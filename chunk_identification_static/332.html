<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>332</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    332
                    <a href="331.html">prev</a>
                    <a href="333.html">next</a>
                    <a href="332_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_c82b9ccdf1393af88048eae80a098a6a0901d157_redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157^1:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157^2:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;8cb6d5aea72f25034c7f3626ec6ef98783b1bee5:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  26 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  27 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  28 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  29 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  30 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  31                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  32 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  34 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  35 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  36 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  37 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  38 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  39 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  40 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  41 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  42 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  43 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  46 import com.google.common.collect.Maps;                                                                   </span>
<span  style="">  47                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  51 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  57     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  58                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  59     private RedisClient redisClient;                                                                     </span>
<span  style="">  60                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  61     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  62                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  63     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  65     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  66                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  67     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  68                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  69     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  70                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  71     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  72                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  74         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  75         redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  81         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  82         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83     }                                                                                                    </span>
<span  style="">  84                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  85     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  86         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  87         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  88         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  89             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  91             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  93         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  94         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  95             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  97         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  98             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  99                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 100                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 101                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 102                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 103                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 105             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 106                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 107                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 109                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 110                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 111                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 113             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 114                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 115                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 116                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 117                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 118                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 119             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 125     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 126         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span  style=""> 131                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 132         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 133         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 134             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 136         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 137         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 139             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 140                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 141                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 142                         Row row = fillData(input.row(), values);                                         </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 143 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-2095674478180876178" onmouseenter="enter('-2095674478180876178');" onmouseout="out('-2095674478180876178');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, values)); </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 145 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 148 =======                                                                                                  </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 150 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 151                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 152                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 153                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 155                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 156                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 157                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 160         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 164     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 165         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166     }                                                                                                    </span>
<span  style=""> 167                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 168     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 169     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 170         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 171         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 172             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 174         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 175             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 177         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 178             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 180         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 181             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  23 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  25 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  26 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  28                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  29 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  30 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  31 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  32 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  34 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  35 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  36 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  37 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  38 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  39 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  40 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  41 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  42 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  43 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  46 import com.google.common.collect.Maps;                                                                   </span>
<span  style="">  47                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  51 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  57     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  58                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  59     private RedisClient redisClient;                                                                     </span>
<span  style="">  60                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  61     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  62                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  63     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  65     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  66                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  67     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  68                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  69     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  70                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  71     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  72                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  74         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="">  75         redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  81         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  82         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83     }                                                                                                    </span>
<span  style="">  84                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  85     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  86         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  87         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  88         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  89             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  91             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  93         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  94         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  95             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  97         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  98             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  99                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 100                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 101                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 102                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 103                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 105             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 106                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 107                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 109                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 110                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 111                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 113             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 114                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 115                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 116                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 117                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 118                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 119             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 125     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 126         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span  style=""> 131                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 132         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 133         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 134             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 136         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 137         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 139             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 140                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 141                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 142                         Row row = fillData(input.row(), values);                                         </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 143 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-2095674478180876178" onmouseenter="enter('-2095674478180876178');" onmouseout="out('-2095674478180876178');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, values)); </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 145 ||||||| BASE                                                                                             </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 148 =======                                                                                                  </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 150 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 151                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 152                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 153                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 155                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 156                     dealMissKey(input, resultFuture);                                                    </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 157                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 160         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 164     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 165         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166     }                                                                                                    </span>
<span  style=""> 167                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 168     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 169     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 170         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 171         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 172             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 174         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 175             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 177         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 178             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 180         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 181             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  18 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  27 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  28 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  31 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  32 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  33 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  34 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  35 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  36 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  37 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  38 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  41 import java.util.function.Consumer;                                                                      </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  42 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  43 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  44 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  45 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  46 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  47 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  48 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  49                                                                                                          </span>
<span  style="">  50                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  51 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  52  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  54 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  55     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  57     private RedisClient redisClient;                                                                     </span>
<span  style="">  58                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  59     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  60                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  61     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  62                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  63     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  65     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  66                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  67     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  68                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  69     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  70                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  71     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  71     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  72         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-7954617859025338600" onmouseenter="enter('-7954617859025338600');" onmouseout="out('-7954617859025338600');" style="">  73         redisSideReqRow = new RedisSideReqRow(super.sideInfo, ((RedisSideTableInfo) (sideTableInfo)));   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  76     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  77     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  78         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  79         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  80         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  83     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  84         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  85         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  86         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  87             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  88         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  89             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  91         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  92         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  93             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  95         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  96             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  97                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style="">  98                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style="">  99                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 100                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 101                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 103             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 104                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 105                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 106                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 106                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 107                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 108                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 109                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 110                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 111             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 112                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 113                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 114                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 115                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 116                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 117             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 118                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120     }                                                                                                    </span>
<span  style=""> 121                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 122     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 123     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 124         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 128     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 128     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 129         String key = buildCacheKey(inputParams);                                                         </span>
<span class="391086597940522415" onmouseenter="enter('391086597940522415');" onmouseout="out('391086597940522415');" style=""> 130         if (StringUtils.isBlank(key)) {                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 131             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132         }                                                                                                </span>
<span class="1977156455400636871" onmouseenter="enter('1977156455400636871');" onmouseout="out('1977156455400636871');" style=""> 133         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) (async)).hgetall(key);       </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 134         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 135             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 136             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 137                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 138                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 139                         Row row = fillData(input.row(), values);                                         </span>
<span class="8909590001630271596" onmouseenter="enter('8909590001630271596');" onmouseout="out('8909590001630271596');" style=""> 140                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));   </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 141                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 142                     } catch (java.lang.Exception e) {                                                    </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 143                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 145                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 146                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 147                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 150         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span  style=""> 152                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 153     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 154     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style=""> 155         return redisSideReqRow.buildCacheKey(refData);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156     }                                                                                                    </span>
<span  style=""> 157                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 158     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 159     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 160         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 161         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 162             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 164         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 165             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 167         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 168             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 170         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 171             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174 }                                                                                                        </span>









</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  28  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  29  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  30  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  31  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  32  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  33                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  34  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  38  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  39  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  40  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  41  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  42  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  43  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  44  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  45  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  46  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  47  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  48  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  49  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  50  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  51  import com.google.common.collect.Maps;                                                                            </span>
<span  style="">  52                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  54  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  55  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  56  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  57  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  58   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  59   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  60  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  61                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  62      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  63                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  64      private RedisClient redisClient;                                                                              </span>
<span  style="">  65                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  66      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  67                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  68      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  69                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  70      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  71                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  72      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  73                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  74      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  75                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  76      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  77                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  78      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  78      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  79          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -        redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>
<span class="-6270850474357319169" onmouseenter="enter('-6270850474357319169');" onmouseout="out('-6270850474357319169');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +        redisSideReqRow = new RedisSideReqRow(super.sideInfo, (RedisSideTableInfo) sideTableInfo);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82      }                                                                                                             </span>
<span  style="">  83                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  84      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  85      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  86          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  87          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  88          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  91      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  92          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  93          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  94          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  95              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  96          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  97              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  99          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style=""> 100          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style=""> 101              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style=""> 103          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 104              case STANDALONE:                                                                                      </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 105                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 106                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 107                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 108                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 109                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 110                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 111              case SENTINEL:                                                                                        </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 112                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 113                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 114                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 114                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 115                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 116                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 117                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 118                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 119              case CLUSTER:                                                                                         </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 120                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 121                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 122                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 123                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 124                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 125              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 126                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span  style=""> 129                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 130      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 131      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 132          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133      }                                                                                                             </span>
<span  style=""> 134                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 135      @Override                                                                                                     </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 136      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 136      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) thðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +                                                                                                                  </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 138          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 139          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 140              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 142          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 143          future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144              @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 145              public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 146                  if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 147                      try {                                                                                         </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 148                          Row row = fillData(input.row(), values);                                                  </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));           </span>
<span class="-2095674478180876178" onmouseenter="enter('-2095674478180876178');" onmouseout="out('-2095674478180876178');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, values));          </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 151                          resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 152                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 153                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 155                  } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 156                      dealMissKey(input, resultFuture);                                                             </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -                    dealCacheData(key,CacheMissVal.getMissKeyObj());                                              </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +                    dealCacheData(key, CacheMissVal.getMissKeyObj());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 161          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 165      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -        StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                          </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -        List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                           </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -        for(String primaryKey : primaryKeys){                                                                     </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -            if(!refData.containsKey(primaryKey)){                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -            }                                                                                                     </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -            keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -        }                                                                                                         </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -        return keyBuilder.toString();                                                                             </span>
<span class="-684523912961789726" onmouseenter="enter('-684523912961789726');" onmouseout="out('-684523912961789726');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +        return redisSideReqRow.buildCacheKey(refData);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176      }                                                                                                             </span>
<span  style=""> 177                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 178      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 179      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 180          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 181          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 182              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 184          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 185              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 187          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 188              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 190          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 191              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="">  23  import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="">  24  import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>



<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  26  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  27  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  28  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  29  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  30                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  31  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  32  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  33  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  34  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  35  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  36  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  37  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  38  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  39  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  40  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  41  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  42  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  43  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  44  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  45  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  46  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  47  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  48  import com.google.common.collect.Maps;                                                                            </span>
<span  style="">  49                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  50  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  51  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  52  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  53  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  55   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  56   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  57  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  58                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  59      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  60                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  61      private RedisClient redisClient;                                                                              </span>
<span  style="">  62                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  63      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  64                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  65      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  66                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  67      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  68                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  69      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  70                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  71      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  72                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  73      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  74                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  75      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  75      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  76          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  77          redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78      }                                                                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  80      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  81      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  82          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  83          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  84          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85      }                                                                                                             </span>
<span  style="">  86                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  87      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  88          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  89          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  90          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  91              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  92          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  93              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  95          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  96          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  97              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  99          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 100              case STANDALONE:                                                                                      </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 101                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 102                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 103                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 104                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 105                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 106                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 107              case SENTINEL:                                                                                        </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 108                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 109                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 110                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 110                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 111                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 112                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 113                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 114                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 115              case CLUSTER:                                                                                         </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 116                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 117                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 118                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 119                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 120                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 121              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 122                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124      }                                                                                                             </span>
<span  style=""> 125                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 126      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 127      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 128          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 131      @Override                                                                                                     </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 132      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 132      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) thðŸ”µ</abbr></span>

<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 133          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 134          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 135              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 137          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 138          future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 139              @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 140              public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 141                  if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 142                      try {                                                                                         </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 143                          Row row = fillData(input.row(), values);                                                  </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));           </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));             </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 146                          resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 147                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 148                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 150                  } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 151                      dealMissKey(input, resultFuture);                                                             </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 152                      dealCacheData(key,CacheMissVal.getMissKeyObj());                                              </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 155          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156      }                                                                                                             </span>
<span  style=""> 157                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 158      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 159      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 160          StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                          </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 161          List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                           </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 162          for(String primaryKey : primaryKeys){                                                                     </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 163              if(!refData.containsKey(primaryKey)){                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 164                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165              }                                                                                                     </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 166              keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167          }                                                                                                         </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 168          return keyBuilder.toString();                                                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169      }                                                                                                             </span>
<span  style=""> 170                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 172      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 173          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 174          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 175              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 177          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 178              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 180          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 181              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 183          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 184              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            