<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>594</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    594
                    <a href="593.html">prev</a>
                    <a href="595.html">next</a>
                    <a href="594_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b43aec0679d705647015fd4416ad6dc326ea7890_core/src/main/java/com/dtstack/flink/sql/side/SideSQLParser.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890:core/src/main/java/com/dtstack/flink/sql/side/SideSQLParser.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^1:core/src/main/java/com/dtstack/flink/sql/side/SideSQLParser.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^2:core/src/main/java/com/dtstack/flink/sql/side/SideSQLParser.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6159bb9bb9904f950c489b50fb7dcbe399c3d327:core/src/main/java/com/dtstack/flink/sql/side/SideSQLParser.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [bj], [bj], [s]], subset: [[b], [bj], [bsj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  23 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  24 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  25 import com.google.common.collect.Maps;                                                                   </span>
<span class="1397139485218690137" onmouseenter="enter('1397139485218690137');" onmouseout="out('1397139485218690137');" style="">  26 import com.google.common.collect.Queues;                                                                 </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  27 import com.google.common.collect.Sets;                                                                   </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  28 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  29 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  30 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  31 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  32 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  33 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  34 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  35 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  36 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="-8823326795697214951" onmouseenter="enter('-8823326795697214951');" onmouseout="out('-8823326795697214951');" style="">  37 import org.apache.calcite.sql.SqlWith;                                                                   </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  38 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  39 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  40 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  41 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  43 =======                                                                                                  </span>
<span class="1277226550340008522" onmouseenter="enter('1277226550340008522');" onmouseout="out('1277226550340008522');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  44 import org.apache.calcite.sql.parser.SqlParser;                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  45 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  46 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  47 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  48 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  49 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  50 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  51                                                                                                          </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  52 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  53 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  54 import java.util.Set;                                                                                    </span>
<span  style="">  55                                                                                                          </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  56 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span  style="">  57                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  58 /**                                                                                                      </span>
<span class="7605977213454941184" onmouseenter="enter('7605977213454941184');" onmouseout="out('7605977213454941184');" style="">  59  * Parsing sql, obtain execution information dimension table                                             </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  60  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  61  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  62  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63  */                                                                                                      </span>
<span  style="">  64                                                                                                          </span>
<span class="3966585742332796558" onmouseenter="enter('3966585742332796558');" onmouseout="out('3966585742332796558');" style="">  65 public class SideSQLParser {                                                                             </span>
<span class="-77182390841532482" onmouseenter="enter('-77182390841532482');" onmouseout="out('-77182390841532482');" style="">  66     private static final Logger LOG = LoggerFactory.getLogger(SideSQLParser.class);                      </span>
<span  style="">  67                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  68     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  69                                                                                                          </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="">  70     public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException { </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="">  71         LOG.info(&quot;----------exec original Sql----------&quot;);                                               </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="">  72         LOG.info(exeSql);                                                                                </span>
<span  style="">  73                                                                                                          </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="">  74         Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                       </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="">  75         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="">  76         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="-9041946153418018780" onmouseenter="enter('-9041946153418018780');" onmouseout="out('-9041946153418018780');" style="">  78         parseSql(sqlNode, sideTableSet, queueInfo, null, null, null);                                    </span>
<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="">  79         queueInfo.offer(sqlNode);                                                                        </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="">  80         return queueInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  83 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  84 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85                                                                                                          </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86     public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException { </span>
<span class="-554334491296517619" onmouseenter="enter('-554334491296517619');" onmouseout="out('-554334491296517619');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87         System.out.println(&quot;----------exec original Sql----------&quot;);                                     </span>
<span class="6408637245030246244" onmouseenter="enter('6408637245030246244');" onmouseout="out('6408637245030246244');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88         System.out.println(exeSql);                                                                      </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89         LOG.info(&quot;----------exec original Sql----------&quot;);                                               </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90         LOG.info(exeSql);                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91                                                                                                          </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92         Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                       </span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93         SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                  </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94         SqlNode sqlNode = sqlParser.parseStmt();                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95                                                                                                          </span>
<span class="-4481737674185385602" onmouseenter="enter('-4481737674185385602');" onmouseout="out('-4481737674185385602');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96         parseSql(sqlNode, sideTableSet, queueInfo, null, null);                                          </span>
<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97         queueInfo.offer(sqlNode);                                                                        </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98         return queueInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100                                                                                                          </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101     private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                   </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103         switch (sqlKind) {                                                                               </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                     checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                 }                                                                                        </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111                 checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116                 checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118             case SELECT:                                                                                 </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119                 SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                       </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120                 if (sqlFrom.getKind() != IDENTIFIER) {                                                   </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                     checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124             case JOIN:                                                                                   </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125                 convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                 break;                                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 127 =======                                                                                                  </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128     private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                   </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130         switch (sqlKind) {                                                                               </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136                     checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137                 }                                                                                        </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138                 checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143                 checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145             case SELECT:                                                                                 </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146                 SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                       </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147                 if (sqlFrom.getKind() != IDENTIFIER) {                                                   </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148                     checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151             case JOIN:                                                                                   </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152                 convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154             case AS:                                                                                     </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155                 SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                </span>
<span class="-229949194999608234" onmouseenter="enter('-229949194999608234');" onmouseout="out('-229949194999608234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                 if (info.getKind() != IDENTIFIER) {                                                      </span>
<span class="-2361038023640716409" onmouseenter="enter('-2361038023640716409');" onmouseout="out('-2361038023640716409');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157                     checkAndReplaceMultiJoin(info, sideTableSet);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="-5768150706489513615" onmouseenter="enter('-5768150706489513615');" onmouseout="out('-5768150706489513615');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163                 checkAndReplaceMultiJoin(unionLeft, sideTableSet);                                       </span>
<span class="-5564097610588924091" onmouseenter="enter('-5564097610588924091');" onmouseout="out('-5564097610588924091');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164                 checkAndReplaceMultiJoin(unionRight, sideTableSet);                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169     }                                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 170 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 171                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 172     /**                                                                                                  </span>
<span class="-3708169461439447854" onmouseenter="enter('-3708169461439447854');" onmouseout="out('-3708169461439447854');" style=""> 173      *  解析 sql 根据维表 join关系重新组装新的sql                                                                      </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 174      * @param sqlNode                                                                                    </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style=""> 175      * @param sideTableSet                                                                               </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 176      * @param queueInfo                                                                                  </span>
<span class="-2398019711746074784" onmouseenter="enter('-2398019711746074784');" onmouseout="out('-2398019711746074784');" style=""> 177      * @param parentWhere                                                                                </span>
<span class="845191212344219041" onmouseenter="enter('845191212344219041');" onmouseout="out('845191212344219041');" style=""> 178      * @param parentSelectList                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 179      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 180      */                                                                                                  </span>
<span class="-4912114046735086097" onmouseenter="enter('-4912114046735086097');" onmouseout="out('-4912114046735086097');" style=""> 181     public Object parseSql(SqlNode sqlNode,                                                              </span>
<span class="-1952250395521254109" onmouseenter="enter('-1952250395521254109');" onmouseout="out('-1952250395521254109');" style=""> 182                            Set&lt;String&gt; sideTableSet,                                                     </span>
<span class="405358965608327863" onmouseenter="enter('405358965608327863');" onmouseout="out('405358965608327863');" style=""> 183                            Queue&lt;Object&gt; queueInfo,                                                      </span>
<span class="2199848844813933222" onmouseenter="enter('2199848844813933222');" onmouseout="out('2199848844813933222');" style=""> 184                            SqlNode parentWhere,                                                          </span>
<span class="1680427389939842559" onmouseenter="enter('1680427389939842559');" onmouseout="out('1680427389939842559');" style=""> 185                            SqlNodeList parentSelectList,                                                 </span>
<span class="1233396441588378287" onmouseenter="enter('1233396441588378287');" onmouseout="out('1233396441588378287');" style=""> 186                            SqlNodeList parentGroupByList){                                               </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 187         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 188         switch (sqlKind){                                                                                </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style=""> 189             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style=""> 190                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style=""> 191                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style=""> 192                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style=""> 193                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="-2137122394942275343" onmouseenter="enter('-2137122394942275343');" onmouseout="out('-2137122394942275343');" style=""><abbr title=" 194                     parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 194                     parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, p🔵</abbr></span>
<span class="558256818041950127" onmouseenter="enter('558256818041950127');" onmouseout="out('558256818041950127');" style=""> 195                     queueInfo.add(sqlWithItem);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196                 }                                                                                        </span>
<span class="3054548125000552946" onmouseenter="enter('3054548125000552946');" onmouseout="out('3054548125000552946');" style=""><abbr title=" 197                 parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 197                 parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGrou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 198                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 200             case INSERT:                                                                                 </span>
<span class="-7853295063534246070" onmouseenter="enter('-7853295063534246070');" onmouseout="out('-7853295063534246070');" style=""> 201                 SqlNode sqlSource = ((SqlInsert)sqlNode).getSource();                                    </span>
<span class="2601968389209545089" onmouseenter="enter('2601968389209545089');" onmouseout="out('2601968389209545089');" style=""><abbr title=" 202                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 202                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 203             case SELECT:                                                                                 </span>
<span class="-737340637367962148" onmouseenter="enter('-737340637367962148');" onmouseout="out('-737340637367962148');" style=""> 204                 SqlNode sqlFrom = ((SqlSelect)sqlNode).getFrom();                                        </span>
<span class="-4595996050370151557" onmouseenter="enter('-4595996050370151557');" onmouseout="out('-4595996050370151557');" style=""> 205                 SqlNode sqlWhere = ((SqlSelect)sqlNode).getWhere();                                      </span>
<span class="-6539957329780970839" onmouseenter="enter('-6539957329780970839');" onmouseout="out('-6539957329780970839');" style=""> 206                 SqlNodeList selectList = ((SqlSelect)sqlNode).getSelectList();                           </span>
<span class="1382610957563429127" onmouseenter="enter('1382610957563429127');" onmouseout="out('1382610957563429127');" style=""> 207                 SqlNodeList groupByList = ((SqlSelect) sqlNode).getGroup();                              </span>
<span  style=""> 208                                                                                                          </span>
<span class="-6669062104161423555" onmouseenter="enter('-6669062104161423555');" onmouseout="out('-6669062104161423555');" style=""> 209                 if(sqlFrom.getKind() != IDENTIFIER){                                                     </span>
<span class="-3530162948571427823" onmouseenter="enter('-3530162948571427823');" onmouseout="out('-3530162948571427823');" style=""><abbr title=" 210                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, groupByList);"> 210                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, grou🔵</abbr></span>
<span class="7802562789325773256" onmouseenter="enter('7802562789325773256');" onmouseout="out('7802562789325773256');" style=""> 211                     if(result instanceof JoinInfo){                                                      </span>
<span class="-8441429291693214923" onmouseenter="enter('-8441429291693214923');" onmouseout="out('-8441429291693214923');" style=""><abbr title=" 212                         return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, queueInfo);"> 212                         return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sql🔵</abbr></span>
<span class="1716266177589910912" onmouseenter="enter('1716266177589910912');" onmouseout="out('1716266177589910912');" style=""> 213                     }else if(result instanceof AliasInfo){                                               </span>
<span class="-6975694729646816765" onmouseenter="enter('-6975694729646816765');" onmouseout="out('-6975694729646816765');" style=""> 214                         String tableName = ((AliasInfo) result).getName();                               </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 215                         if(sideTableSet.contains(tableName)){                                            </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 216                             throw new RuntimeException(&quot;side-table must be used in join operator&quot;);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 219                 }else{                                                                                   </span>
<span class="1420748888812461485" onmouseenter="enter('1420748888812461485');" onmouseout="out('1420748888812461485');" style=""> 220                     String tableName = ((SqlIdentifier)sqlFrom).getSimple();                             </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 221                     if(sideTableSet.contains(tableName)){                                                </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 222                         throw new RuntimeException(&quot;side-table must be used in join operator&quot;);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 225                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 226             case JOIN:                                                                                   </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style=""> 227                 JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style=""> 228                 Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                            </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style=""> 229                 Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                        </span>
<span class="-6306168579289105112" onmouseenter="enter('-6306168579289105112');" onmouseout="out('-6306168579289105112');" style=""> 230                 Map&lt;String, String&gt; fieldRef = Maps.newHashMap();                                        </span>
<span class="-1512934165488206441" onmouseenter="enter('-1512934165488206441');" onmouseout="out('-1512934165488206441');" style=""> 231                 return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo,           </span>
<span class="8113418629148402447" onmouseenter="enter('8113418629148402447');" onmouseout="out('8113418629148402447');" style=""><abbr title=" 232                         parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRef);"> 232                         parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRe🔵</abbr></span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 233             case AS:                                                                                     </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 234                 SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                 </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 235                 SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                               </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style=""> 236                 String infoStr = &quot;&quot;;                                                                     </span>
<span  style=""> 237                                                                                                          </span>
<span class="2126841880433088777" onmouseenter="enter('2126841880433088777');" onmouseout="out('2126841880433088777');" style=""> 238                 if(info.getKind() == IDENTIFIER){                                                        </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style=""> 239                     infoStr = info.toString();                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 240                 } else {                                                                                 </span>
<span class="3298089944558441209" onmouseenter="enter('3298089944558441209');" onmouseout="out('3298089944558441209');" style=""><abbr title=" 241                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList).toString();"> 241                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, pare🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242                 }                                                                                        </span>
<span  style=""> 243                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 244                 AliasInfo aliasInfo = new AliasInfo();                                                   </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 245                 aliasInfo.setName(infoStr);                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 246                 aliasInfo.setAlias(alias.toString());                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 248                 return aliasInfo;                                                                        </span>
<span  style=""> 249                                                                                                          </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 250             case UNION:                                                                                  </span>
<span class="-7477725012703906871" onmouseenter="enter('-7477725012703906871');" onmouseout="out('-7477725012703906871');" style=""> 251                 SqlNode unionLeft = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-368480979530163649" onmouseenter="enter('-368480979530163649');" onmouseout="out('-368480979530163649');" style=""> 252                 SqlNode unionRight = ((SqlBasicCall)sqlNode).getOperands()[1];                           </span>
<span  style=""> 253                                                                                                          </span>
<span class="-4603896956067102557" onmouseenter="enter('-4603896956067102557');" onmouseout="out('-4603896956067102557');" style=""><abbr title=" 254                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 254                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupBy🔵</abbr></span>
<span class="-4077767015718338016" onmouseenter="enter('-4077767015718338016');" onmouseout="out('-4077767015718338016');" style=""><abbr title=" 255                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 255                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupB🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 256                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style=""> 257             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style=""> 258                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 259 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5885804299572217205" onmouseenter="enter('5885804299572217205');" onmouseout="out('5885804299572217205');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 260                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 260                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 261                                                                                                          </span>
<span class="-2988899114509087250" onmouseenter="enter('-2988899114509087250');" onmouseout="out('-2988899114509087250');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 262             case LITERAL:                                                                                </span>
<span class="2819024748306122432" onmouseenter="enter('2819024748306122432');" onmouseout="out('2819024748306122432');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 263                 return LITERAL.toString();                                                               </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 264 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                 }else{                                                                                   </span>
<span class="1420748888812461485" onmouseenter="enter('1420748888812461485');" onmouseout="out('1420748888812461485');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                     String tableName = ((SqlIdentifier)sqlFrom).getSimple();                             </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                     if(sideTableSet.contains(tableName)){                                                </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                         throw new RuntimeException(&quot;side-table must be used in join operator&quot;);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272             case JOIN:                                                                                   </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                 JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                 Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                            </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                 Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                        </span>
<span class="-3780372464013354713" onmouseenter="enter('-3780372464013354713');" onmouseout="out('-3780372464013354713');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 276                 return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWhere, parentSelectList, joinFieldSet, tableRef);"> 276                 return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWher🔵</abbr></span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277             case AS:                                                                                     </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                 SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                 </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                 SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                               </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                 String infoStr = &quot;&quot;;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                                                                                                          </span>
<span class="2126841880433088777" onmouseenter="enter('2126841880433088777');" onmouseout="out('2126841880433088777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                 if(info.getKind() == IDENTIFIER){                                                        </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                     infoStr = info.toString();                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                 } else {                                                                                 </span>
<span class="-6819509038307231597" onmouseenter="enter('-6819509038307231597');" onmouseout="out('-6819509038307231597');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 285                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList).toString();"> 285                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList).toSt🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                 AliasInfo aliasInfo = new AliasInfo();                                                   </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                 aliasInfo.setName(infoStr);                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                 aliasInfo.setAlias(alias.toString());                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 292 =======                                                                                                  </span>
<span class="3263473097860657554" onmouseenter="enter('3263473097860657554');" onmouseout="out('3263473097860657554');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList);      </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295                 break;                                                                                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 296 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 298         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299     }                                                                                                    </span>
<span  style=""> 300                                                                                                          </span>
<span  style=""> 301                                                                                                          </span>
<span  style=""> 302                                                                                                          </span>
<span  style=""> 303                                                                                                          </span>
<span class="-649401327769177886" onmouseenter="enter('-649401327769177886');" onmouseout="out('-649401327769177886');" style=""> 304     public void setLocalTableCache(Map&lt;String, Table&gt; localTableCache) {                                 </span>
<span class="-1916936159945030154" onmouseenter="enter('-1916936159945030154');" onmouseout="out('-1916936159945030154');" style=""> 305         this.localTableCache = localTableCache;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  23 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  24 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  25 import com.google.common.collect.Maps;                                                                   </span>
<span class="1397139485218690137" onmouseenter="enter('1397139485218690137');" onmouseout="out('1397139485218690137');" style="">  26 import com.google.common.collect.Queues;                                                                 </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  27 import com.google.common.collect.Sets;                                                                   </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  28 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  29 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  30 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  31 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  32 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  33 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  34 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  35 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  36 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="-8823326795697214951" onmouseenter="enter('-8823326795697214951');" onmouseout="out('-8823326795697214951');" style="">  37 import org.apache.calcite.sql.SqlWith;                                                                   </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  38 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  39 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  40 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  41 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  42 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  43 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  44 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  45                                                                                                          </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  46 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  47 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  48 import java.util.Set;                                                                                    </span>
<span  style="">  49                                                                                                          </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  50 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span  style="">  51                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7605977213454941184" onmouseenter="enter('7605977213454941184');" onmouseout="out('7605977213454941184');" style="">  53  * Parsing sql, obtain execution information dimension table                                             </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  54  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  55  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  56  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57  */                                                                                                      </span>
<span  style="">  58                                                                                                          </span>
<span class="3966585742332796558" onmouseenter="enter('3966585742332796558');" onmouseout="out('3966585742332796558');" style="">  59 public class SideSQLParser {                                                                             </span>
<span class="-77182390841532482" onmouseenter="enter('-77182390841532482');" onmouseout="out('-77182390841532482');" style="">  60     private static final Logger LOG = LoggerFactory.getLogger(SideSQLParser.class);                      </span>
<span  style="">  61                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  62     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  63                                                                                                          </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="">  64     public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException { </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="">  65         LOG.info(&quot;----------exec original Sql----------&quot;);                                               </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="">  66         LOG.info(exeSql);                                                                                </span>
<span  style="">  67                                                                                                          </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="">  68         Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                       </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="">  69         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="">  70         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-9041946153418018780" onmouseenter="enter('-9041946153418018780');" onmouseout="out('-9041946153418018780');" style="">  72         parseSql(sqlNode, sideTableSet, queueInfo, null, null, null);                                    </span>
<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="">  73         queueInfo.offer(sqlNode);                                                                        </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="">  74         return queueInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span  style="">  77                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  78     /**                                                                                                  </span>
<span class="-3708169461439447854" onmouseenter="enter('-3708169461439447854');" onmouseout="out('-3708169461439447854');" style="">  79      *  解析 sql 根据维表 join关系重新组装新的sql                                                                      </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  80      * @param sqlNode                                                                                    </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style="">  81      * @param sideTableSet                                                                               </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style="">  82      * @param queueInfo                                                                                  </span>
<span class="-2398019711746074784" onmouseenter="enter('-2398019711746074784');" onmouseout="out('-2398019711746074784');" style="">  83      * @param parentWhere                                                                                </span>
<span class="845191212344219041" onmouseenter="enter('845191212344219041');" onmouseout="out('845191212344219041');" style="">  84      * @param parentSelectList                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  85      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86      */                                                                                                  </span>
<span class="-4912114046735086097" onmouseenter="enter('-4912114046735086097');" onmouseout="out('-4912114046735086097');" style="">  87     public Object parseSql(SqlNode sqlNode,                                                              </span>
<span class="-1952250395521254109" onmouseenter="enter('-1952250395521254109');" onmouseout="out('-1952250395521254109');" style="">  88                            Set&lt;String&gt; sideTableSet,                                                     </span>
<span class="405358965608327863" onmouseenter="enter('405358965608327863');" onmouseout="out('405358965608327863');" style="">  89                            Queue&lt;Object&gt; queueInfo,                                                      </span>
<span class="2199848844813933222" onmouseenter="enter('2199848844813933222');" onmouseout="out('2199848844813933222');" style="">  90                            SqlNode parentWhere,                                                          </span>
<span class="1680427389939842559" onmouseenter="enter('1680427389939842559');" onmouseout="out('1680427389939842559');" style="">  91                            SqlNodeList parentSelectList,                                                 </span>
<span class="1233396441588378287" onmouseenter="enter('1233396441588378287');" onmouseout="out('1233396441588378287');" style="">  92                            SqlNodeList parentGroupByList){                                               </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  93         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style="">  94         switch (sqlKind){                                                                                </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="">  95             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="">  96                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="">  97                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="">  98                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="">  99                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="-2137122394942275343" onmouseenter="enter('-2137122394942275343');" onmouseout="out('-2137122394942275343');" style=""><abbr title=" 100                     parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 100                     parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, p🔵</abbr></span>
<span class="558256818041950127" onmouseenter="enter('558256818041950127');" onmouseout="out('558256818041950127');" style=""> 101                     queueInfo.add(sqlWithItem);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102                 }                                                                                        </span>
<span class="3054548125000552946" onmouseenter="enter('3054548125000552946');" onmouseout="out('3054548125000552946');" style=""><abbr title=" 103                 parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 103                 parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGrou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 106             case INSERT:                                                                                 </span>
<span class="-7853295063534246070" onmouseenter="enter('-7853295063534246070');" onmouseout="out('-7853295063534246070');" style=""> 107                 SqlNode sqlSource = ((SqlInsert)sqlNode).getSource();                                    </span>
<span class="2601968389209545089" onmouseenter="enter('2601968389209545089');" onmouseout="out('2601968389209545089');" style=""><abbr title=" 108                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 108                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 109             case SELECT:                                                                                 </span>
<span class="-737340637367962148" onmouseenter="enter('-737340637367962148');" onmouseout="out('-737340637367962148');" style=""> 110                 SqlNode sqlFrom = ((SqlSelect)sqlNode).getFrom();                                        </span>
<span class="-4595996050370151557" onmouseenter="enter('-4595996050370151557');" onmouseout="out('-4595996050370151557');" style=""> 111                 SqlNode sqlWhere = ((SqlSelect)sqlNode).getWhere();                                      </span>
<span class="-6539957329780970839" onmouseenter="enter('-6539957329780970839');" onmouseout="out('-6539957329780970839');" style=""> 112                 SqlNodeList selectList = ((SqlSelect)sqlNode).getSelectList();                           </span>
<span class="1382610957563429127" onmouseenter="enter('1382610957563429127');" onmouseout="out('1382610957563429127');" style=""> 113                 SqlNodeList groupByList = ((SqlSelect) sqlNode).getGroup();                              </span>
<span  style=""> 114                                                                                                          </span>
<span class="-6669062104161423555" onmouseenter="enter('-6669062104161423555');" onmouseout="out('-6669062104161423555');" style=""> 115                 if(sqlFrom.getKind() != IDENTIFIER){                                                     </span>
<span class="-3530162948571427823" onmouseenter="enter('-3530162948571427823');" onmouseout="out('-3530162948571427823');" style=""><abbr title=" 116                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, groupByList);"> 116                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, grou🔵</abbr></span>
<span class="7802562789325773256" onmouseenter="enter('7802562789325773256');" onmouseout="out('7802562789325773256');" style=""> 117                     if(result instanceof JoinInfo){                                                      </span>
<span class="-8441429291693214923" onmouseenter="enter('-8441429291693214923');" onmouseout="out('-8441429291693214923');" style=""><abbr title=" 118                         return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, queueInfo);"> 118                         return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sql🔵</abbr></span>
<span class="1716266177589910912" onmouseenter="enter('1716266177589910912');" onmouseout="out('1716266177589910912');" style=""> 119                     }else if(result instanceof AliasInfo){                                               </span>
<span class="-6975694729646816765" onmouseenter="enter('-6975694729646816765');" onmouseout="out('-6975694729646816765');" style=""> 120                         String tableName = ((AliasInfo) result).getName();                               </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 121                         if(sideTableSet.contains(tableName)){                                            </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 122                             throw new RuntimeException(&quot;side-table must be used in join operator&quot;);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 125                 }else{                                                                                   </span>
<span class="1420748888812461485" onmouseenter="enter('1420748888812461485');" onmouseout="out('1420748888812461485');" style=""> 126                     String tableName = ((SqlIdentifier)sqlFrom).getSimple();                             </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 127                     if(sideTableSet.contains(tableName)){                                                </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 128                         throw new RuntimeException(&quot;side-table must be used in join operator&quot;);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 131                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 132             case JOIN:                                                                                   </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style=""> 133                 JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style=""> 134                 Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                            </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style=""> 135                 Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                        </span>
<span class="-6306168579289105112" onmouseenter="enter('-6306168579289105112');" onmouseout="out('-6306168579289105112');" style=""> 136                 Map&lt;String, String&gt; fieldRef = Maps.newHashMap();                                        </span>
<span class="-1512934165488206441" onmouseenter="enter('-1512934165488206441');" onmouseout="out('-1512934165488206441');" style=""> 137                 return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo,           </span>
<span class="8113418629148402447" onmouseenter="enter('8113418629148402447');" onmouseout="out('8113418629148402447');" style=""><abbr title=" 138                         parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRef);"> 138                         parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRe🔵</abbr></span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 139             case AS:                                                                                     </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 140                 SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                 </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 141                 SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                               </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style=""> 142                 String infoStr = &quot;&quot;;                                                                     </span>
<span  style=""> 143                                                                                                          </span>
<span class="2126841880433088777" onmouseenter="enter('2126841880433088777');" onmouseout="out('2126841880433088777');" style=""> 144                 if(info.getKind() == IDENTIFIER){                                                        </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style=""> 145                     infoStr = info.toString();                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 146                 } else {                                                                                 </span>
<span class="3298089944558441209" onmouseenter="enter('3298089944558441209');" onmouseout="out('3298089944558441209');" style=""><abbr title=" 147                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList).toString();"> 147                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, pare🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148                 }                                                                                        </span>
<span  style=""> 149                                                                                                          </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 150                 AliasInfo aliasInfo = new AliasInfo();                                                   </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 151                 aliasInfo.setName(infoStr);                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 152                 aliasInfo.setAlias(alias.toString());                                                    </span>
<span  style=""> 153                                                                                                          </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 154                 return aliasInfo;                                                                        </span>
<span  style=""> 155                                                                                                          </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 156             case UNION:                                                                                  </span>
<span class="-7477725012703906871" onmouseenter="enter('-7477725012703906871');" onmouseout="out('-7477725012703906871');" style=""> 157                 SqlNode unionLeft = ((SqlBasicCall)sqlNode).getOperands()[0];                            </span>
<span class="-368480979530163649" onmouseenter="enter('-368480979530163649');" onmouseout="out('-368480979530163649');" style=""> 158                 SqlNode unionRight = ((SqlBasicCall)sqlNode).getOperands()[1];                           </span>
<span  style=""> 159                                                                                                          </span>
<span class="-4603896956067102557" onmouseenter="enter('-4603896956067102557');" onmouseout="out('-4603896956067102557');" style=""><abbr title=" 160                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 160                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupBy🔵</abbr></span>
<span class="-4077767015718338016" onmouseenter="enter('-4077767015718338016');" onmouseout="out('-4077767015718338016');" style=""><abbr title=" 161                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 161                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupB🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 162                 break;                                                                                   </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style=""> 163             case ORDER_BY:                                                                               </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style=""> 164                 SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                           </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 165 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5885804299572217205" onmouseenter="enter('5885804299572217205');" onmouseout="out('5885804299572217205');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 166                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 166                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 167                                                                                                          </span>
<span class="-2988899114509087250" onmouseenter="enter('-2988899114509087250');" onmouseout="out('-2988899114509087250');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 168             case LITERAL:                                                                                </span>
<span class="2819024748306122432" onmouseenter="enter('2819024748306122432');" onmouseout="out('2819024748306122432');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 169                 return LITERAL.toString();                                                               </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 170 ||||||| BASE                                                                                             </span>
<span class="3263473097860657554" onmouseenter="enter('3263473097860657554');" onmouseout="out('3263473097860657554');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 175 =======                                                                                                  </span>
<span class="3263473097860657554" onmouseenter="enter('3263473097860657554');" onmouseout="out('3263473097860657554');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList);      </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178                 break;                                                                                   </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 179 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 181         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 183 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 184 ||||||| BASE                                                                                             </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185 private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                       </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187         switch (sqlKind) {                                                                               </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                     checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                 }                                                                                        </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                 checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202             case SELECT:                                                                                 </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                 SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                       </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                 if (sqlFrom.getKind() != IDENTIFIER) {                                                   </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                     checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208             case JOIN:                                                                                   </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                 convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211             case AS:                                                                                     </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                 SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                </span>
<span class="-229949194999608234" onmouseenter="enter('-229949194999608234');" onmouseout="out('-229949194999608234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 if (info.getKind() != IDENTIFIER) {                                                      </span>
<span class="-2361038023640716409" onmouseenter="enter('-2361038023640716409');" onmouseout="out('-2361038023640716409');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                     checkAndReplaceMultiJoin(info, sideTableSet);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="-5768150706489513615" onmouseenter="enter('-5768150706489513615');" onmouseout="out('-5768150706489513615');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220                 checkAndReplaceMultiJoin(unionLeft, sideTableSet);                                       </span>
<span class="-5564097610588924091" onmouseenter="enter('-5564097610588924091');" onmouseout="out('-5564097610588924091');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                 checkAndReplaceMultiJoin(unionRight, sideTableSet);                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 225 =======                                                                                                  </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226 private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                       </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228         switch (sqlKind) {                                                                               </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229             case WITH: {                                                                                 </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230                 SqlWith sqlWith = (SqlWith) sqlNode;                                                     </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231                 SqlNodeList sqlNodeList = sqlWith.withList;                                              </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232                 for (SqlNode withAsTable : sqlNodeList) {                                                </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233                     SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                 </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234                     checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235                 }                                                                                        </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236                 checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238             }                                                                                            </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241                 checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243             case SELECT:                                                                                 </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244                 SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                       </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245                 if (sqlFrom.getKind() != IDENTIFIER) {                                                   </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246                     checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249             case JOIN:                                                                                   </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250                 convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252             case AS:                                                                                     </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253                 SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                </span>
<span class="-229949194999608234" onmouseenter="enter('-229949194999608234');" onmouseout="out('-229949194999608234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254                 if (info.getKind() != IDENTIFIER) {                                                      </span>
<span class="-2361038023640716409" onmouseenter="enter('-2361038023640716409');" onmouseout="out('-2361038023640716409');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255                     checkAndReplaceMultiJoin(info, sideTableSet);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="-5768150706489513615" onmouseenter="enter('-5768150706489513615');" onmouseout="out('-5768150706489513615');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261                 checkAndReplaceMultiJoin(unionLeft, sideTableSet);                                       </span>
<span class="-5564097610588924091" onmouseenter="enter('-5564097610588924091');" onmouseout="out('-5564097610588924091');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262                 checkAndReplaceMultiJoin(unionRight, sideTableSet);                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 268 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 269                                                                                                          </span>
<span  style=""> 270                                                                                                          </span>
<span  style=""> 271                                                                                                          </span>
<span  style=""> 272                                                                                                          </span>
<span  style=""> 273                                                                                                          </span>
<span class="-649401327769177886" onmouseenter="enter('-649401327769177886');" onmouseout="out('-649401327769177886');" style=""> 274     public void setLocalTableCache(Map&lt;String, Table&gt; localTableCache) {                                 </span>
<span class="-1916936159945030154" onmouseenter="enter('-1916936159945030154');" onmouseout="out('-1916936159945030154');" style=""> 275         this.localTableCache = localTableCache;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276     }                                                                                                    </span>
<span  style=""> 277                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278 }                                                                                                        </span>




























</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  20 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  21 import com.dtstack.flink.sql.util.TableUtils;                                                            </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  22 import com.google.common.collect.Maps;                                                                   </span>
<span class="1397139485218690137" onmouseenter="enter('1397139485218690137');" onmouseout="out('1397139485218690137');" style="">  23 import com.google.common.collect.Queues;                                                                 </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  24 import com.google.common.collect.Sets;                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  25 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  26 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  27 import java.util.Set;                                                                                    </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  28 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  29 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  30 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  31 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  32 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  33 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  34 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  35 import org.apache.calcite.sql.SqlOrderBy;                                                                </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  36 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="-8823326795697214951" onmouseenter="enter('-8823326795697214951');" onmouseout="out('-8823326795697214951');" style="">  37 import org.apache.calcite.sql.SqlWith;                                                                   </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  38 import org.apache.calcite.sql.SqlWithItem;                                                               </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  39 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  40 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  41 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  42 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  43 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  44 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="">  45 import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                 </span>
<span  style="">  46                                                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  48 /**                                                                                                      </span>
<span class="7605977213454941184" onmouseenter="enter('7605977213454941184');" onmouseout="out('7605977213454941184');" style="">  49  * Parsing sql, obtain execution information dimension table                                             </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  50  * Date: 2018/7/24                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  51  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  52  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53  */                                                                                                      </span>
<span class="3966585742332796558" onmouseenter="enter('3966585742332796558');" onmouseout="out('3966585742332796558');" style="">  54 public class SideSQLParser {                                                                             </span>
<span class="-77182390841532482" onmouseenter="enter('-77182390841532482');" onmouseout="out('-77182390841532482');" style="">  55     private static final Logger LOG = LoggerFactory.getLogger(SideSQLParser.class);                      </span>
<span  style="">  56                                                                                                          </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  57     private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                      </span>
<span  style="">  58                                                                                                          </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="">  59     public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException { </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="">  60         LOG.info(&quot;----------exec original Sql----------&quot;);                                               </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="">  61         LOG.info(exeSql);                                                                                </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="">  62         Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                       </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="">  63         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="">  64         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span class="-9041946153418018780" onmouseenter="enter('-9041946153418018780');" onmouseout="out('-9041946153418018780');" style="">  65         parseSql(sqlNode, sideTableSet, queueInfo, null, null, null);                                    </span>
<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="">  66         queueInfo.offer(sqlNode);                                                                        </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="">  67         return queueInfo;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68     }                                                                                                    </span>
<span  style="">  69                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70     /**                                                                                                  </span>
<span class="-3708169461439447854" onmouseenter="enter('-3708169461439447854');" onmouseout="out('-3708169461439447854');" style="">  71      *  解析 sql 根据维表 join关系重新组装新的sql                                                                      </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  72      * @param sqlNode                                                                                    </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style="">  73      * @param sideTableSet                                                                               </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style="">  74      * @param queueInfo                                                                                  </span>
<span class="-2398019711746074784" onmouseenter="enter('-2398019711746074784');" onmouseout="out('-2398019711746074784');" style="">  75      * @param parentWhere                                                                                </span>
<span class="845191212344219041" onmouseenter="enter('845191212344219041');" onmouseout="out('845191212344219041');" style="">  76      * @param parentSelectList                                                                           </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  77      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78      */                                                                                                  </span>
<span class="1010039384628845939" onmouseenter="enter('1010039384628845939');" onmouseout="out('1010039384628845939');" style=""><abbr title="  79     public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode parentWhere, SqlNodeList parentSelectList, SqlNodeList parentGroupByList) {">  79     public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode pa🔵</abbr></span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  80         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  81         switch (sqlKind) {                                                                               </span>
<span class="-8624837119986957540" onmouseenter="enter('-8624837119986957540');" onmouseout="out('-8624837119986957540');" style="">  82             case WITH :                                                                                  </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style="">  83                 {                                                                                        </span>
<span class="-5613792330367174153" onmouseenter="enter('-5613792330367174153');" onmouseout="out('-5613792330367174153');" style="">  84                     SqlWith sqlWith = ((SqlWith) (sqlNode));                                             </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="">  85                     SqlNodeList sqlNodeList = sqlWith.withList;                                          </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="">  86                     for (SqlNode withAsTable : sqlNodeList) {                                            </span>
<span class="7351066786664767555" onmouseenter="enter('7351066786664767555');" onmouseout="out('7351066786664767555');" style="">  87                         SqlWithItem sqlWithItem = ((SqlWithItem) (withAsTable));                         </span>
<span class="-2137122394942275343" onmouseenter="enter('-2137122394942275343');" onmouseout="out('-2137122394942275343');" style=""><abbr title="  88                         parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);">  88                         parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectLis🔵</abbr></span>
<span class="558256818041950127" onmouseenter="enter('558256818041950127');" onmouseout="out('558256818041950127');" style="">  89                         queueInfo.add(sqlWithItem);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90                     }                                                                                    </span>
<span class="3054548125000552946" onmouseenter="enter('3054548125000552946');" onmouseout="out('3054548125000552946');" style=""><abbr title="  91                     parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);">  91                     parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  92                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93                 }                                                                                        </span>
<span class="-3229205352829537061" onmouseenter="enter('-3229205352829537061');" onmouseout="out('-3229205352829537061');" style="">  94             case INSERT :                                                                                </span>
<span class="4923379117766569884" onmouseenter="enter('4923379117766569884');" onmouseout="out('4923379117766569884');" style="">  95                 SqlNode sqlSource = ((SqlInsert) (sqlNode)).getSource();                                 </span>
<span class="2601968389209545089" onmouseenter="enter('2601968389209545089');" onmouseout="out('2601968389209545089');" style=""><abbr title="  96                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);">  96                 return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span class="-3198951126756304146" onmouseenter="enter('-3198951126756304146');" onmouseout="out('-3198951126756304146');" style="">  97             case SELECT :                                                                                </span>
<span class="-1459310299914917625" onmouseenter="enter('-1459310299914917625');" onmouseout="out('-1459310299914917625');" style="">  98                 SqlNode sqlFrom = ((SqlSelect) (sqlNode)).getFrom();                                     </span>
<span class="-2393426376845809432" onmouseenter="enter('-2393426376845809432');" onmouseout="out('-2393426376845809432');" style="">  99                 SqlNode sqlWhere = ((SqlSelect) (sqlNode)).getWhere();                                   </span>
<span class="-3132291294692602869" onmouseenter="enter('-3132291294692602869');" onmouseout="out('-3132291294692602869');" style=""> 100                 SqlNodeList selectList = ((SqlSelect) (sqlNode)).getSelectList();                        </span>
<span class="-8102726577559173244" onmouseenter="enter('-8102726577559173244');" onmouseout="out('-8102726577559173244');" style=""> 101                 SqlNodeList groupByList = ((SqlSelect) (sqlNode)).getGroup();                            </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style=""> 102                 if (sqlFrom.getKind() != IDENTIFIER) {                                                   </span>
<span class="-3530162948571427823" onmouseenter="enter('-3530162948571427823');" onmouseout="out('-3530162948571427823');" style=""><abbr title=" 103                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, groupByList);"> 103                     Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, grou🔵</abbr></span>
<span class="-2846633646845060547" onmouseenter="enter('-2846633646845060547');" onmouseout="out('-2846633646845060547');" style=""> 104                     if (result instanceof JoinInfo) {                                                    </span>
<span class="3265840953062921003" onmouseenter="enter('3265840953062921003');" onmouseout="out('3265840953062921003');" style=""><abbr title=" 105                         return TableUtils.dealSelectResultWithJoinInfo(((JoinInfo) (result)), ((SqlSelect) (sqlNode)), queueInfo);"> 105                         return TableUtils.dealSelectResultWithJoinInfo(((JoinInfo) (result)), ((SqlSelect🔵</abbr></span>
<span class="-793414957286274210" onmouseenter="enter('-793414957286274210');" onmouseout="out('-793414957286274210');" style=""> 106                     } else if (result instanceof AliasInfo) {                                            </span>
<span class="6118954434459284547" onmouseenter="enter('6118954434459284547');" onmouseout="out('6118954434459284547');" style=""> 107                         String tableName = ((AliasInfo) (result)).getName();                             </span>
<span class="7998125235127077949" onmouseenter="enter('7998125235127077949');" onmouseout="out('7998125235127077949');" style=""> 108                         if (sideTableSet.contains(tableName)) {                                          </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 109                             throw new RuntimeException(&quot;side-table must be used in join operator&quot;);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 112                 } else {                                                                                 </span>
<span class="-4890106399696482914" onmouseenter="enter('-4890106399696482914');" onmouseout="out('-4890106399696482914');" style=""> 113                     String tableName = ((SqlIdentifier) (sqlFrom)).getSimple();                          </span>
<span class="7998125235127077949" onmouseenter="enter('7998125235127077949');" onmouseout="out('7998125235127077949');" style=""> 114                     if (sideTableSet.contains(tableName)) {                                              </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 115                         throw new RuntimeException(&quot;side-table must be used in join operator&quot;);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 118                 break;                                                                                   </span>
<span class="-6812790603264225102" onmouseenter="enter('-6812790603264225102');" onmouseout="out('-6812790603264225102');" style=""> 119             case JOIN :                                                                                  </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style=""> 120                 JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style=""> 121                 Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                            </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style=""> 122                 Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                        </span>
<span class="-6306168579289105112" onmouseenter="enter('-6306168579289105112');" onmouseout="out('-6306168579289105112');" style=""> 123                 Map&lt;String, String&gt; fieldRef = Maps.newHashMap();                                        </span>
<span class="-8454664021856259127" onmouseenter="enter('-8454664021856259127');" onmouseout="out('-8454664021856259127');" style=""><abbr title=" 124                 return joinNodeDealer.dealJoinNode(((SqlJoin) (sqlNode)), sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRef);"> 124                 return joinNodeDealer.dealJoinNode(((SqlJoin) (sqlNode)), sideTableSet, queueInfo, parent🔵</abbr></span>
<span class="-7603101237578294688" onmouseenter="enter('-7603101237578294688');" onmouseout="out('-7603101237578294688');" style=""> 125             case AS :                                                                                    </span>
<span class="-2581148716866963551" onmouseenter="enter('-2581148716866963551');" onmouseout="out('-2581148716866963551');" style=""> 126                 SqlNode info = ((SqlBasicCall) (sqlNode)).getOperands()[0];                              </span>
<span class="6674876786664753496" onmouseenter="enter('6674876786664753496');" onmouseout="out('6674876786664753496');" style=""> 127                 SqlNode alias = ((SqlBasicCall) (sqlNode)).getOperands()[1];                             </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style=""> 128                 String infoStr = &quot;&quot;;                                                                     </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style=""> 129                 if (info.getKind() == IDENTIFIER) {                                                      </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style=""> 130                     infoStr = info.toString();                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 131                 } else {                                                                                 </span>
<span class="3298089944558441209" onmouseenter="enter('3298089944558441209');" onmouseout="out('3298089944558441209');" style=""><abbr title=" 132                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList).toString();"> 132                     infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, pare🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133                 }                                                                                        </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 134                 AliasInfo aliasInfo = new AliasInfo();                                                   </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 135                 aliasInfo.setName(infoStr);                                                              </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 136                 aliasInfo.setAlias(alias.toString());                                                    </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 137                 return aliasInfo;                                                                        </span>
<span class="1238941309895419592" onmouseenter="enter('1238941309895419592');" onmouseout="out('1238941309895419592');" style=""> 138             case UNION :                                                                                 </span>
<span class="3847221911167009847" onmouseenter="enter('3847221911167009847');" onmouseout="out('3847221911167009847');" style=""> 139                 SqlNode unionLeft = ((SqlBasicCall) (sqlNode)).getOperands()[0];                         </span>
<span class="-4021192438573809697" onmouseenter="enter('-4021192438573809697');" onmouseout="out('-4021192438573809697');" style=""> 140                 SqlNode unionRight = ((SqlBasicCall) (sqlNode)).getOperands()[1];                        </span>
<span class="-4603896956067102557" onmouseenter="enter('-4603896956067102557');" onmouseout="out('-4603896956067102557');" style=""><abbr title=" 141                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 141                 parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupBy🔵</abbr></span>
<span class="-4077767015718338016" onmouseenter="enter('-4077767015718338016');" onmouseout="out('-4077767015718338016');" style=""><abbr title=" 142                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 142                 parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupB🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 143                 break;                                                                                   </span>
<span class="9103487536272409028" onmouseenter="enter('9103487536272409028');" onmouseout="out('9103487536272409028');" style=""> 144             case ORDER_BY :                                                                              </span>
<span class="-6096761147743361957" onmouseenter="enter('-6096761147743361957');" onmouseout="out('-6096761147743361957');" style=""> 145                 SqlOrderBy sqlOrderBy = ((SqlOrderBy) (sqlNode));                                        </span>
<span class="5885804299572217205" onmouseenter="enter('5885804299572217205');" onmouseout="out('5885804299572217205');" style=""><abbr title=" 146                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 146                 parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parent🔵</abbr></span>
<span  style=""> 147                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 148 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-2988899114509087250" onmouseenter="enter('-2988899114509087250');" onmouseout="out('-2988899114509087250');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 149             case LITERAL:                                                                                </span>
<span class="2819024748306122432" onmouseenter="enter('2819024748306122432');" onmouseout="out('2819024748306122432');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150                 return LITERAL.toString();                                                               </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 151 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 152 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 152 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 153 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                                                                                                          </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                 break;                                                                                   </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 157 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span  style=""> 158                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 160         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="-649401327769177886" onmouseenter="enter('-649401327769177886');" onmouseout="out('-649401327769177886');" style=""> 163     public void setLocalTableCache(Map&lt;String, Table&gt; localTableCache) {                                 </span>
<span class="-1916936159945030154" onmouseenter="enter('-1916936159945030154');" onmouseout="out('-1916936159945030154');" style=""> 164         this.localTableCache = localTableCache;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166 }                                                                                                        </span>












































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.parser.FlinkPlanner;                                                                 </span>
<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  25  import com.dtstack.flink.sql.util.TableUtils;                                                                     </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.google.common.base.Preconditions;                                                                      </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  28  import com.google.common.collect.Maps;                                                                            </span>
<span class="1397139485218690137" onmouseenter="enter('1397139485218690137');" onmouseout="out('1397139485218690137');" style="">  29  import com.google.common.collect.Queues;                                                                          </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  30  import com.google.common.collect.Sets;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  33  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="5864552825243215550" onmouseenter="enter('5864552825243215550');" onmouseout="out('5864552825243215550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.calcite.sql.SqlBinaryOperator;                                                                  </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  36  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  37  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  38  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  39  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  41  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  42  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  44  import org.apache.calcite.sql.SqlOrderBy;                                                                         </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  45  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="-8823326795697214951" onmouseenter="enter('-8823326795697214951');" onmouseout="out('-8823326795697214951');" style="">  46  import org.apache.calcite.sql.SqlWith;                                                                            </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  47  import org.apache.calcite.sql.SqlWithItem;                                                                        </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="5604125466397600003" onmouseenter="enter('5604125466397600003');" onmouseout="out('5604125466397600003');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.apache.calcite.sql.fun.SqlStdOperatorTable;                                                            </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  50  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="1277226550340008522" onmouseenter="enter('1277226550340008522');" onmouseout="out('1277226550340008522');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.apache.calcite.sql.parser.SqlParser;                                                                   </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  55  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  56  import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  58  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  59  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  60                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  62  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  63  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  64  import java.util.Set;                                                                                             </span>
<span  style="">  65                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  66  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>

<span  style="">  67                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68  /**                                                                                                               </span>
<span class="7605977213454941184" onmouseenter="enter('7605977213454941184');" onmouseout="out('7605977213454941184');" style="">  69   * Parsing sql, obtain execution information dimension table                                                      </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  70   * Date: 2018/7/24                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  71   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  72   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73   */                                                                                                               </span>
<span  style="">  74                                                                                                                    </span>
<span class="3966585742332796558" onmouseenter="enter('3966585742332796558');" onmouseout="out('3966585742332796558');" style="">  75  public class SideSQLParser {                                                                                      </span>
<span class="-77182390841532482" onmouseenter="enter('-77182390841532482');" onmouseout="out('-77182390841532482');" style="">  76      private static final Logger LOG = LoggerFactory.getLogger(SideSQLParser.class);                               </span>
<span  style="">  77                                                                                                                    </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  78      private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                               </span>
<span  style="">  79                                                                                                                    </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="">  80      public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException {          </span>
<span class="-554334491296517619" onmouseenter="enter('-554334491296517619');" onmouseout="out('-554334491296517619');" style="">  81          System.out.println(&quot;----------exec original Sql----------&quot;);                                              </span>
<span class="6408637245030246244" onmouseenter="enter('6408637245030246244');" onmouseout="out('6408637245030246244');" style="">  82          System.out.println(exeSql);                                                                               </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="">  83          LOG.info(&quot;----------exec original Sql----------&quot;);                                                        </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="">  84          LOG.info(exeSql);                                                                                         </span>
<span  style="">  85                                                                                                                    </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="">  86          Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                                </span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -        SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                           </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -        SqlNode sqlNode = sqlParser.parseStmt();                                                                  </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +        FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                           </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +        SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="-4481737674185385602" onmouseenter="enter('-4481737674185385602');" onmouseout="out('-4481737674185385602');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -        parseSql(sqlNode, sideTableSet, queueInfo, null, null);                                                   </span>
<span class="-9041946153418018780" onmouseenter="enter('-9041946153418018780');" onmouseout="out('-9041946153418018780');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +        parseSql(sqlNode, sideTableSet, queueInfo, null, null, null);                                             </span>
<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="">  94          queueInfo.offer(sqlNode);                                                                                 </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="">  95          return queueInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -    private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                            </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -        SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -        switch (sqlKind) {                                                                                        </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -            case WITH: {                                                                                          </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -                SqlWith sqlWith = (SqlWith) sqlNode;                                                              </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -                SqlNodeList sqlNodeList = sqlWith.withList;                                                       </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                for (SqlNode withAsTable : sqlNodeList) {                                                         </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -                    SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                          </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -                    checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -                }                                                                                                 </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -            }                                                                                                     </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -            case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -                break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -            case SELECT:                                                                                          </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                                </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -                if (sqlFrom.getKind() != IDENTIFIER) {                                                            </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -                    checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -                }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -                break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -            case JOIN:                                                                                            </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -                break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -            case AS:                                                                                              </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -                SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                         </span>
<span class="-229949194999608234" onmouseenter="enter('-229949194999608234');" onmouseout="out('-229949194999608234');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -                if (info.getKind() != IDENTIFIER) {                                                               </span>
<span class="-2361038023640716409" onmouseenter="enter('-2361038023640716409');" onmouseout="out('-2361038023640716409');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -                    checkAndReplaceMultiJoin(info, sideTableSet);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -                }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -                break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -            case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -                SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="-5768150706489513615" onmouseenter="enter('-5768150706489513615');" onmouseout="out('-5768150706489513615');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -                checkAndReplaceMultiJoin(unionLeft, sideTableSet);                                                </span>
<span class="-5564097610588924091" onmouseenter="enter('-5564097610588924091');" onmouseout="out('-5564097610588924091');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -                checkAndReplaceMultiJoin(unionRight, sideTableSet);                                               </span>


<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -    }                                                                                                             </span>
<span  style=""> 138                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -                                                                                                                  </span>
<span class="-7241353614519909745" onmouseenter="enter('-7241353614519909745');" onmouseout="out('-7241353614519909745');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 140 -    public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode parentWhere, SqlNodeList parentSelectList){"> 140 -    public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode parentWhere🔵</abbr></span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +    /**                                                                                                           </span>
<span class="-3708169461439447854" onmouseenter="enter('-3708169461439447854');" onmouseout="out('-3708169461439447854');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +     *  解析 sql 根据维表 join关系重新组装新的sql                                                                               </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +     * @param sqlNode                                                                                             </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 144 +     * @param sideTableSet                                                                                        </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +     * @param queueInfo                                                                                           </span>
<span class="-2398019711746074784" onmouseenter="enter('-2398019711746074784');" onmouseout="out('-2398019711746074784');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +     * @param parentWhere                                                                                         </span>
<span class="845191212344219041" onmouseenter="enter('845191212344219041');" onmouseout="out('845191212344219041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +     * @param parentSelectList                                                                                    </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +     */                                                                                                           </span>
<span class="-4912114046735086097" onmouseenter="enter('-4912114046735086097');" onmouseout="out('-4912114046735086097');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +    public Object parseSql(SqlNode sqlNode,                                                                       </span>
<span class="-1952250395521254109" onmouseenter="enter('-1952250395521254109');" onmouseout="out('-1952250395521254109');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +                           Set&lt;String&gt; sideTableSet,                                                              </span>
<span class="405358965608327863" onmouseenter="enter('405358965608327863');" onmouseout="out('405358965608327863');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +                           Queue&lt;Object&gt; queueInfo,                                                               </span>
<span class="2199848844813933222" onmouseenter="enter('2199848844813933222');" onmouseout="out('2199848844813933222');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +                           SqlNode parentWhere,                                                                   </span>
<span class="1680427389939842559" onmouseenter="enter('1680427389939842559');" onmouseout="out('1680427389939842559');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +                           SqlNodeList parentSelectList,                                                          </span>
<span class="1233396441588378287" onmouseenter="enter('1233396441588378287');" onmouseout="out('1233396441588378287');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +                           SqlNodeList parentGroupByList){                                                        </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 156          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 157          switch (sqlKind){                                                                                         </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style=""> 158              case WITH: {                                                                                          </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style=""> 159                  SqlWith sqlWith = (SqlWith) sqlNode;                                                              </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style=""> 160                  SqlNodeList sqlNodeList = sqlWith.withList;                                                       </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style=""> 161                  for (SqlNode withAsTable : sqlNodeList) {                                                         </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style=""> 162                      SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                          </span>
<span class="4533386739690098296" onmouseenter="enter('4533386739690098296');" onmouseout="out('4533386739690098296');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -                    parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList);          </span>
<span class="-2137122394942275343" onmouseenter="enter('-2137122394942275343');" onmouseout="out('-2137122394942275343');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 164 +                    parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 164 +                    parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGrou🔵</abbr></span>
<span class="558256818041950127" onmouseenter="enter('558256818041950127');" onmouseout="out('558256818041950127');" style=""> 165                      queueInfo.add(sqlWithItem);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                  }                                                                                                 </span>
<span class="-7080171795890614803" onmouseenter="enter('-7080171795890614803');" onmouseout="out('-7080171795890614803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -                parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList);                   </span>
<span class="3054548125000552946" onmouseenter="enter('3054548125000552946');" onmouseout="out('3054548125000552946');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +                parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);</span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 169                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170              }                                                                                                     </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 171              case INSERT:                                                                                          </span>
<span class="-7853295063534246070" onmouseenter="enter('-7853295063534246070');" onmouseout="out('-7853295063534246070');" style=""> 172                  SqlNode sqlSource = ((SqlInsert)sqlNode).getSource();                                             </span>
<span class="1490272844509046038" onmouseenter="enter('1490272844509046038');" onmouseout="out('1490272844509046038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -                return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList);               </span>
<span class="2601968389209545089" onmouseenter="enter('2601968389209545089');" onmouseout="out('2601968389209545089');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 174 +                return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 174 +                return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByLi🔵</abbr></span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 175              case SELECT:                                                                                          </span>
<span class="-737340637367962148" onmouseenter="enter('-737340637367962148');" onmouseout="out('-737340637367962148');" style=""> 176                  SqlNode sqlFrom = ((SqlSelect)sqlNode).getFrom();                                                 </span>
<span class="-4595996050370151557" onmouseenter="enter('-4595996050370151557');" onmouseout="out('-4595996050370151557');" style=""> 177                  SqlNode sqlWhere = ((SqlSelect)sqlNode).getWhere();                                               </span>
<span class="-6539957329780970839" onmouseenter="enter('-6539957329780970839');" onmouseout="out('-6539957329780970839');" style=""> 178                  SqlNodeList selectList = ((SqlSelect)sqlNode).getSelectList();                                    </span>
<span class="1382610957563429127" onmouseenter="enter('1382610957563429127');" onmouseout="out('1382610957563429127');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +                SqlNodeList groupByList = ((SqlSelect) sqlNode).getGroup();                                       </span>
<span  style=""> 180                                                                                                                    </span>
<span class="-6669062104161423555" onmouseenter="enter('-6669062104161423555');" onmouseout="out('-6669062104161423555');" style=""> 181                  if(sqlFrom.getKind() != IDENTIFIER){                                                              </span>
<span class="3375074650633420626" onmouseenter="enter('3375074650633420626');" onmouseout="out('3375074650633420626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                    Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList);             </span>
<span class="-3530162948571427823" onmouseenter="enter('-3530162948571427823');" onmouseout="out('-3530162948571427823');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +                    Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList, groupByList);</span>
<span class="7802562789325773256" onmouseenter="enter('7802562789325773256');" onmouseout="out('7802562789325773256');" style=""> 184                      if(result instanceof JoinInfo){                                                               </span>
<span class="-8441429291693214923" onmouseenter="enter('-8441429291693214923');" onmouseout="out('-8441429291693214923');" style=""><abbr title=" 185                          return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, queueInfo);"> 185                          return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, que🔵</abbr></span>
<span class="1716266177589910912" onmouseenter="enter('1716266177589910912');" onmouseout="out('1716266177589910912');" style=""> 186                      }else if(result instanceof AliasInfo){                                                        </span>
<span class="-6975694729646816765" onmouseenter="enter('-6975694729646816765');" onmouseout="out('-6975694729646816765');" style=""> 187                          String tableName = ((AliasInfo) result).getName();                                        </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 188                          if(sideTableSet.contains(tableName)){                                                     </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 189                              throw new RuntimeException(&quot;side-table must be used in join operator&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                      }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 192                  }else{                                                                                            </span>
<span class="1420748888812461485" onmouseenter="enter('1420748888812461485');" onmouseout="out('1420748888812461485');" style=""> 193                      String tableName = ((SqlIdentifier)sqlFrom).getSimple();                                      </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 194                      if(sideTableSet.contains(tableName)){                                                         </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 195                          throw new RuntimeException(&quot;side-table must be used in join operator&quot;);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 198                  break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 199              case JOIN:                                                                                            </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style=""> 200                  JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                         </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style=""> 201                  Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                                     </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style=""> 202                  Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                                 </span>
<span class="-3780372464013354713" onmouseenter="enter('-3780372464013354713');" onmouseout="out('-3780372464013354713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 203 -                return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWhere, parentSelectList, joinFieldSet, tableRef);"> 203 -                return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWhere, parent🔵</abbr></span>
<span class="-6306168579289105112" onmouseenter="enter('-6306168579289105112');" onmouseout="out('-6306168579289105112');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 204 +                Map&lt;String, String&gt; fieldRef = Maps.newHashMap();                                                 </span>
<span class="-1512934165488206441" onmouseenter="enter('-1512934165488206441');" onmouseout="out('-1512934165488206441');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 205 +                return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo,                    </span>
<span class="8113418629148402447" onmouseenter="enter('8113418629148402447');" onmouseout="out('8113418629148402447');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 206 +                        parentWhere, parentSelectList, parentGroupByList, joinFieldSet, tableRef, fieldRef);      </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 207              case AS:                                                                                              </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 208                  SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                          </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 209                  SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                        </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style=""> 210                  String infoStr = &quot;&quot;;                                                                              </span>
<span  style=""> 211                                                                                                                    </span>
<span class="2126841880433088777" onmouseenter="enter('2126841880433088777');" onmouseout="out('2126841880433088777');" style=""> 212                  if(info.getKind() == IDENTIFIER){                                                                 </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style=""> 213                      infoStr = info.toString();                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 214                  } else {                                                                                          </span>
<span class="-6819509038307231597" onmouseenter="enter('-6819509038307231597');" onmouseout="out('-6819509038307231597');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -                    infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList).toString();  </span>
<span class="3298089944558441209" onmouseenter="enter('3298089944558441209');" onmouseout="out('3298089944558441209');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 216 +                    infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList).toString();"> 216 +                    infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupBy🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217                  }                                                                                                 </span>
<span  style=""> 218                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 219                  AliasInfo aliasInfo = new AliasInfo();                                                            </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 220                  aliasInfo.setName(infoStr);                                                                       </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 221                  aliasInfo.setAlias(alias.toString());                                                             </span>
<span  style=""> 222                                                                                                                    </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 223                  return aliasInfo;                                                                                 </span>
<span  style=""> 224                                                                                                                    </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 225              case UNION:                                                                                           </span>
<span class="-7477725012703906871" onmouseenter="enter('-7477725012703906871');" onmouseout="out('-7477725012703906871');" style=""> 226                  SqlNode unionLeft = ((SqlBasicCall)sqlNode).getOperands()[0];                                     </span>
<span class="-368480979530163649" onmouseenter="enter('-368480979530163649');" onmouseout="out('-368480979530163649');" style=""> 227                  SqlNode unionRight = ((SqlBasicCall)sqlNode).getOperands()[1];                                    </span>
<span  style=""> 228                                                                                                                    </span>
<span class="-2764214125031309434" onmouseenter="enter('-2764214125031309434');" onmouseout="out('-2764214125031309434');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -                parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList);                      </span>
<span class="-2650848251537242185" onmouseenter="enter('-2650848251537242185');" onmouseout="out('-2650848251537242185');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -                parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList);                     </span>
<span class="-4603896956067102557" onmouseenter="enter('-4603896956067102557');" onmouseout="out('-4603896956067102557');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +                parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);   </span>
<span class="-4077767015718338016" onmouseenter="enter('-4077767015718338016');" onmouseout="out('-4077767015718338016');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +                parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 233                  break;                                                                                            </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style=""> 234              case ORDER_BY:                                                                                        </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style=""> 235                  SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                                    </span>
<span class="3263473097860657554" onmouseenter="enter('3263473097860657554');" onmouseout="out('3263473097860657554');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -                parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList);               </span>
<span class="5885804299572217205" onmouseenter="enter('5885804299572217205');" onmouseout="out('5885804299572217205');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 237 +                parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByList);"> 237 +                parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList, parentGroupByLi🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 238 +                                                                                                                  </span>
<span class="-2988899114509087250" onmouseenter="enter('-2988899114509087250');" onmouseout="out('-2988899114509087250');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 239 +            case LITERAL:                                                                                         </span>
<span class="2819024748306122432" onmouseenter="enter('2819024748306122432');" onmouseout="out('2819024748306122432');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +                return LITERAL.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 242          return &quot;&quot;;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243      }                                                                                                             </span>
<span  style=""> 244                                                                                                                    </span>
<span class="-3361988895926806997" onmouseenter="enter('-3361988895926806997');" onmouseout="out('-3361988895926806997');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -    private AliasInfo getSqlNodeAliasInfo(SqlNode sqlNode) {                                                      </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -        SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                                 </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -        SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                                </span>
<span class="534569958050737478" onmouseenter="enter('534569958050737478');" onmouseout="out('534569958050737478');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -        String infoStr = info.getKind() == IDENTIFIER ? info.toString() : null;                                   </span>
<span  style=""> 249                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -        AliasInfo aliasInfo = new AliasInfo();                                                                    </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -        aliasInfo.setName(infoStr);                                                                               </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -        aliasInfo.setAlias(alias.toString());                                                                     </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -        return aliasInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -    /**                                                                                                           </span>
<span class="-1139228218977736129" onmouseenter="enter('-1139228218977736129');" onmouseout="out('-1139228218977736129');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -     * 将和维表关联的join 替换为一个新的查询                                                                                      </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -     * @param sqlNode                                                                                             </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -     * @param sideTableSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -     */                                                                                                           </span>
<span class="-3153036608593848162" onmouseenter="enter('-3153036608593848162');" onmouseout="out('-3153036608593848162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -    private void convertSideJoinToNewQuery(SqlJoin sqlNode, Set&lt;String&gt; sideTableSet) {                           </span>
<span class="4316867198876280783" onmouseenter="enter('4316867198876280783');" onmouseout="out('4316867198876280783');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -        checkAndReplaceMultiJoin(sqlNode.getLeft(), sideTableSet);                                                </span>
<span class="-5502991067270630967" onmouseenter="enter('-5502991067270630967');" onmouseout="out('-5502991067270630967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -        checkAndReplaceMultiJoin(sqlNode.getRight(), sideTableSet);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -    }                                                                                                             </span>
<span  style=""> 265                                                                                                                    </span>
<span  style=""> 266                                                                                                                    </span>
<span class="-649401327769177886" onmouseenter="enter('-649401327769177886');" onmouseout="out('-649401327769177886');" style=""> 267      public void setLocalTableCache(Map&lt;String, Table&gt; localTableCache) {                                          </span>
<span class="-1916936159945030154" onmouseenter="enter('-1916936159945030154');" onmouseout="out('-1916936159945030154');" style=""> 268          this.localTableCache = localTableCache;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269      }                                                                                                             </span>
<span  style=""> 270                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="">  23  import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>

<span class="6766772234276428268" onmouseenter="enter('6766772234276428268');" onmouseout="out('6766772234276428268');" style="">  24  import com.dtstack.flink.sql.util.TableUtils;                                                                     </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.google.common.base.Preconditions;                                                                      </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  27  import com.google.common.collect.Maps;                                                                            </span>
<span class="1397139485218690137" onmouseenter="enter('1397139485218690137');" onmouseout="out('1397139485218690137');" style="">  28  import com.google.common.collect.Queues;                                                                          </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  29  import com.google.common.collect.Sets;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  32  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="5864552825243215550" onmouseenter="enter('5864552825243215550');" onmouseout="out('5864552825243215550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import org.apache.calcite.sql.SqlBinaryOperator;                                                                  </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  35  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  36  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  37  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  38  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  40  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  41  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="-3308206799401099273" onmouseenter="enter('-3308206799401099273');" onmouseout="out('-3308206799401099273');" style="">  43  import org.apache.calcite.sql.SqlOrderBy;                                                                         </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  44  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="-8823326795697214951" onmouseenter="enter('-8823326795697214951');" onmouseout="out('-8823326795697214951');" style="">  45  import org.apache.calcite.sql.SqlWith;                                                                            </span>
<span class="9012576760183743580" onmouseenter="enter('9012576760183743580');" onmouseout="out('9012576760183743580');" style="">  46  import org.apache.calcite.sql.SqlWithItem;                                                                        </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="5604125466397600003" onmouseenter="enter('5604125466397600003');" onmouseout="out('5604125466397600003');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.calcite.sql.fun.SqlStdOperatorTable;                                                            </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  49  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="1277226550340008522" onmouseenter="enter('1277226550340008522');" onmouseout="out('1277226550340008522');" style="">  50  import org.apache.calcite.sql.parser.SqlParser;                                                                   </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  54  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  55  import org.apache.flink.table.api.Table;                                                                          </span>

<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  56  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  57  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  58                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  60  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  61  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  62  import java.util.Set;                                                                                             </span>
<span  style="">  63                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span class="-2521262007515880622" onmouseenter="enter('-2521262007515880622');" onmouseout="out('-2521262007515880622');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +import static org.apache.calcite.sql.SqlKind.IDENTIFIER;                                                          </span>
<span  style="">  66                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  67  /**                                                                                                               </span>
<span class="7605977213454941184" onmouseenter="enter('7605977213454941184');" onmouseout="out('7605977213454941184');" style="">  68   * Parsing sql, obtain execution information dimension table                                                      </span>
<span class="-6082749432478588798" onmouseenter="enter('-6082749432478588798');" onmouseout="out('-6082749432478588798');" style="">  69   * Date: 2018/7/24                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  70   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  71   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  72   */                                                                                                               </span>
<span  style="">  73                                                                                                                    </span>
<span class="3966585742332796558" onmouseenter="enter('3966585742332796558');" onmouseout="out('3966585742332796558');" style="">  74  public class SideSQLParser {                                                                                      </span>
<span class="-77182390841532482" onmouseenter="enter('-77182390841532482');" onmouseout="out('-77182390841532482');" style="">  75      private static final Logger LOG = LoggerFactory.getLogger(SideSQLParser.class);                               </span>
<span  style="">  76                                                                                                                    </span>
<span class="4175687380086503813" onmouseenter="enter('4175687380086503813');" onmouseout="out('4175687380086503813');" style="">  77      private Map&lt;String, Table&gt; localTableCache = Maps.newHashMap();                                               </span>
<span  style="">  78                                                                                                                    </span>
<span class="4228219262260732256" onmouseenter="enter('4228219262260732256');" onmouseout="out('4228219262260732256');" style="">  79      public Queue&lt;Object&gt; getExeQueue(String exeSql, Set&lt;String&gt; sideTableSet) throws SqlParseException {          </span>
<span class="-554334491296517619" onmouseenter="enter('-554334491296517619');" onmouseout="out('-554334491296517619');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -        System.out.println(&quot;----------exec original Sql----------&quot;);                                              </span>
<span class="6408637245030246244" onmouseenter="enter('6408637245030246244');" onmouseout="out('6408637245030246244');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -        System.out.println(exeSql);                                                                               </span>
<span class="-7947557255342642708" onmouseenter="enter('-7947557255342642708');" onmouseout="out('-7947557255342642708');" style="">  82          LOG.info(&quot;----------exec original Sql----------&quot;);                                                        </span>
<span class="1058132582852180835" onmouseenter="enter('1058132582852180835');" onmouseout="out('1058132582852180835');" style="">  83          LOG.info(exeSql);                                                                                         </span>
<span  style="">  84                                                                                                                    </span>
<span class="5128011700743018451" onmouseenter="enter('5128011700743018451');" onmouseout="out('5128011700743018451');" style="">  85          Queue&lt;Object&gt; queueInfo = Queues.newLinkedBlockingQueue();                                                </span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="">  86          SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                           </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="">  87          SqlNode sqlNode = sqlParser.parseStmt();                                                                  </span>


<span  style="">  88                                                                                                                    </span>
<span class="-4481737674185385602" onmouseenter="enter('-4481737674185385602');" onmouseout="out('-4481737674185385602');" style="">  89          parseSql(sqlNode, sideTableSet, queueInfo, null, null);                                                   </span>

<span class="2886026929410252587" onmouseenter="enter('2886026929410252587');" onmouseout="out('2886026929410252587');" style="">  90          queueInfo.offer(sqlNode);                                                                                 </span>
<span class="-7280577500312652584" onmouseenter="enter('-7280577500312652584');" onmouseout="out('-7280577500312652584');" style="">  91          return queueInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92      }                                                                                                             </span>
<span  style="">  93                                                                                                                    </span>
<span class="-7375699729930855386" onmouseenter="enter('-7375699729930855386');" onmouseout="out('-7375699729930855386');" style="">  94      private void checkAndReplaceMultiJoin(SqlNode sqlNode, Set&lt;String&gt; sideTableSet) {                            </span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  95          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  96          switch (sqlKind) {                                                                                        </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style="">  97              case WITH: {                                                                                          </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style="">  98                  SqlWith sqlWith = (SqlWith) sqlNode;                                                              </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style="">  99                  SqlNodeList sqlNodeList = sqlWith.withList;                                                       </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style=""> 100                  for (SqlNode withAsTable : sqlNodeList) {                                                         </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style=""> 101                      SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                          </span>
<span class="7312131524409335821" onmouseenter="enter('7312131524409335821');" onmouseout="out('7312131524409335821');" style=""> 102                      checkAndReplaceMultiJoin(sqlWithItem.query, sideTableSet);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103                  }                                                                                                 </span>
<span class="-5538640999525809718" onmouseenter="enter('-5538640999525809718');" onmouseout="out('-5538640999525809718');" style=""> 104                  checkAndReplaceMultiJoin(sqlWith.body, sideTableSet);                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 105                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106              }                                                                                                     </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 107              case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style=""> 108                  SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="7734614791008547756" onmouseenter="enter('7734614791008547756');" onmouseout="out('7734614791008547756');" style=""> 109                  checkAndReplaceMultiJoin(sqlSource, sideTableSet);                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 110                  break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 111              case SELECT:                                                                                          </span>
<span class="-4229800989062838511" onmouseenter="enter('-4229800989062838511');" onmouseout="out('-4229800989062838511');" style=""> 112                  SqlNode sqlFrom = ((SqlSelect) sqlNode).getFrom();                                                </span>
<span class="5209906327995996306" onmouseenter="enter('5209906327995996306');" onmouseout="out('5209906327995996306');" style=""> 113                  if (sqlFrom.getKind() != IDENTIFIER) {                                                            </span>
<span class="-4185264907666703664" onmouseenter="enter('-4185264907666703664');" onmouseout="out('-4185264907666703664');" style=""> 114                      checkAndReplaceMultiJoin(sqlFrom, sideTableSet);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 116                  break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 117              case JOIN:                                                                                            </span>
<span class="8849571889894911787" onmouseenter="enter('8849571889894911787');" onmouseout="out('8849571889894911787');" style=""> 118                  convertSideJoinToNewQuery((SqlJoin) sqlNode, sideTableSet);                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 119                  break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 120              case AS:                                                                                              </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style=""> 121                  SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                         </span>
<span class="-229949194999608234" onmouseenter="enter('-229949194999608234');" onmouseout="out('-229949194999608234');" style=""> 122                  if (info.getKind() != IDENTIFIER) {                                                               </span>
<span class="-2361038023640716409" onmouseenter="enter('-2361038023640716409');" onmouseout="out('-2361038023640716409');" style=""> 123                      checkAndReplaceMultiJoin(info, sideTableSet);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 125                  break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 126              case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 127                  SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 128                  SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="-5768150706489513615" onmouseenter="enter('-5768150706489513615');" onmouseout="out('-5768150706489513615');" style=""> 129                  checkAndReplaceMultiJoin(unionLeft, sideTableSet);                                                </span>
<span class="-5564097610588924091" onmouseenter="enter('-5564097610588924091');" onmouseout="out('-5564097610588924091');" style=""> 130                  checkAndReplaceMultiJoin(unionRight, sideTableSet);                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                break;                                                                                            </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 133                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135      }                                                                                                             </span>
<span  style=""> 136                                                                                                                    </span>
<span  style=""> 137                                                                                                                    </span>
<span class="-7241353614519909745" onmouseenter="enter('-7241353614519909745');" onmouseout="out('-7241353614519909745');" style=""><abbr title=" 138      public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode parentWhere, SqlNodeList parentSelectList){"> 138      public Object parseSql(SqlNode sqlNode, Set&lt;String&gt; sideTableSet, Queue&lt;Object&gt; queueInfo, SqlNode parentWhere🔵</abbr></span>















<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style=""> 139          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 140          switch (sqlKind){                                                                                         </span>
<span class="-4895776563178477738" onmouseenter="enter('-4895776563178477738');" onmouseout="out('-4895776563178477738');" style=""> 141              case WITH: {                                                                                          </span>
<span class="1074402989354786172" onmouseenter="enter('1074402989354786172');" onmouseout="out('1074402989354786172');" style=""> 142                  SqlWith sqlWith = (SqlWith) sqlNode;                                                              </span>
<span class="1112510853537726574" onmouseenter="enter('1112510853537726574');" onmouseout="out('1112510853537726574');" style=""> 143                  SqlNodeList sqlNodeList = sqlWith.withList;                                                       </span>
<span class="5898329184559807321" onmouseenter="enter('5898329184559807321');" onmouseout="out('5898329184559807321');" style=""> 144                  for (SqlNode withAsTable : sqlNodeList) {                                                         </span>
<span class="5054103522612994093" onmouseenter="enter('5054103522612994093');" onmouseout="out('5054103522612994093');" style=""> 145                      SqlWithItem sqlWithItem = (SqlWithItem) withAsTable;                                          </span>
<span class="4533386739690098296" onmouseenter="enter('4533386739690098296');" onmouseout="out('4533386739690098296');" style=""> 146                      parseSql(sqlWithItem.query, sideTableSet, queueInfo, parentWhere, parentSelectList);          </span>

<span class="558256818041950127" onmouseenter="enter('558256818041950127');" onmouseout="out('558256818041950127');" style=""> 147                      queueInfo.add(sqlWithItem);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148                  }                                                                                                 </span>
<span class="-7080171795890614803" onmouseenter="enter('-7080171795890614803');" onmouseout="out('-7080171795890614803');" style=""> 149                  parseSql(sqlWith.body, sideTableSet, queueInfo, parentWhere, parentSelectList);                   </span>

<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 150                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151              }                                                                                                     </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style=""> 152              case INSERT:                                                                                          </span>
<span class="-7853295063534246070" onmouseenter="enter('-7853295063534246070');" onmouseout="out('-7853295063534246070');" style=""> 153                  SqlNode sqlSource = ((SqlInsert)sqlNode).getSource();                                             </span>
<span class="1490272844509046038" onmouseenter="enter('1490272844509046038');" onmouseout="out('1490272844509046038');" style=""> 154                  return parseSql(sqlSource, sideTableSet, queueInfo, parentWhere, parentSelectList);               </span>

<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 155              case SELECT:                                                                                          </span>
<span class="-737340637367962148" onmouseenter="enter('-737340637367962148');" onmouseout="out('-737340637367962148');" style=""> 156                  SqlNode sqlFrom = ((SqlSelect)sqlNode).getFrom();                                                 </span>
<span class="-4595996050370151557" onmouseenter="enter('-4595996050370151557');" onmouseout="out('-4595996050370151557');" style=""> 157                  SqlNode sqlWhere = ((SqlSelect)sqlNode).getWhere();                                               </span>
<span class="-6539957329780970839" onmouseenter="enter('-6539957329780970839');" onmouseout="out('-6539957329780970839');" style=""> 158                  SqlNodeList selectList = ((SqlSelect)sqlNode).getSelectList();                                    </span>

<span  style=""> 159                                                                                                                    </span>
<span class="-6669062104161423555" onmouseenter="enter('-6669062104161423555');" onmouseout="out('-6669062104161423555');" style=""> 160                  if(sqlFrom.getKind() != IDENTIFIER){                                                              </span>
<span class="3375074650633420626" onmouseenter="enter('3375074650633420626');" onmouseout="out('3375074650633420626');" style=""> 161                      Object result = parseSql(sqlFrom, sideTableSet, queueInfo, sqlWhere, selectList);             </span>

<span class="7802562789325773256" onmouseenter="enter('7802562789325773256');" onmouseout="out('7802562789325773256');" style=""> 162                      if(result instanceof JoinInfo){                                                               </span>
<span class="-8441429291693214923" onmouseenter="enter('-8441429291693214923');" onmouseout="out('-8441429291693214923');" style=""><abbr title=" 163                          return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, queueInfo);"> 163                          return TableUtils.dealSelectResultWithJoinInfo((JoinInfo) result, (SqlSelect) sqlNode, que🔵</abbr></span>
<span class="1716266177589910912" onmouseenter="enter('1716266177589910912');" onmouseout="out('1716266177589910912');" style=""> 164                      }else if(result instanceof AliasInfo){                                                        </span>
<span class="-6975694729646816765" onmouseenter="enter('-6975694729646816765');" onmouseout="out('-6975694729646816765');" style=""> 165                          String tableName = ((AliasInfo) result).getName();                                        </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 166                          if(sideTableSet.contains(tableName)){                                                     </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 167                              throw new RuntimeException(&quot;side-table must be used in join operator&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169                      }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 170                  }else{                                                                                            </span>
<span class="1420748888812461485" onmouseenter="enter('1420748888812461485');" onmouseout="out('1420748888812461485');" style=""> 171                      String tableName = ((SqlIdentifier)sqlFrom).getSimple();                                      </span>
<span class="23740069362058607" onmouseenter="enter('23740069362058607');" onmouseout="out('23740069362058607');" style=""> 172                      if(sideTableSet.contains(tableName)){                                                         </span>
<span class="-1760230060361710630" onmouseenter="enter('-1760230060361710630');" onmouseout="out('-1760230060361710630');" style=""> 173                          throw new RuntimeException(&quot;side-table must be used in join operator&quot;);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 176                  break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 177              case JOIN:                                                                                            </span>
<span class="-3111758306527220061" onmouseenter="enter('-3111758306527220061');" onmouseout="out('-3111758306527220061');" style=""> 178                  JoinNodeDealer joinNodeDealer = new JoinNodeDealer(this);                                         </span>
<span class="9078002366390414240" onmouseenter="enter('9078002366390414240');" onmouseout="out('9078002366390414240');" style=""> 179                  Set&lt;Tuple2&lt;String, String&gt;&gt; joinFieldSet = Sets.newHashSet();                                     </span>
<span class="1100449665231490148" onmouseenter="enter('1100449665231490148');" onmouseout="out('1100449665231490148');" style=""> 180                  Map&lt;String, String&gt; tableRef = Maps.newHashMap();                                                 </span>
<span class="-3780372464013354713" onmouseenter="enter('-3780372464013354713');" onmouseout="out('-3780372464013354713');" style=""><abbr title=" 181                  return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWhere, parentSelectList, joinFieldSet, tableRef);"> 181                  return joinNodeDealer.dealJoinNode((SqlJoin) sqlNode, sideTableSet, queueInfo, parentWhere, parent🔵</abbr></span>



<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 182              case AS:                                                                                              </span>
<span class="-4085054753182131209" onmouseenter="enter('-4085054753182131209');" onmouseout="out('-4085054753182131209');" style=""> 183                  SqlNode info = ((SqlBasicCall)sqlNode).getOperands()[0];                                          </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 184                  SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                        </span>
<span class="-7314337242875568781" onmouseenter="enter('-7314337242875568781');" onmouseout="out('-7314337242875568781');" style=""> 185                  String infoStr = &quot;&quot;;                                                                              </span>
<span  style=""> 186                                                                                                                    </span>
<span class="2126841880433088777" onmouseenter="enter('2126841880433088777');" onmouseout="out('2126841880433088777');" style=""> 187                  if(info.getKind() == IDENTIFIER){                                                                 </span>
<span class="-6527219795850644409" onmouseenter="enter('-6527219795850644409');" onmouseout="out('-6527219795850644409');" style=""> 188                      infoStr = info.toString();                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 189                  } else {                                                                                          </span>
<span class="-6819509038307231597" onmouseenter="enter('-6819509038307231597');" onmouseout="out('-6819509038307231597');" style=""> 190                      infoStr = parseSql(info, sideTableSet, queueInfo, parentWhere, parentSelectList).toString();  </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                  }                                                                                                 </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 193                  AliasInfo aliasInfo = new AliasInfo();                                                            </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 194                  aliasInfo.setName(infoStr);                                                                       </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 195                  aliasInfo.setAlias(alias.toString());                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 197                  return aliasInfo;                                                                                 </span>
<span  style=""> 198                                                                                                                    </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 199              case UNION:                                                                                           </span>
<span class="-7477725012703906871" onmouseenter="enter('-7477725012703906871');" onmouseout="out('-7477725012703906871');" style=""> 200                  SqlNode unionLeft = ((SqlBasicCall)sqlNode).getOperands()[0];                                     </span>
<span class="-368480979530163649" onmouseenter="enter('-368480979530163649');" onmouseout="out('-368480979530163649');" style=""> 201                  SqlNode unionRight = ((SqlBasicCall)sqlNode).getOperands()[1];                                    </span>
<span  style=""> 202                                                                                                                    </span>
<span class="-2764214125031309434" onmouseenter="enter('-2764214125031309434');" onmouseout="out('-2764214125031309434');" style=""> 203                  parseSql(unionLeft, sideTableSet, queueInfo, parentWhere, parentSelectList);                      </span>
<span class="-2650848251537242185" onmouseenter="enter('-2650848251537242185');" onmouseout="out('-2650848251537242185');" style=""> 204                  parseSql(unionRight, sideTableSet, queueInfo, parentWhere, parentSelectList);                     </span>


<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 205                  break;                                                                                            </span>
<span class="9033815331900391172" onmouseenter="enter('9033815331900391172');" onmouseout="out('9033815331900391172');" style=""> 206              case ORDER_BY:                                                                                        </span>
<span class="3723185693474391186" onmouseenter="enter('3723185693474391186');" onmouseout="out('3723185693474391186');" style=""> 207                  SqlOrderBy sqlOrderBy  = (SqlOrderBy) sqlNode;                                                    </span>
<span class="3263473097860657554" onmouseenter="enter('3263473097860657554');" onmouseout="out('3263473097860657554');" style=""> 208                  parseSql(sqlOrderBy.query, sideTableSet, queueInfo, parentWhere, parentSelectList);               </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 209 +            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +                break;                                                                                            </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211          }                                                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 212          return &quot;&quot;;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213      }                                                                                                             </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-3361988895926806997" onmouseenter="enter('-3361988895926806997');" onmouseout="out('-3361988895926806997');" style=""> 215      private AliasInfo getSqlNodeAliasInfo(SqlNode sqlNode) {                                                      </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style=""> 216          SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                                 </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style=""> 217          SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                                </span>
<span class="534569958050737478" onmouseenter="enter('534569958050737478');" onmouseout="out('534569958050737478');" style=""> 218          String infoStr = info.getKind() == IDENTIFIER ? info.toString() : null;                                   </span>
<span  style=""> 219                                                                                                                    </span>
<span class="-2458625767668584085" onmouseenter="enter('-2458625767668584085');" onmouseout="out('-2458625767668584085');" style=""> 220          AliasInfo aliasInfo = new AliasInfo();                                                                    </span>
<span class="-6330277266292138558" onmouseenter="enter('-6330277266292138558');" onmouseout="out('-6330277266292138558');" style=""> 221          aliasInfo.setName(infoStr);                                                                               </span>
<span class="-6584143955119724642" onmouseenter="enter('-6584143955119724642');" onmouseout="out('-6584143955119724642');" style=""> 222          aliasInfo.setAlias(alias.toString());                                                                     </span>
<span class="-3107000398971930583" onmouseenter="enter('-3107000398971930583');" onmouseout="out('-3107000398971930583');" style=""> 223          return aliasInfo;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224      }                                                                                                             </span>
<span  style=""> 225                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 226      /**                                                                                                           </span>
<span class="-1139228218977736129" onmouseenter="enter('-1139228218977736129');" onmouseout="out('-1139228218977736129');" style=""> 227       * 将和维表关联的join 替换为一个新的查询                                                                                      </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 228       * @param sqlNode                                                                                             </span>
<span class="-8651210754005562825" onmouseenter="enter('-8651210754005562825');" onmouseout="out('-8651210754005562825');" style=""> 229       * @param sideTableSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 230       */                                                                                                           </span>
<span class="-3153036608593848162" onmouseenter="enter('-3153036608593848162');" onmouseout="out('-3153036608593848162');" style=""> 231      private void convertSideJoinToNewQuery(SqlJoin sqlNode, Set&lt;String&gt; sideTableSet) {                           </span>
<span class="4316867198876280783" onmouseenter="enter('4316867198876280783');" onmouseout="out('4316867198876280783');" style=""> 232          checkAndReplaceMultiJoin(sqlNode.getLeft(), sideTableSet);                                                </span>
<span class="-5502991067270630967" onmouseenter="enter('-5502991067270630967');" onmouseout="out('-5502991067270630967');" style=""> 233          checkAndReplaceMultiJoin(sqlNode.getRight(), sideTableSet);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234      }                                                                                                             </span>
<span  style=""> 235                                                                                                                    </span>
<span  style=""> 236                                                                                                                    </span>
<span class="-649401327769177886" onmouseenter="enter('-649401327769177886');" onmouseout="out('-649401327769177886');" style=""> 237      public void setLocalTableCache(Map&lt;String, Table&gt; localTableCache) {                                          </span>
<span class="-1916936159945030154" onmouseenter="enter('-1916936159945030154');" onmouseout="out('-1916936159945030154');" style=""> 238          this.localTableCache = localTableCache;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239      }                                                                                                             </span>
<span  style=""> 240                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            