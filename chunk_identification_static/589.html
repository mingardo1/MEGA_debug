<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>589</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    589
                    <a href="588.html">prev</a>
                    <a href="590.html">next</a>
                    <a href="589_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b43aec0679d705647015fd4416ad6dc326ea7890_core/src/main/java/com/dtstack/flink/sql/side/SidePredicatesParser.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890:core/src/main/java/com/dtstack/flink/sql/side/SidePredicatesParser.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^1:core/src/main/java/com/dtstack/flink/sql/side/SidePredicatesParser.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b43aec0679d705647015fd4416ad6dc326ea7890^2:core/src/main/java/com/dtstack/flink/sql/side/SidePredicatesParser.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6159bb9bb9904f950c489b50fb7dcbe399c3d327:core/src/main/java/com/dtstack/flink/sql/side/SidePredicatesParser.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  19 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  20                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  21 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  22 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  23 import com.google.common.collect.Maps;                                                                   </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  24 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  25 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  26 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  27 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  28 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  29 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  30 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  31 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  32 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  33 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span  style="">  34                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  35 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  36 import java.util.Map;                                                                                    </span>
<span  style="">  37                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  38 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  39                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  41  *                                                                                                       </span>
<span class="8689868297768661973" onmouseenter="enter('8689868297768661973');" onmouseout="out('8689868297768661973');" style="">  42  *  将同级谓词信息填充到维表                                                                                         </span>
<span class="-7294136002415509658" onmouseenter="enter('-7294136002415509658');" onmouseout="out('-7294136002415509658');" style="">  43  * Date: 2019/12/11                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  44  * Company: www.dtstack.com                                                                              </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  45  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  46  */                                                                                                      </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="">  47 public class SidePredicatesParser {                                                                      </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  48 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  49     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  49     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws🔵</abbr></span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  52 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 public class SidePredicatesParser {                                                                      </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  54     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  54     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws🔵</abbr></span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55         SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                  </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  56 =======                                                                                                  </span>
<span class="8914128835654641108" onmouseenter="enter('8914128835654641108');" onmouseout="out('8914128835654641108');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  57     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) throws SqlParseException {">  57     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap🔵</abbr></span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58         SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                  </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59         SqlNode sqlNode = sqlParser.parseStmt();                                                         </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  60 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-6218725010169197996" onmouseenter="enter('-6218725010169197996');" onmouseout="out('-6218725010169197996');" style="">  61         parseSql(sqlNode, sideTableMap, Maps.newHashMap());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62     }                                                                                                    </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64     /**                                                                                                  </span>
<span class="-8938943915718346409" onmouseenter="enter('-8938943915718346409');" onmouseout="out('-8938943915718346409');" style="">  65      *  将谓词信息填充到维表属性                                                                                     </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  66      * @param sqlNode                                                                                    </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="">  67      * @param sideTableMap                                                                               </span>
<span class="5326707071817488305" onmouseenter="enter('5326707071817488305');" onmouseout="out('5326707071817488305');" style="">  68      * @param tabMapping  谓词属性中别名对应的真实维表名称                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69      */                                                                                                  </span>
<span class="-350453358075359301" onmouseenter="enter('-350453358075359301');" onmouseout="out('-350453358075359301');" style=""><abbr title="  70     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  70     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, S🔵</abbr></span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  71         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  72         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="">  73             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="">  74                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="-1101454880130282993" onmouseenter="enter('-1101454880130282993');" onmouseout="out('-1101454880130282993');" style="">  75                 parseSql(sqlSource, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  76                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="">  77             case SELECT:                                                                                 </span>
<span class="1662668321521353233" onmouseenter="enter('1662668321521353233');" onmouseout="out('1662668321521353233');" style="">  78                 SqlNode fromNode = ((SqlSelect) sqlNode).getFrom();                                      </span>
<span class="-7381113953409456779" onmouseenter="enter('-7381113953409456779');" onmouseout="out('-7381113953409456779');" style="">  79                 SqlNode whereNode = ((SqlSelect) sqlNode).getWhere();                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="-6304731576216937649" onmouseenter="enter('-6304731576216937649');" onmouseout="out('-6304731576216937649');" style="">  81                 if (fromNode.getKind() != IDENTIFIER) {                                                  </span>
<span class="6082271321132508920" onmouseenter="enter('6082271321132508920');" onmouseout="out('6082271321132508920');" style="">  82                     parseSql(fromNode, sideTableMap, tabMapping);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83                 }                                                                                        </span>
<span class="361899178658135" onmouseenter="enter('361899178658135');" onmouseout="out('361899178658135');" style="">  84                 //  带or的不解析                                                                              </span>
<span class="-450559365930313124" onmouseenter="enter('-450559365930313124');" onmouseout="out('-450559365930313124');" style="">  85                 if (null != whereNode &amp;&amp; whereNode.getKind() != OR) {                                    </span>
<span class="-1868734217058162393" onmouseenter="enter('-1868734217058162393');" onmouseout="out('-1868734217058162393');" style="">  86                     List&lt;PredicateInfo&gt; predicateInfoList = Lists.newArrayList();                        </span>
<span class="-8142164038074458964" onmouseenter="enter('-8142164038074458964');" onmouseout="out('-8142164038074458964');" style="">  87                     extractPredicateInfo(whereNode, predicateInfoList);                                  </span>
<span class="-1800893519042755240" onmouseenter="enter('-1800893519042755240');" onmouseout="out('-1800893519042755240');" style="">  88                     fillToSideTableInfo(sideTableMap, tabMapping, predicateInfoList);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  90                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="">  91             case JOIN:                                                                                   </span>
<span class="3337904632317662883" onmouseenter="enter('3337904632317662883');" onmouseout="out('3337904632317662883');" style="">  92                 SqlNode leftNode = ((SqlJoin) sqlNode).getLeft();                                        </span>
<span class="6174600545483522710" onmouseenter="enter('6174600545483522710');" onmouseout="out('6174600545483522710');" style="">  93                 SqlNode rightNode = ((SqlJoin) sqlNode).getRight();                                      </span>
<span class="3893843580747346079" onmouseenter="enter('3893843580747346079');" onmouseout="out('3893843580747346079');" style="">  94                 parseSql(leftNode, sideTableMap, tabMapping);                                            </span>
<span class="-1550063580510292788" onmouseenter="enter('-1550063580510292788');" onmouseout="out('-1550063580510292788');" style="">  95                 parseSql(rightNode, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  96                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="">  97             case AS:                                                                                     </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="">  98                 SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="">  99                 SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                               </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style=""> 100                 if (info.getKind() == IDENTIFIER) {                                                      </span>
<span class="-6809247708006763533" onmouseenter="enter('-6809247708006763533');" onmouseout="out('-6809247708006763533');" style=""> 101                     tabMapping.put(alias.toString(), info.toString());                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 102                 } else {                                                                                 </span>
<span class="1627725189054467864" onmouseenter="enter('1627725189054467864');" onmouseout="out('1627725189054467864');" style=""> 103                     // 为子查询创建一个同级map                                                                     </span>
<span class="-6730923757280984430" onmouseenter="enter('-6730923757280984430');" onmouseout="out('-6730923757280984430');" style=""> 104                     parseSql(info, sideTableMap, Maps.newHashMap());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 106                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 107             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 108                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 109                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="2983730094677593593" onmouseenter="enter('2983730094677593593');" onmouseout="out('2983730094677593593');" style=""> 110                 parseSql(unionLeft, sideTableMap, tabMapping);                                           </span>
<span class="-682128595120402183" onmouseenter="enter('-682128595120402183');" onmouseout="out('-682128595120402183');" style=""> 111                 parseSql(unionRight, sideTableMap, tabMapping);                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 113             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 114                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-5730717099148913488" onmouseenter="enter('-5730717099148913488');" onmouseout="out('-5730717099148913488');" style=""><abbr title=" 118     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 118     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt;🔵</abbr></span>
<span class="-5143537772085868977" onmouseenter="enter('-5143537772085868977');" onmouseout="out('-5143537772085868977');" style=""><abbr title=" 119         predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())))"> 119         predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.g🔵</abbr></span>
<span class="-878829588541342667" onmouseenter="enter('-878829588541342667');" onmouseout="out('-878829588541342667');" style=""><abbr title=" 120                 .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())).getPredicateInfoes().add(info))"> 120                 .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwner🔵</abbr></span>
<span class="-7281528394716107809" onmouseenter="enter('-7281528394716107809');" onmouseout="out('-7281528394716107809');" style=""> 121                 .count();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span  style=""> 124                                                                                                          </span>
<span class="-6272773481519110694" onmouseenter="enter('-6272773481519110694');" onmouseout="out('-6272773481519110694');" style=""> 125     private void extractPredicateInfo(SqlNode whereNode, List&lt;PredicateInfo&gt; predicatesInfoList) {       </span>
<span class="-1315079444131826039" onmouseenter="enter('-1315079444131826039');" onmouseout="out('-1315079444131826039');" style=""> 126         SqlKind sqlKind = whereNode.getKind();                                                           </span>
<span class="5331611896222785017" onmouseenter="enter('5331611896222785017');" onmouseout="out('5331611896222785017');" style=""> 127         if (sqlKind == SqlKind.AND &amp;&amp; ((SqlBasicCall) whereNode).getOperandList().size() == 2) {         </span>
<span class="-6832131528842420610" onmouseenter="enter('-6832131528842420610');" onmouseout="out('-6832131528842420610');" style=""> 128             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[0], predicatesInfoList);       </span>
<span class="-4853268236633653802" onmouseenter="enter('-4853268236633653802');" onmouseout="out('-4853268236633653802');" style=""> 129             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[1], predicatesInfoList);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 130         } else {                                                                                         </span>
<span class="6338655695570846334" onmouseenter="enter('6338655695570846334');" onmouseout="out('6338655695570846334');" style=""> 131             SqlOperator operator = ((SqlBasicCall) whereNode).getOperator();                             </span>
<span class="6330462445765985009" onmouseenter="enter('6330462445765985009');" onmouseout="out('6330462445765985009');" style=""> 132             String operatorName = operator.getName();                                                    </span>
<span class="-5712206181815162330" onmouseenter="enter('-5712206181815162330');" onmouseout="out('-5712206181815162330');" style=""> 133             SqlKind operatorKind = operator.getKind();                                                   </span>
<span  style=""> 134                                                                                                          </span>
<span class="-3624787404055176751" onmouseenter="enter('-3624787404055176751');" onmouseout="out('-3624787404055176751');" style=""> 135             if (operatorKind == SqlKind.IS_NOT_NULL || operatorKind == SqlKind.IS_NULL) {                </span>
<span class="-8618394030406407904" onmouseenter="enter('-8618394030406407904');" onmouseout="out('-8618394030406407904');" style=""><abbr title=" 136                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 0);"> 136                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 137                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138             }                                                                                            </span>
<span  style=""> 139                                                                                                          </span>
<span class="6827991746517972068" onmouseenter="enter('6827991746517972068');" onmouseout="out('6827991746517972068');" style=""> 140             // 跳过函数                                                                                      </span>
<span class="7033432411623994261" onmouseenter="enter('7033432411623994261');" onmouseout="out('7033432411623994261');" style=""> 141             if ((((SqlBasicCall) whereNode).getOperands()[0] instanceof SqlIdentifier)                   </span>
<span class="4695126583355687281" onmouseenter="enter('4695126583355687281');" onmouseout="out('4695126583355687281');" style=""><abbr title=" 142                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION)) {"> 142                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="1580435819466621331" onmouseenter="enter('1580435819466621331');" onmouseout="out('1580435819466621331');" style=""><abbr title=" 143                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 1);"> 143                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-4379599636634861191" onmouseenter="enter('-4379599636634861191');" onmouseout="out('-4379599636634861191');" style=""> 144             } else if ((((SqlBasicCall) whereNode).getOperands()[1] instanceof SqlIdentifier)            </span>
<span class="4462406844202440903" onmouseenter="enter('4462406844202440903');" onmouseout="out('4462406844202440903');" style=""><abbr title=" 145                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION)) {"> 145                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="6472075389363354698" onmouseenter="enter('6472075389363354698');" onmouseout="out('6472075389363354698');" style=""><abbr title=" 146                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 1, 0);"> 146                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149     }                                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="1912413075341318367" onmouseenter="enter('1912413075341318367');" onmouseout="out('1912413075341318367');" style=""><abbr title=" 151     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String operatorName, SqlKind operatorKind,"> 151     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, 🔵</abbr></span>
<span class="2252308863606392437" onmouseenter="enter('2252308863606392437');" onmouseout="out('2252308863606392437');" style=""> 152                                          int fieldIndex, int conditionIndex) {                           </span>
<span class="-7281485868711016418" onmouseenter="enter('-7281485868711016418');" onmouseout="out('-7281485868711016418');" style=""> 153         SqlIdentifier fieldFullPath = (SqlIdentifier) whereNode.getOperands()[fieldIndex];               </span>
<span class="7203975986175764877" onmouseenter="enter('7203975986175764877');" onmouseout="out('7203975986175764877');" style=""> 154         if (fieldFullPath.names.size() == 2) {                                                           </span>
<span class="-1996143262144281682" onmouseenter="enter('-1996143262144281682');" onmouseout="out('-1996143262144281682');" style=""> 155             String ownerTable = fieldFullPath.names.get(0);                                              </span>
<span class="-8937094567283519424" onmouseenter="enter('-8937094567283519424');" onmouseout="out('-8937094567283519424');" style=""> 156             String fieldName = fieldFullPath.names.get(1);                                               </span>
<span class="-2731393012930882758" onmouseenter="enter('-2731393012930882758');" onmouseout="out('-2731393012930882758');" style=""><abbr title=" 157             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString() + &quot; AND &quot; +"> 157             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].🔵</abbr></span>
<span class="5584033711688284314" onmouseenter="enter('5584033711688284314');" onmouseout="out('5584033711688284314');" style=""><abbr title=" 158                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toString();"> 158                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toStr🔵</abbr></span>
<span  style=""> 159                                                                                                          </span>
<span class="-1206547946994992687" onmouseenter="enter('-1206547946994992687');" onmouseout="out('-1206547946994992687');" style=""><abbr title=" 160             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(operatorKind.toString())"> 160             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperat🔵</abbr></span>
<span class="-7910070237514947571" onmouseenter="enter('-7910070237514947571');" onmouseout="out('-7910070237514947571');" style=""> 161                     .setOwnerTable(ownerTable).setFieldName(fieldName).setCondition(content).build();    </span>
<span class="2100038020113072635" onmouseenter="enter('2100038020113072635');" onmouseout="out('2100038020113072635');" style=""> 162             predicatesInfoList.add(predicateInfo);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164     }                                                                                                    </span>
<span  style=""> 165                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  19 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  20                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  21 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  22 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  23 import com.google.common.collect.Maps;                                                                   </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  24 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  25 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  26 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  27 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  28 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  29 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  30 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  31 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  32 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  33 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span  style="">  34                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  35 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  36 import java.util.Map;                                                                                    </span>
<span  style="">  37                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  38 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  39                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  41  *                                                                                                       </span>
<span class="8689868297768661973" onmouseenter="enter('8689868297768661973');" onmouseout="out('8689868297768661973');" style="">  42  *  将同级谓词信息填充到维表                                                                                         </span>
<span class="-7294136002415509658" onmouseenter="enter('-7294136002415509658');" onmouseout="out('-7294136002415509658');" style="">  43  * Date: 2019/12/11                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  44  * Company: www.dtstack.com                                                                              </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  45  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  46  */                                                                                                      </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="">  47 public class SidePredicatesParser {                                                                      </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  48 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  49 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  49 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws Sql🔵</abbr></span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  52 ||||||| BASE                                                                                             </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  53 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  53 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws Sql🔵</abbr></span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54         SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                  </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55         SqlNode sqlNode = sqlParser.parseStmt();                                                         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  56 =======                                                                                                  </span>
<span class="8914128835654641108" onmouseenter="enter('8914128835654641108');" onmouseout="out('8914128835654641108');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  57 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) throws SqlParseException {">  57 public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) th🔵</abbr></span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58         SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                  </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59         SqlNode sqlNode = sqlParser.parseStmt();                                                         </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  60 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-6218725010169197996" onmouseenter="enter('-6218725010169197996');" onmouseout="out('-6218725010169197996');" style="">  61         parseSql(sqlNode, sideTableMap, Maps.newHashMap());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62     }                                                                                                    </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64     /**                                                                                                  </span>
<span class="-8938943915718346409" onmouseenter="enter('-8938943915718346409');" onmouseout="out('-8938943915718346409');" style="">  65      *  将谓词信息填充到维表属性                                                                                     </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  66      * @param sqlNode                                                                                    </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="">  67      * @param sideTableMap                                                                               </span>
<span class="5326707071817488305" onmouseenter="enter('5326707071817488305');" onmouseout="out('5326707071817488305');" style="">  68      * @param tabMapping  谓词属性中别名对应的真实维表名称                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69      */                                                                                                  </span>
<span class="-350453358075359301" onmouseenter="enter('-350453358075359301');" onmouseout="out('-350453358075359301');" style=""><abbr title="  70     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  70     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, S🔵</abbr></span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  71         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  72         switch (sqlKind) {                                                                               </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="">  73             case INSERT:                                                                                 </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="">  74                 SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                   </span>
<span class="-1101454880130282993" onmouseenter="enter('-1101454880130282993');" onmouseout="out('-1101454880130282993');" style="">  75                 parseSql(sqlSource, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  76                 break;                                                                                   </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="">  77             case SELECT:                                                                                 </span>
<span class="1662668321521353233" onmouseenter="enter('1662668321521353233');" onmouseout="out('1662668321521353233');" style="">  78                 SqlNode fromNode = ((SqlSelect) sqlNode).getFrom();                                      </span>
<span class="-7381113953409456779" onmouseenter="enter('-7381113953409456779');" onmouseout="out('-7381113953409456779');" style="">  79                 SqlNode whereNode = ((SqlSelect) sqlNode).getWhere();                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="-6304731576216937649" onmouseenter="enter('-6304731576216937649');" onmouseout="out('-6304731576216937649');" style="">  81                 if (fromNode.getKind() != IDENTIFIER) {                                                  </span>
<span class="6082271321132508920" onmouseenter="enter('6082271321132508920');" onmouseout="out('6082271321132508920');" style="">  82                     parseSql(fromNode, sideTableMap, tabMapping);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83                 }                                                                                        </span>
<span class="361899178658135" onmouseenter="enter('361899178658135');" onmouseout="out('361899178658135');" style="">  84                 //  带or的不解析                                                                              </span>
<span class="-450559365930313124" onmouseenter="enter('-450559365930313124');" onmouseout="out('-450559365930313124');" style="">  85                 if (null != whereNode &amp;&amp; whereNode.getKind() != OR) {                                    </span>
<span class="-1868734217058162393" onmouseenter="enter('-1868734217058162393');" onmouseout="out('-1868734217058162393');" style="">  86                     List&lt;PredicateInfo&gt; predicateInfoList = Lists.newArrayList();                        </span>
<span class="-8142164038074458964" onmouseenter="enter('-8142164038074458964');" onmouseout="out('-8142164038074458964');" style="">  87                     extractPredicateInfo(whereNode, predicateInfoList);                                  </span>
<span class="-1800893519042755240" onmouseenter="enter('-1800893519042755240');" onmouseout="out('-1800893519042755240');" style="">  88                     fillToSideTableInfo(sideTableMap, tabMapping, predicateInfoList);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  90                 break;                                                                                   </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="">  91             case JOIN:                                                                                   </span>
<span class="3337904632317662883" onmouseenter="enter('3337904632317662883');" onmouseout="out('3337904632317662883');" style="">  92                 SqlNode leftNode = ((SqlJoin) sqlNode).getLeft();                                        </span>
<span class="6174600545483522710" onmouseenter="enter('6174600545483522710');" onmouseout="out('6174600545483522710');" style="">  93                 SqlNode rightNode = ((SqlJoin) sqlNode).getRight();                                      </span>
<span class="3893843580747346079" onmouseenter="enter('3893843580747346079');" onmouseout="out('3893843580747346079');" style="">  94                 parseSql(leftNode, sideTableMap, tabMapping);                                            </span>
<span class="-1550063580510292788" onmouseenter="enter('-1550063580510292788');" onmouseout="out('-1550063580510292788');" style="">  95                 parseSql(rightNode, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  96                 break;                                                                                   </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="">  97             case AS:                                                                                     </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="">  98                 SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="">  99                 SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                               </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style=""> 100                 if (info.getKind() == IDENTIFIER) {                                                      </span>
<span class="-6809247708006763533" onmouseenter="enter('-6809247708006763533');" onmouseout="out('-6809247708006763533');" style=""> 101                     tabMapping.put(alias.toString(), info.toString());                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 102                 } else {                                                                                 </span>
<span class="1627725189054467864" onmouseenter="enter('1627725189054467864');" onmouseout="out('1627725189054467864');" style=""> 103                     // 为子查询创建一个同级map                                                                     </span>
<span class="-6730923757280984430" onmouseenter="enter('-6730923757280984430');" onmouseout="out('-6730923757280984430');" style=""> 104                     parseSql(info, sideTableMap, Maps.newHashMap());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 106                 break;                                                                                   </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 107             case UNION:                                                                                  </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 108                 SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                           </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 109                 SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                          </span>
<span class="2983730094677593593" onmouseenter="enter('2983730094677593593');" onmouseout="out('2983730094677593593');" style=""> 110                 parseSql(unionLeft, sideTableMap, tabMapping);                                           </span>
<span class="-682128595120402183" onmouseenter="enter('-682128595120402183');" onmouseout="out('-682128595120402183');" style=""> 111                 parseSql(unionRight, sideTableMap, tabMapping);                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 113             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 114                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-5730717099148913488" onmouseenter="enter('-5730717099148913488');" onmouseout="out('-5730717099148913488');" style=""><abbr title=" 118     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 118     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt;🔵</abbr></span>
<span class="-5143537772085868977" onmouseenter="enter('-5143537772085868977');" onmouseout="out('-5143537772085868977');" style=""><abbr title=" 119         predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())))"> 119         predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.g🔵</abbr></span>
<span class="-878829588541342667" onmouseenter="enter('-878829588541342667');" onmouseout="out('-878829588541342667');" style=""><abbr title=" 120                 .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())).getPredicateInfoes().add(info))"> 120                 .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwner🔵</abbr></span>
<span class="-7281528394716107809" onmouseenter="enter('-7281528394716107809');" onmouseout="out('-7281528394716107809');" style=""> 121                 .count();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span  style=""> 124                                                                                                          </span>
<span class="-6272773481519110694" onmouseenter="enter('-6272773481519110694');" onmouseout="out('-6272773481519110694');" style=""> 125     private void extractPredicateInfo(SqlNode whereNode, List&lt;PredicateInfo&gt; predicatesInfoList) {       </span>
<span class="-1315079444131826039" onmouseenter="enter('-1315079444131826039');" onmouseout="out('-1315079444131826039');" style=""> 126         SqlKind sqlKind = whereNode.getKind();                                                           </span>
<span class="5331611896222785017" onmouseenter="enter('5331611896222785017');" onmouseout="out('5331611896222785017');" style=""> 127         if (sqlKind == SqlKind.AND &amp;&amp; ((SqlBasicCall) whereNode).getOperandList().size() == 2) {         </span>
<span class="-6832131528842420610" onmouseenter="enter('-6832131528842420610');" onmouseout="out('-6832131528842420610');" style=""> 128             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[0], predicatesInfoList);       </span>
<span class="-4853268236633653802" onmouseenter="enter('-4853268236633653802');" onmouseout="out('-4853268236633653802');" style=""> 129             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[1], predicatesInfoList);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 130         } else {                                                                                         </span>
<span class="6338655695570846334" onmouseenter="enter('6338655695570846334');" onmouseout="out('6338655695570846334');" style=""> 131             SqlOperator operator = ((SqlBasicCall) whereNode).getOperator();                             </span>
<span class="6330462445765985009" onmouseenter="enter('6330462445765985009');" onmouseout="out('6330462445765985009');" style=""> 132             String operatorName = operator.getName();                                                    </span>
<span class="-5712206181815162330" onmouseenter="enter('-5712206181815162330');" onmouseout="out('-5712206181815162330');" style=""> 133             SqlKind operatorKind = operator.getKind();                                                   </span>
<span  style=""> 134                                                                                                          </span>
<span class="-3624787404055176751" onmouseenter="enter('-3624787404055176751');" onmouseout="out('-3624787404055176751');" style=""> 135             if (operatorKind == SqlKind.IS_NOT_NULL || operatorKind == SqlKind.IS_NULL) {                </span>
<span class="-8618394030406407904" onmouseenter="enter('-8618394030406407904');" onmouseout="out('-8618394030406407904');" style=""><abbr title=" 136                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 0);"> 136                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 137                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138             }                                                                                            </span>
<span  style=""> 139                                                                                                          </span>
<span class="6827991746517972068" onmouseenter="enter('6827991746517972068');" onmouseout="out('6827991746517972068');" style=""> 140             // 跳过函数                                                                                      </span>
<span class="7033432411623994261" onmouseenter="enter('7033432411623994261');" onmouseout="out('7033432411623994261');" style=""> 141             if ((((SqlBasicCall) whereNode).getOperands()[0] instanceof SqlIdentifier)                   </span>
<span class="4695126583355687281" onmouseenter="enter('4695126583355687281');" onmouseout="out('4695126583355687281');" style=""><abbr title=" 142                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION)) {"> 142                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="1580435819466621331" onmouseenter="enter('1580435819466621331');" onmouseout="out('1580435819466621331');" style=""><abbr title=" 143                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 1);"> 143                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-4379599636634861191" onmouseenter="enter('-4379599636634861191');" onmouseout="out('-4379599636634861191');" style=""> 144             } else if ((((SqlBasicCall) whereNode).getOperands()[1] instanceof SqlIdentifier)            </span>
<span class="4462406844202440903" onmouseenter="enter('4462406844202440903');" onmouseout="out('4462406844202440903');" style=""><abbr title=" 145                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION)) {"> 145                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="6472075389363354698" onmouseenter="enter('6472075389363354698');" onmouseout="out('6472075389363354698');" style=""><abbr title=" 146                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 1, 0);"> 146                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149     }                                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="1912413075341318367" onmouseenter="enter('1912413075341318367');" onmouseout="out('1912413075341318367');" style=""><abbr title=" 151     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String operatorName, SqlKind operatorKind,"> 151     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, 🔵</abbr></span>
<span class="2252308863606392437" onmouseenter="enter('2252308863606392437');" onmouseout="out('2252308863606392437');" style=""> 152                                          int fieldIndex, int conditionIndex) {                           </span>
<span class="-7281485868711016418" onmouseenter="enter('-7281485868711016418');" onmouseout="out('-7281485868711016418');" style=""> 153         SqlIdentifier fieldFullPath = (SqlIdentifier) whereNode.getOperands()[fieldIndex];               </span>
<span class="7203975986175764877" onmouseenter="enter('7203975986175764877');" onmouseout="out('7203975986175764877');" style=""> 154         if (fieldFullPath.names.size() == 2) {                                                           </span>
<span class="-1996143262144281682" onmouseenter="enter('-1996143262144281682');" onmouseout="out('-1996143262144281682');" style=""> 155             String ownerTable = fieldFullPath.names.get(0);                                              </span>
<span class="-8937094567283519424" onmouseenter="enter('-8937094567283519424');" onmouseout="out('-8937094567283519424');" style=""> 156             String fieldName = fieldFullPath.names.get(1);                                               </span>
<span class="-2731393012930882758" onmouseenter="enter('-2731393012930882758');" onmouseout="out('-2731393012930882758');" style=""><abbr title=" 157             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString() + &quot; AND &quot; +"> 157             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].🔵</abbr></span>
<span class="5584033711688284314" onmouseenter="enter('5584033711688284314');" onmouseout="out('5584033711688284314');" style=""><abbr title=" 158                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toString();"> 158                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toStr🔵</abbr></span>
<span  style=""> 159                                                                                                          </span>
<span class="-1206547946994992687" onmouseenter="enter('-1206547946994992687');" onmouseout="out('-1206547946994992687');" style=""><abbr title=" 160             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(operatorKind.toString())"> 160             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperat🔵</abbr></span>
<span class="-7910070237514947571" onmouseenter="enter('-7910070237514947571');" onmouseout="out('-7910070237514947571');" style=""> 161                     .setOwnerTable(ownerTable).setFieldName(fieldName).setCondition(content).build();    </span>
<span class="2100038020113072635" onmouseenter="enter('2100038020113072635');" onmouseout="out('2100038020113072635');" style=""> 162             predicatesInfoList.add(predicateInfo);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164     }                                                                                                    </span>
<span  style=""> 165                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  20 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  21 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  22 import com.google.common.collect.Maps;                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  24 import java.util.Map;                                                                                    </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  25 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  26 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  27 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  28 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  29 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  30 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  31 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  32 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  33 import org.apache.calcite.sql.parser.SqlParseException;                                                  </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  34 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  35 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span  style="">  36                                                                                                          </span>
<span  style="">  37                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  39  *                                                                                                       </span>
<span class="8689868297768661973" onmouseenter="enter('8689868297768661973');" onmouseout="out('8689868297768661973');" style="">  40  *  将同级谓词信息填充到维表                                                                                         </span>
<span class="-7294136002415509658" onmouseenter="enter('-7294136002415509658');" onmouseout="out('-7294136002415509658');" style="">  41  * Date: 2019/12/11                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  42  * Company: www.dtstack.com                                                                              </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  43  * @author maqi                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  44  */                                                                                                      </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="">  45 public class SidePredicatesParser {                                                                      </span>
<span class="8914128835654641108" onmouseenter="enter('8914128835654641108');" onmouseout="out('8914128835654641108');" style=""><abbr title="  46     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) throws SqlParseException {">  46     public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap🔵</abbr></span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="">  47         FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                  </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="">  48         SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                    </span>
<span class="-6218725010169197996" onmouseenter="enter('-6218725010169197996');" onmouseout="out('-6218725010169197996');" style="">  49         parseSql(sqlNode, sideTableMap, Maps.newHashMap());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50     }                                                                                                    </span>
<span  style="">  51                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52     /**                                                                                                  </span>
<span class="-8938943915718346409" onmouseenter="enter('-8938943915718346409');" onmouseout="out('-8938943915718346409');" style="">  53      *  将谓词信息填充到维表属性                                                                                     </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  54      * @param sqlNode                                                                                    </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="">  55      * @param sideTableMap                                                                               </span>
<span class="5326707071817488305" onmouseenter="enter('5326707071817488305');" onmouseout="out('5326707071817488305');" style="">  56      * @param tabMapping  谓词属性中别名对应的真实维表名称                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57      */                                                                                                  </span>
<span class="-350453358075359301" onmouseenter="enter('-350453358075359301');" onmouseout="out('-350453358075359301');" style=""><abbr title="  58     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  58     private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, S🔵</abbr></span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  59         SqlKind sqlKind = sqlNode.getKind();                                                             </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  60         switch (sqlKind) {                                                                               </span>
<span class="-3229205352829537061" onmouseenter="enter('-3229205352829537061');" onmouseout="out('-3229205352829537061');" style="">  61             case INSERT :                                                                                </span>
<span class="4923379117766569884" onmouseenter="enter('4923379117766569884');" onmouseout="out('4923379117766569884');" style="">  62                 SqlNode sqlSource = ((SqlInsert) (sqlNode)).getSource();                                 </span>
<span class="-1101454880130282993" onmouseenter="enter('-1101454880130282993');" onmouseout="out('-1101454880130282993');" style="">  63                 parseSql(sqlSource, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  64                 break;                                                                                   </span>
<span class="-3198951126756304146" onmouseenter="enter('-3198951126756304146');" onmouseout="out('-3198951126756304146');" style="">  65             case SELECT :                                                                                </span>
<span class="-9048594463055777657" onmouseenter="enter('-9048594463055777657');" onmouseout="out('-9048594463055777657');" style="">  66                 SqlNode fromNode = ((SqlSelect) (sqlNode)).getFrom();                                    </span>
<span class="1767654639687200275" onmouseenter="enter('1767654639687200275');" onmouseout="out('1767654639687200275');" style="">  67                 SqlNode whereNode = ((SqlSelect) (sqlNode)).getWhere();                                  </span>
<span class="-6304731576216937649" onmouseenter="enter('-6304731576216937649');" onmouseout="out('-6304731576216937649');" style="">  68                 if (fromNode.getKind() != IDENTIFIER) {                                                  </span>
<span class="6082271321132508920" onmouseenter="enter('6082271321132508920');" onmouseout="out('6082271321132508920');" style="">  69                     parseSql(fromNode, sideTableMap, tabMapping);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70                 }                                                                                        </span>
<span class="361899178658135" onmouseenter="enter('361899178658135');" onmouseout="out('361899178658135');" style="">  71                 //  带or的不解析                                                                              </span>
<span class="-7266828598419011636" onmouseenter="enter('-7266828598419011636');" onmouseout="out('-7266828598419011636');" style="">  72                 if ((null != whereNode) &amp;&amp; (whereNode.getKind() != OR)) {                                </span>
<span class="-1868734217058162393" onmouseenter="enter('-1868734217058162393');" onmouseout="out('-1868734217058162393');" style="">  73                     List&lt;PredicateInfo&gt; predicateInfoList = Lists.newArrayList();                        </span>
<span class="-8142164038074458964" onmouseenter="enter('-8142164038074458964');" onmouseout="out('-8142164038074458964');" style="">  74                     extractPredicateInfo(whereNode, predicateInfoList);                                  </span>
<span class="-1800893519042755240" onmouseenter="enter('-1800893519042755240');" onmouseout="out('-1800893519042755240');" style="">  75                     fillToSideTableInfo(sideTableMap, tabMapping, predicateInfoList);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  77                 break;                                                                                   </span>
<span class="-6812790603264225102" onmouseenter="enter('-6812790603264225102');" onmouseout="out('-6812790603264225102');" style="">  78             case JOIN :                                                                                  </span>
<span class="-4395251305376668835" onmouseenter="enter('-4395251305376668835');" onmouseout="out('-4395251305376668835');" style="">  79                 SqlNode leftNode = ((SqlJoin) (sqlNode)).getLeft();                                      </span>
<span class="8050631472929284299" onmouseenter="enter('8050631472929284299');" onmouseout="out('8050631472929284299');" style="">  80                 SqlNode rightNode = ((SqlJoin) (sqlNode)).getRight();                                    </span>
<span class="3893843580747346079" onmouseenter="enter('3893843580747346079');" onmouseout="out('3893843580747346079');" style="">  81                 parseSql(leftNode, sideTableMap, tabMapping);                                            </span>
<span class="-1550063580510292788" onmouseenter="enter('-1550063580510292788');" onmouseout="out('-1550063580510292788');" style="">  82                 parseSql(rightNode, sideTableMap, tabMapping);                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  83                 break;                                                                                   </span>
<span class="-7603101237578294688" onmouseenter="enter('-7603101237578294688');" onmouseout="out('-7603101237578294688');" style="">  84             case AS :                                                                                    </span>
<span class="-2581148716866963551" onmouseenter="enter('-2581148716866963551');" onmouseout="out('-2581148716866963551');" style="">  85                 SqlNode info = ((SqlBasicCall) (sqlNode)).getOperands()[0];                              </span>
<span class="6674876786664753496" onmouseenter="enter('6674876786664753496');" onmouseout="out('6674876786664753496');" style="">  86                 SqlNode alias = ((SqlBasicCall) (sqlNode)).getOperands()[1];                             </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style="">  87                 if (info.getKind() == IDENTIFIER) {                                                      </span>
<span class="-6809247708006763533" onmouseenter="enter('-6809247708006763533');" onmouseout="out('-6809247708006763533');" style="">  88                     tabMapping.put(alias.toString(), info.toString());                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  89                 } else {                                                                                 </span>
<span class="1627725189054467864" onmouseenter="enter('1627725189054467864');" onmouseout="out('1627725189054467864');" style="">  90                     // 为子查询创建一个同级map                                                                     </span>
<span class="-6730923757280984430" onmouseenter="enter('-6730923757280984430');" onmouseout="out('-6730923757280984430');" style="">  91                     parseSql(info, sideTableMap, Maps.newHashMap());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92                 }                                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  93                 break;                                                                                   </span>
<span class="1238941309895419592" onmouseenter="enter('1238941309895419592');" onmouseout="out('1238941309895419592');" style="">  94             case UNION :                                                                                 </span>
<span class="3847221911167009847" onmouseenter="enter('3847221911167009847');" onmouseout="out('3847221911167009847');" style="">  95                 SqlNode unionLeft = ((SqlBasicCall) (sqlNode)).getOperands()[0];                         </span>
<span class="-4021192438573809697" onmouseenter="enter('-4021192438573809697');" onmouseout="out('-4021192438573809697');" style="">  96                 SqlNode unionRight = ((SqlBasicCall) (sqlNode)).getOperands()[1];                        </span>
<span class="2983730094677593593" onmouseenter="enter('2983730094677593593');" onmouseout="out('2983730094677593593');" style="">  97                 parseSql(unionLeft, sideTableMap, tabMapping);                                           </span>
<span class="-682128595120402183" onmouseenter="enter('-682128595120402183');" onmouseout="out('-682128595120402183');" style="">  98                 parseSql(unionRight, sideTableMap, tabMapping);                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  99                 break;                                                                                   </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 100             default :                                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 101                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103     }                                                                                                    </span>
<span  style=""> 104                                                                                                          </span>
<span class="-5730717099148913488" onmouseenter="enter('-5730717099148913488');" onmouseout="out('-5730717099148913488');" style=""><abbr title=" 105     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 105     private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt;🔵</abbr></span>
<span class="4232579398949505609" onmouseenter="enter('4232579398949505609');" onmouseout="out('4232579398949505609');" style=""><abbr title=" 106         predicateInfoList.stream().filter(( info) -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable()))).map(( info) -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())).getPredicateInfoes().add(info)).count();"> 106         predicateInfoList.stream().filter(( info) -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(inf🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107     }                                                                                                    </span>
<span  style=""> 108                                                                                                          </span>
<span class="-6272773481519110694" onmouseenter="enter('-6272773481519110694');" onmouseout="out('-6272773481519110694');" style=""> 109     private void extractPredicateInfo(SqlNode whereNode, List&lt;PredicateInfo&gt; predicatesInfoList) {       </span>
<span class="-1315079444131826039" onmouseenter="enter('-1315079444131826039');" onmouseout="out('-1315079444131826039');" style=""> 110         SqlKind sqlKind = whereNode.getKind();                                                           </span>
<span class="5331611896222785017" onmouseenter="enter('5331611896222785017');" onmouseout="out('5331611896222785017');" style=""> 111         if (sqlKind == SqlKind.AND &amp;&amp; ((SqlBasicCall) whereNode).getOperandList().size() == 2) {         </span>
<span class="-6832131528842420610" onmouseenter="enter('-6832131528842420610');" onmouseout="out('-6832131528842420610');" style=""> 112             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[0], predicatesInfoList);       </span>
<span class="-4853268236633653802" onmouseenter="enter('-4853268236633653802');" onmouseout="out('-4853268236633653802');" style=""> 113             extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[1], predicatesInfoList);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 114         } else {                                                                                         </span>
<span class="6338655695570846334" onmouseenter="enter('6338655695570846334');" onmouseout="out('6338655695570846334');" style=""> 115             SqlOperator operator = ((SqlBasicCall) whereNode).getOperator();                             </span>
<span class="6330462445765985009" onmouseenter="enter('6330462445765985009');" onmouseout="out('6330462445765985009');" style=""> 116             String operatorName = operator.getName();                                                    </span>
<span class="-5712206181815162330" onmouseenter="enter('-5712206181815162330');" onmouseout="out('-5712206181815162330');" style=""> 117             SqlKind operatorKind = operator.getKind();                                                   </span>
<span  style=""> 118                                                                                                          </span>
<span class="-3624787404055176751" onmouseenter="enter('-3624787404055176751');" onmouseout="out('-3624787404055176751');" style=""> 119             if (operatorKind == SqlKind.IS_NOT_NULL || operatorKind == SqlKind.IS_NULL) {                </span>
<span class="-8618394030406407904" onmouseenter="enter('-8618394030406407904');" onmouseout="out('-8618394030406407904');" style=""><abbr title=" 120                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 0);"> 120                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 121                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122             }                                                                                            </span>
<span  style=""> 123                                                                                                          </span>
<span class="6827991746517972068" onmouseenter="enter('6827991746517972068');" onmouseout="out('6827991746517972068');" style=""> 124             // 跳过函数                                                                                      </span>
<span class="7033432411623994261" onmouseenter="enter('7033432411623994261');" onmouseout="out('7033432411623994261');" style=""> 125             if ((((SqlBasicCall) whereNode).getOperands()[0] instanceof SqlIdentifier)                   </span>
<span class="4695126583355687281" onmouseenter="enter('4695126583355687281');" onmouseout="out('4695126583355687281');" style=""><abbr title=" 126                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION)) {"> 126                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="1580435819466621331" onmouseenter="enter('1580435819466621331');" onmouseout="out('1580435819466621331');" style=""><abbr title=" 127                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 1);"> 127                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-4379599636634861191" onmouseenter="enter('-4379599636634861191');" onmouseout="out('-4379599636634861191');" style=""> 128             } else if ((((SqlBasicCall) whereNode).getOperands()[1] instanceof SqlIdentifier)            </span>
<span class="4462406844202440903" onmouseenter="enter('4462406844202440903');" onmouseout="out('4462406844202440903');" style=""><abbr title=" 129                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION)) {"> 129                     &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION))🔵</abbr></span>
<span class="6472075389363354698" onmouseenter="enter('6472075389363354698');" onmouseout="out('6472075389363354698');" style=""><abbr title=" 130                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 1, 0);"> 130                 fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, opera🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="1912413075341318367" onmouseenter="enter('1912413075341318367');" onmouseout="out('1912413075341318367');" style=""><abbr title=" 135     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String operatorName, SqlKind operatorKind,"> 135     private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, 🔵</abbr></span>
<span class="2252308863606392437" onmouseenter="enter('2252308863606392437');" onmouseout="out('2252308863606392437');" style=""> 136                                          int fieldIndex, int conditionIndex) {                           </span>
<span class="-7281485868711016418" onmouseenter="enter('-7281485868711016418');" onmouseout="out('-7281485868711016418');" style=""> 137         SqlIdentifier fieldFullPath = (SqlIdentifier) whereNode.getOperands()[fieldIndex];               </span>
<span class="7203975986175764877" onmouseenter="enter('7203975986175764877');" onmouseout="out('7203975986175764877');" style=""> 138         if (fieldFullPath.names.size() == 2) {                                                           </span>
<span class="-1996143262144281682" onmouseenter="enter('-1996143262144281682');" onmouseout="out('-1996143262144281682');" style=""> 139             String ownerTable = fieldFullPath.names.get(0);                                              </span>
<span class="-8937094567283519424" onmouseenter="enter('-8937094567283519424');" onmouseout="out('-8937094567283519424');" style=""> 140             String fieldName = fieldFullPath.names.get(1);                                               </span>
<span class="-2731393012930882758" onmouseenter="enter('-2731393012930882758');" onmouseout="out('-2731393012930882758');" style=""><abbr title=" 141             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString() + &quot; AND &quot; +"> 141             String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].🔵</abbr></span>
<span class="5584033711688284314" onmouseenter="enter('5584033711688284314');" onmouseout="out('5584033711688284314');" style=""><abbr title=" 142                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toString();"> 142                     whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toStr🔵</abbr></span>
<span  style=""> 143                                                                                                          </span>
<span class="-1206547946994992687" onmouseenter="enter('-1206547946994992687');" onmouseout="out('-1206547946994992687');" style=""><abbr title=" 144             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(operatorKind.toString())"> 144             PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperat🔵</abbr></span>
<span class="-7910070237514947571" onmouseenter="enter('-7910070237514947571');" onmouseout="out('-7910070237514947571');" style=""> 145                     .setOwnerTable(ownerTable).setFieldName(fieldName).setCondition(content).build();    </span>
<span class="2100038020113072635" onmouseenter="enter('2100038020113072635');" onmouseout="out('2100038020113072635');" style=""> 146             predicatesInfoList.add(predicateInfo);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149 }                                                                                                        </span>















</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  19  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  20                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import com.dtstack.flink.sql.parser.FlinkPlanner;                                                                 </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  23  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  24  import com.google.common.collect.Maps;                                                                            </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  25  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  26  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  27  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  28  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  29  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  30  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  31  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  32  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  33  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="1277226550340008522" onmouseenter="enter('1277226550340008522');" onmouseout="out('1277226550340008522');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.calcite.sql.parser.SqlParser;                                                                   </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                           </span>
<span  style="">  36                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  37  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  38  import java.util.Map;                                                                                             </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import java.util.stream.Collectors;                                                                               </span>
<span  style="">  40                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  41  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span  style="">  42                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  43  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  44   *                                                                                                                </span>
<span class="8689868297768661973" onmouseenter="enter('8689868297768661973');" onmouseout="out('8689868297768661973');" style="">  45   *  将同级谓词信息填充到维表                                                                                                  </span>
<span class="-7294136002415509658" onmouseenter="enter('-7294136002415509658');" onmouseout="out('-7294136002415509658');" style="">  46   * Date: 2019/12/11                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  47   * Company: www.dtstack.com                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  48   * @author maqi                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  49   */                                                                                                               </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="">  50  public class SidePredicatesParser {                                                                               </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style=""><abbr title="  51      public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  51      public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParse🔵</abbr></span>

<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -        SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                           </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -        SqlNode sqlNode = sqlParser.parseStmt();                                                                  </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +        FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                                           </span>
<span class="-6421300158550037914" onmouseenter="enter('-6421300158550037914');" onmouseout="out('-6421300158550037914');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +        SqlNode sqlNode = flinkPlanner.parse(exeSql);                                                             </span>
<span class="-6218725010169197996" onmouseenter="enter('-6218725010169197996');" onmouseout="out('-6218725010169197996');" style="">  56          parseSql(sqlNode, sideTableMap, Maps.newHashMap());                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57      }                                                                                                             </span>
<span  style="">  58                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59      /**                                                                                                           </span>
<span class="-8938943915718346409" onmouseenter="enter('-8938943915718346409');" onmouseout="out('-8938943915718346409');" style="">  60       *  将谓词信息填充到维表属性                                                                                              </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  61       * @param sqlNode                                                                                             </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="">  62       * @param sideTableMap                                                                                        </span>
<span class="5326707071817488305" onmouseenter="enter('5326707071817488305');" onmouseout="out('5326707071817488305');" style="">  63       * @param tabMapping  谓词属性中别名对应的真实维表名称                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64       */                                                                                                           </span>
<span class="-1450264415365963213" onmouseenter="enter('-1450264415365963213');" onmouseout="out('-1450264415365963213');" style=""><abbr title="  65      private void parseSql(SqlNode sqlNode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  65      private void parseSql(SqlNode sqlNode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping🔵</abbr></span>

<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  66          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  67          switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="">  68              case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="">  69                  SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="-1101454880130282993" onmouseenter="enter('-1101454880130282993');" onmouseout="out('-1101454880130282993');" style="">  70                  parseSql(sqlSource, sideTableMap, tabMapping);                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  71                  break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="">  72              case SELECT:                                                                                          </span>
<span class="1662668321521353233" onmouseenter="enter('1662668321521353233');" onmouseout="out('1662668321521353233');" style="">  73                  SqlNode fromNode = ((SqlSelect) sqlNode).getFrom();                                               </span>
<span class="-7381113953409456779" onmouseenter="enter('-7381113953409456779');" onmouseout="out('-7381113953409456779');" style="">  74                  SqlNode whereNode = ((SqlSelect) sqlNode).getWhere();                                             </span>
<span  style="">  75                                                                                                                    </span>
<span class="-6304731576216937649" onmouseenter="enter('-6304731576216937649');" onmouseout="out('-6304731576216937649');" style="">  76                  if (fromNode.getKind() != IDENTIFIER) {                                                           </span>
<span class="6082271321132508920" onmouseenter="enter('6082271321132508920');" onmouseout="out('6082271321132508920');" style="">  77                      parseSql(fromNode, sideTableMap, tabMapping);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78                  }                                                                                                 </span>
<span class="361899178658135" onmouseenter="enter('361899178658135');" onmouseout="out('361899178658135');" style="">  79                  //  带or的不解析                                                                                       </span>
<span class="-450559365930313124" onmouseenter="enter('-450559365930313124');" onmouseout="out('-450559365930313124');" style="">  80                  if (null != whereNode &amp;&amp; whereNode.getKind() != OR) {                                             </span>
<span class="-1868734217058162393" onmouseenter="enter('-1868734217058162393');" onmouseout="out('-1868734217058162393');" style="">  81                      List&lt;PredicateInfo&gt; predicateInfoList = Lists.newArrayList();                                 </span>
<span class="-8142164038074458964" onmouseenter="enter('-8142164038074458964');" onmouseout="out('-8142164038074458964');" style="">  82                      extractPredicateInfo(whereNode, predicateInfoList);                                           </span>
<span class="-1800893519042755240" onmouseenter="enter('-1800893519042755240');" onmouseout="out('-1800893519042755240');" style="">  83                      fillToSideTableInfo(sideTableMap, tabMapping, predicateInfoList);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  85                  break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="">  86              case JOIN:                                                                                            </span>
<span class="3337904632317662883" onmouseenter="enter('3337904632317662883');" onmouseout="out('3337904632317662883');" style="">  87                  SqlNode leftNode = ((SqlJoin) sqlNode).getLeft();                                                 </span>
<span class="6174600545483522710" onmouseenter="enter('6174600545483522710');" onmouseout="out('6174600545483522710');" style="">  88                  SqlNode rightNode = ((SqlJoin) sqlNode).getRight();                                               </span>
<span class="3893843580747346079" onmouseenter="enter('3893843580747346079');" onmouseout="out('3893843580747346079');" style="">  89                  parseSql(leftNode, sideTableMap, tabMapping);                                                     </span>
<span class="-1550063580510292788" onmouseenter="enter('-1550063580510292788');" onmouseout="out('-1550063580510292788');" style="">  90                  parseSql(rightNode, sideTableMap, tabMapping);                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  91                  break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="">  92              case AS:                                                                                              </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="">  93                  SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                         </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="">  94                  SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                        </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style="">  95                  if (info.getKind() == IDENTIFIER) {                                                               </span>
<span class="-6809247708006763533" onmouseenter="enter('-6809247708006763533');" onmouseout="out('-6809247708006763533');" style="">  96                      tabMapping.put(alias.toString(), info.toString());                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  97                  } else {                                                                                          </span>
<span class="1627725189054467864" onmouseenter="enter('1627725189054467864');" onmouseout="out('1627725189054467864');" style="">  98                      // 为子查询创建一个同级map                                                                              </span>
<span class="-6730923757280984430" onmouseenter="enter('-6730923757280984430');" onmouseout="out('-6730923757280984430');" style="">  99                      parseSql(info, sideTableMap, Maps.newHashMap());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 101                  break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 102              case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 103                  SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 104                  SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="2983730094677593593" onmouseenter="enter('2983730094677593593');" onmouseout="out('2983730094677593593');" style=""> 105                  parseSql(unionLeft, sideTableMap, tabMapping);                                                    </span>
<span class="-682128595120402183" onmouseenter="enter('-682128595120402183');" onmouseout="out('-682128595120402183');" style=""> 106                  parseSql(unionRight, sideTableMap, tabMapping);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 107                  break;                                                                                            </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109      }                                                                                                             </span>
<span  style=""> 110                                                                                                                    </span>
<span class="7613881496027364396" onmouseenter="enter('7613881496027364396');" onmouseout="out('7613881496027364396');" style=""><abbr title=" 111      private void fillToSideTableInfo(Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 111      private void fillToSideTableInfo(Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List🔵</abbr></span>

<span class="-5143537772085868977" onmouseenter="enter('-5143537772085868977');" onmouseout="out('-5143537772085868977');" style=""><abbr title=" 112          predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())))"> 112          predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTa🔵</abbr></span>
<span class="-878829588541342667" onmouseenter="enter('-878829588541342667');" onmouseout="out('-878829588541342667');" style=""><abbr title=" 113                  .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())).getPredicateInfoes().add(info))"> 113                  .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable()))🔵</abbr></span>
<span class="-7281528394716107809" onmouseenter="enter('-7281528394716107809');" onmouseout="out('-7281528394716107809');" style=""> 114                  .count();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span  style=""> 116                                                                                                                    </span>
<span  style=""> 117                                                                                                                    </span>
<span class="-6272773481519110694" onmouseenter="enter('-6272773481519110694');" onmouseout="out('-6272773481519110694');" style=""> 118      private void extractPredicateInfo(SqlNode whereNode, List&lt;PredicateInfo&gt; predicatesInfoList) {                </span>
<span class="-1315079444131826039" onmouseenter="enter('-1315079444131826039');" onmouseout="out('-1315079444131826039');" style=""> 119          SqlKind sqlKind = whereNode.getKind();                                                                    </span>
<span class="5331611896222785017" onmouseenter="enter('5331611896222785017');" onmouseout="out('5331611896222785017');" style=""> 120          if (sqlKind == SqlKind.AND &amp;&amp; ((SqlBasicCall) whereNode).getOperandList().size() == 2) {                  </span>
<span class="-6832131528842420610" onmouseenter="enter('-6832131528842420610');" onmouseout="out('-6832131528842420610');" style=""> 121              extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[0], predicatesInfoList);                </span>
<span class="-4853268236633653802" onmouseenter="enter('-4853268236633653802');" onmouseout="out('-4853268236633653802');" style=""> 122              extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[1], predicatesInfoList);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 123          } else {                                                                                                  </span>
<span class="6338655695570846334" onmouseenter="enter('6338655695570846334');" onmouseout="out('6338655695570846334');" style=""> 124              SqlOperator operator = ((SqlBasicCall) whereNode).getOperator();                                      </span>
<span class="6330462445765985009" onmouseenter="enter('6330462445765985009');" onmouseout="out('6330462445765985009');" style=""> 125              String operatorName = operator.getName();                                                             </span>
<span class="-5712206181815162330" onmouseenter="enter('-5712206181815162330');" onmouseout="out('-5712206181815162330');" style=""> 126              SqlKind operatorKind = operator.getKind();                                                            </span>
<span  style=""> 127                                                                                                                    </span>
<span class="-3624787404055176751" onmouseenter="enter('-3624787404055176751');" onmouseout="out('-3624787404055176751');" style=""> 128              if (operatorKind == SqlKind.IS_NOT_NULL || operatorKind == SqlKind.IS_NULL) {                         </span>
<span class="-8618394030406407904" onmouseenter="enter('-8618394030406407904');" onmouseout="out('-8618394030406407904');" style=""><abbr title=" 129                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 0);"> 129                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 130                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131              }                                                                                                     </span>
<span  style=""> 132                                                                                                                    </span>
<span class="6827991746517972068" onmouseenter="enter('6827991746517972068');" onmouseout="out('6827991746517972068');" style=""> 133              // 跳过函数                                                                                               </span>
<span class="7033432411623994261" onmouseenter="enter('7033432411623994261');" onmouseout="out('7033432411623994261');" style=""> 134              if ((((SqlBasicCall) whereNode).getOperands()[0] instanceof SqlIdentifier)                            </span>
<span class="4695126583355687281" onmouseenter="enter('4695126583355687281');" onmouseout="out('4695126583355687281');" style=""> 135                      &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION)) {       </span>
<span class="1580435819466621331" onmouseenter="enter('1580435819466621331');" onmouseout="out('1580435819466621331');" style=""><abbr title=" 136                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 1);"> 136                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="-4379599636634861191" onmouseenter="enter('-4379599636634861191');" onmouseout="out('-4379599636634861191');" style=""> 137              } else if ((((SqlBasicCall) whereNode).getOperands()[1] instanceof SqlIdentifier)                     </span>
<span class="4462406844202440903" onmouseenter="enter('4462406844202440903');" onmouseout="out('4462406844202440903');" style=""> 138                      &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION)) {       </span>
<span class="6472075389363354698" onmouseenter="enter('6472075389363354698');" onmouseout="out('6472075389363354698');" style=""><abbr title=" 139                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 1, 0);"> 139                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142      }                                                                                                             </span>
<span  style=""> 143                                                                                                                    </span>
<span class="1912413075341318367" onmouseenter="enter('1912413075341318367');" onmouseout="out('1912413075341318367');" style=""><abbr title=" 144      private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String operatorName, SqlKind operatorKind,"> 144      private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String op🔵</abbr></span>
<span class="2252308863606392437" onmouseenter="enter('2252308863606392437');" onmouseout="out('2252308863606392437');" style=""> 145                                           int fieldIndex, int conditionIndex) {                                    </span>
<span class="-7281485868711016418" onmouseenter="enter('-7281485868711016418');" onmouseout="out('-7281485868711016418');" style=""> 146          SqlIdentifier fieldFullPath = (SqlIdentifier) whereNode.getOperands()[fieldIndex];                        </span>
<span class="7203975986175764877" onmouseenter="enter('7203975986175764877');" onmouseout="out('7203975986175764877');" style=""> 147          if (fieldFullPath.names.size() == 2) {                                                                    </span>
<span class="-1996143262144281682" onmouseenter="enter('-1996143262144281682');" onmouseout="out('-1996143262144281682');" style=""> 148              String ownerTable = fieldFullPath.names.get(0);                                                       </span>
<span class="-8937094567283519424" onmouseenter="enter('-8937094567283519424');" onmouseout="out('-8937094567283519424');" style=""> 149              String fieldName = fieldFullPath.names.get(1);                                                        </span>
<span class="-2731393012930882758" onmouseenter="enter('-2731393012930882758');" onmouseout="out('-2731393012930882758');" style=""><abbr title=" 150              String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString() + &quot; AND &quot; +"> 150              String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString(🔵</abbr></span>
<span class="5584033711688284314" onmouseenter="enter('5584033711688284314');" onmouseout="out('5584033711688284314');" style=""> 151                      whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toString();   </span>
<span  style=""> 152                                                                                                                    </span>
<span class="-1206547946994992687" onmouseenter="enter('-1206547946994992687');" onmouseout="out('-1206547946994992687');" style=""><abbr title=" 153              PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(operatorKind.toString())"> 153              PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(op🔵</abbr></span>
<span class="-7910070237514947571" onmouseenter="enter('-7910070237514947571');" onmouseout="out('-7910070237514947571');" style=""> 154                      .setOwnerTable(ownerTable).setFieldName(fieldName).setCondition(content).build();             </span>
<span class="2100038020113072635" onmouseenter="enter('2100038020113072635');" onmouseout="out('2100038020113072635');" style=""> 155              predicatesInfoList.add(predicateInfo);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157      }                                                                                                             </span>
<span  style=""> 158                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  19  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  20                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="">  21  import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>

<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  22  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  23  import com.google.common.collect.Maps;                                                                            </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  24  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  25  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  26  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  27  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  28  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  29  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  30  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  31  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="7194619065086523875" onmouseenter="enter('7194619065086523875');" onmouseout="out('7194619065086523875');" style="">  32  import org.apache.calcite.sql.parser.SqlParseException;                                                           </span>
<span class="1277226550340008522" onmouseenter="enter('1277226550340008522');" onmouseout="out('1277226550340008522');" style="">  33  import org.apache.calcite.sql.parser.SqlParser;                                                                   </span>

<span  style="">  34                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  35  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  36  import java.util.Map;                                                                                             </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import java.util.stream.Collectors;                                                                               </span>
<span  style="">  38                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  39  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span  style="">  40                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  41  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  42   *                                                                                                                </span>
<span class="8689868297768661973" onmouseenter="enter('8689868297768661973');" onmouseout="out('8689868297768661973');" style="">  43   *  将同级谓词信息填充到维表                                                                                                  </span>
<span class="-7294136002415509658" onmouseenter="enter('-7294136002415509658');" onmouseout="out('-7294136002415509658');" style="">  44   * Date: 2019/12/11                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  45   * Company: www.dtstack.com                                                                                       </span>
<span class="1603470065935134681" onmouseenter="enter('1603470065935134681');" onmouseout="out('1603470065935134681');" style="">  46   * @author maqi                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47   */                                                                                                               </span>
<span class="659528471798191727" onmouseenter="enter('659528471798191727');" onmouseout="out('659528471798191727');" style="">  48  public class SidePredicatesParser {                                                                               </span>
<span class="212362013969752497" onmouseenter="enter('212362013969752497');" onmouseout="out('212362013969752497');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  49 -    public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParseException {">  49 -    public void fillPredicatesForSideTable(String exeSql, Map&lt;String, SideTableInfo&gt; sideTableMap) throws SqlParse🔵</abbr></span>
<span class="8914128835654641108" onmouseenter="enter('8914128835654641108');" onmouseout="out('8914128835654641108');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  50 +    public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) throws SqlParseException {">  50 +    public void fillPredicatesForSideTable(String exeSql, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap) throws 🔵</abbr></span>
<span class="7016162249671542936" onmouseenter="enter('7016162249671542936');" onmouseout="out('7016162249671542936');" style="">  51          SqlParser sqlParser = SqlParser.create(exeSql, CalciteConfig.MYSQL_LEX_CONFIG);                           </span>
<span class="-1853454348884693240" onmouseenter="enter('-1853454348884693240');" onmouseout="out('-1853454348884693240');" style="">  52          SqlNode sqlNode = sqlParser.parseStmt();                                                                  </span>


<span class="-6218725010169197996" onmouseenter="enter('-6218725010169197996');" onmouseout="out('-6218725010169197996');" style="">  53          parseSql(sqlNode, sideTableMap, Maps.newHashMap());                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54      }                                                                                                             </span>
<span  style="">  55                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56      /**                                                                                                           </span>
<span class="-8938943915718346409" onmouseenter="enter('-8938943915718346409');" onmouseout="out('-8938943915718346409');" style="">  57       *  将谓词信息填充到维表属性                                                                                              </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style="">  58       * @param sqlNode                                                                                             </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="">  59       * @param sideTableMap                                                                                        </span>
<span class="5326707071817488305" onmouseenter="enter('5326707071817488305');" onmouseout="out('5326707071817488305');" style="">  60       * @param tabMapping  谓词属性中别名对应的真实维表名称                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61       */                                                                                                           </span>
<span class="-1450264415365963213" onmouseenter="enter('-1450264415365963213');" onmouseout="out('-1450264415365963213');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  62 -    private void parseSql(SqlNode sqlNode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  62 -    private void parseSql(SqlNode sqlNode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping🔵</abbr></span>
<span class="-350453358075359301" onmouseenter="enter('-350453358075359301');" onmouseout="out('-350453358075359301');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  63 +    private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping) {">  63 +    private void parseSql(SqlNode sqlNode, Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; ta🔵</abbr></span>
<span class="-6576874451366454813" onmouseenter="enter('-6576874451366454813');" onmouseout="out('-6576874451366454813');" style="">  64          SqlKind sqlKind = sqlNode.getKind();                                                                      </span>
<span class="6693906737523976420" onmouseenter="enter('6693906737523976420');" onmouseout="out('6693906737523976420');" style="">  65          switch (sqlKind) {                                                                                        </span>
<span class="2388664439372983474" onmouseenter="enter('2388664439372983474');" onmouseout="out('2388664439372983474');" style="">  66              case INSERT:                                                                                          </span>
<span class="1507566640229528779" onmouseenter="enter('1507566640229528779');" onmouseout="out('1507566640229528779');" style="">  67                  SqlNode sqlSource = ((SqlInsert) sqlNode).getSource();                                            </span>
<span class="-1101454880130282993" onmouseenter="enter('-1101454880130282993');" onmouseout="out('-1101454880130282993');" style="">  68                  parseSql(sqlSource, sideTableMap, tabMapping);                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  69                  break;                                                                                            </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style="">  70              case SELECT:                                                                                          </span>
<span class="1662668321521353233" onmouseenter="enter('1662668321521353233');" onmouseout="out('1662668321521353233');" style="">  71                  SqlNode fromNode = ((SqlSelect) sqlNode).getFrom();                                               </span>
<span class="-7381113953409456779" onmouseenter="enter('-7381113953409456779');" onmouseout="out('-7381113953409456779');" style="">  72                  SqlNode whereNode = ((SqlSelect) sqlNode).getWhere();                                             </span>
<span  style="">  73                                                                                                                    </span>
<span class="-6304731576216937649" onmouseenter="enter('-6304731576216937649');" onmouseout="out('-6304731576216937649');" style="">  74                  if (fromNode.getKind() != IDENTIFIER) {                                                           </span>
<span class="6082271321132508920" onmouseenter="enter('6082271321132508920');" onmouseout="out('6082271321132508920');" style="">  75                      parseSql(fromNode, sideTableMap, tabMapping);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76                  }                                                                                                 </span>
<span class="361899178658135" onmouseenter="enter('361899178658135');" onmouseout="out('361899178658135');" style="">  77                  //  带or的不解析                                                                                       </span>
<span class="-450559365930313124" onmouseenter="enter('-450559365930313124');" onmouseout="out('-450559365930313124');" style="">  78                  if (null != whereNode &amp;&amp; whereNode.getKind() != OR) {                                             </span>
<span class="-1868734217058162393" onmouseenter="enter('-1868734217058162393');" onmouseout="out('-1868734217058162393');" style="">  79                      List&lt;PredicateInfo&gt; predicateInfoList = Lists.newArrayList();                                 </span>
<span class="-8142164038074458964" onmouseenter="enter('-8142164038074458964');" onmouseout="out('-8142164038074458964');" style="">  80                      extractPredicateInfo(whereNode, predicateInfoList);                                           </span>
<span class="-1800893519042755240" onmouseenter="enter('-1800893519042755240');" onmouseout="out('-1800893519042755240');" style="">  81                      fillToSideTableInfo(sideTableMap, tabMapping, predicateInfoList);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  83                  break;                                                                                            </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style="">  84              case JOIN:                                                                                            </span>
<span class="3337904632317662883" onmouseenter="enter('3337904632317662883');" onmouseout="out('3337904632317662883');" style="">  85                  SqlNode leftNode = ((SqlJoin) sqlNode).getLeft();                                                 </span>
<span class="6174600545483522710" onmouseenter="enter('6174600545483522710');" onmouseout="out('6174600545483522710');" style="">  86                  SqlNode rightNode = ((SqlJoin) sqlNode).getRight();                                               </span>
<span class="3893843580747346079" onmouseenter="enter('3893843580747346079');" onmouseout="out('3893843580747346079');" style="">  87                  parseSql(leftNode, sideTableMap, tabMapping);                                                     </span>
<span class="-1550063580510292788" onmouseenter="enter('-1550063580510292788');" onmouseout="out('-1550063580510292788');" style="">  88                  parseSql(rightNode, sideTableMap, tabMapping);                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  89                  break;                                                                                            </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style="">  90              case AS:                                                                                              </span>
<span class="-7770788458619826788" onmouseenter="enter('-7770788458619826788');" onmouseout="out('-7770788458619826788');" style="">  91                  SqlNode info = ((SqlBasicCall) sqlNode).getOperands()[0];                                         </span>
<span class="1760960030368050225" onmouseenter="enter('1760960030368050225');" onmouseout="out('1760960030368050225');" style="">  92                  SqlNode alias = ((SqlBasicCall) sqlNode).getOperands()[1];                                        </span>
<span class="3045881535147637942" onmouseenter="enter('3045881535147637942');" onmouseout="out('3045881535147637942');" style="">  93                  if (info.getKind() == IDENTIFIER) {                                                               </span>
<span class="-6809247708006763533" onmouseenter="enter('-6809247708006763533');" onmouseout="out('-6809247708006763533');" style="">  94                      tabMapping.put(alias.toString(), info.toString());                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  95                  } else {                                                                                          </span>
<span class="1627725189054467864" onmouseenter="enter('1627725189054467864');" onmouseout="out('1627725189054467864');" style="">  96                      // 为子查询创建一个同级map                                                                              </span>
<span class="-6730923757280984430" onmouseenter="enter('-6730923757280984430');" onmouseout="out('-6730923757280984430');" style="">  97                      parseSql(info, sideTableMap, Maps.newHashMap());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98                  }                                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  99                  break;                                                                                            </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 100              case UNION:                                                                                           </span>
<span class="-8185525423233229369" onmouseenter="enter('-8185525423233229369');" onmouseout="out('-8185525423233229369');" style=""> 101                  SqlNode unionLeft = ((SqlBasicCall) sqlNode).getOperands()[0];                                    </span>
<span class="3590878486653773103" onmouseenter="enter('3590878486653773103');" onmouseout="out('3590878486653773103');" style=""> 102                  SqlNode unionRight = ((SqlBasicCall) sqlNode).getOperands()[1];                                   </span>
<span class="2983730094677593593" onmouseenter="enter('2983730094677593593');" onmouseout="out('2983730094677593593');" style=""> 103                  parseSql(unionLeft, sideTableMap, tabMapping);                                                    </span>
<span class="-682128595120402183" onmouseenter="enter('-682128595120402183');" onmouseout="out('-682128595120402183');" style=""> 104                  parseSql(unionRight, sideTableMap, tabMapping);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 105                  break;                                                                                            </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +            default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109      }                                                                                                             </span>
<span  style=""> 110                                                                                                                    </span>
<span class="7613881496027364396" onmouseenter="enter('7613881496027364396');" onmouseout="out('7613881496027364396');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 111 -    private void fillToSideTableInfo(Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 111 -    private void fillToSideTableInfo(Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List🔵</abbr></span>
<span class="-5730717099148913488" onmouseenter="enter('-5730717099148913488');" onmouseout="out('-5730717099148913488');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 112 +    private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMapping, List&lt;PredicateInfo&gt; predicateInfoList) {"> 112 +    private void fillToSideTableInfo(Map&lt;String, AbstractSideTableInfo&gt; sideTableMap, Map&lt;String, String&gt; tabMappi🔵</abbr></span>
<span class="-5143537772085868977" onmouseenter="enter('-5143537772085868977');" onmouseout="out('-5143537772085868977');" style=""><abbr title=" 113          predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())))"> 113          predicateInfoList.stream().filter(info -&gt; sideTableMap.containsKey(tabMapping.getOrDefault(info.getOwnerTa🔵</abbr></span>
<span class="-878829588541342667" onmouseenter="enter('-878829588541342667');" onmouseout="out('-878829588541342667');" style=""><abbr title=" 114                  .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable())).getPredicateInfoes().add(info))"> 114                  .map(info -&gt; sideTableMap.get(tabMapping.getOrDefault(info.getOwnerTable(), info.getOwnerTable()))🔵</abbr></span>
<span class="-7281528394716107809" onmouseenter="enter('-7281528394716107809');" onmouseout="out('-7281528394716107809');" style=""> 115                  .count();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116      }                                                                                                             </span>
<span  style=""> 117                                                                                                                    </span>
<span  style=""> 118                                                                                                                    </span>
<span class="-6272773481519110694" onmouseenter="enter('-6272773481519110694');" onmouseout="out('-6272773481519110694');" style=""> 119      private void extractPredicateInfo(SqlNode whereNode, List&lt;PredicateInfo&gt; predicatesInfoList) {                </span>
<span class="-1315079444131826039" onmouseenter="enter('-1315079444131826039');" onmouseout="out('-1315079444131826039');" style=""> 120          SqlKind sqlKind = whereNode.getKind();                                                                    </span>
<span class="5331611896222785017" onmouseenter="enter('5331611896222785017');" onmouseout="out('5331611896222785017');" style=""> 121          if (sqlKind == SqlKind.AND &amp;&amp; ((SqlBasicCall) whereNode).getOperandList().size() == 2) {                  </span>
<span class="-6832131528842420610" onmouseenter="enter('-6832131528842420610');" onmouseout="out('-6832131528842420610');" style=""> 122              extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[0], predicatesInfoList);                </span>
<span class="-4853268236633653802" onmouseenter="enter('-4853268236633653802');" onmouseout="out('-4853268236633653802');" style=""> 123              extractPredicateInfo(((SqlBasicCall) whereNode).getOperands()[1], predicatesInfoList);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 124          } else {                                                                                                  </span>
<span class="6338655695570846334" onmouseenter="enter('6338655695570846334');" onmouseout="out('6338655695570846334');" style=""> 125              SqlOperator operator = ((SqlBasicCall) whereNode).getOperator();                                      </span>
<span class="6330462445765985009" onmouseenter="enter('6330462445765985009');" onmouseout="out('6330462445765985009');" style=""> 126              String operatorName = operator.getName();                                                             </span>
<span class="-5712206181815162330" onmouseenter="enter('-5712206181815162330');" onmouseout="out('-5712206181815162330');" style=""> 127              SqlKind operatorKind = operator.getKind();                                                            </span>
<span  style=""> 128                                                                                                                    </span>
<span class="-3624787404055176751" onmouseenter="enter('-3624787404055176751');" onmouseout="out('-3624787404055176751');" style=""> 129              if (operatorKind == SqlKind.IS_NOT_NULL || operatorKind == SqlKind.IS_NULL) {                         </span>
<span class="-8618394030406407904" onmouseenter="enter('-8618394030406407904');" onmouseout="out('-8618394030406407904');" style=""><abbr title=" 130                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 0);"> 130                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 131                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132              }                                                                                                     </span>
<span  style=""> 133                                                                                                                    </span>
<span class="6827991746517972068" onmouseenter="enter('6827991746517972068');" onmouseout="out('6827991746517972068');" style=""> 134              // 跳过函数                                                                                               </span>
<span class="7033432411623994261" onmouseenter="enter('7033432411623994261');" onmouseout="out('7033432411623994261');" style=""> 135              if ((((SqlBasicCall) whereNode).getOperands()[0] instanceof SqlIdentifier)                            </span>
<span class="4695126583355687281" onmouseenter="enter('4695126583355687281');" onmouseout="out('4695126583355687281');" style=""> 136                      &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[1].getKind() != SqlKind.OTHER_FUNCTION)) {       </span>
<span class="1580435819466621331" onmouseenter="enter('1580435819466621331');" onmouseout="out('1580435819466621331');" style=""><abbr title=" 137                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 0, 1);"> 137                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="-4379599636634861191" onmouseenter="enter('-4379599636634861191');" onmouseout="out('-4379599636634861191');" style=""> 138              } else if ((((SqlBasicCall) whereNode).getOperands()[1] instanceof SqlIdentifier)                     </span>
<span class="4462406844202440903" onmouseenter="enter('4462406844202440903');" onmouseout="out('4462406844202440903');" style=""> 139                      &amp;&amp; (((SqlBasicCall) whereNode).getOperands()[0].getKind() != SqlKind.OTHER_FUNCTION)) {       </span>
<span class="6472075389363354698" onmouseenter="enter('6472075389363354698');" onmouseout="out('6472075389363354698');" style=""><abbr title=" 140                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 1, 0);"> 140                  fillPredicateInfoToList((SqlBasicCall) whereNode, predicatesInfoList, operatorName, operatorKind, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143      }                                                                                                             </span>
<span  style=""> 144                                                                                                                    </span>
<span class="1912413075341318367" onmouseenter="enter('1912413075341318367');" onmouseout="out('1912413075341318367');" style=""><abbr title=" 145      private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String operatorName, SqlKind operatorKind,"> 145      private void fillPredicateInfoToList(SqlBasicCall whereNode, List&lt;PredicateInfo&gt; predicatesInfoList, String op🔵</abbr></span>
<span class="2252308863606392437" onmouseenter="enter('2252308863606392437');" onmouseout="out('2252308863606392437');" style=""> 146                                           int fieldIndex, int conditionIndex) {                                    </span>
<span class="-7281485868711016418" onmouseenter="enter('-7281485868711016418');" onmouseout="out('-7281485868711016418');" style=""> 147          SqlIdentifier fieldFullPath = (SqlIdentifier) whereNode.getOperands()[fieldIndex];                        </span>
<span class="7203975986175764877" onmouseenter="enter('7203975986175764877');" onmouseout="out('7203975986175764877');" style=""> 148          if (fieldFullPath.names.size() == 2) {                                                                    </span>
<span class="-1996143262144281682" onmouseenter="enter('-1996143262144281682');" onmouseout="out('-1996143262144281682');" style=""> 149              String ownerTable = fieldFullPath.names.get(0);                                                       </span>
<span class="-8937094567283519424" onmouseenter="enter('-8937094567283519424');" onmouseout="out('-8937094567283519424');" style=""> 150              String fieldName = fieldFullPath.names.get(1);                                                        </span>
<span class="-2731393012930882758" onmouseenter="enter('-2731393012930882758');" onmouseout="out('-2731393012930882758');" style=""><abbr title=" 151              String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString() + &quot; AND &quot; +"> 151              String content = (operatorKind == SqlKind.BETWEEN) ? whereNode.getOperands()[conditionIndex].toString(🔵</abbr></span>
<span class="5584033711688284314" onmouseenter="enter('5584033711688284314');" onmouseout="out('5584033711688284314');" style=""> 152                      whereNode.getOperands()[2].toString() : whereNode.getOperands()[conditionIndex].toString();   </span>
<span  style=""> 153                                                                                                                    </span>
<span class="-1206547946994992687" onmouseenter="enter('-1206547946994992687');" onmouseout="out('-1206547946994992687');" style=""><abbr title=" 154              PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(operatorKind.toString())"> 154              PredicateInfo predicateInfo = PredicateInfo.builder().setOperatorName(operatorName).setOperatorKind(op🔵</abbr></span>
<span class="-7910070237514947571" onmouseenter="enter('-7910070237514947571');" onmouseout="out('-7910070237514947571');" style=""> 155                      .setOwnerTable(ownerTable).setFieldName(fieldName).setCondition(content).build();             </span>
<span class="2100038020113072635" onmouseenter="enter('2100038020113072635');" onmouseout="out('2100038020113072635');" style=""> 156              predicatesInfoList.add(predicateInfo);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158      }                                                                                                             </span>
<span  style=""> 159                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            