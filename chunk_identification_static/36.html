<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>36</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    36
                    <a href="35.html">prev</a>
                    <a href="37.html">next</a>
                    <a href="36_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Automattic/simplenote-android_4e1fa0199c788f410832032e7aff720f0bc7c32d_Simplenote/src/main/java/com/automattic/simplenote/models/Note.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;4e1fa0199c788f410832032e7aff720f0bc7c32d:Simplenote/src/main/java/com/automattic/simplenote/models/Note.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;4e1fa0199c788f410832032e7aff720f0bc7c32d^1:Simplenote/src/main/java/com/automattic/simplenote/models/Note.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;4e1fa0199c788f410832032e7aff720f0bc7c32d^2:Simplenote/src/main/java/com/automattic/simplenote/models/Note.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;3a764d7c3f78240be2e14be35d5bf4517e6f794e:Simplenote/src/main/java/com/automattic/simplenote/models/Note.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="9181943406056492869" onmouseenter="enter('9181943406056492869');" onmouseout="out('9181943406056492869');" style="">   1 package com.automattic.simplenote.models;                                                                </span>
<span  style="">   2                                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3 import android.content.Context;                                                                          </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   4 import android.text.TextUtils;                                                                           </span>
<span  style="">   5                                                                                                          </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   6 import androidx.annotation.NonNull;                                                                      </span>
<span  style="">   7                                                                                                          </span>
<span class="-6092371777820512633" onmouseenter="enter('-6092371777820512633');" onmouseout="out('-6092371777820512633');" style="">   8 import com.automattic.simplenote.R;                                                                      </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">   9 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="1225693603979668275" onmouseenter="enter('1225693603979668275');" onmouseout="out('1225693603979668275');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  10 import com.automattic.simplenote.utils.DateTimeUtils;                                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  11 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12 import com.simperium.client.Bucket;                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  13 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  14 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-643769428942460504" onmouseenter="enter('-643769428942460504');" onmouseout="out('-643769428942460504');" style="">  15 import com.automattic.simplenote.utils.TagUtils;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  16 import com.simperium.client.Bucket;                                                                      </span>
<span class="6125639164043971044" onmouseenter="enter('6125639164043971044');" onmouseout="out('6125639164043971044');" style="">  17 import com.simperium.client.BucketObject;                                                                </span>
<span class="-665307165473523580" onmouseenter="enter('-665307165473523580');" onmouseout="out('-665307165473523580');" style="">  18 import com.simperium.client.BucketSchema;                                                                </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  19 import com.simperium.client.Query;                                                                       </span>
<span class="-838252138947964043" onmouseenter="enter('-838252138947964043');" onmouseout="out('-838252138947964043');" style="">  20 import com.simperium.client.Query.ComparisonType;                                                        </span>
<span class="708242169313900219" onmouseenter="enter('708242169313900219');" onmouseout="out('708242169313900219');" style="">  21 import com.simperium.util.Uuid;                                                                          </span>
<span  style="">  22                                                                                                          </span>
<span class="-9193129351684262878" onmouseenter="enter('-9193129351684262878');" onmouseout="out('-9193129351684262878');" style="">  23 import org.json.JSONArray;                                                                               </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  24 import org.json.JSONException;                                                                           </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  25 import org.json.JSONObject;                                                                              </span>
<span  style="">  26                                                                                                          </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  27 import java.math.BigDecimal;                                                                             </span>
<span class="1238662365364477381" onmouseenter="enter('1238662365364477381');" onmouseout="out('1238662365364477381');" style="">  28 import java.text.DateFormat;                                                                             </span>
<span class="39790854174282861" onmouseenter="enter('39790854174282861');" onmouseout="out('39790854174282861');" style="">  29 import java.text.ParseException;                                                                         </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  30 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  31 import java.util.ArrayList;                                                                              </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  32 import java.util.Calendar;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  33 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  34 import java.util.Locale;                                                                                 </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  35 import java.util.TimeZone;                                                                               </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  36 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  37 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  38                                                                                                          </span>
<span class="-4405840676582391526" onmouseenter="enter('-4405840676582391526');" onmouseout="out('-4405840676582391526');" style="">  39 import static com.automattic.simplenote.utils.SimplenoteLinkify.SIMPLENOTE_LINK_PREFIX;                  </span>
<span  style="">  40                                                                                                          </span>
<span class="1630911635596164534" onmouseenter="enter('1630911635596164534');" onmouseout="out('1630911635596164534');" style="">  41 public class Note extends BucketObject {                                                                 </span>
<span  style="">  42                                                                                                          </span>
<span class="308952937305736491" onmouseenter="enter('308952937305736491');" onmouseout="out('308952937305736491');" style="">  43     public static final String BUCKET_NAME = &quot;note&quot;;                                                     </span>
<span class="6014442145961064017" onmouseenter="enter('6014442145961064017');" onmouseout="out('6014442145961064017');" style="">  44     public static final String MARKDOWN_TAG = &quot;markdown&quot;;                                                </span>
<span class="-8101559688416496628" onmouseenter="enter('-8101559688416496628');" onmouseout="out('-8101559688416496628');" style="">  45     public static final String PINNED_TAG = &quot;pinned&quot;;                                                    </span>
<span class="2755303258201669627" onmouseenter="enter('2755303258201669627');" onmouseout="out('2755303258201669627');" style="">  46     public static final String PREVIEW_TAG = &quot;preview&quot;;                                                  </span>
<span class="1168195147039968761" onmouseenter="enter('1168195147039968761');" onmouseout="out('1168195147039968761');" style="">  47     public static final String PUBLISHED_TAG = &quot;published&quot;;                                              </span>
<span class="6384737125939709481" onmouseenter="enter('6384737125939709481');" onmouseout="out('6384737125939709481');" style="">  48     public static final String NEW_LINE = &quot;\n&quot;;                                                          </span>
<span class="-6709867799447959845" onmouseenter="enter('-6709867799447959845');" onmouseout="out('-6709867799447959845');" style="">  49     public static final String CONTENT_PROPERTY = &quot;content&quot;;                                             </span>
<span class="-7150784166370340219" onmouseenter="enter('-7150784166370340219');" onmouseout="out('-7150784166370340219');" style="">  50     public static final String KEY_PROPERTY = &quot;key&quot;;                                                     </span>
<span class="-2027165692804872527" onmouseenter="enter('-2027165692804872527');" onmouseout="out('-2027165692804872527');" style="">  51     public static final String TAGS_PROPERTY = &quot;tags&quot;;                                                   </span>
<span class="-2782765636412056512" onmouseenter="enter('-2782765636412056512');" onmouseout="out('-2782765636412056512');" style="">  52     public static final String SYSTEM_TAGS_PROPERTY = &quot;systemTags&quot;;                                      </span>
<span class="8082059840675302216" onmouseenter="enter('8082059840675302216');" onmouseout="out('8082059840675302216');" style="">  53     public static final String CREATION_DATE_PROPERTY = &quot;creationDate&quot;;                                  </span>
<span class="-4622628390272251051" onmouseenter="enter('-4622628390272251051');" onmouseout="out('-4622628390272251051');" style="">  54     public static final String MODIFICATION_DATE_PROPERTY = &quot;modificationDate&quot;;                          </span>
<span class="-2614611438740057503" onmouseenter="enter('-2614611438740057503');" onmouseout="out('-2614611438740057503');" style="">  55     public static final String SHARE_URL_PROPERTY = &quot;shareURL&quot;;                                          </span>
<span class="1336476452932138514" onmouseenter="enter('1336476452932138514');" onmouseout="out('1336476452932138514');" style="">  56     public static final String PUBLISH_URL_PROPERTY = &quot;publishURL&quot;;                                      </span>
<span class="-813041889408259553" onmouseenter="enter('-813041889408259553');" onmouseout="out('-813041889408259553');" style="">  57     public static final String DELETED_PROPERTY = &quot;deleted&quot;;                                             </span>
<span class="4804610397042036134" onmouseenter="enter('4804610397042036134');" onmouseout="out('4804610397042036134');" style="">  58     public static final String TITLE_INDEX_NAME = &quot;title&quot;;                                               </span>
<span class="941632753921114575" onmouseenter="enter('941632753921114575');" onmouseout="out('941632753921114575');" style="">  59     public static final String CONTENT_PREVIEW_INDEX_NAME = &quot;contentPreview&quot;;                            </span>
<span class="4601116861733775409" onmouseenter="enter('4601116861733775409');" onmouseout="out('4601116861733775409');" style="">  60     public static final String PINNED_INDEX_NAME = &quot;pinned&quot;;                                             </span>
<span class="-5028217336186587547" onmouseenter="enter('-5028217336186587547');" onmouseout="out('-5028217336186587547');" style="">  61     public static final String MODIFIED_INDEX_NAME = &quot;modified&quot;;                                         </span>
<span class="-2754009865833796434" onmouseenter="enter('-2754009865833796434');" onmouseout="out('-2754009865833796434');" style="">  62     public static final String CREATED_INDEX_NAME = &quot;created&quot;;                                           </span>
<span class="-620094810998015131" onmouseenter="enter('-620094810998015131');" onmouseout="out('-620094810998015131');" style="">  63     public static final String MATCHED_TITLE_INDEX_NAME = &quot;matchedTitle&quot;;                                </span>
<span class="5961311022296185233" onmouseenter="enter('5961311022296185233');" onmouseout="out('5961311022296185233');" style="">  64     public static final String MATCHED_CONTENT_INDEX_NAME = &quot;matchedContent&quot;;                            </span>
<span class="354077366863542774" onmouseenter="enter('354077366863542774');" onmouseout="out('354077366863542774');" style="">  65     public static final String PUBLISH_URL = &quot;http://simp.ly/p/&quot;;                                        </span>
<span class="2475488422216258991" onmouseenter="enter('2475488422216258991');" onmouseout="out('2475488422216258991');" style="">  66     static public final String[] FULL_TEXT_INDEXES = new String[]{                                       </span>
<span class="394877313876947494" onmouseenter="enter('394877313876947494');" onmouseout="out('394877313876947494');" style="">  67             Note.TITLE_INDEX_NAME, Note.CONTENT_PROPERTY};                                               </span>
<span class="-4178348678314657322" onmouseenter="enter('-4178348678314657322');" onmouseout="out('-4178348678314657322');" style="">  68     private static final String BLANK_CONTENT = &quot;&quot;;                                                      </span>
<span class="-8217848203306725764" onmouseenter="enter('-8217848203306725764');" onmouseout="out('-8217848203306725764');" style="">  69     private static final String SPACE = &quot; &quot;;                                                             </span>
<span class="7999038666256371202" onmouseenter="enter('7999038666256371202');" onmouseout="out('7999038666256371202');" style="">  70     private static final int MAX_PREVIEW_CHARS = 300;                                                    </span>
<span class="6617027899127222559" onmouseenter="enter('6617027899127222559');" onmouseout="out('6617027899127222559');" style="">  71     protected String mTitle = null;                                                                      </span>
<span class="-1758175371106332326" onmouseenter="enter('-1758175371106332326');" onmouseout="out('-1758175371106332326');" style="">  72     protected String mContentPreview = null;                                                             </span>
<span  style="">  73                                                                                                          </span>
<span class="-1397623179598998233" onmouseenter="enter('-1397623179598998233');" onmouseout="out('-1397623179598998233');" style="">  74     public Note() {                                                                                      </span>
<span class="-1154746796976603421" onmouseenter="enter('-1154746796976603421');" onmouseout="out('-1154746796976603421');" style="">  75         this(Uuid.uuid());                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="767263449852825375" onmouseenter="enter('767263449852825375');" onmouseout="out('767263449852825375');" style="">  78     public Note(String key) {                                                                            </span>
<span class="53769298429916076" onmouseenter="enter('53769298429916076');" onmouseout="out('53769298429916076');" style="">  79         this(key, new JSONObject());                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80     }                                                                                                    </span>
<span  style="">  81                                                                                                          </span>
<span class="8617384997772879313" onmouseenter="enter('8617384997772879313');" onmouseout="out('8617384997772879313');" style="">  82     public Note(String key, JSONObject properties) {                                                     </span>
<span class="-6821486208075908487" onmouseenter="enter('-6821486208075908487');" onmouseout="out('-6821486208075908487');" style="">  83         super(key, properties);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="458900878223274025" onmouseenter="enter('458900878223274025');" onmouseout="out('458900878223274025');" style="">  86     public static Query&lt;Note&gt; all(Bucket&lt;Note&gt; noteBucket) {                                             </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  87         return noteBucket.query()                                                                        </span>
<span class="-6142536283945774731" onmouseenter="enter('-6142536283945774731');" onmouseout="out('-6142536283945774731');" style="">  88                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span  style="">  90                                                                                                          </span>
<span class="-6525045200709488349" onmouseenter="enter('-6525045200709488349');" onmouseout="out('-6525045200709488349');" style="">  91     public static Query&lt;Note&gt; allDeleted(Bucket&lt;Note&gt; noteBucket) {                                      </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  92         return noteBucket.query()                                                                        </span>
<span class="-6326653849445488397" onmouseenter="enter('-6326653849445488397');" onmouseout="out('-6326653849445488397');" style="">  93                 .where(DELETED_PROPERTY, ComparisonType.EQUAL_TO, true);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94     }                                                                                                    </span>
<span  style="">  95                                                                                                          </span>
<span class="4789545620535823187" onmouseenter="enter('4789545620535823187');" onmouseout="out('4789545620535823187');" style="">  96     public static Query&lt;Note&gt; search(Bucket&lt;Note&gt; noteBucket, String searchString) {                     </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  97         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  98                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-8956541673379552524" onmouseenter="enter('-8956541673379552524');" onmouseout="out('-8956541673379552524');" style="">  99                 .where(CONTENT_PROPERTY, ComparisonType.LIKE, &quot;%&quot; + searchString + &quot;%&quot;);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100     }                                                                                                    </span>
<span  style=""> 101                                                                                                          </span>
<span class="-1229245405128052241" onmouseenter="enter('-1229245405128052241');" onmouseout="out('-1229245405128052241');" style=""> 102     public static Query&lt;Note&gt; allInTag(Bucket&lt;Note&gt; noteBucket, String tag) {                            </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style=""> 103         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 104                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-2207133284802963072" onmouseenter="enter('-2207133284802963072');" onmouseout="out('-2207133284802963072');" style=""> 105                 .where(TAGS_PROPERTY, ComparisonType.LIKE, tag);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="2971412545726517521" onmouseenter="enter('2971412545726517521');" onmouseout="out('2971412545726517521');" style=""> 108     public static Query&lt;Note&gt; allWithNoTag(Bucket&lt;Note&gt; noteBucket) {                                    </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style=""> 109         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 110                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="6567927526378864260" onmouseenter="enter('6567927526378864260');" onmouseout="out('6567927526378864260');" style=""> 111                 .where(TAGS_PROPERTY, ComparisonType.EQUAL_TO, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span  style=""> 113                                                                                                          </span>
<span class="-8938802169787860370" onmouseenter="enter('-8938802169787860370');" onmouseout="out('-8938802169787860370');" style=""> 114     public static Note fromContent(Bucket&lt;Note&gt; notesBucket, String content) {                           </span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 115         Note note = notesBucket.newObject();                                                             </span>
<span class="8912392529601079939" onmouseenter="enter('8912392529601079939');" onmouseout="out('8912392529601079939');" style=""> 116         note.setContent(content);                                                                        </span>
<span class="1465773082586789630" onmouseenter="enter('1465773082586789630');" onmouseout="out('1465773082586789630');" style=""> 117         note.setCreationDate(Calendar.getInstance());                                                    </span>
<span class="-2721490489979887121" onmouseenter="enter('-2721490489979887121');" onmouseout="out('-2721490489979887121');" style=""> 118         note.setModificationDate(note.getCreationDate());                                                </span>
<span  style=""> 119                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 120         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121     }                                                                                                    </span>
<span  style=""> 122                                                                                                          </span>
<span class="-5396846739988471840" onmouseenter="enter('-5396846739988471840');" onmouseout="out('-5396846739988471840');" style=""><abbr title=" 123     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONException, ParseException {"> 123     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONExcepti🔵</abbr></span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 124         Note note = notesBucket.newObject();                                                             </span>
<span class="3098500428867040128" onmouseenter="enter('3098500428867040128');" onmouseout="out('3098500428867040128');" style=""> 125         note.setContent(noteJson.optString(&quot;content&quot;, &quot;&quot;));                                              </span>
<span class="-8154332140304970847" onmouseenter="enter('-8154332140304970847');" onmouseout="out('-8154332140304970847');" style=""><abbr title=" 126         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;creationDate&quot;)) : Calendar.getInstance());"> 126         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getStr🔵</abbr></span>
<span class="-8572711449683887689" onmouseenter="enter('-8572711449683887689');" onmouseout="out('-8572711449683887689');" style=""><abbr title=" 127         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;lastModified&quot;)) : Calendar.getInstance());"> 127         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.ge🔵</abbr></span>
<span class="-5498600081013067663" onmouseenter="enter('-5498600081013067663');" onmouseout="out('-5498600081013067663');" style=""> 128         note.setTags(noteJson.has(&quot;tags&quot;) ? noteJson.getJSONArray(&quot;tags&quot;) : new JSONArray());            </span>
<span class="875604650523146036" onmouseenter="enter('875604650523146036');" onmouseout="out('875604650523146036');" style=""> 129         note.setPinned(noteJson.optBoolean(&quot;pinned&quot;, false));                                            </span>
<span class="1705691732106409520" onmouseenter="enter('1705691732106409520');" onmouseout="out('1705691732106409520');" style=""> 130         note.setMarkdownEnabled(noteJson.optBoolean(&quot;markdown&quot;, false));                                 </span>
<span  style=""> 131                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 132         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="-5517811679430868458" onmouseenter="enter('-5517811679430868458');" onmouseout="out('-5517811679430868458');" style=""> 135     @SuppressWarnings(&quot;unused&quot;)                                                                          </span>
<span class="-4700657283235731904" onmouseenter="enter('-4700657283235731904');" onmouseout="out('-4700657283235731904');" style=""> 136     public static String dateString(Number time, boolean useShortFormat, Context context) {              </span>
<span class="1180405838137731219" onmouseenter="enter('1180405838137731219');" onmouseout="out('1180405838137731219');" style=""> 137         Calendar c = numberToDate(time);                                                                 </span>
<span class="-7277187246954612403" onmouseenter="enter('-7277187246954612403');" onmouseout="out('-7277187246954612403');" style=""> 138         return dateString(c, useShortFormat, context);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="-8567197073889182513" onmouseenter="enter('-8567197073889182513');" onmouseout="out('-8567197073889182513');" style=""> 141     public static String dateString(Calendar c, boolean useShortFormat, Context context) {               </span>
<span class="-4601601397388656558" onmouseenter="enter('-4601601397388656558');" onmouseout="out('-4601601397388656558');" style=""> 142         int year, month, day;                                                                            </span>
<span  style=""> 143                                                                                                          </span>
<span class="-7517224838183820978" onmouseenter="enter('-7517224838183820978');" onmouseout="out('-7517224838183820978');" style=""> 144         String time, date, retVal;                                                                       </span>
<span  style=""> 145                                                                                                          </span>
<span class="-7023974272217551721" onmouseenter="enter('-7023974272217551721');" onmouseout="out('-7023974272217551721');" style=""> 146         Calendar diff = Calendar.getInstance();                                                          </span>
<span class="7346751312817051138" onmouseenter="enter('7346751312817051138');" onmouseout="out('7346751312817051138');" style=""> 147         diff.setTimeInMillis(diff.getTimeInMillis() - c.getTimeInMillis());                              </span>
<span  style=""> 148                                                                                                          </span>
<span class="-2909064038838300707" onmouseenter="enter('-2909064038838300707');" onmouseout="out('-2909064038838300707');" style=""> 149         year = diff.get(Calendar.YEAR);                                                                  </span>
<span class="-5868815277479911950" onmouseenter="enter('-5868815277479911950');" onmouseout="out('-5868815277479911950');" style=""> 150         month = diff.get(Calendar.MONTH);                                                                </span>
<span class="-2637536938238774465" onmouseenter="enter('-2637536938238774465');" onmouseout="out('-2637536938238774465');" style=""> 151         day = diff.get(Calendar.DAY_OF_MONTH);                                                           </span>
<span  style=""> 152                                                                                                          </span>
<span class="1536424719044438994" onmouseenter="enter('1536424719044438994');" onmouseout="out('1536424719044438994');" style=""> 153         diff.setTimeInMillis(0); // starting time                                                        </span>
<span class="-779753610725741249" onmouseenter="enter('-779753610725741249');" onmouseout="out('-779753610725741249');" style=""> 154         time = DateFormat.getTimeInstance(DateFormat.SHORT).format(c.getTime());                         </span>
<span class="-2383141111479093557" onmouseenter="enter('-2383141111479093557');" onmouseout="out('-2383141111479093557');" style=""><abbr title=" 155         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.DAY_OF_MONTH))) {"> 155         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(🔵</abbr></span>
<span class="7635099361720652074" onmouseenter="enter('7635099361720652074');" onmouseout="out('7635099361720652074');" style=""> 156             date = context.getResources().getString(R.string.today);                                     </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 157             if (useShortFormat)                                                                          </span>
<span class="597955899566079772" onmouseenter="enter('597955899566079772');" onmouseout="out('597955899566079772');" style=""> 158                 retVal = time;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 159             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 160                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-818230175523660822" onmouseenter="enter('-818230175523660822');" onmouseout="out('-818230175523660822');" style=""><abbr title=" 161         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)) {"> 161         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)🔵</abbr></span>
<span class="-8420997342841621789" onmouseenter="enter('-8420997342841621789');" onmouseout="out('-8420997342841621789');" style=""> 162             date = context.getResources().getString(R.string.yesterday);                                 </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 163             if (useShortFormat)                                                                          </span>
<span class="8381191313867632389" onmouseenter="enter('8381191313867632389');" onmouseout="out('8381191313867632389');" style=""> 164                 retVal = date;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 165             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 166                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 167         } else {                                                                                         </span>
<span class="-8110415762919125838" onmouseenter="enter('-8110415762919125838');" onmouseout="out('-8110415762919125838');" style=""> 168             date = new SimpleDateFormat(&quot;MMM dd&quot;, Locale.US).format(c.getTime());                        </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 169             retVal = date + &quot;, &quot; + time;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span  style=""> 171                                                                                                          </span>
<span class="-2448447535460405943" onmouseenter="enter('-2448447535460405943');" onmouseout="out('-2448447535460405943');" style=""> 172         return retVal;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173     }                                                                                                    </span>
<span  style=""> 174                                                                                                          </span>
<span class="-1889536418011186938" onmouseenter="enter('-1889536418011186938');" onmouseout="out('-1889536418011186938');" style=""> 175     private static int getReferenceCount(String key, String content) {                                   </span>
<span class="-666706993090019623" onmouseenter="enter('-666706993090019623');" onmouseout="out('-666706993090019623');" style=""> 176         Pattern pattern = Pattern.compile(SIMPLENOTE_LINK_PREFIX + key);                                 </span>
<span class="-5723325120560414069" onmouseenter="enter('-5723325120560414069');" onmouseout="out('-5723325120560414069');" style=""> 177         Matcher matcher = pattern.matcher(content);                                                      </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 178         int count = 0;                                                                                   </span>
<span  style=""> 179                                                                                                          </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 180         while (matcher.find()) {                                                                         </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style=""> 181             count++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182         }                                                                                                </span>
<span  style=""> 183                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 184         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185     }                                                                                                    </span>
<span  style=""> 186                                                                                                          </span>
<span class="-3902014892596708789" onmouseenter="enter('-3902014892596708789');" onmouseout="out('-3902014892596708789');" style=""> 187     public static List&lt;Reference&gt; getReferences(Bucket&lt;Note&gt; bucket, String key) {                       </span>
<span class="-6029684357073269481" onmouseenter="enter('-6029684357073269481');" onmouseout="out('-6029684357073269481');" style=""> 188         List&lt;Reference&gt; references = new ArrayList&lt;&gt;();                                                  </span>
<span class="-4658611266183475458" onmouseenter="enter('-4658611266183475458');" onmouseout="out('-4658611266183475458');" style=""> 189         Bucket.ObjectCursor&lt;Note&gt; cursor = Note.search(bucket, SIMPLENOTE_LINK_PREFIX + key).execute();  </span>
<span  style=""> 190                                                                                                          </span>
<span class="-679463407698125917" onmouseenter="enter('-679463407698125917');" onmouseout="out('-679463407698125917');" style=""> 191         while (cursor.moveToNext()) {                                                                    </span>
<span class="3501306350092034788" onmouseenter="enter('3501306350092034788');" onmouseout="out('3501306350092034788');" style=""> 192             Note note = cursor.getObject();                                                              </span>
<span class="-4285952824793620055" onmouseenter="enter('-4285952824793620055');" onmouseout="out('-4285952824793620055');" style=""> 193             references.add(                                                                              </span>
<span class="-1411633905067872974" onmouseenter="enter('-1411633905067872974');" onmouseout="out('-1411633905067872974');" style=""> 194                 new Reference(                                                                           </span>
<span class="-3110909059350189445" onmouseenter="enter('-3110909059350189445');" onmouseout="out('-3110909059350189445');" style=""> 195                     note.getSimperiumKey(),                                                              </span>
<span class="2543604805982207984" onmouseenter="enter('2543604805982207984');" onmouseout="out('2543604805982207984');" style=""> 196                     note.getTitle(),                                                                     </span>
<span class="7904695514627173906" onmouseenter="enter('7904695514627173906');" onmouseout="out('7904695514627173906');" style=""> 197                     note.getModificationDate(),                                                          </span>
<span class="5299483559431490396" onmouseenter="enter('5299483559431490396');" onmouseout="out('5299483559431490396');" style=""> 198                     getReferenceCount(key, note.getContent())                                            </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 199                 )                                                                                        </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 200             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201         }                                                                                                </span>
<span  style=""> 202                                                                                                          </span>
<span class="-816749515151999705" onmouseenter="enter('-816749515151999705');" onmouseout="out('-816749515151999705');" style=""> 203         return references;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204     }                                                                                                    </span>
<span  style=""> 205                                                                                                          </span>
<span class="6991191424901834769" onmouseenter="enter('6991191424901834769');" onmouseout="out('6991191424901834769');" style=""> 206     public static Calendar numberToDate(Number time) {                                                   </span>
<span class="2627151998164378009" onmouseenter="enter('2627151998164378009');" onmouseout="out('2627151998164378009');" style=""> 207         Calendar date = Calendar.getInstance();                                                          </span>
<span class="-4794582782203016972" onmouseenter="enter('-4794582782203016972');" onmouseout="out('-4794582782203016972');" style=""> 208         if (time != null) {                                                                              </span>
<span class="-3733626690602126121" onmouseenter="enter('-3733626690602126121');" onmouseout="out('-3733626690602126121');" style=""> 209             // Flick Note uses millisecond resolution timestamps Simplenote expects seconds              </span>
<span class="3026137703351918876" onmouseenter="enter('3026137703351918876');" onmouseout="out('3026137703351918876');" style=""> 210             // since we only deal with create and modify timestamps, they should all have occurred       </span>
<span class="-9197945245707351438" onmouseenter="enter('-9197945245707351438');" onmouseout="out('-9197945245707351438');" style=""> 211             // at the present time or in the past.                                                       </span>
<span class="-5330372272438133634" onmouseenter="enter('-5330372272438133634');" onmouseout="out('-5330372272438133634');" style=""> 212             float now = (float) date.getTimeInMillis() / 1000;                                           </span>
<span class="7868403810214452697" onmouseenter="enter('7868403810214452697');" onmouseout="out('7868403810214452697');" style=""> 213             float magnitude = time.floatValue() / now;                                                   </span>
<span class="5909991427144614543" onmouseenter="enter('5909991427144614543');" onmouseout="out('5909991427144614543');" style=""> 214             if (magnitude &gt;= 2.f) time = time.longValue() / 1000;                                        </span>
<span class="2284249078526717288" onmouseenter="enter('2284249078526717288');" onmouseout="out('2284249078526717288');" style=""> 215             date.setTimeInMillis(time.longValue() * 1000);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216         }                                                                                                </span>
<span class="7179427650659377170" onmouseenter="enter('7179427650659377170');" onmouseout="out('7179427650659377170');" style=""> 217         return date;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="466463869222866851" onmouseenter="enter('466463869222866851');" onmouseout="out('466463869222866851');" style=""> 220     public static String numberToDateString(@NonNull Number number) {                                    </span>
<span class="-4090451846849985785" onmouseenter="enter('-4090451846849985785');" onmouseout="out('-4090451846849985785');" style=""> 221         long milliseconds = new BigDecimal(number.toString()).multiply(new BigDecimal(1000)).longValue();</span>
<span class="2239009023688190143" onmouseenter="enter('2239009023688190143');" onmouseout="out('2239009023688190143');" style=""> 222         Calendar calendar = Calendar.getInstance();                                                      </span>
<span class="9071902319976922096" onmouseenter="enter('9071902319976922096');" onmouseout="out('9071902319976922096');" style=""> 223         calendar.setTimeInMillis(milliseconds);                                                          </span>
<span class="-1960866814541712569" onmouseenter="enter('-1960866814541712569');" onmouseout="out('-1960866814541712569');" style=""> 224         SimpleDateFormat date = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSS&#x27;Z&#x27;&quot;, Locale.US);         </span>
<span class="1592748650922216684" onmouseenter="enter('1592748650922216684');" onmouseout="out('1592748650922216684');" style=""> 225         date.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));                                                   </span>
<span class="5827364706871365292" onmouseenter="enter('5827364706871365292');" onmouseout="out('5827364706871365292');" style=""> 226         return date.format(calendar.getTime());                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="6373335669519535085" onmouseenter="enter('6373335669519535085');" onmouseout="out('6373335669519535085');" style=""> 229     protected void updateTitleAndPreview() {                                                             </span>
<span class="4716811977187622861" onmouseenter="enter('4716811977187622861');" onmouseout="out('4716811977187622861');" style=""> 230         // try to build a title and preview property out of content                                      </span>
<span class="-6823550475843248983" onmouseenter="enter('-6823550475843248983');" onmouseout="out('-6823550475843248983');" style=""> 231         String content = getContent().trim();                                                            </span>
<span class="327463840444924073" onmouseenter="enter('327463840444924073');" onmouseout="out('327463840444924073');" style=""> 232         if (content.length() &gt; MAX_PREVIEW_CHARS) {                                                      </span>
<span class="-8480236902805956072" onmouseenter="enter('-8480236902805956072');" onmouseout="out('-8480236902805956072');" style=""> 233             content = content.substring(0, MAX_PREVIEW_CHARS - 1);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234         }                                                                                                </span>
<span  style=""> 235                                                                                                          </span>
<span class="5724017298410569034" onmouseenter="enter('5724017298410569034');" onmouseout="out('5724017298410569034');" style=""> 236         int firstNewLinePosition = content.indexOf(NEW_LINE);                                            </span>
<span class="7786689878958261573" onmouseenter="enter('7786689878958261573');" onmouseout="out('7786689878958261573');" style=""> 237         if (firstNewLinePosition &gt; -1 &amp;&amp; firstNewLinePosition &lt; 200) {                                   </span>
<span class="-397121944761876346" onmouseenter="enter('-397121944761876346');" onmouseout="out('-397121944761876346');" style=""> 238             mTitle = content.substring(0, firstNewLinePosition).trim();                                  </span>
<span  style=""> 239                                                                                                          </span>
<span class="6552686713144756852" onmouseenter="enter('6552686713144756852');" onmouseout="out('6552686713144756852');" style=""> 240             if (firstNewLinePosition &lt; content.length()) {                                               </span>
<span class="3544130446617579720" onmouseenter="enter('3544130446617579720');" onmouseout="out('3544130446617579720');" style=""> 241                 mContentPreview = content.substring(firstNewLinePosition, content.length());             </span>
<span class="-6018298786369494309" onmouseenter="enter('-6018298786369494309');" onmouseout="out('-6018298786369494309');" style=""><abbr title=" 242                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).trim();"> 242                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 243             } else {                                                                                     </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 244                 mContentPreview = content;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 246         } else {                                                                                         </span>
<span class="6158164289681498296" onmouseenter="enter('6158164289681498296');" onmouseout="out('6158164289681498296');" style=""> 247             mTitle = content;                                                                            </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 248             mContentPreview = content;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="-6200437978572139135" onmouseenter="enter('-6200437978572139135');" onmouseout="out('-6200437978572139135');" style=""> 252     public String getTitle() {                                                                           </span>
<span class="5880156293984643419" onmouseenter="enter('5880156293984643419');" onmouseout="out('5880156293984643419');" style=""> 253         if (mTitle == null) {                                                                            </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 254             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255         }                                                                                                </span>
<span class="-7721657982940010876" onmouseenter="enter('-7721657982940010876');" onmouseout="out('-7721657982940010876');" style=""> 256         return mTitle;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257     }                                                                                                    </span>
<span  style=""> 258                                                                                                          </span>
<span class="-2689785139225953203" onmouseenter="enter('-2689785139225953203');" onmouseout="out('-2689785139225953203');" style=""> 259     public String getContent() {                                                                         </span>
<span class="-593492380737036583" onmouseenter="enter('-593492380737036583');" onmouseout="out('-593492380737036583');" style=""> 260         Object content = getProperty(CONTENT_PROPERTY);                                                  </span>
<span class="-2591100211143552235" onmouseenter="enter('-2591100211143552235');" onmouseout="out('-2591100211143552235');" style=""> 261         if (content == null) {                                                                           </span>
<span class="-7439137145129124014" onmouseenter="enter('-7439137145129124014');" onmouseout="out('-7439137145129124014');" style=""> 262             return BLANK_CONTENT;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263         }                                                                                                </span>
<span class="-5104065841615841974" onmouseenter="enter('-5104065841615841974');" onmouseout="out('-5104065841615841974');" style=""> 264         return (String) content;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="8530044186661736565" onmouseenter="enter('8530044186661736565');" onmouseout="out('8530044186661736565');" style=""> 267     public void setContent(String content) {                                                             </span>
<span class="6017523628383929627" onmouseenter="enter('6017523628383929627');" onmouseout="out('6017523628383929627');" style=""> 268         mTitle = null;                                                                                   </span>
<span class="7468898004511818931" onmouseenter="enter('7468898004511818931');" onmouseout="out('7468898004511818931');" style=""> 269         mContentPreview = null;                                                                          </span>
<span class="-7075313288269577686" onmouseenter="enter('-7075313288269577686');" onmouseout="out('-7075313288269577686');" style=""> 270         setProperty(CONTENT_PROPERTY, content);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="-3177715860988830633" onmouseenter="enter('-3177715860988830633');" onmouseout="out('-3177715860988830633');" style=""> 273     public String getContentPreview() {                                                                  </span>
<span class="-8081599038098376119" onmouseenter="enter('-8081599038098376119');" onmouseout="out('-8081599038098376119');" style=""> 274         if (mContentPreview == null) {                                                                   </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 275             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276         }                                                                                                </span>
<span class="-7686656279835722897" onmouseenter="enter('-7686656279835722897');" onmouseout="out('-7686656279835722897');" style=""> 277         return mContentPreview;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span class="-4775876413201063426" onmouseenter="enter('-4775876413201063426');" onmouseout="out('-4775876413201063426');" style=""> 280     public Calendar getCreationDate() {                                                                  </span>
<span class="-8932394895206293128" onmouseenter="enter('-8932394895206293128');" onmouseout="out('-8932394895206293128');" style=""> 281         return numberToDate((Number) getProperty(CREATION_DATE_PROPERTY));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282     }                                                                                                    </span>
<span  style=""> 283                                                                                                          </span>
<span class="3941971105481464917" onmouseenter="enter('3941971105481464917');" onmouseout="out('3941971105481464917');" style=""> 284     public String getCreationDateString() {                                                              </span>
<span class="9031070846992233121" onmouseenter="enter('9031070846992233121');" onmouseout="out('9031070846992233121');" style=""> 285         return numberToDateString((Number) getProperty(CREATION_DATE_PROPERTY));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286     }                                                                                                    </span>
<span  style=""> 287                                                                                                          </span>
<span class="4285319693858833712" onmouseenter="enter('4285319693858833712');" onmouseout="out('4285319693858833712');" style=""> 288     public void setCreationDate(Calendar creationDate) {                                                 </span>
<span class="-3054849024529806025" onmouseenter="enter('-3054849024529806025');" onmouseout="out('-3054849024529806025');" style=""> 289         setProperty(CREATION_DATE_PROPERTY, creationDate.getTimeInMillis() / 1000);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290     }                                                                                                    </span>
<span  style=""> 291                                                                                                          </span>
<span class="4524335170961506892" onmouseenter="enter('4524335170961506892');" onmouseout="out('4524335170961506892');" style=""> 292     public Calendar getModificationDate() {                                                              </span>
<span class="-7489834958201786921" onmouseenter="enter('-7489834958201786921');" onmouseout="out('-7489834958201786921');" style=""> 293         return numberToDate((Number) getProperty(MODIFICATION_DATE_PROPERTY));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="8706492949654452164" onmouseenter="enter('8706492949654452164');" onmouseout="out('8706492949654452164');" style=""> 296     public String getModificationDateString() {                                                          </span>
<span class="-2749496034468843218" onmouseenter="enter('-2749496034468843218');" onmouseout="out('-2749496034468843218');" style=""> 297         return numberToDateString((Number) getProperty(MODIFICATION_DATE_PROPERTY));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298     }                                                                                                    </span>
<span  style=""> 299                                                                                                          </span>
<span class="2249083984085470814" onmouseenter="enter('2249083984085470814');" onmouseout="out('2249083984085470814');" style=""> 300     public void setModificationDate(Calendar modificationDate) {                                         </span>
<span class="-7005792304358284877" onmouseenter="enter('-7005792304358284877');" onmouseout="out('-7005792304358284877');" style=""> 301         setProperty(MODIFICATION_DATE_PROPERTY, modificationDate.getTimeInMillis() / 1000);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302     }                                                                                                    </span>
<span  style=""> 303                                                                                                          </span>
<span class="3367289575484325214" onmouseenter="enter('3367289575484325214');" onmouseout="out('3367289575484325214');" style=""> 304     public String getPublishedUrl() {                                                                    </span>
<span class="-5796973306134907482" onmouseenter="enter('-5796973306134907482');" onmouseout="out('-5796973306134907482');" style=""> 305         String urlCode = (String) getProperty(PUBLISH_URL_PROPERTY);                                     </span>
<span class="7900565639772953850" onmouseenter="enter('7900565639772953850');" onmouseout="out('7900565639772953850');" style=""> 306         if (TextUtils.isEmpty(urlCode)) {                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 307             return &quot;&quot;;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308         }                                                                                                </span>
<span  style=""> 309                                                                                                          </span>
<span class="-8429126260993259062" onmouseenter="enter('-8429126260993259062');" onmouseout="out('-8429126260993259062');" style=""> 310         return PUBLISH_URL + urlCode;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="6727514612417725571" onmouseenter="enter('6727514612417725571');" onmouseout="out('6727514612417725571');" style=""> 313     public boolean hasTag(String tag) {                                                                  </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 314         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-3541717492710720609" onmouseenter="enter('-3541717492710720609');" onmouseout="out('-3541717492710720609');" style=""> 315         String tagLower = tag.toLowerCase();                                                             </span>
<span class="-422766749461737265" onmouseenter="enter('-422766749461737265');" onmouseout="out('-422766749461737265');" style=""> 316         for (String tagName : tags) {                                                                    </span>
<span class="-6783003514598399026" onmouseenter="enter('-6783003514598399026');" onmouseout="out('-6783003514598399026');" style=""> 317             if (tagLower.equals(tagName.toLowerCase())) return true;                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 319         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320     }                                                                                                    </span>
<span  style=""> 321                                                                                                          </span>
<span class="1303119083327749335" onmouseenter="enter('1303119083327749335');" onmouseout="out('1303119083327749335');" style=""> 322     public boolean hasTag(Tag tag) {                                                                     </span>
<span class="-5268388303991583458" onmouseenter="enter('-5268388303991583458');" onmouseout="out('-5268388303991583458');" style=""> 323         return hasTag(tag.getSimperiumKey());                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324     }                                                                                                    </span>
<span  style=""> 325                                                                                                          </span>
<span class="-646587723470162813" onmouseenter="enter('-646587723470162813');" onmouseout="out('-646587723470162813');" style=""> 326     public List&lt;String&gt; getTags() {                                                                      </span>
<span  style=""> 327                                                                                                          </span>
<span class="5046858882238824028" onmouseenter="enter('5046858882238824028');" onmouseout="out('5046858882238824028');" style=""> 328         JSONArray tags = (JSONArray) getProperty(TAGS_PROPERTY);                                         </span>
<span  style=""> 329                                                                                                          </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 330         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 331             tags = new JSONArray();                                                                      </span>
<span class="-8058083631026170990" onmouseenter="enter('-8058083631026170990');" onmouseout="out('-8058083631026170990');" style=""> 332             setProperty(TAGS_PROPERTY, &quot;&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333         }                                                                                                </span>
<span  style=""> 334                                                                                                          </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 335         int length = tags.length();                                                                      </span>
<span  style=""> 336                                                                                                          </span>
<span class="-7737950325994950460" onmouseenter="enter('-7737950325994950460');" onmouseout="out('-7737950325994950460');" style=""> 337         List&lt;String&gt; tagList = new ArrayList&lt;&gt;(length);                                                  </span>
<span  style=""> 338                                                                                                          </span>
<span class="8256074331736484026" onmouseenter="enter('8256074331736484026');" onmouseout="out('8256074331736484026');" style=""> 339         if (length == 0) return tagList;                                                                 </span>
<span  style=""> 340                                                                                                          </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 341         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="-8917993594954591540" onmouseenter="enter('-8917993594954591540');" onmouseout="out('-8917993594954591540');" style=""> 342             String tag = tags.optString(i);                                                              </span>
<span class="-1947204619891178088" onmouseenter="enter('-1947204619891178088');" onmouseout="out('-1947204619891178088');" style=""> 343             if (!tag.equals(&quot;&quot;))                                                                         </span>
<span class="2557583924535716267" onmouseenter="enter('2557583924535716267');" onmouseout="out('2557583924535716267');" style=""> 344                 tagList.add(tag);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345         }                                                                                                </span>
<span  style=""> 346                                                                                                          </span>
<span class="-3183448331203603949" onmouseenter="enter('-3183448331203603949');" onmouseout="out('-3183448331203603949');" style=""> 347         return tagList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348     }                                                                                                    </span>
<span  style=""> 349                                                                                                          </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style=""> 350     public void removeTag(String tagName) {                                                              </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 351         List&lt;String&gt; tags = getTags();                                                                   </span>
<span  style=""> 352                                                                                                          </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style=""> 353         List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style=""> 354         tags.removeAll(tagsMatched);                                                                     </span>
<span  style=""> 355                                                                                                          </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 356         setTags(tags);                                                                                   </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style=""> 357         save();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="-6026710755135647724" onmouseenter="enter('-6026710755135647724');" onmouseout="out('-6026710755135647724');" style=""> 360     public void setTags(List&lt;String&gt; tags) {                                                             </span>
<span class="-8982714688054322872" onmouseenter="enter('-8982714688054322872');" onmouseout="out('-8982714688054322872');" style=""> 361         setProperty(TAGS_PROPERTY, new JSONArray(tags));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362     }                                                                                                    </span>
<span  style=""> 363                                                                                                          </span>
<span class="-1421161503350598143" onmouseenter="enter('-1421161503350598143');" onmouseout="out('-1421161503350598143');" style=""> 364     public void setTags(JSONArray tags) {                                                                </span>
<span class="-9171468773333999657" onmouseenter="enter('-9171468773333999657');" onmouseout="out('-9171468773333999657');" style=""> 365         setProperty(TAGS_PROPERTY, tags);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366     }                                                                                                    </span>
<span  style=""> 367                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 368     /**                                                                                                  </span>
<span class="2568101064766040631" onmouseenter="enter('2568101064766040631');" onmouseout="out('2568101064766040631');" style=""> 369      * String of tags delimited by a space                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 370      */                                                                                                  </span>
<span class="-8942719802141200658" onmouseenter="enter('-8942719802141200658');" onmouseout="out('-8942719802141200658');" style=""> 371     public CharSequence getTagString() {                                                                 </span>
<span class="-4644025499612109112" onmouseenter="enter('-4644025499612109112');" onmouseout="out('-4644025499612109112');" style=""> 372         StringBuilder tagString = new StringBuilder();                                                   </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 373         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-7185531782033852210" onmouseenter="enter('-7185531782033852210');" onmouseout="out('-7185531782033852210');" style=""> 374         for (String tag : tags) {                                                                        </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 375             if (tagString.length() &gt; 0) {                                                                </span>
<span class="-848655472163713161" onmouseenter="enter('-848655472163713161');" onmouseout="out('-848655472163713161');" style=""> 376                 tagString.append(SPACE);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377             }                                                                                            </span>
<span class="3299521276937168474" onmouseenter="enter('3299521276937168474');" onmouseout="out('3299521276937168474');" style=""> 378             tagString.append(tag);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="-3216397563367246452" onmouseenter="enter('-3216397563367246452');" onmouseout="out('-3216397563367246452');" style=""> 380         return tagString;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381     }                                                                                                    </span>
<span  style=""> 382                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 383     /**                                                                                                  </span>
<span class="516081738825732450" onmouseenter="enter('516081738825732450');" onmouseout="out('516081738825732450');" style=""> 384      * Sets the note&#x27;s tags by providing it with a {@link String} of space separated tags.               </span>
<span class="-3361819639621639487" onmouseenter="enter('-3361819639621639487');" onmouseout="out('-3361819639621639487');" style=""> 385      * Filters out duplicate tags.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 386      *                                                                                                   </span>
<span class="-3621424951438819239" onmouseenter="enter('-3621424951438819239');" onmouseout="out('-3621424951438819239');" style=""> 387      * @param tagString a space delimited list of tags                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 388      */                                                                                                  </span>
<span class="-7562161399809710400" onmouseenter="enter('-7562161399809710400');" onmouseout="out('-7562161399809710400');" style=""> 389     public void setTagString(String tagString) {                                                         </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 390         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-8892740331038047380" onmouseenter="enter('-8892740331038047380');" onmouseout="out('-8892740331038047380');" style=""> 391         tags.clear();                                                                                    </span>
<span  style=""> 392                                                                                                          </span>
<span class="7647632027089311583" onmouseenter="enter('7647632027089311583');" onmouseout="out('7647632027089311583');" style=""> 393         if (tagString == null) {                                                                         </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 394             setTags(tags);                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 395             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396         }                                                                                                </span>
<span  style=""> 397                                                                                                          </span>
<span class="-6765712323396427098" onmouseenter="enter('-6765712323396427098');" onmouseout="out('-6765712323396427098');" style=""> 398         // Make sure string has a trailing space                                                         </span>
<span class="3861570924678507302" onmouseenter="enter('3861570924678507302');" onmouseout="out('3861570924678507302');" style=""> 399         if (tagString.length() &gt; 1 &amp;&amp; !tagString.substring(tagString.length() - 1).equals(SPACE))        </span>
<span class="-5113585973277465859" onmouseenter="enter('-5113585973277465859');" onmouseout="out('-5113585973277465859');" style=""> 400             tagString = tagString + SPACE;                                                               </span>
<span class="5741128019150417186" onmouseenter="enter('5741128019150417186');" onmouseout="out('5741128019150417186');" style=""> 401         // for comparing case-insensitive strings, would like to find a way to                           </span>
<span class="-5706726934096139867" onmouseenter="enter('-5706726934096139867');" onmouseout="out('-5706726934096139867');" style=""> 402         // do this without allocating a new list and strings                                             </span>
<span class="5881300344958500433" onmouseenter="enter('5881300344958500433');" onmouseout="out('5881300344958500433');" style=""> 403         List&lt;String&gt; tagsUpperCase = new ArrayList&lt;&gt;();                                                  </span>
<span class="-8087573356169949002" onmouseenter="enter('-8087573356169949002');" onmouseout="out('-8087573356169949002');" style=""> 404         // remove all current tags                                                                       </span>
<span class="1170680636863075190" onmouseenter="enter('1170680636863075190');" onmouseout="out('1170680636863075190');" style=""> 405         int start = 0;                                                                                   </span>
<span class="2514405873256423103" onmouseenter="enter('2514405873256423103');" onmouseout="out('2514405873256423103');" style=""> 406         int next;                                                                                        </span>
<span class="-8708428587370728232" onmouseenter="enter('-8708428587370728232');" onmouseout="out('-8708428587370728232');" style=""> 407         String possible;                                                                                 </span>
<span class="3545966998003531195" onmouseenter="enter('3545966998003531195');" onmouseout="out('3545966998003531195');" style=""> 408         String possibleUpperCase;                                                                        </span>
<span class="-67055061468690966" onmouseenter="enter('-67055061468690966');" onmouseout="out('-67055061468690966');" style=""> 409         // search tag string for space characters and pull out individual tags                           </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 410         do {                                                                                             </span>
<span class="539196990274646798" onmouseenter="enter('539196990274646798');" onmouseout="out('539196990274646798');" style=""> 411             next = tagString.indexOf(SPACE, start);                                                      </span>
<span class="7441993871510338947" onmouseenter="enter('7441993871510338947');" onmouseout="out('7441993871510338947');" style=""> 412             if (next &gt; start) {                                                                          </span>
<span class="-6369978890856333437" onmouseenter="enter('-6369978890856333437');" onmouseout="out('-6369978890856333437');" style=""> 413                 possible = tagString.substring(start, next);                                             </span>
<span class="40967178918958955" onmouseenter="enter('40967178918958955');" onmouseout="out('40967178918958955');" style=""> 414                 possibleUpperCase = possible.toUpperCase();                                              </span>
<span class="-6789588636567169254" onmouseenter="enter('-6789588636567169254');" onmouseout="out('-6789588636567169254');" style=""> 415                 if (!possible.equals(SPACE) &amp;&amp; !tagsUpperCase.contains(possibleUpperCase)) {             </span>
<span class="8107171034948128222" onmouseenter="enter('8107171034948128222');" onmouseout="out('8107171034948128222');" style=""> 416                     tagsUpperCase.add(possibleUpperCase);                                                </span>
<span class="-3623952282264178458" onmouseenter="enter('-3623952282264178458');" onmouseout="out('-3623952282264178458');" style=""> 417                     tags.add(possible);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419             }                                                                                            </span>
<span class="2598261311594212195" onmouseenter="enter('2598261311594212195');" onmouseout="out('2598261311594212195');" style=""> 420             start = next + 1;                                                                            </span>
<span class="-8911857571695172425" onmouseenter="enter('-8911857571695172425');" onmouseout="out('-8911857571695172425');" style=""> 421         } while (next &gt; -1);                                                                             </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 422         setTags(tags);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423     }                                                                                                    </span>
<span  style=""> 424                                                                                                          </span>
<span class="-2380080839978865436" onmouseenter="enter('-2380080839978865436');" onmouseout="out('-2380080839978865436');" style=""> 425     public JSONArray getSystemTags() {                                                                   </span>
<span class="1634689045753216867" onmouseenter="enter('1634689045753216867');" onmouseout="out('1634689045753216867');" style=""> 426         JSONArray tags = (JSONArray) getProperty(SYSTEM_TAGS_PROPERTY);                                  </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 427         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 428             tags = new JSONArray();                                                                      </span>
<span class="8109738276011217421" onmouseenter="enter('8109738276011217421');" onmouseout="out('8109738276011217421');" style=""> 429             setProperty(SYSTEM_TAGS_PROPERTY, tags);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430         }                                                                                                </span>
<span class="-7737333077028274174" onmouseenter="enter('-7737333077028274174');" onmouseout="out('-7737333077028274174');" style=""> 431         return tags;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432     }                                                                                                    </span>
<span  style=""> 433                                                                                                          </span>
<span class="3090413247451101219" onmouseenter="enter('3090413247451101219');" onmouseout="out('3090413247451101219');" style=""> 434     public Boolean isDeleted() {                                                                         </span>
<span class="7870299677279363320" onmouseenter="enter('7870299677279363320');" onmouseout="out('7870299677279363320');" style=""> 435         Object deleted = getProperty(DELETED_PROPERTY);                                                  </span>
<span class="3213349019391348934" onmouseenter="enter('3213349019391348934');" onmouseout="out('3213349019391348934');" style=""> 436         if (deleted == null) {                                                                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 437             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438         }                                                                                                </span>
<span class="-8245820290182222148" onmouseenter="enter('-8245820290182222148');" onmouseout="out('-8245820290182222148');" style=""> 439         if (deleted instanceof Boolean) {                                                                </span>
<span class="110137553981332086" onmouseenter="enter('110137553981332086');" onmouseout="out('110137553981332086');" style=""> 440             return (Boolean) deleted;                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 441         } else {                                                                                         </span>
<span class="5495215667694299112" onmouseenter="enter('5495215667694299112');" onmouseout="out('5495215667694299112');" style=""> 442             // Simperium-iOS sets booleans as integer values (0 or 1)                                    </span>
<span class="2375816303299771461" onmouseenter="enter('2375816303299771461');" onmouseout="out('2375816303299771461');" style=""> 443             return deleted instanceof Number &amp;&amp; ((Number) deleted).intValue() != 0;                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445     }                                                                                                    </span>
<span  style=""> 446                                                                                                          </span>
<span class="6912205177980332866" onmouseenter="enter('6912205177980332866');" onmouseout="out('6912205177980332866');" style=""> 447     public void setDeleted(boolean deleted) {                                                            </span>
<span class="-864256626113761460" onmouseenter="enter('-864256626113761460');" onmouseout="out('-864256626113761460');" style=""> 448         setProperty(DELETED_PROPERTY, deleted);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449     }                                                                                                    </span>
<span  style=""> 450                                                                                                          </span>
<span class="5985631777888601261" onmouseenter="enter('5985631777888601261');" onmouseout="out('5985631777888601261');" style=""> 451     public boolean isMarkdownEnabled() {                                                                 </span>
<span class="-5743540823315516839" onmouseenter="enter('-5743540823315516839');" onmouseout="out('-5743540823315516839');" style=""> 452         return hasSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453     }                                                                                                    </span>
<span  style=""> 454                                                                                                          </span>
<span class="-9134361680160631549" onmouseenter="enter('-9134361680160631549');" onmouseout="out('-9134361680160631549');" style=""> 455     public void enableMarkdown() {                                                                       </span>
<span class="-2955264683036225716" onmouseenter="enter('-2955264683036225716');" onmouseout="out('-2955264683036225716');" style=""> 456         setMarkdownEnabled(true);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457     }                                                                                                    </span>
<span  style=""> 458                                                                                                          </span>
<span class="-2232443542975324273" onmouseenter="enter('-2232443542975324273');" onmouseout="out('-2232443542975324273');" style=""> 459     public void setMarkdownEnabled(boolean isMarkdownEnabled) {                                          </span>
<span class="5908341161553131781" onmouseenter="enter('5908341161553131781');" onmouseout="out('5908341161553131781');" style=""> 460         if (isMarkdownEnabled) {                                                                         </span>
<span class="-7185185989369936008" onmouseenter="enter('-7185185989369936008');" onmouseout="out('-7185185989369936008');" style=""> 461             addSystemTag(MARKDOWN_TAG);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 462         } else {                                                                                         </span>
<span class="1430034125671484052" onmouseenter="enter('1430034125671484052');" onmouseout="out('1430034125671484052');" style=""> 463             removeSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465     }                                                                                                    </span>
<span  style=""> 466                                                                                                          </span>
<span class="-7992821206137485678" onmouseenter="enter('-7992821206137485678');" onmouseout="out('-7992821206137485678');" style=""> 467     public boolean isPinned() {                                                                          </span>
<span class="7436893036029851482" onmouseenter="enter('7436893036029851482');" onmouseout="out('7436893036029851482');" style=""> 468         return hasSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469     }                                                                                                    </span>
<span  style=""> 470                                                                                                          </span>
<span class="7137874092814138484" onmouseenter="enter('7137874092814138484');" onmouseout="out('7137874092814138484');" style=""> 471     public void setPinned(boolean isPinned) {                                                            </span>
<span class="-8977010770732050857" onmouseenter="enter('-8977010770732050857');" onmouseout="out('-8977010770732050857');" style=""> 472         if (isPinned) {                                                                                  </span>
<span class="-705489752486798560" onmouseenter="enter('-705489752486798560');" onmouseout="out('-705489752486798560');" style=""> 473             addSystemTag(PINNED_TAG);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 474         } else {                                                                                         </span>
<span class="5010790157822780054" onmouseenter="enter('5010790157822780054');" onmouseout="out('5010790157822780054');" style=""> 475             removeSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477     }                                                                                                    </span>
<span  style=""> 478                                                                                                          </span>
<span class="3778345749504952755" onmouseenter="enter('3778345749504952755');" onmouseout="out('3778345749504952755');" style=""> 479     public boolean isPreviewEnabled() {                                                                  </span>
<span class="-6537187368585435683" onmouseenter="enter('-6537187368585435683');" onmouseout="out('-6537187368585435683');" style=""> 480         return hasSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481     }                                                                                                    </span>
<span  style=""> 482                                                                                                          </span>
<span class="-3198839301731339686" onmouseenter="enter('-3198839301731339686');" onmouseout="out('-3198839301731339686');" style=""> 483     public void setPreviewEnabled(boolean isPreviewEnabled) {                                            </span>
<span class="-4540372431458214170" onmouseenter="enter('-4540372431458214170');" onmouseout="out('-4540372431458214170');" style=""> 484         if (isPreviewEnabled) {                                                                          </span>
<span class="1609739104508733891" onmouseenter="enter('1609739104508733891');" onmouseout="out('1609739104508733891');" style=""> 485             addSystemTag(PREVIEW_TAG);                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 486         } else {                                                                                         </span>
<span class="1340191486118728833" onmouseenter="enter('1340191486118728833');" onmouseout="out('1340191486118728833');" style=""> 487             removeSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489     }                                                                                                    </span>
<span  style=""> 490                                                                                                          </span>
<span class="5049304787018344959" onmouseenter="enter('5049304787018344959');" onmouseout="out('5049304787018344959');" style=""> 491     public boolean isPublished() {                                                                       </span>
<span class="-3313218062555121548" onmouseenter="enter('-3313218062555121548');" onmouseout="out('-3313218062555121548');" style=""> 492         return hasSystemTag(PUBLISHED_TAG) &amp;&amp; !TextUtils.isEmpty(getPublishedUrl());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493     }                                                                                                    </span>
<span  style=""> 494                                                                                                          </span>
<span class="-1996001930026199474" onmouseenter="enter('-1996001930026199474');" onmouseout="out('-1996001930026199474');" style=""> 495     public void setPublished(boolean isPublished) {                                                      </span>
<span class="-214835194616400293" onmouseenter="enter('-214835194616400293');" onmouseout="out('-214835194616400293');" style=""> 496         if (isPublished) {                                                                               </span>
<span class="6614236660148008937" onmouseenter="enter('6614236660148008937');" onmouseout="out('6614236660148008937');" style=""> 497             addSystemTag(PUBLISHED_TAG);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 498         } else {                                                                                         </span>
<span class="-3125520029372940316" onmouseenter="enter('-3125520029372940316');" onmouseout="out('-3125520029372940316');" style=""> 499             removeSystemTag(PUBLISHED_TAG);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501     }                                                                                                    </span>
<span  style=""> 502                                                                                                          </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style=""> 503     public void removeTag(String tagName) {                                                              </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 504         List&lt;String&gt; tags = getTags();                                                                   </span>
<span  style=""> 505                                                                                                          </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style=""> 506         List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style=""> 507         tags.removeAll(tagsMatched);                                                                     </span>
<span  style=""> 508                                                                                                          </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 509         setTags(tags);                                                                                   </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style=""> 510         save();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511     }                                                                                                    </span>
<span  style=""> 512                                                                                                          </span>
<span class="8481041411290642641" onmouseenter="enter('8481041411290642641');" onmouseout="out('8481041411290642641');" style=""> 513     private boolean hasSystemTag(String tag) {                                                           </span>
<span class="-1472869558903340894" onmouseenter="enter('-1472869558903340894');" onmouseout="out('-1472869558903340894');" style=""> 514         if (TextUtils.isEmpty(tag))                                                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 515             return false;                                                                                </span>
<span  style=""> 516                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 517         JSONArray tags = getSystemTags();                                                                </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 518         int length = tags.length();                                                                      </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 519         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="1029161545303231138" onmouseenter="enter('1029161545303231138');" onmouseout="out('1029161545303231138');" style=""> 520             if (tags.optString(i).equals(tag)) {                                                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 521                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523         }                                                                                                </span>
<span  style=""> 524                                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 525         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526     }                                                                                                    </span>
<span  style=""> 527                                                                                                          </span>
<span class="-1886965851517885412" onmouseenter="enter('-1886965851517885412');" onmouseout="out('-1886965851517885412');" style=""> 528     private void addSystemTag(String tag) {                                                              </span>
<span class="-7266652503291305395" onmouseenter="enter('-7266652503291305395');" onmouseout="out('-7266652503291305395');" style=""> 529         if (TextUtils.isEmpty(tag)) {                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 530             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span  style=""> 532                                                                                                          </span>
<span class="4034934261619610009" onmouseenter="enter('4034934261619610009');" onmouseout="out('4034934261619610009');" style=""> 533         // Ensure we don&#x27;t add the same tag again                                                        </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 534         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="-2655750625237705417" onmouseenter="enter('-2655750625237705417');" onmouseout="out('-2655750625237705417');" style=""> 535             getSystemTags().put(tag);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 536         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537     }                                                                                                    </span>
<span  style=""> 538                                                                                                          </span>
<span class="-6272346588769055483" onmouseenter="enter('-6272346588769055483');" onmouseout="out('-6272346588769055483');" style=""> 539     private void removeSystemTag(String tag) {                                                           </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 540         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 541             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542         }                                                                                                </span>
<span  style=""> 543                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 544         JSONArray tags = getSystemTags();                                                                </span>
<span class="6472000112597211426" onmouseenter="enter('6472000112597211426');" onmouseout="out('6472000112597211426');" style=""> 545         JSONArray newTags = new JSONArray();                                                             </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 546         int length = tags.length();                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 547         try {                                                                                            </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 548             for (int i = 0; i &lt; length; i++) {                                                           </span>
<span class="5751642819386913624" onmouseenter="enter('5751642819386913624');" onmouseout="out('5751642819386913624');" style=""> 549                 Object val = tags.get(i);                                                                </span>
<span class="7076458285668173093" onmouseenter="enter('7076458285668173093');" onmouseout="out('7076458285668173093');" style=""> 550                 if (!val.equals(tag))                                                                    </span>
<span class="-6329059091210941964" onmouseenter="enter('-6329059091210941964');" onmouseout="out('-6329059091210941964');" style=""> 551                     newTags.put(val);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552             }                                                                                            </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 553         } catch (JSONException e) {                                                                      </span>
<span class="4377813279323840039" onmouseenter="enter('4377813279323840039');" onmouseout="out('4377813279323840039');" style=""> 554             // could not update pinned setting                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555         }                                                                                                </span>
<span  style=""> 556                                                                                                          </span>
<span class="8301502673130902229" onmouseenter="enter('8301502673130902229');" onmouseout="out('8301502673130902229');" style=""> 557         setProperty(SYSTEM_TAGS_PROPERTY, newTags);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558     }                                                                                                    </span>
<span  style=""> 559                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 560     /**                                                                                                  </span>
<span class="-397105642920094918" onmouseenter="enter('-397105642920094918');" onmouseout="out('-397105642920094918');" style=""> 561      * Check if the note has any changes                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 562      *                                                                                                   </span>
<span class="6656400016423195192" onmouseenter="enter('6656400016423195192');" onmouseout="out('6656400016423195192');" style=""> 563      * @param content           the new note content                                                     </span>
<span class="698428434066591100" onmouseenter="enter('698428434066591100');" onmouseout="out('698428434066591100');" style=""> 564      * @param tagString         space separated tags                                                     </span>
<span class="-6143007710262330196" onmouseenter="enter('-6143007710262330196');" onmouseout="out('-6143007710262330196');" style=""> 565      * @param isPinned          note is pinned                                                           </span>
<span class="-1154760621356330740" onmouseenter="enter('-1154760621356330740');" onmouseout="out('-1154760621356330740');" style=""> 566      * @param isMarkdownEnabled note has markdown enabled                                                </span>
<span class="-2689180860643219460" onmouseenter="enter('-2689180860643219460');" onmouseout="out('-2689180860643219460');" style=""> 567      * @param isPreviewEnabled  note has preview enabled                                                 </span>
<span class="2808295610973044096" onmouseenter="enter('2808295610973044096');" onmouseout="out('2808295610973044096');" style=""> 568      * @return true if note has changes, false if it is unchanged.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 569      */                                                                                                  </span>
<span class="2249306723652890422" onmouseenter="enter('2249306723652890422');" onmouseout="out('2249306723652890422');" style=""><abbr title=" 570     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boolean isPreviewEnabled) {"> 570     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabl🔵</abbr></span>
<span class="-8752168499945681469" onmouseenter="enter('-8752168499945681469');" onmouseout="out('-8752168499945681469');" style=""> 571         return !content.equals(this.getContent())                                                        </span>
<span class="361029725350182512" onmouseenter="enter('361029725350182512');" onmouseout="out('361029725350182512');" style=""> 572                 || !tagString.equals(this.getTagString().toString())                                     </span>
<span class="-3256796514842471479" onmouseenter="enter('-3256796514842471479');" onmouseout="out('-3256796514842471479');" style=""> 573                 || this.isPinned() != isPinned                                                           </span>
<span class="3248054844136733713" onmouseenter="enter('3248054844136733713');" onmouseout="out('3248054844136733713');" style=""> 574                 || this.isMarkdownEnabled() != isMarkdownEnabled                                         </span>
<span class="7822456953056210787" onmouseenter="enter('7822456953056210787');" onmouseout="out('7822456953056210787');" style=""> 575                 || this.isPreviewEnabled() != isPreviewEnabled;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 576     }                                                                                                    </span>
<span  style=""> 577                                                                                                          </span>
<span class="-7717881480664684723" onmouseenter="enter('-7717881480664684723');" onmouseout="out('-7717881480664684723');" style=""> 578     public static class Schema extends BucketSchema&lt;Note&gt; {                                              </span>
<span  style=""> 579                                                                                                          </span>
<span class="-3235753444162186767" onmouseenter="enter('-3235753444162186767');" onmouseout="out('-3235753444162186767');" style=""> 580         protected static NoteIndexer sNoteIndexer = new NoteIndexer();                                   </span>
<span class="-8196684505127442187" onmouseenter="enter('-8196684505127442187');" onmouseout="out('-8196684505127442187');" style=""> 581         protected static NoteFullTextIndexer sFullTextIndexer = new NoteFullTextIndexer();               </span>
<span  style=""> 582                                                                                                          </span>
<span class="-75865115147660663" onmouseenter="enter('-75865115147660663');" onmouseout="out('-75865115147660663');" style=""> 583         public Schema() {                                                                                </span>
<span class="-4886495676536647522" onmouseenter="enter('-4886495676536647522');" onmouseout="out('-4886495676536647522');" style=""> 584             autoIndex();                                                                                 </span>
<span class="-6825633182165860223" onmouseenter="enter('-6825633182165860223');" onmouseout="out('-6825633182165860223');" style=""> 585             addIndex(sNoteIndexer);                                                                      </span>
<span class="-3392547141042614111" onmouseenter="enter('-3392547141042614111');" onmouseout="out('-3392547141042614111');" style=""> 586             setupFullTextIndex(sFullTextIndexer, NoteFullTextIndexer.INDEXES);                           </span>
<span class="-6401895186782523877" onmouseenter="enter('-6401895186782523877');" onmouseout="out('-6401895186782523877');" style=""> 587             setDefault(CONTENT_PROPERTY, &quot;&quot;);                                                            </span>
<span class="-2554467534039091654" onmouseenter="enter('-2554467534039091654');" onmouseout="out('-2554467534039091654');" style=""> 588             setDefault(SYSTEM_TAGS_PROPERTY, new JSONArray());                                           </span>
<span class="228359577715990029" onmouseenter="enter('228359577715990029');" onmouseout="out('228359577715990029');" style=""> 589             setDefault(TAGS_PROPERTY, new JSONArray());                                                  </span>
<span class="-819869596778271798" onmouseenter="enter('-819869596778271798');" onmouseout="out('-819869596778271798');" style=""> 590             setDefault(DELETED_PROPERTY, false);                                                         </span>
<span class="-8278335164591762572" onmouseenter="enter('-8278335164591762572');" onmouseout="out('-8278335164591762572');" style=""> 591             setDefault(SHARE_URL_PROPERTY, &quot;&quot;);                                                          </span>
<span class="4718032932676673460" onmouseenter="enter('4718032932676673460');" onmouseout="out('4718032932676673460');" style=""> 592             setDefault(PUBLISH_URL_PROPERTY, &quot;&quot;);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593         }                                                                                                </span>
<span  style=""> 594                                                                                                          </span>
<span class="1438294404599077665" onmouseenter="enter('1438294404599077665');" onmouseout="out('1438294404599077665');" style=""> 595         public String getRemoteName() {                                                                  </span>
<span class="-8943072285760215512" onmouseenter="enter('-8943072285760215512');" onmouseout="out('-8943072285760215512');" style=""> 596             return Note.BUCKET_NAME;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597         }                                                                                                </span>
<span  style=""> 598                                                                                                          </span>
<span class="-4946235729406468677" onmouseenter="enter('-4946235729406468677');" onmouseout="out('-4946235729406468677');" style=""> 599         public Note build(String key, JSONObject properties) {                                           </span>
<span class="-2808542273143064496" onmouseenter="enter('-2808542273143064496');" onmouseout="out('-2808542273143064496');" style=""> 600             return new Note(key, properties);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601         }                                                                                                </span>
<span  style=""> 602                                                                                                          </span>
<span class="2318790323390762687" onmouseenter="enter('2318790323390762687');" onmouseout="out('2318790323390762687');" style=""> 603         public void update(Note note, JSONObject properties) {                                           </span>
<span class="-3717338000153341316" onmouseenter="enter('-3717338000153341316');" onmouseout="out('-3717338000153341316');" style=""> 604             note.setProperties(properties);                                                              </span>
<span class="-731284339738821488" onmouseenter="enter('-731284339738821488');" onmouseout="out('-731284339738821488');" style=""> 605             note.mTitle = null;                                                                          </span>
<span class="6645980171711348815" onmouseenter="enter('6645980171711348815');" onmouseout="out('6645980171711348815');" style=""> 606             note.mContentPreview = null;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 608     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 609 }                                                                                                        </span></pre></td>
                            <td><pre><span class="9181943406056492869" onmouseenter="enter('9181943406056492869');" onmouseout="out('9181943406056492869');" style="">   1 package com.automattic.simplenote.models;                                                                </span>
<span  style="">   2                                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3 import android.content.Context;                                                                          </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   4 import android.text.TextUtils;                                                                           </span>
<span  style="">   5                                                                                                          </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   6 import androidx.annotation.NonNull;                                                                      </span>
<span  style="">   7                                                                                                          </span>
<span class="-6092371777820512633" onmouseenter="enter('-6092371777820512633');" onmouseout="out('-6092371777820512633');" style="">   8 import com.automattic.simplenote.R;                                                                      </span>
<span class="1225693603979668275" onmouseenter="enter('1225693603979668275');" onmouseout="out('1225693603979668275');" style="">   9 import com.automattic.simplenote.utils.DateTimeUtils;                                                    </span>
<span class="-643769428942460504" onmouseenter="enter('-643769428942460504');" onmouseout="out('-643769428942460504');" style="">  10 import com.automattic.simplenote.utils.TagUtils;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  11 import com.simperium.client.Bucket;                                                                      </span>
<span class="6125639164043971044" onmouseenter="enter('6125639164043971044');" onmouseout="out('6125639164043971044');" style="">  12 import com.simperium.client.BucketObject;                                                                </span>
<span class="-665307165473523580" onmouseenter="enter('-665307165473523580');" onmouseout="out('-665307165473523580');" style="">  13 import com.simperium.client.BucketSchema;                                                                </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  14 import com.simperium.client.Query;                                                                       </span>
<span class="-838252138947964043" onmouseenter="enter('-838252138947964043');" onmouseout="out('-838252138947964043');" style="">  15 import com.simperium.client.Query.ComparisonType;                                                        </span>
<span class="708242169313900219" onmouseenter="enter('708242169313900219');" onmouseout="out('708242169313900219');" style="">  16 import com.simperium.util.Uuid;                                                                          </span>
<span  style="">  17                                                                                                          </span>
<span class="-9193129351684262878" onmouseenter="enter('-9193129351684262878');" onmouseout="out('-9193129351684262878');" style="">  18 import org.json.JSONArray;                                                                               </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  19 import org.json.JSONException;                                                                           </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  20 import org.json.JSONObject;                                                                              </span>
<span  style="">  21                                                                                                          </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  22 import java.math.BigDecimal;                                                                             </span>
<span class="1238662365364477381" onmouseenter="enter('1238662365364477381');" onmouseout="out('1238662365364477381');" style="">  23 import java.text.DateFormat;                                                                             </span>
<span class="39790854174282861" onmouseenter="enter('39790854174282861');" onmouseout="out('39790854174282861');" style="">  24 import java.text.ParseException;                                                                         </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  25 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  26 import java.util.ArrayList;                                                                              </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  27 import java.util.Calendar;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  28 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  29 import java.util.Locale;                                                                                 </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  30 import java.util.TimeZone;                                                                               </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  31 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  32 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  33                                                                                                          </span>
<span class="-4405840676582391526" onmouseenter="enter('-4405840676582391526');" onmouseout="out('-4405840676582391526');" style="">  34 import static com.automattic.simplenote.utils.SimplenoteLinkify.SIMPLENOTE_LINK_PREFIX;                  </span>
<span  style="">  35                                                                                                          </span>
<span class="1630911635596164534" onmouseenter="enter('1630911635596164534');" onmouseout="out('1630911635596164534');" style="">  36 public class Note extends BucketObject {                                                                 </span>
<span  style="">  37                                                                                                          </span>
<span class="308952937305736491" onmouseenter="enter('308952937305736491');" onmouseout="out('308952937305736491');" style="">  38     public static final String BUCKET_NAME = &quot;note&quot;;                                                     </span>
<span class="6014442145961064017" onmouseenter="enter('6014442145961064017');" onmouseout="out('6014442145961064017');" style="">  39     public static final String MARKDOWN_TAG = &quot;markdown&quot;;                                                </span>
<span class="-8101559688416496628" onmouseenter="enter('-8101559688416496628');" onmouseout="out('-8101559688416496628');" style="">  40     public static final String PINNED_TAG = &quot;pinned&quot;;                                                    </span>
<span class="2755303258201669627" onmouseenter="enter('2755303258201669627');" onmouseout="out('2755303258201669627');" style="">  41     public static final String PREVIEW_TAG = &quot;preview&quot;;                                                  </span>
<span class="1168195147039968761" onmouseenter="enter('1168195147039968761');" onmouseout="out('1168195147039968761');" style="">  42     public static final String PUBLISHED_TAG = &quot;published&quot;;                                              </span>
<span class="6384737125939709481" onmouseenter="enter('6384737125939709481');" onmouseout="out('6384737125939709481');" style="">  43     public static final String NEW_LINE = &quot;\n&quot;;                                                          </span>
<span class="-6709867799447959845" onmouseenter="enter('-6709867799447959845');" onmouseout="out('-6709867799447959845');" style="">  44     public static final String CONTENT_PROPERTY = &quot;content&quot;;                                             </span>
<span class="-7150784166370340219" onmouseenter="enter('-7150784166370340219');" onmouseout="out('-7150784166370340219');" style="">  45     public static final String KEY_PROPERTY = &quot;key&quot;;                                                     </span>
<span class="-2027165692804872527" onmouseenter="enter('-2027165692804872527');" onmouseout="out('-2027165692804872527');" style="">  46     public static final String TAGS_PROPERTY = &quot;tags&quot;;                                                   </span>
<span class="-2782765636412056512" onmouseenter="enter('-2782765636412056512');" onmouseout="out('-2782765636412056512');" style="">  47     public static final String SYSTEM_TAGS_PROPERTY = &quot;systemTags&quot;;                                      </span>
<span class="8082059840675302216" onmouseenter="enter('8082059840675302216');" onmouseout="out('8082059840675302216');" style="">  48     public static final String CREATION_DATE_PROPERTY = &quot;creationDate&quot;;                                  </span>
<span class="-4622628390272251051" onmouseenter="enter('-4622628390272251051');" onmouseout="out('-4622628390272251051');" style="">  49     public static final String MODIFICATION_DATE_PROPERTY = &quot;modificationDate&quot;;                          </span>
<span class="-2614611438740057503" onmouseenter="enter('-2614611438740057503');" onmouseout="out('-2614611438740057503');" style="">  50     public static final String SHARE_URL_PROPERTY = &quot;shareURL&quot;;                                          </span>
<span class="1336476452932138514" onmouseenter="enter('1336476452932138514');" onmouseout="out('1336476452932138514');" style="">  51     public static final String PUBLISH_URL_PROPERTY = &quot;publishURL&quot;;                                      </span>
<span class="-813041889408259553" onmouseenter="enter('-813041889408259553');" onmouseout="out('-813041889408259553');" style="">  52     public static final String DELETED_PROPERTY = &quot;deleted&quot;;                                             </span>
<span class="4804610397042036134" onmouseenter="enter('4804610397042036134');" onmouseout="out('4804610397042036134');" style="">  53     public static final String TITLE_INDEX_NAME = &quot;title&quot;;                                               </span>
<span class="941632753921114575" onmouseenter="enter('941632753921114575');" onmouseout="out('941632753921114575');" style="">  54     public static final String CONTENT_PREVIEW_INDEX_NAME = &quot;contentPreview&quot;;                            </span>
<span class="4601116861733775409" onmouseenter="enter('4601116861733775409');" onmouseout="out('4601116861733775409');" style="">  55     public static final String PINNED_INDEX_NAME = &quot;pinned&quot;;                                             </span>
<span class="-5028217336186587547" onmouseenter="enter('-5028217336186587547');" onmouseout="out('-5028217336186587547');" style="">  56     public static final String MODIFIED_INDEX_NAME = &quot;modified&quot;;                                         </span>
<span class="-2754009865833796434" onmouseenter="enter('-2754009865833796434');" onmouseout="out('-2754009865833796434');" style="">  57     public static final String CREATED_INDEX_NAME = &quot;created&quot;;                                           </span>
<span class="-620094810998015131" onmouseenter="enter('-620094810998015131');" onmouseout="out('-620094810998015131');" style="">  58     public static final String MATCHED_TITLE_INDEX_NAME = &quot;matchedTitle&quot;;                                </span>
<span class="5961311022296185233" onmouseenter="enter('5961311022296185233');" onmouseout="out('5961311022296185233');" style="">  59     public static final String MATCHED_CONTENT_INDEX_NAME = &quot;matchedContent&quot;;                            </span>
<span class="354077366863542774" onmouseenter="enter('354077366863542774');" onmouseout="out('354077366863542774');" style="">  60     public static final String PUBLISH_URL = &quot;http://simp.ly/p/&quot;;                                        </span>
<span class="2475488422216258991" onmouseenter="enter('2475488422216258991');" onmouseout="out('2475488422216258991');" style="">  61     static public final String[] FULL_TEXT_INDEXES = new String[]{                                       </span>
<span class="394877313876947494" onmouseenter="enter('394877313876947494');" onmouseout="out('394877313876947494');" style="">  62             Note.TITLE_INDEX_NAME, Note.CONTENT_PROPERTY};                                               </span>
<span class="-4178348678314657322" onmouseenter="enter('-4178348678314657322');" onmouseout="out('-4178348678314657322');" style="">  63     private static final String BLANK_CONTENT = &quot;&quot;;                                                      </span>
<span class="-8217848203306725764" onmouseenter="enter('-8217848203306725764');" onmouseout="out('-8217848203306725764');" style="">  64     private static final String SPACE = &quot; &quot;;                                                             </span>
<span class="7999038666256371202" onmouseenter="enter('7999038666256371202');" onmouseout="out('7999038666256371202');" style="">  65     private static final int MAX_PREVIEW_CHARS = 300;                                                    </span>
<span class="6617027899127222559" onmouseenter="enter('6617027899127222559');" onmouseout="out('6617027899127222559');" style="">  66     protected String mTitle = null;                                                                      </span>
<span class="-1758175371106332326" onmouseenter="enter('-1758175371106332326');" onmouseout="out('-1758175371106332326');" style="">  67     protected String mContentPreview = null;                                                             </span>
<span  style="">  68                                                                                                          </span>
<span class="-1397623179598998233" onmouseenter="enter('-1397623179598998233');" onmouseout="out('-1397623179598998233');" style="">  69     public Note() {                                                                                      </span>
<span class="-1154746796976603421" onmouseenter="enter('-1154746796976603421');" onmouseout="out('-1154746796976603421');" style="">  70         this(Uuid.uuid());                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="767263449852825375" onmouseenter="enter('767263449852825375');" onmouseout="out('767263449852825375');" style="">  73     public Note(String key) {                                                                            </span>
<span class="53769298429916076" onmouseenter="enter('53769298429916076');" onmouseout="out('53769298429916076');" style="">  74         this(key, new JSONObject());                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="8617384997772879313" onmouseenter="enter('8617384997772879313');" onmouseout="out('8617384997772879313');" style="">  77     public Note(String key, JSONObject properties) {                                                     </span>
<span class="-6821486208075908487" onmouseenter="enter('-6821486208075908487');" onmouseout="out('-6821486208075908487');" style="">  78         super(key, properties);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="458900878223274025" onmouseenter="enter('458900878223274025');" onmouseout="out('458900878223274025');" style="">  81     public static Query&lt;Note&gt; all(Bucket&lt;Note&gt; noteBucket) {                                             </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  82         return noteBucket.query()                                                                        </span>
<span class="-6142536283945774731" onmouseenter="enter('-6142536283945774731');" onmouseout="out('-6142536283945774731');" style="">  83                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="-6525045200709488349" onmouseenter="enter('-6525045200709488349');" onmouseout="out('-6525045200709488349');" style="">  86     public static Query&lt;Note&gt; allDeleted(Bucket&lt;Note&gt; noteBucket) {                                      </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  87         return noteBucket.query()                                                                        </span>
<span class="-6326653849445488397" onmouseenter="enter('-6326653849445488397');" onmouseout="out('-6326653849445488397');" style="">  88                 .where(DELETED_PROPERTY, ComparisonType.EQUAL_TO, true);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span  style="">  90                                                                                                          </span>
<span class="4789545620535823187" onmouseenter="enter('4789545620535823187');" onmouseout="out('4789545620535823187');" style="">  91     public static Query&lt;Note&gt; search(Bucket&lt;Note&gt; noteBucket, String searchString) {                     </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  92         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  93                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-8956541673379552524" onmouseenter="enter('-8956541673379552524');" onmouseout="out('-8956541673379552524');" style="">  94                 .where(CONTENT_PROPERTY, ComparisonType.LIKE, &quot;%&quot; + searchString + &quot;%&quot;);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95     }                                                                                                    </span>
<span  style="">  96                                                                                                          </span>
<span class="-1229245405128052241" onmouseenter="enter('-1229245405128052241');" onmouseout="out('-1229245405128052241');" style="">  97     public static Query&lt;Note&gt; allInTag(Bucket&lt;Note&gt; noteBucket, String tag) {                            </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  98         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  99                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-2207133284802963072" onmouseenter="enter('-2207133284802963072');" onmouseout="out('-2207133284802963072');" style=""> 100                 .where(TAGS_PROPERTY, ComparisonType.LIKE, tag);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101     }                                                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="2971412545726517521" onmouseenter="enter('2971412545726517521');" onmouseout="out('2971412545726517521');" style=""> 103     public static Query&lt;Note&gt; allWithNoTag(Bucket&lt;Note&gt; noteBucket) {                                    </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style=""> 104         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 105                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="6567927526378864260" onmouseenter="enter('6567927526378864260');" onmouseout="out('6567927526378864260');" style=""> 106                 .where(TAGS_PROPERTY, ComparisonType.EQUAL_TO, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107     }                                                                                                    </span>
<span  style=""> 108                                                                                                          </span>
<span class="-8938802169787860370" onmouseenter="enter('-8938802169787860370');" onmouseout="out('-8938802169787860370');" style=""> 109     public static Note fromContent(Bucket&lt;Note&gt; notesBucket, String content) {                           </span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 110         Note note = notesBucket.newObject();                                                             </span>
<span class="8912392529601079939" onmouseenter="enter('8912392529601079939');" onmouseout="out('8912392529601079939');" style=""> 111         note.setContent(content);                                                                        </span>
<span class="1465773082586789630" onmouseenter="enter('1465773082586789630');" onmouseout="out('1465773082586789630');" style=""> 112         note.setCreationDate(Calendar.getInstance());                                                    </span>
<span class="-2721490489979887121" onmouseenter="enter('-2721490489979887121');" onmouseout="out('-2721490489979887121');" style=""> 113         note.setModificationDate(note.getCreationDate());                                                </span>
<span  style=""> 114                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 115         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-5396846739988471840" onmouseenter="enter('-5396846739988471840');" onmouseout="out('-5396846739988471840');" style=""><abbr title=" 118     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONException, ParseException {"> 118     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONExcepti🔵</abbr></span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 119         Note note = notesBucket.newObject();                                                             </span>
<span class="3098500428867040128" onmouseenter="enter('3098500428867040128');" onmouseout="out('3098500428867040128');" style=""> 120         note.setContent(noteJson.optString(&quot;content&quot;, &quot;&quot;));                                              </span>
<span class="-8154332140304970847" onmouseenter="enter('-8154332140304970847');" onmouseout="out('-8154332140304970847');" style=""><abbr title=" 121         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;creationDate&quot;)) : Calendar.getInstance());"> 121         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getStr🔵</abbr></span>
<span class="-8572711449683887689" onmouseenter="enter('-8572711449683887689');" onmouseout="out('-8572711449683887689');" style=""><abbr title=" 122         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;lastModified&quot;)) : Calendar.getInstance());"> 122         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.ge🔵</abbr></span>
<span class="-5498600081013067663" onmouseenter="enter('-5498600081013067663');" onmouseout="out('-5498600081013067663');" style=""> 123         note.setTags(noteJson.has(&quot;tags&quot;) ? noteJson.getJSONArray(&quot;tags&quot;) : new JSONArray());            </span>
<span class="875604650523146036" onmouseenter="enter('875604650523146036');" onmouseout="out('875604650523146036');" style=""> 124         note.setPinned(noteJson.optBoolean(&quot;pinned&quot;, false));                                            </span>
<span class="1705691732106409520" onmouseenter="enter('1705691732106409520');" onmouseout="out('1705691732106409520');" style=""> 125         note.setMarkdownEnabled(noteJson.optBoolean(&quot;markdown&quot;, false));                                 </span>
<span  style=""> 126                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 127         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="-5517811679430868458" onmouseenter="enter('-5517811679430868458');" onmouseout="out('-5517811679430868458');" style=""> 130     @SuppressWarnings(&quot;unused&quot;)                                                                          </span>
<span class="-4700657283235731904" onmouseenter="enter('-4700657283235731904');" onmouseout="out('-4700657283235731904');" style=""> 131     public static String dateString(Number time, boolean useShortFormat, Context context) {              </span>
<span class="1180405838137731219" onmouseenter="enter('1180405838137731219');" onmouseout="out('1180405838137731219');" style=""> 132         Calendar c = numberToDate(time);                                                                 </span>
<span class="-7277187246954612403" onmouseenter="enter('-7277187246954612403');" onmouseout="out('-7277187246954612403');" style=""> 133         return dateString(c, useShortFormat, context);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134     }                                                                                                    </span>
<span  style=""> 135                                                                                                          </span>
<span class="-8567197073889182513" onmouseenter="enter('-8567197073889182513');" onmouseout="out('-8567197073889182513');" style=""> 136     public static String dateString(Calendar c, boolean useShortFormat, Context context) {               </span>
<span class="-4601601397388656558" onmouseenter="enter('-4601601397388656558');" onmouseout="out('-4601601397388656558');" style=""> 137         int year, month, day;                                                                            </span>
<span  style=""> 138                                                                                                          </span>
<span class="-7517224838183820978" onmouseenter="enter('-7517224838183820978');" onmouseout="out('-7517224838183820978');" style=""> 139         String time, date, retVal;                                                                       </span>
<span  style=""> 140                                                                                                          </span>
<span class="-7023974272217551721" onmouseenter="enter('-7023974272217551721');" onmouseout="out('-7023974272217551721');" style=""> 141         Calendar diff = Calendar.getInstance();                                                          </span>
<span class="7346751312817051138" onmouseenter="enter('7346751312817051138');" onmouseout="out('7346751312817051138');" style=""> 142         diff.setTimeInMillis(diff.getTimeInMillis() - c.getTimeInMillis());                              </span>
<span  style=""> 143                                                                                                          </span>
<span class="-2909064038838300707" onmouseenter="enter('-2909064038838300707');" onmouseout="out('-2909064038838300707');" style=""> 144         year = diff.get(Calendar.YEAR);                                                                  </span>
<span class="-5868815277479911950" onmouseenter="enter('-5868815277479911950');" onmouseout="out('-5868815277479911950');" style=""> 145         month = diff.get(Calendar.MONTH);                                                                </span>
<span class="-2637536938238774465" onmouseenter="enter('-2637536938238774465');" onmouseout="out('-2637536938238774465');" style=""> 146         day = diff.get(Calendar.DAY_OF_MONTH);                                                           </span>
<span  style=""> 147                                                                                                          </span>
<span class="1536424719044438994" onmouseenter="enter('1536424719044438994');" onmouseout="out('1536424719044438994');" style=""> 148         diff.setTimeInMillis(0); // starting time                                                        </span>
<span class="-779753610725741249" onmouseenter="enter('-779753610725741249');" onmouseout="out('-779753610725741249');" style=""> 149         time = DateFormat.getTimeInstance(DateFormat.SHORT).format(c.getTime());                         </span>
<span class="-2383141111479093557" onmouseenter="enter('-2383141111479093557');" onmouseout="out('-2383141111479093557');" style=""><abbr title=" 150         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.DAY_OF_MONTH))) {"> 150         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(🔵</abbr></span>
<span class="7635099361720652074" onmouseenter="enter('7635099361720652074');" onmouseout="out('7635099361720652074');" style=""> 151             date = context.getResources().getString(R.string.today);                                     </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 152             if (useShortFormat)                                                                          </span>
<span class="597955899566079772" onmouseenter="enter('597955899566079772');" onmouseout="out('597955899566079772');" style=""> 153                 retVal = time;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 154             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 155                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-818230175523660822" onmouseenter="enter('-818230175523660822');" onmouseout="out('-818230175523660822');" style=""><abbr title=" 156         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)) {"> 156         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)🔵</abbr></span>
<span class="-8420997342841621789" onmouseenter="enter('-8420997342841621789');" onmouseout="out('-8420997342841621789');" style=""> 157             date = context.getResources().getString(R.string.yesterday);                                 </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 158             if (useShortFormat)                                                                          </span>
<span class="8381191313867632389" onmouseenter="enter('8381191313867632389');" onmouseout="out('8381191313867632389');" style=""> 159                 retVal = date;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 160             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 161                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 162         } else {                                                                                         </span>
<span class="-8110415762919125838" onmouseenter="enter('-8110415762919125838');" onmouseout="out('-8110415762919125838');" style=""> 163             date = new SimpleDateFormat(&quot;MMM dd&quot;, Locale.US).format(c.getTime());                        </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 164             retVal = date + &quot;, &quot; + time;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165         }                                                                                                </span>
<span  style=""> 166                                                                                                          </span>
<span class="-2448447535460405943" onmouseenter="enter('-2448447535460405943');" onmouseout="out('-2448447535460405943');" style=""> 167         return retVal;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168     }                                                                                                    </span>
<span  style=""> 169                                                                                                          </span>
<span class="-1889536418011186938" onmouseenter="enter('-1889536418011186938');" onmouseout="out('-1889536418011186938');" style=""> 170     private static int getReferenceCount(String key, String content) {                                   </span>
<span class="-666706993090019623" onmouseenter="enter('-666706993090019623');" onmouseout="out('-666706993090019623');" style=""> 171         Pattern pattern = Pattern.compile(SIMPLENOTE_LINK_PREFIX + key);                                 </span>
<span class="-5723325120560414069" onmouseenter="enter('-5723325120560414069');" onmouseout="out('-5723325120560414069');" style=""> 172         Matcher matcher = pattern.matcher(content);                                                      </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 173         int count = 0;                                                                                   </span>
<span  style=""> 174                                                                                                          </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 175         while (matcher.find()) {                                                                         </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style=""> 176             count++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177         }                                                                                                </span>
<span  style=""> 178                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 179         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180     }                                                                                                    </span>
<span  style=""> 181                                                                                                          </span>
<span class="-3902014892596708789" onmouseenter="enter('-3902014892596708789');" onmouseout="out('-3902014892596708789');" style=""> 182     public static List&lt;Reference&gt; getReferences(Bucket&lt;Note&gt; bucket, String key) {                       </span>
<span class="-6029684357073269481" onmouseenter="enter('-6029684357073269481');" onmouseout="out('-6029684357073269481');" style=""> 183         List&lt;Reference&gt; references = new ArrayList&lt;&gt;();                                                  </span>
<span class="-4658611266183475458" onmouseenter="enter('-4658611266183475458');" onmouseout="out('-4658611266183475458');" style=""> 184         Bucket.ObjectCursor&lt;Note&gt; cursor = Note.search(bucket, SIMPLENOTE_LINK_PREFIX + key).execute();  </span>
<span  style=""> 185                                                                                                          </span>
<span class="-679463407698125917" onmouseenter="enter('-679463407698125917');" onmouseout="out('-679463407698125917');" style=""> 186         while (cursor.moveToNext()) {                                                                    </span>
<span class="3501306350092034788" onmouseenter="enter('3501306350092034788');" onmouseout="out('3501306350092034788');" style=""> 187             Note note = cursor.getObject();                                                              </span>
<span class="-4285952824793620055" onmouseenter="enter('-4285952824793620055');" onmouseout="out('-4285952824793620055');" style=""> 188             references.add(                                                                              </span>
<span class="-1411633905067872974" onmouseenter="enter('-1411633905067872974');" onmouseout="out('-1411633905067872974');" style=""> 189                 new Reference(                                                                           </span>
<span class="-3110909059350189445" onmouseenter="enter('-3110909059350189445');" onmouseout="out('-3110909059350189445');" style=""> 190                     note.getSimperiumKey(),                                                              </span>
<span class="2543604805982207984" onmouseenter="enter('2543604805982207984');" onmouseout="out('2543604805982207984');" style=""> 191                     note.getTitle(),                                                                     </span>
<span class="7904695514627173906" onmouseenter="enter('7904695514627173906');" onmouseout="out('7904695514627173906');" style=""> 192                     note.getModificationDate(),                                                          </span>
<span class="5299483559431490396" onmouseenter="enter('5299483559431490396');" onmouseout="out('5299483559431490396');" style=""> 193                     getReferenceCount(key, note.getContent())                                            </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 194                 )                                                                                        </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 195             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196         }                                                                                                </span>
<span  style=""> 197                                                                                                          </span>
<span class="-816749515151999705" onmouseenter="enter('-816749515151999705');" onmouseout="out('-816749515151999705');" style=""> 198         return references;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="6991191424901834769" onmouseenter="enter('6991191424901834769');" onmouseout="out('6991191424901834769');" style=""> 201     public static Calendar numberToDate(Number time) {                                                   </span>
<span class="2627151998164378009" onmouseenter="enter('2627151998164378009');" onmouseout="out('2627151998164378009');" style=""> 202         Calendar date = Calendar.getInstance();                                                          </span>
<span class="-4794582782203016972" onmouseenter="enter('-4794582782203016972');" onmouseout="out('-4794582782203016972');" style=""> 203         if (time != null) {                                                                              </span>
<span class="-3733626690602126121" onmouseenter="enter('-3733626690602126121');" onmouseout="out('-3733626690602126121');" style=""> 204             // Flick Note uses millisecond resolution timestamps Simplenote expects seconds              </span>
<span class="3026137703351918876" onmouseenter="enter('3026137703351918876');" onmouseout="out('3026137703351918876');" style=""> 205             // since we only deal with create and modify timestamps, they should all have occurred       </span>
<span class="-9197945245707351438" onmouseenter="enter('-9197945245707351438');" onmouseout="out('-9197945245707351438');" style=""> 206             // at the present time or in the past.                                                       </span>
<span class="-5330372272438133634" onmouseenter="enter('-5330372272438133634');" onmouseout="out('-5330372272438133634');" style=""> 207             float now = (float) date.getTimeInMillis() / 1000;                                           </span>
<span class="7868403810214452697" onmouseenter="enter('7868403810214452697');" onmouseout="out('7868403810214452697');" style=""> 208             float magnitude = time.floatValue() / now;                                                   </span>
<span class="5909991427144614543" onmouseenter="enter('5909991427144614543');" onmouseout="out('5909991427144614543');" style=""> 209             if (magnitude &gt;= 2.f) time = time.longValue() / 1000;                                        </span>
<span class="2284249078526717288" onmouseenter="enter('2284249078526717288');" onmouseout="out('2284249078526717288');" style=""> 210             date.setTimeInMillis(time.longValue() * 1000);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span class="7179427650659377170" onmouseenter="enter('7179427650659377170');" onmouseout="out('7179427650659377170');" style=""> 212         return date;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="466463869222866851" onmouseenter="enter('466463869222866851');" onmouseout="out('466463869222866851');" style=""> 215     public static String numberToDateString(@NonNull Number number) {                                    </span>
<span class="-4090451846849985785" onmouseenter="enter('-4090451846849985785');" onmouseout="out('-4090451846849985785');" style=""> 216         long milliseconds = new BigDecimal(number.toString()).multiply(new BigDecimal(1000)).longValue();</span>
<span class="2239009023688190143" onmouseenter="enter('2239009023688190143');" onmouseout="out('2239009023688190143');" style=""> 217         Calendar calendar = Calendar.getInstance();                                                      </span>
<span class="9071902319976922096" onmouseenter="enter('9071902319976922096');" onmouseout="out('9071902319976922096');" style=""> 218         calendar.setTimeInMillis(milliseconds);                                                          </span>
<span class="-1960866814541712569" onmouseenter="enter('-1960866814541712569');" onmouseout="out('-1960866814541712569');" style=""> 219         SimpleDateFormat date = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSS&#x27;Z&#x27;&quot;, Locale.US);         </span>
<span class="1592748650922216684" onmouseenter="enter('1592748650922216684');" onmouseout="out('1592748650922216684');" style=""> 220         date.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));                                                   </span>
<span class="5827364706871365292" onmouseenter="enter('5827364706871365292');" onmouseout="out('5827364706871365292');" style=""> 221         return date.format(calendar.getTime());                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222     }                                                                                                    </span>
<span  style=""> 223                                                                                                          </span>
<span class="6373335669519535085" onmouseenter="enter('6373335669519535085');" onmouseout="out('6373335669519535085');" style=""> 224     protected void updateTitleAndPreview() {                                                             </span>
<span class="4716811977187622861" onmouseenter="enter('4716811977187622861');" onmouseout="out('4716811977187622861');" style=""> 225         // try to build a title and preview property out of content                                      </span>
<span class="-6823550475843248983" onmouseenter="enter('-6823550475843248983');" onmouseout="out('-6823550475843248983');" style=""> 226         String content = getContent().trim();                                                            </span>
<span class="327463840444924073" onmouseenter="enter('327463840444924073');" onmouseout="out('327463840444924073');" style=""> 227         if (content.length() &gt; MAX_PREVIEW_CHARS) {                                                      </span>
<span class="-8480236902805956072" onmouseenter="enter('-8480236902805956072');" onmouseout="out('-8480236902805956072');" style=""> 228             content = content.substring(0, MAX_PREVIEW_CHARS - 1);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229         }                                                                                                </span>
<span  style=""> 230                                                                                                          </span>
<span class="5724017298410569034" onmouseenter="enter('5724017298410569034');" onmouseout="out('5724017298410569034');" style=""> 231         int firstNewLinePosition = content.indexOf(NEW_LINE);                                            </span>
<span class="7786689878958261573" onmouseenter="enter('7786689878958261573');" onmouseout="out('7786689878958261573');" style=""> 232         if (firstNewLinePosition &gt; -1 &amp;&amp; firstNewLinePosition &lt; 200) {                                   </span>
<span class="-397121944761876346" onmouseenter="enter('-397121944761876346');" onmouseout="out('-397121944761876346');" style=""> 233             mTitle = content.substring(0, firstNewLinePosition).trim();                                  </span>
<span  style=""> 234                                                                                                          </span>
<span class="6552686713144756852" onmouseenter="enter('6552686713144756852');" onmouseout="out('6552686713144756852');" style=""> 235             if (firstNewLinePosition &lt; content.length()) {                                               </span>
<span class="3544130446617579720" onmouseenter="enter('3544130446617579720');" onmouseout="out('3544130446617579720');" style=""> 236                 mContentPreview = content.substring(firstNewLinePosition, content.length());             </span>
<span class="-6018298786369494309" onmouseenter="enter('-6018298786369494309');" onmouseout="out('-6018298786369494309');" style=""><abbr title=" 237                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).trim();"> 237                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 238             } else {                                                                                     </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 239                 mContentPreview = content;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 241         } else {                                                                                         </span>
<span class="6158164289681498296" onmouseenter="enter('6158164289681498296');" onmouseout="out('6158164289681498296');" style=""> 242             mTitle = content;                                                                            </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 243             mContentPreview = content;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245     }                                                                                                    </span>
<span  style=""> 246                                                                                                          </span>
<span class="-6200437978572139135" onmouseenter="enter('-6200437978572139135');" onmouseout="out('-6200437978572139135');" style=""> 247     public String getTitle() {                                                                           </span>
<span class="5880156293984643419" onmouseenter="enter('5880156293984643419');" onmouseout="out('5880156293984643419');" style=""> 248         if (mTitle == null) {                                                                            </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 249             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250         }                                                                                                </span>
<span class="-7721657982940010876" onmouseenter="enter('-7721657982940010876');" onmouseout="out('-7721657982940010876');" style=""> 251         return mTitle;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252     }                                                                                                    </span>
<span  style=""> 253                                                                                                          </span>
<span class="-2689785139225953203" onmouseenter="enter('-2689785139225953203');" onmouseout="out('-2689785139225953203');" style=""> 254     public String getContent() {                                                                         </span>
<span class="-593492380737036583" onmouseenter="enter('-593492380737036583');" onmouseout="out('-593492380737036583');" style=""> 255         Object content = getProperty(CONTENT_PROPERTY);                                                  </span>
<span class="-2591100211143552235" onmouseenter="enter('-2591100211143552235');" onmouseout="out('-2591100211143552235');" style=""> 256         if (content == null) {                                                                           </span>
<span class="-7439137145129124014" onmouseenter="enter('-7439137145129124014');" onmouseout="out('-7439137145129124014');" style=""> 257             return BLANK_CONTENT;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258         }                                                                                                </span>
<span class="-5104065841615841974" onmouseenter="enter('-5104065841615841974');" onmouseout="out('-5104065841615841974');" style=""> 259         return (String) content;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260     }                                                                                                    </span>
<span  style=""> 261                                                                                                          </span>
<span class="8530044186661736565" onmouseenter="enter('8530044186661736565');" onmouseout="out('8530044186661736565');" style=""> 262     public void setContent(String content) {                                                             </span>
<span class="6017523628383929627" onmouseenter="enter('6017523628383929627');" onmouseout="out('6017523628383929627');" style=""> 263         mTitle = null;                                                                                   </span>
<span class="7468898004511818931" onmouseenter="enter('7468898004511818931');" onmouseout="out('7468898004511818931');" style=""> 264         mContentPreview = null;                                                                          </span>
<span class="-7075313288269577686" onmouseenter="enter('-7075313288269577686');" onmouseout="out('-7075313288269577686');" style=""> 265         setProperty(CONTENT_PROPERTY, content);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span  style=""> 267                                                                                                          </span>
<span class="-3177715860988830633" onmouseenter="enter('-3177715860988830633');" onmouseout="out('-3177715860988830633');" style=""> 268     public String getContentPreview() {                                                                  </span>
<span class="-8081599038098376119" onmouseenter="enter('-8081599038098376119');" onmouseout="out('-8081599038098376119');" style=""> 269         if (mContentPreview == null) {                                                                   </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 270             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271         }                                                                                                </span>
<span class="-7686656279835722897" onmouseenter="enter('-7686656279835722897');" onmouseout="out('-7686656279835722897');" style=""> 272         return mContentPreview;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="-4775876413201063426" onmouseenter="enter('-4775876413201063426');" onmouseout="out('-4775876413201063426');" style=""> 275     public Calendar getCreationDate() {                                                                  </span>
<span class="-8932394895206293128" onmouseenter="enter('-8932394895206293128');" onmouseout="out('-8932394895206293128');" style=""> 276         return numberToDate((Number) getProperty(CREATION_DATE_PROPERTY));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277     }                                                                                                    </span>
<span  style=""> 278                                                                                                          </span>
<span class="3941971105481464917" onmouseenter="enter('3941971105481464917');" onmouseout="out('3941971105481464917');" style=""> 279     public String getCreationDateString() {                                                              </span>
<span class="9031070846992233121" onmouseenter="enter('9031070846992233121');" onmouseout="out('9031070846992233121');" style=""> 280         return numberToDateString((Number) getProperty(CREATION_DATE_PROPERTY));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281     }                                                                                                    </span>
<span  style=""> 282                                                                                                          </span>
<span class="4285319693858833712" onmouseenter="enter('4285319693858833712');" onmouseout="out('4285319693858833712');" style=""> 283     public void setCreationDate(Calendar creationDate) {                                                 </span>
<span class="-3054849024529806025" onmouseenter="enter('-3054849024529806025');" onmouseout="out('-3054849024529806025');" style=""> 284         setProperty(CREATION_DATE_PROPERTY, creationDate.getTimeInMillis() / 1000);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285     }                                                                                                    </span>
<span  style=""> 286                                                                                                          </span>
<span class="4524335170961506892" onmouseenter="enter('4524335170961506892');" onmouseout="out('4524335170961506892');" style=""> 287     public Calendar getModificationDate() {                                                              </span>
<span class="-7489834958201786921" onmouseenter="enter('-7489834958201786921');" onmouseout="out('-7489834958201786921');" style=""> 288         return numberToDate((Number) getProperty(MODIFICATION_DATE_PROPERTY));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="8706492949654452164" onmouseenter="enter('8706492949654452164');" onmouseout="out('8706492949654452164');" style=""> 291     public String getModificationDateString() {                                                          </span>
<span class="-2749496034468843218" onmouseenter="enter('-2749496034468843218');" onmouseout="out('-2749496034468843218');" style=""> 292         return numberToDateString((Number) getProperty(MODIFICATION_DATE_PROPERTY));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293     }                                                                                                    </span>
<span  style=""> 294                                                                                                          </span>
<span class="2249083984085470814" onmouseenter="enter('2249083984085470814');" onmouseout="out('2249083984085470814');" style=""> 295     public void setModificationDate(Calendar modificationDate) {                                         </span>
<span class="-7005792304358284877" onmouseenter="enter('-7005792304358284877');" onmouseout="out('-7005792304358284877');" style=""> 296         setProperty(MODIFICATION_DATE_PROPERTY, modificationDate.getTimeInMillis() / 1000);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297     }                                                                                                    </span>
<span  style=""> 298                                                                                                          </span>
<span class="3367289575484325214" onmouseenter="enter('3367289575484325214');" onmouseout="out('3367289575484325214');" style=""> 299     public String getPublishedUrl() {                                                                    </span>
<span class="-5796973306134907482" onmouseenter="enter('-5796973306134907482');" onmouseout="out('-5796973306134907482');" style=""> 300         String urlCode = (String) getProperty(PUBLISH_URL_PROPERTY);                                     </span>
<span class="7900565639772953850" onmouseenter="enter('7900565639772953850');" onmouseout="out('7900565639772953850');" style=""> 301         if (TextUtils.isEmpty(urlCode)) {                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 302             return &quot;&quot;;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303         }                                                                                                </span>
<span  style=""> 304                                                                                                          </span>
<span class="-8429126260993259062" onmouseenter="enter('-8429126260993259062');" onmouseout="out('-8429126260993259062');" style=""> 305         return PUBLISH_URL + urlCode;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="6727514612417725571" onmouseenter="enter('6727514612417725571');" onmouseout="out('6727514612417725571');" style=""> 308     public boolean hasTag(String tag) {                                                                  </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 309         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-3541717492710720609" onmouseenter="enter('-3541717492710720609');" onmouseout="out('-3541717492710720609');" style=""> 310         String tagLower = tag.toLowerCase();                                                             </span>
<span class="-422766749461737265" onmouseenter="enter('-422766749461737265');" onmouseout="out('-422766749461737265');" style=""> 311         for (String tagName : tags) {                                                                    </span>
<span class="-6783003514598399026" onmouseenter="enter('-6783003514598399026');" onmouseout="out('-6783003514598399026');" style=""> 312             if (tagLower.equals(tagName.toLowerCase())) return true;                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 314         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315     }                                                                                                    </span>
<span  style=""> 316                                                                                                          </span>
<span class="1303119083327749335" onmouseenter="enter('1303119083327749335');" onmouseout="out('1303119083327749335');" style=""> 317     public boolean hasTag(Tag tag) {                                                                     </span>
<span class="-5268388303991583458" onmouseenter="enter('-5268388303991583458');" onmouseout="out('-5268388303991583458');" style=""> 318         return hasTag(tag.getSimperiumKey());                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319     }                                                                                                    </span>
<span  style=""> 320                                                                                                          </span>
<span class="-646587723470162813" onmouseenter="enter('-646587723470162813');" onmouseout="out('-646587723470162813');" style=""> 321     public List&lt;String&gt; getTags() {                                                                      </span>
<span  style=""> 322                                                                                                          </span>
<span class="5046858882238824028" onmouseenter="enter('5046858882238824028');" onmouseout="out('5046858882238824028');" style=""> 323         JSONArray tags = (JSONArray) getProperty(TAGS_PROPERTY);                                         </span>
<span  style=""> 324                                                                                                          </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 325         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 326             tags = new JSONArray();                                                                      </span>
<span class="-8058083631026170990" onmouseenter="enter('-8058083631026170990');" onmouseout="out('-8058083631026170990');" style=""> 327             setProperty(TAGS_PROPERTY, &quot;&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328         }                                                                                                </span>
<span  style=""> 329                                                                                                          </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 330         int length = tags.length();                                                                      </span>
<span  style=""> 331                                                                                                          </span>
<span class="-7737950325994950460" onmouseenter="enter('-7737950325994950460');" onmouseout="out('-7737950325994950460');" style=""> 332         List&lt;String&gt; tagList = new ArrayList&lt;&gt;(length);                                                  </span>
<span  style=""> 333                                                                                                          </span>
<span class="8256074331736484026" onmouseenter="enter('8256074331736484026');" onmouseout="out('8256074331736484026');" style=""> 334         if (length == 0) return tagList;                                                                 </span>
<span  style=""> 335                                                                                                          </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 336         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="-8917993594954591540" onmouseenter="enter('-8917993594954591540');" onmouseout="out('-8917993594954591540');" style=""> 337             String tag = tags.optString(i);                                                              </span>
<span class="-1947204619891178088" onmouseenter="enter('-1947204619891178088');" onmouseout="out('-1947204619891178088');" style=""> 338             if (!tag.equals(&quot;&quot;))                                                                         </span>
<span class="2557583924535716267" onmouseenter="enter('2557583924535716267');" onmouseout="out('2557583924535716267');" style=""> 339                 tagList.add(tag);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340         }                                                                                                </span>
<span  style=""> 341                                                                                                          </span>
<span class="-3183448331203603949" onmouseenter="enter('-3183448331203603949');" onmouseout="out('-3183448331203603949');" style=""> 342         return tagList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343     }                                                                                                    </span>
<span  style=""> 344                                                                                                          </span>
<span class="-6026710755135647724" onmouseenter="enter('-6026710755135647724');" onmouseout="out('-6026710755135647724');" style=""> 345     public void setTags(List&lt;String&gt; tags) {                                                             </span>
<span class="-8982714688054322872" onmouseenter="enter('-8982714688054322872');" onmouseout="out('-8982714688054322872');" style=""> 346         setProperty(TAGS_PROPERTY, new JSONArray(tags));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="-1421161503350598143" onmouseenter="enter('-1421161503350598143');" onmouseout="out('-1421161503350598143');" style=""> 349     public void setTags(JSONArray tags) {                                                                </span>
<span class="-9171468773333999657" onmouseenter="enter('-9171468773333999657');" onmouseout="out('-9171468773333999657');" style=""> 350         setProperty(TAGS_PROPERTY, tags);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351     }                                                                                                    </span>
<span  style=""> 352                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 353     /**                                                                                                  </span>
<span class="2568101064766040631" onmouseenter="enter('2568101064766040631');" onmouseout="out('2568101064766040631');" style=""> 354      * String of tags delimited by a space                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 355      */                                                                                                  </span>
<span class="-8942719802141200658" onmouseenter="enter('-8942719802141200658');" onmouseout="out('-8942719802141200658');" style=""> 356     public CharSequence getTagString() {                                                                 </span>
<span class="-4644025499612109112" onmouseenter="enter('-4644025499612109112');" onmouseout="out('-4644025499612109112');" style=""> 357         StringBuilder tagString = new StringBuilder();                                                   </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 358         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-7185531782033852210" onmouseenter="enter('-7185531782033852210');" onmouseout="out('-7185531782033852210');" style=""> 359         for (String tag : tags) {                                                                        </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 360             if (tagString.length() &gt; 0) {                                                                </span>
<span class="-848655472163713161" onmouseenter="enter('-848655472163713161');" onmouseout="out('-848655472163713161');" style=""> 361                 tagString.append(SPACE);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362             }                                                                                            </span>
<span class="3299521276937168474" onmouseenter="enter('3299521276937168474');" onmouseout="out('3299521276937168474');" style=""> 363             tagString.append(tag);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364         }                                                                                                </span>
<span class="-3216397563367246452" onmouseenter="enter('-3216397563367246452');" onmouseout="out('-3216397563367246452');" style=""> 365         return tagString;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366     }                                                                                                    </span>
<span  style=""> 367                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 368     /**                                                                                                  </span>
<span class="516081738825732450" onmouseenter="enter('516081738825732450');" onmouseout="out('516081738825732450');" style=""> 369      * Sets the note&#x27;s tags by providing it with a {@link String} of space separated tags.               </span>
<span class="-3361819639621639487" onmouseenter="enter('-3361819639621639487');" onmouseout="out('-3361819639621639487');" style=""> 370      * Filters out duplicate tags.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 371      *                                                                                                   </span>
<span class="-3621424951438819239" onmouseenter="enter('-3621424951438819239');" onmouseout="out('-3621424951438819239');" style=""> 372      * @param tagString a space delimited list of tags                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 373      */                                                                                                  </span>
<span class="-7562161399809710400" onmouseenter="enter('-7562161399809710400');" onmouseout="out('-7562161399809710400');" style=""> 374     public void setTagString(String tagString) {                                                         </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 375         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-8892740331038047380" onmouseenter="enter('-8892740331038047380');" onmouseout="out('-8892740331038047380');" style=""> 376         tags.clear();                                                                                    </span>
<span  style=""> 377                                                                                                          </span>
<span class="7647632027089311583" onmouseenter="enter('7647632027089311583');" onmouseout="out('7647632027089311583');" style=""> 378         if (tagString == null) {                                                                         </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 379             setTags(tags);                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 380             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381         }                                                                                                </span>
<span  style=""> 382                                                                                                          </span>
<span class="-6765712323396427098" onmouseenter="enter('-6765712323396427098');" onmouseout="out('-6765712323396427098');" style=""> 383         // Make sure string has a trailing space                                                         </span>
<span class="3861570924678507302" onmouseenter="enter('3861570924678507302');" onmouseout="out('3861570924678507302');" style=""> 384         if (tagString.length() &gt; 1 &amp;&amp; !tagString.substring(tagString.length() - 1).equals(SPACE))        </span>
<span class="-5113585973277465859" onmouseenter="enter('-5113585973277465859');" onmouseout="out('-5113585973277465859');" style=""> 385             tagString = tagString + SPACE;                                                               </span>
<span class="5741128019150417186" onmouseenter="enter('5741128019150417186');" onmouseout="out('5741128019150417186');" style=""> 386         // for comparing case-insensitive strings, would like to find a way to                           </span>
<span class="-5706726934096139867" onmouseenter="enter('-5706726934096139867');" onmouseout="out('-5706726934096139867');" style=""> 387         // do this without allocating a new list and strings                                             </span>
<span class="5881300344958500433" onmouseenter="enter('5881300344958500433');" onmouseout="out('5881300344958500433');" style=""> 388         List&lt;String&gt; tagsUpperCase = new ArrayList&lt;&gt;();                                                  </span>
<span class="-8087573356169949002" onmouseenter="enter('-8087573356169949002');" onmouseout="out('-8087573356169949002');" style=""> 389         // remove all current tags                                                                       </span>
<span class="1170680636863075190" onmouseenter="enter('1170680636863075190');" onmouseout="out('1170680636863075190');" style=""> 390         int start = 0;                                                                                   </span>
<span class="2514405873256423103" onmouseenter="enter('2514405873256423103');" onmouseout="out('2514405873256423103');" style=""> 391         int next;                                                                                        </span>
<span class="-8708428587370728232" onmouseenter="enter('-8708428587370728232');" onmouseout="out('-8708428587370728232');" style=""> 392         String possible;                                                                                 </span>
<span class="3545966998003531195" onmouseenter="enter('3545966998003531195');" onmouseout="out('3545966998003531195');" style=""> 393         String possibleUpperCase;                                                                        </span>
<span class="-67055061468690966" onmouseenter="enter('-67055061468690966');" onmouseout="out('-67055061468690966');" style=""> 394         // search tag string for space characters and pull out individual tags                           </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 395         do {                                                                                             </span>
<span class="539196990274646798" onmouseenter="enter('539196990274646798');" onmouseout="out('539196990274646798');" style=""> 396             next = tagString.indexOf(SPACE, start);                                                      </span>
<span class="7441993871510338947" onmouseenter="enter('7441993871510338947');" onmouseout="out('7441993871510338947');" style=""> 397             if (next &gt; start) {                                                                          </span>
<span class="-6369978890856333437" onmouseenter="enter('-6369978890856333437');" onmouseout="out('-6369978890856333437');" style=""> 398                 possible = tagString.substring(start, next);                                             </span>
<span class="40967178918958955" onmouseenter="enter('40967178918958955');" onmouseout="out('40967178918958955');" style=""> 399                 possibleUpperCase = possible.toUpperCase();                                              </span>
<span class="-6789588636567169254" onmouseenter="enter('-6789588636567169254');" onmouseout="out('-6789588636567169254');" style=""> 400                 if (!possible.equals(SPACE) &amp;&amp; !tagsUpperCase.contains(possibleUpperCase)) {             </span>
<span class="8107171034948128222" onmouseenter="enter('8107171034948128222');" onmouseout="out('8107171034948128222');" style=""> 401                     tagsUpperCase.add(possibleUpperCase);                                                </span>
<span class="-3623952282264178458" onmouseenter="enter('-3623952282264178458');" onmouseout="out('-3623952282264178458');" style=""> 402                     tags.add(possible);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404             }                                                                                            </span>
<span class="2598261311594212195" onmouseenter="enter('2598261311594212195');" onmouseout="out('2598261311594212195');" style=""> 405             start = next + 1;                                                                            </span>
<span class="-8911857571695172425" onmouseenter="enter('-8911857571695172425');" onmouseout="out('-8911857571695172425');" style=""> 406         } while (next &gt; -1);                                                                             </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 407         setTags(tags);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408     }                                                                                                    </span>
<span  style=""> 409                                                                                                          </span>
<span class="-2380080839978865436" onmouseenter="enter('-2380080839978865436');" onmouseout="out('-2380080839978865436');" style=""> 410     public JSONArray getSystemTags() {                                                                   </span>
<span class="1634689045753216867" onmouseenter="enter('1634689045753216867');" onmouseout="out('1634689045753216867');" style=""> 411         JSONArray tags = (JSONArray) getProperty(SYSTEM_TAGS_PROPERTY);                                  </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 412         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 413             tags = new JSONArray();                                                                      </span>
<span class="8109738276011217421" onmouseenter="enter('8109738276011217421');" onmouseout="out('8109738276011217421');" style=""> 414             setProperty(SYSTEM_TAGS_PROPERTY, tags);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415         }                                                                                                </span>
<span class="-7737333077028274174" onmouseenter="enter('-7737333077028274174');" onmouseout="out('-7737333077028274174');" style=""> 416         return tags;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417     }                                                                                                    </span>
<span  style=""> 418                                                                                                          </span>
<span class="3090413247451101219" onmouseenter="enter('3090413247451101219');" onmouseout="out('3090413247451101219');" style=""> 419     public Boolean isDeleted() {                                                                         </span>
<span class="7870299677279363320" onmouseenter="enter('7870299677279363320');" onmouseout="out('7870299677279363320');" style=""> 420         Object deleted = getProperty(DELETED_PROPERTY);                                                  </span>
<span class="3213349019391348934" onmouseenter="enter('3213349019391348934');" onmouseout="out('3213349019391348934');" style=""> 421         if (deleted == null) {                                                                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 422             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423         }                                                                                                </span>
<span class="-8245820290182222148" onmouseenter="enter('-8245820290182222148');" onmouseout="out('-8245820290182222148');" style=""> 424         if (deleted instanceof Boolean) {                                                                </span>
<span class="110137553981332086" onmouseenter="enter('110137553981332086');" onmouseout="out('110137553981332086');" style=""> 425             return (Boolean) deleted;                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 426         } else {                                                                                         </span>
<span class="5495215667694299112" onmouseenter="enter('5495215667694299112');" onmouseout="out('5495215667694299112');" style=""> 427             // Simperium-iOS sets booleans as integer values (0 or 1)                                    </span>
<span class="2375816303299771461" onmouseenter="enter('2375816303299771461');" onmouseout="out('2375816303299771461');" style=""> 428             return deleted instanceof Number &amp;&amp; ((Number) deleted).intValue() != 0;                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430     }                                                                                                    </span>
<span  style=""> 431                                                                                                          </span>
<span class="6912205177980332866" onmouseenter="enter('6912205177980332866');" onmouseout="out('6912205177980332866');" style=""> 432     public void setDeleted(boolean deleted) {                                                            </span>
<span class="-864256626113761460" onmouseenter="enter('-864256626113761460');" onmouseout="out('-864256626113761460');" style=""> 433         setProperty(DELETED_PROPERTY, deleted);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434     }                                                                                                    </span>
<span  style=""> 435                                                                                                          </span>
<span class="5985631777888601261" onmouseenter="enter('5985631777888601261');" onmouseout="out('5985631777888601261');" style=""> 436     public boolean isMarkdownEnabled() {                                                                 </span>
<span class="-5743540823315516839" onmouseenter="enter('-5743540823315516839');" onmouseout="out('-5743540823315516839');" style=""> 437         return hasSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438     }                                                                                                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="-9134361680160631549" onmouseenter="enter('-9134361680160631549');" onmouseout="out('-9134361680160631549');" style=""> 440     public void enableMarkdown() {                                                                       </span>
<span class="-2955264683036225716" onmouseenter="enter('-2955264683036225716');" onmouseout="out('-2955264683036225716');" style=""> 441         setMarkdownEnabled(true);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="-2232443542975324273" onmouseenter="enter('-2232443542975324273');" onmouseout="out('-2232443542975324273');" style=""> 444     public void setMarkdownEnabled(boolean isMarkdownEnabled) {                                          </span>
<span class="5908341161553131781" onmouseenter="enter('5908341161553131781');" onmouseout="out('5908341161553131781');" style=""> 445         if (isMarkdownEnabled) {                                                                         </span>
<span class="-7185185989369936008" onmouseenter="enter('-7185185989369936008');" onmouseout="out('-7185185989369936008');" style=""> 446             addSystemTag(MARKDOWN_TAG);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 447         } else {                                                                                         </span>
<span class="1430034125671484052" onmouseenter="enter('1430034125671484052');" onmouseout="out('1430034125671484052');" style=""> 448             removeSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450     }                                                                                                    </span>
<span  style=""> 451                                                                                                          </span>
<span class="-7992821206137485678" onmouseenter="enter('-7992821206137485678');" onmouseout="out('-7992821206137485678');" style=""> 452     public boolean isPinned() {                                                                          </span>
<span class="7436893036029851482" onmouseenter="enter('7436893036029851482');" onmouseout="out('7436893036029851482');" style=""> 453         return hasSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454     }                                                                                                    </span>
<span  style=""> 455                                                                                                          </span>
<span class="7137874092814138484" onmouseenter="enter('7137874092814138484');" onmouseout="out('7137874092814138484');" style=""> 456     public void setPinned(boolean isPinned) {                                                            </span>
<span class="-8977010770732050857" onmouseenter="enter('-8977010770732050857');" onmouseout="out('-8977010770732050857');" style=""> 457         if (isPinned) {                                                                                  </span>
<span class="-705489752486798560" onmouseenter="enter('-705489752486798560');" onmouseout="out('-705489752486798560');" style=""> 458             addSystemTag(PINNED_TAG);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 459         } else {                                                                                         </span>
<span class="5010790157822780054" onmouseenter="enter('5010790157822780054');" onmouseout="out('5010790157822780054');" style=""> 460             removeSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462     }                                                                                                    </span>
<span  style=""> 463                                                                                                          </span>
<span class="3778345749504952755" onmouseenter="enter('3778345749504952755');" onmouseout="out('3778345749504952755');" style=""> 464     public boolean isPreviewEnabled() {                                                                  </span>
<span class="-6537187368585435683" onmouseenter="enter('-6537187368585435683');" onmouseout="out('-6537187368585435683');" style=""> 465         return hasSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466     }                                                                                                    </span>
<span  style=""> 467                                                                                                          </span>
<span class="-3198839301731339686" onmouseenter="enter('-3198839301731339686');" onmouseout="out('-3198839301731339686');" style=""> 468     public void setPreviewEnabled(boolean isPreviewEnabled) {                                            </span>
<span class="-4540372431458214170" onmouseenter="enter('-4540372431458214170');" onmouseout="out('-4540372431458214170');" style=""> 469         if (isPreviewEnabled) {                                                                          </span>
<span class="1609739104508733891" onmouseenter="enter('1609739104508733891');" onmouseout="out('1609739104508733891');" style=""> 470             addSystemTag(PREVIEW_TAG);                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 471         } else {                                                                                         </span>
<span class="1340191486118728833" onmouseenter="enter('1340191486118728833');" onmouseout="out('1340191486118728833');" style=""> 472             removeSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474     }                                                                                                    </span>
<span  style=""> 475                                                                                                          </span>
<span class="5049304787018344959" onmouseenter="enter('5049304787018344959');" onmouseout="out('5049304787018344959');" style=""> 476     public boolean isPublished() {                                                                       </span>
<span class="-3313218062555121548" onmouseenter="enter('-3313218062555121548');" onmouseout="out('-3313218062555121548');" style=""> 477         return hasSystemTag(PUBLISHED_TAG) &amp;&amp; !TextUtils.isEmpty(getPublishedUrl());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478     }                                                                                                    </span>
<span  style=""> 479                                                                                                          </span>
<span class="-1996001930026199474" onmouseenter="enter('-1996001930026199474');" onmouseout="out('-1996001930026199474');" style=""> 480     public void setPublished(boolean isPublished) {                                                      </span>
<span class="-214835194616400293" onmouseenter="enter('-214835194616400293');" onmouseout="out('-214835194616400293');" style=""> 481         if (isPublished) {                                                                               </span>
<span class="6614236660148008937" onmouseenter="enter('6614236660148008937');" onmouseout="out('6614236660148008937');" style=""> 482             addSystemTag(PUBLISHED_TAG);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 483         } else {                                                                                         </span>
<span class="-3125520029372940316" onmouseenter="enter('-3125520029372940316');" onmouseout="out('-3125520029372940316');" style=""> 484             removeSystemTag(PUBLISHED_TAG);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486     }                                                                                                    </span>
<span  style=""> 487                                                                                                          </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style=""> 488     public void removeTag(String tagName) {                                                              </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 489         List&lt;String&gt; tags = getTags();                                                                   </span>
<span  style=""> 490                                                                                                          </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style=""> 491         List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style=""> 492         tags.removeAll(tagsMatched);                                                                     </span>
<span  style=""> 493                                                                                                          </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 494         setTags(tags);                                                                                   </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style=""> 495         save();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496     }                                                                                                    </span>
<span  style=""> 497                                                                                                          </span>
<span class="8481041411290642641" onmouseenter="enter('8481041411290642641');" onmouseout="out('8481041411290642641');" style=""> 498     private boolean hasSystemTag(String tag) {                                                           </span>
<span class="-1472869558903340894" onmouseenter="enter('-1472869558903340894');" onmouseout="out('-1472869558903340894');" style=""> 499         if (TextUtils.isEmpty(tag))                                                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 500             return false;                                                                                </span>
<span  style=""> 501                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 502         JSONArray tags = getSystemTags();                                                                </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 503         int length = tags.length();                                                                      </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 504         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="1029161545303231138" onmouseenter="enter('1029161545303231138');" onmouseout="out('1029161545303231138');" style=""> 505             if (tags.optString(i).equals(tag)) {                                                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 506                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508         }                                                                                                </span>
<span  style=""> 509                                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 510         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511     }                                                                                                    </span>
<span  style=""> 512                                                                                                          </span>
<span class="-1886965851517885412" onmouseenter="enter('-1886965851517885412');" onmouseout="out('-1886965851517885412');" style=""> 513     private void addSystemTag(String tag) {                                                              </span>
<span class="-7266652503291305395" onmouseenter="enter('-7266652503291305395');" onmouseout="out('-7266652503291305395');" style=""> 514         if (TextUtils.isEmpty(tag)) {                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 515             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516         }                                                                                                </span>
<span  style=""> 517                                                                                                          </span>
<span class="4034934261619610009" onmouseenter="enter('4034934261619610009');" onmouseout="out('4034934261619610009');" style=""> 518         // Ensure we don&#x27;t add the same tag again                                                        </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 519         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="-2655750625237705417" onmouseenter="enter('-2655750625237705417');" onmouseout="out('-2655750625237705417');" style=""> 520             getSystemTags().put(tag);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522     }                                                                                                    </span>
<span  style=""> 523                                                                                                          </span>
<span class="-6272346588769055483" onmouseenter="enter('-6272346588769055483');" onmouseout="out('-6272346588769055483');" style=""> 524     private void removeSystemTag(String tag) {                                                           </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 525         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 526             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527         }                                                                                                </span>
<span  style=""> 528                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 529         JSONArray tags = getSystemTags();                                                                </span>
<span class="6472000112597211426" onmouseenter="enter('6472000112597211426');" onmouseout="out('6472000112597211426');" style=""> 530         JSONArray newTags = new JSONArray();                                                             </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 531         int length = tags.length();                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 532         try {                                                                                            </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 533             for (int i = 0; i &lt; length; i++) {                                                           </span>
<span class="5751642819386913624" onmouseenter="enter('5751642819386913624');" onmouseout="out('5751642819386913624');" style=""> 534                 Object val = tags.get(i);                                                                </span>
<span class="7076458285668173093" onmouseenter="enter('7076458285668173093');" onmouseout="out('7076458285668173093');" style=""> 535                 if (!val.equals(tag))                                                                    </span>
<span class="-6329059091210941964" onmouseenter="enter('-6329059091210941964');" onmouseout="out('-6329059091210941964');" style=""> 536                     newTags.put(val);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537             }                                                                                            </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 538         } catch (JSONException e) {                                                                      </span>
<span class="4377813279323840039" onmouseenter="enter('4377813279323840039');" onmouseout="out('4377813279323840039');" style=""> 539             // could not update pinned setting                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540         }                                                                                                </span>
<span  style=""> 541                                                                                                          </span>
<span class="8301502673130902229" onmouseenter="enter('8301502673130902229');" onmouseout="out('8301502673130902229');" style=""> 542         setProperty(SYSTEM_TAGS_PROPERTY, newTags);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543     }                                                                                                    </span>
<span  style=""> 544                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 545     /**                                                                                                  </span>
<span class="-397105642920094918" onmouseenter="enter('-397105642920094918');" onmouseout="out('-397105642920094918');" style=""> 546      * Check if the note has any changes                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 547      *                                                                                                   </span>
<span class="6656400016423195192" onmouseenter="enter('6656400016423195192');" onmouseout="out('6656400016423195192');" style=""> 548      * @param content           the new note content                                                     </span>
<span class="698428434066591100" onmouseenter="enter('698428434066591100');" onmouseout="out('698428434066591100');" style=""> 549      * @param tagString         space separated tags                                                     </span>
<span class="-6143007710262330196" onmouseenter="enter('-6143007710262330196');" onmouseout="out('-6143007710262330196');" style=""> 550      * @param isPinned          note is pinned                                                           </span>
<span class="-1154760621356330740" onmouseenter="enter('-1154760621356330740');" onmouseout="out('-1154760621356330740');" style=""> 551      * @param isMarkdownEnabled note has markdown enabled                                                </span>
<span class="-2689180860643219460" onmouseenter="enter('-2689180860643219460');" onmouseout="out('-2689180860643219460');" style=""> 552      * @param isPreviewEnabled  note has preview enabled                                                 </span>
<span class="2808295610973044096" onmouseenter="enter('2808295610973044096');" onmouseout="out('2808295610973044096');" style=""> 553      * @return true if note has changes, false if it is unchanged.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 554      */                                                                                                  </span>
<span class="2249306723652890422" onmouseenter="enter('2249306723652890422');" onmouseout="out('2249306723652890422');" style=""><abbr title=" 555     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boolean isPreviewEnabled) {"> 555     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabl🔵</abbr></span>
<span class="-8752168499945681469" onmouseenter="enter('-8752168499945681469');" onmouseout="out('-8752168499945681469');" style=""> 556         return !content.equals(this.getContent())                                                        </span>
<span class="361029725350182512" onmouseenter="enter('361029725350182512');" onmouseout="out('361029725350182512');" style=""> 557                 || !tagString.equals(this.getTagString().toString())                                     </span>
<span class="-3256796514842471479" onmouseenter="enter('-3256796514842471479');" onmouseout="out('-3256796514842471479');" style=""> 558                 || this.isPinned() != isPinned                                                           </span>
<span class="3248054844136733713" onmouseenter="enter('3248054844136733713');" onmouseout="out('3248054844136733713');" style=""> 559                 || this.isMarkdownEnabled() != isMarkdownEnabled                                         </span>
<span class="7822456953056210787" onmouseenter="enter('7822456953056210787');" onmouseout="out('7822456953056210787');" style=""> 560                 || this.isPreviewEnabled() != isPreviewEnabled;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 561     }                                                                                                    </span>
<span  style=""> 562                                                                                                          </span>
<span class="-7717881480664684723" onmouseenter="enter('-7717881480664684723');" onmouseout="out('-7717881480664684723');" style=""> 563     public static class Schema extends BucketSchema&lt;Note&gt; {                                              </span>
<span  style=""> 564                                                                                                          </span>
<span class="-3235753444162186767" onmouseenter="enter('-3235753444162186767');" onmouseout="out('-3235753444162186767');" style=""> 565         protected static NoteIndexer sNoteIndexer = new NoteIndexer();                                   </span>
<span class="-8196684505127442187" onmouseenter="enter('-8196684505127442187');" onmouseout="out('-8196684505127442187');" style=""> 566         protected static NoteFullTextIndexer sFullTextIndexer = new NoteFullTextIndexer();               </span>
<span  style=""> 567                                                                                                          </span>
<span class="-75865115147660663" onmouseenter="enter('-75865115147660663');" onmouseout="out('-75865115147660663');" style=""> 568         public Schema() {                                                                                </span>
<span class="-4886495676536647522" onmouseenter="enter('-4886495676536647522');" onmouseout="out('-4886495676536647522');" style=""> 569             autoIndex();                                                                                 </span>
<span class="-6825633182165860223" onmouseenter="enter('-6825633182165860223');" onmouseout="out('-6825633182165860223');" style=""> 570             addIndex(sNoteIndexer);                                                                      </span>
<span class="-3392547141042614111" onmouseenter="enter('-3392547141042614111');" onmouseout="out('-3392547141042614111');" style=""> 571             setupFullTextIndex(sFullTextIndexer, NoteFullTextIndexer.INDEXES);                           </span>
<span class="-6401895186782523877" onmouseenter="enter('-6401895186782523877');" onmouseout="out('-6401895186782523877');" style=""> 572             setDefault(CONTENT_PROPERTY, &quot;&quot;);                                                            </span>
<span class="-2554467534039091654" onmouseenter="enter('-2554467534039091654');" onmouseout="out('-2554467534039091654');" style=""> 573             setDefault(SYSTEM_TAGS_PROPERTY, new JSONArray());                                           </span>
<span class="228359577715990029" onmouseenter="enter('228359577715990029');" onmouseout="out('228359577715990029');" style=""> 574             setDefault(TAGS_PROPERTY, new JSONArray());                                                  </span>
<span class="-819869596778271798" onmouseenter="enter('-819869596778271798');" onmouseout="out('-819869596778271798');" style=""> 575             setDefault(DELETED_PROPERTY, false);                                                         </span>
<span class="-8278335164591762572" onmouseenter="enter('-8278335164591762572');" onmouseout="out('-8278335164591762572');" style=""> 576             setDefault(SHARE_URL_PROPERTY, &quot;&quot;);                                                          </span>
<span class="4718032932676673460" onmouseenter="enter('4718032932676673460');" onmouseout="out('4718032932676673460');" style=""> 577             setDefault(PUBLISH_URL_PROPERTY, &quot;&quot;);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578         }                                                                                                </span>
<span  style=""> 579                                                                                                          </span>
<span class="1438294404599077665" onmouseenter="enter('1438294404599077665');" onmouseout="out('1438294404599077665');" style=""> 580         public String getRemoteName() {                                                                  </span>
<span class="-8943072285760215512" onmouseenter="enter('-8943072285760215512');" onmouseout="out('-8943072285760215512');" style=""> 581             return Note.BUCKET_NAME;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 582         }                                                                                                </span>
<span  style=""> 583                                                                                                          </span>
<span class="-4946235729406468677" onmouseenter="enter('-4946235729406468677');" onmouseout="out('-4946235729406468677');" style=""> 584         public Note build(String key, JSONObject properties) {                                           </span>
<span class="-2808542273143064496" onmouseenter="enter('-2808542273143064496');" onmouseout="out('-2808542273143064496');" style=""> 585             return new Note(key, properties);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586         }                                                                                                </span>
<span  style=""> 587                                                                                                          </span>
<span class="2318790323390762687" onmouseenter="enter('2318790323390762687');" onmouseout="out('2318790323390762687');" style=""> 588         public void update(Note note, JSONObject properties) {                                           </span>
<span class="-3717338000153341316" onmouseenter="enter('-3717338000153341316');" onmouseout="out('-3717338000153341316');" style=""> 589             note.setProperties(properties);                                                              </span>
<span class="-731284339738821488" onmouseenter="enter('-731284339738821488');" onmouseout="out('-731284339738821488');" style=""> 590             note.mTitle = null;                                                                          </span>
<span class="6645980171711348815" onmouseenter="enter('6645980171711348815');" onmouseout="out('6645980171711348815');" style=""> 591             note.mContentPreview = null;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 592         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594 }                                                                                                        </span>













</pre></td>
                            <td><pre><span class="9181943406056492869" onmouseenter="enter('9181943406056492869');" onmouseout="out('9181943406056492869');" style="">   1 package com.automattic.simplenote.models;                                                                </span>
<span  style="">   2                                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3 import android.content.Context;                                                                          </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   4 import android.text.TextUtils;                                                                           </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   5 import androidx.annotation.NonNull;                                                                      </span>
<span class="-6092371777820512633" onmouseenter="enter('-6092371777820512633');" onmouseout="out('-6092371777820512633');" style="">   6 import com.automattic.simplenote.R;                                                                      </span>
<span class="1225693603979668275" onmouseenter="enter('1225693603979668275');" onmouseout="out('1225693603979668275');" style="">   7 import com.automattic.simplenote.utils.DateTimeUtils;                                                    </span>
<span class="-643769428942460504" onmouseenter="enter('-643769428942460504');" onmouseout="out('-643769428942460504');" style="">   8 import com.automattic.simplenote.utils.TagUtils;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">   9 import com.simperium.client.Bucket;                                                                      </span>
<span class="6125639164043971044" onmouseenter="enter('6125639164043971044');" onmouseout="out('6125639164043971044');" style="">  10 import com.simperium.client.BucketObject;                                                                </span>
<span class="-665307165473523580" onmouseenter="enter('-665307165473523580');" onmouseout="out('-665307165473523580');" style="">  11 import com.simperium.client.BucketSchema;                                                                </span>
<span class="-838252138947964043" onmouseenter="enter('-838252138947964043');" onmouseout="out('-838252138947964043');" style="">  12 import com.simperium.client.Query.ComparisonType;                                                        </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  13 import com.simperium.client.Query;                                                                       </span>
<span class="708242169313900219" onmouseenter="enter('708242169313900219');" onmouseout="out('708242169313900219');" style="">  14 import com.simperium.util.Uuid;                                                                          </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  15 import java.math.BigDecimal;                                                                             </span>
<span class="1238662365364477381" onmouseenter="enter('1238662365364477381');" onmouseout="out('1238662365364477381');" style="">  16 import java.text.DateFormat;                                                                             </span>
<span class="39790854174282861" onmouseenter="enter('39790854174282861');" onmouseout="out('39790854174282861');" style="">  17 import java.text.ParseException;                                                                         </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  18 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  19 import java.util.ArrayList;                                                                              </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  20 import java.util.Calendar;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  21 import java.util.List;                                                                                   </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  22 import java.util.Locale;                                                                                 </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  23 import java.util.TimeZone;                                                                               </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  24 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  25 import java.util.regex.Pattern;                                                                          </span>
<span class="-9193129351684262878" onmouseenter="enter('-9193129351684262878');" onmouseout="out('-9193129351684262878');" style="">  26 import org.json.JSONArray;                                                                               </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  27 import org.json.JSONException;                                                                           </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  28 import org.json.JSONObject;                                                                              </span>
<span class="-4405840676582391526" onmouseenter="enter('-4405840676582391526');" onmouseout="out('-4405840676582391526');" style="">  29 import static com.automattic.simplenote.utils.SimplenoteLinkify.SIMPLENOTE_LINK_PREFIX;                  </span>
<span  style="">  30                                                                                                          </span>
<span  style="">  31                                                                                                          </span>
<span class="1630911635596164534" onmouseenter="enter('1630911635596164534');" onmouseout="out('1630911635596164534');" style="">  32 public class Note extends BucketObject {                                                                 </span>
<span  style="">  33                                                                                                          </span>
<span class="308952937305736491" onmouseenter="enter('308952937305736491');" onmouseout="out('308952937305736491');" style="">  34     public static final String BUCKET_NAME = &quot;note&quot;;                                                     </span>
<span class="6014442145961064017" onmouseenter="enter('6014442145961064017');" onmouseout="out('6014442145961064017');" style="">  35     public static final String MARKDOWN_TAG = &quot;markdown&quot;;                                                </span>
<span class="-8101559688416496628" onmouseenter="enter('-8101559688416496628');" onmouseout="out('-8101559688416496628');" style="">  36     public static final String PINNED_TAG = &quot;pinned&quot;;                                                    </span>
<span class="2755303258201669627" onmouseenter="enter('2755303258201669627');" onmouseout="out('2755303258201669627');" style="">  37     public static final String PREVIEW_TAG = &quot;preview&quot;;                                                  </span>
<span class="1168195147039968761" onmouseenter="enter('1168195147039968761');" onmouseout="out('1168195147039968761');" style="">  38     public static final String PUBLISHED_TAG = &quot;published&quot;;                                              </span>
<span class="6384737125939709481" onmouseenter="enter('6384737125939709481');" onmouseout="out('6384737125939709481');" style="">  39     public static final String NEW_LINE = &quot;\n&quot;;                                                          </span>
<span class="-6709867799447959845" onmouseenter="enter('-6709867799447959845');" onmouseout="out('-6709867799447959845');" style="">  40     public static final String CONTENT_PROPERTY = &quot;content&quot;;                                             </span>
<span class="-7150784166370340219" onmouseenter="enter('-7150784166370340219');" onmouseout="out('-7150784166370340219');" style="">  41     public static final String KEY_PROPERTY = &quot;key&quot;;                                                     </span>
<span class="-2027165692804872527" onmouseenter="enter('-2027165692804872527');" onmouseout="out('-2027165692804872527');" style="">  42     public static final String TAGS_PROPERTY = &quot;tags&quot;;                                                   </span>
<span class="-2782765636412056512" onmouseenter="enter('-2782765636412056512');" onmouseout="out('-2782765636412056512');" style="">  43     public static final String SYSTEM_TAGS_PROPERTY = &quot;systemTags&quot;;                                      </span>
<span class="8082059840675302216" onmouseenter="enter('8082059840675302216');" onmouseout="out('8082059840675302216');" style="">  44     public static final String CREATION_DATE_PROPERTY = &quot;creationDate&quot;;                                  </span>
<span class="-4622628390272251051" onmouseenter="enter('-4622628390272251051');" onmouseout="out('-4622628390272251051');" style="">  45     public static final String MODIFICATION_DATE_PROPERTY = &quot;modificationDate&quot;;                          </span>
<span class="-2614611438740057503" onmouseenter="enter('-2614611438740057503');" onmouseout="out('-2614611438740057503');" style="">  46     public static final String SHARE_URL_PROPERTY = &quot;shareURL&quot;;                                          </span>
<span class="1336476452932138514" onmouseenter="enter('1336476452932138514');" onmouseout="out('1336476452932138514');" style="">  47     public static final String PUBLISH_URL_PROPERTY = &quot;publishURL&quot;;                                      </span>
<span class="-813041889408259553" onmouseenter="enter('-813041889408259553');" onmouseout="out('-813041889408259553');" style="">  48     public static final String DELETED_PROPERTY = &quot;deleted&quot;;                                             </span>
<span class="4804610397042036134" onmouseenter="enter('4804610397042036134');" onmouseout="out('4804610397042036134');" style="">  49     public static final String TITLE_INDEX_NAME = &quot;title&quot;;                                               </span>
<span class="941632753921114575" onmouseenter="enter('941632753921114575');" onmouseout="out('941632753921114575');" style="">  50     public static final String CONTENT_PREVIEW_INDEX_NAME = &quot;contentPreview&quot;;                            </span>
<span class="4601116861733775409" onmouseenter="enter('4601116861733775409');" onmouseout="out('4601116861733775409');" style="">  51     public static final String PINNED_INDEX_NAME = &quot;pinned&quot;;                                             </span>
<span class="-5028217336186587547" onmouseenter="enter('-5028217336186587547');" onmouseout="out('-5028217336186587547');" style="">  52     public static final String MODIFIED_INDEX_NAME = &quot;modified&quot;;                                         </span>
<span class="-2754009865833796434" onmouseenter="enter('-2754009865833796434');" onmouseout="out('-2754009865833796434');" style="">  53     public static final String CREATED_INDEX_NAME = &quot;created&quot;;                                           </span>
<span class="-620094810998015131" onmouseenter="enter('-620094810998015131');" onmouseout="out('-620094810998015131');" style="">  54     public static final String MATCHED_TITLE_INDEX_NAME = &quot;matchedTitle&quot;;                                </span>
<span class="5961311022296185233" onmouseenter="enter('5961311022296185233');" onmouseout="out('5961311022296185233');" style="">  55     public static final String MATCHED_CONTENT_INDEX_NAME = &quot;matchedContent&quot;;                            </span>
<span class="354077366863542774" onmouseenter="enter('354077366863542774');" onmouseout="out('354077366863542774');" style="">  56     public static final String PUBLISH_URL = &quot;http://simp.ly/p/&quot;;                                        </span>
<span class="2475488422216258991" onmouseenter="enter('2475488422216258991');" onmouseout="out('2475488422216258991');" style="">  57     static public final String[] FULL_TEXT_INDEXES = new String[]{                                       </span>
<span class="394877313876947494" onmouseenter="enter('394877313876947494');" onmouseout="out('394877313876947494');" style="">  58             Note.TITLE_INDEX_NAME, Note.CONTENT_PROPERTY};                                               </span>
<span class="-4178348678314657322" onmouseenter="enter('-4178348678314657322');" onmouseout="out('-4178348678314657322');" style="">  59     private static final String BLANK_CONTENT = &quot;&quot;;                                                      </span>
<span class="-8217848203306725764" onmouseenter="enter('-8217848203306725764');" onmouseout="out('-8217848203306725764');" style="">  60     private static final String SPACE = &quot; &quot;;                                                             </span>
<span class="7999038666256371202" onmouseenter="enter('7999038666256371202');" onmouseout="out('7999038666256371202');" style="">  61     private static final int MAX_PREVIEW_CHARS = 300;                                                    </span>
<span class="6617027899127222559" onmouseenter="enter('6617027899127222559');" onmouseout="out('6617027899127222559');" style="">  62     protected String mTitle = null;                                                                      </span>
<span class="-1758175371106332326" onmouseenter="enter('-1758175371106332326');" onmouseout="out('-1758175371106332326');" style="">  63     protected String mContentPreview = null;                                                             </span>
<span  style="">  64                                                                                                          </span>
<span class="-1397623179598998233" onmouseenter="enter('-1397623179598998233');" onmouseout="out('-1397623179598998233');" style="">  65     public Note() {                                                                                      </span>
<span class="-1154746796976603421" onmouseenter="enter('-1154746796976603421');" onmouseout="out('-1154746796976603421');" style="">  66         this(Uuid.uuid());                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="767263449852825375" onmouseenter="enter('767263449852825375');" onmouseout="out('767263449852825375');" style="">  69     public Note(String key) {                                                                            </span>
<span class="53769298429916076" onmouseenter="enter('53769298429916076');" onmouseout="out('53769298429916076');" style="">  70         this(key, new JSONObject());                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="8617384997772879313" onmouseenter="enter('8617384997772879313');" onmouseout="out('8617384997772879313');" style="">  73     public Note(String key, JSONObject properties) {                                                     </span>
<span class="-6821486208075908487" onmouseenter="enter('-6821486208075908487');" onmouseout="out('-6821486208075908487');" style="">  74         super(key, properties);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="458900878223274025" onmouseenter="enter('458900878223274025');" onmouseout="out('458900878223274025');" style="">  77     public static Query&lt;Note&gt; all(Bucket&lt;Note&gt; noteBucket) {                                             </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  78         return noteBucket.query()                                                                        </span>
<span class="-6142536283945774731" onmouseenter="enter('-6142536283945774731');" onmouseout="out('-6142536283945774731');" style="">  79                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80     }                                                                                                    </span>
<span  style="">  81                                                                                                          </span>
<span class="-6525045200709488349" onmouseenter="enter('-6525045200709488349');" onmouseout="out('-6525045200709488349');" style="">  82     public static Query&lt;Note&gt; allDeleted(Bucket&lt;Note&gt; noteBucket) {                                      </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  83         return noteBucket.query()                                                                        </span>
<span class="-6326653849445488397" onmouseenter="enter('-6326653849445488397');" onmouseout="out('-6326653849445488397');" style="">  84                 .where(DELETED_PROPERTY, ComparisonType.EQUAL_TO, true);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85     }                                                                                                    </span>
<span  style="">  86                                                                                                          </span>
<span class="4789545620535823187" onmouseenter="enter('4789545620535823187');" onmouseout="out('4789545620535823187');" style="">  87     public static Query&lt;Note&gt; search(Bucket&lt;Note&gt; noteBucket, String searchString) {                     </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  88         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  89                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-8956541673379552524" onmouseenter="enter('-8956541673379552524');" onmouseout="out('-8956541673379552524');" style="">  90                 .where(CONTENT_PROPERTY, ComparisonType.LIKE, &quot;%&quot; + searchString + &quot;%&quot;);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span  style="">  92                                                                                                          </span>
<span class="-1229245405128052241" onmouseenter="enter('-1229245405128052241');" onmouseout="out('-1229245405128052241');" style="">  93     public static Query&lt;Note&gt; allInTag(Bucket&lt;Note&gt; noteBucket, String tag) {                            </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  94         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  95                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="-2207133284802963072" onmouseenter="enter('-2207133284802963072');" onmouseout="out('-2207133284802963072');" style="">  96                 .where(TAGS_PROPERTY, ComparisonType.LIKE, tag);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97     }                                                                                                    </span>
<span  style="">  98                                                                                                          </span>
<span class="2971412545726517521" onmouseenter="enter('2971412545726517521');" onmouseout="out('2971412545726517521');" style="">  99     public static Query&lt;Note&gt; allWithNoTag(Bucket&lt;Note&gt; noteBucket) {                                    </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style=""> 100         return noteBucket.query()                                                                        </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 101                 .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                              </span>
<span class="6567927526378864260" onmouseenter="enter('6567927526378864260');" onmouseout="out('6567927526378864260');" style=""> 102                 .where(TAGS_PROPERTY, ComparisonType.EQUAL_TO, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103     }                                                                                                    </span>
<span  style=""> 104                                                                                                          </span>
<span class="-8938802169787860370" onmouseenter="enter('-8938802169787860370');" onmouseout="out('-8938802169787860370');" style=""> 105     public static Note fromContent(Bucket&lt;Note&gt; notesBucket, String content) {                           </span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 106         Note note = notesBucket.newObject();                                                             </span>
<span class="8912392529601079939" onmouseenter="enter('8912392529601079939');" onmouseout="out('8912392529601079939');" style=""> 107         note.setContent(content);                                                                        </span>
<span class="1465773082586789630" onmouseenter="enter('1465773082586789630');" onmouseout="out('1465773082586789630');" style=""> 108         note.setCreationDate(Calendar.getInstance());                                                    </span>
<span class="-2721490489979887121" onmouseenter="enter('-2721490489979887121');" onmouseout="out('-2721490489979887121');" style=""> 109         note.setModificationDate(note.getCreationDate());                                                </span>
<span  style=""> 110                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 111         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span  style=""> 113                                                                                                          </span>
<span class="-5396846739988471840" onmouseenter="enter('-5396846739988471840');" onmouseout="out('-5396846739988471840');" style=""><abbr title=" 114     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONException, ParseException {"> 114     public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONExcepti🔵</abbr></span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style=""> 115         Note note = notesBucket.newObject();                                                             </span>
<span class="3098500428867040128" onmouseenter="enter('3098500428867040128');" onmouseout="out('3098500428867040128');" style=""> 116         note.setContent(noteJson.optString(&quot;content&quot;, &quot;&quot;));                                              </span>
<span class="-8154332140304970847" onmouseenter="enter('-8154332140304970847');" onmouseout="out('-8154332140304970847');" style=""><abbr title=" 117         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;creationDate&quot;)) : Calendar.getInstance());"> 117         note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getStr🔵</abbr></span>
<span class="-8572711449683887689" onmouseenter="enter('-8572711449683887689');" onmouseout="out('-8572711449683887689');" style=""><abbr title=" 118         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;lastModified&quot;)) : Calendar.getInstance());"> 118         note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.ge🔵</abbr></span>
<span class="-5498600081013067663" onmouseenter="enter('-5498600081013067663');" onmouseout="out('-5498600081013067663');" style=""> 119         note.setTags(noteJson.has(&quot;tags&quot;) ? noteJson.getJSONArray(&quot;tags&quot;) : new JSONArray());            </span>
<span class="875604650523146036" onmouseenter="enter('875604650523146036');" onmouseout="out('875604650523146036');" style=""> 120         note.setPinned(noteJson.optBoolean(&quot;pinned&quot;, false));                                            </span>
<span class="1705691732106409520" onmouseenter="enter('1705691732106409520');" onmouseout="out('1705691732106409520');" style=""> 121         note.setMarkdownEnabled(noteJson.optBoolean(&quot;markdown&quot;, false));                                 </span>
<span  style=""> 122                                                                                                          </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style=""> 123         return note;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124     }                                                                                                    </span>
<span  style=""> 125                                                                                                          </span>
<span class="-5517811679430868458" onmouseenter="enter('-5517811679430868458');" onmouseout="out('-5517811679430868458');" style=""> 126     @SuppressWarnings(&quot;unused&quot;)                                                                          </span>
<span class="-4700657283235731904" onmouseenter="enter('-4700657283235731904');" onmouseout="out('-4700657283235731904');" style=""> 127     public static String dateString(Number time, boolean useShortFormat, Context context) {              </span>
<span class="1180405838137731219" onmouseenter="enter('1180405838137731219');" onmouseout="out('1180405838137731219');" style=""> 128         Calendar c = numberToDate(time);                                                                 </span>
<span class="-7277187246954612403" onmouseenter="enter('-7277187246954612403');" onmouseout="out('-7277187246954612403');" style=""> 129         return dateString(c, useShortFormat, context);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="-8567197073889182513" onmouseenter="enter('-8567197073889182513');" onmouseout="out('-8567197073889182513');" style=""> 132     public static String dateString(Calendar c, boolean useShortFormat, Context context) {               </span>
<span class="-4601601397388656558" onmouseenter="enter('-4601601397388656558');" onmouseout="out('-4601601397388656558');" style=""> 133         int year, month, day;                                                                            </span>
<span  style=""> 134                                                                                                          </span>
<span class="-7517224838183820978" onmouseenter="enter('-7517224838183820978');" onmouseout="out('-7517224838183820978');" style=""> 135         String time, date, retVal;                                                                       </span>
<span  style=""> 136                                                                                                          </span>
<span class="-7023974272217551721" onmouseenter="enter('-7023974272217551721');" onmouseout="out('-7023974272217551721');" style=""> 137         Calendar diff = Calendar.getInstance();                                                          </span>
<span class="7346751312817051138" onmouseenter="enter('7346751312817051138');" onmouseout="out('7346751312817051138');" style=""> 138         diff.setTimeInMillis(diff.getTimeInMillis() - c.getTimeInMillis());                              </span>
<span  style=""> 139                                                                                                          </span>
<span class="-2909064038838300707" onmouseenter="enter('-2909064038838300707');" onmouseout="out('-2909064038838300707');" style=""> 140         year = diff.get(Calendar.YEAR);                                                                  </span>
<span class="-5868815277479911950" onmouseenter="enter('-5868815277479911950');" onmouseout="out('-5868815277479911950');" style=""> 141         month = diff.get(Calendar.MONTH);                                                                </span>
<span class="-2637536938238774465" onmouseenter="enter('-2637536938238774465');" onmouseout="out('-2637536938238774465');" style=""> 142         day = diff.get(Calendar.DAY_OF_MONTH);                                                           </span>
<span  style=""> 143                                                                                                          </span>
<span class="1536424719044438994" onmouseenter="enter('1536424719044438994');" onmouseout="out('1536424719044438994');" style=""> 144         diff.setTimeInMillis(0); // starting time                                                        </span>
<span class="-779753610725741249" onmouseenter="enter('-779753610725741249');" onmouseout="out('-779753610725741249');" style=""> 145         time = DateFormat.getTimeInstance(DateFormat.SHORT).format(c.getTime());                         </span>
<span class="-2383141111479093557" onmouseenter="enter('-2383141111479093557');" onmouseout="out('-2383141111479093557');" style=""><abbr title=" 146         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.DAY_OF_MONTH))) {"> 146         if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(🔵</abbr></span>
<span class="7635099361720652074" onmouseenter="enter('7635099361720652074');" onmouseout="out('7635099361720652074');" style=""> 147             date = context.getResources().getString(R.string.today);                                     </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 148             if (useShortFormat)                                                                          </span>
<span class="597955899566079772" onmouseenter="enter('597955899566079772');" onmouseout="out('597955899566079772');" style=""> 149                 retVal = time;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 150             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 151                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-818230175523660822" onmouseenter="enter('-818230175523660822');" onmouseout="out('-818230175523660822');" style=""><abbr title=" 152         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)) {"> 152         } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)🔵</abbr></span>
<span class="-8420997342841621789" onmouseenter="enter('-8420997342841621789');" onmouseout="out('-8420997342841621789');" style=""> 153             date = context.getResources().getString(R.string.yesterday);                                 </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 154             if (useShortFormat)                                                                          </span>
<span class="8381191313867632389" onmouseenter="enter('8381191313867632389');" onmouseout="out('8381191313867632389');" style=""> 155                 retVal = date;                                                                           </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 156             else                                                                                         </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 157                 retVal = date + &quot;, &quot; + time;                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 158         } else {                                                                                         </span>
<span class="-8110415762919125838" onmouseenter="enter('-8110415762919125838');" onmouseout="out('-8110415762919125838');" style=""> 159             date = new SimpleDateFormat(&quot;MMM dd&quot;, Locale.US).format(c.getTime());                        </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 160             retVal = date + &quot;, &quot; + time;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span  style=""> 162                                                                                                          </span>
<span class="-2448447535460405943" onmouseenter="enter('-2448447535460405943');" onmouseout="out('-2448447535460405943');" style=""> 163         return retVal;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164     }                                                                                                    </span>
<span  style=""> 165                                                                                                          </span>
<span class="-1889536418011186938" onmouseenter="enter('-1889536418011186938');" onmouseout="out('-1889536418011186938');" style=""> 166     private static int getReferenceCount(String key, String content) {                                   </span>
<span class="-666706993090019623" onmouseenter="enter('-666706993090019623');" onmouseout="out('-666706993090019623');" style=""> 167         Pattern pattern = Pattern.compile(SIMPLENOTE_LINK_PREFIX + key);                                 </span>
<span class="-5723325120560414069" onmouseenter="enter('-5723325120560414069');" onmouseout="out('-5723325120560414069');" style=""> 168         Matcher matcher = pattern.matcher(content);                                                      </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 169         int count = 0;                                                                                   </span>
<span  style=""> 170                                                                                                          </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 171         while (matcher.find()) {                                                                         </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style=""> 172             count++;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173         }                                                                                                </span>
<span  style=""> 174                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 175         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span  style=""> 177                                                                                                          </span>
<span class="-3902014892596708789" onmouseenter="enter('-3902014892596708789');" onmouseout="out('-3902014892596708789');" style=""> 178     public static List&lt;Reference&gt; getReferences(Bucket&lt;Note&gt; bucket, String key) {                       </span>
<span class="-6029684357073269481" onmouseenter="enter('-6029684357073269481');" onmouseout="out('-6029684357073269481');" style=""> 179         List&lt;Reference&gt; references = new ArrayList&lt;&gt;();                                                  </span>
<span class="-4658611266183475458" onmouseenter="enter('-4658611266183475458');" onmouseout="out('-4658611266183475458');" style=""> 180         Bucket.ObjectCursor&lt;Note&gt; cursor = Note.search(bucket, SIMPLENOTE_LINK_PREFIX + key).execute();  </span>
<span  style=""> 181                                                                                                          </span>
<span class="-679463407698125917" onmouseenter="enter('-679463407698125917');" onmouseout="out('-679463407698125917');" style=""> 182         while (cursor.moveToNext()) {                                                                    </span>
<span class="3501306350092034788" onmouseenter="enter('3501306350092034788');" onmouseout="out('3501306350092034788');" style=""> 183             Note note = cursor.getObject();                                                              </span>
<span class="-4285952824793620055" onmouseenter="enter('-4285952824793620055');" onmouseout="out('-4285952824793620055');" style=""> 184             references.add(                                                                              </span>
<span class="-1411633905067872974" onmouseenter="enter('-1411633905067872974');" onmouseout="out('-1411633905067872974');" style=""> 185                 new Reference(                                                                           </span>
<span class="-3110909059350189445" onmouseenter="enter('-3110909059350189445');" onmouseout="out('-3110909059350189445');" style=""> 186                     note.getSimperiumKey(),                                                              </span>
<span class="2543604805982207984" onmouseenter="enter('2543604805982207984');" onmouseout="out('2543604805982207984');" style=""> 187                     note.getTitle(),                                                                     </span>
<span class="7904695514627173906" onmouseenter="enter('7904695514627173906');" onmouseout="out('7904695514627173906');" style=""> 188                     note.getModificationDate(),                                                          </span>
<span class="5299483559431490396" onmouseenter="enter('5299483559431490396');" onmouseout="out('5299483559431490396');" style=""> 189                     getReferenceCount(key, note.getContent())                                            </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 190                 )                                                                                        </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 191             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span  style=""> 193                                                                                                          </span>
<span class="-816749515151999705" onmouseenter="enter('-816749515151999705');" onmouseout="out('-816749515151999705');" style=""> 194         return references;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195     }                                                                                                    </span>
<span  style=""> 196                                                                                                          </span>
<span class="6991191424901834769" onmouseenter="enter('6991191424901834769');" onmouseout="out('6991191424901834769');" style=""> 197     public static Calendar numberToDate(Number time) {                                                   </span>
<span class="2627151998164378009" onmouseenter="enter('2627151998164378009');" onmouseout="out('2627151998164378009');" style=""> 198         Calendar date = Calendar.getInstance();                                                          </span>
<span class="-4794582782203016972" onmouseenter="enter('-4794582782203016972');" onmouseout="out('-4794582782203016972');" style=""> 199         if (time != null) {                                                                              </span>
<span class="-3733626690602126121" onmouseenter="enter('-3733626690602126121');" onmouseout="out('-3733626690602126121');" style=""> 200             // Flick Note uses millisecond resolution timestamps Simplenote expects seconds              </span>
<span class="3026137703351918876" onmouseenter="enter('3026137703351918876');" onmouseout="out('3026137703351918876');" style=""> 201             // since we only deal with create and modify timestamps, they should all have occurred       </span>
<span class="-9197945245707351438" onmouseenter="enter('-9197945245707351438');" onmouseout="out('-9197945245707351438');" style=""> 202             // at the present time or in the past.                                                       </span>
<span class="-5330372272438133634" onmouseenter="enter('-5330372272438133634');" onmouseout="out('-5330372272438133634');" style=""> 203             float now = (float) date.getTimeInMillis() / 1000;                                           </span>
<span class="7868403810214452697" onmouseenter="enter('7868403810214452697');" onmouseout="out('7868403810214452697');" style=""> 204             float magnitude = time.floatValue() / now;                                                   </span>
<span class="5909991427144614543" onmouseenter="enter('5909991427144614543');" onmouseout="out('5909991427144614543');" style=""> 205             if (magnitude &gt;= 2.f) time = time.longValue() / 1000;                                        </span>
<span class="2284249078526717288" onmouseenter="enter('2284249078526717288');" onmouseout="out('2284249078526717288');" style=""> 206             date.setTimeInMillis(time.longValue() * 1000);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207         }                                                                                                </span>
<span class="7179427650659377170" onmouseenter="enter('7179427650659377170');" onmouseout="out('7179427650659377170');" style=""> 208         return date;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="466463869222866851" onmouseenter="enter('466463869222866851');" onmouseout="out('466463869222866851');" style=""> 211     public static String numberToDateString(@NonNull Number number) {                                    </span>
<span class="-4090451846849985785" onmouseenter="enter('-4090451846849985785');" onmouseout="out('-4090451846849985785');" style=""> 212         long milliseconds = new BigDecimal(number.toString()).multiply(new BigDecimal(1000)).longValue();</span>
<span class="2239009023688190143" onmouseenter="enter('2239009023688190143');" onmouseout="out('2239009023688190143');" style=""> 213         Calendar calendar = Calendar.getInstance();                                                      </span>
<span class="9071902319976922096" onmouseenter="enter('9071902319976922096');" onmouseout="out('9071902319976922096');" style=""> 214         calendar.setTimeInMillis(milliseconds);                                                          </span>
<span class="-1960866814541712569" onmouseenter="enter('-1960866814541712569');" onmouseout="out('-1960866814541712569');" style=""> 215         SimpleDateFormat date = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSS&#x27;Z&#x27;&quot;, Locale.US);         </span>
<span class="1592748650922216684" onmouseenter="enter('1592748650922216684');" onmouseout="out('1592748650922216684');" style=""> 216         date.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));                                                   </span>
<span class="5827364706871365292" onmouseenter="enter('5827364706871365292');" onmouseout="out('5827364706871365292');" style=""> 217         return date.format(calendar.getTime());                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="6373335669519535085" onmouseenter="enter('6373335669519535085');" onmouseout="out('6373335669519535085');" style=""> 220     protected void updateTitleAndPreview() {                                                             </span>
<span class="4716811977187622861" onmouseenter="enter('4716811977187622861');" onmouseout="out('4716811977187622861');" style=""> 221         // try to build a title and preview property out of content                                      </span>
<span class="-6823550475843248983" onmouseenter="enter('-6823550475843248983');" onmouseout="out('-6823550475843248983');" style=""> 222         String content = getContent().trim();                                                            </span>
<span class="327463840444924073" onmouseenter="enter('327463840444924073');" onmouseout="out('327463840444924073');" style=""> 223         if (content.length() &gt; MAX_PREVIEW_CHARS) {                                                      </span>
<span class="-8480236902805956072" onmouseenter="enter('-8480236902805956072');" onmouseout="out('-8480236902805956072');" style=""> 224             content = content.substring(0, MAX_PREVIEW_CHARS - 1);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225         }                                                                                                </span>
<span  style=""> 226                                                                                                          </span>
<span class="5724017298410569034" onmouseenter="enter('5724017298410569034');" onmouseout="out('5724017298410569034');" style=""> 227         int firstNewLinePosition = content.indexOf(NEW_LINE);                                            </span>
<span class="7786689878958261573" onmouseenter="enter('7786689878958261573');" onmouseout="out('7786689878958261573');" style=""> 228         if (firstNewLinePosition &gt; -1 &amp;&amp; firstNewLinePosition &lt; 200) {                                   </span>
<span class="-397121944761876346" onmouseenter="enter('-397121944761876346');" onmouseout="out('-397121944761876346');" style=""> 229             mTitle = content.substring(0, firstNewLinePosition).trim();                                  </span>
<span  style=""> 230                                                                                                          </span>
<span class="6552686713144756852" onmouseenter="enter('6552686713144756852');" onmouseout="out('6552686713144756852');" style=""> 231             if (firstNewLinePosition &lt; content.length()) {                                               </span>
<span class="3544130446617579720" onmouseenter="enter('3544130446617579720');" onmouseout="out('3544130446617579720');" style=""> 232                 mContentPreview = content.substring(firstNewLinePosition, content.length());             </span>
<span class="-6018298786369494309" onmouseenter="enter('-6018298786369494309');" onmouseout="out('-6018298786369494309');" style=""><abbr title=" 233                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).trim();"> 233                 mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 234             } else {                                                                                     </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 235                 mContentPreview = content;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 237         } else {                                                                                         </span>
<span class="6158164289681498296" onmouseenter="enter('6158164289681498296');" onmouseout="out('6158164289681498296');" style=""> 238             mTitle = content;                                                                            </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 239             mContentPreview = content;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241     }                                                                                                    </span>
<span  style=""> 242                                                                                                          </span>
<span class="-6200437978572139135" onmouseenter="enter('-6200437978572139135');" onmouseout="out('-6200437978572139135');" style=""> 243     public String getTitle() {                                                                           </span>
<span class="5880156293984643419" onmouseenter="enter('5880156293984643419');" onmouseout="out('5880156293984643419');" style=""> 244         if (mTitle == null) {                                                                            </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 245             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246         }                                                                                                </span>
<span class="-7721657982940010876" onmouseenter="enter('-7721657982940010876');" onmouseout="out('-7721657982940010876');" style=""> 247         return mTitle;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248     }                                                                                                    </span>
<span  style=""> 249                                                                                                          </span>
<span class="-2689785139225953203" onmouseenter="enter('-2689785139225953203');" onmouseout="out('-2689785139225953203');" style=""> 250     public String getContent() {                                                                         </span>
<span class="-593492380737036583" onmouseenter="enter('-593492380737036583');" onmouseout="out('-593492380737036583');" style=""> 251         Object content = getProperty(CONTENT_PROPERTY);                                                  </span>
<span class="-2591100211143552235" onmouseenter="enter('-2591100211143552235');" onmouseout="out('-2591100211143552235');" style=""> 252         if (content == null) {                                                                           </span>
<span class="-7439137145129124014" onmouseenter="enter('-7439137145129124014');" onmouseout="out('-7439137145129124014');" style=""> 253             return BLANK_CONTENT;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254         }                                                                                                </span>
<span class="-5104065841615841974" onmouseenter="enter('-5104065841615841974');" onmouseout="out('-5104065841615841974');" style=""> 255         return (String) content;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256     }                                                                                                    </span>
<span  style=""> 257                                                                                                          </span>
<span class="8530044186661736565" onmouseenter="enter('8530044186661736565');" onmouseout="out('8530044186661736565');" style=""> 258     public void setContent(String content) {                                                             </span>
<span class="6017523628383929627" onmouseenter="enter('6017523628383929627');" onmouseout="out('6017523628383929627');" style=""> 259         mTitle = null;                                                                                   </span>
<span class="7468898004511818931" onmouseenter="enter('7468898004511818931');" onmouseout="out('7468898004511818931');" style=""> 260         mContentPreview = null;                                                                          </span>
<span class="-7075313288269577686" onmouseenter="enter('-7075313288269577686');" onmouseout="out('-7075313288269577686');" style=""> 261         setProperty(CONTENT_PROPERTY, content);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262     }                                                                                                    </span>
<span  style=""> 263                                                                                                          </span>
<span class="-3177715860988830633" onmouseenter="enter('-3177715860988830633');" onmouseout="out('-3177715860988830633');" style=""> 264     public String getContentPreview() {                                                                  </span>
<span class="-8081599038098376119" onmouseenter="enter('-8081599038098376119');" onmouseout="out('-8081599038098376119');" style=""> 265         if (mContentPreview == null) {                                                                   </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 266             updateTitleAndPreview();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267         }                                                                                                </span>
<span class="-7686656279835722897" onmouseenter="enter('-7686656279835722897');" onmouseout="out('-7686656279835722897');" style=""> 268         return mContentPreview;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269     }                                                                                                    </span>
<span  style=""> 270                                                                                                          </span>
<span class="-4775876413201063426" onmouseenter="enter('-4775876413201063426');" onmouseout="out('-4775876413201063426');" style=""> 271     public Calendar getCreationDate() {                                                                  </span>
<span class="-8932394895206293128" onmouseenter="enter('-8932394895206293128');" onmouseout="out('-8932394895206293128');" style=""> 272         return numberToDate((Number) getProperty(CREATION_DATE_PROPERTY));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="3941971105481464917" onmouseenter="enter('3941971105481464917');" onmouseout="out('3941971105481464917');" style=""> 275     public String getCreationDateString() {                                                              </span>
<span class="9031070846992233121" onmouseenter="enter('9031070846992233121');" onmouseout="out('9031070846992233121');" style=""> 276         return numberToDateString((Number) getProperty(CREATION_DATE_PROPERTY));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277     }                                                                                                    </span>
<span  style=""> 278                                                                                                          </span>
<span class="4285319693858833712" onmouseenter="enter('4285319693858833712');" onmouseout="out('4285319693858833712');" style=""> 279     public void setCreationDate(Calendar creationDate) {                                                 </span>
<span class="-3054849024529806025" onmouseenter="enter('-3054849024529806025');" onmouseout="out('-3054849024529806025');" style=""> 280         setProperty(CREATION_DATE_PROPERTY, creationDate.getTimeInMillis() / 1000);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281     }                                                                                                    </span>
<span  style=""> 282                                                                                                          </span>
<span class="4524335170961506892" onmouseenter="enter('4524335170961506892');" onmouseout="out('4524335170961506892');" style=""> 283     public Calendar getModificationDate() {                                                              </span>
<span class="-7489834958201786921" onmouseenter="enter('-7489834958201786921');" onmouseout="out('-7489834958201786921');" style=""> 284         return numberToDate((Number) getProperty(MODIFICATION_DATE_PROPERTY));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285     }                                                                                                    </span>
<span  style=""> 286                                                                                                          </span>
<span class="8706492949654452164" onmouseenter="enter('8706492949654452164');" onmouseout="out('8706492949654452164');" style=""> 287     public String getModificationDateString() {                                                          </span>
<span class="-2749496034468843218" onmouseenter="enter('-2749496034468843218');" onmouseout="out('-2749496034468843218');" style=""> 288         return numberToDateString((Number) getProperty(MODIFICATION_DATE_PROPERTY));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="2249083984085470814" onmouseenter="enter('2249083984085470814');" onmouseout="out('2249083984085470814');" style=""> 291     public void setModificationDate(Calendar modificationDate) {                                         </span>
<span class="-7005792304358284877" onmouseenter="enter('-7005792304358284877');" onmouseout="out('-7005792304358284877');" style=""> 292         setProperty(MODIFICATION_DATE_PROPERTY, modificationDate.getTimeInMillis() / 1000);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293     }                                                                                                    </span>
<span  style=""> 294                                                                                                          </span>
<span class="3367289575484325214" onmouseenter="enter('3367289575484325214');" onmouseout="out('3367289575484325214');" style=""> 295     public String getPublishedUrl() {                                                                    </span>
<span class="-5796973306134907482" onmouseenter="enter('-5796973306134907482');" onmouseout="out('-5796973306134907482');" style=""> 296         String urlCode = (String) getProperty(PUBLISH_URL_PROPERTY);                                     </span>
<span class="7900565639772953850" onmouseenter="enter('7900565639772953850');" onmouseout="out('7900565639772953850');" style=""> 297         if (TextUtils.isEmpty(urlCode)) {                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 298             return &quot;&quot;;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299         }                                                                                                </span>
<span  style=""> 300                                                                                                          </span>
<span class="-8429126260993259062" onmouseenter="enter('-8429126260993259062');" onmouseout="out('-8429126260993259062');" style=""> 301         return PUBLISH_URL + urlCode;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302     }                                                                                                    </span>
<span  style=""> 303                                                                                                          </span>
<span class="6727514612417725571" onmouseenter="enter('6727514612417725571');" onmouseout="out('6727514612417725571');" style=""> 304     public boolean hasTag(String tag) {                                                                  </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 305         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-3541717492710720609" onmouseenter="enter('-3541717492710720609');" onmouseout="out('-3541717492710720609');" style=""> 306         String tagLower = tag.toLowerCase();                                                             </span>
<span class="-422766749461737265" onmouseenter="enter('-422766749461737265');" onmouseout="out('-422766749461737265');" style=""> 307         for (String tagName : tags) {                                                                    </span>
<span class="-6783003514598399026" onmouseenter="enter('-6783003514598399026');" onmouseout="out('-6783003514598399026');" style=""> 308             if (tagLower.equals(tagName.toLowerCase())) return true;                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 310         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="1303119083327749335" onmouseenter="enter('1303119083327749335');" onmouseout="out('1303119083327749335');" style=""> 313     public boolean hasTag(Tag tag) {                                                                     </span>
<span class="-5268388303991583458" onmouseenter="enter('-5268388303991583458');" onmouseout="out('-5268388303991583458');" style=""> 314         return hasTag(tag.getSimperiumKey());                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315     }                                                                                                    </span>
<span  style=""> 316                                                                                                          </span>
<span class="-646587723470162813" onmouseenter="enter('-646587723470162813');" onmouseout="out('-646587723470162813');" style=""> 317     public List&lt;String&gt; getTags() {                                                                      </span>
<span  style=""> 318                                                                                                          </span>
<span class="5046858882238824028" onmouseenter="enter('5046858882238824028');" onmouseout="out('5046858882238824028');" style=""> 319         JSONArray tags = (JSONArray) getProperty(TAGS_PROPERTY);                                         </span>
<span  style=""> 320                                                                                                          </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 321         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 322             tags = new JSONArray();                                                                      </span>
<span class="-8058083631026170990" onmouseenter="enter('-8058083631026170990');" onmouseout="out('-8058083631026170990');" style=""> 323             setProperty(TAGS_PROPERTY, &quot;&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324         }                                                                                                </span>
<span  style=""> 325                                                                                                          </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 326         int length = tags.length();                                                                      </span>
<span  style=""> 327                                                                                                          </span>
<span class="-7737950325994950460" onmouseenter="enter('-7737950325994950460');" onmouseout="out('-7737950325994950460');" style=""> 328         List&lt;String&gt; tagList = new ArrayList&lt;&gt;(length);                                                  </span>
<span  style=""> 329                                                                                                          </span>
<span class="8256074331736484026" onmouseenter="enter('8256074331736484026');" onmouseout="out('8256074331736484026');" style=""> 330         if (length == 0) return tagList;                                                                 </span>
<span  style=""> 331                                                                                                          </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 332         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="-8917993594954591540" onmouseenter="enter('-8917993594954591540');" onmouseout="out('-8917993594954591540');" style=""> 333             String tag = tags.optString(i);                                                              </span>
<span class="-1947204619891178088" onmouseenter="enter('-1947204619891178088');" onmouseout="out('-1947204619891178088');" style=""> 334             if (!tag.equals(&quot;&quot;))                                                                         </span>
<span class="2557583924535716267" onmouseenter="enter('2557583924535716267');" onmouseout="out('2557583924535716267');" style=""> 335                 tagList.add(tag);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336         }                                                                                                </span>
<span  style=""> 337                                                                                                          </span>
<span class="-3183448331203603949" onmouseenter="enter('-3183448331203603949');" onmouseout="out('-3183448331203603949');" style=""> 338         return tagList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339     }                                                                                                    </span>
<span  style=""> 340                                                                                                          </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style=""> 341     public void removeTag(String tagName) {                                                              </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 342         List&lt;String&gt; tags = getTags();                                                                   </span>
<span  style=""> 343                                                                                                          </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style=""> 344         List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style=""> 345         tags.removeAll(tagsMatched);                                                                     </span>
<span  style=""> 346                                                                                                          </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 347         setTags(tags);                                                                                   </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style=""> 348         save();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349     }                                                                                                    </span>
<span  style=""> 350                                                                                                          </span>
<span class="-6026710755135647724" onmouseenter="enter('-6026710755135647724');" onmouseout="out('-6026710755135647724');" style=""> 351     public void setTags(List&lt;String&gt; tags) {                                                             </span>
<span class="-8982714688054322872" onmouseenter="enter('-8982714688054322872');" onmouseout="out('-8982714688054322872');" style=""> 352         setProperty(TAGS_PROPERTY, new JSONArray(tags));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353     }                                                                                                    </span>
<span  style=""> 354                                                                                                          </span>
<span class="-1421161503350598143" onmouseenter="enter('-1421161503350598143');" onmouseout="out('-1421161503350598143');" style=""> 355     public void setTags(JSONArray tags) {                                                                </span>
<span class="-9171468773333999657" onmouseenter="enter('-9171468773333999657');" onmouseout="out('-9171468773333999657');" style=""> 356         setProperty(TAGS_PROPERTY, tags);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 359     /**                                                                                                  </span>
<span class="2568101064766040631" onmouseenter="enter('2568101064766040631');" onmouseout="out('2568101064766040631');" style=""> 360      * String of tags delimited by a space                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 361      */                                                                                                  </span>
<span class="-8942719802141200658" onmouseenter="enter('-8942719802141200658');" onmouseout="out('-8942719802141200658');" style=""> 362     public CharSequence getTagString() {                                                                 </span>
<span class="-4644025499612109112" onmouseenter="enter('-4644025499612109112');" onmouseout="out('-4644025499612109112');" style=""> 363         StringBuilder tagString = new StringBuilder();                                                   </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 364         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-7185531782033852210" onmouseenter="enter('-7185531782033852210');" onmouseout="out('-7185531782033852210');" style=""> 365         for (String tag : tags) {                                                                        </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 366             if (tagString.length() &gt; 0) {                                                                </span>
<span class="-848655472163713161" onmouseenter="enter('-848655472163713161');" onmouseout="out('-848655472163713161');" style=""> 367                 tagString.append(SPACE);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368             }                                                                                            </span>
<span class="3299521276937168474" onmouseenter="enter('3299521276937168474');" onmouseout="out('3299521276937168474');" style=""> 369             tagString.append(tag);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370         }                                                                                                </span>
<span class="-3216397563367246452" onmouseenter="enter('-3216397563367246452');" onmouseout="out('-3216397563367246452');" style=""> 371         return tagString;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372     }                                                                                                    </span>
<span  style=""> 373                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 374     /**                                                                                                  </span>
<span class="516081738825732450" onmouseenter="enter('516081738825732450');" onmouseout="out('516081738825732450');" style=""> 375      * Sets the note&#x27;s tags by providing it with a {@link String} of space separated tags.               </span>
<span class="-3361819639621639487" onmouseenter="enter('-3361819639621639487');" onmouseout="out('-3361819639621639487');" style=""> 376      * Filters out duplicate tags.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 377      *                                                                                                   </span>
<span class="-3621424951438819239" onmouseenter="enter('-3621424951438819239');" onmouseout="out('-3621424951438819239');" style=""> 378      * @param tagString a space delimited list of tags                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 379      */                                                                                                  </span>
<span class="-7562161399809710400" onmouseenter="enter('-7562161399809710400');" onmouseout="out('-7562161399809710400');" style=""> 380     public void setTagString(String tagString) {                                                         </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 381         List&lt;String&gt; tags = getTags();                                                                   </span>
<span class="-8892740331038047380" onmouseenter="enter('-8892740331038047380');" onmouseout="out('-8892740331038047380');" style=""> 382         tags.clear();                                                                                    </span>
<span  style=""> 383                                                                                                          </span>
<span class="7647632027089311583" onmouseenter="enter('7647632027089311583');" onmouseout="out('7647632027089311583');" style=""> 384         if (tagString == null) {                                                                         </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 385             setTags(tags);                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 386             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387         }                                                                                                </span>
<span  style=""> 388                                                                                                          </span>
<span class="-6765712323396427098" onmouseenter="enter('-6765712323396427098');" onmouseout="out('-6765712323396427098');" style=""> 389         // Make sure string has a trailing space                                                         </span>
<span class="3861570924678507302" onmouseenter="enter('3861570924678507302');" onmouseout="out('3861570924678507302');" style=""> 390         if (tagString.length() &gt; 1 &amp;&amp; !tagString.substring(tagString.length() - 1).equals(SPACE))        </span>
<span class="-5113585973277465859" onmouseenter="enter('-5113585973277465859');" onmouseout="out('-5113585973277465859');" style=""> 391             tagString = tagString + SPACE;                                                               </span>
<span class="5741128019150417186" onmouseenter="enter('5741128019150417186');" onmouseout="out('5741128019150417186');" style=""> 392         // for comparing case-insensitive strings, would like to find a way to                           </span>
<span class="-5706726934096139867" onmouseenter="enter('-5706726934096139867');" onmouseout="out('-5706726934096139867');" style=""> 393         // do this without allocating a new list and strings                                             </span>
<span class="5881300344958500433" onmouseenter="enter('5881300344958500433');" onmouseout="out('5881300344958500433');" style=""> 394         List&lt;String&gt; tagsUpperCase = new ArrayList&lt;&gt;();                                                  </span>
<span class="-8087573356169949002" onmouseenter="enter('-8087573356169949002');" onmouseout="out('-8087573356169949002');" style=""> 395         // remove all current tags                                                                       </span>
<span class="1170680636863075190" onmouseenter="enter('1170680636863075190');" onmouseout="out('1170680636863075190');" style=""> 396         int start = 0;                                                                                   </span>
<span class="2514405873256423103" onmouseenter="enter('2514405873256423103');" onmouseout="out('2514405873256423103');" style=""> 397         int next;                                                                                        </span>
<span class="-8708428587370728232" onmouseenter="enter('-8708428587370728232');" onmouseout="out('-8708428587370728232');" style=""> 398         String possible;                                                                                 </span>
<span class="3545966998003531195" onmouseenter="enter('3545966998003531195');" onmouseout="out('3545966998003531195');" style=""> 399         String possibleUpperCase;                                                                        </span>
<span class="-67055061468690966" onmouseenter="enter('-67055061468690966');" onmouseout="out('-67055061468690966');" style=""> 400         // search tag string for space characters and pull out individual tags                           </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 401         do {                                                                                             </span>
<span class="539196990274646798" onmouseenter="enter('539196990274646798');" onmouseout="out('539196990274646798');" style=""> 402             next = tagString.indexOf(SPACE, start);                                                      </span>
<span class="7441993871510338947" onmouseenter="enter('7441993871510338947');" onmouseout="out('7441993871510338947');" style=""> 403             if (next &gt; start) {                                                                          </span>
<span class="-6369978890856333437" onmouseenter="enter('-6369978890856333437');" onmouseout="out('-6369978890856333437');" style=""> 404                 possible = tagString.substring(start, next);                                             </span>
<span class="40967178918958955" onmouseenter="enter('40967178918958955');" onmouseout="out('40967178918958955');" style=""> 405                 possibleUpperCase = possible.toUpperCase();                                              </span>
<span class="-6789588636567169254" onmouseenter="enter('-6789588636567169254');" onmouseout="out('-6789588636567169254');" style=""> 406                 if (!possible.equals(SPACE) &amp;&amp; !tagsUpperCase.contains(possibleUpperCase)) {             </span>
<span class="8107171034948128222" onmouseenter="enter('8107171034948128222');" onmouseout="out('8107171034948128222');" style=""> 407                     tagsUpperCase.add(possibleUpperCase);                                                </span>
<span class="-3623952282264178458" onmouseenter="enter('-3623952282264178458');" onmouseout="out('-3623952282264178458');" style=""> 408                     tags.add(possible);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410             }                                                                                            </span>
<span class="2598261311594212195" onmouseenter="enter('2598261311594212195');" onmouseout="out('2598261311594212195');" style=""> 411             start = next + 1;                                                                            </span>
<span class="-8911857571695172425" onmouseenter="enter('-8911857571695172425');" onmouseout="out('-8911857571695172425');" style=""> 412         } while (next &gt; -1);                                                                             </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 413         setTags(tags);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414     }                                                                                                    </span>
<span  style=""> 415                                                                                                          </span>
<span class="-2380080839978865436" onmouseenter="enter('-2380080839978865436');" onmouseout="out('-2380080839978865436');" style=""> 416     public JSONArray getSystemTags() {                                                                   </span>
<span class="1634689045753216867" onmouseenter="enter('1634689045753216867');" onmouseout="out('1634689045753216867');" style=""> 417         JSONArray tags = (JSONArray) getProperty(SYSTEM_TAGS_PROPERTY);                                  </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 418         if (tags == null) {                                                                              </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 419             tags = new JSONArray();                                                                      </span>
<span class="8109738276011217421" onmouseenter="enter('8109738276011217421');" onmouseout="out('8109738276011217421');" style=""> 420             setProperty(SYSTEM_TAGS_PROPERTY, tags);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421         }                                                                                                </span>
<span class="-7737333077028274174" onmouseenter="enter('-7737333077028274174');" onmouseout="out('-7737333077028274174');" style=""> 422         return tags;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423     }                                                                                                    </span>
<span  style=""> 424                                                                                                          </span>
<span class="3090413247451101219" onmouseenter="enter('3090413247451101219');" onmouseout="out('3090413247451101219');" style=""> 425     public Boolean isDeleted() {                                                                         </span>
<span class="7870299677279363320" onmouseenter="enter('7870299677279363320');" onmouseout="out('7870299677279363320');" style=""> 426         Object deleted = getProperty(DELETED_PROPERTY);                                                  </span>
<span class="3213349019391348934" onmouseenter="enter('3213349019391348934');" onmouseout="out('3213349019391348934');" style=""> 427         if (deleted == null) {                                                                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 428             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429         }                                                                                                </span>
<span class="-8245820290182222148" onmouseenter="enter('-8245820290182222148');" onmouseout="out('-8245820290182222148');" style=""> 430         if (deleted instanceof Boolean) {                                                                </span>
<span class="110137553981332086" onmouseenter="enter('110137553981332086');" onmouseout="out('110137553981332086');" style=""> 431             return (Boolean) deleted;                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 432         } else {                                                                                         </span>
<span class="5495215667694299112" onmouseenter="enter('5495215667694299112');" onmouseout="out('5495215667694299112');" style=""> 433             // Simperium-iOS sets booleans as integer values (0 or 1)                                    </span>
<span class="2375816303299771461" onmouseenter="enter('2375816303299771461');" onmouseout="out('2375816303299771461');" style=""> 434             return deleted instanceof Number &amp;&amp; ((Number) deleted).intValue() != 0;                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436     }                                                                                                    </span>
<span  style=""> 437                                                                                                          </span>
<span class="6912205177980332866" onmouseenter="enter('6912205177980332866');" onmouseout="out('6912205177980332866');" style=""> 438     public void setDeleted(boolean deleted) {                                                            </span>
<span class="-864256626113761460" onmouseenter="enter('-864256626113761460');" onmouseout="out('-864256626113761460');" style=""> 439         setProperty(DELETED_PROPERTY, deleted);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440     }                                                                                                    </span>
<span  style=""> 441                                                                                                          </span>
<span class="5985631777888601261" onmouseenter="enter('5985631777888601261');" onmouseout="out('5985631777888601261');" style=""> 442     public boolean isMarkdownEnabled() {                                                                 </span>
<span class="-5743540823315516839" onmouseenter="enter('-5743540823315516839');" onmouseout="out('-5743540823315516839');" style=""> 443         return hasSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444     }                                                                                                    </span>
<span  style=""> 445                                                                                                          </span>
<span class="-9134361680160631549" onmouseenter="enter('-9134361680160631549');" onmouseout="out('-9134361680160631549');" style=""> 446     public void enableMarkdown() {                                                                       </span>
<span class="-2955264683036225716" onmouseenter="enter('-2955264683036225716');" onmouseout="out('-2955264683036225716');" style=""> 447         setMarkdownEnabled(true);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="-2232443542975324273" onmouseenter="enter('-2232443542975324273');" onmouseout="out('-2232443542975324273');" style=""> 450     public void setMarkdownEnabled(boolean isMarkdownEnabled) {                                          </span>
<span class="5908341161553131781" onmouseenter="enter('5908341161553131781');" onmouseout="out('5908341161553131781');" style=""> 451         if (isMarkdownEnabled) {                                                                         </span>
<span class="-7185185989369936008" onmouseenter="enter('-7185185989369936008');" onmouseout="out('-7185185989369936008');" style=""> 452             addSystemTag(MARKDOWN_TAG);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 453         } else {                                                                                         </span>
<span class="1430034125671484052" onmouseenter="enter('1430034125671484052');" onmouseout="out('1430034125671484052');" style=""> 454             removeSystemTag(MARKDOWN_TAG);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456     }                                                                                                    </span>
<span  style=""> 457                                                                                                          </span>
<span class="-7992821206137485678" onmouseenter="enter('-7992821206137485678');" onmouseout="out('-7992821206137485678');" style=""> 458     public boolean isPinned() {                                                                          </span>
<span class="7436893036029851482" onmouseenter="enter('7436893036029851482');" onmouseout="out('7436893036029851482');" style=""> 459         return hasSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460     }                                                                                                    </span>
<span  style=""> 461                                                                                                          </span>
<span class="7137874092814138484" onmouseenter="enter('7137874092814138484');" onmouseout="out('7137874092814138484');" style=""> 462     public void setPinned(boolean isPinned) {                                                            </span>
<span class="-8977010770732050857" onmouseenter="enter('-8977010770732050857');" onmouseout="out('-8977010770732050857');" style=""> 463         if (isPinned) {                                                                                  </span>
<span class="-705489752486798560" onmouseenter="enter('-705489752486798560');" onmouseout="out('-705489752486798560');" style=""> 464             addSystemTag(PINNED_TAG);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 465         } else {                                                                                         </span>
<span class="5010790157822780054" onmouseenter="enter('5010790157822780054');" onmouseout="out('5010790157822780054');" style=""> 466             removeSystemTag(PINNED_TAG);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="3778345749504952755" onmouseenter="enter('3778345749504952755');" onmouseout="out('3778345749504952755');" style=""> 470     public boolean isPreviewEnabled() {                                                                  </span>
<span class="-6537187368585435683" onmouseenter="enter('-6537187368585435683');" onmouseout="out('-6537187368585435683');" style=""> 471         return hasSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span  style=""> 473                                                                                                          </span>
<span class="-3198839301731339686" onmouseenter="enter('-3198839301731339686');" onmouseout="out('-3198839301731339686');" style=""> 474     public void setPreviewEnabled(boolean isPreviewEnabled) {                                            </span>
<span class="-4540372431458214170" onmouseenter="enter('-4540372431458214170');" onmouseout="out('-4540372431458214170');" style=""> 475         if (isPreviewEnabled) {                                                                          </span>
<span class="1609739104508733891" onmouseenter="enter('1609739104508733891');" onmouseout="out('1609739104508733891');" style=""> 476             addSystemTag(PREVIEW_TAG);                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 477         } else {                                                                                         </span>
<span class="1340191486118728833" onmouseenter="enter('1340191486118728833');" onmouseout="out('1340191486118728833');" style=""> 478             removeSystemTag(PREVIEW_TAG);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 479         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="5049304787018344959" onmouseenter="enter('5049304787018344959');" onmouseout="out('5049304787018344959');" style=""> 482     public boolean isPublished() {                                                                       </span>
<span class="-3313218062555121548" onmouseenter="enter('-3313218062555121548');" onmouseout="out('-3313218062555121548');" style=""> 483         return hasSystemTag(PUBLISHED_TAG) &amp;&amp; !TextUtils.isEmpty(getPublishedUrl());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span class="-1996001930026199474" onmouseenter="enter('-1996001930026199474');" onmouseout="out('-1996001930026199474');" style=""> 486     public void setPublished(boolean isPublished) {                                                      </span>
<span class="-214835194616400293" onmouseenter="enter('-214835194616400293');" onmouseout="out('-214835194616400293');" style=""> 487         if (isPublished) {                                                                               </span>
<span class="6614236660148008937" onmouseenter="enter('6614236660148008937');" onmouseout="out('6614236660148008937');" style=""> 488             addSystemTag(PUBLISHED_TAG);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 489         } else {                                                                                         </span>
<span class="-3125520029372940316" onmouseenter="enter('-3125520029372940316');" onmouseout="out('-3125520029372940316');" style=""> 490             removeSystemTag(PUBLISHED_TAG);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style=""> 494     public void removeTag(String tagName) {                                                              </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 495         List&lt;String&gt; tags = getTags();                                                                   </span>
<span  style=""> 496                                                                                                          </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style=""> 497         List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style=""> 498         tags.removeAll(tagsMatched);                                                                     </span>
<span  style=""> 499                                                                                                          </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 500         setTags(tags);                                                                                   </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style=""> 501         save();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502     }                                                                                                    </span>
<span  style=""> 503                                                                                                          </span>
<span class="8481041411290642641" onmouseenter="enter('8481041411290642641');" onmouseout="out('8481041411290642641');" style=""> 504     private boolean hasSystemTag(String tag) {                                                           </span>
<span class="-1472869558903340894" onmouseenter="enter('-1472869558903340894');" onmouseout="out('-1472869558903340894');" style=""> 505         if (TextUtils.isEmpty(tag))                                                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 506             return false;                                                                                </span>
<span  style=""> 507                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 508         JSONArray tags = getSystemTags();                                                                </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 509         int length = tags.length();                                                                      </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 510         for (int i = 0; i &lt; length; i++) {                                                               </span>
<span class="1029161545303231138" onmouseenter="enter('1029161545303231138');" onmouseout="out('1029161545303231138');" style=""> 511             if (tags.optString(i).equals(tag)) {                                                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 512                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514         }                                                                                                </span>
<span  style=""> 515                                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 516         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517     }                                                                                                    </span>
<span  style=""> 518                                                                                                          </span>
<span class="-1886965851517885412" onmouseenter="enter('-1886965851517885412');" onmouseout="out('-1886965851517885412');" style=""> 519     private void addSystemTag(String tag) {                                                              </span>
<span class="-7266652503291305395" onmouseenter="enter('-7266652503291305395');" onmouseout="out('-7266652503291305395');" style=""> 520         if (TextUtils.isEmpty(tag)) {                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 521             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522         }                                                                                                </span>
<span  style=""> 523                                                                                                          </span>
<span class="4034934261619610009" onmouseenter="enter('4034934261619610009');" onmouseout="out('4034934261619610009');" style=""> 524         // Ensure we don&#x27;t add the same tag again                                                        </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 525         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="-2655750625237705417" onmouseenter="enter('-2655750625237705417');" onmouseout="out('-2655750625237705417');" style=""> 526             getSystemTags().put(tag);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528     }                                                                                                    </span>
<span  style=""> 529                                                                                                          </span>
<span class="-6272346588769055483" onmouseenter="enter('-6272346588769055483');" onmouseout="out('-6272346588769055483');" style=""> 530     private void removeSystemTag(String tag) {                                                           </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 531         if (!hasSystemTag(tag)) {                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 532             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533         }                                                                                                </span>
<span  style=""> 534                                                                                                          </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 535         JSONArray tags = getSystemTags();                                                                </span>
<span class="6472000112597211426" onmouseenter="enter('6472000112597211426');" onmouseout="out('6472000112597211426');" style=""> 536         JSONArray newTags = new JSONArray();                                                             </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 537         int length = tags.length();                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 538         try {                                                                                            </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 539             for (int i = 0; i &lt; length; i++) {                                                           </span>
<span class="5751642819386913624" onmouseenter="enter('5751642819386913624');" onmouseout="out('5751642819386913624');" style=""> 540                 Object val = tags.get(i);                                                                </span>
<span class="7076458285668173093" onmouseenter="enter('7076458285668173093');" onmouseout="out('7076458285668173093');" style=""> 541                 if (!val.equals(tag))                                                                    </span>
<span class="-6329059091210941964" onmouseenter="enter('-6329059091210941964');" onmouseout="out('-6329059091210941964');" style=""> 542                     newTags.put(val);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543             }                                                                                            </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 544         } catch (JSONException e) {                                                                      </span>
<span class="4377813279323840039" onmouseenter="enter('4377813279323840039');" onmouseout="out('4377813279323840039');" style=""> 545             // could not update pinned setting                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546         }                                                                                                </span>
<span  style=""> 547                                                                                                          </span>
<span class="8301502673130902229" onmouseenter="enter('8301502673130902229');" onmouseout="out('8301502673130902229');" style=""> 548         setProperty(SYSTEM_TAGS_PROPERTY, newTags);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549     }                                                                                                    </span>
<span  style=""> 550                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 551     /**                                                                                                  </span>
<span class="-397105642920094918" onmouseenter="enter('-397105642920094918');" onmouseout="out('-397105642920094918');" style=""> 552      * Check if the note has any changes                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 553      *                                                                                                   </span>
<span class="6656400016423195192" onmouseenter="enter('6656400016423195192');" onmouseout="out('6656400016423195192');" style=""> 554      * @param content           the new note content                                                     </span>
<span class="698428434066591100" onmouseenter="enter('698428434066591100');" onmouseout="out('698428434066591100');" style=""> 555      * @param tagString         space separated tags                                                     </span>
<span class="-6143007710262330196" onmouseenter="enter('-6143007710262330196');" onmouseout="out('-6143007710262330196');" style=""> 556      * @param isPinned          note is pinned                                                           </span>
<span class="-1154760621356330740" onmouseenter="enter('-1154760621356330740');" onmouseout="out('-1154760621356330740');" style=""> 557      * @param isMarkdownEnabled note has markdown enabled                                                </span>
<span class="-2689180860643219460" onmouseenter="enter('-2689180860643219460');" onmouseout="out('-2689180860643219460');" style=""> 558      * @param isPreviewEnabled  note has preview enabled                                                 </span>
<span class="2808295610973044096" onmouseenter="enter('2808295610973044096');" onmouseout="out('2808295610973044096');" style=""> 559      * @return true if note has changes, false if it is unchanged.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 560      */                                                                                                  </span>
<span class="2249306723652890422" onmouseenter="enter('2249306723652890422');" onmouseout="out('2249306723652890422');" style=""><abbr title=" 561     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boolean isPreviewEnabled) {"> 561     public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabl🔵</abbr></span>
<span class="-8752168499945681469" onmouseenter="enter('-8752168499945681469');" onmouseout="out('-8752168499945681469');" style=""> 562         return !content.equals(this.getContent())                                                        </span>
<span class="361029725350182512" onmouseenter="enter('361029725350182512');" onmouseout="out('361029725350182512');" style=""> 563                 || !tagString.equals(this.getTagString().toString())                                     </span>
<span class="-3256796514842471479" onmouseenter="enter('-3256796514842471479');" onmouseout="out('-3256796514842471479');" style=""> 564                 || this.isPinned() != isPinned                                                           </span>
<span class="3248054844136733713" onmouseenter="enter('3248054844136733713');" onmouseout="out('3248054844136733713');" style=""> 565                 || this.isMarkdownEnabled() != isMarkdownEnabled                                         </span>
<span class="7822456953056210787" onmouseenter="enter('7822456953056210787');" onmouseout="out('7822456953056210787');" style=""> 566                 || this.isPreviewEnabled() != isPreviewEnabled;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="-7717881480664684723" onmouseenter="enter('-7717881480664684723');" onmouseout="out('-7717881480664684723');" style=""> 569     public static class Schema extends BucketSchema&lt;Note&gt; {                                              </span>
<span  style=""> 570                                                                                                          </span>
<span class="-3235753444162186767" onmouseenter="enter('-3235753444162186767');" onmouseout="out('-3235753444162186767');" style=""> 571         protected static NoteIndexer sNoteIndexer = new NoteIndexer();                                   </span>
<span class="-8196684505127442187" onmouseenter="enter('-8196684505127442187');" onmouseout="out('-8196684505127442187');" style=""> 572         protected static NoteFullTextIndexer sFullTextIndexer = new NoteFullTextIndexer();               </span>
<span  style=""> 573                                                                                                          </span>
<span class="-75865115147660663" onmouseenter="enter('-75865115147660663');" onmouseout="out('-75865115147660663');" style=""> 574         public Schema() {                                                                                </span>
<span class="-4886495676536647522" onmouseenter="enter('-4886495676536647522');" onmouseout="out('-4886495676536647522');" style=""> 575             autoIndex();                                                                                 </span>
<span class="-6825633182165860223" onmouseenter="enter('-6825633182165860223');" onmouseout="out('-6825633182165860223');" style=""> 576             addIndex(sNoteIndexer);                                                                      </span>
<span class="-3392547141042614111" onmouseenter="enter('-3392547141042614111');" onmouseout="out('-3392547141042614111');" style=""> 577             setupFullTextIndex(sFullTextIndexer, NoteFullTextIndexer.INDEXES);                           </span>
<span class="-6401895186782523877" onmouseenter="enter('-6401895186782523877');" onmouseout="out('-6401895186782523877');" style=""> 578             setDefault(CONTENT_PROPERTY, &quot;&quot;);                                                            </span>
<span class="-2554467534039091654" onmouseenter="enter('-2554467534039091654');" onmouseout="out('-2554467534039091654');" style=""> 579             setDefault(SYSTEM_TAGS_PROPERTY, new JSONArray());                                           </span>
<span class="228359577715990029" onmouseenter="enter('228359577715990029');" onmouseout="out('228359577715990029');" style=""> 580             setDefault(TAGS_PROPERTY, new JSONArray());                                                  </span>
<span class="-819869596778271798" onmouseenter="enter('-819869596778271798');" onmouseout="out('-819869596778271798');" style=""> 581             setDefault(DELETED_PROPERTY, false);                                                         </span>
<span class="-8278335164591762572" onmouseenter="enter('-8278335164591762572');" onmouseout="out('-8278335164591762572');" style=""> 582             setDefault(SHARE_URL_PROPERTY, &quot;&quot;);                                                          </span>
<span class="4718032932676673460" onmouseenter="enter('4718032932676673460');" onmouseout="out('4718032932676673460');" style=""> 583             setDefault(PUBLISH_URL_PROPERTY, &quot;&quot;);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 584         }                                                                                                </span>
<span  style=""> 585                                                                                                          </span>
<span class="1438294404599077665" onmouseenter="enter('1438294404599077665');" onmouseout="out('1438294404599077665');" style=""> 586         public String getRemoteName() {                                                                  </span>
<span class="-8943072285760215512" onmouseenter="enter('-8943072285760215512');" onmouseout="out('-8943072285760215512');" style=""> 587             return Note.BUCKET_NAME;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 588         }                                                                                                </span>
<span  style=""> 589                                                                                                          </span>
<span class="-4946235729406468677" onmouseenter="enter('-4946235729406468677');" onmouseout="out('-4946235729406468677');" style=""> 590         public Note build(String key, JSONObject properties) {                                           </span>
<span class="-2808542273143064496" onmouseenter="enter('-2808542273143064496');" onmouseout="out('-2808542273143064496');" style=""> 591             return new Note(key, properties);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 592         }                                                                                                </span>
<span  style=""> 593                                                                                                          </span>
<span class="2318790323390762687" onmouseenter="enter('2318790323390762687');" onmouseout="out('2318790323390762687');" style=""> 594         public void update(Note note, JSONObject properties) {                                           </span>
<span class="-3717338000153341316" onmouseenter="enter('-3717338000153341316');" onmouseout="out('-3717338000153341316');" style=""> 595             note.setProperties(properties);                                                              </span>
<span class="-731284339738821488" onmouseenter="enter('-731284339738821488');" onmouseout="out('-731284339738821488');" style=""> 596             note.mTitle = null;                                                                          </span>
<span class="6645980171711348815" onmouseenter="enter('6645980171711348815');" onmouseout="out('6645980171711348815');" style=""> 597             note.mContentPreview = null;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600 }                                                                                                        </span>







</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="9181943406056492869" onmouseenter="enter('9181943406056492869');" onmouseout="out('9181943406056492869');" style="">   1  package com.automattic.simplenote.models;                                                                         </span>
<span  style="">   2                                                                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3  import android.content.Context;                                                                                   </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   4  import android.text.TextUtils;                                                                                    </span>
<span  style="">   5                                                                                                                    </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   6  import androidx.annotation.NonNull;                                                                               </span>
<span  style="">   7                                                                                                                    </span>
<span class="-6092371777820512633" onmouseenter="enter('-6092371777820512633');" onmouseout="out('-6092371777820512633');" style="">   8  import com.automattic.simplenote.R;                                                                               </span>
<span class="1225693603979668275" onmouseenter="enter('1225693603979668275');" onmouseout="out('1225693603979668275');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 +import com.automattic.simplenote.utils.DateTimeUtils;                                                             </span>
<span class="-643769428942460504" onmouseenter="enter('-643769428942460504');" onmouseout="out('-643769428942460504');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  10 +import com.automattic.simplenote.utils.TagUtils;                                                                  </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  11  import com.simperium.client.Bucket;                                                                               </span>
<span class="6125639164043971044" onmouseenter="enter('6125639164043971044');" onmouseout="out('6125639164043971044');" style="">  12  import com.simperium.client.BucketObject;                                                                         </span>
<span class="-665307165473523580" onmouseenter="enter('-665307165473523580');" onmouseout="out('-665307165473523580');" style="">  13  import com.simperium.client.BucketSchema;                                                                         </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  14  import com.simperium.client.Query;                                                                                </span>
<span class="-838252138947964043" onmouseenter="enter('-838252138947964043');" onmouseout="out('-838252138947964043');" style="">  15  import com.simperium.client.Query.ComparisonType;                                                                 </span>
<span class="708242169313900219" onmouseenter="enter('708242169313900219');" onmouseout="out('708242169313900219');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 +import com.simperium.util.Uuid;                                                                                   </span>
<span  style="">  17                                                                                                                    </span>
<span class="-9193129351684262878" onmouseenter="enter('-9193129351684262878');" onmouseout="out('-9193129351684262878');" style="">  18  import org.json.JSONArray;                                                                                        </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  19  import org.json.JSONException;                                                                                    </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  20  import org.json.JSONObject;                                                                                       </span>
<span  style="">  21                                                                                                                    </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  22  import java.math.BigDecimal;                                                                                      </span>
<span class="1238662365364477381" onmouseenter="enter('1238662365364477381');" onmouseout="out('1238662365364477381');" style="">  23  import java.text.DateFormat;                                                                                      </span>
<span class="39790854174282861" onmouseenter="enter('39790854174282861');" onmouseout="out('39790854174282861');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import java.text.ParseException;                                                                                  </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  25  import java.text.SimpleDateFormat;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  26  import java.util.ArrayList;                                                                                       </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  27  import java.util.Calendar;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  28  import java.util.List;                                                                                            </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  29  import java.util.Locale;                                                                                          </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  30  import java.util.TimeZone;                                                                                        </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  31  import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  32  import java.util.regex.Pattern;                                                                                   </span>
<span  style="">  33                                                                                                                    </span>
<span class="-4405840676582391526" onmouseenter="enter('-4405840676582391526');" onmouseout="out('-4405840676582391526');" style="">  34  import static com.automattic.simplenote.utils.SimplenoteLinkify.SIMPLENOTE_LINK_PREFIX;                           </span>
<span  style="">  35                                                                                                                    </span>
<span class="1630911635596164534" onmouseenter="enter('1630911635596164534');" onmouseout="out('1630911635596164534');" style="">  36  public class Note extends BucketObject {                                                                          </span>
<span  style="">  37                                                                                                                    </span>
<span class="308952937305736491" onmouseenter="enter('308952937305736491');" onmouseout="out('308952937305736491');" style="">  38      public static final String BUCKET_NAME = &quot;note&quot;;                                                              </span>
<span class="6014442145961064017" onmouseenter="enter('6014442145961064017');" onmouseout="out('6014442145961064017');" style="">  39      public static final String MARKDOWN_TAG = &quot;markdown&quot;;                                                         </span>
<span class="-8101559688416496628" onmouseenter="enter('-8101559688416496628');" onmouseout="out('-8101559688416496628');" style="">  40      public static final String PINNED_TAG = &quot;pinned&quot;;                                                             </span>
<span class="2755303258201669627" onmouseenter="enter('2755303258201669627');" onmouseout="out('2755303258201669627');" style="">  41      public static final String PREVIEW_TAG = &quot;preview&quot;;                                                           </span>
<span class="1168195147039968761" onmouseenter="enter('1168195147039968761');" onmouseout="out('1168195147039968761');" style="">  42      public static final String PUBLISHED_TAG = &quot;published&quot;;                                                       </span>
<span class="6384737125939709481" onmouseenter="enter('6384737125939709481');" onmouseout="out('6384737125939709481');" style="">  43      public static final String NEW_LINE = &quot;\n&quot;;                                                                   </span>
<span class="-6709867799447959845" onmouseenter="enter('-6709867799447959845');" onmouseout="out('-6709867799447959845');" style="">  44      public static final String CONTENT_PROPERTY = &quot;content&quot;;                                                      </span>
<span class="-7150784166370340219" onmouseenter="enter('-7150784166370340219');" onmouseout="out('-7150784166370340219');" style="">  45      public static final String KEY_PROPERTY = &quot;key&quot;;                                                              </span>
<span class="-2027165692804872527" onmouseenter="enter('-2027165692804872527');" onmouseout="out('-2027165692804872527');" style="">  46      public static final String TAGS_PROPERTY = &quot;tags&quot;;                                                            </span>
<span class="-2782765636412056512" onmouseenter="enter('-2782765636412056512');" onmouseout="out('-2782765636412056512');" style="">  47      public static final String SYSTEM_TAGS_PROPERTY = &quot;systemTags&quot;;                                               </span>
<span class="8082059840675302216" onmouseenter="enter('8082059840675302216');" onmouseout="out('8082059840675302216');" style="">  48      public static final String CREATION_DATE_PROPERTY = &quot;creationDate&quot;;                                           </span>
<span class="-4622628390272251051" onmouseenter="enter('-4622628390272251051');" onmouseout="out('-4622628390272251051');" style="">  49      public static final String MODIFICATION_DATE_PROPERTY = &quot;modificationDate&quot;;                                   </span>
<span class="-2614611438740057503" onmouseenter="enter('-2614611438740057503');" onmouseout="out('-2614611438740057503');" style="">  50      public static final String SHARE_URL_PROPERTY = &quot;shareURL&quot;;                                                   </span>
<span class="1336476452932138514" onmouseenter="enter('1336476452932138514');" onmouseout="out('1336476452932138514');" style="">  51      public static final String PUBLISH_URL_PROPERTY = &quot;publishURL&quot;;                                               </span>
<span class="-813041889408259553" onmouseenter="enter('-813041889408259553');" onmouseout="out('-813041889408259553');" style="">  52      public static final String DELETED_PROPERTY = &quot;deleted&quot;;                                                      </span>
<span class="4804610397042036134" onmouseenter="enter('4804610397042036134');" onmouseout="out('4804610397042036134');" style="">  53      public static final String TITLE_INDEX_NAME = &quot;title&quot;;                                                        </span>
<span class="941632753921114575" onmouseenter="enter('941632753921114575');" onmouseout="out('941632753921114575');" style="">  54      public static final String CONTENT_PREVIEW_INDEX_NAME = &quot;contentPreview&quot;;                                     </span>
<span class="4601116861733775409" onmouseenter="enter('4601116861733775409');" onmouseout="out('4601116861733775409');" style="">  55      public static final String PINNED_INDEX_NAME = &quot;pinned&quot;;                                                      </span>
<span class="-5028217336186587547" onmouseenter="enter('-5028217336186587547');" onmouseout="out('-5028217336186587547');" style="">  56      public static final String MODIFIED_INDEX_NAME = &quot;modified&quot;;                                                  </span>
<span class="-2754009865833796434" onmouseenter="enter('-2754009865833796434');" onmouseout="out('-2754009865833796434');" style="">  57      public static final String CREATED_INDEX_NAME = &quot;created&quot;;                                                    </span>
<span class="-620094810998015131" onmouseenter="enter('-620094810998015131');" onmouseout="out('-620094810998015131');" style="">  58      public static final String MATCHED_TITLE_INDEX_NAME = &quot;matchedTitle&quot;;                                         </span>
<span class="5961311022296185233" onmouseenter="enter('5961311022296185233');" onmouseout="out('5961311022296185233');" style="">  59      public static final String MATCHED_CONTENT_INDEX_NAME = &quot;matchedContent&quot;;                                     </span>
<span class="354077366863542774" onmouseenter="enter('354077366863542774');" onmouseout="out('354077366863542774');" style="">  60      public static final String PUBLISH_URL = &quot;http://simp.ly/p/&quot;;                                                 </span>
<span class="2475488422216258991" onmouseenter="enter('2475488422216258991');" onmouseout="out('2475488422216258991');" style="">  61      static public final String[] FULL_TEXT_INDEXES = new String[]{                                                </span>
<span class="394877313876947494" onmouseenter="enter('394877313876947494');" onmouseout="out('394877313876947494');" style="">  62              Note.TITLE_INDEX_NAME, Note.CONTENT_PROPERTY};                                                        </span>
<span class="-4178348678314657322" onmouseenter="enter('-4178348678314657322');" onmouseout="out('-4178348678314657322');" style="">  63      private static final String BLANK_CONTENT = &quot;&quot;;                                                               </span>
<span class="-8217848203306725764" onmouseenter="enter('-8217848203306725764');" onmouseout="out('-8217848203306725764');" style="">  64      private static final String SPACE = &quot; &quot;;                                                                      </span>
<span class="7999038666256371202" onmouseenter="enter('7999038666256371202');" onmouseout="out('7999038666256371202');" style="">  65      private static final int MAX_PREVIEW_CHARS = 300;                                                             </span>
<span class="6617027899127222559" onmouseenter="enter('6617027899127222559');" onmouseout="out('6617027899127222559');" style="">  66      protected String mTitle = null;                                                                               </span>
<span class="-1758175371106332326" onmouseenter="enter('-1758175371106332326');" onmouseout="out('-1758175371106332326');" style="">  67      protected String mContentPreview = null;                                                                      </span>
<span  style="">  68                                                                                                                    </span>
<span class="-1397623179598998233" onmouseenter="enter('-1397623179598998233');" onmouseout="out('-1397623179598998233');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +    public Note() {                                                                                               </span>
<span class="-1154746796976603421" onmouseenter="enter('-1154746796976603421');" onmouseout="out('-1154746796976603421');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +        this(Uuid.uuid());                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +    }                                                                                                             </span>
<span  style="">  72                                                                                                                    </span>
<span class="767263449852825375" onmouseenter="enter('767263449852825375');" onmouseout="out('767263449852825375');" style="">  73      public Note(String key) {                                                                                     </span>
<span class="-8964647538928034033" onmouseenter="enter('-8964647538928034033');" onmouseout="out('-8964647538928034033');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -        super(key, new JSONObject());                                                                             </span>
<span class="53769298429916076" onmouseenter="enter('53769298429916076');" onmouseout="out('53769298429916076');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +        this(key, new JSONObject());                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="8617384997772879313" onmouseenter="enter('8617384997772879313');" onmouseout="out('8617384997772879313');" style="">  78      public Note(String key, JSONObject properties) {                                                              </span>
<span class="-6821486208075908487" onmouseenter="enter('-6821486208075908487');" onmouseout="out('-6821486208075908487');" style="">  79          super(key, properties);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80      }                                                                                                             </span>
<span  style="">  81                                                                                                                    </span>
<span class="458900878223274025" onmouseenter="enter('458900878223274025');" onmouseout="out('458900878223274025');" style="">  82      public static Query&lt;Note&gt; all(Bucket&lt;Note&gt; noteBucket) {                                                      </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  83          return noteBucket.query()                                                                                 </span>
<span class="-6142536283945774731" onmouseenter="enter('-6142536283945774731');" onmouseout="out('-6142536283945774731');" style="">  84                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85      }                                                                                                             </span>
<span  style="">  86                                                                                                                    </span>
<span class="-6525045200709488349" onmouseenter="enter('-6525045200709488349');" onmouseout="out('-6525045200709488349');" style="">  87      public static Query&lt;Note&gt; allDeleted(Bucket&lt;Note&gt; noteBucket) {                                               </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  88          return noteBucket.query()                                                                                 </span>
<span class="-6326653849445488397" onmouseenter="enter('-6326653849445488397');" onmouseout="out('-6326653849445488397');" style="">  89                  .where(DELETED_PROPERTY, ComparisonType.EQUAL_TO, true);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="4789545620535823187" onmouseenter="enter('4789545620535823187');" onmouseout="out('4789545620535823187');" style="">  92      public static Query&lt;Note&gt; search(Bucket&lt;Note&gt; noteBucket, String searchString) {                              </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  93          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  94                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="-8956541673379552524" onmouseenter="enter('-8956541673379552524');" onmouseout="out('-8956541673379552524');" style="">  95                  .where(CONTENT_PROPERTY, ComparisonType.LIKE, &quot;%&quot; + searchString + &quot;%&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="-1229245405128052241" onmouseenter="enter('-1229245405128052241');" onmouseout="out('-1229245405128052241');" style="">  98      public static Query&lt;Note&gt; allInTag(Bucket&lt;Note&gt; noteBucket, String tag) {                                     </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  99          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 100                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="-2207133284802963072" onmouseenter="enter('-2207133284802963072');" onmouseout="out('-2207133284802963072');" style=""> 101                  .where(TAGS_PROPERTY, ComparisonType.LIKE, tag);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102      }                                                                                                             </span>
<span  style=""> 103                                                                                                                    </span>
<span class="2971412545726517521" onmouseenter="enter('2971412545726517521');" onmouseout="out('2971412545726517521');" style=""> 104      public static Query&lt;Note&gt; allWithNoTag(Bucket&lt;Note&gt; noteBucket) {                                             </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style=""> 105          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style=""> 106                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="6567927526378864260" onmouseenter="enter('6567927526378864260');" onmouseout="out('6567927526378864260');" style=""> 107                  .where(TAGS_PROPERTY, ComparisonType.EQUAL_TO, null);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +                                                                                                                  </span>
<span class="-8938802169787860370" onmouseenter="enter('-8938802169787860370');" onmouseout="out('-8938802169787860370');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +    public static Note fromContent(Bucket&lt;Note&gt; notesBucket, String content) {                                    </span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +        Note note = notesBucket.newObject();                                                                      </span>
<span class="8912392529601079939" onmouseenter="enter('8912392529601079939');" onmouseout="out('8912392529601079939');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +        note.setContent(content);                                                                                 </span>
<span class="1465773082586789630" onmouseenter="enter('1465773082586789630');" onmouseout="out('1465773082586789630');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +        note.setCreationDate(Calendar.getInstance());                                                             </span>
<span class="-2721490489979887121" onmouseenter="enter('-2721490489979887121');" onmouseout="out('-2721490489979887121');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +        note.setModificationDate(note.getCreationDate());                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +                                                                                                                  </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +        return note;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                                                                                                                  </span>
<span class="-5396846739988471840" onmouseenter="enter('-5396846739988471840');" onmouseout="out('-5396846739988471840');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 119 +    public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONException, ParseException {"> 119 +    public static Note fromExportedJson(Bucket&lt;Note&gt; notesBucket, JSONObject noteJson) throws JSONException, Parse🔵</abbr></span>
<span class="-291933899080701850" onmouseenter="enter('-291933899080701850');" onmouseout="out('-291933899080701850');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +        Note note = notesBucket.newObject();                                                                      </span>
<span class="3098500428867040128" onmouseenter="enter('3098500428867040128');" onmouseout="out('3098500428867040128');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +        note.setContent(noteJson.optString(&quot;content&quot;, &quot;&quot;));                                                       </span>
<span class="-8154332140304970847" onmouseenter="enter('-8154332140304970847');" onmouseout="out('-8154332140304970847');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 122 +        note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;creationDate&quot;)) : Calendar.getInstance());"> 122 +        note.setCreationDate(noteJson.has(&quot;creationDate&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;crea🔵</abbr></span>
<span class="-8572711449683887689" onmouseenter="enter('-8572711449683887689');" onmouseout="out('-8572711449683887689');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 123 +        note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;lastModified&quot;)) : Calendar.getInstance());"> 123 +        note.setModificationDate(noteJson.has(&quot;lastModified&quot;) ? DateTimeUtils.getDateCalendar(noteJson.getString(&quot;🔵</abbr></span>
<span class="-5498600081013067663" onmouseenter="enter('-5498600081013067663');" onmouseout="out('-5498600081013067663');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +        note.setTags(noteJson.has(&quot;tags&quot;) ? noteJson.getJSONArray(&quot;tags&quot;) : new JSONArray());                     </span>
<span class="875604650523146036" onmouseenter="enter('875604650523146036');" onmouseout="out('875604650523146036');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        note.setPinned(noteJson.optBoolean(&quot;pinned&quot;, false));                                                     </span>
<span class="1705691732106409520" onmouseenter="enter('1705691732106409520');" onmouseout="out('1705691732106409520');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +        note.setMarkdownEnabled(noteJson.optBoolean(&quot;markdown&quot;, false));                                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +                                                                                                                  </span>
<span class="925626910960947041" onmouseenter="enter('925626910960947041');" onmouseout="out('925626910960947041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +        return note;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="-5517811679430868458" onmouseenter="enter('-5517811679430868458');" onmouseout="out('-5517811679430868458');" style=""> 131      @SuppressWarnings(&quot;unused&quot;)                                                                                   </span>
<span class="-4700657283235731904" onmouseenter="enter('-4700657283235731904');" onmouseout="out('-4700657283235731904');" style=""> 132      public static String dateString(Number time, boolean useShortFormat, Context context) {                       </span>
<span class="1180405838137731219" onmouseenter="enter('1180405838137731219');" onmouseout="out('1180405838137731219');" style=""> 133          Calendar c = numberToDate(time);                                                                          </span>
<span class="-7277187246954612403" onmouseenter="enter('-7277187246954612403');" onmouseout="out('-7277187246954612403');" style=""> 134          return dateString(c, useShortFormat, context);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135      }                                                                                                             </span>
<span  style=""> 136                                                                                                                    </span>
<span class="-8567197073889182513" onmouseenter="enter('-8567197073889182513');" onmouseout="out('-8567197073889182513');" style=""> 137      public static String dateString(Calendar c, boolean useShortFormat, Context context) {                        </span>
<span class="-4601601397388656558" onmouseenter="enter('-4601601397388656558');" onmouseout="out('-4601601397388656558');" style=""> 138          int year, month, day;                                                                                     </span>
<span  style=""> 139                                                                                                                    </span>
<span class="-7517224838183820978" onmouseenter="enter('-7517224838183820978');" onmouseout="out('-7517224838183820978');" style=""> 140          String time, date, retVal;                                                                                </span>
<span  style=""> 141                                                                                                                    </span>
<span class="-7023974272217551721" onmouseenter="enter('-7023974272217551721');" onmouseout="out('-7023974272217551721');" style=""> 142          Calendar diff = Calendar.getInstance();                                                                   </span>
<span class="7346751312817051138" onmouseenter="enter('7346751312817051138');" onmouseout="out('7346751312817051138');" style=""> 143          diff.setTimeInMillis(diff.getTimeInMillis() - c.getTimeInMillis());                                       </span>
<span  style=""> 144                                                                                                                    </span>
<span class="-2909064038838300707" onmouseenter="enter('-2909064038838300707');" onmouseout="out('-2909064038838300707');" style=""> 145          year = diff.get(Calendar.YEAR);                                                                           </span>
<span class="-5868815277479911950" onmouseenter="enter('-5868815277479911950');" onmouseout="out('-5868815277479911950');" style=""> 146          month = diff.get(Calendar.MONTH);                                                                         </span>
<span class="-2637536938238774465" onmouseenter="enter('-2637536938238774465');" onmouseout="out('-2637536938238774465');" style=""> 147          day = diff.get(Calendar.DAY_OF_MONTH);                                                                    </span>
<span  style=""> 148                                                                                                                    </span>
<span class="1536424719044438994" onmouseenter="enter('1536424719044438994');" onmouseout="out('1536424719044438994');" style=""> 149          diff.setTimeInMillis(0); // starting time                                                                 </span>
<span class="-779753610725741249" onmouseenter="enter('-779753610725741249');" onmouseout="out('-779753610725741249');" style=""> 150          time = DateFormat.getTimeInstance(DateFormat.SHORT).format(c.getTime());                                  </span>
<span class="-2383141111479093557" onmouseenter="enter('-2383141111479093557');" onmouseout="out('-2383141111479093557');" style=""><abbr title=" 151          if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.DAY_OF_MONTH))) {"> 151          if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.🔵</abbr></span>
<span class="7635099361720652074" onmouseenter="enter('7635099361720652074');" onmouseout="out('7635099361720652074');" style=""> 152              date = context.getResources().getString(R.string.today);                                              </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 153              if (useShortFormat)                                                                                   </span>
<span class="597955899566079772" onmouseenter="enter('597955899566079772');" onmouseout="out('597955899566079772');" style=""> 154                  retVal = time;                                                                                    </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 155              else                                                                                                  </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 156                  retVal = date + &quot;, &quot; + time;                                                                      </span>
<span class="-818230175523660822" onmouseenter="enter('-818230175523660822');" onmouseout="out('-818230175523660822');" style=""> 157          } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)) {      </span>
<span class="-8420997342841621789" onmouseenter="enter('-8420997342841621789');" onmouseout="out('-8420997342841621789');" style=""> 158              date = context.getResources().getString(R.string.yesterday);                                          </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 159              if (useShortFormat)                                                                                   </span>
<span class="8381191313867632389" onmouseenter="enter('8381191313867632389');" onmouseout="out('8381191313867632389');" style=""> 160                  retVal = date;                                                                                    </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 161              else                                                                                                  </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 162                  retVal = date + &quot;, &quot; + time;                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 163          } else {                                                                                                  </span>
<span class="-8110415762919125838" onmouseenter="enter('-8110415762919125838');" onmouseout="out('-8110415762919125838');" style=""> 164              date = new SimpleDateFormat(&quot;MMM dd&quot;, Locale.US).format(c.getTime());                                 </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 165              retVal = date + &quot;, &quot; + time;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166          }                                                                                                         </span>
<span  style=""> 167                                                                                                                    </span>
<span class="-2448447535460405943" onmouseenter="enter('-2448447535460405943');" onmouseout="out('-2448447535460405943');" style=""> 168          return retVal;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169      }                                                                                                             </span>
<span  style=""> 170                                                                                                                    </span>
<span class="-1889536418011186938" onmouseenter="enter('-1889536418011186938');" onmouseout="out('-1889536418011186938');" style=""> 171      private static int getReferenceCount(String key, String content) {                                            </span>
<span class="-666706993090019623" onmouseenter="enter('-666706993090019623');" onmouseout="out('-666706993090019623');" style=""> 172          Pattern pattern = Pattern.compile(SIMPLENOTE_LINK_PREFIX + key);                                          </span>
<span class="-5723325120560414069" onmouseenter="enter('-5723325120560414069');" onmouseout="out('-5723325120560414069');" style=""> 173          Matcher matcher = pattern.matcher(content);                                                               </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 174          int count = 0;                                                                                            </span>
<span  style=""> 175                                                                                                                    </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 176          while (matcher.find()) {                                                                                  </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style=""> 177              count++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178          }                                                                                                         </span>
<span  style=""> 179                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 180          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span class="-3902014892596708789" onmouseenter="enter('-3902014892596708789');" onmouseout="out('-3902014892596708789');" style=""> 183      public static List&lt;Reference&gt; getReferences(Bucket&lt;Note&gt; bucket, String key) {                                </span>
<span class="-6029684357073269481" onmouseenter="enter('-6029684357073269481');" onmouseout="out('-6029684357073269481');" style=""> 184          List&lt;Reference&gt; references = new ArrayList&lt;&gt;();                                                           </span>
<span class="-4658611266183475458" onmouseenter="enter('-4658611266183475458');" onmouseout="out('-4658611266183475458');" style=""> 185          Bucket.ObjectCursor&lt;Note&gt; cursor = Note.search(bucket, SIMPLENOTE_LINK_PREFIX + key).execute();           </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-679463407698125917" onmouseenter="enter('-679463407698125917');" onmouseout="out('-679463407698125917');" style=""> 187          while (cursor.moveToNext()) {                                                                             </span>
<span class="3501306350092034788" onmouseenter="enter('3501306350092034788');" onmouseout="out('3501306350092034788');" style=""> 188              Note note = cursor.getObject();                                                                       </span>
<span class="-4285952824793620055" onmouseenter="enter('-4285952824793620055');" onmouseout="out('-4285952824793620055');" style=""> 189              references.add(                                                                                       </span>
<span class="-1411633905067872974" onmouseenter="enter('-1411633905067872974');" onmouseout="out('-1411633905067872974');" style=""> 190                  new Reference(                                                                                    </span>
<span class="-3110909059350189445" onmouseenter="enter('-3110909059350189445');" onmouseout="out('-3110909059350189445');" style=""> 191                      note.getSimperiumKey(),                                                                       </span>
<span class="2543604805982207984" onmouseenter="enter('2543604805982207984');" onmouseout="out('2543604805982207984');" style=""> 192                      note.getTitle(),                                                                              </span>
<span class="7904695514627173906" onmouseenter="enter('7904695514627173906');" onmouseout="out('7904695514627173906');" style=""> 193                      note.getModificationDate(),                                                                   </span>
<span class="5299483559431490396" onmouseenter="enter('5299483559431490396');" onmouseout="out('5299483559431490396');" style=""> 194                      getReferenceCount(key, note.getContent())                                                     </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 195                  )                                                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 196              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197          }                                                                                                         </span>
<span  style=""> 198                                                                                                                    </span>
<span class="-816749515151999705" onmouseenter="enter('-816749515151999705');" onmouseout="out('-816749515151999705');" style=""> 199          return references;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200      }                                                                                                             </span>
<span  style=""> 201                                                                                                                    </span>
<span class="6991191424901834769" onmouseenter="enter('6991191424901834769');" onmouseout="out('6991191424901834769');" style=""> 202      public static Calendar numberToDate(Number time) {                                                            </span>
<span class="2627151998164378009" onmouseenter="enter('2627151998164378009');" onmouseout="out('2627151998164378009');" style=""> 203          Calendar date = Calendar.getInstance();                                                                   </span>
<span class="-4794582782203016972" onmouseenter="enter('-4794582782203016972');" onmouseout="out('-4794582782203016972');" style=""> 204          if (time != null) {                                                                                       </span>
<span class="-3733626690602126121" onmouseenter="enter('-3733626690602126121');" onmouseout="out('-3733626690602126121');" style=""> 205              // Flick Note uses millisecond resolution timestamps Simplenote expects seconds                       </span>
<span class="3026137703351918876" onmouseenter="enter('3026137703351918876');" onmouseout="out('3026137703351918876');" style=""> 206              // since we only deal with create and modify timestamps, they should all have occurred                </span>
<span class="-9197945245707351438" onmouseenter="enter('-9197945245707351438');" onmouseout="out('-9197945245707351438');" style=""> 207              // at the present time or in the past.                                                                </span>
<span class="-5330372272438133634" onmouseenter="enter('-5330372272438133634');" onmouseout="out('-5330372272438133634');" style=""> 208              float now = (float) date.getTimeInMillis() / 1000;                                                    </span>
<span class="7868403810214452697" onmouseenter="enter('7868403810214452697');" onmouseout="out('7868403810214452697');" style=""> 209              float magnitude = time.floatValue() / now;                                                            </span>
<span class="5909991427144614543" onmouseenter="enter('5909991427144614543');" onmouseout="out('5909991427144614543');" style=""> 210              if (magnitude &gt;= 2.f) time = time.longValue() / 1000;                                                 </span>
<span class="2284249078526717288" onmouseenter="enter('2284249078526717288');" onmouseout="out('2284249078526717288');" style=""> 211              date.setTimeInMillis(time.longValue() * 1000);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212          }                                                                                                         </span>
<span class="7179427650659377170" onmouseenter="enter('7179427650659377170');" onmouseout="out('7179427650659377170');" style=""> 213          return date;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="466463869222866851" onmouseenter="enter('466463869222866851');" onmouseout="out('466463869222866851');" style=""> 216      public static String numberToDateString(@NonNull Number number) {                                             </span>
<span class="-4090451846849985785" onmouseenter="enter('-4090451846849985785');" onmouseout="out('-4090451846849985785');" style=""> 217          long milliseconds = new BigDecimal(number.toString()).multiply(new BigDecimal(1000)).longValue();         </span>
<span class="2239009023688190143" onmouseenter="enter('2239009023688190143');" onmouseout="out('2239009023688190143');" style=""> 218          Calendar calendar = Calendar.getInstance();                                                               </span>
<span class="9071902319976922096" onmouseenter="enter('9071902319976922096');" onmouseout="out('9071902319976922096');" style=""> 219          calendar.setTimeInMillis(milliseconds);                                                                   </span>
<span class="-1960866814541712569" onmouseenter="enter('-1960866814541712569');" onmouseout="out('-1960866814541712569');" style=""> 220          SimpleDateFormat date = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSS&#x27;Z&#x27;&quot;, Locale.US);                  </span>
<span class="1592748650922216684" onmouseenter="enter('1592748650922216684');" onmouseout="out('1592748650922216684');" style=""> 221          date.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));                                                            </span>
<span class="5827364706871365292" onmouseenter="enter('5827364706871365292');" onmouseout="out('5827364706871365292');" style=""> 222          return date.format(calendar.getTime());                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223      }                                                                                                             </span>
<span  style=""> 224                                                                                                                    </span>
<span class="6373335669519535085" onmouseenter="enter('6373335669519535085');" onmouseout="out('6373335669519535085');" style=""> 225      protected void updateTitleAndPreview() {                                                                      </span>
<span class="4716811977187622861" onmouseenter="enter('4716811977187622861');" onmouseout="out('4716811977187622861');" style=""> 226          // try to build a title and preview property out of content                                               </span>
<span class="-6823550475843248983" onmouseenter="enter('-6823550475843248983');" onmouseout="out('-6823550475843248983');" style=""> 227          String content = getContent().trim();                                                                     </span>
<span class="327463840444924073" onmouseenter="enter('327463840444924073');" onmouseout="out('327463840444924073');" style=""> 228          if (content.length() &gt; MAX_PREVIEW_CHARS) {                                                               </span>
<span class="-8480236902805956072" onmouseenter="enter('-8480236902805956072');" onmouseout="out('-8480236902805956072');" style=""> 229              content = content.substring(0, MAX_PREVIEW_CHARS - 1);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230          }                                                                                                         </span>
<span  style=""> 231                                                                                                                    </span>
<span class="5724017298410569034" onmouseenter="enter('5724017298410569034');" onmouseout="out('5724017298410569034');" style=""> 232          int firstNewLinePosition = content.indexOf(NEW_LINE);                                                     </span>
<span class="7786689878958261573" onmouseenter="enter('7786689878958261573');" onmouseout="out('7786689878958261573');" style=""> 233          if (firstNewLinePosition &gt; -1 &amp;&amp; firstNewLinePosition &lt; 200) {                                            </span>
<span class="-397121944761876346" onmouseenter="enter('-397121944761876346');" onmouseout="out('-397121944761876346');" style=""> 234              mTitle = content.substring(0, firstNewLinePosition).trim();                                           </span>
<span  style=""> 235                                                                                                                    </span>
<span class="6552686713144756852" onmouseenter="enter('6552686713144756852');" onmouseout="out('6552686713144756852');" style=""> 236              if (firstNewLinePosition &lt; content.length()) {                                                        </span>
<span class="3544130446617579720" onmouseenter="enter('3544130446617579720');" onmouseout="out('3544130446617579720');" style=""> 237                  mContentPreview = content.substring(firstNewLinePosition, content.length());                      </span>
<span class="-6018298786369494309" onmouseenter="enter('-6018298786369494309');" onmouseout="out('-6018298786369494309');" style=""> 238                  mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).trim();  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 239              } else {                                                                                              </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 240                  mContentPreview = content;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 242          } else {                                                                                                  </span>
<span class="6158164289681498296" onmouseenter="enter('6158164289681498296');" onmouseout="out('6158164289681498296');" style=""> 243              mTitle = content;                                                                                     </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 244              mContentPreview = content;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-6200437978572139135" onmouseenter="enter('-6200437978572139135');" onmouseout="out('-6200437978572139135');" style=""> 248      public String getTitle() {                                                                                    </span>
<span class="5880156293984643419" onmouseenter="enter('5880156293984643419');" onmouseout="out('5880156293984643419');" style=""> 249          if (mTitle == null) {                                                                                     </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 250              updateTitleAndPreview();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251          }                                                                                                         </span>
<span class="-7721657982940010876" onmouseenter="enter('-7721657982940010876');" onmouseout="out('-7721657982940010876');" style=""> 252          return mTitle;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253      }                                                                                                             </span>
<span  style=""> 254                                                                                                                    </span>
<span class="-2689785139225953203" onmouseenter="enter('-2689785139225953203');" onmouseout="out('-2689785139225953203');" style=""> 255      public String getContent() {                                                                                  </span>
<span class="-593492380737036583" onmouseenter="enter('-593492380737036583');" onmouseout="out('-593492380737036583');" style=""> 256          Object content = getProperty(CONTENT_PROPERTY);                                                           </span>
<span class="-2591100211143552235" onmouseenter="enter('-2591100211143552235');" onmouseout="out('-2591100211143552235');" style=""> 257          if (content == null) {                                                                                    </span>
<span class="-7439137145129124014" onmouseenter="enter('-7439137145129124014');" onmouseout="out('-7439137145129124014');" style=""> 258              return BLANK_CONTENT;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259          }                                                                                                         </span>
<span class="-5104065841615841974" onmouseenter="enter('-5104065841615841974');" onmouseout="out('-5104065841615841974');" style=""> 260          return (String) content;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261      }                                                                                                             </span>
<span  style=""> 262                                                                                                                    </span>
<span class="8530044186661736565" onmouseenter="enter('8530044186661736565');" onmouseout="out('8530044186661736565');" style=""> 263      public void setContent(String content) {                                                                      </span>
<span class="6017523628383929627" onmouseenter="enter('6017523628383929627');" onmouseout="out('6017523628383929627');" style=""> 264          mTitle = null;                                                                                            </span>
<span class="7468898004511818931" onmouseenter="enter('7468898004511818931');" onmouseout="out('7468898004511818931');" style=""> 265          mContentPreview = null;                                                                                   </span>
<span class="-7075313288269577686" onmouseenter="enter('-7075313288269577686');" onmouseout="out('-7075313288269577686');" style=""> 266          setProperty(CONTENT_PROPERTY, content);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267      }                                                                                                             </span>
<span  style=""> 268                                                                                                                    </span>
<span class="-3177715860988830633" onmouseenter="enter('-3177715860988830633');" onmouseout="out('-3177715860988830633');" style=""> 269      public String getContentPreview() {                                                                           </span>
<span class="-8081599038098376119" onmouseenter="enter('-8081599038098376119');" onmouseout="out('-8081599038098376119');" style=""> 270          if (mContentPreview == null) {                                                                            </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 271              updateTitleAndPreview();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272          }                                                                                                         </span>
<span class="-7686656279835722897" onmouseenter="enter('-7686656279835722897');" onmouseout="out('-7686656279835722897');" style=""> 273          return mContentPreview;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274      }                                                                                                             </span>
<span  style=""> 275                                                                                                                    </span>
<span class="-4775876413201063426" onmouseenter="enter('-4775876413201063426');" onmouseout="out('-4775876413201063426');" style=""> 276      public Calendar getCreationDate() {                                                                           </span>
<span class="-8932394895206293128" onmouseenter="enter('-8932394895206293128');" onmouseout="out('-8932394895206293128');" style=""> 277          return numberToDate((Number) getProperty(CREATION_DATE_PROPERTY));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278      }                                                                                                             </span>
<span  style=""> 279                                                                                                                    </span>
<span class="3941971105481464917" onmouseenter="enter('3941971105481464917');" onmouseout="out('3941971105481464917');" style=""> 280      public String getCreationDateString() {                                                                       </span>
<span class="9031070846992233121" onmouseenter="enter('9031070846992233121');" onmouseout="out('9031070846992233121');" style=""> 281          return numberToDateString((Number) getProperty(CREATION_DATE_PROPERTY));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282      }                                                                                                             </span>
<span  style=""> 283                                                                                                                    </span>
<span class="4285319693858833712" onmouseenter="enter('4285319693858833712');" onmouseout="out('4285319693858833712');" style=""> 284      public void setCreationDate(Calendar creationDate) {                                                          </span>
<span class="-3054849024529806025" onmouseenter="enter('-3054849024529806025');" onmouseout="out('-3054849024529806025');" style=""> 285          setProperty(CREATION_DATE_PROPERTY, creationDate.getTimeInMillis() / 1000);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286      }                                                                                                             </span>
<span  style=""> 287                                                                                                                    </span>
<span class="4524335170961506892" onmouseenter="enter('4524335170961506892');" onmouseout="out('4524335170961506892');" style=""> 288      public Calendar getModificationDate() {                                                                       </span>
<span class="-7489834958201786921" onmouseenter="enter('-7489834958201786921');" onmouseout="out('-7489834958201786921');" style=""> 289          return numberToDate((Number) getProperty(MODIFICATION_DATE_PROPERTY));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290      }                                                                                                             </span>
<span  style=""> 291                                                                                                                    </span>
<span class="8706492949654452164" onmouseenter="enter('8706492949654452164');" onmouseout="out('8706492949654452164');" style=""> 292      public String getModificationDateString() {                                                                   </span>
<span class="-2749496034468843218" onmouseenter="enter('-2749496034468843218');" onmouseout="out('-2749496034468843218');" style=""> 293          return numberToDateString((Number) getProperty(MODIFICATION_DATE_PROPERTY));                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294      }                                                                                                             </span>
<span  style=""> 295                                                                                                                    </span>
<span class="2249083984085470814" onmouseenter="enter('2249083984085470814');" onmouseout="out('2249083984085470814');" style=""> 296      public void setModificationDate(Calendar modificationDate) {                                                  </span>
<span class="-7005792304358284877" onmouseenter="enter('-7005792304358284877');" onmouseout="out('-7005792304358284877');" style=""> 297          setProperty(MODIFICATION_DATE_PROPERTY, modificationDate.getTimeInMillis() / 1000);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298      }                                                                                                             </span>
<span  style=""> 299                                                                                                                    </span>
<span class="3367289575484325214" onmouseenter="enter('3367289575484325214');" onmouseout="out('3367289575484325214');" style=""> 300      public String getPublishedUrl() {                                                                             </span>
<span class="-5796973306134907482" onmouseenter="enter('-5796973306134907482');" onmouseout="out('-5796973306134907482');" style=""> 301          String urlCode = (String) getProperty(PUBLISH_URL_PROPERTY);                                              </span>
<span class="7900565639772953850" onmouseenter="enter('7900565639772953850');" onmouseout="out('7900565639772953850');" style=""> 302          if (TextUtils.isEmpty(urlCode)) {                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 303              return &quot;&quot;;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304          }                                                                                                         </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-8429126260993259062" onmouseenter="enter('-8429126260993259062');" onmouseout="out('-8429126260993259062');" style=""> 306          return PUBLISH_URL + urlCode;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307      }                                                                                                             </span>
<span  style=""> 308                                                                                                                    </span>
<span class="6727514612417725571" onmouseenter="enter('6727514612417725571');" onmouseout="out('6727514612417725571');" style=""> 309      public boolean hasTag(String tag) {                                                                           </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 310          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-3541717492710720609" onmouseenter="enter('-3541717492710720609');" onmouseout="out('-3541717492710720609');" style=""> 311          String tagLower = tag.toLowerCase();                                                                      </span>
<span class="-422766749461737265" onmouseenter="enter('-422766749461737265');" onmouseout="out('-422766749461737265');" style=""> 312          for (String tagName : tags) {                                                                             </span>
<span class="-6783003514598399026" onmouseenter="enter('-6783003514598399026');" onmouseout="out('-6783003514598399026');" style=""> 313              if (tagLower.equals(tagName.toLowerCase())) return true;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 315          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316      }                                                                                                             </span>
<span  style=""> 317                                                                                                                    </span>
<span class="1303119083327749335" onmouseenter="enter('1303119083327749335');" onmouseout="out('1303119083327749335');" style=""> 318      public boolean hasTag(Tag tag) {                                                                              </span>
<span class="-5268388303991583458" onmouseenter="enter('-5268388303991583458');" onmouseout="out('-5268388303991583458');" style=""> 319          return hasTag(tag.getSimperiumKey());                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span  style=""> 321                                                                                                                    </span>
<span class="-646587723470162813" onmouseenter="enter('-646587723470162813');" onmouseout="out('-646587723470162813');" style=""> 322      public List&lt;String&gt; getTags() {                                                                               </span>
<span  style=""> 323                                                                                                                    </span>
<span class="5046858882238824028" onmouseenter="enter('5046858882238824028');" onmouseout="out('5046858882238824028');" style=""> 324          JSONArray tags = (JSONArray) getProperty(TAGS_PROPERTY);                                                  </span>
<span  style=""> 325                                                                                                                    </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 326          if (tags == null) {                                                                                       </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 327              tags = new JSONArray();                                                                               </span>
<span class="-8058083631026170990" onmouseenter="enter('-8058083631026170990');" onmouseout="out('-8058083631026170990');" style=""> 328              setProperty(TAGS_PROPERTY, &quot;&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329          }                                                                                                         </span>
<span  style=""> 330                                                                                                                    </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 331          int length = tags.length();                                                                               </span>
<span  style=""> 332                                                                                                                    </span>
<span class="-7737950325994950460" onmouseenter="enter('-7737950325994950460');" onmouseout="out('-7737950325994950460');" style=""> 333          List&lt;String&gt; tagList = new ArrayList&lt;&gt;(length);                                                           </span>
<span  style=""> 334                                                                                                                    </span>
<span class="8256074331736484026" onmouseenter="enter('8256074331736484026');" onmouseout="out('8256074331736484026');" style=""> 335          if (length == 0) return tagList;                                                                          </span>
<span  style=""> 336                                                                                                                    </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 337          for (int i = 0; i &lt; length; i++) {                                                                        </span>
<span class="-8917993594954591540" onmouseenter="enter('-8917993594954591540');" onmouseout="out('-8917993594954591540');" style=""> 338              String tag = tags.optString(i);                                                                       </span>
<span class="-1947204619891178088" onmouseenter="enter('-1947204619891178088');" onmouseout="out('-1947204619891178088');" style=""> 339              if (!tag.equals(&quot;&quot;))                                                                                  </span>
<span class="2557583924535716267" onmouseenter="enter('2557583924535716267');" onmouseout="out('2557583924535716267');" style=""> 340                  tagList.add(tag);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341          }                                                                                                         </span>
<span  style=""> 342                                                                                                                    </span>
<span class="-3183448331203603949" onmouseenter="enter('-3183448331203603949');" onmouseout="out('-3183448331203603949');" style=""> 343          return tagList;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344      }                                                                                                             </span>
<span  style=""> 345                                                                                                                    </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 346 +    public void removeTag(String tagName) {                                                                       </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 347 +        List&lt;String&gt; tags = getTags();                                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 348 +                                                                                                                  </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 349 +        List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                         </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 350 +        tags.removeAll(tagsMatched);                                                                              </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 351 +                                                                                                                  </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 352 +        setTags(tags);                                                                                            </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 353 +        save();                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 354 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 355 +                                                                                                                  </span>
<span class="-6026710755135647724" onmouseenter="enter('-6026710755135647724');" onmouseout="out('-6026710755135647724');" style=""> 356      public void setTags(List&lt;String&gt; tags) {                                                                      </span>
<span class="-8982714688054322872" onmouseenter="enter('-8982714688054322872');" onmouseout="out('-8982714688054322872');" style=""> 357          setProperty(TAGS_PROPERTY, new JSONArray(tags));                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 358 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 359 +                                                                                                                  </span>
<span class="-1421161503350598143" onmouseenter="enter('-1421161503350598143');" onmouseout="out('-1421161503350598143');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 360 +    public void setTags(JSONArray tags) {                                                                         </span>
<span class="-9171468773333999657" onmouseenter="enter('-9171468773333999657');" onmouseout="out('-9171468773333999657');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 361 +        setProperty(TAGS_PROPERTY, tags);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362      }                                                                                                             </span>
<span  style=""> 363                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 364      /**                                                                                                           </span>
<span class="2568101064766040631" onmouseenter="enter('2568101064766040631');" onmouseout="out('2568101064766040631');" style=""> 365       * String of tags delimited by a space                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 366       */                                                                                                           </span>
<span class="-8942719802141200658" onmouseenter="enter('-8942719802141200658');" onmouseout="out('-8942719802141200658');" style=""> 367      public CharSequence getTagString() {                                                                          </span>
<span class="-4644025499612109112" onmouseenter="enter('-4644025499612109112');" onmouseout="out('-4644025499612109112');" style=""> 368          StringBuilder tagString = new StringBuilder();                                                            </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 369          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-7185531782033852210" onmouseenter="enter('-7185531782033852210');" onmouseout="out('-7185531782033852210');" style=""> 370          for (String tag : tags) {                                                                                 </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 371              if (tagString.length() &gt; 0) {                                                                         </span>
<span class="-848655472163713161" onmouseenter="enter('-848655472163713161');" onmouseout="out('-848655472163713161');" style=""> 372                  tagString.append(SPACE);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373              }                                                                                                     </span>
<span class="3299521276937168474" onmouseenter="enter('3299521276937168474');" onmouseout="out('3299521276937168474');" style=""> 374              tagString.append(tag);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375          }                                                                                                         </span>
<span class="-3216397563367246452" onmouseenter="enter('-3216397563367246452');" onmouseout="out('-3216397563367246452');" style=""> 376          return tagString;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377      }                                                                                                             </span>
<span  style=""> 378                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 379      /**                                                                                                           </span>
<span class="516081738825732450" onmouseenter="enter('516081738825732450');" onmouseout="out('516081738825732450');" style=""> 380       * Sets the note&#x27;s tags by providing it with a {@link String} of space separated tags.                        </span>
<span class="-3361819639621639487" onmouseenter="enter('-3361819639621639487');" onmouseout="out('-3361819639621639487');" style=""> 381       * Filters out duplicate tags.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 382       *                                                                                                            </span>
<span class="-3621424951438819239" onmouseenter="enter('-3621424951438819239');" onmouseout="out('-3621424951438819239');" style=""> 383       * @param tagString a space delimited list of tags                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 384       */                                                                                                           </span>
<span class="-7562161399809710400" onmouseenter="enter('-7562161399809710400');" onmouseout="out('-7562161399809710400');" style=""> 385      public void setTagString(String tagString) {                                                                  </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 386          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-8892740331038047380" onmouseenter="enter('-8892740331038047380');" onmouseout="out('-8892740331038047380');" style=""> 387          tags.clear();                                                                                             </span>
<span  style=""> 388                                                                                                                    </span>
<span class="7647632027089311583" onmouseenter="enter('7647632027089311583');" onmouseout="out('7647632027089311583');" style=""> 389          if (tagString == null) {                                                                                  </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 390              setTags(tags);                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 391              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392          }                                                                                                         </span>
<span  style=""> 393                                                                                                                    </span>
<span class="-6765712323396427098" onmouseenter="enter('-6765712323396427098');" onmouseout="out('-6765712323396427098');" style=""> 394          // Make sure string has a trailing space                                                                  </span>
<span class="3861570924678507302" onmouseenter="enter('3861570924678507302');" onmouseout="out('3861570924678507302');" style=""> 395          if (tagString.length() &gt; 1 &amp;&amp; !tagString.substring(tagString.length() - 1).equals(SPACE))                 </span>
<span class="-5113585973277465859" onmouseenter="enter('-5113585973277465859');" onmouseout="out('-5113585973277465859');" style=""> 396              tagString = tagString + SPACE;                                                                        </span>
<span class="5741128019150417186" onmouseenter="enter('5741128019150417186');" onmouseout="out('5741128019150417186');" style=""> 397          // for comparing case-insensitive strings, would like to find a way to                                    </span>
<span class="-5706726934096139867" onmouseenter="enter('-5706726934096139867');" onmouseout="out('-5706726934096139867');" style=""> 398          // do this without allocating a new list and strings                                                      </span>
<span class="5881300344958500433" onmouseenter="enter('5881300344958500433');" onmouseout="out('5881300344958500433');" style=""> 399          List&lt;String&gt; tagsUpperCase = new ArrayList&lt;&gt;();                                                           </span>
<span class="-8087573356169949002" onmouseenter="enter('-8087573356169949002');" onmouseout="out('-8087573356169949002');" style=""> 400          // remove all current tags                                                                                </span>
<span class="1170680636863075190" onmouseenter="enter('1170680636863075190');" onmouseout="out('1170680636863075190');" style=""> 401          int start = 0;                                                                                            </span>
<span class="2514405873256423103" onmouseenter="enter('2514405873256423103');" onmouseout="out('2514405873256423103');" style=""> 402          int next;                                                                                                 </span>
<span class="-8708428587370728232" onmouseenter="enter('-8708428587370728232');" onmouseout="out('-8708428587370728232');" style=""> 403          String possible;                                                                                          </span>
<span class="3545966998003531195" onmouseenter="enter('3545966998003531195');" onmouseout="out('3545966998003531195');" style=""> 404          String possibleUpperCase;                                                                                 </span>
<span class="-67055061468690966" onmouseenter="enter('-67055061468690966');" onmouseout="out('-67055061468690966');" style=""> 405          // search tag string for space characters and pull out individual tags                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 406          do {                                                                                                      </span>
<span class="539196990274646798" onmouseenter="enter('539196990274646798');" onmouseout="out('539196990274646798');" style=""> 407              next = tagString.indexOf(SPACE, start);                                                               </span>
<span class="7441993871510338947" onmouseenter="enter('7441993871510338947');" onmouseout="out('7441993871510338947');" style=""> 408              if (next &gt; start) {                                                                                   </span>
<span class="-6369978890856333437" onmouseenter="enter('-6369978890856333437');" onmouseout="out('-6369978890856333437');" style=""> 409                  possible = tagString.substring(start, next);                                                      </span>
<span class="40967178918958955" onmouseenter="enter('40967178918958955');" onmouseout="out('40967178918958955');" style=""> 410                  possibleUpperCase = possible.toUpperCase();                                                       </span>
<span class="-6789588636567169254" onmouseenter="enter('-6789588636567169254');" onmouseout="out('-6789588636567169254');" style=""> 411                  if (!possible.equals(SPACE) &amp;&amp; !tagsUpperCase.contains(possibleUpperCase)) {                      </span>
<span class="8107171034948128222" onmouseenter="enter('8107171034948128222');" onmouseout="out('8107171034948128222');" style=""> 412                      tagsUpperCase.add(possibleUpperCase);                                                         </span>
<span class="-3623952282264178458" onmouseenter="enter('-3623952282264178458');" onmouseout="out('-3623952282264178458');" style=""> 413                      tags.add(possible);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415              }                                                                                                     </span>
<span class="2598261311594212195" onmouseenter="enter('2598261311594212195');" onmouseout="out('2598261311594212195');" style=""> 416              start = next + 1;                                                                                     </span>
<span class="-8911857571695172425" onmouseenter="enter('-8911857571695172425');" onmouseout="out('-8911857571695172425');" style=""> 417          } while (next &gt; -1);                                                                                      </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 418          setTags(tags);                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419      }                                                                                                             </span>
<span  style=""> 420                                                                                                                    </span>
<span class="-2380080839978865436" onmouseenter="enter('-2380080839978865436');" onmouseout="out('-2380080839978865436');" style=""> 421      public JSONArray getSystemTags() {                                                                            </span>
<span class="1634689045753216867" onmouseenter="enter('1634689045753216867');" onmouseout="out('1634689045753216867');" style=""> 422          JSONArray tags = (JSONArray) getProperty(SYSTEM_TAGS_PROPERTY);                                           </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 423          if (tags == null) {                                                                                       </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 424              tags = new JSONArray();                                                                               </span>
<span class="8109738276011217421" onmouseenter="enter('8109738276011217421');" onmouseout="out('8109738276011217421');" style=""> 425              setProperty(SYSTEM_TAGS_PROPERTY, tags);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426          }                                                                                                         </span>
<span class="-7737333077028274174" onmouseenter="enter('-7737333077028274174');" onmouseout="out('-7737333077028274174');" style=""> 427          return tags;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428      }                                                                                                             </span>
<span  style=""> 429                                                                                                                    </span>
<span class="3090413247451101219" onmouseenter="enter('3090413247451101219');" onmouseout="out('3090413247451101219');" style=""> 430      public Boolean isDeleted() {                                                                                  </span>
<span class="7870299677279363320" onmouseenter="enter('7870299677279363320');" onmouseout="out('7870299677279363320');" style=""> 431          Object deleted = getProperty(DELETED_PROPERTY);                                                           </span>
<span class="3213349019391348934" onmouseenter="enter('3213349019391348934');" onmouseout="out('3213349019391348934');" style=""> 432          if (deleted == null) {                                                                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 433              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434          }                                                                                                         </span>
<span class="-8245820290182222148" onmouseenter="enter('-8245820290182222148');" onmouseout="out('-8245820290182222148');" style=""> 435          if (deleted instanceof Boolean) {                                                                         </span>
<span class="110137553981332086" onmouseenter="enter('110137553981332086');" onmouseout="out('110137553981332086');" style=""> 436              return (Boolean) deleted;                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 437          } else {                                                                                                  </span>
<span class="5495215667694299112" onmouseenter="enter('5495215667694299112');" onmouseout="out('5495215667694299112');" style=""> 438              // Simperium-iOS sets booleans as integer values (0 or 1)                                             </span>
<span class="2375816303299771461" onmouseenter="enter('2375816303299771461');" onmouseout="out('2375816303299771461');" style=""> 439              return deleted instanceof Number &amp;&amp; ((Number) deleted).intValue() != 0;                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441      }                                                                                                             </span>
<span  style=""> 442                                                                                                                    </span>
<span class="6912205177980332866" onmouseenter="enter('6912205177980332866');" onmouseout="out('6912205177980332866');" style=""> 443      public void setDeleted(boolean deleted) {                                                                     </span>
<span class="-864256626113761460" onmouseenter="enter('-864256626113761460');" onmouseout="out('-864256626113761460');" style=""> 444          setProperty(DELETED_PROPERTY, deleted);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445      }                                                                                                             </span>
<span  style=""> 446                                                                                                                    </span>
<span class="5985631777888601261" onmouseenter="enter('5985631777888601261');" onmouseout="out('5985631777888601261');" style=""> 447      public boolean isMarkdownEnabled() {                                                                          </span>
<span class="-5743540823315516839" onmouseenter="enter('-5743540823315516839');" onmouseout="out('-5743540823315516839');" style=""> 448          return hasSystemTag(MARKDOWN_TAG);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449      }                                                                                                             </span>
<span  style=""> 450                                                                                                                    </span>
<span class="-9134361680160631549" onmouseenter="enter('-9134361680160631549');" onmouseout="out('-9134361680160631549');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 451 +    public void enableMarkdown() {                                                                                </span>
<span class="-2955264683036225716" onmouseenter="enter('-2955264683036225716');" onmouseout="out('-2955264683036225716');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 452 +        setMarkdownEnabled(true);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 453 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 454 +                                                                                                                  </span>
<span class="-2232443542975324273" onmouseenter="enter('-2232443542975324273');" onmouseout="out('-2232443542975324273');" style=""> 455      public void setMarkdownEnabled(boolean isMarkdownEnabled) {                                                   </span>
<span class="5908341161553131781" onmouseenter="enter('5908341161553131781');" onmouseout="out('5908341161553131781');" style=""> 456          if (isMarkdownEnabled) {                                                                                  </span>
<span class="-7185185989369936008" onmouseenter="enter('-7185185989369936008');" onmouseout="out('-7185185989369936008');" style=""> 457              addSystemTag(MARKDOWN_TAG);                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 458          } else {                                                                                                  </span>
<span class="1430034125671484052" onmouseenter="enter('1430034125671484052');" onmouseout="out('1430034125671484052');" style=""> 459              removeSystemTag(MARKDOWN_TAG);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461      }                                                                                                             </span>
<span  style=""> 462                                                                                                                    </span>
<span class="-7992821206137485678" onmouseenter="enter('-7992821206137485678');" onmouseout="out('-7992821206137485678');" style=""> 463      public boolean isPinned() {                                                                                   </span>
<span class="7436893036029851482" onmouseenter="enter('7436893036029851482');" onmouseout="out('7436893036029851482');" style=""> 464          return hasSystemTag(PINNED_TAG);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465      }                                                                                                             </span>
<span  style=""> 466                                                                                                                    </span>
<span class="7137874092814138484" onmouseenter="enter('7137874092814138484');" onmouseout="out('7137874092814138484');" style=""> 467      public void setPinned(boolean isPinned) {                                                                     </span>
<span class="-8977010770732050857" onmouseenter="enter('-8977010770732050857');" onmouseout="out('-8977010770732050857');" style=""> 468          if (isPinned) {                                                                                           </span>
<span class="-705489752486798560" onmouseenter="enter('-705489752486798560');" onmouseout="out('-705489752486798560');" style=""> 469              addSystemTag(PINNED_TAG);                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 470          } else {                                                                                                  </span>
<span class="5010790157822780054" onmouseenter="enter('5010790157822780054');" onmouseout="out('5010790157822780054');" style=""> 471              removeSystemTag(PINNED_TAG);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473      }                                                                                                             </span>
<span  style=""> 474                                                                                                                    </span>
<span class="3778345749504952755" onmouseenter="enter('3778345749504952755');" onmouseout="out('3778345749504952755');" style=""> 475      public boolean isPreviewEnabled() {                                                                           </span>
<span class="-6537187368585435683" onmouseenter="enter('-6537187368585435683');" onmouseout="out('-6537187368585435683');" style=""> 476          return hasSystemTag(PREVIEW_TAG);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477      }                                                                                                             </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-3198839301731339686" onmouseenter="enter('-3198839301731339686');" onmouseout="out('-3198839301731339686');" style=""> 479      public void setPreviewEnabled(boolean isPreviewEnabled) {                                                     </span>
<span class="-4540372431458214170" onmouseenter="enter('-4540372431458214170');" onmouseout="out('-4540372431458214170');" style=""> 480          if (isPreviewEnabled) {                                                                                   </span>
<span class="1609739104508733891" onmouseenter="enter('1609739104508733891');" onmouseout="out('1609739104508733891');" style=""> 481              addSystemTag(PREVIEW_TAG);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 482          } else {                                                                                                  </span>
<span class="1340191486118728833" onmouseenter="enter('1340191486118728833');" onmouseout="out('1340191486118728833');" style=""> 483              removeSystemTag(PREVIEW_TAG);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485      }                                                                                                             </span>
<span  style=""> 486                                                                                                                    </span>
<span class="5049304787018344959" onmouseenter="enter('5049304787018344959');" onmouseout="out('5049304787018344959');" style=""> 487      public boolean isPublished() {                                                                                </span>
<span class="-3313218062555121548" onmouseenter="enter('-3313218062555121548');" onmouseout="out('-3313218062555121548');" style=""> 488          return hasSystemTag(PUBLISHED_TAG) &amp;&amp; !TextUtils.isEmpty(getPublishedUrl());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489      }                                                                                                             </span>
<span  style=""> 490                                                                                                                    </span>
<span class="-1996001930026199474" onmouseenter="enter('-1996001930026199474');" onmouseout="out('-1996001930026199474');" style=""> 491      public void setPublished(boolean isPublished) {                                                               </span>
<span class="-214835194616400293" onmouseenter="enter('-214835194616400293');" onmouseout="out('-214835194616400293');" style=""> 492          if (isPublished) {                                                                                        </span>
<span class="6614236660148008937" onmouseenter="enter('6614236660148008937');" onmouseout="out('6614236660148008937');" style=""> 493              addSystemTag(PUBLISHED_TAG);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 494          } else {                                                                                                  </span>
<span class="-3125520029372940316" onmouseenter="enter('-3125520029372940316');" onmouseout="out('-3125520029372940316');" style=""> 495              removeSystemTag(PUBLISHED_TAG);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497      }                                                                                                             </span>
<span  style=""> 498                                                                                                                    </span>










<span class="8481041411290642641" onmouseenter="enter('8481041411290642641');" onmouseout="out('8481041411290642641');" style=""> 499      private boolean hasSystemTag(String tag) {                                                                    </span>
<span class="-1472869558903340894" onmouseenter="enter('-1472869558903340894');" onmouseout="out('-1472869558903340894');" style=""> 500          if (TextUtils.isEmpty(tag))                                                                               </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 501              return false;                                                                                         </span>
<span  style=""> 502                                                                                                                    </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 503          JSONArray tags = getSystemTags();                                                                         </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 504          int length = tags.length();                                                                               </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 505          for (int i = 0; i &lt; length; i++) {                                                                        </span>
<span class="1029161545303231138" onmouseenter="enter('1029161545303231138');" onmouseout="out('1029161545303231138');" style=""> 506              if (tags.optString(i).equals(tag)) {                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 507                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 509          }                                                                                                         </span>
<span  style=""> 510                                                                                                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 511          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512      }                                                                                                             </span>
<span  style=""> 513                                                                                                                    </span>
<span class="-1886965851517885412" onmouseenter="enter('-1886965851517885412');" onmouseout="out('-1886965851517885412');" style=""> 514      private void addSystemTag(String tag) {                                                                       </span>
<span class="-7266652503291305395" onmouseenter="enter('-7266652503291305395');" onmouseout="out('-7266652503291305395');" style=""> 515          if (TextUtils.isEmpty(tag)) {                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 516              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517          }                                                                                                         </span>
<span  style=""> 518                                                                                                                    </span>
<span class="4034934261619610009" onmouseenter="enter('4034934261619610009');" onmouseout="out('4034934261619610009');" style=""> 519          // Ensure we don&#x27;t add the same tag again                                                                 </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 520          if (!hasSystemTag(tag)) {                                                                                 </span>
<span class="-2655750625237705417" onmouseenter="enter('-2655750625237705417');" onmouseout="out('-2655750625237705417');" style=""> 521              getSystemTags().put(tag);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523      }                                                                                                             </span>
<span  style=""> 524                                                                                                                    </span>
<span class="-6272346588769055483" onmouseenter="enter('-6272346588769055483');" onmouseout="out('-6272346588769055483');" style=""> 525      private void removeSystemTag(String tag) {                                                                    </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 526          if (!hasSystemTag(tag)) {                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 527              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528          }                                                                                                         </span>
<span  style=""> 529                                                                                                                    </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 530          JSONArray tags = getSystemTags();                                                                         </span>
<span class="6472000112597211426" onmouseenter="enter('6472000112597211426');" onmouseout="out('6472000112597211426');" style=""> 531          JSONArray newTags = new JSONArray();                                                                      </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 532          int length = tags.length();                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 533          try {                                                                                                     </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 534              for (int i = 0; i &lt; length; i++) {                                                                    </span>
<span class="5751642819386913624" onmouseenter="enter('5751642819386913624');" onmouseout="out('5751642819386913624');" style=""> 535                  Object val = tags.get(i);                                                                         </span>
<span class="7076458285668173093" onmouseenter="enter('7076458285668173093');" onmouseout="out('7076458285668173093');" style=""> 536                  if (!val.equals(tag))                                                                             </span>
<span class="-6329059091210941964" onmouseenter="enter('-6329059091210941964');" onmouseout="out('-6329059091210941964');" style=""> 537                      newTags.put(val);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538              }                                                                                                     </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 539          } catch (JSONException e) {                                                                               </span>
<span class="4377813279323840039" onmouseenter="enter('4377813279323840039');" onmouseout="out('4377813279323840039');" style=""> 540              // could not update pinned setting                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541          }                                                                                                         </span>
<span  style=""> 542                                                                                                                    </span>
<span class="8301502673130902229" onmouseenter="enter('8301502673130902229');" onmouseout="out('8301502673130902229');" style=""> 543          setProperty(SYSTEM_TAGS_PROPERTY, newTags);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544      }                                                                                                             </span>
<span  style=""> 545                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 546      /**                                                                                                           </span>
<span class="-397105642920094918" onmouseenter="enter('-397105642920094918');" onmouseout="out('-397105642920094918');" style=""> 547       * Check if the note has any changes                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 548       *                                                                                                            </span>
<span class="6656400016423195192" onmouseenter="enter('6656400016423195192');" onmouseout="out('6656400016423195192');" style=""> 549       * @param content           the new note content                                                              </span>
<span class="698428434066591100" onmouseenter="enter('698428434066591100');" onmouseout="out('698428434066591100');" style=""> 550       * @param tagString         space separated tags                                                              </span>
<span class="-6143007710262330196" onmouseenter="enter('-6143007710262330196');" onmouseout="out('-6143007710262330196');" style=""> 551       * @param isPinned          note is pinned                                                                    </span>
<span class="-1154760621356330740" onmouseenter="enter('-1154760621356330740');" onmouseout="out('-1154760621356330740');" style=""> 552       * @param isMarkdownEnabled note has markdown enabled                                                         </span>
<span class="-2689180860643219460" onmouseenter="enter('-2689180860643219460');" onmouseout="out('-2689180860643219460');" style=""> 553       * @param isPreviewEnabled  note has preview enabled                                                          </span>
<span class="2808295610973044096" onmouseenter="enter('2808295610973044096');" onmouseout="out('2808295610973044096');" style=""> 554       * @return true if note has changes, false if it is unchanged.                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 555       */                                                                                                           </span>
<span class="2249306723652890422" onmouseenter="enter('2249306723652890422');" onmouseout="out('2249306723652890422');" style=""><abbr title=" 556      public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boolean isPreviewEnabled) {"> 556      public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boole🔵</abbr></span>
<span class="-8752168499945681469" onmouseenter="enter('-8752168499945681469');" onmouseout="out('-8752168499945681469');" style=""> 557          return !content.equals(this.getContent())                                                                 </span>
<span class="361029725350182512" onmouseenter="enter('361029725350182512');" onmouseout="out('361029725350182512');" style=""> 558                  || !tagString.equals(this.getTagString().toString())                                              </span>
<span class="-3256796514842471479" onmouseenter="enter('-3256796514842471479');" onmouseout="out('-3256796514842471479');" style=""> 559                  || this.isPinned() != isPinned                                                                    </span>
<span class="3248054844136733713" onmouseenter="enter('3248054844136733713');" onmouseout="out('3248054844136733713');" style=""> 560                  || this.isMarkdownEnabled() != isMarkdownEnabled                                                  </span>
<span class="7822456953056210787" onmouseenter="enter('7822456953056210787');" onmouseout="out('7822456953056210787');" style=""> 561                  || this.isPreviewEnabled() != isPreviewEnabled;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 562      }                                                                                                             </span>
<span  style=""> 563                                                                                                                    </span>
<span class="-7717881480664684723" onmouseenter="enter('-7717881480664684723');" onmouseout="out('-7717881480664684723');" style=""> 564      public static class Schema extends BucketSchema&lt;Note&gt; {                                                       </span>
<span  style=""> 565                                                                                                                    </span>
<span class="-3235753444162186767" onmouseenter="enter('-3235753444162186767');" onmouseout="out('-3235753444162186767');" style=""> 566          protected static NoteIndexer sNoteIndexer = new NoteIndexer();                                            </span>
<span class="-8196684505127442187" onmouseenter="enter('-8196684505127442187');" onmouseout="out('-8196684505127442187');" style=""> 567          protected static NoteFullTextIndexer sFullTextIndexer = new NoteFullTextIndexer();                        </span>
<span  style=""> 568                                                                                                                    </span>
<span class="-75865115147660663" onmouseenter="enter('-75865115147660663');" onmouseout="out('-75865115147660663');" style=""> 569          public Schema() {                                                                                         </span>
<span class="-4886495676536647522" onmouseenter="enter('-4886495676536647522');" onmouseout="out('-4886495676536647522');" style=""> 570              autoIndex();                                                                                          </span>
<span class="-6825633182165860223" onmouseenter="enter('-6825633182165860223');" onmouseout="out('-6825633182165860223');" style=""> 571              addIndex(sNoteIndexer);                                                                               </span>
<span class="-3392547141042614111" onmouseenter="enter('-3392547141042614111');" onmouseout="out('-3392547141042614111');" style=""> 572              setupFullTextIndex(sFullTextIndexer, NoteFullTextIndexer.INDEXES);                                    </span>
<span class="-6401895186782523877" onmouseenter="enter('-6401895186782523877');" onmouseout="out('-6401895186782523877');" style=""> 573              setDefault(CONTENT_PROPERTY, &quot;&quot;);                                                                     </span>
<span class="-2554467534039091654" onmouseenter="enter('-2554467534039091654');" onmouseout="out('-2554467534039091654');" style=""> 574              setDefault(SYSTEM_TAGS_PROPERTY, new JSONArray());                                                    </span>
<span class="228359577715990029" onmouseenter="enter('228359577715990029');" onmouseout="out('228359577715990029');" style=""> 575              setDefault(TAGS_PROPERTY, new JSONArray());                                                           </span>
<span class="-819869596778271798" onmouseenter="enter('-819869596778271798');" onmouseout="out('-819869596778271798');" style=""> 576              setDefault(DELETED_PROPERTY, false);                                                                  </span>
<span class="-8278335164591762572" onmouseenter="enter('-8278335164591762572');" onmouseout="out('-8278335164591762572');" style=""> 577              setDefault(SHARE_URL_PROPERTY, &quot;&quot;);                                                                   </span>
<span class="4718032932676673460" onmouseenter="enter('4718032932676673460');" onmouseout="out('4718032932676673460');" style=""> 578              setDefault(PUBLISH_URL_PROPERTY, &quot;&quot;);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579          }                                                                                                         </span>
<span  style=""> 580                                                                                                                    </span>
<span class="1438294404599077665" onmouseenter="enter('1438294404599077665');" onmouseout="out('1438294404599077665');" style=""> 581          public String getRemoteName() {                                                                           </span>
<span class="-8943072285760215512" onmouseenter="enter('-8943072285760215512');" onmouseout="out('-8943072285760215512');" style=""> 582              return Note.BUCKET_NAME;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583          }                                                                                                         </span>
<span  style=""> 584                                                                                                                    </span>
<span class="-4946235729406468677" onmouseenter="enter('-4946235729406468677');" onmouseout="out('-4946235729406468677');" style=""> 585          public Note build(String key, JSONObject properties) {                                                    </span>
<span class="-2808542273143064496" onmouseenter="enter('-2808542273143064496');" onmouseout="out('-2808542273143064496');" style=""> 586              return new Note(key, properties);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 587          }                                                                                                         </span>
<span  style=""> 588                                                                                                                    </span>
<span class="2318790323390762687" onmouseenter="enter('2318790323390762687');" onmouseout="out('2318790323390762687');" style=""> 589          public void update(Note note, JSONObject properties) {                                                    </span>
<span class="-3717338000153341316" onmouseenter="enter('-3717338000153341316');" onmouseout="out('-3717338000153341316');" style=""> 590              note.setProperties(properties);                                                                       </span>
<span class="-731284339738821488" onmouseenter="enter('-731284339738821488');" onmouseout="out('-731284339738821488');" style=""> 591              note.mTitle = null;                                                                                   </span>
<span class="6645980171711348815" onmouseenter="enter('6645980171711348815');" onmouseout="out('6645980171711348815');" style=""> 592              note.mContentPreview = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="9181943406056492869" onmouseenter="enter('9181943406056492869');" onmouseout="out('9181943406056492869');" style="">   1  package com.automattic.simplenote.models;                                                                         </span>
<span  style="">   2                                                                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   3  import android.content.Context;                                                                                   </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   4  import android.text.TextUtils;                                                                                    </span>
<span  style="">   5                                                                                                                    </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   6  import androidx.annotation.NonNull;                                                                               </span>
<span  style="">   7                                                                                                                    </span>
<span class="-6092371777820512633" onmouseenter="enter('-6092371777820512633');" onmouseout="out('-6092371777820512633');" style="">   8  import com.automattic.simplenote.R;                                                                               </span>
<span class="-643769428942460504" onmouseenter="enter('-643769428942460504');" onmouseout="out('-643769428942460504');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 +import com.automattic.simplenote.utils.TagUtils;                                                                  </span>

<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  10  import com.simperium.client.Bucket;                                                                               </span>
<span class="6125639164043971044" onmouseenter="enter('6125639164043971044');" onmouseout="out('6125639164043971044');" style="">  11  import com.simperium.client.BucketObject;                                                                         </span>
<span class="-665307165473523580" onmouseenter="enter('-665307165473523580');" onmouseout="out('-665307165473523580');" style="">  12  import com.simperium.client.BucketSchema;                                                                         </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  13  import com.simperium.client.Query;                                                                                </span>
<span class="-838252138947964043" onmouseenter="enter('-838252138947964043');" onmouseout="out('-838252138947964043');" style="">  14  import com.simperium.client.Query.ComparisonType;                                                                 </span>

<span  style="">  15                                                                                                                    </span>
<span class="-9193129351684262878" onmouseenter="enter('-9193129351684262878');" onmouseout="out('-9193129351684262878');" style="">  16  import org.json.JSONArray;                                                                                        </span>
<span class="-8573375701834280359" onmouseenter="enter('-8573375701834280359');" onmouseout="out('-8573375701834280359');" style="">  17  import org.json.JSONException;                                                                                    </span>
<span class="7232075261178918144" onmouseenter="enter('7232075261178918144');" onmouseout="out('7232075261178918144');" style="">  18  import org.json.JSONObject;                                                                                       </span>
<span  style="">  19                                                                                                                    </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  20  import java.math.BigDecimal;                                                                                      </span>
<span class="1238662365364477381" onmouseenter="enter('1238662365364477381');" onmouseout="out('1238662365364477381');" style="">  21  import java.text.DateFormat;                                                                                      </span>

<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  22  import java.text.SimpleDateFormat;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  23  import java.util.ArrayList;                                                                                       </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  24  import java.util.Calendar;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  25  import java.util.List;                                                                                            </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  26  import java.util.Locale;                                                                                          </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  27  import java.util.TimeZone;                                                                                        </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  28  import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  29  import java.util.regex.Pattern;                                                                                   </span>
<span  style="">  30                                                                                                                    </span>
<span class="-4405840676582391526" onmouseenter="enter('-4405840676582391526');" onmouseout="out('-4405840676582391526');" style="">  31  import static com.automattic.simplenote.utils.SimplenoteLinkify.SIMPLENOTE_LINK_PREFIX;                           </span>
<span  style="">  32                                                                                                                    </span>
<span class="1630911635596164534" onmouseenter="enter('1630911635596164534');" onmouseout="out('1630911635596164534');" style="">  33  public class Note extends BucketObject {                                                                          </span>
<span  style="">  34                                                                                                                    </span>
<span class="308952937305736491" onmouseenter="enter('308952937305736491');" onmouseout="out('308952937305736491');" style="">  35      public static final String BUCKET_NAME = &quot;note&quot;;                                                              </span>
<span class="6014442145961064017" onmouseenter="enter('6014442145961064017');" onmouseout="out('6014442145961064017');" style="">  36      public static final String MARKDOWN_TAG = &quot;markdown&quot;;                                                         </span>
<span class="-8101559688416496628" onmouseenter="enter('-8101559688416496628');" onmouseout="out('-8101559688416496628');" style="">  37      public static final String PINNED_TAG = &quot;pinned&quot;;                                                             </span>
<span class="2755303258201669627" onmouseenter="enter('2755303258201669627');" onmouseout="out('2755303258201669627');" style="">  38      public static final String PREVIEW_TAG = &quot;preview&quot;;                                                           </span>
<span class="1168195147039968761" onmouseenter="enter('1168195147039968761');" onmouseout="out('1168195147039968761');" style="">  39      public static final String PUBLISHED_TAG = &quot;published&quot;;                                                       </span>
<span class="6384737125939709481" onmouseenter="enter('6384737125939709481');" onmouseout="out('6384737125939709481');" style="">  40      public static final String NEW_LINE = &quot;\n&quot;;                                                                   </span>
<span class="-6709867799447959845" onmouseenter="enter('-6709867799447959845');" onmouseout="out('-6709867799447959845');" style="">  41      public static final String CONTENT_PROPERTY = &quot;content&quot;;                                                      </span>
<span class="-7150784166370340219" onmouseenter="enter('-7150784166370340219');" onmouseout="out('-7150784166370340219');" style="">  42      public static final String KEY_PROPERTY = &quot;key&quot;;                                                              </span>
<span class="-2027165692804872527" onmouseenter="enter('-2027165692804872527');" onmouseout="out('-2027165692804872527');" style="">  43      public static final String TAGS_PROPERTY = &quot;tags&quot;;                                                            </span>
<span class="-2782765636412056512" onmouseenter="enter('-2782765636412056512');" onmouseout="out('-2782765636412056512');" style="">  44      public static final String SYSTEM_TAGS_PROPERTY = &quot;systemTags&quot;;                                               </span>
<span class="8082059840675302216" onmouseenter="enter('8082059840675302216');" onmouseout="out('8082059840675302216');" style="">  45      public static final String CREATION_DATE_PROPERTY = &quot;creationDate&quot;;                                           </span>
<span class="-4622628390272251051" onmouseenter="enter('-4622628390272251051');" onmouseout="out('-4622628390272251051');" style="">  46      public static final String MODIFICATION_DATE_PROPERTY = &quot;modificationDate&quot;;                                   </span>
<span class="-2614611438740057503" onmouseenter="enter('-2614611438740057503');" onmouseout="out('-2614611438740057503');" style="">  47      public static final String SHARE_URL_PROPERTY = &quot;shareURL&quot;;                                                   </span>
<span class="1336476452932138514" onmouseenter="enter('1336476452932138514');" onmouseout="out('1336476452932138514');" style="">  48      public static final String PUBLISH_URL_PROPERTY = &quot;publishURL&quot;;                                               </span>
<span class="-813041889408259553" onmouseenter="enter('-813041889408259553');" onmouseout="out('-813041889408259553');" style="">  49      public static final String DELETED_PROPERTY = &quot;deleted&quot;;                                                      </span>
<span class="4804610397042036134" onmouseenter="enter('4804610397042036134');" onmouseout="out('4804610397042036134');" style="">  50      public static final String TITLE_INDEX_NAME = &quot;title&quot;;                                                        </span>
<span class="941632753921114575" onmouseenter="enter('941632753921114575');" onmouseout="out('941632753921114575');" style="">  51      public static final String CONTENT_PREVIEW_INDEX_NAME = &quot;contentPreview&quot;;                                     </span>
<span class="4601116861733775409" onmouseenter="enter('4601116861733775409');" onmouseout="out('4601116861733775409');" style="">  52      public static final String PINNED_INDEX_NAME = &quot;pinned&quot;;                                                      </span>
<span class="-5028217336186587547" onmouseenter="enter('-5028217336186587547');" onmouseout="out('-5028217336186587547');" style="">  53      public static final String MODIFIED_INDEX_NAME = &quot;modified&quot;;                                                  </span>
<span class="-2754009865833796434" onmouseenter="enter('-2754009865833796434');" onmouseout="out('-2754009865833796434');" style="">  54      public static final String CREATED_INDEX_NAME = &quot;created&quot;;                                                    </span>
<span class="-620094810998015131" onmouseenter="enter('-620094810998015131');" onmouseout="out('-620094810998015131');" style="">  55      public static final String MATCHED_TITLE_INDEX_NAME = &quot;matchedTitle&quot;;                                         </span>
<span class="5961311022296185233" onmouseenter="enter('5961311022296185233');" onmouseout="out('5961311022296185233');" style="">  56      public static final String MATCHED_CONTENT_INDEX_NAME = &quot;matchedContent&quot;;                                     </span>
<span class="354077366863542774" onmouseenter="enter('354077366863542774');" onmouseout="out('354077366863542774');" style="">  57      public static final String PUBLISH_URL = &quot;http://simp.ly/p/&quot;;                                                 </span>
<span class="2475488422216258991" onmouseenter="enter('2475488422216258991');" onmouseout="out('2475488422216258991');" style="">  58      static public final String[] FULL_TEXT_INDEXES = new String[]{                                                </span>
<span class="394877313876947494" onmouseenter="enter('394877313876947494');" onmouseout="out('394877313876947494');" style="">  59              Note.TITLE_INDEX_NAME, Note.CONTENT_PROPERTY};                                                        </span>
<span class="-4178348678314657322" onmouseenter="enter('-4178348678314657322');" onmouseout="out('-4178348678314657322');" style="">  60      private static final String BLANK_CONTENT = &quot;&quot;;                                                               </span>
<span class="-8217848203306725764" onmouseenter="enter('-8217848203306725764');" onmouseout="out('-8217848203306725764');" style="">  61      private static final String SPACE = &quot; &quot;;                                                                      </span>
<span class="7999038666256371202" onmouseenter="enter('7999038666256371202');" onmouseout="out('7999038666256371202');" style="">  62      private static final int MAX_PREVIEW_CHARS = 300;                                                             </span>
<span class="6617027899127222559" onmouseenter="enter('6617027899127222559');" onmouseout="out('6617027899127222559');" style="">  63      protected String mTitle = null;                                                                               </span>
<span class="-1758175371106332326" onmouseenter="enter('-1758175371106332326');" onmouseout="out('-1758175371106332326');" style="">  64      protected String mContentPreview = null;                                                                      </span>
<span  style="">  65                                                                                                                    </span>



<span  style="">  66                                                                                                                    </span>
<span class="767263449852825375" onmouseenter="enter('767263449852825375');" onmouseout="out('767263449852825375');" style="">  67      public Note(String key) {                                                                                     </span>
<span class="-8964647538928034033" onmouseenter="enter('-8964647538928034033');" onmouseout="out('-8964647538928034033');" style="">  68          super(key, new JSONObject());                                                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69      }                                                                                                             </span>
<span  style="">  70                                                                                                                    </span>
<span class="8617384997772879313" onmouseenter="enter('8617384997772879313');" onmouseout="out('8617384997772879313');" style="">  71      public Note(String key, JSONObject properties) {                                                              </span>
<span class="-6821486208075908487" onmouseenter="enter('-6821486208075908487');" onmouseout="out('-6821486208075908487');" style="">  72          super(key, properties);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73      }                                                                                                             </span>
<span  style="">  74                                                                                                                    </span>
<span class="458900878223274025" onmouseenter="enter('458900878223274025');" onmouseout="out('458900878223274025');" style="">  75      public static Query&lt;Note&gt; all(Bucket&lt;Note&gt; noteBucket) {                                                      </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  76          return noteBucket.query()                                                                                 </span>
<span class="-6142536283945774731" onmouseenter="enter('-6142536283945774731');" onmouseout="out('-6142536283945774731');" style="">  77                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78      }                                                                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="-6525045200709488349" onmouseenter="enter('-6525045200709488349');" onmouseout="out('-6525045200709488349');" style="">  80      public static Query&lt;Note&gt; allDeleted(Bucket&lt;Note&gt; noteBucket) {                                               </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  81          return noteBucket.query()                                                                                 </span>
<span class="-6326653849445488397" onmouseenter="enter('-6326653849445488397');" onmouseout="out('-6326653849445488397');" style="">  82                  .where(DELETED_PROPERTY, ComparisonType.EQUAL_TO, true);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83      }                                                                                                             </span>
<span  style="">  84                                                                                                                    </span>
<span class="4789545620535823187" onmouseenter="enter('4789545620535823187');" onmouseout="out('4789545620535823187');" style="">  85      public static Query&lt;Note&gt; search(Bucket&lt;Note&gt; noteBucket, String searchString) {                              </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  86          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  87                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="-8956541673379552524" onmouseenter="enter('-8956541673379552524');" onmouseout="out('-8956541673379552524');" style="">  88                  .where(CONTENT_PROPERTY, ComparisonType.LIKE, &quot;%&quot; + searchString + &quot;%&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="-1229245405128052241" onmouseenter="enter('-1229245405128052241');" onmouseout="out('-1229245405128052241');" style="">  91      public static Query&lt;Note&gt; allInTag(Bucket&lt;Note&gt; noteBucket, String tag) {                                     </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  92          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  93                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="-2207133284802963072" onmouseenter="enter('-2207133284802963072');" onmouseout="out('-2207133284802963072');" style="">  94                  .where(TAGS_PROPERTY, ComparisonType.LIKE, tag);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95      }                                                                                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="2971412545726517521" onmouseenter="enter('2971412545726517521');" onmouseout="out('2971412545726517521');" style="">  97      public static Query&lt;Note&gt; allWithNoTag(Bucket&lt;Note&gt; noteBucket) {                                             </span>
<span class="1591072370690947187" onmouseenter="enter('1591072370690947187');" onmouseout="out('1591072370690947187');" style="">  98          return noteBucket.query()                                                                                 </span>
<span class="-5615557647224699056" onmouseenter="enter('-5615557647224699056');" onmouseout="out('-5615557647224699056');" style="">  99                  .where(DELETED_PROPERTY, ComparisonType.NOT_EQUAL_TO, true)                                       </span>
<span class="6567927526378864260" onmouseenter="enter('6567927526378864260');" onmouseout="out('6567927526378864260');" style=""> 100                  .where(TAGS_PROPERTY, ComparisonType.EQUAL_TO, null);                                             </span>





















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101      }                                                                                                             </span>
<span  style=""> 102                                                                                                                    </span>
<span class="-5517811679430868458" onmouseenter="enter('-5517811679430868458');" onmouseout="out('-5517811679430868458');" style=""> 103      @SuppressWarnings(&quot;unused&quot;)                                                                                   </span>
<span class="-4700657283235731904" onmouseenter="enter('-4700657283235731904');" onmouseout="out('-4700657283235731904');" style=""> 104      public static String dateString(Number time, boolean useShortFormat, Context context) {                       </span>
<span class="1180405838137731219" onmouseenter="enter('1180405838137731219');" onmouseout="out('1180405838137731219');" style=""> 105          Calendar c = numberToDate(time);                                                                          </span>
<span class="-7277187246954612403" onmouseenter="enter('-7277187246954612403');" onmouseout="out('-7277187246954612403');" style=""> 106          return dateString(c, useShortFormat, context);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107      }                                                                                                             </span>
<span  style=""> 108                                                                                                                    </span>
<span class="-8567197073889182513" onmouseenter="enter('-8567197073889182513');" onmouseout="out('-8567197073889182513');" style=""> 109      public static String dateString(Calendar c, boolean useShortFormat, Context context) {                        </span>
<span class="-4601601397388656558" onmouseenter="enter('-4601601397388656558');" onmouseout="out('-4601601397388656558');" style=""> 110          int year, month, day;                                                                                     </span>
<span  style=""> 111                                                                                                                    </span>
<span class="-7517224838183820978" onmouseenter="enter('-7517224838183820978');" onmouseout="out('-7517224838183820978');" style=""> 112          String time, date, retVal;                                                                                </span>
<span  style=""> 113                                                                                                                    </span>
<span class="-7023974272217551721" onmouseenter="enter('-7023974272217551721');" onmouseout="out('-7023974272217551721');" style=""> 114          Calendar diff = Calendar.getInstance();                                                                   </span>
<span class="7346751312817051138" onmouseenter="enter('7346751312817051138');" onmouseout="out('7346751312817051138');" style=""> 115          diff.setTimeInMillis(diff.getTimeInMillis() - c.getTimeInMillis());                                       </span>
<span  style=""> 116                                                                                                                    </span>
<span class="-2909064038838300707" onmouseenter="enter('-2909064038838300707');" onmouseout="out('-2909064038838300707');" style=""> 117          year = diff.get(Calendar.YEAR);                                                                           </span>
<span class="-5868815277479911950" onmouseenter="enter('-5868815277479911950');" onmouseout="out('-5868815277479911950');" style=""> 118          month = diff.get(Calendar.MONTH);                                                                         </span>
<span class="-2637536938238774465" onmouseenter="enter('-2637536938238774465');" onmouseout="out('-2637536938238774465');" style=""> 119          day = diff.get(Calendar.DAY_OF_MONTH);                                                                    </span>
<span  style=""> 120                                                                                                                    </span>
<span class="1536424719044438994" onmouseenter="enter('1536424719044438994');" onmouseout="out('1536424719044438994');" style=""> 121          diff.setTimeInMillis(0); // starting time                                                                 </span>
<span class="-779753610725741249" onmouseenter="enter('-779753610725741249');" onmouseout="out('-779753610725741249');" style=""> 122          time = DateFormat.getTimeInstance(DateFormat.SHORT).format(c.getTime());                                  </span>
<span class="-2383141111479093557" onmouseenter="enter('-2383141111479093557');" onmouseout="out('-2383141111479093557');" style=""><abbr title=" 123          if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.DAY_OF_MONTH))) {"> 123          if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == diff.get(Calendar.🔵</abbr></span>
<span class="7635099361720652074" onmouseenter="enter('7635099361720652074');" onmouseout="out('7635099361720652074');" style=""> 124              date = context.getResources().getString(R.string.today);                                              </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 125              if (useShortFormat)                                                                                   </span>
<span class="597955899566079772" onmouseenter="enter('597955899566079772');" onmouseout="out('597955899566079772');" style=""> 126                  retVal = time;                                                                                    </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 127              else                                                                                                  </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 128                  retVal = date + &quot;, &quot; + time;                                                                      </span>
<span class="-818230175523660822" onmouseenter="enter('-818230175523660822');" onmouseout="out('-818230175523660822');" style=""> 129          } else if ((year == diff.get(Calendar.YEAR)) &amp;&amp; (month == diff.get(Calendar.MONTH)) &amp;&amp; (day == 1)) {      </span>
<span class="-8420997342841621789" onmouseenter="enter('-8420997342841621789');" onmouseout="out('-8420997342841621789');" style=""> 130              date = context.getResources().getString(R.string.yesterday);                                          </span>
<span class="8493899913340733835" onmouseenter="enter('8493899913340733835');" onmouseout="out('8493899913340733835');" style=""> 131              if (useShortFormat)                                                                                   </span>
<span class="8381191313867632389" onmouseenter="enter('8381191313867632389');" onmouseout="out('8381191313867632389');" style=""> 132                  retVal = date;                                                                                    </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 133              else                                                                                                  </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 134                  retVal = date + &quot;, &quot; + time;                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 135          } else {                                                                                                  </span>
<span class="-8110415762919125838" onmouseenter="enter('-8110415762919125838');" onmouseout="out('-8110415762919125838');" style=""> 136              date = new SimpleDateFormat(&quot;MMM dd&quot;, Locale.US).format(c.getTime());                                 </span>
<span class="-1890689043550180813" onmouseenter="enter('-1890689043550180813');" onmouseout="out('-1890689043550180813');" style=""> 137              retVal = date + &quot;, &quot; + time;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138          }                                                                                                         </span>
<span  style=""> 139                                                                                                                    </span>
<span class="-2448447535460405943" onmouseenter="enter('-2448447535460405943');" onmouseout="out('-2448447535460405943');" style=""> 140          return retVal;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141      }                                                                                                             </span>
<span  style=""> 142                                                                                                                    </span>
<span class="-1889536418011186938" onmouseenter="enter('-1889536418011186938');" onmouseout="out('-1889536418011186938');" style=""> 143      private static int getReferenceCount(String key, String content) {                                            </span>
<span class="-666706993090019623" onmouseenter="enter('-666706993090019623');" onmouseout="out('-666706993090019623');" style=""> 144          Pattern pattern = Pattern.compile(SIMPLENOTE_LINK_PREFIX + key);                                          </span>
<span class="-5723325120560414069" onmouseenter="enter('-5723325120560414069');" onmouseout="out('-5723325120560414069');" style=""> 145          Matcher matcher = pattern.matcher(content);                                                               </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 146          int count = 0;                                                                                            </span>
<span  style=""> 147                                                                                                                    </span>
<span class="-5488916631119752457" onmouseenter="enter('-5488916631119752457');" onmouseout="out('-5488916631119752457');" style=""> 148          while (matcher.find()) {                                                                                  </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style=""> 149              count++;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150          }                                                                                                         </span>
<span  style=""> 151                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 152          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153      }                                                                                                             </span>
<span  style=""> 154                                                                                                                    </span>
<span class="-3902014892596708789" onmouseenter="enter('-3902014892596708789');" onmouseout="out('-3902014892596708789');" style=""> 155      public static List&lt;Reference&gt; getReferences(Bucket&lt;Note&gt; bucket, String key) {                                </span>
<span class="-6029684357073269481" onmouseenter="enter('-6029684357073269481');" onmouseout="out('-6029684357073269481');" style=""> 156          List&lt;Reference&gt; references = new ArrayList&lt;&gt;();                                                           </span>
<span class="-4658611266183475458" onmouseenter="enter('-4658611266183475458');" onmouseout="out('-4658611266183475458');" style=""> 157          Bucket.ObjectCursor&lt;Note&gt; cursor = Note.search(bucket, SIMPLENOTE_LINK_PREFIX + key).execute();           </span>
<span  style=""> 158                                                                                                                    </span>
<span class="-679463407698125917" onmouseenter="enter('-679463407698125917');" onmouseout="out('-679463407698125917');" style=""> 159          while (cursor.moveToNext()) {                                                                             </span>
<span class="3501306350092034788" onmouseenter="enter('3501306350092034788');" onmouseout="out('3501306350092034788');" style=""> 160              Note note = cursor.getObject();                                                                       </span>
<span class="-4285952824793620055" onmouseenter="enter('-4285952824793620055');" onmouseout="out('-4285952824793620055');" style=""> 161              references.add(                                                                                       </span>
<span class="-1411633905067872974" onmouseenter="enter('-1411633905067872974');" onmouseout="out('-1411633905067872974');" style=""> 162                  new Reference(                                                                                    </span>
<span class="-3110909059350189445" onmouseenter="enter('-3110909059350189445');" onmouseout="out('-3110909059350189445');" style=""> 163                      note.getSimperiumKey(),                                                                       </span>
<span class="2543604805982207984" onmouseenter="enter('2543604805982207984');" onmouseout="out('2543604805982207984');" style=""> 164                      note.getTitle(),                                                                              </span>
<span class="7904695514627173906" onmouseenter="enter('7904695514627173906');" onmouseout="out('7904695514627173906');" style=""> 165                      note.getModificationDate(),                                                                   </span>
<span class="5299483559431490396" onmouseenter="enter('5299483559431490396');" onmouseout="out('5299483559431490396');" style=""> 166                      getReferenceCount(key, note.getContent())                                                     </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 167                  )                                                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 168              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169          }                                                                                                         </span>
<span  style=""> 170                                                                                                                    </span>
<span class="-816749515151999705" onmouseenter="enter('-816749515151999705');" onmouseout="out('-816749515151999705');" style=""> 171          return references;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172      }                                                                                                             </span>
<span  style=""> 173                                                                                                                    </span>
<span class="6991191424901834769" onmouseenter="enter('6991191424901834769');" onmouseout="out('6991191424901834769');" style=""> 174      public static Calendar numberToDate(Number time) {                                                            </span>
<span class="2627151998164378009" onmouseenter="enter('2627151998164378009');" onmouseout="out('2627151998164378009');" style=""> 175          Calendar date = Calendar.getInstance();                                                                   </span>
<span class="-4794582782203016972" onmouseenter="enter('-4794582782203016972');" onmouseout="out('-4794582782203016972');" style=""> 176          if (time != null) {                                                                                       </span>
<span class="-3733626690602126121" onmouseenter="enter('-3733626690602126121');" onmouseout="out('-3733626690602126121');" style=""> 177              // Flick Note uses millisecond resolution timestamps Simplenote expects seconds                       </span>
<span class="3026137703351918876" onmouseenter="enter('3026137703351918876');" onmouseout="out('3026137703351918876');" style=""> 178              // since we only deal with create and modify timestamps, they should all have occurred                </span>
<span class="-9197945245707351438" onmouseenter="enter('-9197945245707351438');" onmouseout="out('-9197945245707351438');" style=""> 179              // at the present time or in the past.                                                                </span>
<span class="-5330372272438133634" onmouseenter="enter('-5330372272438133634');" onmouseout="out('-5330372272438133634');" style=""> 180              float now = (float) date.getTimeInMillis() / 1000;                                                    </span>
<span class="7868403810214452697" onmouseenter="enter('7868403810214452697');" onmouseout="out('7868403810214452697');" style=""> 181              float magnitude = time.floatValue() / now;                                                            </span>
<span class="5909991427144614543" onmouseenter="enter('5909991427144614543');" onmouseout="out('5909991427144614543');" style=""> 182              if (magnitude &gt;= 2.f) time = time.longValue() / 1000;                                                 </span>
<span class="2284249078526717288" onmouseenter="enter('2284249078526717288');" onmouseout="out('2284249078526717288');" style=""> 183              date.setTimeInMillis(time.longValue() * 1000);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184          }                                                                                                         </span>
<span class="7179427650659377170" onmouseenter="enter('7179427650659377170');" onmouseout="out('7179427650659377170');" style=""> 185          return date;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="466463869222866851" onmouseenter="enter('466463869222866851');" onmouseout="out('466463869222866851');" style=""> 188      public static String numberToDateString(@NonNull Number number) {                                             </span>
<span class="-4090451846849985785" onmouseenter="enter('-4090451846849985785');" onmouseout="out('-4090451846849985785');" style=""> 189          long milliseconds = new BigDecimal(number.toString()).multiply(new BigDecimal(1000)).longValue();         </span>
<span class="2239009023688190143" onmouseenter="enter('2239009023688190143');" onmouseout="out('2239009023688190143');" style=""> 190          Calendar calendar = Calendar.getInstance();                                                               </span>
<span class="9071902319976922096" onmouseenter="enter('9071902319976922096');" onmouseout="out('9071902319976922096');" style=""> 191          calendar.setTimeInMillis(milliseconds);                                                                   </span>
<span class="-1960866814541712569" onmouseenter="enter('-1960866814541712569');" onmouseout="out('-1960866814541712569');" style=""> 192          SimpleDateFormat date = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSS&#x27;Z&#x27;&quot;, Locale.US);                  </span>
<span class="1592748650922216684" onmouseenter="enter('1592748650922216684');" onmouseout="out('1592748650922216684');" style=""> 193          date.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));                                                            </span>
<span class="5827364706871365292" onmouseenter="enter('5827364706871365292');" onmouseout="out('5827364706871365292');" style=""> 194          return date.format(calendar.getTime());                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="6373335669519535085" onmouseenter="enter('6373335669519535085');" onmouseout="out('6373335669519535085');" style=""> 197      protected void updateTitleAndPreview() {                                                                      </span>
<span class="4716811977187622861" onmouseenter="enter('4716811977187622861');" onmouseout="out('4716811977187622861');" style=""> 198          // try to build a title and preview property out of content                                               </span>
<span class="-6823550475843248983" onmouseenter="enter('-6823550475843248983');" onmouseout="out('-6823550475843248983');" style=""> 199          String content = getContent().trim();                                                                     </span>
<span class="327463840444924073" onmouseenter="enter('327463840444924073');" onmouseout="out('327463840444924073');" style=""> 200          if (content.length() &gt; MAX_PREVIEW_CHARS) {                                                               </span>
<span class="-8480236902805956072" onmouseenter="enter('-8480236902805956072');" onmouseout="out('-8480236902805956072');" style=""> 201              content = content.substring(0, MAX_PREVIEW_CHARS - 1);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202          }                                                                                                         </span>
<span  style=""> 203                                                                                                                    </span>
<span class="5724017298410569034" onmouseenter="enter('5724017298410569034');" onmouseout="out('5724017298410569034');" style=""> 204          int firstNewLinePosition = content.indexOf(NEW_LINE);                                                     </span>
<span class="7786689878958261573" onmouseenter="enter('7786689878958261573');" onmouseout="out('7786689878958261573');" style=""> 205          if (firstNewLinePosition &gt; -1 &amp;&amp; firstNewLinePosition &lt; 200) {                                            </span>
<span class="-397121944761876346" onmouseenter="enter('-397121944761876346');" onmouseout="out('-397121944761876346');" style=""> 206              mTitle = content.substring(0, firstNewLinePosition).trim();                                           </span>
<span  style=""> 207                                                                                                                    </span>
<span class="6552686713144756852" onmouseenter="enter('6552686713144756852');" onmouseout="out('6552686713144756852');" style=""> 208              if (firstNewLinePosition &lt; content.length()) {                                                        </span>
<span class="3544130446617579720" onmouseenter="enter('3544130446617579720');" onmouseout="out('3544130446617579720');" style=""> 209                  mContentPreview = content.substring(firstNewLinePosition, content.length());                      </span>
<span class="-6018298786369494309" onmouseenter="enter('-6018298786369494309');" onmouseout="out('-6018298786369494309');" style=""> 210                  mContentPreview = mContentPreview.replace(NEW_LINE, SPACE).replace(SPACE + SPACE, SPACE).trim();  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 211              } else {                                                                                              </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 212                  mContentPreview = content;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 214          } else {                                                                                                  </span>
<span class="6158164289681498296" onmouseenter="enter('6158164289681498296');" onmouseout="out('6158164289681498296');" style=""> 215              mTitle = content;                                                                                     </span>
<span class="1516017085770072130" onmouseenter="enter('1516017085770072130');" onmouseout="out('1516017085770072130');" style=""> 216              mContentPreview = content;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218      }                                                                                                             </span>
<span  style=""> 219                                                                                                                    </span>
<span class="-6200437978572139135" onmouseenter="enter('-6200437978572139135');" onmouseout="out('-6200437978572139135');" style=""> 220      public String getTitle() {                                                                                    </span>
<span class="5880156293984643419" onmouseenter="enter('5880156293984643419');" onmouseout="out('5880156293984643419');" style=""> 221          if (mTitle == null) {                                                                                     </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 222              updateTitleAndPreview();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223          }                                                                                                         </span>
<span class="-7721657982940010876" onmouseenter="enter('-7721657982940010876');" onmouseout="out('-7721657982940010876');" style=""> 224          return mTitle;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225      }                                                                                                             </span>
<span  style=""> 226                                                                                                                    </span>
<span class="-2689785139225953203" onmouseenter="enter('-2689785139225953203');" onmouseout="out('-2689785139225953203');" style=""> 227      public String getContent() {                                                                                  </span>
<span class="-593492380737036583" onmouseenter="enter('-593492380737036583');" onmouseout="out('-593492380737036583');" style=""> 228          Object content = getProperty(CONTENT_PROPERTY);                                                           </span>
<span class="-2591100211143552235" onmouseenter="enter('-2591100211143552235');" onmouseout="out('-2591100211143552235');" style=""> 229          if (content == null) {                                                                                    </span>
<span class="-7439137145129124014" onmouseenter="enter('-7439137145129124014');" onmouseout="out('-7439137145129124014');" style=""> 230              return BLANK_CONTENT;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231          }                                                                                                         </span>
<span class="-5104065841615841974" onmouseenter="enter('-5104065841615841974');" onmouseout="out('-5104065841615841974');" style=""> 232          return (String) content;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233      }                                                                                                             </span>
<span  style=""> 234                                                                                                                    </span>
<span class="8530044186661736565" onmouseenter="enter('8530044186661736565');" onmouseout="out('8530044186661736565');" style=""> 235      public void setContent(String content) {                                                                      </span>
<span class="6017523628383929627" onmouseenter="enter('6017523628383929627');" onmouseout="out('6017523628383929627');" style=""> 236          mTitle = null;                                                                                            </span>
<span class="7468898004511818931" onmouseenter="enter('7468898004511818931');" onmouseout="out('7468898004511818931');" style=""> 237          mContentPreview = null;                                                                                   </span>
<span class="-7075313288269577686" onmouseenter="enter('-7075313288269577686');" onmouseout="out('-7075313288269577686');" style=""> 238          setProperty(CONTENT_PROPERTY, content);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239      }                                                                                                             </span>
<span  style=""> 240                                                                                                                    </span>
<span class="-3177715860988830633" onmouseenter="enter('-3177715860988830633');" onmouseout="out('-3177715860988830633');" style=""> 241      public String getContentPreview() {                                                                           </span>
<span class="-8081599038098376119" onmouseenter="enter('-8081599038098376119');" onmouseout="out('-8081599038098376119');" style=""> 242          if (mContentPreview == null) {                                                                            </span>
<span class="-2998280411651081682" onmouseenter="enter('-2998280411651081682');" onmouseout="out('-2998280411651081682');" style=""> 243              updateTitleAndPreview();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244          }                                                                                                         </span>
<span class="-7686656279835722897" onmouseenter="enter('-7686656279835722897');" onmouseout="out('-7686656279835722897');" style=""> 245          return mContentPreview;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-4775876413201063426" onmouseenter="enter('-4775876413201063426');" onmouseout="out('-4775876413201063426');" style=""> 248      public Calendar getCreationDate() {                                                                           </span>
<span class="-8932394895206293128" onmouseenter="enter('-8932394895206293128');" onmouseout="out('-8932394895206293128');" style=""> 249          return numberToDate((Number) getProperty(CREATION_DATE_PROPERTY));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250      }                                                                                                             </span>
<span  style=""> 251                                                                                                                    </span>
<span class="3941971105481464917" onmouseenter="enter('3941971105481464917');" onmouseout="out('3941971105481464917');" style=""> 252      public String getCreationDateString() {                                                                       </span>
<span class="9031070846992233121" onmouseenter="enter('9031070846992233121');" onmouseout="out('9031070846992233121');" style=""> 253          return numberToDateString((Number) getProperty(CREATION_DATE_PROPERTY));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254      }                                                                                                             </span>
<span  style=""> 255                                                                                                                    </span>
<span class="4285319693858833712" onmouseenter="enter('4285319693858833712');" onmouseout="out('4285319693858833712');" style=""> 256      public void setCreationDate(Calendar creationDate) {                                                          </span>
<span class="-3054849024529806025" onmouseenter="enter('-3054849024529806025');" onmouseout="out('-3054849024529806025');" style=""> 257          setProperty(CREATION_DATE_PROPERTY, creationDate.getTimeInMillis() / 1000);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258      }                                                                                                             </span>
<span  style=""> 259                                                                                                                    </span>
<span class="4524335170961506892" onmouseenter="enter('4524335170961506892');" onmouseout="out('4524335170961506892');" style=""> 260      public Calendar getModificationDate() {                                                                       </span>
<span class="-7489834958201786921" onmouseenter="enter('-7489834958201786921');" onmouseout="out('-7489834958201786921');" style=""> 261          return numberToDate((Number) getProperty(MODIFICATION_DATE_PROPERTY));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262      }                                                                                                             </span>
<span  style=""> 263                                                                                                                    </span>
<span class="8706492949654452164" onmouseenter="enter('8706492949654452164');" onmouseout="out('8706492949654452164');" style=""> 264      public String getModificationDateString() {                                                                   </span>
<span class="-2749496034468843218" onmouseenter="enter('-2749496034468843218');" onmouseout="out('-2749496034468843218');" style=""> 265          return numberToDateString((Number) getProperty(MODIFICATION_DATE_PROPERTY));                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266      }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="2249083984085470814" onmouseenter="enter('2249083984085470814');" onmouseout="out('2249083984085470814');" style=""> 268      public void setModificationDate(Calendar modificationDate) {                                                  </span>
<span class="-7005792304358284877" onmouseenter="enter('-7005792304358284877');" onmouseout="out('-7005792304358284877');" style=""> 269          setProperty(MODIFICATION_DATE_PROPERTY, modificationDate.getTimeInMillis() / 1000);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270      }                                                                                                             </span>
<span  style=""> 271                                                                                                                    </span>
<span class="3367289575484325214" onmouseenter="enter('3367289575484325214');" onmouseout="out('3367289575484325214');" style=""> 272      public String getPublishedUrl() {                                                                             </span>
<span class="-5796973306134907482" onmouseenter="enter('-5796973306134907482');" onmouseout="out('-5796973306134907482');" style=""> 273          String urlCode = (String) getProperty(PUBLISH_URL_PROPERTY);                                              </span>
<span class="7900565639772953850" onmouseenter="enter('7900565639772953850');" onmouseout="out('7900565639772953850');" style=""> 274          if (TextUtils.isEmpty(urlCode)) {                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 275              return &quot;&quot;;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276          }                                                                                                         </span>
<span  style=""> 277                                                                                                                    </span>
<span class="-8429126260993259062" onmouseenter="enter('-8429126260993259062');" onmouseout="out('-8429126260993259062');" style=""> 278          return PUBLISH_URL + urlCode;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279      }                                                                                                             </span>
<span  style=""> 280                                                                                                                    </span>
<span class="6727514612417725571" onmouseenter="enter('6727514612417725571');" onmouseout="out('6727514612417725571');" style=""> 281      public boolean hasTag(String tag) {                                                                           </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 282          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-3541717492710720609" onmouseenter="enter('-3541717492710720609');" onmouseout="out('-3541717492710720609');" style=""> 283          String tagLower = tag.toLowerCase();                                                                      </span>
<span class="-422766749461737265" onmouseenter="enter('-422766749461737265');" onmouseout="out('-422766749461737265');" style=""> 284          for (String tagName : tags) {                                                                             </span>
<span class="-6783003514598399026" onmouseenter="enter('-6783003514598399026');" onmouseout="out('-6783003514598399026');" style=""> 285              if (tagLower.equals(tagName.toLowerCase())) return true;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 287          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288      }                                                                                                             </span>
<span  style=""> 289                                                                                                                    </span>
<span class="1303119083327749335" onmouseenter="enter('1303119083327749335');" onmouseout="out('1303119083327749335');" style=""> 290      public boolean hasTag(Tag tag) {                                                                              </span>
<span class="-5268388303991583458" onmouseenter="enter('-5268388303991583458');" onmouseout="out('-5268388303991583458');" style=""> 291          return hasTag(tag.getSimperiumKey());                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292      }                                                                                                             </span>
<span  style=""> 293                                                                                                                    </span>
<span class="-646587723470162813" onmouseenter="enter('-646587723470162813');" onmouseout="out('-646587723470162813');" style=""> 294      public List&lt;String&gt; getTags() {                                                                               </span>
<span  style=""> 295                                                                                                                    </span>
<span class="5046858882238824028" onmouseenter="enter('5046858882238824028');" onmouseout="out('5046858882238824028');" style=""> 296          JSONArray tags = (JSONArray) getProperty(TAGS_PROPERTY);                                                  </span>
<span  style=""> 297                                                                                                                    </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 298          if (tags == null) {                                                                                       </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 299              tags = new JSONArray();                                                                               </span>
<span class="-8058083631026170990" onmouseenter="enter('-8058083631026170990');" onmouseout="out('-8058083631026170990');" style=""> 300              setProperty(TAGS_PROPERTY, &quot;&quot;);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301          }                                                                                                         </span>
<span  style=""> 302                                                                                                                    </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 303          int length = tags.length();                                                                               </span>
<span  style=""> 304                                                                                                                    </span>
<span class="-7737950325994950460" onmouseenter="enter('-7737950325994950460');" onmouseout="out('-7737950325994950460');" style=""> 305          List&lt;String&gt; tagList = new ArrayList&lt;&gt;(length);                                                           </span>
<span  style=""> 306                                                                                                                    </span>
<span class="8256074331736484026" onmouseenter="enter('8256074331736484026');" onmouseout="out('8256074331736484026');" style=""> 307          if (length == 0) return tagList;                                                                          </span>
<span  style=""> 308                                                                                                                    </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 309          for (int i = 0; i &lt; length; i++) {                                                                        </span>
<span class="-8917993594954591540" onmouseenter="enter('-8917993594954591540');" onmouseout="out('-8917993594954591540');" style=""> 310              String tag = tags.optString(i);                                                                       </span>
<span class="-1947204619891178088" onmouseenter="enter('-1947204619891178088');" onmouseout="out('-1947204619891178088');" style=""> 311              if (!tag.equals(&quot;&quot;))                                                                                  </span>
<span class="2557583924535716267" onmouseenter="enter('2557583924535716267');" onmouseout="out('2557583924535716267');" style=""> 312                  tagList.add(tag);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313          }                                                                                                         </span>
<span  style=""> 314                                                                                                                    </span>
<span class="-3183448331203603949" onmouseenter="enter('-3183448331203603949');" onmouseout="out('-3183448331203603949');" style=""> 315          return tagList;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316      }                                                                                                             </span>
<span  style=""> 317                                                                                                                    </span>










<span class="-6026710755135647724" onmouseenter="enter('-6026710755135647724');" onmouseout="out('-6026710755135647724');" style=""> 318      public void setTags(List&lt;String&gt; tags) {                                                                      </span>
<span class="-8982714688054322872" onmouseenter="enter('-8982714688054322872');" onmouseout="out('-8982714688054322872');" style=""> 319          setProperty(TAGS_PROPERTY, new JSONArray(tags));                                                          </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span  style=""> 321                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 322      /**                                                                                                           </span>
<span class="2568101064766040631" onmouseenter="enter('2568101064766040631');" onmouseout="out('2568101064766040631');" style=""> 323       * String of tags delimited by a space                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 324       */                                                                                                           </span>
<span class="-8942719802141200658" onmouseenter="enter('-8942719802141200658');" onmouseout="out('-8942719802141200658');" style=""> 325      public CharSequence getTagString() {                                                                          </span>
<span class="-4644025499612109112" onmouseenter="enter('-4644025499612109112');" onmouseout="out('-4644025499612109112');" style=""> 326          StringBuilder tagString = new StringBuilder();                                                            </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 327          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-7185531782033852210" onmouseenter="enter('-7185531782033852210');" onmouseout="out('-7185531782033852210');" style=""> 328          for (String tag : tags) {                                                                                 </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 329              if (tagString.length() &gt; 0) {                                                                         </span>
<span class="-848655472163713161" onmouseenter="enter('-848655472163713161');" onmouseout="out('-848655472163713161');" style=""> 330                  tagString.append(SPACE);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331              }                                                                                                     </span>
<span class="3299521276937168474" onmouseenter="enter('3299521276937168474');" onmouseout="out('3299521276937168474');" style=""> 332              tagString.append(tag);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333          }                                                                                                         </span>
<span class="-3216397563367246452" onmouseenter="enter('-3216397563367246452');" onmouseout="out('-3216397563367246452');" style=""> 334          return tagString;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335      }                                                                                                             </span>
<span  style=""> 336                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 337      /**                                                                                                           </span>
<span class="516081738825732450" onmouseenter="enter('516081738825732450');" onmouseout="out('516081738825732450');" style=""> 338       * Sets the note&#x27;s tags by providing it with a {@link String} of space separated tags.                        </span>
<span class="-3361819639621639487" onmouseenter="enter('-3361819639621639487');" onmouseout="out('-3361819639621639487');" style=""> 339       * Filters out duplicate tags.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 340       *                                                                                                            </span>
<span class="-3621424951438819239" onmouseenter="enter('-3621424951438819239');" onmouseout="out('-3621424951438819239');" style=""> 341       * @param tagString a space delimited list of tags                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 342       */                                                                                                           </span>
<span class="-7562161399809710400" onmouseenter="enter('-7562161399809710400');" onmouseout="out('-7562161399809710400');" style=""> 343      public void setTagString(String tagString) {                                                                  </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style=""> 344          List&lt;String&gt; tags = getTags();                                                                            </span>
<span class="-8892740331038047380" onmouseenter="enter('-8892740331038047380');" onmouseout="out('-8892740331038047380');" style=""> 345          tags.clear();                                                                                             </span>
<span  style=""> 346                                                                                                                    </span>
<span class="7647632027089311583" onmouseenter="enter('7647632027089311583');" onmouseout="out('7647632027089311583');" style=""> 347          if (tagString == null) {                                                                                  </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 348              setTags(tags);                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 349              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350          }                                                                                                         </span>
<span  style=""> 351                                                                                                                    </span>
<span class="-6765712323396427098" onmouseenter="enter('-6765712323396427098');" onmouseout="out('-6765712323396427098');" style=""> 352          // Make sure string has a trailing space                                                                  </span>
<span class="3861570924678507302" onmouseenter="enter('3861570924678507302');" onmouseout="out('3861570924678507302');" style=""> 353          if (tagString.length() &gt; 1 &amp;&amp; !tagString.substring(tagString.length() - 1).equals(SPACE))                 </span>
<span class="-5113585973277465859" onmouseenter="enter('-5113585973277465859');" onmouseout="out('-5113585973277465859');" style=""> 354              tagString = tagString + SPACE;                                                                        </span>
<span class="5741128019150417186" onmouseenter="enter('5741128019150417186');" onmouseout="out('5741128019150417186');" style=""> 355          // for comparing case-insensitive strings, would like to find a way to                                    </span>
<span class="-5706726934096139867" onmouseenter="enter('-5706726934096139867');" onmouseout="out('-5706726934096139867');" style=""> 356          // do this without allocating a new list and strings                                                      </span>
<span class="5881300344958500433" onmouseenter="enter('5881300344958500433');" onmouseout="out('5881300344958500433');" style=""> 357          List&lt;String&gt; tagsUpperCase = new ArrayList&lt;&gt;();                                                           </span>
<span class="-8087573356169949002" onmouseenter="enter('-8087573356169949002');" onmouseout="out('-8087573356169949002');" style=""> 358          // remove all current tags                                                                                </span>
<span class="1170680636863075190" onmouseenter="enter('1170680636863075190');" onmouseout="out('1170680636863075190');" style=""> 359          int start = 0;                                                                                            </span>
<span class="2514405873256423103" onmouseenter="enter('2514405873256423103');" onmouseout="out('2514405873256423103');" style=""> 360          int next;                                                                                                 </span>
<span class="-8708428587370728232" onmouseenter="enter('-8708428587370728232');" onmouseout="out('-8708428587370728232');" style=""> 361          String possible;                                                                                          </span>
<span class="3545966998003531195" onmouseenter="enter('3545966998003531195');" onmouseout="out('3545966998003531195');" style=""> 362          String possibleUpperCase;                                                                                 </span>
<span class="-67055061468690966" onmouseenter="enter('-67055061468690966');" onmouseout="out('-67055061468690966');" style=""> 363          // search tag string for space characters and pull out individual tags                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 364          do {                                                                                                      </span>
<span class="539196990274646798" onmouseenter="enter('539196990274646798');" onmouseout="out('539196990274646798');" style=""> 365              next = tagString.indexOf(SPACE, start);                                                               </span>
<span class="7441993871510338947" onmouseenter="enter('7441993871510338947');" onmouseout="out('7441993871510338947');" style=""> 366              if (next &gt; start) {                                                                                   </span>
<span class="-6369978890856333437" onmouseenter="enter('-6369978890856333437');" onmouseout="out('-6369978890856333437');" style=""> 367                  possible = tagString.substring(start, next);                                                      </span>
<span class="40967178918958955" onmouseenter="enter('40967178918958955');" onmouseout="out('40967178918958955');" style=""> 368                  possibleUpperCase = possible.toUpperCase();                                                       </span>
<span class="-6789588636567169254" onmouseenter="enter('-6789588636567169254');" onmouseout="out('-6789588636567169254');" style=""> 369                  if (!possible.equals(SPACE) &amp;&amp; !tagsUpperCase.contains(possibleUpperCase)) {                      </span>
<span class="8107171034948128222" onmouseenter="enter('8107171034948128222');" onmouseout="out('8107171034948128222');" style=""> 370                      tagsUpperCase.add(possibleUpperCase);                                                         </span>
<span class="-3623952282264178458" onmouseenter="enter('-3623952282264178458');" onmouseout="out('-3623952282264178458');" style=""> 371                      tags.add(possible);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373              }                                                                                                     </span>
<span class="2598261311594212195" onmouseenter="enter('2598261311594212195');" onmouseout="out('2598261311594212195');" style=""> 374              start = next + 1;                                                                                     </span>
<span class="-8911857571695172425" onmouseenter="enter('-8911857571695172425');" onmouseout="out('-8911857571695172425');" style=""> 375          } while (next &gt; -1);                                                                                      </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style=""> 376          setTags(tags);                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377      }                                                                                                             </span>
<span  style=""> 378                                                                                                                    </span>
<span class="-2380080839978865436" onmouseenter="enter('-2380080839978865436');" onmouseout="out('-2380080839978865436');" style=""> 379      public JSONArray getSystemTags() {                                                                            </span>
<span class="1634689045753216867" onmouseenter="enter('1634689045753216867');" onmouseout="out('1634689045753216867');" style=""> 380          JSONArray tags = (JSONArray) getProperty(SYSTEM_TAGS_PROPERTY);                                           </span>
<span class="6531412736475233316" onmouseenter="enter('6531412736475233316');" onmouseout="out('6531412736475233316');" style=""> 381          if (tags == null) {                                                                                       </span>
<span class="9078710184173432610" onmouseenter="enter('9078710184173432610');" onmouseout="out('9078710184173432610');" style=""> 382              tags = new JSONArray();                                                                               </span>
<span class="8109738276011217421" onmouseenter="enter('8109738276011217421');" onmouseout="out('8109738276011217421');" style=""> 383              setProperty(SYSTEM_TAGS_PROPERTY, tags);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384          }                                                                                                         </span>
<span class="-7737333077028274174" onmouseenter="enter('-7737333077028274174');" onmouseout="out('-7737333077028274174');" style=""> 385          return tags;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386      }                                                                                                             </span>
<span  style=""> 387                                                                                                                    </span>
<span class="3090413247451101219" onmouseenter="enter('3090413247451101219');" onmouseout="out('3090413247451101219');" style=""> 388      public Boolean isDeleted() {                                                                                  </span>
<span class="7870299677279363320" onmouseenter="enter('7870299677279363320');" onmouseout="out('7870299677279363320');" style=""> 389          Object deleted = getProperty(DELETED_PROPERTY);                                                           </span>
<span class="3213349019391348934" onmouseenter="enter('3213349019391348934');" onmouseout="out('3213349019391348934');" style=""> 390          if (deleted == null) {                                                                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 391              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392          }                                                                                                         </span>
<span class="-8245820290182222148" onmouseenter="enter('-8245820290182222148');" onmouseout="out('-8245820290182222148');" style=""> 393          if (deleted instanceof Boolean) {                                                                         </span>
<span class="110137553981332086" onmouseenter="enter('110137553981332086');" onmouseout="out('110137553981332086');" style=""> 394              return (Boolean) deleted;                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 395          } else {                                                                                                  </span>
<span class="5495215667694299112" onmouseenter="enter('5495215667694299112');" onmouseout="out('5495215667694299112');" style=""> 396              // Simperium-iOS sets booleans as integer values (0 or 1)                                             </span>
<span class="2375816303299771461" onmouseenter="enter('2375816303299771461');" onmouseout="out('2375816303299771461');" style=""> 397              return deleted instanceof Number &amp;&amp; ((Number) deleted).intValue() != 0;                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399      }                                                                                                             </span>
<span  style=""> 400                                                                                                                    </span>
<span class="6912205177980332866" onmouseenter="enter('6912205177980332866');" onmouseout="out('6912205177980332866');" style=""> 401      public void setDeleted(boolean deleted) {                                                                     </span>
<span class="-864256626113761460" onmouseenter="enter('-864256626113761460');" onmouseout="out('-864256626113761460');" style=""> 402          setProperty(DELETED_PROPERTY, deleted);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403      }                                                                                                             </span>
<span  style=""> 404                                                                                                                    </span>
<span class="5985631777888601261" onmouseenter="enter('5985631777888601261');" onmouseout="out('5985631777888601261');" style=""> 405      public boolean isMarkdownEnabled() {                                                                          </span>
<span class="-5743540823315516839" onmouseenter="enter('-5743540823315516839');" onmouseout="out('-5743540823315516839');" style=""> 406          return hasSystemTag(MARKDOWN_TAG);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407      }                                                                                                             </span>
<span  style=""> 408                                                                                                                    </span>




<span class="-2232443542975324273" onmouseenter="enter('-2232443542975324273');" onmouseout="out('-2232443542975324273');" style=""> 409      public void setMarkdownEnabled(boolean isMarkdownEnabled) {                                                   </span>
<span class="5908341161553131781" onmouseenter="enter('5908341161553131781');" onmouseout="out('5908341161553131781');" style=""> 410          if (isMarkdownEnabled) {                                                                                  </span>
<span class="-7185185989369936008" onmouseenter="enter('-7185185989369936008');" onmouseout="out('-7185185989369936008');" style=""> 411              addSystemTag(MARKDOWN_TAG);                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 412          } else {                                                                                                  </span>
<span class="1430034125671484052" onmouseenter="enter('1430034125671484052');" onmouseout="out('1430034125671484052');" style=""> 413              removeSystemTag(MARKDOWN_TAG);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415      }                                                                                                             </span>
<span  style=""> 416                                                                                                                    </span>
<span class="-7992821206137485678" onmouseenter="enter('-7992821206137485678');" onmouseout="out('-7992821206137485678');" style=""> 417      public boolean isPinned() {                                                                                   </span>
<span class="7436893036029851482" onmouseenter="enter('7436893036029851482');" onmouseout="out('7436893036029851482');" style=""> 418          return hasSystemTag(PINNED_TAG);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419      }                                                                                                             </span>
<span  style=""> 420                                                                                                                    </span>
<span class="7137874092814138484" onmouseenter="enter('7137874092814138484');" onmouseout="out('7137874092814138484');" style=""> 421      public void setPinned(boolean isPinned) {                                                                     </span>
<span class="-8977010770732050857" onmouseenter="enter('-8977010770732050857');" onmouseout="out('-8977010770732050857');" style=""> 422          if (isPinned) {                                                                                           </span>
<span class="-705489752486798560" onmouseenter="enter('-705489752486798560');" onmouseout="out('-705489752486798560');" style=""> 423              addSystemTag(PINNED_TAG);                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 424          } else {                                                                                                  </span>
<span class="5010790157822780054" onmouseenter="enter('5010790157822780054');" onmouseout="out('5010790157822780054');" style=""> 425              removeSystemTag(PINNED_TAG);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427      }                                                                                                             </span>
<span  style=""> 428                                                                                                                    </span>
<span class="3778345749504952755" onmouseenter="enter('3778345749504952755');" onmouseout="out('3778345749504952755');" style=""> 429      public boolean isPreviewEnabled() {                                                                           </span>
<span class="-6537187368585435683" onmouseenter="enter('-6537187368585435683');" onmouseout="out('-6537187368585435683');" style=""> 430          return hasSystemTag(PREVIEW_TAG);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431      }                                                                                                             </span>
<span  style=""> 432                                                                                                                    </span>
<span class="-3198839301731339686" onmouseenter="enter('-3198839301731339686');" onmouseout="out('-3198839301731339686');" style=""> 433      public void setPreviewEnabled(boolean isPreviewEnabled) {                                                     </span>
<span class="-4540372431458214170" onmouseenter="enter('-4540372431458214170');" onmouseout="out('-4540372431458214170');" style=""> 434          if (isPreviewEnabled) {                                                                                   </span>
<span class="1609739104508733891" onmouseenter="enter('1609739104508733891');" onmouseout="out('1609739104508733891');" style=""> 435              addSystemTag(PREVIEW_TAG);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 436          } else {                                                                                                  </span>
<span class="1340191486118728833" onmouseenter="enter('1340191486118728833');" onmouseout="out('1340191486118728833');" style=""> 437              removeSystemTag(PREVIEW_TAG);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439      }                                                                                                             </span>
<span  style=""> 440                                                                                                                    </span>
<span class="5049304787018344959" onmouseenter="enter('5049304787018344959');" onmouseout="out('5049304787018344959');" style=""> 441      public boolean isPublished() {                                                                                </span>
<span class="-3313218062555121548" onmouseenter="enter('-3313218062555121548');" onmouseout="out('-3313218062555121548');" style=""> 442          return hasSystemTag(PUBLISHED_TAG) &amp;&amp; !TextUtils.isEmpty(getPublishedUrl());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443      }                                                                                                             </span>
<span  style=""> 444                                                                                                                    </span>
<span class="-1996001930026199474" onmouseenter="enter('-1996001930026199474');" onmouseout="out('-1996001930026199474');" style=""> 445      public void setPublished(boolean isPublished) {                                                               </span>
<span class="-214835194616400293" onmouseenter="enter('-214835194616400293');" onmouseout="out('-214835194616400293');" style=""> 446          if (isPublished) {                                                                                        </span>
<span class="6614236660148008937" onmouseenter="enter('6614236660148008937');" onmouseout="out('6614236660148008937');" style=""> 447              addSystemTag(PUBLISHED_TAG);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 448          } else {                                                                                                  </span>
<span class="-3125520029372940316" onmouseenter="enter('-3125520029372940316');" onmouseout="out('-3125520029372940316');" style=""> 449              removeSystemTag(PUBLISHED_TAG);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 451      }                                                                                                             </span>
<span  style=""> 452                                                                                                                    </span>
<span class="-774122069426151266" onmouseenter="enter('-774122069426151266');" onmouseout="out('-774122069426151266');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 453 +    public void removeTag(String tagName) {                                                                       </span>
<span class="-7156606951491867974" onmouseenter="enter('-7156606951491867974');" onmouseout="out('-7156606951491867974');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 454 +        List&lt;String&gt; tags = getTags();                                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 455 +                                                                                                                  </span>
<span class="-4968889763858242681" onmouseenter="enter('-4968889763858242681');" onmouseout="out('-4968889763858242681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 456 +        List&lt;String&gt; tagsMatched = TagUtils.findTagsMatch(tags, tagName);                                         </span>
<span class="8024503584246599832" onmouseenter="enter('8024503584246599832');" onmouseout="out('8024503584246599832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 457 +        tags.removeAll(tagsMatched);                                                                              </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 458 +                                                                                                                  </span>
<span class="-3148524022076108640" onmouseenter="enter('-3148524022076108640');" onmouseout="out('-3148524022076108640');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 459 +        setTags(tags);                                                                                            </span>
<span class="8471916837986154111" onmouseenter="enter('8471916837986154111');" onmouseout="out('8471916837986154111');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 460 +        save();                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 461 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 462 +                                                                                                                  </span>
<span class="8481041411290642641" onmouseenter="enter('8481041411290642641');" onmouseout="out('8481041411290642641');" style=""> 463      private boolean hasSystemTag(String tag) {                                                                    </span>
<span class="-1472869558903340894" onmouseenter="enter('-1472869558903340894');" onmouseout="out('-1472869558903340894');" style=""> 464          if (TextUtils.isEmpty(tag))                                                                               </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 465              return false;                                                                                         </span>
<span  style=""> 466                                                                                                                    </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 467          JSONArray tags = getSystemTags();                                                                         </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 468          int length = tags.length();                                                                               </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 469          for (int i = 0; i &lt; length; i++) {                                                                        </span>
<span class="1029161545303231138" onmouseenter="enter('1029161545303231138');" onmouseout="out('1029161545303231138');" style=""> 470              if (tags.optString(i).equals(tag)) {                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 471                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473          }                                                                                                         </span>
<span  style=""> 474                                                                                                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 475          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476      }                                                                                                             </span>
<span  style=""> 477                                                                                                                    </span>
<span class="-1886965851517885412" onmouseenter="enter('-1886965851517885412');" onmouseout="out('-1886965851517885412');" style=""> 478      private void addSystemTag(String tag) {                                                                       </span>
<span class="-7266652503291305395" onmouseenter="enter('-7266652503291305395');" onmouseout="out('-7266652503291305395');" style=""> 479          if (TextUtils.isEmpty(tag)) {                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 480              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481          }                                                                                                         </span>
<span  style=""> 482                                                                                                                    </span>
<span class="4034934261619610009" onmouseenter="enter('4034934261619610009');" onmouseout="out('4034934261619610009');" style=""> 483          // Ensure we don&#x27;t add the same tag again                                                                 </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 484          if (!hasSystemTag(tag)) {                                                                                 </span>
<span class="-2655750625237705417" onmouseenter="enter('-2655750625237705417');" onmouseout="out('-2655750625237705417');" style=""> 485              getSystemTags().put(tag);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487      }                                                                                                             </span>
<span  style=""> 488                                                                                                                    </span>
<span class="-6272346588769055483" onmouseenter="enter('-6272346588769055483');" onmouseout="out('-6272346588769055483');" style=""> 489      private void removeSystemTag(String tag) {                                                                    </span>
<span class="4475384509373287742" onmouseenter="enter('4475384509373287742');" onmouseout="out('4475384509373287742');" style=""> 490          if (!hasSystemTag(tag)) {                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 491              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492          }                                                                                                         </span>
<span  style=""> 493                                                                                                                    </span>
<span class="-8058095151201873037" onmouseenter="enter('-8058095151201873037');" onmouseout="out('-8058095151201873037');" style=""> 494          JSONArray tags = getSystemTags();                                                                         </span>
<span class="6472000112597211426" onmouseenter="enter('6472000112597211426');" onmouseout="out('6472000112597211426');" style=""> 495          JSONArray newTags = new JSONArray();                                                                      </span>
<span class="1470548578065798141" onmouseenter="enter('1470548578065798141');" onmouseout="out('1470548578065798141');" style=""> 496          int length = tags.length();                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 497          try {                                                                                                     </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 498              for (int i = 0; i &lt; length; i++) {                                                                    </span>
<span class="5751642819386913624" onmouseenter="enter('5751642819386913624');" onmouseout="out('5751642819386913624');" style=""> 499                  Object val = tags.get(i);                                                                         </span>
<span class="7076458285668173093" onmouseenter="enter('7076458285668173093');" onmouseout="out('7076458285668173093');" style=""> 500                  if (!val.equals(tag))                                                                             </span>
<span class="-6329059091210941964" onmouseenter="enter('-6329059091210941964');" onmouseout="out('-6329059091210941964');" style=""> 501                      newTags.put(val);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502              }                                                                                                     </span>
<span class="2021063483207698984" onmouseenter="enter('2021063483207698984');" onmouseout="out('2021063483207698984');" style=""> 503          } catch (JSONException e) {                                                                               </span>
<span class="4377813279323840039" onmouseenter="enter('4377813279323840039');" onmouseout="out('4377813279323840039');" style=""> 504              // could not update pinned setting                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505          }                                                                                                         </span>
<span  style=""> 506                                                                                                                    </span>
<span class="8301502673130902229" onmouseenter="enter('8301502673130902229');" onmouseout="out('8301502673130902229');" style=""> 507          setProperty(SYSTEM_TAGS_PROPERTY, newTags);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508      }                                                                                                             </span>
<span  style=""> 509                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 510      /**                                                                                                           </span>
<span class="-397105642920094918" onmouseenter="enter('-397105642920094918');" onmouseout="out('-397105642920094918');" style=""> 511       * Check if the note has any changes                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 512       *                                                                                                            </span>
<span class="6656400016423195192" onmouseenter="enter('6656400016423195192');" onmouseout="out('6656400016423195192');" style=""> 513       * @param content           the new note content                                                              </span>
<span class="698428434066591100" onmouseenter="enter('698428434066591100');" onmouseout="out('698428434066591100');" style=""> 514       * @param tagString         space separated tags                                                              </span>
<span class="-6143007710262330196" onmouseenter="enter('-6143007710262330196');" onmouseout="out('-6143007710262330196');" style=""> 515       * @param isPinned          note is pinned                                                                    </span>
<span class="-1154760621356330740" onmouseenter="enter('-1154760621356330740');" onmouseout="out('-1154760621356330740');" style=""> 516       * @param isMarkdownEnabled note has markdown enabled                                                         </span>
<span class="-2689180860643219460" onmouseenter="enter('-2689180860643219460');" onmouseout="out('-2689180860643219460');" style=""> 517       * @param isPreviewEnabled  note has preview enabled                                                          </span>
<span class="2808295610973044096" onmouseenter="enter('2808295610973044096');" onmouseout="out('2808295610973044096');" style=""> 518       * @return true if note has changes, false if it is unchanged.                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 519       */                                                                                                           </span>
<span class="2249306723652890422" onmouseenter="enter('2249306723652890422');" onmouseout="out('2249306723652890422');" style=""><abbr title=" 520      public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boolean isPreviewEnabled) {"> 520      public boolean hasChanges(String content, String tagString, boolean isPinned, boolean isMarkdownEnabled, boole🔵</abbr></span>
<span class="-8752168499945681469" onmouseenter="enter('-8752168499945681469');" onmouseout="out('-8752168499945681469');" style=""> 521          return !content.equals(this.getContent())                                                                 </span>
<span class="361029725350182512" onmouseenter="enter('361029725350182512');" onmouseout="out('361029725350182512');" style=""> 522                  || !tagString.equals(this.getTagString().toString())                                              </span>
<span class="-3256796514842471479" onmouseenter="enter('-3256796514842471479');" onmouseout="out('-3256796514842471479');" style=""> 523                  || this.isPinned() != isPinned                                                                    </span>
<span class="3248054844136733713" onmouseenter="enter('3248054844136733713');" onmouseout="out('3248054844136733713');" style=""> 524                  || this.isMarkdownEnabled() != isMarkdownEnabled                                                  </span>
<span class="7822456953056210787" onmouseenter="enter('7822456953056210787');" onmouseout="out('7822456953056210787');" style=""> 525                  || this.isPreviewEnabled() != isPreviewEnabled;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526      }                                                                                                             </span>
<span  style=""> 527                                                                                                                    </span>
<span class="-7717881480664684723" onmouseenter="enter('-7717881480664684723');" onmouseout="out('-7717881480664684723');" style=""> 528      public static class Schema extends BucketSchema&lt;Note&gt; {                                                       </span>
<span  style=""> 529                                                                                                                    </span>
<span class="-3235753444162186767" onmouseenter="enter('-3235753444162186767');" onmouseout="out('-3235753444162186767');" style=""> 530          protected static NoteIndexer sNoteIndexer = new NoteIndexer();                                            </span>
<span class="-8196684505127442187" onmouseenter="enter('-8196684505127442187');" onmouseout="out('-8196684505127442187');" style=""> 531          protected static NoteFullTextIndexer sFullTextIndexer = new NoteFullTextIndexer();                        </span>
<span  style=""> 532                                                                                                                    </span>
<span class="-75865115147660663" onmouseenter="enter('-75865115147660663');" onmouseout="out('-75865115147660663');" style=""> 533          public Schema() {                                                                                         </span>
<span class="-4886495676536647522" onmouseenter="enter('-4886495676536647522');" onmouseout="out('-4886495676536647522');" style=""> 534              autoIndex();                                                                                          </span>
<span class="-6825633182165860223" onmouseenter="enter('-6825633182165860223');" onmouseout="out('-6825633182165860223');" style=""> 535              addIndex(sNoteIndexer);                                                                               </span>
<span class="-3392547141042614111" onmouseenter="enter('-3392547141042614111');" onmouseout="out('-3392547141042614111');" style=""> 536              setupFullTextIndex(sFullTextIndexer, NoteFullTextIndexer.INDEXES);                                    </span>
<span class="-6401895186782523877" onmouseenter="enter('-6401895186782523877');" onmouseout="out('-6401895186782523877');" style=""> 537              setDefault(CONTENT_PROPERTY, &quot;&quot;);                                                                     </span>
<span class="-2554467534039091654" onmouseenter="enter('-2554467534039091654');" onmouseout="out('-2554467534039091654');" style=""> 538              setDefault(SYSTEM_TAGS_PROPERTY, new JSONArray());                                                    </span>
<span class="228359577715990029" onmouseenter="enter('228359577715990029');" onmouseout="out('228359577715990029');" style=""> 539              setDefault(TAGS_PROPERTY, new JSONArray());                                                           </span>
<span class="-819869596778271798" onmouseenter="enter('-819869596778271798');" onmouseout="out('-819869596778271798');" style=""> 540              setDefault(DELETED_PROPERTY, false);                                                                  </span>
<span class="-8278335164591762572" onmouseenter="enter('-8278335164591762572');" onmouseout="out('-8278335164591762572');" style=""> 541              setDefault(SHARE_URL_PROPERTY, &quot;&quot;);                                                                   </span>
<span class="4718032932676673460" onmouseenter="enter('4718032932676673460');" onmouseout="out('4718032932676673460');" style=""> 542              setDefault(PUBLISH_URL_PROPERTY, &quot;&quot;);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543          }                                                                                                         </span>
<span  style=""> 544                                                                                                                    </span>
<span class="1438294404599077665" onmouseenter="enter('1438294404599077665');" onmouseout="out('1438294404599077665');" style=""> 545          public String getRemoteName() {                                                                           </span>
<span class="-8943072285760215512" onmouseenter="enter('-8943072285760215512');" onmouseout="out('-8943072285760215512');" style=""> 546              return Note.BUCKET_NAME;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547          }                                                                                                         </span>
<span  style=""> 548                                                                                                                    </span>
<span class="-4946235729406468677" onmouseenter="enter('-4946235729406468677');" onmouseout="out('-4946235729406468677');" style=""> 549          public Note build(String key, JSONObject properties) {                                                    </span>
<span class="-2808542273143064496" onmouseenter="enter('-2808542273143064496');" onmouseout="out('-2808542273143064496');" style=""> 550              return new Note(key, properties);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 551          }                                                                                                         </span>
<span  style=""> 552                                                                                                                    </span>
<span class="2318790323390762687" onmouseenter="enter('2318790323390762687');" onmouseout="out('2318790323390762687');" style=""> 553          public void update(Note note, JSONObject properties) {                                                    </span>
<span class="-3717338000153341316" onmouseenter="enter('-3717338000153341316');" onmouseout="out('-3717338000153341316');" style=""> 554              note.setProperties(properties);                                                                       </span>
<span class="-731284339738821488" onmouseenter="enter('-731284339738821488');" onmouseout="out('-731284339738821488');" style=""> 555              note.mTitle = null;                                                                                   </span>
<span class="6645980171711348815" onmouseenter="enter('6645980171711348815');" onmouseout="out('6645980171711348815');" style=""> 556              note.mContentPreview = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            