<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>251</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    251
                    <a href="250.html">prev</a>
                    <a href="252.html">next</a>
                    <a href="251_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    CyanogenMod/android_packages_apps_Trebuchet_c63b8b82d3cd7dbb375f92cf8e3bf62d73bc0f81_src/com/android/launcher3/LauncherProvider.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;c63b8b82d3cd7dbb375f92cf8e3bf62d73bc0f81:src/com/android/launcher3/LauncherProvider.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;c63b8b82d3cd7dbb375f92cf8e3bf62d73bc0f81^1:src/com/android/launcher3/LauncherProvider.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;c63b8b82d3cd7dbb375f92cf8e3bf62d73bc0f81^2:src/com/android/launcher3/LauncherProvider.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;7470c817e46f241bf37a7874fa7cf7493fc7cf94:src/com/android/launcher3/LauncherProvider.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [j], [j]], subset: [[b], [bj], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="1710841298952644868" onmouseenter="enter('1710841298952644868');" onmouseout="out('1710841298952644868');" style="">   2  * Copyright (C) 2008 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">  17 package com.android.launcher3;                                                                           </span>
<span  style="">  18                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">  19 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="8802236814006375919" onmouseenter="enter('8802236814006375919');" onmouseout="out('8802236814006375919');" style="">  20 import android.appwidget.AppWidgetManager;                                                               </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">  21 import android.content.ComponentName;                                                                    </span>
<span class="550877806393279246" onmouseenter="enter('550877806393279246');" onmouseout="out('550877806393279246');" style="">  22 import android.content.ContentProvider;                                                                  </span>
<span class="3739800667450215943" onmouseenter="enter('3739800667450215943');" onmouseout="out('3739800667450215943');" style="">  23 import android.content.ContentProviderOperation;                                                         </span>
<span class="-6369732601490611729" onmouseenter="enter('-6369732601490611729');" onmouseout="out('-6369732601490611729');" style="">  24 import android.content.ContentProviderResult;                                                            </span>
<span class="6126857652515451632" onmouseenter="enter('6126857652515451632');" onmouseout="out('6126857652515451632');" style="">  25 import android.content.ContentResolver;                                                                  </span>
<span class="-9185307499822629" onmouseenter="enter('-9185307499822629');" onmouseout="out('-9185307499822629');" style="">  26 import android.content.ContentUris;                                                                      </span>
<span class="3127723864207259776" onmouseenter="enter('3127723864207259776');" onmouseout="out('3127723864207259776');" style="">  27 import android.content.ContentValues;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  28 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  29 import android.content.Intent;                                                                           </span>
<span class="-4160670168441716907" onmouseenter="enter('-4160670168441716907');" onmouseout="out('-4160670168441716907');" style="">  30 import android.content.OperationApplicationException;                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  31 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  32 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  33 import android.database.Cursor;                                                                          </span>
<span class="5870833163231201789" onmouseenter="enter('5870833163231201789');" onmouseout="out('5870833163231201789');" style="">  34 import android.database.SQLException;                                                                    </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  35 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="6401548559697116088" onmouseenter="enter('6401548559697116088');" onmouseout="out('6401548559697116088');" style="">  36 import android.database.sqlite.SQLiteOpenHelper;                                                         </span>
<span class="-1253510085600408435" onmouseenter="enter('-1253510085600408435');" onmouseout="out('-1253510085600408435');" style="">  37 import android.database.sqlite.SQLiteQueryBuilder;                                                       </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  38 import android.net.Uri;                                                                                  </span>
<span class="5635872676092141444" onmouseenter="enter('5635872676092141444');" onmouseout="out('5635872676092141444');" style="">  39 import android.os.StrictMode;                                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  40 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  41 import android.util.Log;                                                                                 </span>
<span class="-1076320969941752510" onmouseenter="enter('-1076320969941752510');" onmouseout="out('-1076320969941752510');" style="">  42 import android.util.SparseArray;                                                                         </span>
<span  style="">  43                                                                                                          </span>
<span class="4395110202233918405" onmouseenter="enter('4395110202233918405');" onmouseout="out('4395110202233918405');" style="">  44 import com.android.launcher3.AutoInstallsLayout.LayoutParserCallback;                                    </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  45 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span class="6372524458266053383" onmouseenter="enter('6372524458266053383');" onmouseout="out('6372524458266053383');" style="">  46 import com.android.launcher3.compat.UserHandleCompat;                                                    </span>
<span class="-8849211230761127863" onmouseenter="enter('-8849211230761127863');" onmouseout="out('-8849211230761127863');" style="">  47 import com.android.launcher3.compat.UserManagerCompat;                                                   </span>
<span class="-7468653447981916815" onmouseenter="enter('-7468653447981916815');" onmouseout="out('-7468653447981916815');" style="">  48 import com.android.launcher3.config.ProviderConfig;                                                      </span>
<span  style="">  49                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  50 import java.io.File;                                                                                     </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  51 import java.net.URISyntaxException;                                                                      </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  52 import java.util.ArrayList;                                                                              </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53 import java.util.Collections;                                                                            </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54 import java.util.HashSet;                                                                                </span>
<span  style="">  55                                                                                                          </span>
<span class="-5661310118425891821" onmouseenter="enter('-5661310118425891821');" onmouseout="out('-5661310118425891821');" style="">  56 public class LauncherProvider extends ContentProvider {                                                  </span>
<span class="-5301430442842506185" onmouseenter="enter('-5301430442842506185');" onmouseout="out('-5301430442842506185');" style="">  57     private static final String TAG = &quot;Launcher.LauncherProvider&quot;;                                       </span>
<span class="-8469384925954206736" onmouseenter="enter('-8469384925954206736');" onmouseout="out('-8469384925954206736');" style="">  58     private static final boolean LOGD = false;                                                           </span>
<span  style="">  59                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  60 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-4449901048814672092" onmouseenter="enter('-4449901048814672092');" onmouseout="out('-4449901048814672092');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61     private static final int DATABASE_VERSION = 21;                                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  62 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="8296161443463465713" onmouseenter="enter('8296161443463465713');" onmouseout="out('8296161443463465713');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63     private static final int MIN_DATABASE_VERSION = 12;                                                  </span>
<span class="-4449901048814672092" onmouseenter="enter('-4449901048814672092');" onmouseout="out('-4449901048814672092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64     private static final int DATABASE_VERSION = 21;                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  65 =======                                                                                                  </span>
<span class="8296161443463465713" onmouseenter="enter('8296161443463465713');" onmouseout="out('8296161443463465713');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66     private static final int MIN_DATABASE_VERSION = 12;                                                  </span>
<span class="9152615363478404775" onmouseenter="enter('9152615363478404775');" onmouseout="out('9152615363478404775');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67     private static final int DATABASE_VERSION = 22;                                                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  68 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  69                                                                                                          </span>
<span class="-458478327704245810" onmouseenter="enter('-458478327704245810');" onmouseout="out('-458478327704245810');" style="">  70     static final String OLD_AUTHORITY = &quot;com.android.launcher2.settings&quot;;                                </span>
<span class="-4376021050615906115" onmouseenter="enter('-4376021050615906115');" onmouseout="out('-4376021050615906115');" style="">  71     static final String AUTHORITY = ProviderConfig.AUTHORITY;                                            </span>
<span  style="">  72                                                                                                          </span>
<span class="-6626902943579202823" onmouseenter="enter('-6626902943579202823');" onmouseout="out('-6626902943579202823');" style="">  73     static final String TABLE_FAVORITES = &quot;favorites&quot;;                                                   </span>
<span class="-4121112267423691577" onmouseenter="enter('-4121112267423691577');" onmouseout="out('-4121112267423691577');" style="">  74     static final String TABLE_WORKSPACE_SCREENS = &quot;workspaceScreens&quot;;                                    </span>
<span class="5667619940348816611" onmouseenter="enter('5667619940348816611');" onmouseout="out('5667619940348816611');" style="">  75     static final String PARAMETER_NOTIFY = &quot;notify&quot;;                                                     </span>
<span class="4313854869595882016" onmouseenter="enter('4313854869595882016');" onmouseout="out('4313854869595882016');" style="">  76     static final String EMPTY_DATABASE_CREATED = &quot;EMPTY_DATABASE_CREATED&quot;;                               </span>
<span  style="">  77                                                                                                          </span>
<span class="-254878042648191521" onmouseenter="enter('-254878042648191521');" onmouseout="out('-254878042648191521');" style="">  78     private static final String URI_PARAM_IS_EXTERNAL_ADD = &quot;isExternalAdd&quot;;                             </span>
<span  style="">  79                                                                                                          </span>
<span class="-4555445478569710276" onmouseenter="enter('-4555445478569710276');" onmouseout="out('-4555445478569710276');" style="">  80     private LauncherProviderChangeListener mListener;                                                    </span>
<span  style="">  81                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  82     /**                                                                                                  </span>
<span class="-3211764681636990688" onmouseenter="enter('-3211764681636990688');" onmouseout="out('-3211764681636990688');" style="">  83      * {@link Uri} triggered at any registered {@link android.database.ContentObserver} when             </span>
<span class="-4919300270466303234" onmouseenter="enter('-4919300270466303234');" onmouseout="out('-4919300270466303234');" style="">  84      * {@link AppWidgetHost#deleteHost()} is called during database creation.                            </span>
<span class="-788325382909228329" onmouseenter="enter('-788325382909228329');" onmouseout="out('-788325382909228329');" style="">  85      * Use this to recall {@link AppWidgetHost#startListening()} if needed.                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86      */                                                                                                  </span>
<span class="5515339483970246409" onmouseenter="enter('5515339483970246409');" onmouseout="out('5515339483970246409');" style="">  87     static final Uri CONTENT_APPWIDGET_RESET_URI =                                                       </span>
<span class="3194273355649806706" onmouseenter="enter('3194273355649806706');" onmouseout="out('3194273355649806706');" style="">  88             Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/appWidgetReset&quot;);                                     </span>
<span  style="">  89                                                                                                          </span>
<span class="-35355205086145165" onmouseenter="enter('-35355205086145165');" onmouseout="out('-35355205086145165');" style="">  90     private DatabaseHelper mOpenHelper;                                                                  </span>
<span  style="">  91                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92     @Override                                                                                            </span>
<span class="5054121129922253104" onmouseenter="enter('5054121129922253104');" onmouseout="out('5054121129922253104');" style="">  93     public boolean onCreate() {                                                                          </span>
<span class="4475688138331124962" onmouseenter="enter('4475688138331124962');" onmouseout="out('4475688138331124962');" style="">  94         final Context context = getContext();                                                            </span>
<span class="-8005318937043312715" onmouseenter="enter('-8005318937043312715');" onmouseout="out('-8005318937043312715');" style="">  95         StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();                          </span>
<span class="-7690576094790651842" onmouseenter="enter('-7690576094790651842');" onmouseout="out('-7690576094790651842');" style="">  96         mOpenHelper = new DatabaseHelper(context);                                                       </span>
<span class="-9120794859598568002" onmouseenter="enter('-9120794859598568002');" onmouseout="out('-9120794859598568002');" style="">  97         StrictMode.setThreadPolicy(oldPolicy);                                                           </span>
<span class="-7305781479923559628" onmouseenter="enter('-7305781479923559628');" onmouseout="out('-7305781479923559628');" style="">  98         LauncherAppState.setLauncherProvider(this);                                                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  99         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100     }                                                                                                    </span>
<span  style=""> 101                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 102     public boolean wasNewDbCreated() {                                                                   </span>
<span class="-2120364841155545874" onmouseenter="enter('-2120364841155545874');" onmouseout="out('-2120364841155545874');" style=""> 103         return mOpenHelper.wasNewDbCreated();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104     }                                                                                                    </span>
<span  style=""> 105                                                                                                          </span>
<span class="9170464131639972057" onmouseenter="enter('9170464131639972057');" onmouseout="out('9170464131639972057');" style=""> 106     public void setLauncherProviderChangeListener(LauncherProviderChangeListener listener) {             </span>
<span class="9132236250678632099" onmouseenter="enter('9132236250678632099');" onmouseout="out('9132236250678632099');" style=""> 107         mListener = listener;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="-1263590755434456926" onmouseenter="enter('-1263590755434456926');" onmouseout="out('-1263590755434456926');" style=""> 111     public String getType(Uri uri) {                                                                     </span>
<span class="336598653403461328" onmouseenter="enter('336598653403461328');" onmouseout="out('336598653403461328');" style=""> 112         SqlArguments args = new SqlArguments(uri, null, null);                                           </span>
<span class="-3811208733585118846" onmouseenter="enter('-3811208733585118846');" onmouseout="out('-3811208733585118846');" style=""> 113         if (TextUtils.isEmpty(args.where)) {                                                             </span>
<span class="4564755247099008741" onmouseenter="enter('4564755247099008741');" onmouseout="out('4564755247099008741');" style=""> 114             return &quot;vnd.android.cursor.dir/&quot; + args.table;                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 115         } else {                                                                                         </span>
<span class="9039528378345344991" onmouseenter="enter('9039528378345344991');" onmouseout="out('9039528378345344991');" style=""> 116             return &quot;vnd.android.cursor.item/&quot; + args.table;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 120     @Override                                                                                            </span>
<span class="2688381462100157580" onmouseenter="enter('2688381462100157580');" onmouseout="out('2688381462100157580');" style=""> 121     public Cursor query(Uri uri, String[] projection, String selection,                                  </span>
<span class="-8080601171652713678" onmouseenter="enter('-8080601171652713678');" onmouseout="out('-8080601171652713678');" style=""> 122             String[] selectionArgs, String sortOrder) {                                                  </span>
<span  style=""> 123                                                                                                          </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 124         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span class="-631518951729113636" onmouseenter="enter('-631518951729113636');" onmouseout="out('-631518951729113636');" style=""> 125         SQLiteQueryBuilder qb = new SQLiteQueryBuilder();                                                </span>
<span class="2611293065726660593" onmouseenter="enter('2611293065726660593');" onmouseout="out('2611293065726660593');" style=""> 126         qb.setTables(args.table);                                                                        </span>
<span  style=""> 127                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 128         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3134453170380441664" onmouseenter="enter('3134453170380441664');" onmouseout="out('3134453170380441664');" style=""> 129         Cursor result = qb.query(db, projection, args.where, args.args, null, null, sortOrder);          </span>
<span class="-7763164457135943875" onmouseenter="enter('-7763164457135943875');" onmouseout="out('-7763164457135943875');" style=""> 130         result.setNotificationUri(getContext().getContentResolver(), uri);                               </span>
<span  style=""> 131                                                                                                          </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 132         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="9207797122534392164" onmouseenter="enter('9207797122534392164');" onmouseout="out('9207797122534392164');" style=""> 135     private static long dbInsertAndCheck(DatabaseHelper helper,                                          </span>
<span class="-7649003652568167377" onmouseenter="enter('-7649003652568167377');" onmouseout="out('-7649003652568167377');" style=""> 136             SQLiteDatabase db, String table, String nullColumnHack, ContentValues values) {              </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style=""> 137         if (values == null) {                                                                            </span>
<span class="7184965589450928593" onmouseenter="enter('7184965589450928593');" onmouseout="out('7184965589450928593');" style=""> 138             throw new RuntimeException(&quot;Error: attempting to insert null values&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139         }                                                                                                </span>
<span class="7050899094957739080" onmouseenter="enter('7050899094957739080');" onmouseout="out('7050899094957739080');" style=""> 140         if (!values.containsKey(LauncherSettings.ChangeLogColumns._ID)) {                                </span>
<span class="492623150120761321" onmouseenter="enter('492623150120761321');" onmouseout="out('492623150120761321');" style=""> 141             throw new RuntimeException(&quot;Error: attempting to add item without specifying an id&quot;);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142         }                                                                                                </span>
<span class="-5706715493188407465" onmouseenter="enter('-5706715493188407465');" onmouseout="out('-5706715493188407465');" style=""> 143         helper.checkId(table, values);                                                                   </span>
<span class="1074556166740873719" onmouseenter="enter('1074556166740873719');" onmouseout="out('1074556166740873719');" style=""> 144         return db.insert(table, nullColumnHack, values);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145     }                                                                                                    </span>
<span  style=""> 146                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 147     @Override                                                                                            </span>
<span class="-734135164912880773" onmouseenter="enter('-734135164912880773');" onmouseout="out('-734135164912880773');" style=""> 148     public Uri insert(Uri uri, ContentValues initialValues) {                                            </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 149         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span  style=""> 150                                                                                                          </span>
<span class="-8942992855752528468" onmouseenter="enter('-8942992855752528468');" onmouseout="out('-8942992855752528468');" style=""> 151         // In very limited cases, we support system|signature permission apps to add to the db           </span>
<span class="8337919216215113797" onmouseenter="enter('8337919216215113797');" onmouseout="out('8337919216215113797');" style=""> 152         String externalAdd = uri.getQueryParameter(URI_PARAM_IS_EXTERNAL_ADD);                           </span>
<span class="-2295815198673808272" onmouseenter="enter('-2295815198673808272');" onmouseout="out('-2295815198673808272');" style=""> 153         if (externalAdd != null &amp;&amp; &quot;true&quot;.equals(externalAdd)) {                                         </span>
<span class="255159610270408066" onmouseenter="enter('255159610270408066');" onmouseout="out('255159610270408066');" style=""> 154             if (!mOpenHelper.initializeExternalAdd(initialValues)) {                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 155                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157         }                                                                                                </span>
<span  style=""> 158                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 159         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-6358079444454153819" onmouseenter="enter('-6358079444454153819');" onmouseout="out('-6358079444454153819');" style=""> 160         addModifiedTime(initialValues);                                                                  </span>
<span class="5419112362953263362" onmouseenter="enter('5419112362953263362');" onmouseout="out('5419112362953263362');" style=""> 161         final long rowId = dbInsertAndCheck(mOpenHelper, db, args.table, null, initialValues);           </span>
<span class="8445680939324035407" onmouseenter="enter('8445680939324035407');" onmouseout="out('8445680939324035407');" style=""> 162         if (rowId &lt;= 0) return null;                                                                     </span>
<span  style=""> 163                                                                                                          </span>
<span class="8735878877349428813" onmouseenter="enter('8735878877349428813');" onmouseout="out('8735878877349428813');" style=""> 164         uri = ContentUris.withAppendedId(uri, rowId);                                                    </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 165         sendNotify(uri);                                                                                 </span>
<span  style=""> 166                                                                                                          </span>
<span class="8673785246827833247" onmouseenter="enter('8673785246827833247');" onmouseout="out('8673785246827833247');" style=""> 167         return uri;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168     }                                                                                                    </span>
<span  style=""> 169                                                                                                          </span>
<span  style=""> 170                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171     @Override                                                                                            </span>
<span class="-327877481205905086" onmouseenter="enter('-327877481205905086');" onmouseout="out('-327877481205905086');" style=""> 172     public int bulkInsert(Uri uri, ContentValues[] values) {                                             </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 173         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span  style=""> 174                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 175         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 176         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 177         try {                                                                                            </span>
<span class="7727596149598132072" onmouseenter="enter('7727596149598132072');" onmouseout="out('7727596149598132072');" style=""> 178             int numValues = values.length;                                                               </span>
<span class="805790054769028067" onmouseenter="enter('805790054769028067');" onmouseout="out('805790054769028067');" style=""> 179             for (int i = 0; i &lt; numValues; i++) {                                                        </span>
<span class="2678636525018066730" onmouseenter="enter('2678636525018066730');" onmouseout="out('2678636525018066730');" style=""> 180                 addModifiedTime(values[i]);                                                              </span>
<span class="-5505203781899797586" onmouseenter="enter('-5505203781899797586');" onmouseout="out('-5505203781899797586');" style=""> 181                 if (dbInsertAndCheck(mOpenHelper, db, args.table, null, values[i]) &lt; 0) {                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 182                     return 0;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184             }                                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 185             db.setTransactionSuccessful();                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 186         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 187             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span  style=""> 189                                                                                                          </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 190         sendNotify(uri);                                                                                 </span>
<span class="6793841392205084718" onmouseenter="enter('6793841392205084718');" onmouseout="out('6793841392205084718');" style=""> 191         return values.length;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192     }                                                                                                    </span>
<span  style=""> 193                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194     @Override                                                                                            </span>
<span class="5983754597853237276" onmouseenter="enter('5983754597853237276');" onmouseout="out('5983754597853237276');" style=""> 195     public ContentProviderResult[] applyBatch(ArrayList&lt;ContentProviderOperation&gt; operations)            </span>
<span class="-5628895276830175510" onmouseenter="enter('-5628895276830175510');" onmouseout="out('-5628895276830175510');" style=""> 196             throws OperationApplicationException {                                                       </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 197         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 198         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 199         try {                                                                                            </span>
<span class="3840622082470564062" onmouseenter="enter('3840622082470564062');" onmouseout="out('3840622082470564062');" style=""> 200             ContentProviderResult[] result =  super.applyBatch(operations);                              </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 201             db.setTransactionSuccessful();                                                               </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 202             return result;                                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 203         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 204             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206     }                                                                                                    </span>
<span  style=""> 207                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 208     @Override                                                                                            </span>
<span class="-6238796754049684603" onmouseenter="enter('-6238796754049684603');" onmouseout="out('-6238796754049684603');" style=""> 209     public int delete(Uri uri, String selection, String[] selectionArgs) {                               </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 210         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span  style=""> 211                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 212         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-848417512188045481" onmouseenter="enter('-848417512188045481');" onmouseout="out('-848417512188045481');" style=""> 213         int count = db.delete(args.table, args.where, args.args);                                        </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 214         if (count &gt; 0) sendNotify(uri);                                                                  </span>
<span  style=""> 215                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 216         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217     }                                                                                                    </span>
<span  style=""> 218                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 219     @Override                                                                                            </span>
<span class="-6200308159398621930" onmouseenter="enter('-6200308159398621930');" onmouseout="out('-6200308159398621930');" style=""> 220     public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {         </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 221         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span  style=""> 222                                                                                                          </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 223         addModifiedTime(values);                                                                         </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 224         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="6692131291033480751" onmouseenter="enter('6692131291033480751');" onmouseout="out('6692131291033480751');" style=""> 225         int count = db.update(args.table, values, args.where, args.args);                                </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 226         if (count &gt; 0) sendNotify(uri);                                                                  </span>
<span  style=""> 227                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 228         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="-6137155183451194640" onmouseenter="enter('-6137155183451194640');" onmouseout="out('-6137155183451194640');" style=""> 231     private void sendNotify(Uri uri) {                                                                   </span>
<span class="8087997420167282782" onmouseenter="enter('8087997420167282782');" onmouseout="out('8087997420167282782');" style=""> 232         String notify = uri.getQueryParameter(PARAMETER_NOTIFY);                                         </span>
<span class="-1882364541416460726" onmouseenter="enter('-1882364541416460726');" onmouseout="out('-1882364541416460726');" style=""> 233         if (notify == null || &quot;true&quot;.equals(notify)) {                                                   </span>
<span class="-1009902495160891118" onmouseenter="enter('-1009902495160891118');" onmouseout="out('-1009902495160891118');" style=""> 234             getContext().getContentResolver().notifyChange(uri, null);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235         }                                                                                                </span>
<span  style=""> 236                                                                                                          </span>
<span class="-88474152060363663" onmouseenter="enter('-88474152060363663');" onmouseout="out('-88474152060363663');" style=""> 237         // always notify the backup agent                                                                </span>
<span class="-4136841506633225478" onmouseenter="enter('-4136841506633225478');" onmouseout="out('-4136841506633225478');" style=""> 238         LauncherBackupAgentHelper.dataChanged(getContext());                                             </span>
<span class="3660947493902737932" onmouseenter="enter('3660947493902737932');" onmouseout="out('3660947493902737932');" style=""> 239         if (mListener != null) {                                                                         </span>
<span class="7178241373784368891" onmouseenter="enter('7178241373784368891');" onmouseout="out('7178241373784368891');" style=""> 240             mListener.onLauncherProviderChange();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span  style=""> 243                                                                                                          </span>
<span class="-6084407814327678466" onmouseenter="enter('-6084407814327678466');" onmouseout="out('-6084407814327678466');" style=""> 244     private static void addModifiedTime(ContentValues values) {                                          </span>
<span class="7778574075272931857" onmouseenter="enter('7778574075272931857');" onmouseout="out('7778574075272931857');" style=""> 245         values.put(LauncherSettings.ChangeLogColumns.MODIFIED, System.currentTimeMillis());              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246     }                                                                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 248     public long generateNewItemId() {                                                                    </span>
<span class="4208143222012601660" onmouseenter="enter('4208143222012601660');" onmouseout="out('4208143222012601660');" style=""> 249         return mOpenHelper.generateNewItemId();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 252     public void updateMaxItemId(long id) {                                                               </span>
<span class="5887752252226734670" onmouseenter="enter('5887752252226734670');" onmouseout="out('5887752252226734670');" style=""> 253         mOpenHelper.updateMaxItemId(id);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254     }                                                                                                    </span>
<span  style=""> 255                                                                                                          </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 256     public long generateNewScreenId() {                                                                  </span>
<span class="1793864293735992917" onmouseenter="enter('1793864293735992917');" onmouseout="out('1793864293735992917');" style=""> 257         return mOpenHelper.generateNewScreenId();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 260     /**                                                                                                  </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 261      * Clears all the data for a fresh start.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 262      */                                                                                                  </span>
<span class="-8979529877881539007" onmouseenter="enter('-8979529877881539007');" onmouseout="out('-8979529877881539007');" style=""> 263     synchronized public void createEmptyDB() {                                                           </span>
<span class="-257404101089763384" onmouseenter="enter('-257404101089763384');" onmouseout="out('-257404101089763384');" style=""> 264         mOpenHelper.createEmptyDB(mOpenHelper.getWritableDatabase());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="6671122679064927328" onmouseenter="enter('6671122679064927328');" onmouseout="out('6671122679064927328');" style=""> 267     public void clearFlagEmptyDbCreated() {                                                              </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 268         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="6603172609148556207" onmouseenter="enter('6603172609148556207');" onmouseout="out('6603172609148556207');" style=""> 269         getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE)                                   </span>
<span class="-4990178698661362372" onmouseenter="enter('-4990178698661362372');" onmouseout="out('-4990178698661362372');" style=""> 270             .edit()                                                                                      </span>
<span class="-4523663616686353798" onmouseenter="enter('-4523663616686353798');" onmouseout="out('-4523663616686353798');" style=""> 271             .remove(EMPTY_DATABASE_CREATED)                                                              </span>
<span class="5746476506062343638" onmouseenter="enter('5746476506062343638');" onmouseout="out('5746476506062343638');" style=""> 272             .commit();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 275     /**                                                                                                  </span>
<span class="277164340629859803" onmouseenter="enter('277164340629859803');" onmouseout="out('277164340629859803');" style=""> 276      * Loads the default workspace based on the following priority scheme:                               </span>
<span class="6191061916552549057" onmouseenter="enter('6191061916552549057');" onmouseout="out('6191061916552549057');" style=""> 277      *   1) From a package provided by play store                                                        </span>
<span class="-1458935321569433020" onmouseenter="enter('-1458935321569433020');" onmouseout="out('-1458935321569433020');" style=""> 278      *   2) From a partner configuration APK, already in the system image                                </span>
<span class="-8497452292409790071" onmouseenter="enter('-8497452292409790071');" onmouseout="out('-8497452292409790071');" style=""> 279      *   3) The default configuration for the particular device                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 280      */                                                                                                  </span>
<span class="-4109341010907676070" onmouseenter="enter('-4109341010907676070');" onmouseout="out('-4109341010907676070');" style=""> 281     synchronized public void loadDefaultFavoritesIfNecessary() {                                         </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 282         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="-1270995004093477684" onmouseenter="enter('-1270995004093477684');" onmouseout="out('-1270995004093477684');" style=""> 283         SharedPreferences sp = getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span  style=""> 284                                                                                                          </span>
<span class="-1164862040405657048" onmouseenter="enter('-1164862040405657048');" onmouseout="out('-1164862040405657048');" style=""> 285         if (sp.getBoolean(EMPTY_DATABASE_CREATED, false)) {                                              </span>
<span class="-3246698064640464314" onmouseenter="enter('-3246698064640464314');" onmouseout="out('-3246698064640464314');" style=""> 286             Log.d(TAG, &quot;loading default workspace&quot;);                                                     </span>
<span  style=""> 287                                                                                                          </span>
<span class="7358984688962203192" onmouseenter="enter('7358984688962203192');" onmouseout="out('7358984688962203192');" style=""> 288             AutoInstallsLayout loader = AutoInstallsLayout.get(getContext(),                             </span>
<span class="4267100487943846224" onmouseenter="enter('4267100487943846224');" onmouseout="out('4267100487943846224');" style=""> 289                     mOpenHelper.mAppWidgetHost, mOpenHelper);                                            </span>
<span  style=""> 290                                                                                                          </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 291             if (loader == null) {                                                                        </span>
<span class="-7748100060285216458" onmouseenter="enter('-7748100060285216458');" onmouseout="out('-7748100060285216458');" style=""> 292                 final Partner partner = Partner.get(getContext().getPackageManager());                   </span>
<span class="-604675337449948556" onmouseenter="enter('-604675337449948556');" onmouseout="out('-604675337449948556');" style=""> 293                 if (partner != null &amp;&amp; partner.hasDefaultLayout()) {                                     </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 294                     final Resources partnerRes = partner.getResources();                                 </span>
<span class="4481789752192356250" onmouseenter="enter('4481789752192356250');" onmouseout="out('4481789752192356250');" style=""> 295                     int workspaceResId = partnerRes.getIdentifier(Partner.RES_DEFAULT_LAYOUT,            </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 296                             &quot;xml&quot;, partner.getPackageName());                                            </span>
<span class="-1442734434460802886" onmouseenter="enter('-1442734434460802886');" onmouseout="out('-1442734434460802886');" style=""> 297                     if (workspaceResId != 0) {                                                           </span>
<span class="-624367766367819814" onmouseenter="enter('-624367766367819814');" onmouseout="out('-624367766367819814');" style=""> 298                         loader = new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,       </span>
<span class="3991293503056578945" onmouseenter="enter('3991293503056578945');" onmouseout="out('3991293503056578945');" style=""> 299                                 mOpenHelper, partnerRes, workspaceResId);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302             }                                                                                            </span>
<span  style=""> 303                                                                                                          </span>
<span class="-1006525515535848907" onmouseenter="enter('-1006525515535848907');" onmouseout="out('-1006525515535848907');" style=""> 304             final boolean usingExternallyProvidedLayout = loader != null;                                </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 305             if (loader == null) {                                                                        </span>
<span class="-6937254959516916052" onmouseenter="enter('-6937254959516916052');" onmouseout="out('-6937254959516916052');" style=""> 306                 loader = getDefaultLayoutParser();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307             }                                                                                            </span>
<span class="126045670500141" onmouseenter="enter('126045670500141');" onmouseout="out('126045670500141');" style=""> 308             // Populate favorites table with initial favorites                                           </span>
<span class="8206837333293431906" onmouseenter="enter('8206837333293431906');" onmouseout="out('8206837333293431906');" style=""> 309             if ((mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(), loader) &lt;= 0)              </span>
<span class="-363747028825236736" onmouseenter="enter('-363747028825236736');" onmouseout="out('-363747028825236736');" style=""> 310                     &amp;&amp; usingExternallyProvidedLayout) {                                                  </span>
<span class="-5734732948359842282" onmouseenter="enter('-5734732948359842282');" onmouseout="out('-5734732948359842282');" style=""> 311                 // Unable to load external layout. Cleanup and load the internal layout.                 </span>
<span class="5828098457627567319" onmouseenter="enter('5828098457627567319');" onmouseout="out('5828098457627567319');" style=""> 312                 createEmptyDB();                                                                         </span>
<span class="-3956631052588999268" onmouseenter="enter('-3956631052588999268');" onmouseout="out('-3956631052588999268');" style=""> 313                 mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(),                             </span>
<span class="5010356356580148690" onmouseenter="enter('5010356356580148690');" onmouseout="out('5010356356580148690');" style=""> 314                         getDefaultLayoutParser());                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span class="-1774667578952654848" onmouseenter="enter('-1774667578952654848');" onmouseout="out('-1774667578952654848');" style=""> 316             clearFlagEmptyDbCreated();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318     }                                                                                                    </span>
<span  style=""> 319                                                                                                          </span>
<span class="1869645688222446570" onmouseenter="enter('1869645688222446570');" onmouseout="out('1869645688222446570');" style=""> 320     private DefaultLayoutParser getDefaultLayoutParser() {                                               </span>
<span class="-4358736250572585751" onmouseenter="enter('-4358736250572585751');" onmouseout="out('-4358736250572585751');" style=""> 321         int defaultLayout = LauncherAppState.getInstance()                                               </span>
<span class="-3651315710070586527" onmouseenter="enter('-3651315710070586527');" onmouseout="out('-3651315710070586527');" style=""> 322                 .getDynamicGrid().getDeviceProfile().defaultLayoutId;                                    </span>
<span class="-4806143495772092322" onmouseenter="enter('-4806143495772092322');" onmouseout="out('-4806143495772092322');" style=""> 323         return new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                         </span>
<span class="-4976455824453899875" onmouseenter="enter('-4976455824453899875');" onmouseout="out('-4976455824453899875');" style=""> 324                 mOpenHelper, getContext().getResources(), defaultLayout);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325     }                                                                                                    </span>
<span  style=""> 326                                                                                                          </span>
<span class="-8499205643032210495" onmouseenter="enter('-8499205643032210495');" onmouseout="out('-8499205643032210495');" style=""> 327     public void migrateLauncher2Shortcuts() {                                                            </span>
<span class="-5770271076267441053" onmouseenter="enter('-5770271076267441053');" onmouseout="out('-5770271076267441053');" style=""> 328         mOpenHelper.migrateLauncher2Shortcuts(mOpenHelper.getWritableDatabase(),                         </span>
<span class="-4855681120160555012" onmouseenter="enter('-4855681120160555012');" onmouseout="out('-4855681120160555012');" style=""> 329                 Uri.parse(getContext().getString(R.string.old_launcher_provider_uri)));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330     }                                                                                                    </span>
<span  style=""> 331                                                                                                          </span>
<span class="-5196105730574921781" onmouseenter="enter('-5196105730574921781');" onmouseout="out('-5196105730574921781');" style=""> 332     public void updateFolderItemsRank() {                                                                </span>
<span class="4982456805094611516" onmouseenter="enter('4982456805094611516');" onmouseout="out('4982456805094611516');" style=""> 333         mOpenHelper.updateFolderItemsRank(mOpenHelper.getWritableDatabase(), false);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334     }                                                                                                    </span>
<span  style=""> 335                                                                                                          </span>
<span class="-7861087353469194327" onmouseenter="enter('-7861087353469194327');" onmouseout="out('-7861087353469194327');" style=""> 336     public void deleteDatabase() {                                                                       </span>
<span class="-3081120555997572478" onmouseenter="enter('-3081120555997572478');" onmouseout="out('-3081120555997572478');" style=""> 337         // Are you sure? (y/n)                                                                           </span>
<span class="7599905409028339447" onmouseenter="enter('7599905409028339447');" onmouseout="out('7599905409028339447');" style=""> 338         final SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                     </span>
<span class="4824670475834221257" onmouseenter="enter('4824670475834221257');" onmouseout="out('4824670475834221257');" style=""> 339         final File dbFile = new File(db.getPath());                                                      </span>
<span class="-4378932496508441297" onmouseenter="enter('-4378932496508441297');" onmouseout="out('-4378932496508441297');" style=""> 340         mOpenHelper.close();                                                                             </span>
<span class="-2168275612742463412" onmouseenter="enter('-2168275612742463412');" onmouseout="out('-2168275612742463412');" style=""> 341         if (dbFile.exists()) {                                                                           </span>
<span class="7055278701412747697" onmouseenter="enter('7055278701412747697');" onmouseout="out('7055278701412747697');" style=""> 342             SQLiteDatabase.deleteDatabase(dbFile);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343         }                                                                                                </span>
<span class="1429708216911350032" onmouseenter="enter('1429708216911350032');" onmouseout="out('1429708216911350032');" style=""> 344         mOpenHelper = new DatabaseHelper(getContext());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345     }                                                                                                    </span>
<span  style=""> 346                                                                                                          </span>
<span class="-8073014385313712586" onmouseenter="enter('-8073014385313712586');" onmouseout="out('-8073014385313712586');" style=""> 347     private static class DatabaseHelper extends SQLiteOpenHelper implements LayoutParserCallback {       </span>
<span class="-2672328117217234149" onmouseenter="enter('-2672328117217234149');" onmouseout="out('-2672328117217234149');" style=""> 348         private final Context mContext;                                                                  </span>
<span class="-7815254415381208754" onmouseenter="enter('-7815254415381208754');" onmouseout="out('-7815254415381208754');" style=""> 349         private final AppWidgetHost mAppWidgetHost;                                                      </span>
<span class="256431113711786954" onmouseenter="enter('256431113711786954');" onmouseout="out('256431113711786954');" style=""> 350         private long mMaxItemId = -1;                                                                    </span>
<span class="3024521003496490102" onmouseenter="enter('3024521003496490102');" onmouseout="out('3024521003496490102');" style=""> 351         private long mMaxScreenId = -1;                                                                  </span>
<span  style=""> 352                                                                                                          </span>
<span class="7342788129695687690" onmouseenter="enter('7342788129695687690');" onmouseout="out('7342788129695687690');" style=""> 353         private boolean mNewDbCreated = false;                                                           </span>
<span  style=""> 354                                                                                                          </span>
<span class="1000156088447424124" onmouseenter="enter('1000156088447424124');" onmouseout="out('1000156088447424124');" style=""> 355         DatabaseHelper(Context context) {                                                                </span>
<span class="5450204288644697643" onmouseenter="enter('5450204288644697643');" onmouseout="out('5450204288644697643');" style=""> 356             super(context, LauncherFiles.LAUNCHER_DB, null, DATABASE_VERSION);                           </span>
<span class="7260904205784329196" onmouseenter="enter('7260904205784329196');" onmouseout="out('7260904205784329196');" style=""> 357             mContext = context;                                                                          </span>
<span class="6731257549223913473" onmouseenter="enter('6731257549223913473');" onmouseout="out('6731257549223913473');" style=""> 358             mAppWidgetHost = new AppWidgetHost(context, Launcher.APPWIDGET_HOST_ID);                     </span>
<span  style=""> 359                                                                                                          </span>
<span class="-7119307471557363464" onmouseenter="enter('-7119307471557363464');" onmouseout="out('-7119307471557363464');" style=""> 360             // In the case where neither onCreate nor onUpgrade gets called, we read the maxId from      </span>
<span class="-7146491614936969963" onmouseenter="enter('-7146491614936969963');" onmouseout="out('-7146491614936969963');" style=""> 361             // the DB here                                                                               </span>
<span class="-8239698715373110075" onmouseenter="enter('-8239698715373110075');" onmouseout="out('-8239698715373110075');" style=""> 362             if (mMaxItemId == -1) {                                                                      </span>
<span class="6514208419145701418" onmouseenter="enter('6514208419145701418');" onmouseout="out('6514208419145701418');" style=""> 363                 mMaxItemId = initializeMaxItemId(getWritableDatabase());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364             }                                                                                            </span>
<span class="2158219101093277292" onmouseenter="enter('2158219101093277292');" onmouseout="out('2158219101093277292');" style=""> 365             if (mMaxScreenId == -1) {                                                                    </span>
<span class="-7197865417052699646" onmouseenter="enter('-7197865417052699646');" onmouseout="out('-7197865417052699646');" style=""> 366                 mMaxScreenId = initializeMaxScreenId(getWritableDatabase());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368         }                                                                                                </span>
<span  style=""> 369                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 370         public boolean wasNewDbCreated() {                                                               </span>
<span class="1294520975679493300" onmouseenter="enter('1294520975679493300');" onmouseout="out('1294520975679493300');" style=""> 371             return mNewDbCreated;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372         }                                                                                                </span>
<span  style=""> 373                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 374         /**                                                                                              </span>
<span class="-3713204910685876719" onmouseenter="enter('-3713204910685876719');" onmouseout="out('-3713204910685876719');" style=""> 375          * Send notification that we&#x27;ve deleted the {@link AppWidgetHost},                               </span>
<span class="-5398164636189778479" onmouseenter="enter('-5398164636189778479');" onmouseout="out('-5398164636189778479');" style=""> 376          * probably as part of the initial database creation. The receiver may                           </span>
<span class="-284834762183367019" onmouseenter="enter('-284834762183367019');" onmouseout="out('-284834762183367019');" style=""> 377          * want to re-call {@link AppWidgetHost#startListening()} to ensure                              </span>
<span class="1913597860538764992" onmouseenter="enter('1913597860538764992');" onmouseout="out('1913597860538764992');" style=""> 378          * callbacks are correctly set.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 379          */                                                                                              </span>
<span class="3384745401314169661" onmouseenter="enter('3384745401314169661');" onmouseout="out('3384745401314169661');" style=""> 380         private void sendAppWidgetResetNotify() {                                                        </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 381             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="4149774703050814155" onmouseenter="enter('4149774703050814155');" onmouseout="out('4149774703050814155');" style=""> 382             resolver.notifyChange(CONTENT_APPWIDGET_RESET_URI, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383         }                                                                                                </span>
<span  style=""> 384                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 385         @Override                                                                                        </span>
<span class="3201464308903999877" onmouseenter="enter('3201464308903999877');" onmouseout="out('3201464308903999877');" style=""> 386         public void onCreate(SQLiteDatabase db) {                                                        </span>
<span class="4744685829155971552" onmouseenter="enter('4744685829155971552');" onmouseout="out('4744685829155971552');" style=""> 387             if (LOGD) Log.d(TAG, &quot;creating new launcher database&quot;);                                      </span>
<span  style=""> 388                                                                                                          </span>
<span class="-5512536783286632376" onmouseenter="enter('-5512536783286632376');" onmouseout="out('-5512536783286632376');" style=""> 389             mMaxItemId = 1;                                                                              </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 390             mMaxScreenId = 0;                                                                            </span>
<span class="-3863035699221776712" onmouseenter="enter('-3863035699221776712');" onmouseout="out('-3863035699221776712');" style=""> 391             mNewDbCreated = true;                                                                        </span>
<span  style=""> 392                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 393             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                     </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 394             long userSerialNumber = userManager.getSerialNumberForUser(                                  </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 395                     UserHandleCompat.myUserHandle());                                                    </span>
<span  style=""> 396                                                                                                          </span>
<span class="-5810771542500139933" onmouseenter="enter('-5810771542500139933');" onmouseout="out('-5810771542500139933');" style=""> 397             db.execSQL(&quot;CREATE TABLE favorites (&quot; +                                                      </span>
<span class="-7286867248755276119" onmouseenter="enter('-7286867248755276119');" onmouseout="out('-7286867248755276119');" style=""> 398                     &quot;_id INTEGER PRIMARY KEY,&quot; +                                                         </span>
<span class="5329137835308229169" onmouseenter="enter('5329137835308229169');" onmouseout="out('5329137835308229169');" style=""> 399                     &quot;title TEXT,&quot; +                                                                      </span>
<span class="-7776152072054589061" onmouseenter="enter('-7776152072054589061');" onmouseout="out('-7776152072054589061');" style=""> 400                     &quot;intent TEXT,&quot; +                                                                     </span>
<span class="4982593742089674958" onmouseenter="enter('4982593742089674958');" onmouseout="out('4982593742089674958');" style=""> 401                     &quot;container INTEGER,&quot; +                                                               </span>
<span class="-1871026270657853169" onmouseenter="enter('-1871026270657853169');" onmouseout="out('-1871026270657853169');" style=""> 402                     &quot;screen INTEGER,&quot; +                                                                  </span>
<span class="-9174211260981343890" onmouseenter="enter('-9174211260981343890');" onmouseout="out('-9174211260981343890');" style=""> 403                     &quot;cellX INTEGER,&quot; +                                                                   </span>
<span class="1584772009960348649" onmouseenter="enter('1584772009960348649');" onmouseout="out('1584772009960348649');" style=""> 404                     &quot;cellY INTEGER,&quot; +                                                                   </span>
<span class="5424055190881126727" onmouseenter="enter('5424055190881126727');" onmouseout="out('5424055190881126727');" style=""> 405                     &quot;spanX INTEGER,&quot; +                                                                   </span>
<span class="6553755327503045229" onmouseenter="enter('6553755327503045229');" onmouseout="out('6553755327503045229');" style=""> 406                     &quot;spanY INTEGER,&quot; +                                                                   </span>
<span class="5229848414421823036" onmouseenter="enter('5229848414421823036');" onmouseout="out('5229848414421823036');" style=""> 407                     &quot;itemType INTEGER,&quot; +                                                                </span>
<span class="-1771151571856416667" onmouseenter="enter('-1771151571856416667');" onmouseout="out('-1771151571856416667');" style=""> 408                     &quot;appWidgetId INTEGER NOT NULL DEFAULT -1,&quot; +                                         </span>
<span class="-9047067707489472437" onmouseenter="enter('-9047067707489472437');" onmouseout="out('-9047067707489472437');" style=""> 409                     &quot;isShortcut INTEGER,&quot; +                                                              </span>
<span class="-3445858598434382544" onmouseenter="enter('-3445858598434382544');" onmouseout="out('-3445858598434382544');" style=""> 410                     &quot;iconType INTEGER,&quot; +                                                                </span>
<span class="4279668316006004948" onmouseenter="enter('4279668316006004948');" onmouseout="out('4279668316006004948');" style=""> 411                     &quot;iconPackage TEXT,&quot; +                                                                </span>
<span class="2008284586023778304" onmouseenter="enter('2008284586023778304');" onmouseout="out('2008284586023778304');" style=""> 412                     &quot;iconResource TEXT,&quot; +                                                               </span>
<span class="-5981868381948376489" onmouseenter="enter('-5981868381948376489');" onmouseout="out('-5981868381948376489');" style=""> 413                     &quot;icon BLOB,&quot; +                                                                       </span>
<span class="5686768105176115842" onmouseenter="enter('5686768105176115842');" onmouseout="out('5686768105176115842');" style=""> 414                     &quot;uri TEXT,&quot; +                                                                        </span>
<span class="-5470568819214956502" onmouseenter="enter('-5470568819214956502');" onmouseout="out('-5470568819214956502');" style=""> 415                     &quot;displayMode INTEGER,&quot; +                                                             </span>
<span class="3582502352252677630" onmouseenter="enter('3582502352252677630');" onmouseout="out('3582502352252677630');" style=""> 416                     &quot;appWidgetProvider TEXT,&quot; +                                                          </span>
<span class="4065658841092455651" onmouseenter="enter('4065658841092455651');" onmouseout="out('4065658841092455651');" style=""> 417                     &quot;modified INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="422282607120493296" onmouseenter="enter('422282607120493296');" onmouseout="out('422282607120493296');" style=""> 418                     &quot;restored INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="823907807759654324" onmouseenter="enter('823907807759654324');" onmouseout="out('823907807759654324');" style=""> 419                     &quot;profileId INTEGER DEFAULT &quot; + userSerialNumber + &quot;,&quot; +                              </span>
<span class="-8486149279194715653" onmouseenter="enter('-8486149279194715653');" onmouseout="out('-8486149279194715653');" style=""> 420                     &quot;rank INTEGER NOT NULL DEFAULT 0&quot; +                                                  </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 421                     &quot;);&quot;);                                                                               </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 422             addWorkspacesTable(db);                                                                      </span>
<span  style=""> 423                                                                                                          </span>
<span class="-1982623284376040662" onmouseenter="enter('-1982623284376040662');" onmouseout="out('-1982623284376040662');" style=""> 424             // Database was just created, so wipe any previous widgets                                   </span>
<span class="35469525966995251" onmouseenter="enter('35469525966995251');" onmouseout="out('35469525966995251');" style=""> 425             if (mAppWidgetHost != null) {                                                                </span>
<span class="2879907381293157546" onmouseenter="enter('2879907381293157546');" onmouseout="out('2879907381293157546');" style=""> 426                 mAppWidgetHost.deleteHost();                                                             </span>
<span class="-5770229164268459929" onmouseenter="enter('-5770229164268459929');" onmouseout="out('-5770229164268459929');" style=""> 427                 sendAppWidgetResetNotify();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428             }                                                                                            </span>
<span  style=""> 429                                                                                                          </span>
<span class="-1063142603395313746" onmouseenter="enter('-1063142603395313746');" onmouseout="out('-1063142603395313746');" style=""> 430             // Fresh and clean launcher DB.                                                              </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 431             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="7629543500667828090" onmouseenter="enter('7629543500667828090');" onmouseout="out('7629543500667828090');" style=""> 432             setFlagEmptyDbCreated();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433         }                                                                                                </span>
<span  style=""> 434                                                                                                          </span>
<span class="6272912136443308513" onmouseenter="enter('6272912136443308513');" onmouseout="out('6272912136443308513');" style=""> 435         private void addWorkspacesTable(SQLiteDatabase db) {                                             </span>
<span class="2730049849658983478" onmouseenter="enter('2730049849658983478');" onmouseout="out('2730049849658983478');" style=""> 436             db.execSQL(&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS + &quot; (&quot; +                                </span>
<span class="3055097616701045664" onmouseenter="enter('3055097616701045664');" onmouseout="out('3055097616701045664');" style=""> 437                     LauncherSettings.WorkspaceScreens._ID + &quot; INTEGER PRIMARY KEY,&quot; +                    </span>
<span class="-8340457193420065897" onmouseenter="enter('-8340457193420065897');" onmouseout="out('-8340457193420065897');" style=""> 438                     LauncherSettings.WorkspaceScreens.SCREEN_RANK + &quot; INTEGER,&quot; +                        </span>
<span class="7771125962287368960" onmouseenter="enter('7771125962287368960');" onmouseout="out('7771125962287368960');" style=""> 439                     LauncherSettings.ChangeLogColumns.MODIFIED + &quot; INTEGER NOT NULL DEFAULT 0&quot; +         </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 440                     &quot;);&quot;);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441         }                                                                                                </span>
<span  style=""> 442                                                                                                          </span>
<span class="-3232037806458942317" onmouseenter="enter('-3232037806458942317');" onmouseout="out('-3232037806458942317');" style=""> 443         private void removeOrphanedItems(SQLiteDatabase db) {                                            </span>
<span class="-3995909494643948388" onmouseenter="enter('-3995909494643948388');" onmouseout="out('-3995909494643948388');" style=""> 444             // Delete items directly on the workspace who&#x27;s screen id doesn&#x27;t exist                      </span>
<span class="6555258266445461688" onmouseenter="enter('6555258266445461688');" onmouseout="out('6555258266445461688');" style=""> 445             //  &quot;DELETE FROM favorites WHERE screen NOT IN (SELECT _id FROM workspaceScreens)            </span>
<span class="-1584785563187965465" onmouseenter="enter('-1584785563187965465');" onmouseout="out('-1584785563187965465');" style=""> 446             //   AND container = -100&quot;                                                                   </span>
<span class="-3502523792993972030" onmouseenter="enter('-3502523792993972030');" onmouseout="out('-3502523792993972030');" style=""> 447             String removeOrphanedDesktopItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                       </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 448                     &quot; WHERE &quot; +                                                                          </span>
<span class="-8781539607986806909" onmouseenter="enter('-8781539607986806909');" onmouseout="out('-8781539607986806909');" style=""> 449                     LauncherSettings.Favorites.SCREEN + &quot; NOT IN (SELECT &quot; +                             </span>
<span class="-3730067412022302503" onmouseenter="enter('-3730067412022302503');" onmouseout="out('-3730067412022302503');" style=""> 450                     LauncherSettings.WorkspaceScreens._ID + &quot; FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot;)&quot; +   </span>
<span class="8831213357842987069" onmouseenter="enter('8831213357842987069');" onmouseout="out('8831213357842987069');" style=""> 451                     &quot; AND &quot; +                                                                            </span>
<span class="-3912897749337440213" onmouseenter="enter('-3912897749337440213');" onmouseout="out('-3912897749337440213');" style=""> 452                     LauncherSettings.Favorites.CONTAINER + &quot; = &quot; +                                       </span>
<span class="-1572782876841487653" onmouseenter="enter('-1572782876841487653');" onmouseout="out('-1572782876841487653');" style=""> 453                     LauncherSettings.Favorites.CONTAINER_DESKTOP;                                        </span>
<span class="-5442680607495552531" onmouseenter="enter('-5442680607495552531');" onmouseout="out('-5442680607495552531');" style=""> 454             db.execSQL(removeOrphanedDesktopItems);                                                      </span>
<span  style=""> 455                                                                                                          </span>
<span class="2150462606818952724" onmouseenter="enter('2150462606818952724');" onmouseout="out('2150462606818952724');" style=""> 456             // Delete items contained in folders which no longer exist (after above statement)           </span>
<span class="7157590486959116676" onmouseenter="enter('7157590486959116676');" onmouseout="out('7157590486959116676');" style=""> 457             //  &quot;DELETE FROM favorites  WHERE container &lt;&gt; -100 AND container &lt;&gt; -101 AND container      </span>
<span class="4713393280747800603" onmouseenter="enter('4713393280747800603');" onmouseout="out('4713393280747800603');" style=""> 458             //   NOT IN (SELECT _id FROM favorites WHERE itemType = 2)&quot;                                  </span>
<span class="-8895952306054120744" onmouseenter="enter('-8895952306054120744');" onmouseout="out('-8895952306054120744');" style=""> 459             String removeOrphanedFolderItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 460                     &quot; WHERE &quot; +                                                                          </span>
<span class="-9165304043886914201" onmouseenter="enter('-9165304043886914201');" onmouseout="out('-9165304043886914201');" style=""> 461                     LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                      </span>
<span class="2430974176390543784" onmouseenter="enter('2430974176390543784');" onmouseout="out('2430974176390543784');" style=""> 462                     LauncherSettings.Favorites.CONTAINER_DESKTOP +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 463                     &quot; AND &quot;                                                                              </span>
<span class="5144458996296891504" onmouseenter="enter('5144458996296891504');" onmouseout="out('5144458996296891504');" style=""> 464                     + LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                    </span>
<span class="20571678636460503" onmouseenter="enter('20571678636460503');" onmouseout="out('20571678636460503');" style=""> 465                     LauncherSettings.Favorites.CONTAINER_HOTSEAT +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 466                     &quot; AND &quot;                                                                              </span>
<span class="-4280152506863766824" onmouseenter="enter('-4280152506863766824');" onmouseout="out('-4280152506863766824');" style=""> 467                     + LauncherSettings.Favorites.CONTAINER + &quot; NOT IN (SELECT &quot; +                        </span>
<span class="-971280935083657149" onmouseenter="enter('-971280935083657149');" onmouseout="out('-971280935083657149');" style=""> 468                     LauncherSettings.Favorites._ID + &quot; FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="4038942553560789906" onmouseenter="enter('4038942553560789906');" onmouseout="out('4038942553560789906');" style=""> 469                     &quot; WHERE &quot; + LauncherSettings.Favorites.ITEM_TYPE + &quot; = &quot; +                           </span>
<span class="-1734962565729646321" onmouseenter="enter('-1734962565729646321');" onmouseout="out('-1734962565729646321');" style=""> 470                     LauncherSettings.Favorites.ITEM_TYPE_FOLDER + &quot;)&quot;;                                   </span>
<span class="-8852316947474253726" onmouseenter="enter('-8852316947474253726');" onmouseout="out('-8852316947474253726');" style=""> 471             db.execSQL(removeOrphanedFolderItems);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472         }                                                                                                </span>
<span  style=""> 473                                                                                                          </span>
<span class="-2961433455992777066" onmouseenter="enter('-2961433455992777066');" onmouseout="out('-2961433455992777066');" style=""> 474         private void setFlagJustLoadedOldDb() {                                                          </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 475             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 476             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="6248178474895602573" onmouseenter="enter('6248178474895602573');" onmouseout="out('6248178474895602573');" style=""> 477             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, false).commit();                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478         }                                                                                                </span>
<span  style=""> 479                                                                                                          </span>
<span class="3580170518454540960" onmouseenter="enter('3580170518454540960');" onmouseout="out('3580170518454540960');" style=""> 480         private void setFlagEmptyDbCreated() {                                                           </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 481             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 482             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="-1598905447100916131" onmouseenter="enter('-1598905447100916131');" onmouseout="out('-1598905447100916131');" style=""> 483             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, true).commit();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484         }                                                                                                </span>
<span  style=""> 485                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 486         @Override                                                                                        </span>
<span class="-4655538025867202729" onmouseenter="enter('-4655538025867202729');" onmouseout="out('-4655538025867202729');" style=""> 487         public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {                       </span>
<span class="-3337256987478665120" onmouseenter="enter('-3337256987478665120');" onmouseout="out('-3337256987478665120');" style=""> 488             if (LOGD) Log.d(TAG, &quot;onUpgrade triggered: &quot; + oldVersion);                                  </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 489             switch (oldVersion) {                                                                        </span>
<span class="9079869636182330080" onmouseenter="enter('9079869636182330080');" onmouseout="out('9079869636182330080');" style=""> 490                 // The version cannot be lower that 12, as Launcher3 never supported a lower             </span>
<span class="-4883409179661970227" onmouseenter="enter('-4883409179661970227');" onmouseout="out('-4883409179661970227');" style=""> 491                 // version of the DB.                                                                    </span>
<span class="3359875150199815819" onmouseenter="enter('3359875150199815819');" onmouseout="out('3359875150199815819');" style=""> 492                 case 12: {                                                                               </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style=""> 493                     // With the new shrink-wrapped and re-orderable workspaces, it makes sense           </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style=""> 494                     // to persist workspace screens and their relative order.                            </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 495                     mMaxScreenId = 0;                                                                    </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 496                     addWorkspacesTable(db);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497                 }                                                                                        </span>
<span class="-3873917579330875824" onmouseenter="enter('-3873917579330875824');" onmouseout="out('-3873917579330875824');" style=""> 498                 case 13: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 499                     db.beginTransaction();                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 500                     try {                                                                                </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style=""> 501                         // Insert new column for holding widget provider name                            </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 502                         db.execSQL(&quot;ALTER TABLE favorites &quot; +                                            </span>
<span class="-1191376551368325446" onmouseenter="enter('-1191376551368325446');" onmouseout="out('-1191376551368325446');" style=""> 503                                 &quot;ADD COLUMN appWidgetProvider TEXT;&quot;);                                   </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 504                         db.setTransactionSuccessful();                                                   </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 505                     } catch (SQLException ex) {                                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 506                         Log.e(TAG, ex.getMessage(), ex);                                                 </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 507                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 508                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 509                     } finally {                                                                          </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 510                         db.endTransaction();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                 }                                                                                        </span>
<span class="8507938363259012736" onmouseenter="enter('8507938363259012736');" onmouseout="out('8507938363259012736');" style=""> 513                 case 14: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 514                     db.beginTransaction();                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 515                     try {                                                                                </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style=""> 516                         // Insert new column for holding update timestamp                                </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 517                         db.execSQL(&quot;ALTER TABLE favorites &quot; +                                            </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 518                                 &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                      </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style=""> 519                         db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                     </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 520                                 &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                      </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 521                         db.setTransactionSuccessful();                                                   </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 522                     } catch (SQLException ex) {                                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 523                         Log.e(TAG, ex.getMessage(), ex);                                                 </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 524                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 525                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 526                     } finally {                                                                          </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 527                         db.endTransaction();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529                 }                                                                                        </span>
<span class="8561964280724983620" onmouseenter="enter('8561964280724983620');" onmouseout="out('8561964280724983620');" style=""> 530                 case 15: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 531                     db.beginTransaction();                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 532                     try {                                                                                </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style=""> 533                         // Insert new column for holding restore status                                  </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 534                         db.execSQL(&quot;ALTER TABLE favorites &quot; +                                            </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style=""> 535                                 &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                      </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 536                         db.setTransactionSuccessful();                                                   </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 537                     } catch (SQLException ex) {                                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 538                         Log.e(TAG, ex.getMessage(), ex);                                                 </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 539                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 540                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 541                     } finally {                                                                          </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 542                         db.endTransaction();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544                 }                                                                                        </span>
<span class="7575290899313355683" onmouseenter="enter('7575290899313355683');" onmouseout="out('7575290899313355683');" style=""> 545                 case 16: {                                                                               </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style=""> 546                     // We use the db version upgrade here to identify users who may not have seen        </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style=""> 547                     // clings yet (because they weren&#x27;t available), but for whom the clings are now      </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style=""> 548                     // available (tablet users). Because one of the possible cling flows (migration)     </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style=""> 549                     // is very destructive (wipes out workspaces), we want to prevent this from showing  </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style=""> 550                     // until clear data. We do so by marking that the clings have been shown.            </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style=""> 551                     LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552                 }                                                                                        </span>
<span class="874358258533148680" onmouseenter="enter('874358258533148680');" onmouseout="out('874358258533148680');" style=""> 553                 case 17: {                                                                               </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style=""> 554                     // No-op                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555                 }                                                                                        </span>
<span class="7290242482342203768" onmouseenter="enter('7290242482342203768');" onmouseout="out('7290242482342203768');" style=""> 556                 case 18: {                                                                               </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style=""> 557                     // Due to a data loss bug, some users may have items associated with screen ids      </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style=""> 558                     // which no longer exist. Since this can cause other problems, and since the user    </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style=""> 559                     // will never see these items anyway, we use database upgrade as an opportunity to   </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style=""> 560                     // clean things up.                                                                  </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style=""> 561                     removeOrphanedItems(db);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 562                 }                                                                                        </span>
<span class="2857663073964692700" onmouseenter="enter('2857663073964692700');" onmouseout="out('2857663073964692700');" style=""> 563                 case 19: {                                                                               </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style=""> 564                     // Add userId column                                                                 </span>
<span class="2862263159714553199" onmouseenter="enter('2862263159714553199');" onmouseout="out('2862263159714553199');" style=""> 565                     if (!addProfileColumn(db)) {                                                         </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 566                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 567                         break;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 569                 }                                                                                        </span>
<span class="-901653241001302481" onmouseenter="enter('-901653241001302481');" onmouseout="out('-901653241001302481');" style=""> 570                 case 20:                                                                                 </span>
<span class="-5016813644414129178" onmouseenter="enter('-5016813644414129178');" onmouseout="out('-5016813644414129178');" style=""> 571                     if (!updateFolderItemsRank(db, true)) {                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 572                         break;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573                     }                                                                                    </span>
<span class="-7447648558388390989" onmouseenter="enter('-7447648558388390989');" onmouseout="out('-7447648558388390989');" style=""> 574                 case 21: {                                                                               </span>
<span class="8949931370118151818" onmouseenter="enter('8949931370118151818');" onmouseout="out('8949931370118151818');" style=""> 575                     // DB Upgraded successfully                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 576                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578             }                                                                                            </span>
<span  style=""> 579                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 580 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-498940447290760811" onmouseenter="enter('-498940447290760811');" onmouseout="out('-498940447290760811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 581             // DB was not upgraded                                                                       </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 582             Log.w(TAG, &quot;Destroying all old data.&quot;);                                                      </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 583             createEmptyDB(db);                                                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 584 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4742571203445114157" onmouseenter="enter('4742571203445114157');" onmouseout="out('4742571203445114157');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 585             if (version &lt; 15) {                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 586                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 587                 try {                                                                                    </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 588                     // Insert new column for holding update timestamp                                    </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 589                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 590                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 591                     db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                         </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 592                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 593                     db.setTransactionSuccessful();                                                       </span>
<span class="8988210671545584151" onmouseenter="enter('8988210671545584151');" onmouseout="out('8988210671545584151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 594                     version = 15;                                                                        </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 595                 } catch (SQLException ex) {                                                              </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 596                     // Old version remains, which means we wipe old data                                 </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 597                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 598                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 599                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 600                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 601             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 602                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 603                                                                                                          </span>
<span class="1076365416612257192" onmouseenter="enter('1076365416612257192');" onmouseout="out('1076365416612257192');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 604             if (version &lt; 16) {                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 605                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 606                 try {                                                                                    </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 607                     // Insert new column for holding restore status                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 608                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 609                             &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 610                     db.setTransactionSuccessful();                                                       </span>
<span class="2013829968714493382" onmouseenter="enter('2013829968714493382');" onmouseout="out('2013829968714493382');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 611                     version = 16;                                                                        </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 612                 } catch (SQLException ex) {                                                              </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 613                     // Old version remains, which means we wipe old data                                 </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 614                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 615                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 616                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 617                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 618             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 619                                                                                                          </span>
<span class="-6756468306354214848" onmouseenter="enter('-6756468306354214848');" onmouseout="out('-6756468306354214848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 620             if (version &lt; 17) {                                                                          </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 621                 // We use the db version upgrade here to identify users who may not have seen            </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 622                 // clings yet (because they weren&#x27;t available), but for whom the clings are now          </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 623                 // available (tablet users). Because one of the possible cling flows (migration)         </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 624                 // is very destructive (wipes out workspaces), we want to prevent this from showing      </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 625                 // until clear data. We do so by marking that the clings have been shown.                </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 626                 LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                         </span>
<span class="-3652383409155171451" onmouseenter="enter('-3652383409155171451');" onmouseout="out('-3652383409155171451');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 627                 version = 17;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 628             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 629                                                                                                          </span>
<span class="7817650129783202172" onmouseenter="enter('7817650129783202172');" onmouseout="out('7817650129783202172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 630             if (version &lt; 18) {                                                                          </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 631                 // No-op                                                                                 </span>
<span class="-862393984298106042" onmouseenter="enter('-862393984298106042');" onmouseout="out('-862393984298106042');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 632                 version = 18;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 633             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 634                                                                                                          </span>
<span class="-3427379715691059477" onmouseenter="enter('-3427379715691059477');" onmouseout="out('-3427379715691059477');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 635             if (version &lt; 19) {                                                                          </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 636                 // Due to a data loss bug, some users may have items associated with screen ids          </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 637                 // which no longer exist. Since this can cause other problems, and since the user        </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 638                 // will never see these items anyway, we use database upgrade as an opportunity to       </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 639                 // clean things up.                                                                      </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 640                 removeOrphanedItems(db);                                                                 </span>
<span class="-8622797196606405802" onmouseenter="enter('-8622797196606405802');" onmouseout="out('-8622797196606405802');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 641                 version = 19;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 642             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 643                                                                                                          </span>
<span class="7499725911390962675" onmouseenter="enter('7499725911390962675');" onmouseout="out('7499725911390962675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 644             if (version &lt; 20) {                                                                          </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 645                 // Add userId column                                                                     </span>
<span class="3648122535018422218" onmouseenter="enter('3648122535018422218');" onmouseout="out('3648122535018422218');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 646                 if (addProfileColumn(db)) {                                                              </span>
<span class="-3196204954256045340" onmouseenter="enter('-3196204954256045340');" onmouseout="out('-3196204954256045340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 647                     version = 20;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 648                 }                                                                                        </span>
<span class="-7922924049235754756" onmouseenter="enter('-7922924049235754756');" onmouseout="out('-7922924049235754756');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 649                 // else old version remains, which means we wipe old data                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 650             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 651                                                                                                          </span>
<span class="-1689277129606306081" onmouseenter="enter('-1689277129606306081');" onmouseout="out('-1689277129606306081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 652             if (version &lt; 21) {                                                                          </span>
<span class="-7646592925974879249" onmouseenter="enter('-7646592925974879249');" onmouseout="out('-7646592925974879249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 653                 if (updateFolderItemsRank(db, true)) {                                                   </span>
<span class="8220648455759030377" onmouseenter="enter('8220648455759030377');" onmouseout="out('8220648455759030377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 654                     version  = 21;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 655                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 656             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 657                                                                                                          </span>
<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 658             if (version != DATABASE_VERSION) {                                                           </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 659                 Log.w(TAG, &quot;Destroying all old data.&quot;);                                                  </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 660                 createEmptyDB(db);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 661             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 662         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 663                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 664         @Override                                                                                        </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 665         public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                     </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 666             // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                    </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 667             Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +          </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 668                     &quot;. Wiping databse.&quot;);                                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 669 =======                                                                                                  </span>
<span class="4742571203445114157" onmouseenter="enter('4742571203445114157');" onmouseout="out('4742571203445114157');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670             if (version &lt; 15) {                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672                 try {                                                                                    </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673                     // Insert new column for holding update timestamp                                    </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                     db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                         </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678                     db.setTransactionSuccessful();                                                       </span>
<span class="8988210671545584151" onmouseenter="enter('8988210671545584151');" onmouseout="out('8988210671545584151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679                     version = 15;                                                                        </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680                 } catch (SQLException ex) {                                                              </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681                     // Old version remains, which means we wipe old data                                 </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688                                                                                                          </span>
<span class="1076365416612257192" onmouseenter="enter('1076365416612257192');" onmouseout="out('1076365416612257192');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689             if (version &lt; 16) {                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691                 try {                                                                                    </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692                     // Insert new column for holding restore status                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694                             &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695                     db.setTransactionSuccessful();                                                       </span>
<span class="2013829968714493382" onmouseenter="enter('2013829968714493382');" onmouseout="out('2013829968714493382');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696                     version = 16;                                                                        </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697                 } catch (SQLException ex) {                                                              </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                     // Old version remains, which means we wipe old data                                 </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704                                                                                                          </span>
<span class="-6756468306354214848" onmouseenter="enter('-6756468306354214848');" onmouseout="out('-6756468306354214848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705             if (version &lt; 17) {                                                                          </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706                 // We use the db version upgrade here to identify users who may not have seen            </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707                 // clings yet (because they weren&#x27;t available), but for whom the clings are now          </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708                 // available (tablet users). Because one of the possible cling flows (migration)         </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709                 // is very destructive (wipes out workspaces), we want to prevent this from showing      </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710                 // until clear data. We do so by marking that the clings have been shown.                </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711                 LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                         </span>
<span class="-3652383409155171451" onmouseenter="enter('-3652383409155171451');" onmouseout="out('-3652383409155171451');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712                 version = 17;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714                                                                                                          </span>
<span class="7817650129783202172" onmouseenter="enter('7817650129783202172');" onmouseout="out('7817650129783202172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715             if (version &lt; 18) {                                                                          </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716                 // No-op                                                                                 </span>
<span class="-862393984298106042" onmouseenter="enter('-862393984298106042');" onmouseout="out('-862393984298106042');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717                 version = 18;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719                                                                                                          </span>
<span class="-3427379715691059477" onmouseenter="enter('-3427379715691059477');" onmouseout="out('-3427379715691059477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720             if (version &lt; 19) {                                                                          </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721                 // Due to a data loss bug, some users may have items associated with screen ids          </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722                 // which no longer exist. Since this can cause other problems, and since the user        </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723                 // will never see these items anyway, we use database upgrade as an opportunity to       </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724                 // clean things up.                                                                      </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725                 removeOrphanedItems(db);                                                                 </span>
<span class="-8622797196606405802" onmouseenter="enter('-8622797196606405802');" onmouseout="out('-8622797196606405802');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726                 version = 19;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728                                                                                                          </span>
<span class="7499725911390962675" onmouseenter="enter('7499725911390962675');" onmouseout="out('7499725911390962675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729             if (version &lt; 20) {                                                                          </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                 // Add userId column                                                                     </span>
<span class="3648122535018422218" onmouseenter="enter('3648122535018422218');" onmouseout="out('3648122535018422218');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731                 if (addProfileColumn(db)) {                                                              </span>
<span class="-3196204954256045340" onmouseenter="enter('-3196204954256045340');" onmouseout="out('-3196204954256045340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732                     version = 20;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733                 }                                                                                        </span>
<span class="-7922924049235754756" onmouseenter="enter('-7922924049235754756');" onmouseout="out('-7922924049235754756');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734                 // else old version remains, which means we wipe old data                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736                                                                                                          </span>
<span class="-1689277129606306081" onmouseenter="enter('-1689277129606306081');" onmouseout="out('-1689277129606306081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737             if (version &lt; 21) {                                                                          </span>
<span class="-7646592925974879249" onmouseenter="enter('-7646592925974879249');" onmouseout="out('-7646592925974879249');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738                 if (updateFolderItemsRank(db, true)) {                                                   </span>
<span class="8220648455759030377" onmouseenter="enter('8220648455759030377');" onmouseout="out('8220648455759030377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739                     version  = 21;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742                                                                                                          </span>
<span class="-4846602042225353550" onmouseenter="enter('-4846602042225353550');" onmouseout="out('-4846602042225353550');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743             if (version == 21) {                                                                         </span>
<span class="-5097001155547350088" onmouseenter="enter('-5097001155547350088');" onmouseout="out('-5097001155547350088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744                 // Recreate workspace table with screen id a primary key                                 </span>
<span class="697484093328969732" onmouseenter="enter('697484093328969732');" onmouseout="out('697484093328969732');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 745                 if (recreateWorkspaceTable(db)) {                                                        </span>
<span class="987773274296909165" onmouseenter="enter('987773274296909165');" onmouseout="out('987773274296909165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746                     version = 22;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749                                                                                                          </span>
<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750             if (version != DATABASE_VERSION) {                                                           </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                 Log.w(TAG, &quot;Destroying all old data.&quot;);                                                  </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752                 createEmptyDB(db);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753             }                                                                                            </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 754 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 755         }                                                                                                </span>
<span  style=""> 756                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 757         @Override                                                                                        </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style=""> 758         public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                     </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style=""> 759             // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                    </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style=""> 760             Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +          </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style=""> 761                     &quot;. Wiping databse.&quot;);                                                                </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 762             createEmptyDB(db);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 763         }                                                                                                </span>
<span  style=""> 764                                                                                                          </span>
<span  style=""> 765                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 766         /**                                                                                              </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 767          * Clears all the data for a fresh start.                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 768          */                                                                                              </span>
<span class="3436200006891248330" onmouseenter="enter('3436200006891248330');" onmouseout="out('3436200006891248330');" style=""> 769         public void createEmptyDB(SQLiteDatabase db) {                                                   </span>
<span class="-5910745818286558462" onmouseenter="enter('-5910745818286558462');" onmouseout="out('-5910745818286558462');" style=""> 770             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_FAVORITES);                                       </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 771             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                               </span>
<span class="1466158746107327510" onmouseenter="enter('1466158746107327510');" onmouseout="out('1466158746107327510');" style=""> 772             onCreate(db);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 773         }                                                                                                </span>
<span  style=""> 774                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 775         /**                                                                                              </span>
<span class="-1053110313716749360" onmouseenter="enter('-1053110313716749360');" onmouseout="out('-1053110313716749360');" style=""> 776          * Recreates workspace table and migrates data to the new table.                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 777          */                                                                                              </span>
<span class="-7546703806174777110" onmouseenter="enter('-7546703806174777110');" onmouseout="out('-7546703806174777110');" style=""> 778         public boolean recreateWorkspaceTable(SQLiteDatabase db) {                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 779             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 780             try {                                                                                        </span>
<span class="5182132674792153706" onmouseenter="enter('5182132674792153706');" onmouseout="out('5182132674792153706');" style=""> 781                 Cursor c = db.query(TABLE_WORKSPACE_SCREENS,                                             </span>
<span class="3343280592061827584" onmouseenter="enter('3343280592061827584');" onmouseout="out('3343280592061827584');" style=""> 782                         new String[] {LauncherSettings.WorkspaceScreens._ID},                            </span>
<span class="2929567931923591515" onmouseenter="enter('2929567931923591515');" onmouseout="out('2929567931923591515');" style=""> 783                         null, null, null, null,                                                          </span>
<span class="5916017515631826997" onmouseenter="enter('5916017515631826997');" onmouseout="out('5916017515631826997');" style=""> 784                         LauncherSettings.WorkspaceScreens.SCREEN_RANK);                                  </span>
<span class="-1823344416972566514" onmouseenter="enter('-1823344416972566514');" onmouseout="out('-1823344416972566514');" style=""> 785                 ArrayList&lt;Long&gt; sortedIDs = new ArrayList&lt;Long&gt;();                                       </span>
<span class="4402015381954986250" onmouseenter="enter('4402015381954986250');" onmouseout="out('4402015381954986250');" style=""> 786                 long maxId = 0;                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 787                 try {                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 788                     while (c.moveToNext()) {                                                             </span>
<span class="3955822985937591936" onmouseenter="enter('3955822985937591936');" onmouseout="out('3955822985937591936');" style=""> 789                         Long id = c.getLong(0);                                                          </span>
<span class="-8099018151679223899" onmouseenter="enter('-8099018151679223899');" onmouseout="out('-8099018151679223899');" style=""> 790                         if (!sortedIDs.contains(id)) {                                                   </span>
<span class="4916945519325465611" onmouseenter="enter('4916945519325465611');" onmouseout="out('4916945519325465611');" style=""> 791                             sortedIDs.add(id);                                                           </span>
<span class="2021292296450644008" onmouseenter="enter('2021292296450644008');" onmouseout="out('2021292296450644008');" style=""> 792                             maxId = Math.max(maxId, id);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 793                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 794                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 795                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 796                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797                 }                                                                                        </span>
<span  style=""> 798                                                                                                          </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 799                 db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                           </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 800                 addWorkspacesTable(db);                                                                  </span>
<span  style=""> 801                                                                                                          </span>
<span class="-8504221546344504536" onmouseenter="enter('-8504221546344504536');" onmouseout="out('-8504221546344504536');" style=""> 802                 // Add all screen ids back                                                               </span>
<span class="-3342479167869315002" onmouseenter="enter('-3342479167869315002');" onmouseout="out('-3342479167869315002');" style=""> 803                 int total = sortedIDs.size();                                                            </span>
<span class="1933062560544426975" onmouseenter="enter('1933062560544426975');" onmouseout="out('1933062560544426975');" style=""> 804                 for (int i = 0; i &lt; total; i++) {                                                        </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 805                     ContentValues values = new ContentValues();                                          </span>
<span class="-1408476222282542161" onmouseenter="enter('-1408476222282542161');" onmouseout="out('-1408476222282542161');" style=""> 806                     values.put(LauncherSettings.WorkspaceScreens._ID, sortedIDs.get(i));                 </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style=""> 807                     values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                        </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 808                     addModifiedTime(values);                                                             </span>
<span class="-5345205574848137989" onmouseenter="enter('-5345205574848137989');" onmouseout="out('-5345205574848137989');" style=""> 809                     db.insertOrThrow(TABLE_WORKSPACE_SCREENS, null, values);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 810                 }                                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 811                 db.setTransactionSuccessful();                                                           </span>
<span class="-777319983275495791" onmouseenter="enter('-777319983275495791');" onmouseout="out('-777319983275495791');" style=""> 812                 mMaxScreenId = maxId;                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 813             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 814                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 815                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 816                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 817             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 818                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 819             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 820             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 821         }                                                                                                </span>
<span  style=""> 822                                                                                                          </span>
<span class="-7501286576844846445" onmouseenter="enter('-7501286576844846445');" onmouseout="out('-7501286576844846445');" style=""> 823         private boolean updateFolderItemsRank(SQLiteDatabase db, boolean addRankColumn) {                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 824             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 825             try {                                                                                        </span>
<span class="5008547084206266322" onmouseenter="enter('5008547084206266322');" onmouseout="out('5008547084206266322');" style=""> 826                 if (addRankColumn) {                                                                     </span>
<span class="-7289454301230657535" onmouseenter="enter('-7289454301230657535');" onmouseout="out('-7289454301230657535');" style=""> 827                     // Insert new column for holding rank                                                </span>
<span class="-1590113536171608350" onmouseenter="enter('-1590113536171608350');" onmouseout="out('-1590113536171608350');" style=""> 828                     db.execSQL(&quot;ALTER TABLE favorites ADD COLUMN rank INTEGER NOT NULL DEFAULT 0;&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 829                 }                                                                                        </span>
<span  style=""> 830                                                                                                          </span>
<span class="-6084339731876053459" onmouseenter="enter('-6084339731876053459');" onmouseout="out('-6084339731876053459');" style=""> 831                 // Get a map for folder ID to folder width                                               </span>
<span class="7958578721408666232" onmouseenter="enter('7958578721408666232');" onmouseout="out('7958578721408666232');" style=""> 832                 Cursor c = db.rawQuery(&quot;SELECT container, MAX(cellX) FROM favorites&quot;                     </span>
<span class="1296304159181878428" onmouseenter="enter('1296304159181878428');" onmouseout="out('1296304159181878428');" style=""> 833                         + &quot; WHERE container IN (SELECT _id FROM favorites WHERE itemType = ?)&quot;           </span>
<span class="8240981592991850481" onmouseenter="enter('8240981592991850481');" onmouseout="out('8240981592991850481');" style=""> 834                         + &quot; GROUP BY container;&quot;,                                                        </span>
<span class="-3631725497478036647" onmouseenter="enter('-3631725497478036647');" onmouseout="out('-3631725497478036647');" style=""> 835                         new String[] {Integer.toString(LauncherSettings.Favorites.ITEM_TYPE_FOLDER)});   </span>
<span  style=""> 836                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 837                 while (c.moveToNext()) {                                                                 </span>
<span class="-6809072711155135098" onmouseenter="enter('-6809072711155135098');" onmouseout="out('-6809072711155135098');" style=""> 838                     db.execSQL(&quot;UPDATE favorites SET rank=cellX+(cellY*?) WHERE &quot;                        </span>
<span class="8697652523066470339" onmouseenter="enter('8697652523066470339');" onmouseout="out('8697652523066470339');" style=""> 839                             + &quot;container=? AND cellX IS NOT NULL AND cellY IS NOT NULL;&quot;,                </span>
<span class="-3010724386050799789" onmouseenter="enter('-3010724386050799789');" onmouseout="out('-3010724386050799789');" style=""> 840                             new Object[] {c.getLong(1) + 1, c.getLong(0)});                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 841                 }                                                                                        </span>
<span  style=""> 842                                                                                                          </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 843                 c.close();                                                                               </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 844                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 845             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 846                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 847                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 848                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 849             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 850                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 851             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 852             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 853         }                                                                                                </span>
<span  style=""> 854                                                                                                          </span>
<span class="-4559468305095454841" onmouseenter="enter('-4559468305095454841');" onmouseout="out('-4559468305095454841');" style=""> 855         private boolean addProfileColumn(SQLiteDatabase db) {                                            </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 856             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 857             try {                                                                                        </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 858                 UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                 </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 859                 // Default to the serial number of this user, for older                                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 860                 // shortcuts.                                                                            </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 861                 long userSerialNumber = userManager.getSerialNumberForUser(                              </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 862                         UserHandleCompat.myUserHandle());                                                </span>
<span class="-7537890297935646580" onmouseenter="enter('-7537890297935646580');" onmouseout="out('-7537890297935646580');" style=""> 863                 // Insert new column for holding user serial number                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 864                 db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                    </span>
<span class="6389325795698900878" onmouseenter="enter('6389325795698900878');" onmouseout="out('6389325795698900878');" style=""> 865                         &quot;ADD COLUMN profileId INTEGER DEFAULT &quot;                                          </span>
<span class="-6027465318491077769" onmouseenter="enter('-6027465318491077769');" onmouseout="out('-6027465318491077769');" style=""> 866                                         + userSerialNumber + &quot;;&quot;);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 867                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 868             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 869                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 870                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 871                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 872             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 873                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 874             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 875             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 876         }                                                                                                </span>
<span  style=""> 877                                                                                                          </span>
<span class="-8543343401238088250" onmouseenter="enter('-8543343401238088250');" onmouseout="out('-8543343401238088250');" style=""> 878         // Generates a new ID to use for an object in your database. This method should be only          </span>
<span class="-535999813132446250" onmouseenter="enter('-535999813132446250');" onmouseout="out('-535999813132446250');" style=""> 879         // called from the main UI thread. As an exception, we do call it when we call the               </span>
<span class="-3416944691245960228" onmouseenter="enter('-3416944691245960228');" onmouseout="out('-3416944691245960228');" style=""> 880         // constructor from the worker thread; however, this doesn&#x27;t extend until after the              </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 881         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 882         // after that point                                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 883         @Override                                                                                        </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 884         public long generateNewItemId() {                                                                </span>
<span class="2999684209048406821" onmouseenter="enter('2999684209048406821');" onmouseout="out('2999684209048406821');" style=""> 885             if (mMaxItemId &lt; 0) {                                                                        </span>
<span class="-7068859972649181897" onmouseenter="enter('-7068859972649181897');" onmouseout="out('-7068859972649181897');" style=""> 886                 throw new RuntimeException(&quot;Error: max item id was not initialized&quot;);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 887             }                                                                                            </span>
<span class="-2732750815463784999" onmouseenter="enter('-2732750815463784999');" onmouseout="out('-2732750815463784999');" style=""> 888             mMaxItemId += 1;                                                                             </span>
<span class="5456580978366825274" onmouseenter="enter('5456580978366825274');" onmouseout="out('5456580978366825274');" style=""> 889             return mMaxItemId;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 890         }                                                                                                </span>
<span  style=""> 891                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 892         @Override                                                                                        </span>
<span class="329443540154066398" onmouseenter="enter('329443540154066398');" onmouseout="out('329443540154066398');" style=""> 893         public long insertAndCheck(SQLiteDatabase db, ContentValues values) {                            </span>
<span class="-1505151618823806706" onmouseenter="enter('-1505151618823806706');" onmouseout="out('-1505151618823806706');" style=""> 894             return dbInsertAndCheck(this, db, TABLE_FAVORITES, null, values);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 895         }                                                                                                </span>
<span  style=""> 896                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 897         public void updateMaxItemId(long id) {                                                           </span>
<span class="-6849429476525109058" onmouseenter="enter('-6849429476525109058');" onmouseout="out('-6849429476525109058');" style=""> 898             mMaxItemId = id + 1;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 899         }                                                                                                </span>
<span  style=""> 900                                                                                                          </span>
<span class="-7367368828761155068" onmouseenter="enter('-7367368828761155068');" onmouseout="out('-7367368828761155068');" style=""> 901         public void checkId(String table, ContentValues values) {                                        </span>
<span class="-1608142162103033850" onmouseenter="enter('-1608142162103033850');" onmouseout="out('-1608142162103033850');" style=""> 902             long id = values.getAsLong(LauncherSettings.BaseLauncherColumns._ID);                        </span>
<span class="-6900211224990683940" onmouseenter="enter('-6900211224990683940');" onmouseout="out('-6900211224990683940');" style=""> 903             if (table == LauncherProvider.TABLE_WORKSPACE_SCREENS) {                                     </span>
<span class="9109073648364222254" onmouseenter="enter('9109073648364222254');" onmouseout="out('9109073648364222254');" style=""> 904                 mMaxScreenId = Math.max(id, mMaxScreenId);                                               </span>
<span class="-6240460135729763291" onmouseenter="enter('-6240460135729763291');" onmouseout="out('-6240460135729763291');" style=""> 905             }  else {                                                                                    </span>
<span class="754800730159449376" onmouseenter="enter('754800730159449376');" onmouseout="out('754800730159449376');" style=""> 906                 mMaxItemId = Math.max(id, mMaxItemId);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 907             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 908         }                                                                                                </span>
<span  style=""> 909                                                                                                          </span>
<span class="-8013451254632200820" onmouseenter="enter('-8013451254632200820');" onmouseout="out('-8013451254632200820');" style=""> 910         private long initializeMaxItemId(SQLiteDatabase db) {                                            </span>
<span class="-6457280004469744269" onmouseenter="enter('-6457280004469744269');" onmouseout="out('-6457280004469744269');" style=""> 911             Cursor c = db.rawQuery(&quot;SELECT MAX(_id) FROM favorites&quot;, null);                              </span>
<span  style=""> 912                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 913             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 914             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 915             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 916             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 917                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 918             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 919             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 920                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921             }                                                                                            </span>
<span  style=""> 922                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 923             if (id == -1) {                                                                              </span>
<span class="-8632333559810917367" onmouseenter="enter('-8632333559810917367');" onmouseout="out('-8632333559810917367');" style=""> 924                 throw new RuntimeException(&quot;Error: could not query max item id&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 925             }                                                                                            </span>
<span  style=""> 926                                                                                                          </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 927             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 928         }                                                                                                </span>
<span  style=""> 929                                                                                                          </span>
<span class="3292148501075941248" onmouseenter="enter('3292148501075941248');" onmouseout="out('3292148501075941248');" style=""> 930         // Generates a new ID to use for an workspace screen in your database. This method               </span>
<span class="8169251972405240623" onmouseenter="enter('8169251972405240623');" onmouseout="out('8169251972405240623');" style=""> 931         // should be only called from the main UI thread. As an exception, we do call it when we         </span>
<span class="5354260748737756868" onmouseenter="enter('5354260748737756868');" onmouseout="out('5354260748737756868');" style=""> 932         // call the constructor from the worker thread; however, this doesn&#x27;t extend until after the     </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 933         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 934         // after that point                                                                              </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 935         public long generateNewScreenId() {                                                              </span>
<span class="-2601779586206833262" onmouseenter="enter('-2601779586206833262');" onmouseout="out('-2601779586206833262');" style=""> 936             if (mMaxScreenId &lt; 0) {                                                                      </span>
<span class="-8395628436366181623" onmouseenter="enter('-8395628436366181623');" onmouseout="out('-8395628436366181623');" style=""> 937                 throw new RuntimeException(&quot;Error: max screen id was not initialized&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 938             }                                                                                            </span>
<span class="-7600499966171393409" onmouseenter="enter('-7600499966171393409');" onmouseout="out('-7600499966171393409');" style=""> 939             mMaxScreenId += 1;                                                                           </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 940             // Log to disk                                                                               </span>
<span class="-8761729187376845632" onmouseenter="enter('-8761729187376845632');" onmouseout="out('-8761729187376845632');" style=""> 941             Launcher.addDumpLog(TAG, &quot;11683562 - generateNewScreenId(): &quot; + mMaxScreenId, true);         </span>
<span class="-2082539956971430335" onmouseenter="enter('-2082539956971430335');" onmouseout="out('-2082539956971430335');" style=""> 942             return mMaxScreenId;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 943         }                                                                                                </span>
<span  style=""> 944                                                                                                          </span>
<span class="1340022180158952931" onmouseenter="enter('1340022180158952931');" onmouseout="out('1340022180158952931');" style=""> 945         private long initializeMaxScreenId(SQLiteDatabase db) {                                          </span>
<span class="-2625939584691052131" onmouseenter="enter('-2625939584691052131');" onmouseout="out('-2625939584691052131');" style=""><abbr title=" 946             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);"> 946             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TA🔵</abbr></span>
<span  style=""> 947                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 948             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 949             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 950             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 951             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 952                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 953             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 954             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 955                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 956             }                                                                                            </span>
<span  style=""> 957                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 958             if (id == -1) {                                                                              </span>
<span class="5981752458110974976" onmouseenter="enter('5981752458110974976');" onmouseout="out('5981752458110974976');" style=""> 959                 throw new RuntimeException(&quot;Error: could not query max screen id&quot;);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 960             }                                                                                            </span>
<span  style=""> 961                                                                                                          </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 962             // Log to disk                                                                               </span>
<span class="27430974887508761" onmouseenter="enter('27430974887508761');" onmouseout="out('27430974887508761');" style=""> 963             Launcher.addDumpLog(TAG, &quot;11683562 - initializeMaxScreenId(): &quot; + id, true);                 </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 964             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 965         }                                                                                                </span>
<span  style=""> 966                                                                                                          </span>
<span class="1383368615032249869" onmouseenter="enter('1383368615032249869');" onmouseout="out('1383368615032249869');" style=""> 967         private boolean initializeExternalAdd(ContentValues values) {                                    </span>
<span class="-4585320292275114767" onmouseenter="enter('-4585320292275114767');" onmouseout="out('-4585320292275114767');" style=""> 968             // 1. Ensure that externally added items have a valid item id                                </span>
<span class="-4828262327370557067" onmouseenter="enter('-4828262327370557067');" onmouseout="out('-4828262327370557067');" style=""> 969             long id = generateNewItemId();                                                               </span>
<span class="-4305015780380424948" onmouseenter="enter('-4305015780380424948');" onmouseout="out('-4305015780380424948');" style=""> 970             values.put(LauncherSettings.Favorites._ID, id);                                              </span>
<span  style=""> 971                                                                                                          </span>
<span class="5555856101718413728" onmouseenter="enter('5555856101718413728');" onmouseout="out('5555856101718413728');" style=""> 972             // 2. In the case of an app widget, and if no app widget id is specified, we                 </span>
<span class="5653436237424007902" onmouseenter="enter('5653436237424007902');" onmouseout="out('5653436237424007902');" style=""> 973             // attempt allocate and bind the widget.                                                     </span>
<span class="7737959233990593661" onmouseenter="enter('7737959233990593661');" onmouseout="out('7737959233990593661');" style=""> 974             Integer itemType = values.getAsInteger(LauncherSettings.Favorites.ITEM_TYPE);                </span>
<span class="2055658702897830579" onmouseenter="enter('2055658702897830579');" onmouseout="out('2055658702897830579');" style=""> 975             if (itemType != null &amp;&amp;                                                                      </span>
<span class="-1739021162756129174" onmouseenter="enter('-1739021162756129174');" onmouseout="out('-1739021162756129174');" style=""> 976                     itemType.intValue() == LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET &amp;&amp;             </span>
<span class="-6215251601594981481" onmouseenter="enter('-6215251601594981481');" onmouseout="out('-6215251601594981481');" style=""> 977                     !values.containsKey(LauncherSettings.Favorites.APPWIDGET_ID)) {                      </span>
<span  style=""> 978                                                                                                          </span>
<span class="328319718470950320" onmouseenter="enter('328319718470950320');" onmouseout="out('328319718470950320');" style=""> 979                 final AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(mContext);        </span>
<span class="7884761264945585321" onmouseenter="enter('7884761264945585321');" onmouseout="out('7884761264945585321');" style=""> 980                 ComponentName cn = ComponentName.unflattenFromString(                                    </span>
<span class="2179911768770688102" onmouseenter="enter('2179911768770688102');" onmouseout="out('2179911768770688102');" style=""> 981                         values.getAsString(Favorites.APPWIDGET_PROVIDER));                               </span>
<span  style=""> 982                                                                                                          </span>
<span class="3459055710499452007" onmouseenter="enter('3459055710499452007');" onmouseout="out('3459055710499452007');" style=""> 983                 if (cn != null) {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 984                     try {                                                                                </span>
<span class="7176738113779216844" onmouseenter="enter('7176738113779216844');" onmouseout="out('7176738113779216844');" style=""> 985                         int appWidgetId = mAppWidgetHost.allocateAppWidgetId();                          </span>
<span class="3122228588084428979" onmouseenter="enter('3122228588084428979');" onmouseout="out('3122228588084428979');" style=""> 986                         values.put(LauncherSettings.Favorites.APPWIDGET_ID, appWidgetId);                </span>
<span class="2309614617117273311" onmouseenter="enter('2309614617117273311');" onmouseout="out('2309614617117273311');" style=""> 987                         if (!appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn)) {                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 988                             return false;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 989                         }                                                                                </span>
<span class="1200625667814236005" onmouseenter="enter('1200625667814236005');" onmouseout="out('1200625667814236005');" style=""> 990                     } catch (RuntimeException e) {                                                       </span>
<span class="9049318523495391496" onmouseenter="enter('9049318523495391496');" onmouseout="out('9049318523495391496');" style=""> 991                         Log.e(TAG, &quot;Failed to initialize external widget&quot;, e);                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 992                         return false;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 993                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 994                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 995                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 996                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 997             }                                                                                            </span>
<span  style=""> 998                                                                                                          </span>
<span class="-5393917371757635815" onmouseenter="enter('-5393917371757635815');" onmouseout="out('-5393917371757635815');" style=""> 999             // Add screen id if not present                                                              </span>
<span class="-8492193036384627967" onmouseenter="enter('-8492193036384627967');" onmouseout="out('-8492193036384627967');" style="">1000             long screenId = values.getAsLong(LauncherSettings.Favorites.SCREEN);                         </span>
<span class="-8472780943665027311" onmouseenter="enter('-8472780943665027311');" onmouseout="out('-8472780943665027311');" style="">1001             if (!addScreenIdIfNecessary(screenId)) {                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1002                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1003             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">1004             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1005         }                                                                                                </span>
<span  style="">1006                                                                                                          </span>
<span class="7352835902307890843" onmouseenter="enter('7352835902307890843');" onmouseout="out('7352835902307890843');" style="">1007         // Returns true of screen id exists, or if successfully added                                    </span>
<span class="-4057720447241324922" onmouseenter="enter('-4057720447241324922');" onmouseout="out('-4057720447241324922');" style="">1008         private boolean addScreenIdIfNecessary(long screenId) {                                          </span>
<span class="-8332527954530563349" onmouseenter="enter('-8332527954530563349');" onmouseout="out('-8332527954530563349');" style="">1009             if (!hasScreenId(screenId)) {                                                                </span>
<span class="-3380006025674561043" onmouseenter="enter('-3380006025674561043');" onmouseout="out('-3380006025674561043');" style="">1010                 int rank = getMaxScreenRank() + 1;                                                       </span>
<span  style="">1011                                                                                                          </span>
<span class="4061202061343128850" onmouseenter="enter('4061202061343128850');" onmouseout="out('4061202061343128850');" style="">1012                 ContentValues v = new ContentValues();                                                   </span>
<span class="-5112420615000020353" onmouseenter="enter('-5112420615000020353');" onmouseout="out('-5112420615000020353');" style="">1013                 v.put(LauncherSettings.WorkspaceScreens._ID, screenId);                                  </span>
<span class="6806563186306365402" onmouseenter="enter('6806563186306365402');" onmouseout="out('6806563186306365402');" style="">1014                 v.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                              </span>
<span class="-1115795847996433461" onmouseenter="enter('-1115795847996433461');" onmouseout="out('-1115795847996433461');" style="">1015                 if (dbInsertAndCheck(this, getWritableDatabase(),                                        </span>
<span class="3238415722136121635" onmouseenter="enter('3238415722136121635');" onmouseout="out('3238415722136121635');" style="">1016                         TABLE_WORKSPACE_SCREENS, null, v) &lt; 0) {                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1017                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1018                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1019             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">1020             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1021         }                                                                                                </span>
<span  style="">1022                                                                                                          </span>
<span class="5478264759768975399" onmouseenter="enter('5478264759768975399');" onmouseout="out('5478264759768975399');" style="">1023         private boolean hasScreenId(long screenId) {                                                     </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style="">1024             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="7657123469267572077" onmouseenter="enter('7657123469267572077');" onmouseout="out('7657123469267572077');" style="">1025             Cursor c = db.rawQuery(&quot;SELECT * FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot; WHERE &quot;                </span>
<span class="1858055579641267103" onmouseenter="enter('1858055579641267103');" onmouseout="out('1858055579641267103');" style="">1026                     + LauncherSettings.WorkspaceScreens._ID + &quot; = &quot; + screenId, null);                   </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style="">1027             if (c != null) {                                                                             </span>
<span class="-7874906179005583875" onmouseenter="enter('-7874906179005583875');" onmouseout="out('-7874906179005583875');" style="">1028                 int count = c.getCount();                                                                </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1029                 c.close();                                                                               </span>
<span class="4255567607434315929" onmouseenter="enter('4255567607434315929');" onmouseout="out('4255567607434315929');" style="">1030                 return count &gt; 0;                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1031             } else {                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">1032                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1033             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1034         }                                                                                                </span>
<span  style="">1035                                                                                                          </span>
<span class="-2708828914383579811" onmouseenter="enter('-2708828914383579811');" onmouseout="out('-2708828914383579811');" style="">1036         private int getMaxScreenRank() {                                                                 </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style="">1037             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="4567502420956726358" onmouseenter="enter('4567502420956726358');" onmouseout="out('4567502420956726358');" style="">1038             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens.SCREEN_RANK         </span>
<span class="-851271521804486447" onmouseenter="enter('-851271521804486447');" onmouseout="out('-851271521804486447');" style="">1039                     + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);                                        </span>
<span  style="">1040                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style="">1041             // get the result                                                                            </span>
<span class="-7089673966704675292" onmouseenter="enter('-7089673966704675292');" onmouseout="out('-7089673966704675292');" style="">1042             final int maxRankIndex = 0;                                                                  </span>
<span class="8995972804405745177" onmouseenter="enter('8995972804405745177');" onmouseout="out('8995972804405745177');" style="">1043             int rank = -1;                                                                               </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style="">1044             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="-130706833968251970" onmouseenter="enter('-130706833968251970');" onmouseout="out('-130706833968251970');" style="">1045                 rank = c.getInt(maxRankIndex);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1046             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style="">1047             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1048                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1049             }                                                                                            </span>
<span  style="">1050                                                                                                          </span>
<span class="-5061660947414305561" onmouseenter="enter('-5061660947414305561');" onmouseout="out('-5061660947414305561');" style="">1051             return rank;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1052         }                                                                                                </span>
<span  style="">1053                                                                                                          </span>
<span class="7076012940679285170" onmouseenter="enter('7076012940679285170');" onmouseout="out('7076012940679285170');" style="">1054         private int loadFavorites(SQLiteDatabase db, AutoInstallsLayout loader) {                        </span>
<span class="-517932292017625058" onmouseenter="enter('-517932292017625058');" onmouseout="out('-517932292017625058');" style="">1055             ArrayList&lt;Long&gt; screenIds = new ArrayList&lt;Long&gt;();                                           </span>
<span class="-1992683231790282850" onmouseenter="enter('-1992683231790282850');" onmouseout="out('-1992683231790282850');" style="">1056             // TODO: Use multiple loaders with fall-back and transaction.                                </span>
<span class="-198133332043015666" onmouseenter="enter('-198133332043015666');" onmouseout="out('-198133332043015666');" style="">1057             int count = loader.loadLayout(db, screenIds);                                                </span>
<span  style="">1058                                                                                                          </span>
<span class="6833875387324148439" onmouseenter="enter('6833875387324148439');" onmouseout="out('6833875387324148439');" style="">1059             // Add the screens specified by the items above                                              </span>
<span class="2978539432730983390" onmouseenter="enter('2978539432730983390');" onmouseout="out('2978539432730983390');" style="">1060             Collections.sort(screenIds);                                                                 </span>
<span class="5419352211080831355" onmouseenter="enter('5419352211080831355');" onmouseout="out('5419352211080831355');" style="">1061             int rank = 0;                                                                                </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style="">1062             ContentValues values = new ContentValues();                                                  </span>
<span class="7152107230041712979" onmouseenter="enter('7152107230041712979');" onmouseout="out('7152107230041712979');" style="">1063             for (Long id : screenIds) {                                                                  </span>
<span class="6295623415315599771" onmouseenter="enter('6295623415315599771');" onmouseout="out('6295623415315599771');" style="">1064                 values.clear();                                                                          </span>
<span class="-3523466272369778299" onmouseenter="enter('-3523466272369778299');" onmouseout="out('-3523466272369778299');" style="">1065                 values.put(LauncherSettings.WorkspaceScreens._ID, id);                                   </span>
<span class="-4819700644573994153" onmouseenter="enter('-4819700644573994153');" onmouseout="out('-4819700644573994153');" style="">1066                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                         </span>
<span class="-7619796578683976012" onmouseenter="enter('-7619796578683976012');" onmouseout="out('-7619796578683976012');" style="">1067                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values) &lt; 0) {             </span>
<span class="-4349241721568097596" onmouseenter="enter('-4349241721568097596');" onmouseout="out('-4349241721568097596');" style="">1068                     throw new RuntimeException(&quot;Failed initialize screen table&quot;                          </span>
<span class="6358788983404305676" onmouseenter="enter('6358788983404305676');" onmouseout="out('6358788983404305676');" style="">1069                             + &quot;from default layout&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1070                 }                                                                                        </span>
<span class="-39828730810908930" onmouseenter="enter('-39828730810908930');" onmouseout="out('-39828730810908930');" style="">1071                 rank++;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1072             }                                                                                            </span>
<span  style="">1073                                                                                                          </span>
<span class="-1496945990523812752" onmouseenter="enter('-1496945990523812752');" onmouseout="out('-1496945990523812752');" style="">1074             // Ensure that the max ids are initialized                                                   </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1075             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1076             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span  style="">1077                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style="">1078             return count;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1079         }                                                                                                </span>
<span  style="">1080                                                                                                          </span>
<span class="725730754436415996" onmouseenter="enter('725730754436415996');" onmouseout="out('725730754436415996');" style="">1081         private void migrateLauncher2Shortcuts(SQLiteDatabase db, Uri uri) {                             </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style="">1082             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="-3774076673393313717" onmouseenter="enter('-3774076673393313717');" onmouseout="out('-3774076673393313717');" style="">1083             Cursor c = null;                                                                             </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style="">1084             int count = 0;                                                                               </span>
<span class="-3336839334240068207" onmouseenter="enter('-3336839334240068207');" onmouseout="out('-3336839334240068207');" style="">1085             int curScreen = 0;                                                                           </span>
<span  style="">1086                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1087             try {                                                                                        </span>
<span class="-9000085593458662527" onmouseenter="enter('-9000085593458662527');" onmouseout="out('-9000085593458662527');" style="">1088                 c = resolver.query(uri, null, null, null, &quot;title ASC&quot;);                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="">1089             } catch (Exception e) {                                                                      </span>
<span class="-1642344425252950446" onmouseenter="enter('-1642344425252950446');" onmouseout="out('-1642344425252950446');" style="">1090                 // Ignore                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1091             }                                                                                            </span>
<span  style="">1092                                                                                                          </span>
<span class="-8364191572061005786" onmouseenter="enter('-8364191572061005786');" onmouseout="out('-8364191572061005786');" style="">1093             // We already have a favorites database in the old provider                                  </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style="">1094             if (c != null) {                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1095                 try {                                                                                    </span>
<span class="-7145577210477193493" onmouseenter="enter('-7145577210477193493');" onmouseout="out('-7145577210477193493');" style="">1096                     if (c.getCount() &gt; 0) {                                                              </span>
<span class="574469590853725413" onmouseenter="enter('574469590853725413');" onmouseout="out('574469590853725413');" style="">1097                         final int idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);     </span>
<span class="-3305857310034960574" onmouseenter="enter('-3305857310034960574');" onmouseout="out('-3305857310034960574');" style="">1098                         final int intentIndex                                                            </span>
<span class="7354730669796853916" onmouseenter="enter('7354730669796853916');" onmouseout="out('7354730669796853916');" style="">1099                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);            </span>
<span class="-5630883347545993547" onmouseenter="enter('-5630883347545993547');" onmouseout="out('-5630883347545993547');" style="">1100                         final int titleIndex                                                             </span>
<span class="698330273931132471" onmouseenter="enter('698330273931132471');" onmouseout="out('698330273931132471');" style="">1101                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);             </span>
<span class="-3330891132272232037" onmouseenter="enter('-3330891132272232037');" onmouseout="out('-3330891132272232037');" style="">1102                         final int iconTypeIndex                                                          </span>
<span class="7801651150775381680" onmouseenter="enter('7801651150775381680');" onmouseout="out('7801651150775381680');" style="">1103                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);         </span>
<span class="-1496515754016715409" onmouseenter="enter('-1496515754016715409');" onmouseout="out('-1496515754016715409');" style="">1104                         final int iconIndex                                                              </span>
<span class="-6743710571640483882" onmouseenter="enter('-6743710571640483882');" onmouseout="out('-6743710571640483882');" style="">1105                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);              </span>
<span class="-4968513115427762421" onmouseenter="enter('-4968513115427762421');" onmouseout="out('-4968513115427762421');" style="">1106                         final int iconPackageIndex                                                       </span>
<span class="6406994869194943351" onmouseenter="enter('6406994869194943351');" onmouseout="out('6406994869194943351');" style="">1107                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);      </span>
<span class="7917018656335895183" onmouseenter="enter('7917018656335895183');" onmouseout="out('7917018656335895183');" style="">1108                         final int iconResourceIndex                                                      </span>
<span class="2805080254532821790" onmouseenter="enter('2805080254532821790');" onmouseout="out('2805080254532821790');" style="">1109                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);     </span>
<span class="-4237567403763432926" onmouseenter="enter('-4237567403763432926');" onmouseout="out('-4237567403763432926');" style="">1110                         final int containerIndex                                                         </span>
<span class="-5056484222025497452" onmouseenter="enter('-5056484222025497452');" onmouseout="out('-5056484222025497452');" style="">1111                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);         </span>
<span class="-1231922168250187193" onmouseenter="enter('-1231922168250187193');" onmouseout="out('-1231922168250187193');" style="">1112                         final int itemTypeIndex                                                          </span>
<span class="4225538929397018586" onmouseenter="enter('4225538929397018586');" onmouseout="out('4225538929397018586');" style="">1113                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);         </span>
<span class="1886064968207935621" onmouseenter="enter('1886064968207935621');" onmouseout="out('1886064968207935621');" style="">1114                         final int screenIndex                                                            </span>
<span class="5823358741192050359" onmouseenter="enter('5823358741192050359');" onmouseout="out('5823358741192050359');" style="">1115                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);            </span>
<span class="148786652433469700" onmouseenter="enter('148786652433469700');" onmouseout="out('148786652433469700');" style="">1116                         final int cellXIndex                                                             </span>
<span class="-2420213882448561608" onmouseenter="enter('-2420213882448561608');" onmouseout="out('-2420213882448561608');" style="">1117                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);             </span>
<span class="7105291823960507491" onmouseenter="enter('7105291823960507491');" onmouseout="out('7105291823960507491');" style="">1118                         final int cellYIndex                                                             </span>
<span class="570222995967736070" onmouseenter="enter('570222995967736070');" onmouseout="out('570222995967736070');" style="">1119                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);             </span>
<span class="-6657516663903609513" onmouseenter="enter('-6657516663903609513');" onmouseout="out('-6657516663903609513');" style="">1120                         final int uriIndex                                                               </span>
<span class="-7627325667289175305" onmouseenter="enter('-7627325667289175305');" onmouseout="out('-7627325667289175305');" style="">1121                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);               </span>
<span class="3126191733073545935" onmouseenter="enter('3126191733073545935');" onmouseout="out('3126191733073545935');" style="">1122                         final int displayModeIndex                                                       </span>
<span class="5824024113471232605" onmouseenter="enter('5824024113471232605');" onmouseout="out('5824024113471232605');" style="">1123                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);      </span>
<span class="6969636044710489163" onmouseenter="enter('6969636044710489163');" onmouseout="out('6969636044710489163');" style="">1124                         final int profileIndex                                                           </span>
<span class="-4394079448083019726" onmouseenter="enter('-4394079448083019726');" onmouseout="out('-4394079448083019726');" style="">1125                                 = c.getColumnIndex(LauncherSettings.Favorites.PROFILE_ID);               </span>
<span  style="">1126                                                                                                          </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="">1127                         int i = 0;                                                                       </span>
<span class="3196084964022358374" onmouseenter="enter('3196084964022358374');" onmouseout="out('3196084964022358374');" style="">1128                         int curX = 0;                                                                    </span>
<span class="-8919994129307273415" onmouseenter="enter('-8919994129307273415');" onmouseout="out('-8919994129307273415');" style="">1129                         int curY = 0;                                                                    </span>
<span  style="">1130                                                                                                          </span>
<span class="1185328747399966274" onmouseenter="enter('1185328747399966274');" onmouseout="out('1185328747399966274');" style="">1131                         final LauncherAppState app = LauncherAppState.getInstance();                     </span>
<span class="7124839587395892858" onmouseenter="enter('7124839587395892858');" onmouseout="out('7124839587395892858');" style="">1132                         final DeviceProfile grid = app.getDynamicGrid().getDeviceProfile();              </span>
<span class="690371396691664791" onmouseenter="enter('690371396691664791');" onmouseout="out('690371396691664791');" style="">1133                         final int width = (int) grid.numColumns;                                         </span>
<span class="-5064901428253886355" onmouseenter="enter('-5064901428253886355');" onmouseout="out('-5064901428253886355');" style="">1134                         final int height = (int) grid.numRows;                                           </span>
<span class="-4109722385928167056" onmouseenter="enter('-4109722385928167056');" onmouseout="out('-4109722385928167056');" style="">1135                         final int hotseatWidth = (int) grid.numHotseatIcons;                             </span>
<span  style="">1136                                                                                                          </span>
<span class="-4392487977825691924" onmouseenter="enter('-4392487977825691924');" onmouseout="out('-4392487977825691924');" style="">1137                         final HashSet&lt;String&gt; seenIntents = new HashSet&lt;String&gt;(c.getCount());           </span>
<span  style="">1138                                                                                                          </span>
<span class="-1775881703038933069" onmouseenter="enter('-1775881703038933069');" onmouseout="out('-1775881703038933069');" style="">1139                         final ArrayList&lt;ContentValues&gt; shortcuts = new ArrayList&lt;ContentValues&gt;();       </span>
<span class="-5282219486258454454" onmouseenter="enter('-5282219486258454454');" onmouseout="out('-5282219486258454454');" style="">1140                         final ArrayList&lt;ContentValues&gt; folders = new ArrayList&lt;ContentValues&gt;();         </span>
<span class="7748304206224281059" onmouseenter="enter('7748304206224281059');" onmouseout="out('7748304206224281059');" style="">1141                         final SparseArray&lt;ContentValues&gt; hotseat = new SparseArray&lt;ContentValues&gt;();     </span>
<span  style="">1142                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style="">1143                         while (c.moveToNext()) {                                                         </span>
<span class="-2982692859195643614" onmouseenter="enter('-2982692859195643614');" onmouseout="out('-2982692859195643614');" style="">1144                             final int itemType = c.getInt(itemTypeIndex);                                </span>
<span class="-7155300134759553393" onmouseenter="enter('-7155300134759553393');" onmouseout="out('-7155300134759553393');" style="">1145                             if (itemType != Favorites.ITEM_TYPE_APPLICATION                              </span>
<span class="-6505147694408678007" onmouseenter="enter('-6505147694408678007');" onmouseout="out('-6505147694408678007');" style="">1146                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_SHORTCUT                          </span>
<span class="-1211279440538129484" onmouseenter="enter('-1211279440538129484');" onmouseout="out('-1211279440538129484');" style="">1147                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_FOLDER) {                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1148                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1149                             }                                                                            </span>
<span  style="">1150                                                                                                          </span>
<span class="6546086433507254477" onmouseenter="enter('6546086433507254477');" onmouseout="out('6546086433507254477');" style="">1151                             final int cellX = c.getInt(cellXIndex);                                      </span>
<span class="-5848765603231722693" onmouseenter="enter('-5848765603231722693');" onmouseout="out('-5848765603231722693');" style="">1152                             final int cellY = c.getInt(cellYIndex);                                      </span>
<span class="5057139106655212954" onmouseenter="enter('5057139106655212954');" onmouseout="out('5057139106655212954');" style="">1153                             final int screen = c.getInt(screenIndex);                                    </span>
<span class="-6682259384170717005" onmouseenter="enter('-6682259384170717005');" onmouseout="out('-6682259384170717005');" style="">1154                             int container = c.getInt(containerIndex);                                    </span>
<span class="-3517014905521526588" onmouseenter="enter('-3517014905521526588');" onmouseout="out('-3517014905521526588');" style="">1155                             final String intentStr = c.getString(intentIndex);                           </span>
<span  style="">1156                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style="">1157                             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);     </span>
<span class="7210862209025052290" onmouseenter="enter('7210862209025052290');" onmouseout="out('7210862209025052290');" style="">1158                             UserHandleCompat userHandle;                                                 </span>
<span class="-704754462563124721" onmouseenter="enter('-704754462563124721');" onmouseout="out('-704754462563124721');" style="">1159                             final long userSerialNumber;                                                 </span>
<span class="-3188525411347809180" onmouseenter="enter('-3188525411347809180');" onmouseout="out('-3188525411347809180');" style="">1160                             if (profileIndex != -1 &amp;&amp; !c.isNull(profileIndex)) {                         </span>
<span class="3377600326593357797" onmouseenter="enter('3377600326593357797');" onmouseout="out('3377600326593357797');" style="">1161                                 userSerialNumber = c.getInt(profileIndex);                               </span>
<span class="-5580723935665666817" onmouseenter="enter('-5580723935665666817');" onmouseout="out('-5580723935665666817');" style="">1162                                 userHandle = userManager.getUserForSerialNumber(userSerialNumber);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1163                             } else {                                                                     </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style="">1164                                 // Default to the serial number of this user, for older                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style="">1165                                 // shortcuts.                                                            </span>
<span class="153827185233038497" onmouseenter="enter('153827185233038497');" onmouseout="out('153827185233038497');" style="">1166                                 userHandle = UserHandleCompat.myUserHandle();                            </span>
<span class="-7992210937529459410" onmouseenter="enter('-7992210937529459410');" onmouseout="out('-7992210937529459410');" style="">1167                                 userSerialNumber = userManager.getSerialNumberForUser(userHandle);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1168                             }                                                                            </span>
<span  style="">1169                                                                                                          </span>
<span class="-5734975396466070409" onmouseenter="enter('-5734975396466070409');" onmouseout="out('-5734975396466070409');" style="">1170                             if (userHandle == null) {                                                    </span>
<span class="8825647937501871391" onmouseenter="enter('8825647937501871391');" onmouseout="out('8825647937501871391');" style="">1171                                 Launcher.addDumpLog(TAG, &quot;skipping deleted user&quot;, true);                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1172                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1173                             }                                                                            </span>
<span  style="">1174                                                                                                          </span>
<span class="-8522267007848438017" onmouseenter="enter('-8522267007848438017');" onmouseout="out('-8522267007848438017');" style="">1175                             Launcher.addDumpLog(TAG, &quot;migrating \&quot;&quot;                                      </span>
<span class="5716371482803525639" onmouseenter="enter('5716371482803525639');" onmouseout="out('5716371482803525639');" style="">1176                                 + c.getString(titleIndex) + &quot;\&quot; (&quot;                                       </span>
<span class="1581718899431916610" onmouseenter="enter('1581718899431916610');" onmouseout="out('1581718899431916610');" style="">1177                                 + cellX + &quot;,&quot; + cellY + &quot;@&quot;                                              </span>
<span class="-5433460809722614707" onmouseenter="enter('-5433460809722614707');" onmouseout="out('-5433460809722614707');" style="">1178                                 + LauncherSettings.Favorites.containerToString(container)                </span>
<span class="7963207375316982791" onmouseenter="enter('7963207375316982791');" onmouseout="out('7963207375316982791');" style="">1179                                 + &quot;/&quot; + screen                                                           </span>
<span class="6018191721230485089" onmouseenter="enter('6018191721230485089');" onmouseout="out('6018191721230485089');" style="">1180                                 + &quot;): &quot; + intentStr, true);                                              </span>
<span  style="">1181                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1182                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span  style="">1183                                                                                                          </span>
<span class="-3217378244605518341" onmouseenter="enter('-3217378244605518341');" onmouseout="out('-3217378244605518341');" style="">1184                                 final Intent intent;                                                     </span>
<span class="-6604091625193940309" onmouseenter="enter('-6604091625193940309');" onmouseout="out('-6604091625193940309');" style="">1185                                 final ComponentName cn;                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1186                                 try {                                                                    </span>
<span class="-5300012287142621419" onmouseenter="enter('-5300012287142621419');" onmouseout="out('-5300012287142621419');" style="">1187                                     intent = Intent.parseUri(intentStr, 0);                              </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style="">1188                                 } catch (URISyntaxException e) {                                         </span>
<span class="4944972948248133238" onmouseenter="enter('4944972948248133238');" onmouseout="out('4944972948248133238');" style="">1189                                     // bogus intent?                                                     </span>
<span class="8337166236749198483" onmouseenter="enter('8337166236749198483');" onmouseout="out('8337166236749198483');" style="">1190                                     Launcher.addDumpLog(TAG,                                             </span>
<span class="7306432149085172440" onmouseenter="enter('7306432149085172440');" onmouseout="out('7306432149085172440');" style="">1191                                             &quot;skipping invalid intent uri&quot;, true);                        </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1192                                     continue;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1193                                 }                                                                        </span>
<span  style="">1194                                                                                                          </span>
<span class="6421562153709548736" onmouseenter="enter('6421562153709548736');" onmouseout="out('6421562153709548736');" style="">1195                                 cn = intent.getComponent();                                              </span>
<span class="1165574592669081424" onmouseenter="enter('1165574592669081424');" onmouseout="out('1165574592669081424');" style="">1196                                 if (TextUtils.isEmpty(intentStr)) {                                      </span>
<span class="1109263052506568546" onmouseenter="enter('1109263052506568546');" onmouseout="out('1109263052506568546');" style="">1197                                     // no intent? no icon                                                </span>
<span class="-2999961336534157526" onmouseenter="enter('-2999961336534157526');" onmouseout="out('-2999961336534157526');" style="">1198                                     Launcher.addDumpLog(TAG, &quot;skipping empty intent&quot;, true);             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1199                                     continue;                                                            </span>
<span class="-9117039092771941538" onmouseenter="enter('-9117039092771941538');" onmouseout="out('-9117039092771941538');" style="">1200                                 } else if (cn != null &amp;&amp;                                                 </span>
<span class="-3538782463140269707" onmouseenter="enter('-3538782463140269707');" onmouseout="out('-3538782463140269707');" style="">1201                                         !LauncherModel.isValidPackageActivity(mContext, cn,              </span>
<span class="2012568974631198883" onmouseenter="enter('2012568974631198883');" onmouseout="out('2012568974631198883');" style="">1202                                                 userHandle)) {                                           </span>
<span class="-8462735888325815955" onmouseenter="enter('-8462735888325815955');" onmouseout="out('-8462735888325815955');" style="">1203                                     // component no longer exists.                                       </span>
<span class="8244127631099782564" onmouseenter="enter('8244127631099782564');" onmouseout="out('8244127631099782564');" style="">1204                                     Launcher.addDumpLog(TAG, &quot;skipping item whose component &quot; +          </span>
<span class="-2271033079359571531" onmouseenter="enter('-2271033079359571531');" onmouseout="out('-2271033079359571531');" style="">1205                                             &quot;no longer exists.&quot;, true);                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1206                                     continue;                                                            </span>
<span class="1808399553142797413" onmouseenter="enter('1808399553142797413');" onmouseout="out('1808399553142797413');" style="">1207                                 } else if (container ==                                                  </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1208                                         LauncherSettings.Favorites.CONTAINER_DESKTOP) {                  </span>
<span class="-6651088913311152009" onmouseenter="enter('-6651088913311152009');" onmouseout="out('-6651088913311152009');" style="">1209                                     // Dedupe icons directly on the workspace                            </span>
<span  style="">1210                                                                                                          </span>
<span class="-7857209544272892433" onmouseenter="enter('-7857209544272892433');" onmouseout="out('-7857209544272892433');" style="">1211                                     // Canonicalize                                                      </span>
<span class="-8986671765649789370" onmouseenter="enter('-8986671765649789370');" onmouseout="out('-8986671765649789370');" style="">1212                                     // the Play Store sets the package parameter, but Launcher           </span>
<span class="-2685712344279555181" onmouseenter="enter('-2685712344279555181');" onmouseout="out('-2685712344279555181');" style="">1213                                     // does not, so we clear that out to keep them the same.             </span>
<span class="-1462576698638737516" onmouseenter="enter('-1462576698638737516');" onmouseout="out('-1462576698638737516');" style="">1214                                     // Also ignore intent flags for the purposes of deduping.            </span>
<span class="-3363694106044374937" onmouseenter="enter('-3363694106044374937');" onmouseout="out('-3363694106044374937');" style="">1215                                     intent.setPackage(null);                                             </span>
<span class="-3409071973040894037" onmouseenter="enter('-3409071973040894037');" onmouseout="out('-3409071973040894037');" style="">1216                                     int flags = intent.getFlags();                                       </span>
<span class="547103070058811611" onmouseenter="enter('547103070058811611');" onmouseout="out('547103070058811611');" style="">1217                                     intent.setFlags(0);                                                  </span>
<span class="-947990318544641084" onmouseenter="enter('-947990318544641084');" onmouseout="out('-947990318544641084');" style="">1218                                     final String key = intent.toUri(0);                                  </span>
<span class="-7327331133269780521" onmouseenter="enter('-7327331133269780521');" onmouseout="out('-7327331133269780521');" style="">1219                                     intent.setFlags(flags);                                              </span>
<span class="7480204102005082432" onmouseenter="enter('7480204102005082432');" onmouseout="out('7480204102005082432');" style="">1220                                     if (seenIntents.contains(key)) {                                     </span>
<span class="2006049222885589498" onmouseenter="enter('2006049222885589498');" onmouseout="out('2006049222885589498');" style="">1221                                         Launcher.addDumpLog(TAG, &quot;skipping duplicate&quot;, true);            </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1222                                         continue;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1223                                     } else {                                                             </span>
<span class="4653019047206831387" onmouseenter="enter('4653019047206831387');" onmouseout="out('4653019047206831387');" style="">1224                                         seenIntents.add(key);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1225                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1226                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1227                             }                                                                            </span>
<span  style="">1228                                                                                                          </span>
<span class="-3805379390248188389" onmouseenter="enter('-3805379390248188389');" onmouseout="out('-3805379390248188389');" style="">1229                             ContentValues values = new ContentValues(c.getColumnCount());                </span>
<span class="2787548740347733717" onmouseenter="enter('2787548740347733717');" onmouseout="out('2787548740347733717');" style="">1230                             values.put(LauncherSettings.Favorites._ID, c.getInt(idIndex));               </span>
<span class="4552396250235420866" onmouseenter="enter('4552396250235420866');" onmouseout="out('4552396250235420866');" style="">1231                             values.put(LauncherSettings.Favorites.INTENT, intentStr);                    </span>
<span class="3080545696092648727" onmouseenter="enter('3080545696092648727');" onmouseout="out('3080545696092648727');" style="">1232                             values.put(LauncherSettings.Favorites.TITLE, c.getString(titleIndex));       </span>
<span class="8877369206974054200" onmouseenter="enter('8877369206974054200');" onmouseout="out('8877369206974054200');" style="">1233                             values.put(LauncherSettings.Favorites.ICON_TYPE,                             </span>
<span class="8705323818259019594" onmouseenter="enter('8705323818259019594');" onmouseout="out('8705323818259019594');" style="">1234                                     c.getInt(iconTypeIndex));                                            </span>
<span class="3857475807367449049" onmouseenter="enter('3857475807367449049');" onmouseout="out('3857475807367449049');" style="">1235                             values.put(LauncherSettings.Favorites.ICON, c.getBlob(iconIndex));           </span>
<span class="-7054095546130863513" onmouseenter="enter('-7054095546130863513');" onmouseout="out('-7054095546130863513');" style="">1236                             values.put(LauncherSettings.Favorites.ICON_PACKAGE,                          </span>
<span class="-4377124255190457588" onmouseenter="enter('-4377124255190457588');" onmouseout="out('-4377124255190457588');" style="">1237                                     c.getString(iconPackageIndex));                                      </span>
<span class="7491883888231273974" onmouseenter="enter('7491883888231273974');" onmouseout="out('7491883888231273974');" style="">1238                             values.put(LauncherSettings.Favorites.ICON_RESOURCE,                         </span>
<span class="-14487948683300389" onmouseenter="enter('-14487948683300389');" onmouseout="out('-14487948683300389');" style="">1239                                     c.getString(iconResourceIndex));                                     </span>
<span class="5180659022499168410" onmouseenter="enter('5180659022499168410');" onmouseout="out('5180659022499168410');" style="">1240                             values.put(LauncherSettings.Favorites.ITEM_TYPE, itemType);                  </span>
<span class="2567875359902744917" onmouseenter="enter('2567875359902744917');" onmouseout="out('2567875359902744917');" style="">1241                             values.put(LauncherSettings.Favorites.APPWIDGET_ID, -1);                     </span>
<span class="-3897523412202294315" onmouseenter="enter('-3897523412202294315');" onmouseout="out('-3897523412202294315');" style="">1242                             values.put(LauncherSettings.Favorites.URI, c.getString(uriIndex));           </span>
<span class="8253479465859182990" onmouseenter="enter('8253479465859182990');" onmouseout="out('8253479465859182990');" style="">1243                             values.put(LauncherSettings.Favorites.DISPLAY_MODE,                          </span>
<span class="-8416795076296111227" onmouseenter="enter('-8416795076296111227');" onmouseout="out('-8416795076296111227');" style="">1244                                     c.getInt(displayModeIndex));                                         </span>
<span class="-1880957120536425376" onmouseenter="enter('-1880957120536425376');" onmouseout="out('-1880957120536425376');" style="">1245                             values.put(LauncherSettings.Favorites.PROFILE_ID, userSerialNumber);         </span>
<span  style="">1246                                                                                                          </span>
<span class="-216205184326719357" onmouseenter="enter('-216205184326719357');" onmouseout="out('-216205184326719357');" style="">1247                             if (container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {             </span>
<span class="2845166931909672251" onmouseenter="enter('2845166931909672251');" onmouseout="out('2845166931909672251');" style="">1248                                 hotseat.put(screen, values);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1249                             }                                                                            </span>
<span  style="">1250                                                                                                          </span>
<span class="-8534427976726701331" onmouseenter="enter('-8534427976726701331');" onmouseout="out('-8534427976726701331');" style="">1251                             if (container != LauncherSettings.Favorites.CONTAINER_DESKTOP) {             </span>
<span class="3724214252155726452" onmouseenter="enter('3724214252155726452');" onmouseout="out('3724214252155726452');" style="">1252                                 // In a folder or in the hotseat, preserve position                      </span>
<span class="4993135311254983149" onmouseenter="enter('4993135311254983149');" onmouseout="out('4993135311254983149');" style="">1253                                 values.put(LauncherSettings.Favorites.SCREEN, screen);                   </span>
<span class="-7735658353589578952" onmouseenter="enter('-7735658353589578952');" onmouseout="out('-7735658353589578952');" style="">1254                                 values.put(LauncherSettings.Favorites.CELLX, cellX);                     </span>
<span class="-6596875348392322090" onmouseenter="enter('-6596875348392322090');" onmouseout="out('-6596875348392322090');" style="">1255                                 values.put(LauncherSettings.Favorites.CELLY, cellY);                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1256                             } else {                                                                     </span>
<span class="-6079732280628496127" onmouseenter="enter('-6079732280628496127');" onmouseout="out('-6079732280628496127');" style="">1257                                 // For items contained directly on one of the workspace screen,          </span>
<span class="-850513443108501253" onmouseenter="enter('-850513443108501253');" onmouseout="out('-850513443108501253');" style="">1258                                 // we&#x27;ll determine their location (screen, x, y) in a second pass.       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1259                             }                                                                            </span>
<span  style="">1260                                                                                                          </span>
<span class="7684212050113439789" onmouseenter="enter('7684212050113439789');" onmouseout="out('7684212050113439789');" style="">1261                             values.put(LauncherSettings.Favorites.CONTAINER, container);                 </span>
<span  style="">1262                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1263                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span class="-7897547558000712151" onmouseenter="enter('-7897547558000712151');" onmouseout="out('-7897547558000712151');" style="">1264                                 shortcuts.add(values);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1265                             } else {                                                                     </span>
<span class="5214044302935278086" onmouseenter="enter('5214044302935278086');" onmouseout="out('5214044302935278086');" style="">1266                                 folders.add(values);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1267                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1268                         }                                                                                </span>
<span  style="">1269                                                                                                          </span>
<span class="3792333482677793462" onmouseenter="enter('3792333482677793462');" onmouseout="out('3792333482677793462');" style="">1270                         // Now that we have all the hotseat icons, let&#x27;s go through them left-right      </span>
<span class="6853065735140319510" onmouseenter="enter('6853065735140319510');" onmouseout="out('6853065735140319510');" style="">1271                         // and assign valid locations for them in the new hotseat                        </span>
<span class="-382900916992065291" onmouseenter="enter('-382900916992065291');" onmouseout="out('-382900916992065291');" style="">1272                         final int N = hotseat.size();                                                    </span>
<span class="9016073461123662191" onmouseenter="enter('9016073461123662191');" onmouseout="out('9016073461123662191');" style="">1273                         for (int idx=0; idx&lt;N; idx++) {                                                  </span>
<span class="-7027280347801461154" onmouseenter="enter('-7027280347801461154');" onmouseout="out('-7027280347801461154');" style="">1274                             int hotseatX = hotseat.keyAt(idx);                                           </span>
<span class="7267222979225491944" onmouseenter="enter('7267222979225491944');" onmouseout="out('7267222979225491944');" style="">1275                             ContentValues values = hotseat.valueAt(idx);                                 </span>
<span  style="">1276                                                                                                          </span>
<span class="-3018245694205955067" onmouseenter="enter('-3018245694205955067');" onmouseout="out('-3018245694205955067');" style="">1277                             if (hotseatX == grid.hotseatAllAppsRank) {                                   </span>
<span class="-8495735509078642350" onmouseenter="enter('-8495735509078642350');" onmouseout="out('-8495735509078642350');" style="">1278                                 // let&#x27;s drop this in the next available hole in the hotseat             </span>
<span class="-2055954181227443816" onmouseenter="enter('-2055954181227443816');" onmouseout="out('-2055954181227443816');" style="">1279                                 while (++hotseatX &lt; hotseatWidth) {                                      </span>
<span class="-5595819560409222327" onmouseenter="enter('-5595819560409222327');" onmouseout="out('-5595819560409222327');" style="">1280                                     if (hotseat.get(hotseatX) == null) {                                 </span>
<span class="2131484666649578366" onmouseenter="enter('2131484666649578366');" onmouseout="out('2131484666649578366');" style="">1281                                         // found a spot! move it here                                    </span>
<span class="325808457439646533" onmouseenter="enter('325808457439646533');" onmouseout="out('325808457439646533');" style="">1282                                         values.put(LauncherSettings.Favorites.SCREEN,                    </span>
<span class="8014085861051867033" onmouseenter="enter('8014085861051867033');" onmouseout="out('8014085861051867033');" style="">1283                                                 hotseatX);                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1284                                         break;                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1285                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1286                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1287                             }                                                                            </span>
<span class="4361559665402156368" onmouseenter="enter('4361559665402156368');" onmouseout="out('4361559665402156368');" style="">1288                             if (hotseatX &gt;= hotseatWidth) {                                              </span>
<span class="198406244599777154" onmouseenter="enter('198406244599777154');" onmouseout="out('198406244599777154');" style="">1289                                 // no room for you in the hotseat? it&#x27;s off to the desktop with you      </span>
<span class="274548545061036766" onmouseenter="enter('274548545061036766');" onmouseout="out('274548545061036766');" style="">1290                                 values.put(LauncherSettings.Favorites.CONTAINER,                         </span>
<span class="951133373394890183" onmouseenter="enter('951133373394890183');" onmouseout="out('951133373394890183');" style="">1291                                            Favorites.CONTAINER_DESKTOP);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1292                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1293                         }                                                                                </span>
<span  style="">1294                                                                                                          </span>
<span class="4538029778921500049" onmouseenter="enter('4538029778921500049');" onmouseout="out('4538029778921500049');" style="">1295                         final ArrayList&lt;ContentValues&gt; allItems = new ArrayList&lt;ContentValues&gt;();        </span>
<span class="-4972040190483698817" onmouseenter="enter('-4972040190483698817');" onmouseout="out('-4972040190483698817');" style="">1296                         // Folders first                                                                 </span>
<span class="1607706518732535744" onmouseenter="enter('1607706518732535744');" onmouseout="out('1607706518732535744');" style="">1297                         allItems.addAll(folders);                                                        </span>
<span class="2106236708914116763" onmouseenter="enter('2106236708914116763');" onmouseout="out('2106236708914116763');" style="">1298                         // Then shortcuts                                                                </span>
<span class="-1250372864837547145" onmouseenter="enter('-1250372864837547145');" onmouseout="out('-1250372864837547145');" style="">1299                         allItems.addAll(shortcuts);                                                      </span>
<span  style="">1300                                                                                                          </span>
<span class="-2195882050879177813" onmouseenter="enter('-2195882050879177813');" onmouseout="out('-2195882050879177813');" style="">1301                         // Layout all the folders                                                        </span>
<span class="-252665973237041297" onmouseenter="enter('-252665973237041297');" onmouseout="out('-252665973237041297');" style="">1302                         for (ContentValues values: allItems) {                                           </span>
<span class="-6238460523304059987" onmouseenter="enter('-6238460523304059987');" onmouseout="out('-6238460523304059987');" style="">1303                             if (values.getAsInteger(LauncherSettings.Favorites.CONTAINER) !=             </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1304                                     LauncherSettings.Favorites.CONTAINER_DESKTOP) {                      </span>
<span class="4544740026899945117" onmouseenter="enter('4544740026899945117');" onmouseout="out('4544740026899945117');" style="">1305                                 // Hotseat items and folder items have already had their                 </span>
<span class="9061827072000509027" onmouseenter="enter('9061827072000509027');" onmouseout="out('9061827072000509027');" style="">1306                                 // location information set. Nothing to be done here.                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1307                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1308                             }                                                                            </span>
<span class="851641135220662264" onmouseenter="enter('851641135220662264');" onmouseout="out('851641135220662264');" style="">1309                             values.put(LauncherSettings.Favorites.SCREEN, curScreen);                    </span>
<span class="-1049962748703223150" onmouseenter="enter('-1049962748703223150');" onmouseout="out('-1049962748703223150');" style="">1310                             values.put(LauncherSettings.Favorites.CELLX, curX);                          </span>
<span class="-5258025824110848668" onmouseenter="enter('-5258025824110848668');" onmouseout="out('-5258025824110848668');" style="">1311                             values.put(LauncherSettings.Favorites.CELLY, curY);                          </span>
<span class="1910082031532915038" onmouseenter="enter('1910082031532915038');" onmouseout="out('1910082031532915038');" style="">1312                             curX = (curX + 1) % width;                                                   </span>
<span class="-7155276018455302787" onmouseenter="enter('-7155276018455302787');" onmouseout="out('-7155276018455302787');" style="">1313                             if (curX == 0) {                                                             </span>
<span class="2376495568180329749" onmouseenter="enter('2376495568180329749');" onmouseout="out('2376495568180329749');" style="">1314                                 curY = (curY + 1);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1315                             }                                                                            </span>
<span class="-4531638622721531414" onmouseenter="enter('-4531638622721531414');" onmouseout="out('-4531638622721531414');" style="">1316                             // Leave the last row of icons blank on every screen                         </span>
<span class="-5543182397018270277" onmouseenter="enter('-5543182397018270277');" onmouseout="out('-5543182397018270277');" style="">1317                             if (curY == height - 1) {                                                    </span>
<span class="-6657705079427553715" onmouseenter="enter('-6657705079427553715');" onmouseout="out('-6657705079427553715');" style="">1318                                 curScreen = (int) generateNewScreenId();                                 </span>
<span class="4679043716901678926" onmouseenter="enter('4679043716901678926');" onmouseout="out('4679043716901678926');" style="">1319                                 curY = 0;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1320                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1321                         }                                                                                </span>
<span  style="">1322                                                                                                          </span>
<span class="1853917526349173349" onmouseenter="enter('1853917526349173349');" onmouseout="out('1853917526349173349');" style="">1323                         if (allItems.size() &gt; 0) {                                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1324                             db.beginTransaction();                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1325                             try {                                                                        </span>
<span class="-7256059133012813079" onmouseenter="enter('-7256059133012813079');" onmouseout="out('-7256059133012813079');" style="">1326                                 for (ContentValues row: allItems) {                                      </span>
<span class="3155601228699925770" onmouseenter="enter('3155601228699925770');" onmouseout="out('3155601228699925770');" style="">1327                                     if (row == null) continue;                                           </span>
<span class="-304018147606180100" onmouseenter="enter('-304018147606180100');" onmouseout="out('-304018147606180100');" style="">1328                                     if (dbInsertAndCheck(this, db, TABLE_FAVORITES, null, row)           </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1329                                             &lt; 0) {                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1330                                         return;                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1331                                     } else {                                                             </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style="">1332                                         count++;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1333                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1334                                 }                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1335                                 db.setTransactionSuccessful();                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1336                             } finally {                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1337                                 db.endTransaction();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1338                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1339                         }                                                                                </span>
<span  style="">1340                                                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1341                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1342                         try {                                                                            </span>
<span class="-7150489321946493056" onmouseenter="enter('-7150489321946493056');" onmouseout="out('-7150489321946493056');" style="">1343                             for (i=0; i&lt;=curScreen; i++) {                                               </span>
<span class="7694375558102178162" onmouseenter="enter('7694375558102178162');" onmouseout="out('7694375558102178162');" style="">1344                                 final ContentValues values = new ContentValues();                        </span>
<span class="-5225632710651404139" onmouseenter="enter('-5225632710651404139');" onmouseout="out('-5225632710651404139');" style="">1345                                 values.put(LauncherSettings.WorkspaceScreens._ID, i);                    </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="">1346                                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);            </span>
<span class="-6007460446232002971" onmouseenter="enter('-6007460446232002971');" onmouseout="out('-6007460446232002971');" style="">1347                                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values)    </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1348                                         &lt; 0) {                                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1349                                     return;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1350                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1351                             }                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1352                             db.setTransactionSuccessful();                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1353                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1354                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1355                         }                                                                                </span>
<span  style="">1356                                                                                                          </span>
<span class="3757730671360045414" onmouseenter="enter('3757730671360045414');" onmouseout="out('3757730671360045414');" style="">1357                         updateFolderItemsRank(db, false);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1358                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1359                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1360                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1361                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1362             }                                                                                            </span>
<span  style="">1363                                                                                                          </span>
<span class="-6182516414964240870" onmouseenter="enter('-6182516414964240870');" onmouseout="out('-6182516414964240870');" style="">1364             Launcher.addDumpLog(TAG, &quot;migrated &quot; + count + &quot; icons from Launcher2 into &quot;                 </span>
<span class="3301967416992773508" onmouseenter="enter('3301967416992773508');" onmouseout="out('3301967416992773508');" style="">1365                     + (curScreen+1) + &quot; screens&quot;, true);                                                 </span>
<span  style="">1366                                                                                                          </span>
<span class="3355055744209094121" onmouseenter="enter('3355055744209094121');" onmouseout="out('3355055744209094121');" style="">1367             // ensure that new screens are created to hold these icons                                   </span>
<span class="4167333916835222093" onmouseenter="enter('4167333916835222093');" onmouseout="out('4167333916835222093');" style="">1368             setFlagJustLoadedOldDb();                                                                    </span>
<span  style="">1369                                                                                                          </span>
<span class="2071167438564206442" onmouseenter="enter('2071167438564206442');" onmouseout="out('2071167438564206442');" style="">1370             // Update max IDs; very important since we just grabbed IDs from another database            </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1371             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1372             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span class="-439077128883569126" onmouseenter="enter('-439077128883569126');" onmouseout="out('-439077128883569126');" style="">1373             if (LOGD) Log.d(TAG, &quot;mMaxItemId: &quot; + mMaxItemId + &quot; mMaxScreenId: &quot; + mMaxScreenId);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1374         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1375     }                                                                                                    </span>
<span  style="">1376                                                                                                          </span>
<span class="8465274381710394045" onmouseenter="enter('8465274381710394045');" onmouseout="out('8465274381710394045');" style="">1377     static class SqlArguments {                                                                          </span>
<span class="8122936482838815352" onmouseenter="enter('8122936482838815352');" onmouseout="out('8122936482838815352');" style="">1378         public final String table;                                                                       </span>
<span class="5442590397567481633" onmouseenter="enter('5442590397567481633');" onmouseout="out('5442590397567481633');" style="">1379         public final String where;                                                                       </span>
<span class="-2258632185412795279" onmouseenter="enter('-2258632185412795279');" onmouseout="out('-2258632185412795279');" style="">1380         public final String[] args;                                                                      </span>
<span  style="">1381                                                                                                          </span>
<span class="538735252304320137" onmouseenter="enter('538735252304320137');" onmouseout="out('538735252304320137');" style="">1382         SqlArguments(Uri url, String where, String[] args) {                                             </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1383             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1384                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="7181058370626512064" onmouseenter="enter('7181058370626512064');" onmouseout="out('7181058370626512064');" style="">1385                 this.where = where;                                                                      </span>
<span class="8688716567728705492" onmouseenter="enter('8688716567728705492');" onmouseout="out('8688716567728705492');" style="">1386                 this.args = args;                                                                        </span>
<span class="2325935358302734243" onmouseenter="enter('2325935358302734243');" onmouseout="out('2325935358302734243');" style="">1387             } else if (url.getPathSegments().size() != 2) {                                              </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1388                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="186586201607437821" onmouseenter="enter('186586201607437821');" onmouseout="out('186586201607437821');" style="">1389             } else if (!TextUtils.isEmpty(where)) {                                                      </span>
<span class="2785963644153593875" onmouseenter="enter('2785963644153593875');" onmouseout="out('2785963644153593875');" style="">1390                 throw new UnsupportedOperationException(&quot;WHERE clause not supported: &quot; + url);           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1391             } else {                                                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1392                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="-834356181554398700" onmouseenter="enter('-834356181554398700');" onmouseout="out('-834356181554398700');" style="">1393                 this.where = &quot;_id=&quot; + ContentUris.parseId(url);                                          </span>
<span class="-7173439380439508667" onmouseenter="enter('-7173439380439508667');" onmouseout="out('-7173439380439508667');" style="">1394                 this.args = null;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1395             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1396         }                                                                                                </span>
<span  style="">1397                                                                                                          </span>
<span class="5705249208777482684" onmouseenter="enter('5705249208777482684');" onmouseout="out('5705249208777482684');" style="">1398         SqlArguments(Uri url) {                                                                          </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1399             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-594585027826531892" onmouseenter="enter('-594585027826531892');" onmouseout="out('-594585027826531892');" style="">1400                 table = url.getPathSegments().get(0);                                                    </span>
<span class="3938761229458861077" onmouseenter="enter('3938761229458861077');" onmouseout="out('3938761229458861077');" style="">1401                 where = null;                                                                            </span>
<span class="8940401955607507518" onmouseenter="enter('8940401955607507518');" onmouseout="out('8940401955607507518');" style="">1402                 args = null;                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1403             } else {                                                                                     </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1404                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1405             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1406         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1407     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1408 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="1710841298952644868" onmouseenter="enter('1710841298952644868');" onmouseout="out('1710841298952644868');" style="">   2  * Copyright (C) 2008 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">  17 package com.android.launcher3;                                                                           </span>
<span  style="">  18                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">  19 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="8802236814006375919" onmouseenter="enter('8802236814006375919');" onmouseout="out('8802236814006375919');" style="">  20 import android.appwidget.AppWidgetManager;                                                               </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">  21 import android.content.ComponentName;                                                                    </span>
<span class="550877806393279246" onmouseenter="enter('550877806393279246');" onmouseout="out('550877806393279246');" style="">  22 import android.content.ContentProvider;                                                                  </span>
<span class="3739800667450215943" onmouseenter="enter('3739800667450215943');" onmouseout="out('3739800667450215943');" style="">  23 import android.content.ContentProviderOperation;                                                         </span>
<span class="-6369732601490611729" onmouseenter="enter('-6369732601490611729');" onmouseout="out('-6369732601490611729');" style="">  24 import android.content.ContentProviderResult;                                                            </span>
<span class="6126857652515451632" onmouseenter="enter('6126857652515451632');" onmouseout="out('6126857652515451632');" style="">  25 import android.content.ContentResolver;                                                                  </span>
<span class="-9185307499822629" onmouseenter="enter('-9185307499822629');" onmouseout="out('-9185307499822629');" style="">  26 import android.content.ContentUris;                                                                      </span>
<span class="3127723864207259776" onmouseenter="enter('3127723864207259776');" onmouseout="out('3127723864207259776');" style="">  27 import android.content.ContentValues;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  28 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  29 import android.content.Intent;                                                                           </span>
<span class="-4160670168441716907" onmouseenter="enter('-4160670168441716907');" onmouseout="out('-4160670168441716907');" style="">  30 import android.content.OperationApplicationException;                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  31 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  32 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  33 import android.database.Cursor;                                                                          </span>
<span class="5870833163231201789" onmouseenter="enter('5870833163231201789');" onmouseout="out('5870833163231201789');" style="">  34 import android.database.SQLException;                                                                    </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  35 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="6401548559697116088" onmouseenter="enter('6401548559697116088');" onmouseout="out('6401548559697116088');" style="">  36 import android.database.sqlite.SQLiteOpenHelper;                                                         </span>
<span class="-1253510085600408435" onmouseenter="enter('-1253510085600408435');" onmouseout="out('-1253510085600408435');" style="">  37 import android.database.sqlite.SQLiteQueryBuilder;                                                       </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  38 import android.net.Uri;                                                                                  </span>
<span class="5635872676092141444" onmouseenter="enter('5635872676092141444');" onmouseout="out('5635872676092141444');" style="">  39 import android.os.StrictMode;                                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  40 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  41 import android.util.Log;                                                                                 </span>
<span class="-1076320969941752510" onmouseenter="enter('-1076320969941752510');" onmouseout="out('-1076320969941752510');" style="">  42 import android.util.SparseArray;                                                                         </span>
<span  style="">  43                                                                                                          </span>
<span class="4395110202233918405" onmouseenter="enter('4395110202233918405');" onmouseout="out('4395110202233918405');" style="">  44 import com.android.launcher3.AutoInstallsLayout.LayoutParserCallback;                                    </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  45 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span class="6372524458266053383" onmouseenter="enter('6372524458266053383');" onmouseout="out('6372524458266053383');" style="">  46 import com.android.launcher3.compat.UserHandleCompat;                                                    </span>
<span class="-8849211230761127863" onmouseenter="enter('-8849211230761127863');" onmouseout="out('-8849211230761127863');" style="">  47 import com.android.launcher3.compat.UserManagerCompat;                                                   </span>
<span class="-7468653447981916815" onmouseenter="enter('-7468653447981916815');" onmouseout="out('-7468653447981916815');" style="">  48 import com.android.launcher3.config.ProviderConfig;                                                      </span>
<span  style="">  49                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  50 import java.io.File;                                                                                     </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  51 import java.net.URISyntaxException;                                                                      </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  52 import java.util.ArrayList;                                                                              </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53 import java.util.Collections;                                                                            </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54 import java.util.HashSet;                                                                                </span>
<span  style="">  55                                                                                                          </span>
<span class="-5661310118425891821" onmouseenter="enter('-5661310118425891821');" onmouseout="out('-5661310118425891821');" style="">  56 public class LauncherProvider extends ContentProvider {                                                  </span>
<span class="-5301430442842506185" onmouseenter="enter('-5301430442842506185');" onmouseout="out('-5301430442842506185');" style="">  57     private static final String TAG = &quot;Launcher.LauncherProvider&quot;;                                       </span>
<span class="-8469384925954206736" onmouseenter="enter('-8469384925954206736');" onmouseout="out('-8469384925954206736');" style="">  58     private static final boolean LOGD = false;                                                           </span>
<span  style="">  59                                                                                                          </span>
<span class="9152615363478404775" onmouseenter="enter('9152615363478404775');" onmouseout="out('9152615363478404775');" style="">  60     private static final int DATABASE_VERSION = 22;                                                      </span>
<span  style="">  61                                                                                                          </span>
<span class="-458478327704245810" onmouseenter="enter('-458478327704245810');" onmouseout="out('-458478327704245810');" style="">  62     static final String OLD_AUTHORITY = &quot;com.android.launcher2.settings&quot;;                                </span>
<span class="-4376021050615906115" onmouseenter="enter('-4376021050615906115');" onmouseout="out('-4376021050615906115');" style="">  63     static final String AUTHORITY = ProviderConfig.AUTHORITY;                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-6626902943579202823" onmouseenter="enter('-6626902943579202823');" onmouseout="out('-6626902943579202823');" style="">  65     static final String TABLE_FAVORITES = &quot;favorites&quot;;                                                   </span>
<span class="-4121112267423691577" onmouseenter="enter('-4121112267423691577');" onmouseout="out('-4121112267423691577');" style="">  66     static final String TABLE_WORKSPACE_SCREENS = &quot;workspaceScreens&quot;;                                    </span>
<span class="5667619940348816611" onmouseenter="enter('5667619940348816611');" onmouseout="out('5667619940348816611');" style="">  67     static final String PARAMETER_NOTIFY = &quot;notify&quot;;                                                     </span>
<span class="4313854869595882016" onmouseenter="enter('4313854869595882016');" onmouseout="out('4313854869595882016');" style="">  68     static final String EMPTY_DATABASE_CREATED = &quot;EMPTY_DATABASE_CREATED&quot;;                               </span>
<span  style="">  69                                                                                                          </span>
<span class="-254878042648191521" onmouseenter="enter('-254878042648191521');" onmouseout="out('-254878042648191521');" style="">  70     private static final String URI_PARAM_IS_EXTERNAL_ADD = &quot;isExternalAdd&quot;;                             </span>
<span  style="">  71                                                                                                          </span>
<span class="-4555445478569710276" onmouseenter="enter('-4555445478569710276');" onmouseout="out('-4555445478569710276');" style="">  72     private LauncherProviderChangeListener mListener;                                                    </span>
<span  style="">  73                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  74     /**                                                                                                  </span>
<span class="-3211764681636990688" onmouseenter="enter('-3211764681636990688');" onmouseout="out('-3211764681636990688');" style="">  75      * {@link Uri} triggered at any registered {@link android.database.ContentObserver} when             </span>
<span class="-4919300270466303234" onmouseenter="enter('-4919300270466303234');" onmouseout="out('-4919300270466303234');" style="">  76      * {@link AppWidgetHost#deleteHost()} is called during database creation.                            </span>
<span class="-788325382909228329" onmouseenter="enter('-788325382909228329');" onmouseout="out('-788325382909228329');" style="">  77      * Use this to recall {@link AppWidgetHost#startListening()} if needed.                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  78      */                                                                                                  </span>
<span class="5515339483970246409" onmouseenter="enter('5515339483970246409');" onmouseout="out('5515339483970246409');" style="">  79     static final Uri CONTENT_APPWIDGET_RESET_URI =                                                       </span>
<span class="3194273355649806706" onmouseenter="enter('3194273355649806706');" onmouseout="out('3194273355649806706');" style="">  80             Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/appWidgetReset&quot;);                                     </span>
<span  style="">  81                                                                                                          </span>
<span class="-35355205086145165" onmouseenter="enter('-35355205086145165');" onmouseout="out('-35355205086145165');" style="">  82     private DatabaseHelper mOpenHelper;                                                                  </span>
<span  style="">  83                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  84     @Override                                                                                            </span>
<span class="5054121129922253104" onmouseenter="enter('5054121129922253104');" onmouseout="out('5054121129922253104');" style="">  85     public boolean onCreate() {                                                                          </span>
<span class="4475688138331124962" onmouseenter="enter('4475688138331124962');" onmouseout="out('4475688138331124962');" style="">  86         final Context context = getContext();                                                            </span>
<span class="-8005318937043312715" onmouseenter="enter('-8005318937043312715');" onmouseout="out('-8005318937043312715');" style="">  87         StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();                          </span>
<span class="-7690576094790651842" onmouseenter="enter('-7690576094790651842');" onmouseout="out('-7690576094790651842');" style="">  88         mOpenHelper = new DatabaseHelper(context);                                                       </span>
<span class="-9120794859598568002" onmouseenter="enter('-9120794859598568002');" onmouseout="out('-9120794859598568002');" style="">  89         StrictMode.setThreadPolicy(oldPolicy);                                                           </span>
<span class="-7305781479923559628" onmouseenter="enter('-7305781479923559628');" onmouseout="out('-7305781479923559628');" style="">  90         LauncherAppState.setLauncherProvider(this);                                                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  91         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92     }                                                                                                    </span>
<span  style="">  93                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style="">  94     public boolean wasNewDbCreated() {                                                                   </span>
<span class="-2120364841155545874" onmouseenter="enter('-2120364841155545874');" onmouseout="out('-2120364841155545874');" style="">  95         return mOpenHelper.wasNewDbCreated();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="9170464131639972057" onmouseenter="enter('9170464131639972057');" onmouseout="out('9170464131639972057');" style="">  98     public void setLauncherProviderChangeListener(LauncherProviderChangeListener listener) {             </span>
<span class="9132236250678632099" onmouseenter="enter('9132236250678632099');" onmouseout="out('9132236250678632099');" style="">  99         mListener = listener;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100     }                                                                                                    </span>
<span  style=""> 101                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 102     @Override                                                                                            </span>
<span class="-1263590755434456926" onmouseenter="enter('-1263590755434456926');" onmouseout="out('-1263590755434456926');" style=""> 103     public String getType(Uri uri) {                                                                     </span>
<span class="336598653403461328" onmouseenter="enter('336598653403461328');" onmouseout="out('336598653403461328');" style=""> 104         SqlArguments args = new SqlArguments(uri, null, null);                                           </span>
<span class="-3811208733585118846" onmouseenter="enter('-3811208733585118846');" onmouseout="out('-3811208733585118846');" style=""> 105         if (TextUtils.isEmpty(args.where)) {                                                             </span>
<span class="4564755247099008741" onmouseenter="enter('4564755247099008741');" onmouseout="out('4564755247099008741');" style=""> 106             return &quot;vnd.android.cursor.dir/&quot; + args.table;                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 107         } else {                                                                                         </span>
<span class="9039528378345344991" onmouseenter="enter('9039528378345344991');" onmouseout="out('9039528378345344991');" style=""> 108             return &quot;vnd.android.cursor.item/&quot; + args.table;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span  style=""> 111                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 112     @Override                                                                                            </span>
<span class="2688381462100157580" onmouseenter="enter('2688381462100157580');" onmouseout="out('2688381462100157580');" style=""> 113     public Cursor query(Uri uri, String[] projection, String selection,                                  </span>
<span class="-8080601171652713678" onmouseenter="enter('-8080601171652713678');" onmouseout="out('-8080601171652713678');" style=""> 114             String[] selectionArgs, String sortOrder) {                                                  </span>
<span  style=""> 115                                                                                                          </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 116         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span class="-631518951729113636" onmouseenter="enter('-631518951729113636');" onmouseout="out('-631518951729113636');" style=""> 117         SQLiteQueryBuilder qb = new SQLiteQueryBuilder();                                                </span>
<span class="2611293065726660593" onmouseenter="enter('2611293065726660593');" onmouseout="out('2611293065726660593');" style=""> 118         qb.setTables(args.table);                                                                        </span>
<span  style=""> 119                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 120         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3134453170380441664" onmouseenter="enter('3134453170380441664');" onmouseout="out('3134453170380441664');" style=""> 121         Cursor result = qb.query(db, projection, args.where, args.args, null, null, sortOrder);          </span>
<span class="-7763164457135943875" onmouseenter="enter('-7763164457135943875');" onmouseout="out('-7763164457135943875');" style=""> 122         result.setNotificationUri(getContext().getContentResolver(), uri);                               </span>
<span  style=""> 123                                                                                                          </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 124         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="9207797122534392164" onmouseenter="enter('9207797122534392164');" onmouseout="out('9207797122534392164');" style=""> 127     private static long dbInsertAndCheck(DatabaseHelper helper,                                          </span>
<span class="-7649003652568167377" onmouseenter="enter('-7649003652568167377');" onmouseout="out('-7649003652568167377');" style=""> 128             SQLiteDatabase db, String table, String nullColumnHack, ContentValues values) {              </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style=""> 129         if (values == null) {                                                                            </span>
<span class="7184965589450928593" onmouseenter="enter('7184965589450928593');" onmouseout="out('7184965589450928593');" style=""> 130             throw new RuntimeException(&quot;Error: attempting to insert null values&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131         }                                                                                                </span>
<span class="7050899094957739080" onmouseenter="enter('7050899094957739080');" onmouseout="out('7050899094957739080');" style=""> 132         if (!values.containsKey(LauncherSettings.ChangeLogColumns._ID)) {                                </span>
<span class="492623150120761321" onmouseenter="enter('492623150120761321');" onmouseout="out('492623150120761321');" style=""> 133             throw new RuntimeException(&quot;Error: attempting to add item without specifying an id&quot;);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134         }                                                                                                </span>
<span class="-5706715493188407465" onmouseenter="enter('-5706715493188407465');" onmouseout="out('-5706715493188407465');" style=""> 135         helper.checkId(table, values);                                                                   </span>
<span class="1074556166740873719" onmouseenter="enter('1074556166740873719');" onmouseout="out('1074556166740873719');" style=""> 136         return db.insert(table, nullColumnHack, values);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137     }                                                                                                    </span>
<span  style=""> 138                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 139     @Override                                                                                            </span>
<span class="-734135164912880773" onmouseenter="enter('-734135164912880773');" onmouseout="out('-734135164912880773');" style=""> 140     public Uri insert(Uri uri, ContentValues initialValues) {                                            </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 141         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span  style=""> 142                                                                                                          </span>
<span class="-8942992855752528468" onmouseenter="enter('-8942992855752528468');" onmouseout="out('-8942992855752528468');" style=""> 143         // In very limited cases, we support system|signature permission apps to add to the db           </span>
<span class="8337919216215113797" onmouseenter="enter('8337919216215113797');" onmouseout="out('8337919216215113797');" style=""> 144         String externalAdd = uri.getQueryParameter(URI_PARAM_IS_EXTERNAL_ADD);                           </span>
<span class="-2295815198673808272" onmouseenter="enter('-2295815198673808272');" onmouseout="out('-2295815198673808272');" style=""> 145         if (externalAdd != null &amp;&amp; &quot;true&quot;.equals(externalAdd)) {                                         </span>
<span class="255159610270408066" onmouseenter="enter('255159610270408066');" onmouseout="out('255159610270408066');" style=""> 146             if (!mOpenHelper.initializeExternalAdd(initialValues)) {                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 147                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149         }                                                                                                </span>
<span  style=""> 150                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 151         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-6358079444454153819" onmouseenter="enter('-6358079444454153819');" onmouseout="out('-6358079444454153819');" style=""> 152         addModifiedTime(initialValues);                                                                  </span>
<span class="5419112362953263362" onmouseenter="enter('5419112362953263362');" onmouseout="out('5419112362953263362');" style=""> 153         final long rowId = dbInsertAndCheck(mOpenHelper, db, args.table, null, initialValues);           </span>
<span class="8445680939324035407" onmouseenter="enter('8445680939324035407');" onmouseout="out('8445680939324035407');" style=""> 154         if (rowId &lt;= 0) return null;                                                                     </span>
<span  style=""> 155                                                                                                          </span>
<span class="8735878877349428813" onmouseenter="enter('8735878877349428813');" onmouseout="out('8735878877349428813');" style=""> 156         uri = ContentUris.withAppendedId(uri, rowId);                                                    </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 157         sendNotify(uri);                                                                                 </span>
<span  style=""> 158                                                                                                          </span>
<span class="8673785246827833247" onmouseenter="enter('8673785246827833247');" onmouseout="out('8673785246827833247');" style=""> 159         return uri;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160     }                                                                                                    </span>
<span  style=""> 161                                                                                                          </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="-327877481205905086" onmouseenter="enter('-327877481205905086');" onmouseout="out('-327877481205905086');" style=""> 164     public int bulkInsert(Uri uri, ContentValues[] values) {                                             </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 165         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span  style=""> 166                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 167         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 168         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 169         try {                                                                                            </span>
<span class="7727596149598132072" onmouseenter="enter('7727596149598132072');" onmouseout="out('7727596149598132072');" style=""> 170             int numValues = values.length;                                                               </span>
<span class="805790054769028067" onmouseenter="enter('805790054769028067');" onmouseout="out('805790054769028067');" style=""> 171             for (int i = 0; i &lt; numValues; i++) {                                                        </span>
<span class="2678636525018066730" onmouseenter="enter('2678636525018066730');" onmouseout="out('2678636525018066730');" style=""> 172                 addModifiedTime(values[i]);                                                              </span>
<span class="-5505203781899797586" onmouseenter="enter('-5505203781899797586');" onmouseout="out('-5505203781899797586');" style=""> 173                 if (dbInsertAndCheck(mOpenHelper, db, args.table, null, values[i]) &lt; 0) {                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 174                     return 0;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176             }                                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 177             db.setTransactionSuccessful();                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 178         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 179             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span  style=""> 181                                                                                                          </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 182         sendNotify(uri);                                                                                 </span>
<span class="6793841392205084718" onmouseenter="enter('6793841392205084718');" onmouseout="out('6793841392205084718');" style=""> 183         return values.length;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 186     @Override                                                                                            </span>
<span class="5983754597853237276" onmouseenter="enter('5983754597853237276');" onmouseout="out('5983754597853237276');" style=""> 187     public ContentProviderResult[] applyBatch(ArrayList&lt;ContentProviderOperation&gt; operations)            </span>
<span class="-5628895276830175510" onmouseenter="enter('-5628895276830175510');" onmouseout="out('-5628895276830175510');" style=""> 188             throws OperationApplicationException {                                                       </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 189         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 190         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 191         try {                                                                                            </span>
<span class="3840622082470564062" onmouseenter="enter('3840622082470564062');" onmouseout="out('3840622082470564062');" style=""> 192             ContentProviderResult[] result =  super.applyBatch(operations);                              </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 193             db.setTransactionSuccessful();                                                               </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 194             return result;                                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 195         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 196             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 200     @Override                                                                                            </span>
<span class="-6238796754049684603" onmouseenter="enter('-6238796754049684603');" onmouseout="out('-6238796754049684603');" style=""> 201     public int delete(Uri uri, String selection, String[] selectionArgs) {                               </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 202         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span  style=""> 203                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 204         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-848417512188045481" onmouseenter="enter('-848417512188045481');" onmouseout="out('-848417512188045481');" style=""> 205         int count = db.delete(args.table, args.where, args.args);                                        </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 206         if (count &gt; 0) sendNotify(uri);                                                                  </span>
<span  style=""> 207                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 208         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 211     @Override                                                                                            </span>
<span class="-6200308159398621930" onmouseenter="enter('-6200308159398621930');" onmouseout="out('-6200308159398621930');" style=""> 212     public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {         </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 213         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span  style=""> 214                                                                                                          </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 215         addModifiedTime(values);                                                                         </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 216         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="6692131291033480751" onmouseenter="enter('6692131291033480751');" onmouseout="out('6692131291033480751');" style=""> 217         int count = db.update(args.table, values, args.where, args.args);                                </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 218         if (count &gt; 0) sendNotify(uri);                                                                  </span>
<span  style=""> 219                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 220         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221     }                                                                                                    </span>
<span  style=""> 222                                                                                                          </span>
<span class="-6137155183451194640" onmouseenter="enter('-6137155183451194640');" onmouseout="out('-6137155183451194640');" style=""> 223     private void sendNotify(Uri uri) {                                                                   </span>
<span class="8087997420167282782" onmouseenter="enter('8087997420167282782');" onmouseout="out('8087997420167282782');" style=""> 224         String notify = uri.getQueryParameter(PARAMETER_NOTIFY);                                         </span>
<span class="-1882364541416460726" onmouseenter="enter('-1882364541416460726');" onmouseout="out('-1882364541416460726');" style=""> 225         if (notify == null || &quot;true&quot;.equals(notify)) {                                                   </span>
<span class="-1009902495160891118" onmouseenter="enter('-1009902495160891118');" onmouseout="out('-1009902495160891118');" style=""> 226             getContext().getContentResolver().notifyChange(uri, null);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227         }                                                                                                </span>
<span  style=""> 228                                                                                                          </span>
<span class="-88474152060363663" onmouseenter="enter('-88474152060363663');" onmouseout="out('-88474152060363663');" style=""> 229         // always notify the backup agent                                                                </span>
<span class="-4136841506633225478" onmouseenter="enter('-4136841506633225478');" onmouseout="out('-4136841506633225478');" style=""> 230         LauncherBackupAgentHelper.dataChanged(getContext());                                             </span>
<span class="3660947493902737932" onmouseenter="enter('3660947493902737932');" onmouseout="out('3660947493902737932');" style=""> 231         if (mListener != null) {                                                                         </span>
<span class="7178241373784368891" onmouseenter="enter('7178241373784368891');" onmouseout="out('7178241373784368891');" style=""> 232             mListener.onLauncherProviderChange();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="-6084407814327678466" onmouseenter="enter('-6084407814327678466');" onmouseout="out('-6084407814327678466');" style=""> 236     private static void addModifiedTime(ContentValues values) {                                          </span>
<span class="7778574075272931857" onmouseenter="enter('7778574075272931857');" onmouseout="out('7778574075272931857');" style=""> 237         values.put(LauncherSettings.ChangeLogColumns.MODIFIED, System.currentTimeMillis());              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238     }                                                                                                    </span>
<span  style=""> 239                                                                                                          </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 240     public long generateNewItemId() {                                                                    </span>
<span class="4208143222012601660" onmouseenter="enter('4208143222012601660');" onmouseout="out('4208143222012601660');" style=""> 241         return mOpenHelper.generateNewItemId();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span  style=""> 243                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 244     public void updateMaxItemId(long id) {                                                               </span>
<span class="5887752252226734670" onmouseenter="enter('5887752252226734670');" onmouseout="out('5887752252226734670');" style=""> 245         mOpenHelper.updateMaxItemId(id);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246     }                                                                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 248     public long generateNewScreenId() {                                                                  </span>
<span class="1793864293735992917" onmouseenter="enter('1793864293735992917');" onmouseout="out('1793864293735992917');" style=""> 249         return mOpenHelper.generateNewScreenId();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="6930658551566435877" onmouseenter="enter('6930658551566435877');" onmouseout="out('6930658551566435877');" style=""> 252     // This is only required one time while loading the workspace during the                             </span>
<span class="-2970396193784752555" onmouseenter="enter('-2970396193784752555');" onmouseout="out('-2970396193784752555');" style=""> 253     // upgrade path, and should never be called from anywhere else.                                      </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 254 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 255 ||||||| BASE                                                                                             </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256 public void updateMaxScreenId(long maxScreenId) {                                                        </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257             // Log to disk                                                                               </span>
<span class="-6999371015775210769" onmouseenter="enter('-6999371015775210769');" onmouseout="out('-6999371015775210769');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258             Launcher.addDumpLog(TAG, &quot;11683562 - updateMaxScreenId(): &quot; + maxScreenId, true);            </span>
<span class="-5262779621072196869" onmouseenter="enter('-5262779621072196869');" onmouseout="out('-5262779621072196869');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259             mMaxScreenId = maxScreenId;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260         }                                                                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 261 =======                                                                                                  </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262 public void updateMaxScreenId(long maxScreenId) {                                                        </span>
<span class="1650077191565319140" onmouseenter="enter('1650077191565319140');" onmouseout="out('1650077191565319140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263         mOpenHelper.updateMaxScreenId(maxScreenId);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 265 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 266                                                                                                          </span>
<span  style=""> 267                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 268     /**                                                                                                  </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 269      * Clears all the data for a fresh start.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 270      */                                                                                                  </span>
<span class="-8979529877881539007" onmouseenter="enter('-8979529877881539007');" onmouseout="out('-8979529877881539007');" style=""> 271     synchronized public void createEmptyDB() {                                                           </span>
<span class="-257404101089763384" onmouseenter="enter('-257404101089763384');" onmouseout="out('-257404101089763384');" style=""> 272         mOpenHelper.createEmptyDB(mOpenHelper.getWritableDatabase());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="6671122679064927328" onmouseenter="enter('6671122679064927328');" onmouseout="out('6671122679064927328');" style=""> 275     public void clearFlagEmptyDbCreated() {                                                              </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 276         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="6603172609148556207" onmouseenter="enter('6603172609148556207');" onmouseout="out('6603172609148556207');" style=""> 277         getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE)                                   </span>
<span class="-4990178698661362372" onmouseenter="enter('-4990178698661362372');" onmouseout="out('-4990178698661362372');" style=""> 278             .edit()                                                                                      </span>
<span class="-4523663616686353798" onmouseenter="enter('-4523663616686353798');" onmouseout="out('-4523663616686353798');" style=""> 279             .remove(EMPTY_DATABASE_CREATED)                                                              </span>
<span class="5746476506062343638" onmouseenter="enter('5746476506062343638');" onmouseout="out('5746476506062343638');" style=""> 280             .commit();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281     }                                                                                                    </span>
<span  style=""> 282                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 283     /**                                                                                                  </span>
<span class="277164340629859803" onmouseenter="enter('277164340629859803');" onmouseout="out('277164340629859803');" style=""> 284      * Loads the default workspace based on the following priority scheme:                               </span>
<span class="6191061916552549057" onmouseenter="enter('6191061916552549057');" onmouseout="out('6191061916552549057');" style=""> 285      *   1) From a package provided by play store                                                        </span>
<span class="-1458935321569433020" onmouseenter="enter('-1458935321569433020');" onmouseout="out('-1458935321569433020');" style=""> 286      *   2) From a partner configuration APK, already in the system image                                </span>
<span class="-8497452292409790071" onmouseenter="enter('-8497452292409790071');" onmouseout="out('-8497452292409790071');" style=""> 287      *   3) The default configuration for the particular device                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 288      */                                                                                                  </span>
<span class="-4109341010907676070" onmouseenter="enter('-4109341010907676070');" onmouseout="out('-4109341010907676070');" style=""> 289     synchronized public void loadDefaultFavoritesIfNecessary() {                                         </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 290         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="-1270995004093477684" onmouseenter="enter('-1270995004093477684');" onmouseout="out('-1270995004093477684');" style=""> 291         SharedPreferences sp = getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span  style=""> 292                                                                                                          </span>
<span class="-1164862040405657048" onmouseenter="enter('-1164862040405657048');" onmouseout="out('-1164862040405657048');" style=""> 293         if (sp.getBoolean(EMPTY_DATABASE_CREATED, false)) {                                              </span>
<span class="-3246698064640464314" onmouseenter="enter('-3246698064640464314');" onmouseout="out('-3246698064640464314');" style=""> 294             Log.d(TAG, &quot;loading default workspace&quot;);                                                     </span>
<span  style=""> 295                                                                                                          </span>
<span class="7358984688962203192" onmouseenter="enter('7358984688962203192');" onmouseout="out('7358984688962203192');" style=""> 296             AutoInstallsLayout loader = AutoInstallsLayout.get(getContext(),                             </span>
<span class="4267100487943846224" onmouseenter="enter('4267100487943846224');" onmouseout="out('4267100487943846224');" style=""> 297                     mOpenHelper.mAppWidgetHost, mOpenHelper);                                            </span>
<span  style=""> 298                                                                                                          </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 299             if (loader == null) {                                                                        </span>
<span class="-7748100060285216458" onmouseenter="enter('-7748100060285216458');" onmouseout="out('-7748100060285216458');" style=""> 300                 final Partner partner = Partner.get(getContext().getPackageManager());                   </span>
<span class="-604675337449948556" onmouseenter="enter('-604675337449948556');" onmouseout="out('-604675337449948556');" style=""> 301                 if (partner != null &amp;&amp; partner.hasDefaultLayout()) {                                     </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 302                     final Resources partnerRes = partner.getResources();                                 </span>
<span class="4481789752192356250" onmouseenter="enter('4481789752192356250');" onmouseout="out('4481789752192356250');" style=""> 303                     int workspaceResId = partnerRes.getIdentifier(Partner.RES_DEFAULT_LAYOUT,            </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 304                             &quot;xml&quot;, partner.getPackageName());                                            </span>
<span class="-1442734434460802886" onmouseenter="enter('-1442734434460802886');" onmouseout="out('-1442734434460802886');" style=""> 305                     if (workspaceResId != 0) {                                                           </span>
<span class="-624367766367819814" onmouseenter="enter('-624367766367819814');" onmouseout="out('-624367766367819814');" style=""> 306                         loader = new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,       </span>
<span class="3991293503056578945" onmouseenter="enter('3991293503056578945');" onmouseout="out('3991293503056578945');" style=""> 307                                 mOpenHelper, partnerRes, workspaceResId);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310             }                                                                                            </span>
<span  style=""> 311                                                                                                          </span>
<span class="-1006525515535848907" onmouseenter="enter('-1006525515535848907');" onmouseout="out('-1006525515535848907');" style=""> 312             final boolean usingExternallyProvidedLayout = loader != null;                                </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 313             if (loader == null) {                                                                        </span>
<span class="-6937254959516916052" onmouseenter="enter('-6937254959516916052');" onmouseout="out('-6937254959516916052');" style=""> 314                 loader = getDefaultLayoutParser();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span class="126045670500141" onmouseenter="enter('126045670500141');" onmouseout="out('126045670500141');" style=""> 316             // Populate favorites table with initial favorites                                           </span>
<span class="8206837333293431906" onmouseenter="enter('8206837333293431906');" onmouseout="out('8206837333293431906');" style=""> 317             if ((mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(), loader) &lt;= 0)              </span>
<span class="-363747028825236736" onmouseenter="enter('-363747028825236736');" onmouseout="out('-363747028825236736');" style=""> 318                     &amp;&amp; usingExternallyProvidedLayout) {                                                  </span>
<span class="-5734732948359842282" onmouseenter="enter('-5734732948359842282');" onmouseout="out('-5734732948359842282');" style=""> 319                 // Unable to load external layout. Cleanup and load the internal layout.                 </span>
<span class="5828098457627567319" onmouseenter="enter('5828098457627567319');" onmouseout="out('5828098457627567319');" style=""> 320                 createEmptyDB();                                                                         </span>
<span class="-3956631052588999268" onmouseenter="enter('-3956631052588999268');" onmouseout="out('-3956631052588999268');" style=""> 321                 mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(),                             </span>
<span class="5010356356580148690" onmouseenter="enter('5010356356580148690');" onmouseout="out('5010356356580148690');" style=""> 322                         getDefaultLayoutParser());                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span class="-1774667578952654848" onmouseenter="enter('-1774667578952654848');" onmouseout="out('-1774667578952654848');" style=""> 324             clearFlagEmptyDbCreated();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326     }                                                                                                    </span>
<span  style=""> 327                                                                                                          </span>
<span class="1869645688222446570" onmouseenter="enter('1869645688222446570');" onmouseout="out('1869645688222446570');" style=""> 328     private DefaultLayoutParser getDefaultLayoutParser() {                                               </span>
<span class="-4358736250572585751" onmouseenter="enter('-4358736250572585751');" onmouseout="out('-4358736250572585751');" style=""> 329         int defaultLayout = LauncherAppState.getInstance()                                               </span>
<span class="-3651315710070586527" onmouseenter="enter('-3651315710070586527');" onmouseout="out('-3651315710070586527');" style=""> 330                 .getDynamicGrid().getDeviceProfile().defaultLayoutId;                                    </span>
<span class="-4806143495772092322" onmouseenter="enter('-4806143495772092322');" onmouseout="out('-4806143495772092322');" style=""> 331         return new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                         </span>
<span class="-4976455824453899875" onmouseenter="enter('-4976455824453899875');" onmouseout="out('-4976455824453899875');" style=""> 332                 mOpenHelper, getContext().getResources(), defaultLayout);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333     }                                                                                                    </span>
<span  style=""> 334                                                                                                          </span>
<span class="-8499205643032210495" onmouseenter="enter('-8499205643032210495');" onmouseout="out('-8499205643032210495');" style=""> 335     public void migrateLauncher2Shortcuts() {                                                            </span>
<span class="-5770271076267441053" onmouseenter="enter('-5770271076267441053');" onmouseout="out('-5770271076267441053');" style=""> 336         mOpenHelper.migrateLauncher2Shortcuts(mOpenHelper.getWritableDatabase(),                         </span>
<span class="-4855681120160555012" onmouseenter="enter('-4855681120160555012');" onmouseout="out('-4855681120160555012');" style=""> 337                 Uri.parse(getContext().getString(R.string.old_launcher_provider_uri)));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338     }                                                                                                    </span>
<span  style=""> 339                                                                                                          </span>
<span class="-5196105730574921781" onmouseenter="enter('-5196105730574921781');" onmouseout="out('-5196105730574921781');" style=""> 340     public void updateFolderItemsRank() {                                                                </span>
<span class="4982456805094611516" onmouseenter="enter('4982456805094611516');" onmouseout="out('4982456805094611516');" style=""> 341         mOpenHelper.updateFolderItemsRank(mOpenHelper.getWritableDatabase(), false);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342     }                                                                                                    </span>
<span  style=""> 343                                                                                                          </span>
<span class="-7861087353469194327" onmouseenter="enter('-7861087353469194327');" onmouseout="out('-7861087353469194327');" style=""> 344     public void deleteDatabase() {                                                                       </span>
<span class="-3081120555997572478" onmouseenter="enter('-3081120555997572478');" onmouseout="out('-3081120555997572478');" style=""> 345         // Are you sure? (y/n)                                                                           </span>
<span class="7599905409028339447" onmouseenter="enter('7599905409028339447');" onmouseout="out('7599905409028339447');" style=""> 346         final SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                     </span>
<span class="4824670475834221257" onmouseenter="enter('4824670475834221257');" onmouseout="out('4824670475834221257');" style=""> 347         final File dbFile = new File(db.getPath());                                                      </span>
<span class="-4378932496508441297" onmouseenter="enter('-4378932496508441297');" onmouseout="out('-4378932496508441297');" style=""> 348         mOpenHelper.close();                                                                             </span>
<span class="-2168275612742463412" onmouseenter="enter('-2168275612742463412');" onmouseout="out('-2168275612742463412');" style=""> 349         if (dbFile.exists()) {                                                                           </span>
<span class="7055278701412747697" onmouseenter="enter('7055278701412747697');" onmouseout="out('7055278701412747697');" style=""> 350             SQLiteDatabase.deleteDatabase(dbFile);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351         }                                                                                                </span>
<span class="1429708216911350032" onmouseenter="enter('1429708216911350032');" onmouseout="out('1429708216911350032');" style=""> 352         mOpenHelper = new DatabaseHelper(getContext());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353     }                                                                                                    </span>
<span  style=""> 354                                                                                                          </span>
<span class="-8073014385313712586" onmouseenter="enter('-8073014385313712586');" onmouseout="out('-8073014385313712586');" style=""> 355     private static class DatabaseHelper extends SQLiteOpenHelper implements LayoutParserCallback {       </span>
<span class="-2672328117217234149" onmouseenter="enter('-2672328117217234149');" onmouseout="out('-2672328117217234149');" style=""> 356         private final Context mContext;                                                                  </span>
<span class="-7815254415381208754" onmouseenter="enter('-7815254415381208754');" onmouseout="out('-7815254415381208754');" style=""> 357         private final AppWidgetHost mAppWidgetHost;                                                      </span>
<span class="256431113711786954" onmouseenter="enter('256431113711786954');" onmouseout="out('256431113711786954');" style=""> 358         private long mMaxItemId = -1;                                                                    </span>
<span class="3024521003496490102" onmouseenter="enter('3024521003496490102');" onmouseout="out('3024521003496490102');" style=""> 359         private long mMaxScreenId = -1;                                                                  </span>
<span  style=""> 360                                                                                                          </span>
<span class="7342788129695687690" onmouseenter="enter('7342788129695687690');" onmouseout="out('7342788129695687690');" style=""> 361         private boolean mNewDbCreated = false;                                                           </span>
<span  style=""> 362                                                                                                          </span>
<span class="1000156088447424124" onmouseenter="enter('1000156088447424124');" onmouseout="out('1000156088447424124');" style=""> 363         DatabaseHelper(Context context) {                                                                </span>
<span class="5450204288644697643" onmouseenter="enter('5450204288644697643');" onmouseout="out('5450204288644697643');" style=""> 364             super(context, LauncherFiles.LAUNCHER_DB, null, DATABASE_VERSION);                           </span>
<span class="7260904205784329196" onmouseenter="enter('7260904205784329196');" onmouseout="out('7260904205784329196');" style=""> 365             mContext = context;                                                                          </span>
<span class="6731257549223913473" onmouseenter="enter('6731257549223913473');" onmouseout="out('6731257549223913473');" style=""> 366             mAppWidgetHost = new AppWidgetHost(context, Launcher.APPWIDGET_HOST_ID);                     </span>
<span  style=""> 367                                                                                                          </span>
<span class="-7119307471557363464" onmouseenter="enter('-7119307471557363464');" onmouseout="out('-7119307471557363464');" style=""> 368             // In the case where neither onCreate nor onUpgrade gets called, we read the maxId from      </span>
<span class="-7146491614936969963" onmouseenter="enter('-7146491614936969963');" onmouseout="out('-7146491614936969963');" style=""> 369             // the DB here                                                                               </span>
<span class="-8239698715373110075" onmouseenter="enter('-8239698715373110075');" onmouseout="out('-8239698715373110075');" style=""> 370             if (mMaxItemId == -1) {                                                                      </span>
<span class="6514208419145701418" onmouseenter="enter('6514208419145701418');" onmouseout="out('6514208419145701418');" style=""> 371                 mMaxItemId = initializeMaxItemId(getWritableDatabase());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372             }                                                                                            </span>
<span class="2158219101093277292" onmouseenter="enter('2158219101093277292');" onmouseout="out('2158219101093277292');" style=""> 373             if (mMaxScreenId == -1) {                                                                    </span>
<span class="-7197865417052699646" onmouseenter="enter('-7197865417052699646');" onmouseout="out('-7197865417052699646');" style=""> 374                 mMaxScreenId = initializeMaxScreenId(getWritableDatabase());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 376         }                                                                                                </span>
<span  style=""> 377                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 378         public boolean wasNewDbCreated() {                                                               </span>
<span class="1294520975679493300" onmouseenter="enter('1294520975679493300');" onmouseout="out('1294520975679493300');" style=""> 379             return mNewDbCreated;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380         }                                                                                                </span>
<span  style=""> 381                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 382         /**                                                                                              </span>
<span class="-3713204910685876719" onmouseenter="enter('-3713204910685876719');" onmouseout="out('-3713204910685876719');" style=""> 383          * Send notification that we&#x27;ve deleted the {@link AppWidgetHost},                               </span>
<span class="-5398164636189778479" onmouseenter="enter('-5398164636189778479');" onmouseout="out('-5398164636189778479');" style=""> 384          * probably as part of the initial database creation. The receiver may                           </span>
<span class="-284834762183367019" onmouseenter="enter('-284834762183367019');" onmouseout="out('-284834762183367019');" style=""> 385          * want to re-call {@link AppWidgetHost#startListening()} to ensure                              </span>
<span class="1913597860538764992" onmouseenter="enter('1913597860538764992');" onmouseout="out('1913597860538764992');" style=""> 386          * callbacks are correctly set.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 387          */                                                                                              </span>
<span class="3384745401314169661" onmouseenter="enter('3384745401314169661');" onmouseout="out('3384745401314169661');" style=""> 388         private void sendAppWidgetResetNotify() {                                                        </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 389             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="4149774703050814155" onmouseenter="enter('4149774703050814155');" onmouseout="out('4149774703050814155');" style=""> 390             resolver.notifyChange(CONTENT_APPWIDGET_RESET_URI, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391         }                                                                                                </span>
<span  style=""> 392                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 393         @Override                                                                                        </span>
<span class="3201464308903999877" onmouseenter="enter('3201464308903999877');" onmouseout="out('3201464308903999877');" style=""> 394         public void onCreate(SQLiteDatabase db) {                                                        </span>
<span class="4744685829155971552" onmouseenter="enter('4744685829155971552');" onmouseout="out('4744685829155971552');" style=""> 395             if (LOGD) Log.d(TAG, &quot;creating new launcher database&quot;);                                      </span>
<span  style=""> 396                                                                                                          </span>
<span class="-5512536783286632376" onmouseenter="enter('-5512536783286632376');" onmouseout="out('-5512536783286632376');" style=""> 397             mMaxItemId = 1;                                                                              </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 398             mMaxScreenId = 0;                                                                            </span>
<span class="-3863035699221776712" onmouseenter="enter('-3863035699221776712');" onmouseout="out('-3863035699221776712');" style=""> 399             mNewDbCreated = true;                                                                        </span>
<span  style=""> 400                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 401             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                     </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 402             long userSerialNumber = userManager.getSerialNumberForUser(                                  </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 403                     UserHandleCompat.myUserHandle());                                                    </span>
<span  style=""> 404                                                                                                          </span>
<span class="-5810771542500139933" onmouseenter="enter('-5810771542500139933');" onmouseout="out('-5810771542500139933');" style=""> 405             db.execSQL(&quot;CREATE TABLE favorites (&quot; +                                                      </span>
<span class="-7286867248755276119" onmouseenter="enter('-7286867248755276119');" onmouseout="out('-7286867248755276119');" style=""> 406                     &quot;_id INTEGER PRIMARY KEY,&quot; +                                                         </span>
<span class="5329137835308229169" onmouseenter="enter('5329137835308229169');" onmouseout="out('5329137835308229169');" style=""> 407                     &quot;title TEXT,&quot; +                                                                      </span>
<span class="-7776152072054589061" onmouseenter="enter('-7776152072054589061');" onmouseout="out('-7776152072054589061');" style=""> 408                     &quot;intent TEXT,&quot; +                                                                     </span>
<span class="4982593742089674958" onmouseenter="enter('4982593742089674958');" onmouseout="out('4982593742089674958');" style=""> 409                     &quot;container INTEGER,&quot; +                                                               </span>
<span class="-1871026270657853169" onmouseenter="enter('-1871026270657853169');" onmouseout="out('-1871026270657853169');" style=""> 410                     &quot;screen INTEGER,&quot; +                                                                  </span>
<span class="-9174211260981343890" onmouseenter="enter('-9174211260981343890');" onmouseout="out('-9174211260981343890');" style=""> 411                     &quot;cellX INTEGER,&quot; +                                                                   </span>
<span class="1584772009960348649" onmouseenter="enter('1584772009960348649');" onmouseout="out('1584772009960348649');" style=""> 412                     &quot;cellY INTEGER,&quot; +                                                                   </span>
<span class="5424055190881126727" onmouseenter="enter('5424055190881126727');" onmouseout="out('5424055190881126727');" style=""> 413                     &quot;spanX INTEGER,&quot; +                                                                   </span>
<span class="6553755327503045229" onmouseenter="enter('6553755327503045229');" onmouseout="out('6553755327503045229');" style=""> 414                     &quot;spanY INTEGER,&quot; +                                                                   </span>
<span class="5229848414421823036" onmouseenter="enter('5229848414421823036');" onmouseout="out('5229848414421823036');" style=""> 415                     &quot;itemType INTEGER,&quot; +                                                                </span>
<span class="-1771151571856416667" onmouseenter="enter('-1771151571856416667');" onmouseout="out('-1771151571856416667');" style=""> 416                     &quot;appWidgetId INTEGER NOT NULL DEFAULT -1,&quot; +                                         </span>
<span class="-9047067707489472437" onmouseenter="enter('-9047067707489472437');" onmouseout="out('-9047067707489472437');" style=""> 417                     &quot;isShortcut INTEGER,&quot; +                                                              </span>
<span class="-3445858598434382544" onmouseenter="enter('-3445858598434382544');" onmouseout="out('-3445858598434382544');" style=""> 418                     &quot;iconType INTEGER,&quot; +                                                                </span>
<span class="4279668316006004948" onmouseenter="enter('4279668316006004948');" onmouseout="out('4279668316006004948');" style=""> 419                     &quot;iconPackage TEXT,&quot; +                                                                </span>
<span class="2008284586023778304" onmouseenter="enter('2008284586023778304');" onmouseout="out('2008284586023778304');" style=""> 420                     &quot;iconResource TEXT,&quot; +                                                               </span>
<span class="-5981868381948376489" onmouseenter="enter('-5981868381948376489');" onmouseout="out('-5981868381948376489');" style=""> 421                     &quot;icon BLOB,&quot; +                                                                       </span>
<span class="5686768105176115842" onmouseenter="enter('5686768105176115842');" onmouseout="out('5686768105176115842');" style=""> 422                     &quot;uri TEXT,&quot; +                                                                        </span>
<span class="-5470568819214956502" onmouseenter="enter('-5470568819214956502');" onmouseout="out('-5470568819214956502');" style=""> 423                     &quot;displayMode INTEGER,&quot; +                                                             </span>
<span class="3582502352252677630" onmouseenter="enter('3582502352252677630');" onmouseout="out('3582502352252677630');" style=""> 424                     &quot;appWidgetProvider TEXT,&quot; +                                                          </span>
<span class="4065658841092455651" onmouseenter="enter('4065658841092455651');" onmouseout="out('4065658841092455651');" style=""> 425                     &quot;modified INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="422282607120493296" onmouseenter="enter('422282607120493296');" onmouseout="out('422282607120493296');" style=""> 426                     &quot;restored INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="823907807759654324" onmouseenter="enter('823907807759654324');" onmouseout="out('823907807759654324');" style=""> 427                     &quot;profileId INTEGER DEFAULT &quot; + userSerialNumber + &quot;,&quot; +                              </span>
<span class="-8486149279194715653" onmouseenter="enter('-8486149279194715653');" onmouseout="out('-8486149279194715653');" style=""> 428                     &quot;rank INTEGER NOT NULL DEFAULT 0&quot; +                                                  </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 429                     &quot;);&quot;);                                                                               </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 430             addWorkspacesTable(db);                                                                      </span>
<span  style=""> 431                                                                                                          </span>
<span class="-1982623284376040662" onmouseenter="enter('-1982623284376040662');" onmouseout="out('-1982623284376040662');" style=""> 432             // Database was just created, so wipe any previous widgets                                   </span>
<span class="35469525966995251" onmouseenter="enter('35469525966995251');" onmouseout="out('35469525966995251');" style=""> 433             if (mAppWidgetHost != null) {                                                                </span>
<span class="2879907381293157546" onmouseenter="enter('2879907381293157546');" onmouseout="out('2879907381293157546');" style=""> 434                 mAppWidgetHost.deleteHost();                                                             </span>
<span class="-5770229164268459929" onmouseenter="enter('-5770229164268459929');" onmouseout="out('-5770229164268459929');" style=""> 435                 sendAppWidgetResetNotify();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436             }                                                                                            </span>
<span  style=""> 437                                                                                                          </span>
<span class="-1063142603395313746" onmouseenter="enter('-1063142603395313746');" onmouseout="out('-1063142603395313746');" style=""> 438             // Fresh and clean launcher DB.                                                              </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 439             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="7629543500667828090" onmouseenter="enter('7629543500667828090');" onmouseout="out('7629543500667828090');" style=""> 440             setFlagEmptyDbCreated();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441         }                                                                                                </span>
<span  style=""> 442                                                                                                          </span>
<span class="6272912136443308513" onmouseenter="enter('6272912136443308513');" onmouseout="out('6272912136443308513');" style=""> 443         private void addWorkspacesTable(SQLiteDatabase db) {                                             </span>
<span class="2730049849658983478" onmouseenter="enter('2730049849658983478');" onmouseout="out('2730049849658983478');" style=""> 444             db.execSQL(&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS + &quot; (&quot; +                                </span>
<span class="3055097616701045664" onmouseenter="enter('3055097616701045664');" onmouseout="out('3055097616701045664');" style=""> 445                     LauncherSettings.WorkspaceScreens._ID + &quot; INTEGER PRIMARY KEY,&quot; +                    </span>
<span class="-8340457193420065897" onmouseenter="enter('-8340457193420065897');" onmouseout="out('-8340457193420065897');" style=""> 446                     LauncherSettings.WorkspaceScreens.SCREEN_RANK + &quot; INTEGER,&quot; +                        </span>
<span class="7771125962287368960" onmouseenter="enter('7771125962287368960');" onmouseout="out('7771125962287368960');" style=""> 447                     LauncherSettings.ChangeLogColumns.MODIFIED + &quot; INTEGER NOT NULL DEFAULT 0&quot; +         </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 448                     &quot;);&quot;);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449         }                                                                                                </span>
<span  style=""> 450                                                                                                          </span>
<span class="-3232037806458942317" onmouseenter="enter('-3232037806458942317');" onmouseout="out('-3232037806458942317');" style=""> 451         private void removeOrphanedItems(SQLiteDatabase db) {                                            </span>
<span class="-3995909494643948388" onmouseenter="enter('-3995909494643948388');" onmouseout="out('-3995909494643948388');" style=""> 452             // Delete items directly on the workspace who&#x27;s screen id doesn&#x27;t exist                      </span>
<span class="6555258266445461688" onmouseenter="enter('6555258266445461688');" onmouseout="out('6555258266445461688');" style=""> 453             //  &quot;DELETE FROM favorites WHERE screen NOT IN (SELECT _id FROM workspaceScreens)            </span>
<span class="-1584785563187965465" onmouseenter="enter('-1584785563187965465');" onmouseout="out('-1584785563187965465');" style=""> 454             //   AND container = -100&quot;                                                                   </span>
<span class="-3502523792993972030" onmouseenter="enter('-3502523792993972030');" onmouseout="out('-3502523792993972030');" style=""> 455             String removeOrphanedDesktopItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                       </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 456                     &quot; WHERE &quot; +                                                                          </span>
<span class="-8781539607986806909" onmouseenter="enter('-8781539607986806909');" onmouseout="out('-8781539607986806909');" style=""> 457                     LauncherSettings.Favorites.SCREEN + &quot; NOT IN (SELECT &quot; +                             </span>
<span class="-3730067412022302503" onmouseenter="enter('-3730067412022302503');" onmouseout="out('-3730067412022302503');" style=""> 458                     LauncherSettings.WorkspaceScreens._ID + &quot; FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot;)&quot; +   </span>
<span class="8831213357842987069" onmouseenter="enter('8831213357842987069');" onmouseout="out('8831213357842987069');" style=""> 459                     &quot; AND &quot; +                                                                            </span>
<span class="-3912897749337440213" onmouseenter="enter('-3912897749337440213');" onmouseout="out('-3912897749337440213');" style=""> 460                     LauncherSettings.Favorites.CONTAINER + &quot; = &quot; +                                       </span>
<span class="-1572782876841487653" onmouseenter="enter('-1572782876841487653');" onmouseout="out('-1572782876841487653');" style=""> 461                     LauncherSettings.Favorites.CONTAINER_DESKTOP;                                        </span>
<span class="-5442680607495552531" onmouseenter="enter('-5442680607495552531');" onmouseout="out('-5442680607495552531');" style=""> 462             db.execSQL(removeOrphanedDesktopItems);                                                      </span>
<span  style=""> 463                                                                                                          </span>
<span class="2150462606818952724" onmouseenter="enter('2150462606818952724');" onmouseout="out('2150462606818952724');" style=""> 464             // Delete items contained in folders which no longer exist (after above statement)           </span>
<span class="7157590486959116676" onmouseenter="enter('7157590486959116676');" onmouseout="out('7157590486959116676');" style=""> 465             //  &quot;DELETE FROM favorites  WHERE container &lt;&gt; -100 AND container &lt;&gt; -101 AND container      </span>
<span class="4713393280747800603" onmouseenter="enter('4713393280747800603');" onmouseout="out('4713393280747800603');" style=""> 466             //   NOT IN (SELECT _id FROM favorites WHERE itemType = 2)&quot;                                  </span>
<span class="-8895952306054120744" onmouseenter="enter('-8895952306054120744');" onmouseout="out('-8895952306054120744');" style=""> 467             String removeOrphanedFolderItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 468                     &quot; WHERE &quot; +                                                                          </span>
<span class="-9165304043886914201" onmouseenter="enter('-9165304043886914201');" onmouseout="out('-9165304043886914201');" style=""> 469                     LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                      </span>
<span class="2430974176390543784" onmouseenter="enter('2430974176390543784');" onmouseout="out('2430974176390543784');" style=""> 470                     LauncherSettings.Favorites.CONTAINER_DESKTOP +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 471                     &quot; AND &quot;                                                                              </span>
<span class="5144458996296891504" onmouseenter="enter('5144458996296891504');" onmouseout="out('5144458996296891504');" style=""> 472                     + LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                    </span>
<span class="20571678636460503" onmouseenter="enter('20571678636460503');" onmouseout="out('20571678636460503');" style=""> 473                     LauncherSettings.Favorites.CONTAINER_HOTSEAT +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 474                     &quot; AND &quot;                                                                              </span>
<span class="-4280152506863766824" onmouseenter="enter('-4280152506863766824');" onmouseout="out('-4280152506863766824');" style=""> 475                     + LauncherSettings.Favorites.CONTAINER + &quot; NOT IN (SELECT &quot; +                        </span>
<span class="-971280935083657149" onmouseenter="enter('-971280935083657149');" onmouseout="out('-971280935083657149');" style=""> 476                     LauncherSettings.Favorites._ID + &quot; FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="4038942553560789906" onmouseenter="enter('4038942553560789906');" onmouseout="out('4038942553560789906');" style=""> 477                     &quot; WHERE &quot; + LauncherSettings.Favorites.ITEM_TYPE + &quot; = &quot; +                           </span>
<span class="-1734962565729646321" onmouseenter="enter('-1734962565729646321');" onmouseout="out('-1734962565729646321');" style=""> 478                     LauncherSettings.Favorites.ITEM_TYPE_FOLDER + &quot;)&quot;;                                   </span>
<span class="-8852316947474253726" onmouseenter="enter('-8852316947474253726');" onmouseout="out('-8852316947474253726');" style=""> 479             db.execSQL(removeOrphanedFolderItems);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480         }                                                                                                </span>
<span  style=""> 481                                                                                                          </span>
<span class="-2961433455992777066" onmouseenter="enter('-2961433455992777066');" onmouseout="out('-2961433455992777066');" style=""> 482         private void setFlagJustLoadedOldDb() {                                                          </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 483             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 484             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="6248178474895602573" onmouseenter="enter('6248178474895602573');" onmouseout="out('6248178474895602573');" style=""> 485             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, false).commit();                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486         }                                                                                                </span>
<span  style=""> 487                                                                                                          </span>
<span class="3580170518454540960" onmouseenter="enter('3580170518454540960');" onmouseout="out('3580170518454540960');" style=""> 488         private void setFlagEmptyDbCreated() {                                                           </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 489             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 490             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="-1598905447100916131" onmouseenter="enter('-1598905447100916131');" onmouseout="out('-1598905447100916131');" style=""> 491             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, true).commit();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492         }                                                                                                </span>
<span  style=""> 493                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 494         @Override                                                                                        </span>
<span class="-4655538025867202729" onmouseenter="enter('-4655538025867202729');" onmouseout="out('-4655538025867202729');" style=""> 495         public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {                       </span>
<span class="-3337256987478665120" onmouseenter="enter('-3337256987478665120');" onmouseout="out('-3337256987478665120');" style=""> 496             if (LOGD) Log.d(TAG, &quot;onUpgrade triggered: &quot; + oldVersion);                                  </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 497             switch (oldVersion) {                                                                        </span>
<span class="9079869636182330080" onmouseenter="enter('9079869636182330080');" onmouseout="out('9079869636182330080');" style=""> 498                 // The version cannot be lower that 12, as Launcher3 never supported a lower             </span>
<span class="-4883409179661970227" onmouseenter="enter('-4883409179661970227');" onmouseout="out('-4883409179661970227');" style=""> 499                 // version of the DB.                                                                    </span>
<span class="3359875150199815819" onmouseenter="enter('3359875150199815819');" onmouseout="out('3359875150199815819');" style=""> 500                 case 12: {                                                                               </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style=""> 501                 // With the new shrink-wrapped and re-orderable workspaces, it makes sense               </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style=""> 502                 // to persist workspace screens and their relative order.                                </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 503                 mMaxScreenId = 0;                                                                        </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 504                 addWorkspacesTable(db);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505             }                                                                                            </span>
<span class="-3873917579330875824" onmouseenter="enter('-3873917579330875824');" onmouseout="out('-3873917579330875824');" style=""> 506                 case 13: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 507                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 508                 try {                                                                                    </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style=""> 509                     // Insert new column for holding widget provider name                                </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 510                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="-1191376551368325446" onmouseenter="enter('-1191376551368325446');" onmouseout="out('-1191376551368325446');" style=""> 511                             &quot;ADD COLUMN appWidgetProvider TEXT;&quot;);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 512                     db.setTransactionSuccessful();                                                       </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 513                 } catch (SQLException ex) {                                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 514                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 515                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 516                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 517                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 518                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 520             }                                                                                            </span>
<span class="8507938363259012736" onmouseenter="enter('8507938363259012736');" onmouseout="out('8507938363259012736');" style=""> 521                 case 14: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 522                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 523                 try {                                                                                    </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style=""> 524                     // Insert new column for holding update timestamp                                    </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 525                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 526                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style=""> 527                     db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                         </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 528                             &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 529                     db.setTransactionSuccessful();                                                       </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 530                 } catch (SQLException ex) {                                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 531                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 532                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 533                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 534                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 535                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 536                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537             }                                                                                            </span>
<span class="8561964280724983620" onmouseenter="enter('8561964280724983620');" onmouseout="out('8561964280724983620');" style=""> 538                 case 15: {                                                                               </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 539                 db.beginTransaction();                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 540                 try {                                                                                    </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style=""> 541                     // Insert new column for holding restore status                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 542                     db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style=""> 543                             &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                          </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 544                     db.setTransactionSuccessful();                                                       </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 545                 } catch (SQLException ex) {                                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 546                     Log.e(TAG, ex.getMessage(), ex);                                                     </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 547                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 548                         break;                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 549                 } finally {                                                                              </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 550                     db.endTransaction();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 551                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552             }                                                                                            </span>
<span class="7575290899313355683" onmouseenter="enter('7575290899313355683');" onmouseout="out('7575290899313355683');" style=""> 553                 case 16: {                                                                               </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style=""> 554                 // We use the db version upgrade here to identify users who may not have seen            </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style=""> 555                 // clings yet (because they weren&#x27;t available), but for whom the clings are now          </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style=""> 556                 // available (tablet users). Because one of the possible cling flows (migration)         </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style=""> 557                 // is very destructive (wipes out workspaces), we want to prevent this from showing      </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style=""> 558                 // until clear data. We do so by marking that the clings have been shown.                </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style=""> 559                 LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 560             }                                                                                            </span>
<span class="874358258533148680" onmouseenter="enter('874358258533148680');" onmouseout="out('874358258533148680');" style=""> 561                 case 17: {                                                                               </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style=""> 562                 // No-op                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563             }                                                                                            </span>
<span class="7290242482342203768" onmouseenter="enter('7290242482342203768');" onmouseout="out('7290242482342203768');" style=""> 564                 case 18: {                                                                               </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style=""> 565                 // Due to a data loss bug, some users may have items associated with screen ids          </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style=""> 566                 // which no longer exist. Since this can cause other problems, and since the user        </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style=""> 567                 // will never see these items anyway, we use database upgrade as an opportunity to       </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style=""> 568                 // clean things up.                                                                      </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style=""> 569                 removeOrphanedItems(db);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 570             }                                                                                            </span>
<span class="2857663073964692700" onmouseenter="enter('2857663073964692700');" onmouseout="out('2857663073964692700');" style=""> 571                 case 19: {                                                                               </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style=""> 572                 // Add userId column                                                                     </span>
<span class="2862263159714553199" onmouseenter="enter('2862263159714553199');" onmouseout="out('2862263159714553199');" style=""> 573                     if (!addProfileColumn(db)) {                                                         </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 574                         // Old version remains, which means we wipe old data                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 575                         break;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 576                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577             }                                                                                            </span>
<span class="-901653241001302481" onmouseenter="enter('-901653241001302481');" onmouseout="out('-901653241001302481');" style=""> 578                 case 20:                                                                                 </span>
<span class="-5016813644414129178" onmouseenter="enter('-5016813644414129178');" onmouseout="out('-5016813644414129178');" style=""> 579                     if (!updateFolderItemsRank(db, true)) {                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 580                         break;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 581                     }                                                                                    </span>
<span class="-7447648558388390989" onmouseenter="enter('-7447648558388390989');" onmouseout="out('-7447648558388390989');" style=""> 582                 case 21: {                                                                               </span>
<span class="8949931370118151818" onmouseenter="enter('8949931370118151818');" onmouseout="out('8949931370118151818');" style=""> 583                     // DB Upgraded successfully                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 584                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 586             }                                                                                            </span>
<span  style=""> 587                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 588 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-498940447290760811" onmouseenter="enter('-498940447290760811');" onmouseout="out('-498940447290760811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 589             // DB was not upgraded                                                                       </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 590 ||||||| BASE                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 591             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 592                                                                                                          </span>
<span class="7499725911390962675" onmouseenter="enter('7499725911390962675');" onmouseout="out('7499725911390962675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 593             if (version &lt; 20) {                                                                          </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 594                 // Add userId column                                                                     </span>
<span class="3648122535018422218" onmouseenter="enter('3648122535018422218');" onmouseout="out('3648122535018422218');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 595                 if (addProfileColumn(db)) {                                                              </span>
<span class="-3196204954256045340" onmouseenter="enter('-3196204954256045340');" onmouseout="out('-3196204954256045340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 596                     version = 20;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 597                 }                                                                                        </span>
<span class="-7922924049235754756" onmouseenter="enter('-7922924049235754756');" onmouseout="out('-7922924049235754756');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 598                 // else old version remains, which means we wipe old data                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 599             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 600                                                                                                          </span>
<span class="-1689277129606306081" onmouseenter="enter('-1689277129606306081');" onmouseout="out('-1689277129606306081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 601             if (version &lt; 21) {                                                                          </span>
<span class="-7646592925974879249" onmouseenter="enter('-7646592925974879249');" onmouseout="out('-7646592925974879249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 602                 if (updateFolderItemsRank(db, true)) {                                                   </span>
<span class="8220648455759030377" onmouseenter="enter('8220648455759030377');" onmouseout="out('8220648455759030377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 603                     version  = 21;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 604                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 605             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 606                                                                                                          </span>
<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 607             if (version != DATABASE_VERSION) {                                                           </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 608                 Log.w(TAG, &quot;Destroying all old data.&quot;);                                                  </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 609                 createEmptyDB(db);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 610             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 611         }                                                                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 612 =======                                                                                                  </span>
<span class="-4846602042225353550" onmouseenter="enter('-4846602042225353550');" onmouseout="out('-4846602042225353550');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613             if (version == 21) {                                                                         </span>
<span class="-5097001155547350088" onmouseenter="enter('-5097001155547350088');" onmouseout="out('-5097001155547350088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614                 // Recreate workspace table with screen id a primary key                                 </span>
<span class="697484093328969732" onmouseenter="enter('697484093328969732');" onmouseout="out('697484093328969732');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615                 if (recreateWorkspaceTable(db)) {                                                        </span>
<span class="987773274296909165" onmouseenter="enter('987773274296909165');" onmouseout="out('987773274296909165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616                     version = 22;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619                                                                                                          </span>
<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620             if (version != DATABASE_VERSION) {                                                           </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 621 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style=""> 622                 Log.w(TAG, &quot;Destroying all old data.&quot;);                                                  </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 623                 createEmptyDB(db);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624             }                                                                                            </span>
<span  style=""> 625                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 626         @Override                                                                                        </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style=""> 627         public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                     </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style=""> 628             // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                    </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style=""> 629             Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +          </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style=""> 630                     &quot;. Wiping databse.&quot;);                                                                </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 631             createEmptyDB(db);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 632         }                                                                                                </span>
<span  style=""> 633                                                                                                          </span>
<span  style=""> 634                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 635         /**                                                                                              </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 636          * Clears all the data for a fresh start.                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 637          */                                                                                              </span>
<span class="3436200006891248330" onmouseenter="enter('3436200006891248330');" onmouseout="out('3436200006891248330');" style=""> 638         public void createEmptyDB(SQLiteDatabase db) {                                                   </span>
<span class="-5910745818286558462" onmouseenter="enter('-5910745818286558462');" onmouseout="out('-5910745818286558462');" style=""> 639             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_FAVORITES);                                       </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 640             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                               </span>
<span class="1466158746107327510" onmouseenter="enter('1466158746107327510');" onmouseout="out('1466158746107327510');" style=""> 641             onCreate(db);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642         }                                                                                                </span>
<span  style=""> 643                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 644         /**                                                                                              </span>
<span class="-1053110313716749360" onmouseenter="enter('-1053110313716749360');" onmouseout="out('-1053110313716749360');" style=""> 645          * Recreates workspace table and migrates data to the new table.                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 646          */                                                                                              </span>
<span class="-7546703806174777110" onmouseenter="enter('-7546703806174777110');" onmouseout="out('-7546703806174777110');" style=""> 647         public boolean recreateWorkspaceTable(SQLiteDatabase db) {                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 648             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 649             try {                                                                                        </span>
<span class="5182132674792153706" onmouseenter="enter('5182132674792153706');" onmouseout="out('5182132674792153706');" style=""> 650                 Cursor c = db.query(TABLE_WORKSPACE_SCREENS,                                             </span>
<span class="3343280592061827584" onmouseenter="enter('3343280592061827584');" onmouseout="out('3343280592061827584');" style=""> 651                         new String[] {LauncherSettings.WorkspaceScreens._ID},                            </span>
<span class="2929567931923591515" onmouseenter="enter('2929567931923591515');" onmouseout="out('2929567931923591515');" style=""> 652                         null, null, null, null,                                                          </span>
<span class="5916017515631826997" onmouseenter="enter('5916017515631826997');" onmouseout="out('5916017515631826997');" style=""> 653                         LauncherSettings.WorkspaceScreens.SCREEN_RANK);                                  </span>
<span class="-1823344416972566514" onmouseenter="enter('-1823344416972566514');" onmouseout="out('-1823344416972566514');" style=""> 654                 ArrayList&lt;Long&gt; sortedIDs = new ArrayList&lt;Long&gt;();                                       </span>
<span class="4402015381954986250" onmouseenter="enter('4402015381954986250');" onmouseout="out('4402015381954986250');" style=""> 655                 long maxId = 0;                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 656                 try {                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 657                     while (c.moveToNext()) {                                                             </span>
<span class="3955822985937591936" onmouseenter="enter('3955822985937591936');" onmouseout="out('3955822985937591936');" style=""> 658                         Long id = c.getLong(0);                                                          </span>
<span class="-8099018151679223899" onmouseenter="enter('-8099018151679223899');" onmouseout="out('-8099018151679223899');" style=""> 659                         if (!sortedIDs.contains(id)) {                                                   </span>
<span class="4916945519325465611" onmouseenter="enter('4916945519325465611');" onmouseout="out('4916945519325465611');" style=""> 660                             sortedIDs.add(id);                                                           </span>
<span class="2021292296450644008" onmouseenter="enter('2021292296450644008');" onmouseout="out('2021292296450644008');" style=""> 661                             maxId = Math.max(maxId, id);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 662                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 664                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 665                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 666                 }                                                                                        </span>
<span  style=""> 667                                                                                                          </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 668                 db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                           </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 669                 addWorkspacesTable(db);                                                                  </span>
<span  style=""> 670                                                                                                          </span>
<span class="-8504221546344504536" onmouseenter="enter('-8504221546344504536');" onmouseout="out('-8504221546344504536');" style=""> 671                 // Add all screen ids back                                                               </span>
<span class="-3342479167869315002" onmouseenter="enter('-3342479167869315002');" onmouseout="out('-3342479167869315002');" style=""> 672                 int total = sortedIDs.size();                                                            </span>
<span class="1933062560544426975" onmouseenter="enter('1933062560544426975');" onmouseout="out('1933062560544426975');" style=""> 673                 for (int i = 0; i &lt; total; i++) {                                                        </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 674                     ContentValues values = new ContentValues();                                          </span>
<span class="-1408476222282542161" onmouseenter="enter('-1408476222282542161');" onmouseout="out('-1408476222282542161');" style=""> 675                     values.put(LauncherSettings.WorkspaceScreens._ID, sortedIDs.get(i));                 </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style=""> 676                     values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                        </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 677                     addModifiedTime(values);                                                             </span>
<span class="-5345205574848137989" onmouseenter="enter('-5345205574848137989');" onmouseout="out('-5345205574848137989');" style=""> 678                     db.insertOrThrow(TABLE_WORKSPACE_SCREENS, null, values);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 679                 }                                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 680                 db.setTransactionSuccessful();                                                           </span>
<span class="-777319983275495791" onmouseenter="enter('-777319983275495791');" onmouseout="out('-777319983275495791');" style=""> 681                 mMaxScreenId = maxId;                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 682             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 683                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 684                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 685                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 686             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 687                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 689             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690         }                                                                                                </span>
<span  style=""> 691                                                                                                          </span>
<span class="-7501286576844846445" onmouseenter="enter('-7501286576844846445');" onmouseout="out('-7501286576844846445');" style=""> 692         private boolean updateFolderItemsRank(SQLiteDatabase db, boolean addRankColumn) {                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 693             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 694             try {                                                                                        </span>
<span class="5008547084206266322" onmouseenter="enter('5008547084206266322');" onmouseout="out('5008547084206266322');" style=""> 695                 if (addRankColumn) {                                                                     </span>
<span class="-7289454301230657535" onmouseenter="enter('-7289454301230657535');" onmouseout="out('-7289454301230657535');" style=""> 696                     // Insert new column for holding rank                                                </span>
<span class="-1590113536171608350" onmouseenter="enter('-1590113536171608350');" onmouseout="out('-1590113536171608350');" style=""> 697                     db.execSQL(&quot;ALTER TABLE favorites ADD COLUMN rank INTEGER NOT NULL DEFAULT 0;&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 698                 }                                                                                        </span>
<span  style=""> 699                                                                                                          </span>
<span class="-6084339731876053459" onmouseenter="enter('-6084339731876053459');" onmouseout="out('-6084339731876053459');" style=""> 700                 // Get a map for folder ID to folder width                                               </span>
<span class="7958578721408666232" onmouseenter="enter('7958578721408666232');" onmouseout="out('7958578721408666232');" style=""> 701                 Cursor c = db.rawQuery(&quot;SELECT container, MAX(cellX) FROM favorites&quot;                     </span>
<span class="1296304159181878428" onmouseenter="enter('1296304159181878428');" onmouseout="out('1296304159181878428');" style=""> 702                         + &quot; WHERE container IN (SELECT _id FROM favorites WHERE itemType = ?)&quot;           </span>
<span class="8240981592991850481" onmouseenter="enter('8240981592991850481');" onmouseout="out('8240981592991850481');" style=""> 703                         + &quot; GROUP BY container;&quot;,                                                        </span>
<span class="-3631725497478036647" onmouseenter="enter('-3631725497478036647');" onmouseout="out('-3631725497478036647');" style=""> 704                         new String[] {Integer.toString(LauncherSettings.Favorites.ITEM_TYPE_FOLDER)});   </span>
<span  style=""> 705                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 706                 while (c.moveToNext()) {                                                                 </span>
<span class="-6809072711155135098" onmouseenter="enter('-6809072711155135098');" onmouseout="out('-6809072711155135098');" style=""> 707                     db.execSQL(&quot;UPDATE favorites SET rank=cellX+(cellY*?) WHERE &quot;                        </span>
<span class="8697652523066470339" onmouseenter="enter('8697652523066470339');" onmouseout="out('8697652523066470339');" style=""> 708                             + &quot;container=? AND cellX IS NOT NULL AND cellY IS NOT NULL;&quot;,                </span>
<span class="-3010724386050799789" onmouseenter="enter('-3010724386050799789');" onmouseout="out('-3010724386050799789');" style=""> 709                             new Object[] {c.getLong(1) + 1, c.getLong(0)});                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 710                 }                                                                                        </span>
<span  style=""> 711                                                                                                          </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 712                 c.close();                                                                               </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 713                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 714             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 715                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 716                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 717                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 718             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 719                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 720             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 721             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722         }                                                                                                </span>
<span  style=""> 723                                                                                                          </span>
<span class="-4559468305095454841" onmouseenter="enter('-4559468305095454841');" onmouseout="out('-4559468305095454841');" style=""> 724         private boolean addProfileColumn(SQLiteDatabase db) {                                            </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 725             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 726             try {                                                                                        </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 727                 UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                 </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 728                 // Default to the serial number of this user, for older                                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 729                 // shortcuts.                                                                            </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 730                 long userSerialNumber = userManager.getSerialNumberForUser(                              </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 731                         UserHandleCompat.myUserHandle());                                                </span>
<span class="-7537890297935646580" onmouseenter="enter('-7537890297935646580');" onmouseout="out('-7537890297935646580');" style=""> 732                 // Insert new column for holding user serial number                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 733                 db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                    </span>
<span class="6389325795698900878" onmouseenter="enter('6389325795698900878');" onmouseout="out('6389325795698900878');" style=""> 734                         &quot;ADD COLUMN profileId INTEGER DEFAULT &quot;                                          </span>
<span class="-6027465318491077769" onmouseenter="enter('-6027465318491077769');" onmouseout="out('-6027465318491077769');" style=""> 735                                         + userSerialNumber + &quot;;&quot;);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 736                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 737             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 738                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 739                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 740                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 741             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 742                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 744             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 745         }                                                                                                </span>
<span  style=""> 746                                                                                                          </span>
<span class="-8543343401238088250" onmouseenter="enter('-8543343401238088250');" onmouseout="out('-8543343401238088250');" style=""> 747         // Generates a new ID to use for an object in your database. This method should be only          </span>
<span class="-535999813132446250" onmouseenter="enter('-535999813132446250');" onmouseout="out('-535999813132446250');" style=""> 748         // called from the main UI thread. As an exception, we do call it when we call the               </span>
<span class="-3416944691245960228" onmouseenter="enter('-3416944691245960228');" onmouseout="out('-3416944691245960228');" style=""> 749         // constructor from the worker thread; however, this doesn&#x27;t extend until after the              </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 750         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 751         // after that point                                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 752         @Override                                                                                        </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 753         public long generateNewItemId() {                                                                </span>
<span class="2999684209048406821" onmouseenter="enter('2999684209048406821');" onmouseout="out('2999684209048406821');" style=""> 754             if (mMaxItemId &lt; 0) {                                                                        </span>
<span class="-7068859972649181897" onmouseenter="enter('-7068859972649181897');" onmouseout="out('-7068859972649181897');" style=""> 755                 throw new RuntimeException(&quot;Error: max item id was not initialized&quot;);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 756             }                                                                                            </span>
<span class="-2732750815463784999" onmouseenter="enter('-2732750815463784999');" onmouseout="out('-2732750815463784999');" style=""> 757             mMaxItemId += 1;                                                                             </span>
<span class="5456580978366825274" onmouseenter="enter('5456580978366825274');" onmouseout="out('5456580978366825274');" style=""> 758             return mMaxItemId;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 759         }                                                                                                </span>
<span  style=""> 760                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 761         @Override                                                                                        </span>
<span class="329443540154066398" onmouseenter="enter('329443540154066398');" onmouseout="out('329443540154066398');" style=""> 762         public long insertAndCheck(SQLiteDatabase db, ContentValues values) {                            </span>
<span class="-1505151618823806706" onmouseenter="enter('-1505151618823806706');" onmouseout="out('-1505151618823806706');" style=""> 763             return dbInsertAndCheck(this, db, TABLE_FAVORITES, null, values);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 764         }                                                                                                </span>
<span  style=""> 765                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 766         public void updateMaxItemId(long id) {                                                           </span>
<span class="-6849429476525109058" onmouseenter="enter('-6849429476525109058');" onmouseout="out('-6849429476525109058');" style=""> 767             mMaxItemId = id + 1;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 768         }                                                                                                </span>
<span  style=""> 769                                                                                                          </span>
<span class="-7367368828761155068" onmouseenter="enter('-7367368828761155068');" onmouseout="out('-7367368828761155068');" style=""> 770         public void checkId(String table, ContentValues values) {                                        </span>
<span class="-1608142162103033850" onmouseenter="enter('-1608142162103033850');" onmouseout="out('-1608142162103033850');" style=""> 771             long id = values.getAsLong(LauncherSettings.BaseLauncherColumns._ID);                        </span>
<span class="-6900211224990683940" onmouseenter="enter('-6900211224990683940');" onmouseout="out('-6900211224990683940');" style=""> 772             if (table == LauncherProvider.TABLE_WORKSPACE_SCREENS) {                                     </span>
<span class="9109073648364222254" onmouseenter="enter('9109073648364222254');" onmouseout="out('9109073648364222254');" style=""> 773                 mMaxScreenId = Math.max(id, mMaxScreenId);                                               </span>
<span class="-6240460135729763291" onmouseenter="enter('-6240460135729763291');" onmouseout="out('-6240460135729763291');" style=""> 774             }  else {                                                                                    </span>
<span class="754800730159449376" onmouseenter="enter('754800730159449376');" onmouseout="out('754800730159449376');" style=""> 775                 mMaxItemId = Math.max(id, mMaxItemId);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 776             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 777         }                                                                                                </span>
<span  style=""> 778                                                                                                          </span>
<span class="-8013451254632200820" onmouseenter="enter('-8013451254632200820');" onmouseout="out('-8013451254632200820');" style=""> 779         private long initializeMaxItemId(SQLiteDatabase db) {                                            </span>
<span class="-6457280004469744269" onmouseenter="enter('-6457280004469744269');" onmouseout="out('-6457280004469744269');" style=""> 780             Cursor c = db.rawQuery(&quot;SELECT MAX(_id) FROM favorites&quot;, null);                              </span>
<span  style=""> 781                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 782             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 783             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 784             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 785             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 786                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 787             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 788             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 789                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 790             }                                                                                            </span>
<span  style=""> 791                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 792             if (id == -1) {                                                                              </span>
<span class="-8632333559810917367" onmouseenter="enter('-8632333559810917367');" onmouseout="out('-8632333559810917367');" style=""> 793                 throw new RuntimeException(&quot;Error: could not query max item id&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 794             }                                                                                            </span>
<span  style=""> 795                                                                                                          </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 796             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797         }                                                                                                </span>
<span  style=""> 798                                                                                                          </span>
<span class="3292148501075941248" onmouseenter="enter('3292148501075941248');" onmouseout="out('3292148501075941248');" style=""> 799         // Generates a new ID to use for an workspace screen in your database. This method               </span>
<span class="8169251972405240623" onmouseenter="enter('8169251972405240623');" onmouseout="out('8169251972405240623');" style=""> 800         // should be only called from the main UI thread. As an exception, we do call it when we         </span>
<span class="5354260748737756868" onmouseenter="enter('5354260748737756868');" onmouseout="out('5354260748737756868');" style=""> 801         // call the constructor from the worker thread; however, this doesn&#x27;t extend until after the     </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 802         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 803         // after that point                                                                              </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 804         public long generateNewScreenId() {                                                              </span>
<span class="-2601779586206833262" onmouseenter="enter('-2601779586206833262');" onmouseout="out('-2601779586206833262');" style=""> 805             if (mMaxScreenId &lt; 0) {                                                                      </span>
<span class="-8395628436366181623" onmouseenter="enter('-8395628436366181623');" onmouseout="out('-8395628436366181623');" style=""> 806                 throw new RuntimeException(&quot;Error: max screen id was not initialized&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 807             }                                                                                            </span>
<span class="-7600499966171393409" onmouseenter="enter('-7600499966171393409');" onmouseout="out('-7600499966171393409');" style=""> 808             mMaxScreenId += 1;                                                                           </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 809             // Log to disk                                                                               </span>
<span class="-8761729187376845632" onmouseenter="enter('-8761729187376845632');" onmouseout="out('-8761729187376845632');" style=""> 810             Launcher.addDumpLog(TAG, &quot;11683562 - generateNewScreenId(): &quot; + mMaxScreenId, true);         </span>
<span class="-2082539956971430335" onmouseenter="enter('-2082539956971430335');" onmouseout="out('-2082539956971430335');" style=""> 811             return mMaxScreenId;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812         }                                                                                                </span>
<span  style=""> 813                                                                                                          </span>
<span class="1340022180158952931" onmouseenter="enter('1340022180158952931');" onmouseout="out('1340022180158952931');" style=""> 814         private long initializeMaxScreenId(SQLiteDatabase db) {                                          </span>
<span class="-2625939584691052131" onmouseenter="enter('-2625939584691052131');" onmouseout="out('-2625939584691052131');" style=""><abbr title=" 815             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);"> 815             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TA🔵</abbr></span>
<span  style=""> 816                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 817             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 818             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 819             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 820             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 821                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 822             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 823             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 824                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 825             }                                                                                            </span>
<span  style=""> 826                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 827             if (id == -1) {                                                                              </span>
<span class="5981752458110974976" onmouseenter="enter('5981752458110974976');" onmouseout="out('5981752458110974976');" style=""> 828                 throw new RuntimeException(&quot;Error: could not query max screen id&quot;);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 829             }                                                                                            </span>
<span  style=""> 830                                                                                                          </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 831             // Log to disk                                                                               </span>
<span class="27430974887508761" onmouseenter="enter('27430974887508761');" onmouseout="out('27430974887508761');" style=""> 832             Launcher.addDumpLog(TAG, &quot;11683562 - initializeMaxScreenId(): &quot; + id, true);                 </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 833             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834         }                                                                                                </span>
<span  style=""> 835                                                                                                          </span>
<span class="1383368615032249869" onmouseenter="enter('1383368615032249869');" onmouseout="out('1383368615032249869');" style=""> 836         private boolean initializeExternalAdd(ContentValues values) {                                    </span>
<span class="-4585320292275114767" onmouseenter="enter('-4585320292275114767');" onmouseout="out('-4585320292275114767');" style=""> 837             // 1. Ensure that externally added items have a valid item id                                </span>
<span class="-4828262327370557067" onmouseenter="enter('-4828262327370557067');" onmouseout="out('-4828262327370557067');" style=""> 838             long id = generateNewItemId();                                                               </span>
<span class="-4305015780380424948" onmouseenter="enter('-4305015780380424948');" onmouseout="out('-4305015780380424948');" style=""> 839             values.put(LauncherSettings.Favorites._ID, id);                                              </span>
<span  style=""> 840                                                                                                          </span>
<span class="5555856101718413728" onmouseenter="enter('5555856101718413728');" onmouseout="out('5555856101718413728');" style=""> 841             // 2. In the case of an app widget, and if no app widget id is specified, we                 </span>
<span class="5653436237424007902" onmouseenter="enter('5653436237424007902');" onmouseout="out('5653436237424007902');" style=""> 842             // attempt allocate and bind the widget.                                                     </span>
<span class="7737959233990593661" onmouseenter="enter('7737959233990593661');" onmouseout="out('7737959233990593661');" style=""> 843             Integer itemType = values.getAsInteger(LauncherSettings.Favorites.ITEM_TYPE);                </span>
<span class="2055658702897830579" onmouseenter="enter('2055658702897830579');" onmouseout="out('2055658702897830579');" style=""> 844             if (itemType != null &amp;&amp;                                                                      </span>
<span class="-1739021162756129174" onmouseenter="enter('-1739021162756129174');" onmouseout="out('-1739021162756129174');" style=""> 845                     itemType.intValue() == LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET &amp;&amp;             </span>
<span class="-6215251601594981481" onmouseenter="enter('-6215251601594981481');" onmouseout="out('-6215251601594981481');" style=""> 846                     !values.containsKey(LauncherSettings.Favorites.APPWIDGET_ID)) {                      </span>
<span  style=""> 847                                                                                                          </span>
<span class="328319718470950320" onmouseenter="enter('328319718470950320');" onmouseout="out('328319718470950320');" style=""> 848                 final AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(mContext);        </span>
<span class="7884761264945585321" onmouseenter="enter('7884761264945585321');" onmouseout="out('7884761264945585321');" style=""> 849                 ComponentName cn = ComponentName.unflattenFromString(                                    </span>
<span class="2179911768770688102" onmouseenter="enter('2179911768770688102');" onmouseout="out('2179911768770688102');" style=""> 850                         values.getAsString(Favorites.APPWIDGET_PROVIDER));                               </span>
<span  style=""> 851                                                                                                          </span>
<span class="3459055710499452007" onmouseenter="enter('3459055710499452007');" onmouseout="out('3459055710499452007');" style=""> 852                 if (cn != null) {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 853                     try {                                                                                </span>
<span class="7176738113779216844" onmouseenter="enter('7176738113779216844');" onmouseout="out('7176738113779216844');" style=""> 854                         int appWidgetId = mAppWidgetHost.allocateAppWidgetId();                          </span>
<span class="3122228588084428979" onmouseenter="enter('3122228588084428979');" onmouseout="out('3122228588084428979');" style=""> 855                         values.put(LauncherSettings.Favorites.APPWIDGET_ID, appWidgetId);                </span>
<span class="2309614617117273311" onmouseenter="enter('2309614617117273311');" onmouseout="out('2309614617117273311');" style=""> 856                         if (!appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn)) {                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 857                             return false;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 858                         }                                                                                </span>
<span class="1200625667814236005" onmouseenter="enter('1200625667814236005');" onmouseout="out('1200625667814236005');" style=""> 859                     } catch (RuntimeException e) {                                                       </span>
<span class="9049318523495391496" onmouseenter="enter('9049318523495391496');" onmouseout="out('9049318523495391496');" style=""> 860                         Log.e(TAG, &quot;Failed to initialize external widget&quot;, e);                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 861                         return false;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 862                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 863                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 864                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 865                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 866             }                                                                                            </span>
<span  style=""> 867                                                                                                          </span>
<span class="-5393917371757635815" onmouseenter="enter('-5393917371757635815');" onmouseout="out('-5393917371757635815');" style=""> 868             // Add screen id if not present                                                              </span>
<span class="-8492193036384627967" onmouseenter="enter('-8492193036384627967');" onmouseout="out('-8492193036384627967');" style=""> 869             long screenId = values.getAsLong(LauncherSettings.Favorites.SCREEN);                         </span>
<span class="-8472780943665027311" onmouseenter="enter('-8472780943665027311');" onmouseout="out('-8472780943665027311');" style=""> 870             if (!addScreenIdIfNecessary(screenId)) {                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 871                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 872             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 873             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 874         }                                                                                                </span>
<span  style=""> 875                                                                                                          </span>
<span class="7352835902307890843" onmouseenter="enter('7352835902307890843');" onmouseout="out('7352835902307890843');" style=""> 876         // Returns true of screen id exists, or if successfully added                                    </span>
<span class="-4057720447241324922" onmouseenter="enter('-4057720447241324922');" onmouseout="out('-4057720447241324922');" style=""> 877         private boolean addScreenIdIfNecessary(long screenId) {                                          </span>
<span class="-8332527954530563349" onmouseenter="enter('-8332527954530563349');" onmouseout="out('-8332527954530563349');" style=""> 878             if (!hasScreenId(screenId)) {                                                                </span>
<span class="-3380006025674561043" onmouseenter="enter('-3380006025674561043');" onmouseout="out('-3380006025674561043');" style=""> 879                 int rank = getMaxScreenRank() + 1;                                                       </span>
<span  style=""> 880                                                                                                          </span>
<span class="4061202061343128850" onmouseenter="enter('4061202061343128850');" onmouseout="out('4061202061343128850');" style=""> 881                 ContentValues v = new ContentValues();                                                   </span>
<span class="-5112420615000020353" onmouseenter="enter('-5112420615000020353');" onmouseout="out('-5112420615000020353');" style=""> 882                 v.put(LauncherSettings.WorkspaceScreens._ID, screenId);                                  </span>
<span class="6806563186306365402" onmouseenter="enter('6806563186306365402');" onmouseout="out('6806563186306365402');" style=""> 883                 v.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                              </span>
<span class="-1115795847996433461" onmouseenter="enter('-1115795847996433461');" onmouseout="out('-1115795847996433461');" style=""> 884                 if (dbInsertAndCheck(this, getWritableDatabase(),                                        </span>
<span class="3238415722136121635" onmouseenter="enter('3238415722136121635');" onmouseout="out('3238415722136121635');" style=""> 885                         TABLE_WORKSPACE_SCREENS, null, v) &lt; 0) {                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 886                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 887                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 888             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 889             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 890         }                                                                                                </span>
<span  style=""> 891                                                                                                          </span>
<span class="5478264759768975399" onmouseenter="enter('5478264759768975399');" onmouseout="out('5478264759768975399');" style=""> 892         private boolean hasScreenId(long screenId) {                                                     </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 893             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="7657123469267572077" onmouseenter="enter('7657123469267572077');" onmouseout="out('7657123469267572077');" style=""> 894             Cursor c = db.rawQuery(&quot;SELECT * FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot; WHERE &quot;                </span>
<span class="1858055579641267103" onmouseenter="enter('1858055579641267103');" onmouseout="out('1858055579641267103');" style=""> 895                     + LauncherSettings.WorkspaceScreens._ID + &quot; = &quot; + screenId, null);                   </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 896             if (c != null) {                                                                             </span>
<span class="-7874906179005583875" onmouseenter="enter('-7874906179005583875');" onmouseout="out('-7874906179005583875');" style=""> 897                 int count = c.getCount();                                                                </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 898                 c.close();                                                                               </span>
<span class="4255567607434315929" onmouseenter="enter('4255567607434315929');" onmouseout="out('4255567607434315929');" style=""> 899                 return count &gt; 0;                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 900             } else {                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 901                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 902             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 903         }                                                                                                </span>
<span  style=""> 904                                                                                                          </span>
<span class="-2708828914383579811" onmouseenter="enter('-2708828914383579811');" onmouseout="out('-2708828914383579811');" style=""> 905         private int getMaxScreenRank() {                                                                 </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 906             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="4567502420956726358" onmouseenter="enter('4567502420956726358');" onmouseout="out('4567502420956726358');" style=""> 907             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens.SCREEN_RANK         </span>
<span class="-851271521804486447" onmouseenter="enter('-851271521804486447');" onmouseout="out('-851271521804486447');" style=""> 908                     + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);                                        </span>
<span  style=""> 909                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 910             // get the result                                                                            </span>
<span class="-7089673966704675292" onmouseenter="enter('-7089673966704675292');" onmouseout="out('-7089673966704675292');" style=""> 911             final int maxRankIndex = 0;                                                                  </span>
<span class="8995972804405745177" onmouseenter="enter('8995972804405745177');" onmouseout="out('8995972804405745177');" style=""> 912             int rank = -1;                                                                               </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 913             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="-130706833968251970" onmouseenter="enter('-130706833968251970');" onmouseout="out('-130706833968251970');" style=""> 914                 rank = c.getInt(maxRankIndex);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 915             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 916             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 917                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 918             }                                                                                            </span>
<span  style=""> 919                                                                                                          </span>
<span class="-5061660947414305561" onmouseenter="enter('-5061660947414305561');" onmouseout="out('-5061660947414305561');" style=""> 920             return rank;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921         }                                                                                                </span>
<span  style=""> 922                                                                                                          </span>
<span class="7076012940679285170" onmouseenter="enter('7076012940679285170');" onmouseout="out('7076012940679285170');" style=""> 923         private int loadFavorites(SQLiteDatabase db, AutoInstallsLayout loader) {                        </span>
<span class="-517932292017625058" onmouseenter="enter('-517932292017625058');" onmouseout="out('-517932292017625058');" style=""> 924             ArrayList&lt;Long&gt; screenIds = new ArrayList&lt;Long&gt;();                                           </span>
<span class="-1992683231790282850" onmouseenter="enter('-1992683231790282850');" onmouseout="out('-1992683231790282850');" style=""> 925             // TODO: Use multiple loaders with fall-back and transaction.                                </span>
<span class="-198133332043015666" onmouseenter="enter('-198133332043015666');" onmouseout="out('-198133332043015666');" style=""> 926             int count = loader.loadLayout(db, screenIds);                                                </span>
<span  style=""> 927                                                                                                          </span>
<span class="6833875387324148439" onmouseenter="enter('6833875387324148439');" onmouseout="out('6833875387324148439');" style=""> 928             // Add the screens specified by the items above                                              </span>
<span class="2978539432730983390" onmouseenter="enter('2978539432730983390');" onmouseout="out('2978539432730983390');" style=""> 929             Collections.sort(screenIds);                                                                 </span>
<span class="5419352211080831355" onmouseenter="enter('5419352211080831355');" onmouseout="out('5419352211080831355');" style=""> 930             int rank = 0;                                                                                </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 931             ContentValues values = new ContentValues();                                                  </span>
<span class="7152107230041712979" onmouseenter="enter('7152107230041712979');" onmouseout="out('7152107230041712979');" style=""> 932             for (Long id : screenIds) {                                                                  </span>
<span class="6295623415315599771" onmouseenter="enter('6295623415315599771');" onmouseout="out('6295623415315599771');" style=""> 933                 values.clear();                                                                          </span>
<span class="-3523466272369778299" onmouseenter="enter('-3523466272369778299');" onmouseout="out('-3523466272369778299');" style=""> 934                 values.put(LauncherSettings.WorkspaceScreens._ID, id);                                   </span>
<span class="-4819700644573994153" onmouseenter="enter('-4819700644573994153');" onmouseout="out('-4819700644573994153');" style=""> 935                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                         </span>
<span class="-7619796578683976012" onmouseenter="enter('-7619796578683976012');" onmouseout="out('-7619796578683976012');" style=""> 936                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values) &lt; 0) {             </span>
<span class="-4349241721568097596" onmouseenter="enter('-4349241721568097596');" onmouseout="out('-4349241721568097596');" style=""> 937                     throw new RuntimeException(&quot;Failed initialize screen table&quot;                          </span>
<span class="6358788983404305676" onmouseenter="enter('6358788983404305676');" onmouseout="out('6358788983404305676');" style=""> 938                             + &quot;from default layout&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939                 }                                                                                        </span>
<span class="-39828730810908930" onmouseenter="enter('-39828730810908930');" onmouseout="out('-39828730810908930');" style=""> 940                 rank++;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 941             }                                                                                            </span>
<span  style=""> 942                                                                                                          </span>
<span class="-1496945990523812752" onmouseenter="enter('-1496945990523812752');" onmouseout="out('-1496945990523812752');" style=""> 943             // Ensure that the max ids are initialized                                                   </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 944             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style=""> 945             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span  style=""> 946                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 947             return count;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 948         }                                                                                                </span>
<span  style=""> 949                                                                                                          </span>
<span class="725730754436415996" onmouseenter="enter('725730754436415996');" onmouseout="out('725730754436415996');" style=""> 950         private void migrateLauncher2Shortcuts(SQLiteDatabase db, Uri uri) {                             </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 951             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="-3774076673393313717" onmouseenter="enter('-3774076673393313717');" onmouseout="out('-3774076673393313717');" style=""> 952             Cursor c = null;                                                                             </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 953             int count = 0;                                                                               </span>
<span class="-3336839334240068207" onmouseenter="enter('-3336839334240068207');" onmouseout="out('-3336839334240068207');" style=""> 954             int curScreen = 0;                                                                           </span>
<span  style=""> 955                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 956             try {                                                                                        </span>
<span class="-9000085593458662527" onmouseenter="enter('-9000085593458662527');" onmouseout="out('-9000085593458662527');" style=""> 957                 c = resolver.query(uri, null, null, null, &quot;title ASC&quot;);                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 958             } catch (Exception e) {                                                                      </span>
<span class="-1642344425252950446" onmouseenter="enter('-1642344425252950446');" onmouseout="out('-1642344425252950446');" style=""> 959                 // Ignore                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 960             }                                                                                            </span>
<span  style=""> 961                                                                                                          </span>
<span class="-8364191572061005786" onmouseenter="enter('-8364191572061005786');" onmouseout="out('-8364191572061005786');" style=""> 962             // We already have a favorites database in the old provider                                  </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 963             if (c != null) {                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 964                 try {                                                                                    </span>
<span class="-7145577210477193493" onmouseenter="enter('-7145577210477193493');" onmouseout="out('-7145577210477193493');" style=""> 965                     if (c.getCount() &gt; 0) {                                                              </span>
<span class="574469590853725413" onmouseenter="enter('574469590853725413');" onmouseout="out('574469590853725413');" style=""> 966                         final int idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);     </span>
<span class="-3305857310034960574" onmouseenter="enter('-3305857310034960574');" onmouseout="out('-3305857310034960574');" style=""> 967                         final int intentIndex                                                            </span>
<span class="7354730669796853916" onmouseenter="enter('7354730669796853916');" onmouseout="out('7354730669796853916');" style=""> 968                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);            </span>
<span class="-5630883347545993547" onmouseenter="enter('-5630883347545993547');" onmouseout="out('-5630883347545993547');" style=""> 969                         final int titleIndex                                                             </span>
<span class="698330273931132471" onmouseenter="enter('698330273931132471');" onmouseout="out('698330273931132471');" style=""> 970                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);             </span>
<span class="-3330891132272232037" onmouseenter="enter('-3330891132272232037');" onmouseout="out('-3330891132272232037');" style=""> 971                         final int iconTypeIndex                                                          </span>
<span class="7801651150775381680" onmouseenter="enter('7801651150775381680');" onmouseout="out('7801651150775381680');" style=""> 972                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);         </span>
<span class="-1496515754016715409" onmouseenter="enter('-1496515754016715409');" onmouseout="out('-1496515754016715409');" style=""> 973                         final int iconIndex                                                              </span>
<span class="-6743710571640483882" onmouseenter="enter('-6743710571640483882');" onmouseout="out('-6743710571640483882');" style=""> 974                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);              </span>
<span class="-4968513115427762421" onmouseenter="enter('-4968513115427762421');" onmouseout="out('-4968513115427762421');" style=""> 975                         final int iconPackageIndex                                                       </span>
<span class="6406994869194943351" onmouseenter="enter('6406994869194943351');" onmouseout="out('6406994869194943351');" style=""> 976                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);      </span>
<span class="7917018656335895183" onmouseenter="enter('7917018656335895183');" onmouseout="out('7917018656335895183');" style=""> 977                         final int iconResourceIndex                                                      </span>
<span class="2805080254532821790" onmouseenter="enter('2805080254532821790');" onmouseout="out('2805080254532821790');" style=""> 978                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);     </span>
<span class="-4237567403763432926" onmouseenter="enter('-4237567403763432926');" onmouseout="out('-4237567403763432926');" style=""> 979                         final int containerIndex                                                         </span>
<span class="-5056484222025497452" onmouseenter="enter('-5056484222025497452');" onmouseout="out('-5056484222025497452');" style=""> 980                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);         </span>
<span class="-1231922168250187193" onmouseenter="enter('-1231922168250187193');" onmouseout="out('-1231922168250187193');" style=""> 981                         final int itemTypeIndex                                                          </span>
<span class="4225538929397018586" onmouseenter="enter('4225538929397018586');" onmouseout="out('4225538929397018586');" style=""> 982                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);         </span>
<span class="1886064968207935621" onmouseenter="enter('1886064968207935621');" onmouseout="out('1886064968207935621');" style=""> 983                         final int screenIndex                                                            </span>
<span class="5823358741192050359" onmouseenter="enter('5823358741192050359');" onmouseout="out('5823358741192050359');" style=""> 984                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);            </span>
<span class="148786652433469700" onmouseenter="enter('148786652433469700');" onmouseout="out('148786652433469700');" style=""> 985                         final int cellXIndex                                                             </span>
<span class="-2420213882448561608" onmouseenter="enter('-2420213882448561608');" onmouseout="out('-2420213882448561608');" style=""> 986                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);             </span>
<span class="7105291823960507491" onmouseenter="enter('7105291823960507491');" onmouseout="out('7105291823960507491');" style=""> 987                         final int cellYIndex                                                             </span>
<span class="570222995967736070" onmouseenter="enter('570222995967736070');" onmouseout="out('570222995967736070');" style=""> 988                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);             </span>
<span class="-6657516663903609513" onmouseenter="enter('-6657516663903609513');" onmouseout="out('-6657516663903609513');" style=""> 989                         final int uriIndex                                                               </span>
<span class="-7627325667289175305" onmouseenter="enter('-7627325667289175305');" onmouseout="out('-7627325667289175305');" style=""> 990                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);               </span>
<span class="3126191733073545935" onmouseenter="enter('3126191733073545935');" onmouseout="out('3126191733073545935');" style=""> 991                         final int displayModeIndex                                                       </span>
<span class="5824024113471232605" onmouseenter="enter('5824024113471232605');" onmouseout="out('5824024113471232605');" style=""> 992                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);      </span>
<span class="6969636044710489163" onmouseenter="enter('6969636044710489163');" onmouseout="out('6969636044710489163');" style=""> 993                         final int profileIndex                                                           </span>
<span class="-4394079448083019726" onmouseenter="enter('-4394079448083019726');" onmouseout="out('-4394079448083019726');" style=""> 994                                 = c.getColumnIndex(LauncherSettings.Favorites.PROFILE_ID);               </span>
<span  style=""> 995                                                                                                          </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style=""> 996                         int i = 0;                                                                       </span>
<span class="3196084964022358374" onmouseenter="enter('3196084964022358374');" onmouseout="out('3196084964022358374');" style=""> 997                         int curX = 0;                                                                    </span>
<span class="-8919994129307273415" onmouseenter="enter('-8919994129307273415');" onmouseout="out('-8919994129307273415');" style=""> 998                         int curY = 0;                                                                    </span>
<span  style=""> 999                                                                                                          </span>
<span class="1185328747399966274" onmouseenter="enter('1185328747399966274');" onmouseout="out('1185328747399966274');" style="">1000                         final LauncherAppState app = LauncherAppState.getInstance();                     </span>
<span class="7124839587395892858" onmouseenter="enter('7124839587395892858');" onmouseout="out('7124839587395892858');" style="">1001                         final DeviceProfile grid = app.getDynamicGrid().getDeviceProfile();              </span>
<span class="690371396691664791" onmouseenter="enter('690371396691664791');" onmouseout="out('690371396691664791');" style="">1002                         final int width = (int) grid.numColumns;                                         </span>
<span class="-5064901428253886355" onmouseenter="enter('-5064901428253886355');" onmouseout="out('-5064901428253886355');" style="">1003                         final int height = (int) grid.numRows;                                           </span>
<span class="-4109722385928167056" onmouseenter="enter('-4109722385928167056');" onmouseout="out('-4109722385928167056');" style="">1004                         final int hotseatWidth = (int) grid.numHotseatIcons;                             </span>
<span  style="">1005                                                                                                          </span>
<span class="-4392487977825691924" onmouseenter="enter('-4392487977825691924');" onmouseout="out('-4392487977825691924');" style="">1006                         final HashSet&lt;String&gt; seenIntents = new HashSet&lt;String&gt;(c.getCount());           </span>
<span  style="">1007                                                                                                          </span>
<span class="-1775881703038933069" onmouseenter="enter('-1775881703038933069');" onmouseout="out('-1775881703038933069');" style="">1008                         final ArrayList&lt;ContentValues&gt; shortcuts = new ArrayList&lt;ContentValues&gt;();       </span>
<span class="-5282219486258454454" onmouseenter="enter('-5282219486258454454');" onmouseout="out('-5282219486258454454');" style="">1009                         final ArrayList&lt;ContentValues&gt; folders = new ArrayList&lt;ContentValues&gt;();         </span>
<span class="7748304206224281059" onmouseenter="enter('7748304206224281059');" onmouseout="out('7748304206224281059');" style="">1010                         final SparseArray&lt;ContentValues&gt; hotseat = new SparseArray&lt;ContentValues&gt;();     </span>
<span  style="">1011                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style="">1012                         while (c.moveToNext()) {                                                         </span>
<span class="-2982692859195643614" onmouseenter="enter('-2982692859195643614');" onmouseout="out('-2982692859195643614');" style="">1013                             final int itemType = c.getInt(itemTypeIndex);                                </span>
<span class="-7155300134759553393" onmouseenter="enter('-7155300134759553393');" onmouseout="out('-7155300134759553393');" style="">1014                             if (itemType != Favorites.ITEM_TYPE_APPLICATION                              </span>
<span class="-6505147694408678007" onmouseenter="enter('-6505147694408678007');" onmouseout="out('-6505147694408678007');" style="">1015                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_SHORTCUT                          </span>
<span class="-1211279440538129484" onmouseenter="enter('-1211279440538129484');" onmouseout="out('-1211279440538129484');" style="">1016                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_FOLDER) {                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1017                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1018                             }                                                                            </span>
<span  style="">1019                                                                                                          </span>
<span class="6546086433507254477" onmouseenter="enter('6546086433507254477');" onmouseout="out('6546086433507254477');" style="">1020                             final int cellX = c.getInt(cellXIndex);                                      </span>
<span class="-5848765603231722693" onmouseenter="enter('-5848765603231722693');" onmouseout="out('-5848765603231722693');" style="">1021                             final int cellY = c.getInt(cellYIndex);                                      </span>
<span class="5057139106655212954" onmouseenter="enter('5057139106655212954');" onmouseout="out('5057139106655212954');" style="">1022                             final int screen = c.getInt(screenIndex);                                    </span>
<span class="-6682259384170717005" onmouseenter="enter('-6682259384170717005');" onmouseout="out('-6682259384170717005');" style="">1023                             int container = c.getInt(containerIndex);                                    </span>
<span class="-3517014905521526588" onmouseenter="enter('-3517014905521526588');" onmouseout="out('-3517014905521526588');" style="">1024                             final String intentStr = c.getString(intentIndex);                           </span>
<span  style="">1025                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style="">1026                             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);     </span>
<span class="7210862209025052290" onmouseenter="enter('7210862209025052290');" onmouseout="out('7210862209025052290');" style="">1027                             UserHandleCompat userHandle;                                                 </span>
<span class="-704754462563124721" onmouseenter="enter('-704754462563124721');" onmouseout="out('-704754462563124721');" style="">1028                             final long userSerialNumber;                                                 </span>
<span class="-3188525411347809180" onmouseenter="enter('-3188525411347809180');" onmouseout="out('-3188525411347809180');" style="">1029                             if (profileIndex != -1 &amp;&amp; !c.isNull(profileIndex)) {                         </span>
<span class="3377600326593357797" onmouseenter="enter('3377600326593357797');" onmouseout="out('3377600326593357797');" style="">1030                                 userSerialNumber = c.getInt(profileIndex);                               </span>
<span class="-5580723935665666817" onmouseenter="enter('-5580723935665666817');" onmouseout="out('-5580723935665666817');" style="">1031                                 userHandle = userManager.getUserForSerialNumber(userSerialNumber);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1032                             } else {                                                                     </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style="">1033                                 // Default to the serial number of this user, for older                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style="">1034                                 // shortcuts.                                                            </span>
<span class="153827185233038497" onmouseenter="enter('153827185233038497');" onmouseout="out('153827185233038497');" style="">1035                                 userHandle = UserHandleCompat.myUserHandle();                            </span>
<span class="-7992210937529459410" onmouseenter="enter('-7992210937529459410');" onmouseout="out('-7992210937529459410');" style="">1036                                 userSerialNumber = userManager.getSerialNumberForUser(userHandle);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1037                             }                                                                            </span>
<span  style="">1038                                                                                                          </span>
<span class="-5734975396466070409" onmouseenter="enter('-5734975396466070409');" onmouseout="out('-5734975396466070409');" style="">1039                             if (userHandle == null) {                                                    </span>
<span class="8825647937501871391" onmouseenter="enter('8825647937501871391');" onmouseout="out('8825647937501871391');" style="">1040                                 Launcher.addDumpLog(TAG, &quot;skipping deleted user&quot;, true);                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1041                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1042                             }                                                                            </span>
<span  style="">1043                                                                                                          </span>
<span class="-8522267007848438017" onmouseenter="enter('-8522267007848438017');" onmouseout="out('-8522267007848438017');" style="">1044                             Launcher.addDumpLog(TAG, &quot;migrating \&quot;&quot;                                      </span>
<span class="5716371482803525639" onmouseenter="enter('5716371482803525639');" onmouseout="out('5716371482803525639');" style="">1045                                 + c.getString(titleIndex) + &quot;\&quot; (&quot;                                       </span>
<span class="1581718899431916610" onmouseenter="enter('1581718899431916610');" onmouseout="out('1581718899431916610');" style="">1046                                 + cellX + &quot;,&quot; + cellY + &quot;@&quot;                                              </span>
<span class="-5433460809722614707" onmouseenter="enter('-5433460809722614707');" onmouseout="out('-5433460809722614707');" style="">1047                                 + LauncherSettings.Favorites.containerToString(container)                </span>
<span class="7963207375316982791" onmouseenter="enter('7963207375316982791');" onmouseout="out('7963207375316982791');" style="">1048                                 + &quot;/&quot; + screen                                                           </span>
<span class="6018191721230485089" onmouseenter="enter('6018191721230485089');" onmouseout="out('6018191721230485089');" style="">1049                                 + &quot;): &quot; + intentStr, true);                                              </span>
<span  style="">1050                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1051                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span  style="">1052                                                                                                          </span>
<span class="-3217378244605518341" onmouseenter="enter('-3217378244605518341');" onmouseout="out('-3217378244605518341');" style="">1053                                 final Intent intent;                                                     </span>
<span class="-6604091625193940309" onmouseenter="enter('-6604091625193940309');" onmouseout="out('-6604091625193940309');" style="">1054                                 final ComponentName cn;                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1055                                 try {                                                                    </span>
<span class="-5300012287142621419" onmouseenter="enter('-5300012287142621419');" onmouseout="out('-5300012287142621419');" style="">1056                                     intent = Intent.parseUri(intentStr, 0);                              </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style="">1057                                 } catch (URISyntaxException e) {                                         </span>
<span class="4944972948248133238" onmouseenter="enter('4944972948248133238');" onmouseout="out('4944972948248133238');" style="">1058                                     // bogus intent?                                                     </span>
<span class="8337166236749198483" onmouseenter="enter('8337166236749198483');" onmouseout="out('8337166236749198483');" style="">1059                                     Launcher.addDumpLog(TAG,                                             </span>
<span class="7306432149085172440" onmouseenter="enter('7306432149085172440');" onmouseout="out('7306432149085172440');" style="">1060                                             &quot;skipping invalid intent uri&quot;, true);                        </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1061                                     continue;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1062                                 }                                                                        </span>
<span  style="">1063                                                                                                          </span>
<span class="6421562153709548736" onmouseenter="enter('6421562153709548736');" onmouseout="out('6421562153709548736');" style="">1064                                 cn = intent.getComponent();                                              </span>
<span class="1165574592669081424" onmouseenter="enter('1165574592669081424');" onmouseout="out('1165574592669081424');" style="">1065                                 if (TextUtils.isEmpty(intentStr)) {                                      </span>
<span class="1109263052506568546" onmouseenter="enter('1109263052506568546');" onmouseout="out('1109263052506568546');" style="">1066                                     // no intent? no icon                                                </span>
<span class="-2999961336534157526" onmouseenter="enter('-2999961336534157526');" onmouseout="out('-2999961336534157526');" style="">1067                                     Launcher.addDumpLog(TAG, &quot;skipping empty intent&quot;, true);             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1068                                     continue;                                                            </span>
<span class="-9117039092771941538" onmouseenter="enter('-9117039092771941538');" onmouseout="out('-9117039092771941538');" style="">1069                                 } else if (cn != null &amp;&amp;                                                 </span>
<span class="-3538782463140269707" onmouseenter="enter('-3538782463140269707');" onmouseout="out('-3538782463140269707');" style="">1070                                         !LauncherModel.isValidPackageActivity(mContext, cn,              </span>
<span class="2012568974631198883" onmouseenter="enter('2012568974631198883');" onmouseout="out('2012568974631198883');" style="">1071                                                 userHandle)) {                                           </span>
<span class="-8462735888325815955" onmouseenter="enter('-8462735888325815955');" onmouseout="out('-8462735888325815955');" style="">1072                                     // component no longer exists.                                       </span>
<span class="8244127631099782564" onmouseenter="enter('8244127631099782564');" onmouseout="out('8244127631099782564');" style="">1073                                     Launcher.addDumpLog(TAG, &quot;skipping item whose component &quot; +          </span>
<span class="-2271033079359571531" onmouseenter="enter('-2271033079359571531');" onmouseout="out('-2271033079359571531');" style="">1074                                             &quot;no longer exists.&quot;, true);                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1075                                     continue;                                                            </span>
<span class="1808399553142797413" onmouseenter="enter('1808399553142797413');" onmouseout="out('1808399553142797413');" style="">1076                                 } else if (container ==                                                  </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1077                                         LauncherSettings.Favorites.CONTAINER_DESKTOP) {                  </span>
<span class="-6651088913311152009" onmouseenter="enter('-6651088913311152009');" onmouseout="out('-6651088913311152009');" style="">1078                                     // Dedupe icons directly on the workspace                            </span>
<span  style="">1079                                                                                                          </span>
<span class="-7857209544272892433" onmouseenter="enter('-7857209544272892433');" onmouseout="out('-7857209544272892433');" style="">1080                                     // Canonicalize                                                      </span>
<span class="-8986671765649789370" onmouseenter="enter('-8986671765649789370');" onmouseout="out('-8986671765649789370');" style="">1081                                     // the Play Store sets the package parameter, but Launcher           </span>
<span class="-2685712344279555181" onmouseenter="enter('-2685712344279555181');" onmouseout="out('-2685712344279555181');" style="">1082                                     // does not, so we clear that out to keep them the same.             </span>
<span class="-1462576698638737516" onmouseenter="enter('-1462576698638737516');" onmouseout="out('-1462576698638737516');" style="">1083                                     // Also ignore intent flags for the purposes of deduping.            </span>
<span class="-3363694106044374937" onmouseenter="enter('-3363694106044374937');" onmouseout="out('-3363694106044374937');" style="">1084                                     intent.setPackage(null);                                             </span>
<span class="-3409071973040894037" onmouseenter="enter('-3409071973040894037');" onmouseout="out('-3409071973040894037');" style="">1085                                     int flags = intent.getFlags();                                       </span>
<span class="547103070058811611" onmouseenter="enter('547103070058811611');" onmouseout="out('547103070058811611');" style="">1086                                     intent.setFlags(0);                                                  </span>
<span class="-947990318544641084" onmouseenter="enter('-947990318544641084');" onmouseout="out('-947990318544641084');" style="">1087                                     final String key = intent.toUri(0);                                  </span>
<span class="-7327331133269780521" onmouseenter="enter('-7327331133269780521');" onmouseout="out('-7327331133269780521');" style="">1088                                     intent.setFlags(flags);                                              </span>
<span class="7480204102005082432" onmouseenter="enter('7480204102005082432');" onmouseout="out('7480204102005082432');" style="">1089                                     if (seenIntents.contains(key)) {                                     </span>
<span class="2006049222885589498" onmouseenter="enter('2006049222885589498');" onmouseout="out('2006049222885589498');" style="">1090                                         Launcher.addDumpLog(TAG, &quot;skipping duplicate&quot;, true);            </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1091                                         continue;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1092                                     } else {                                                             </span>
<span class="4653019047206831387" onmouseenter="enter('4653019047206831387');" onmouseout="out('4653019047206831387');" style="">1093                                         seenIntents.add(key);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1094                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1095                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1096                             }                                                                            </span>
<span  style="">1097                                                                                                          </span>
<span class="-3805379390248188389" onmouseenter="enter('-3805379390248188389');" onmouseout="out('-3805379390248188389');" style="">1098                             ContentValues values = new ContentValues(c.getColumnCount());                </span>
<span class="2787548740347733717" onmouseenter="enter('2787548740347733717');" onmouseout="out('2787548740347733717');" style="">1099                             values.put(LauncherSettings.Favorites._ID, c.getInt(idIndex));               </span>
<span class="4552396250235420866" onmouseenter="enter('4552396250235420866');" onmouseout="out('4552396250235420866');" style="">1100                             values.put(LauncherSettings.Favorites.INTENT, intentStr);                    </span>
<span class="3080545696092648727" onmouseenter="enter('3080545696092648727');" onmouseout="out('3080545696092648727');" style="">1101                             values.put(LauncherSettings.Favorites.TITLE, c.getString(titleIndex));       </span>
<span class="8877369206974054200" onmouseenter="enter('8877369206974054200');" onmouseout="out('8877369206974054200');" style="">1102                             values.put(LauncherSettings.Favorites.ICON_TYPE,                             </span>
<span class="8705323818259019594" onmouseenter="enter('8705323818259019594');" onmouseout="out('8705323818259019594');" style="">1103                                     c.getInt(iconTypeIndex));                                            </span>
<span class="3857475807367449049" onmouseenter="enter('3857475807367449049');" onmouseout="out('3857475807367449049');" style="">1104                             values.put(LauncherSettings.Favorites.ICON, c.getBlob(iconIndex));           </span>
<span class="-7054095546130863513" onmouseenter="enter('-7054095546130863513');" onmouseout="out('-7054095546130863513');" style="">1105                             values.put(LauncherSettings.Favorites.ICON_PACKAGE,                          </span>
<span class="-4377124255190457588" onmouseenter="enter('-4377124255190457588');" onmouseout="out('-4377124255190457588');" style="">1106                                     c.getString(iconPackageIndex));                                      </span>
<span class="7491883888231273974" onmouseenter="enter('7491883888231273974');" onmouseout="out('7491883888231273974');" style="">1107                             values.put(LauncherSettings.Favorites.ICON_RESOURCE,                         </span>
<span class="-14487948683300389" onmouseenter="enter('-14487948683300389');" onmouseout="out('-14487948683300389');" style="">1108                                     c.getString(iconResourceIndex));                                     </span>
<span class="5180659022499168410" onmouseenter="enter('5180659022499168410');" onmouseout="out('5180659022499168410');" style="">1109                             values.put(LauncherSettings.Favorites.ITEM_TYPE, itemType);                  </span>
<span class="2567875359902744917" onmouseenter="enter('2567875359902744917');" onmouseout="out('2567875359902744917');" style="">1110                             values.put(LauncherSettings.Favorites.APPWIDGET_ID, -1);                     </span>
<span class="-3897523412202294315" onmouseenter="enter('-3897523412202294315');" onmouseout="out('-3897523412202294315');" style="">1111                             values.put(LauncherSettings.Favorites.URI, c.getString(uriIndex));           </span>
<span class="8253479465859182990" onmouseenter="enter('8253479465859182990');" onmouseout="out('8253479465859182990');" style="">1112                             values.put(LauncherSettings.Favorites.DISPLAY_MODE,                          </span>
<span class="-8416795076296111227" onmouseenter="enter('-8416795076296111227');" onmouseout="out('-8416795076296111227');" style="">1113                                     c.getInt(displayModeIndex));                                         </span>
<span class="-1880957120536425376" onmouseenter="enter('-1880957120536425376');" onmouseout="out('-1880957120536425376');" style="">1114                             values.put(LauncherSettings.Favorites.PROFILE_ID, userSerialNumber);         </span>
<span  style="">1115                                                                                                          </span>
<span class="-216205184326719357" onmouseenter="enter('-216205184326719357');" onmouseout="out('-216205184326719357');" style="">1116                             if (container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {             </span>
<span class="2845166931909672251" onmouseenter="enter('2845166931909672251');" onmouseout="out('2845166931909672251');" style="">1117                                 hotseat.put(screen, values);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1118                             }                                                                            </span>
<span  style="">1119                                                                                                          </span>
<span class="-8534427976726701331" onmouseenter="enter('-8534427976726701331');" onmouseout="out('-8534427976726701331');" style="">1120                             if (container != LauncherSettings.Favorites.CONTAINER_DESKTOP) {             </span>
<span class="3724214252155726452" onmouseenter="enter('3724214252155726452');" onmouseout="out('3724214252155726452');" style="">1121                                 // In a folder or in the hotseat, preserve position                      </span>
<span class="4993135311254983149" onmouseenter="enter('4993135311254983149');" onmouseout="out('4993135311254983149');" style="">1122                                 values.put(LauncherSettings.Favorites.SCREEN, screen);                   </span>
<span class="-7735658353589578952" onmouseenter="enter('-7735658353589578952');" onmouseout="out('-7735658353589578952');" style="">1123                                 values.put(LauncherSettings.Favorites.CELLX, cellX);                     </span>
<span class="-6596875348392322090" onmouseenter="enter('-6596875348392322090');" onmouseout="out('-6596875348392322090');" style="">1124                                 values.put(LauncherSettings.Favorites.CELLY, cellY);                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1125                             } else {                                                                     </span>
<span class="-6079732280628496127" onmouseenter="enter('-6079732280628496127');" onmouseout="out('-6079732280628496127');" style="">1126                                 // For items contained directly on one of the workspace screen,          </span>
<span class="-850513443108501253" onmouseenter="enter('-850513443108501253');" onmouseout="out('-850513443108501253');" style="">1127                                 // we&#x27;ll determine their location (screen, x, y) in a second pass.       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1128                             }                                                                            </span>
<span  style="">1129                                                                                                          </span>
<span class="7684212050113439789" onmouseenter="enter('7684212050113439789');" onmouseout="out('7684212050113439789');" style="">1130                             values.put(LauncherSettings.Favorites.CONTAINER, container);                 </span>
<span  style="">1131                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1132                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span class="-7897547558000712151" onmouseenter="enter('-7897547558000712151');" onmouseout="out('-7897547558000712151');" style="">1133                                 shortcuts.add(values);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1134                             } else {                                                                     </span>
<span class="5214044302935278086" onmouseenter="enter('5214044302935278086');" onmouseout="out('5214044302935278086');" style="">1135                                 folders.add(values);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1136                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1137                         }                                                                                </span>
<span  style="">1138                                                                                                          </span>
<span class="3792333482677793462" onmouseenter="enter('3792333482677793462');" onmouseout="out('3792333482677793462');" style="">1139                         // Now that we have all the hotseat icons, let&#x27;s go through them left-right      </span>
<span class="6853065735140319510" onmouseenter="enter('6853065735140319510');" onmouseout="out('6853065735140319510');" style="">1140                         // and assign valid locations for them in the new hotseat                        </span>
<span class="-382900916992065291" onmouseenter="enter('-382900916992065291');" onmouseout="out('-382900916992065291');" style="">1141                         final int N = hotseat.size();                                                    </span>
<span class="9016073461123662191" onmouseenter="enter('9016073461123662191');" onmouseout="out('9016073461123662191');" style="">1142                         for (int idx=0; idx&lt;N; idx++) {                                                  </span>
<span class="-7027280347801461154" onmouseenter="enter('-7027280347801461154');" onmouseout="out('-7027280347801461154');" style="">1143                             int hotseatX = hotseat.keyAt(idx);                                           </span>
<span class="7267222979225491944" onmouseenter="enter('7267222979225491944');" onmouseout="out('7267222979225491944');" style="">1144                             ContentValues values = hotseat.valueAt(idx);                                 </span>
<span  style="">1145                                                                                                          </span>
<span class="-3018245694205955067" onmouseenter="enter('-3018245694205955067');" onmouseout="out('-3018245694205955067');" style="">1146                             if (hotseatX == grid.hotseatAllAppsRank) {                                   </span>
<span class="-8495735509078642350" onmouseenter="enter('-8495735509078642350');" onmouseout="out('-8495735509078642350');" style="">1147                                 // let&#x27;s drop this in the next available hole in the hotseat             </span>
<span class="-2055954181227443816" onmouseenter="enter('-2055954181227443816');" onmouseout="out('-2055954181227443816');" style="">1148                                 while (++hotseatX &lt; hotseatWidth) {                                      </span>
<span class="-5595819560409222327" onmouseenter="enter('-5595819560409222327');" onmouseout="out('-5595819560409222327');" style="">1149                                     if (hotseat.get(hotseatX) == null) {                                 </span>
<span class="2131484666649578366" onmouseenter="enter('2131484666649578366');" onmouseout="out('2131484666649578366');" style="">1150                                         // found a spot! move it here                                    </span>
<span class="325808457439646533" onmouseenter="enter('325808457439646533');" onmouseout="out('325808457439646533');" style="">1151                                         values.put(LauncherSettings.Favorites.SCREEN,                    </span>
<span class="8014085861051867033" onmouseenter="enter('8014085861051867033');" onmouseout="out('8014085861051867033');" style="">1152                                                 hotseatX);                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1153                                         break;                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1154                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1155                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1156                             }                                                                            </span>
<span class="4361559665402156368" onmouseenter="enter('4361559665402156368');" onmouseout="out('4361559665402156368');" style="">1157                             if (hotseatX &gt;= hotseatWidth) {                                              </span>
<span class="198406244599777154" onmouseenter="enter('198406244599777154');" onmouseout="out('198406244599777154');" style="">1158                                 // no room for you in the hotseat? it&#x27;s off to the desktop with you      </span>
<span class="274548545061036766" onmouseenter="enter('274548545061036766');" onmouseout="out('274548545061036766');" style="">1159                                 values.put(LauncherSettings.Favorites.CONTAINER,                         </span>
<span class="951133373394890183" onmouseenter="enter('951133373394890183');" onmouseout="out('951133373394890183');" style="">1160                                            Favorites.CONTAINER_DESKTOP);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1161                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1162                         }                                                                                </span>
<span  style="">1163                                                                                                          </span>
<span class="4538029778921500049" onmouseenter="enter('4538029778921500049');" onmouseout="out('4538029778921500049');" style="">1164                         final ArrayList&lt;ContentValues&gt; allItems = new ArrayList&lt;ContentValues&gt;();        </span>
<span class="-4972040190483698817" onmouseenter="enter('-4972040190483698817');" onmouseout="out('-4972040190483698817');" style="">1165                         // Folders first                                                                 </span>
<span class="1607706518732535744" onmouseenter="enter('1607706518732535744');" onmouseout="out('1607706518732535744');" style="">1166                         allItems.addAll(folders);                                                        </span>
<span class="2106236708914116763" onmouseenter="enter('2106236708914116763');" onmouseout="out('2106236708914116763');" style="">1167                         // Then shortcuts                                                                </span>
<span class="-1250372864837547145" onmouseenter="enter('-1250372864837547145');" onmouseout="out('-1250372864837547145');" style="">1168                         allItems.addAll(shortcuts);                                                      </span>
<span  style="">1169                                                                                                          </span>
<span class="-2195882050879177813" onmouseenter="enter('-2195882050879177813');" onmouseout="out('-2195882050879177813');" style="">1170                         // Layout all the folders                                                        </span>
<span class="-252665973237041297" onmouseenter="enter('-252665973237041297');" onmouseout="out('-252665973237041297');" style="">1171                         for (ContentValues values: allItems) {                                           </span>
<span class="-6238460523304059987" onmouseenter="enter('-6238460523304059987');" onmouseout="out('-6238460523304059987');" style="">1172                             if (values.getAsInteger(LauncherSettings.Favorites.CONTAINER) !=             </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1173                                     LauncherSettings.Favorites.CONTAINER_DESKTOP) {                      </span>
<span class="4544740026899945117" onmouseenter="enter('4544740026899945117');" onmouseout="out('4544740026899945117');" style="">1174                                 // Hotseat items and folder items have already had their                 </span>
<span class="9061827072000509027" onmouseenter="enter('9061827072000509027');" onmouseout="out('9061827072000509027');" style="">1175                                 // location information set. Nothing to be done here.                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1176                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1177                             }                                                                            </span>
<span class="851641135220662264" onmouseenter="enter('851641135220662264');" onmouseout="out('851641135220662264');" style="">1178                             values.put(LauncherSettings.Favorites.SCREEN, curScreen);                    </span>
<span class="-1049962748703223150" onmouseenter="enter('-1049962748703223150');" onmouseout="out('-1049962748703223150');" style="">1179                             values.put(LauncherSettings.Favorites.CELLX, curX);                          </span>
<span class="-5258025824110848668" onmouseenter="enter('-5258025824110848668');" onmouseout="out('-5258025824110848668');" style="">1180                             values.put(LauncherSettings.Favorites.CELLY, curY);                          </span>
<span class="1910082031532915038" onmouseenter="enter('1910082031532915038');" onmouseout="out('1910082031532915038');" style="">1181                             curX = (curX + 1) % width;                                                   </span>
<span class="-7155276018455302787" onmouseenter="enter('-7155276018455302787');" onmouseout="out('-7155276018455302787');" style="">1182                             if (curX == 0) {                                                             </span>
<span class="2376495568180329749" onmouseenter="enter('2376495568180329749');" onmouseout="out('2376495568180329749');" style="">1183                                 curY = (curY + 1);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1184                             }                                                                            </span>
<span class="-4531638622721531414" onmouseenter="enter('-4531638622721531414');" onmouseout="out('-4531638622721531414');" style="">1185                             // Leave the last row of icons blank on every screen                         </span>
<span class="-5543182397018270277" onmouseenter="enter('-5543182397018270277');" onmouseout="out('-5543182397018270277');" style="">1186                             if (curY == height - 1) {                                                    </span>
<span class="-6657705079427553715" onmouseenter="enter('-6657705079427553715');" onmouseout="out('-6657705079427553715');" style="">1187                                 curScreen = (int) generateNewScreenId();                                 </span>
<span class="4679043716901678926" onmouseenter="enter('4679043716901678926');" onmouseout="out('4679043716901678926');" style="">1188                                 curY = 0;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1189                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1190                         }                                                                                </span>
<span  style="">1191                                                                                                          </span>
<span class="1853917526349173349" onmouseenter="enter('1853917526349173349');" onmouseout="out('1853917526349173349');" style="">1192                         if (allItems.size() &gt; 0) {                                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1193                             db.beginTransaction();                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1194                             try {                                                                        </span>
<span class="-7256059133012813079" onmouseenter="enter('-7256059133012813079');" onmouseout="out('-7256059133012813079');" style="">1195                                 for (ContentValues row: allItems) {                                      </span>
<span class="3155601228699925770" onmouseenter="enter('3155601228699925770');" onmouseout="out('3155601228699925770');" style="">1196                                     if (row == null) continue;                                           </span>
<span class="-304018147606180100" onmouseenter="enter('-304018147606180100');" onmouseout="out('-304018147606180100');" style="">1197                                     if (dbInsertAndCheck(this, db, TABLE_FAVORITES, null, row)           </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1198                                             &lt; 0) {                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1199                                         return;                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1200                                     } else {                                                             </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style="">1201                                         count++;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1202                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1203                                 }                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1204                                 db.setTransactionSuccessful();                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1205                             } finally {                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1206                                 db.endTransaction();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1207                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1208                         }                                                                                </span>
<span  style="">1209                                                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1210                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1211                         try {                                                                            </span>
<span class="-7150489321946493056" onmouseenter="enter('-7150489321946493056');" onmouseout="out('-7150489321946493056');" style="">1212                             for (i=0; i&lt;=curScreen; i++) {                                               </span>
<span class="7694375558102178162" onmouseenter="enter('7694375558102178162');" onmouseout="out('7694375558102178162');" style="">1213                                 final ContentValues values = new ContentValues();                        </span>
<span class="-5225632710651404139" onmouseenter="enter('-5225632710651404139');" onmouseout="out('-5225632710651404139');" style="">1214                                 values.put(LauncherSettings.WorkspaceScreens._ID, i);                    </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="">1215                                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);            </span>
<span class="-6007460446232002971" onmouseenter="enter('-6007460446232002971');" onmouseout="out('-6007460446232002971');" style="">1216                                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values)    </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1217                                         &lt; 0) {                                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1218                                     return;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1219                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1220                             }                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1221                             db.setTransactionSuccessful();                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1222                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1223                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1224                         }                                                                                </span>
<span  style="">1225                                                                                                          </span>
<span class="3757730671360045414" onmouseenter="enter('3757730671360045414');" onmouseout="out('3757730671360045414');" style="">1226                         updateFolderItemsRank(db, false);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1227                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1228                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1229                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1230                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1231             }                                                                                            </span>
<span  style="">1232                                                                                                          </span>
<span class="-6182516414964240870" onmouseenter="enter('-6182516414964240870');" onmouseout="out('-6182516414964240870');" style="">1233             Launcher.addDumpLog(TAG, &quot;migrated &quot; + count + &quot; icons from Launcher2 into &quot;                 </span>
<span class="3301967416992773508" onmouseenter="enter('3301967416992773508');" onmouseout="out('3301967416992773508');" style="">1234                     + (curScreen+1) + &quot; screens&quot;, true);                                                 </span>
<span  style="">1235                                                                                                          </span>
<span class="3355055744209094121" onmouseenter="enter('3355055744209094121');" onmouseout="out('3355055744209094121');" style="">1236             // ensure that new screens are created to hold these icons                                   </span>
<span class="4167333916835222093" onmouseenter="enter('4167333916835222093');" onmouseout="out('4167333916835222093');" style="">1237             setFlagJustLoadedOldDb();                                                                    </span>
<span  style="">1238                                                                                                          </span>
<span class="2071167438564206442" onmouseenter="enter('2071167438564206442');" onmouseout="out('2071167438564206442');" style="">1239             // Update max IDs; very important since we just grabbed IDs from another database            </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1240             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1241             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span class="-439077128883569126" onmouseenter="enter('-439077128883569126');" onmouseout="out('-439077128883569126');" style="">1242             if (LOGD) Log.d(TAG, &quot;mMaxItemId: &quot; + mMaxItemId + &quot; mMaxScreenId: &quot; + mMaxScreenId);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1243         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1244     }                                                                                                    </span>
<span  style="">1245                                                                                                          </span>
<span class="8465274381710394045" onmouseenter="enter('8465274381710394045');" onmouseout="out('8465274381710394045');" style="">1246     static class SqlArguments {                                                                          </span>
<span class="8122936482838815352" onmouseenter="enter('8122936482838815352');" onmouseout="out('8122936482838815352');" style="">1247         public final String table;                                                                       </span>
<span class="5442590397567481633" onmouseenter="enter('5442590397567481633');" onmouseout="out('5442590397567481633');" style="">1248         public final String where;                                                                       </span>
<span class="-2258632185412795279" onmouseenter="enter('-2258632185412795279');" onmouseout="out('-2258632185412795279');" style="">1249         public final String[] args;                                                                      </span>
<span  style="">1250                                                                                                          </span>
<span class="538735252304320137" onmouseenter="enter('538735252304320137');" onmouseout="out('538735252304320137');" style="">1251         SqlArguments(Uri url, String where, String[] args) {                                             </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1252             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1253                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="7181058370626512064" onmouseenter="enter('7181058370626512064');" onmouseout="out('7181058370626512064');" style="">1254                 this.where = where;                                                                      </span>
<span class="8688716567728705492" onmouseenter="enter('8688716567728705492');" onmouseout="out('8688716567728705492');" style="">1255                 this.args = args;                                                                        </span>
<span class="2325935358302734243" onmouseenter="enter('2325935358302734243');" onmouseout="out('2325935358302734243');" style="">1256             } else if (url.getPathSegments().size() != 2) {                                              </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1257                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="186586201607437821" onmouseenter="enter('186586201607437821');" onmouseout="out('186586201607437821');" style="">1258             } else if (!TextUtils.isEmpty(where)) {                                                      </span>
<span class="2785963644153593875" onmouseenter="enter('2785963644153593875');" onmouseout="out('2785963644153593875');" style="">1259                 throw new UnsupportedOperationException(&quot;WHERE clause not supported: &quot; + url);           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1260             } else {                                                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1261                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="-834356181554398700" onmouseenter="enter('-834356181554398700');" onmouseout="out('-834356181554398700');" style="">1262                 this.where = &quot;_id=&quot; + ContentUris.parseId(url);                                          </span>
<span class="-7173439380439508667" onmouseenter="enter('-7173439380439508667');" onmouseout="out('-7173439380439508667');" style="">1263                 this.args = null;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1264             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1265         }                                                                                                </span>
<span  style="">1266                                                                                                          </span>
<span class="5705249208777482684" onmouseenter="enter('5705249208777482684');" onmouseout="out('5705249208777482684');" style="">1267         SqlArguments(Uri url) {                                                                          </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1268             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-594585027826531892" onmouseenter="enter('-594585027826531892');" onmouseout="out('-594585027826531892');" style="">1269                 table = url.getPathSegments().get(0);                                                    </span>
<span class="3938761229458861077" onmouseenter="enter('3938761229458861077');" onmouseout="out('3938761229458861077');" style="">1270                 where = null;                                                                            </span>
<span class="8940401955607507518" onmouseenter="enter('8940401955607507518');" onmouseout="out('8940401955607507518');" style="">1271                 args = null;                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1272             } else {                                                                                     </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1273                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1274             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1275         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1276     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1277 }                                                                                                        </span>

































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="1710841298952644868" onmouseenter="enter('1710841298952644868');" onmouseout="out('1710841298952644868');" style="">   2  * Copyright (C) 2008 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">  16 package com.android.launcher3;                                                                           </span>
<span  style="">  17                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">  18 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="8802236814006375919" onmouseenter="enter('8802236814006375919');" onmouseout="out('8802236814006375919');" style="">  19 import android.appwidget.AppWidgetManager;                                                               </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">  20 import android.content.ComponentName;                                                                    </span>
<span class="550877806393279246" onmouseenter="enter('550877806393279246');" onmouseout="out('550877806393279246');" style="">  21 import android.content.ContentProvider;                                                                  </span>
<span class="3739800667450215943" onmouseenter="enter('3739800667450215943');" onmouseout="out('3739800667450215943');" style="">  22 import android.content.ContentProviderOperation;                                                         </span>
<span class="-6369732601490611729" onmouseenter="enter('-6369732601490611729');" onmouseout="out('-6369732601490611729');" style="">  23 import android.content.ContentProviderResult;                                                            </span>
<span class="6126857652515451632" onmouseenter="enter('6126857652515451632');" onmouseout="out('6126857652515451632');" style="">  24 import android.content.ContentResolver;                                                                  </span>
<span class="-9185307499822629" onmouseenter="enter('-9185307499822629');" onmouseout="out('-9185307499822629');" style="">  25 import android.content.ContentUris;                                                                      </span>
<span class="3127723864207259776" onmouseenter="enter('3127723864207259776');" onmouseout="out('3127723864207259776');" style="">  26 import android.content.ContentValues;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  27 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  28 import android.content.Intent;                                                                           </span>
<span class="-4160670168441716907" onmouseenter="enter('-4160670168441716907');" onmouseout="out('-4160670168441716907');" style="">  29 import android.content.OperationApplicationException;                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  30 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  31 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  32 import android.database.Cursor;                                                                          </span>
<span class="5870833163231201789" onmouseenter="enter('5870833163231201789');" onmouseout="out('5870833163231201789');" style="">  33 import android.database.SQLException;                                                                    </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  34 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="6401548559697116088" onmouseenter="enter('6401548559697116088');" onmouseout="out('6401548559697116088');" style="">  35 import android.database.sqlite.SQLiteOpenHelper;                                                         </span>
<span class="-1253510085600408435" onmouseenter="enter('-1253510085600408435');" onmouseout="out('-1253510085600408435');" style="">  36 import android.database.sqlite.SQLiteQueryBuilder;                                                       </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  37 import android.net.Uri;                                                                                  </span>
<span class="5635872676092141444" onmouseenter="enter('5635872676092141444');" onmouseout="out('5635872676092141444');" style="">  38 import android.os.StrictMode;                                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  39 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  40 import android.util.Log;                                                                                 </span>
<span class="-1076320969941752510" onmouseenter="enter('-1076320969941752510');" onmouseout="out('-1076320969941752510');" style="">  41 import android.util.SparseArray;                                                                         </span>
<span class="4395110202233918405" onmouseenter="enter('4395110202233918405');" onmouseout="out('4395110202233918405');" style="">  42 import com.android.launcher3.AutoInstallsLayout.LayoutParserCallback;                                    </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  43 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span class="6372524458266053383" onmouseenter="enter('6372524458266053383');" onmouseout="out('6372524458266053383');" style="">  44 import com.android.launcher3.compat.UserHandleCompat;                                                    </span>
<span class="-8849211230761127863" onmouseenter="enter('-8849211230761127863');" onmouseout="out('-8849211230761127863');" style="">  45 import com.android.launcher3.compat.UserManagerCompat;                                                   </span>
<span class="-7468653447981916815" onmouseenter="enter('-7468653447981916815');" onmouseout="out('-7468653447981916815');" style="">  46 import com.android.launcher3.config.ProviderConfig;                                                      </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  47 import java.io.File;                                                                                     </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  48 import java.net.URISyntaxException;                                                                      </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  49 import java.util.ArrayList;                                                                              </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  50 import java.util.Collections;                                                                            </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  51 import java.util.HashSet;                                                                                </span>
<span  style="">  52                                                                                                          </span>
<span  style="">  53                                                                                                          </span>
<span class="-5661310118425891821" onmouseenter="enter('-5661310118425891821');" onmouseout="out('-5661310118425891821');" style="">  54 public class LauncherProvider extends ContentProvider {                                                  </span>
<span class="-5301430442842506185" onmouseenter="enter('-5301430442842506185');" onmouseout="out('-5301430442842506185');" style="">  55     private static final String TAG = &quot;Launcher.LauncherProvider&quot;;                                       </span>
<span  style="">  56                                                                                                          </span>
<span class="-8469384925954206736" onmouseenter="enter('-8469384925954206736');" onmouseout="out('-8469384925954206736');" style="">  57     private static final boolean LOGD = false;                                                           </span>
<span  style="">  58                                                                                                          </span>
<span class="9152615363478404775" onmouseenter="enter('9152615363478404775');" onmouseout="out('9152615363478404775');" style="">  59     private static final int DATABASE_VERSION = 22;                                                      </span>
<span  style="">  60                                                                                                          </span>
<span class="-458478327704245810" onmouseenter="enter('-458478327704245810');" onmouseout="out('-458478327704245810');" style="">  61     static final String OLD_AUTHORITY = &quot;com.android.launcher2.settings&quot;;                                </span>
<span  style="">  62                                                                                                          </span>
<span class="-4376021050615906115" onmouseenter="enter('-4376021050615906115');" onmouseout="out('-4376021050615906115');" style="">  63     static final String AUTHORITY = ProviderConfig.AUTHORITY;                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-6626902943579202823" onmouseenter="enter('-6626902943579202823');" onmouseout="out('-6626902943579202823');" style="">  65     static final String TABLE_FAVORITES = &quot;favorites&quot;;                                                   </span>
<span  style="">  66                                                                                                          </span>
<span class="-4121112267423691577" onmouseenter="enter('-4121112267423691577');" onmouseout="out('-4121112267423691577');" style="">  67     static final String TABLE_WORKSPACE_SCREENS = &quot;workspaceScreens&quot;;                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="5667619940348816611" onmouseenter="enter('5667619940348816611');" onmouseout="out('5667619940348816611');" style="">  69     static final String PARAMETER_NOTIFY = &quot;notify&quot;;                                                     </span>
<span  style="">  70                                                                                                          </span>
<span class="4313854869595882016" onmouseenter="enter('4313854869595882016');" onmouseout="out('4313854869595882016');" style="">  71     static final String EMPTY_DATABASE_CREATED = &quot;EMPTY_DATABASE_CREATED&quot;;                               </span>
<span  style="">  72                                                                                                          </span>
<span class="-254878042648191521" onmouseenter="enter('-254878042648191521');" onmouseout="out('-254878042648191521');" style="">  73     private static final String URI_PARAM_IS_EXTERNAL_ADD = &quot;isExternalAdd&quot;;                             </span>
<span  style="">  74                                                                                                          </span>
<span class="-4555445478569710276" onmouseenter="enter('-4555445478569710276');" onmouseout="out('-4555445478569710276');" style="">  75     private LauncherProviderChangeListener mListener;                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  77     /**                                                                                                  </span>
<span class="-3211764681636990688" onmouseenter="enter('-3211764681636990688');" onmouseout="out('-3211764681636990688');" style="">  78      * {@link Uri} triggered at any registered {@link android.database.ContentObserver} when             </span>
<span class="-4919300270466303234" onmouseenter="enter('-4919300270466303234');" onmouseout="out('-4919300270466303234');" style="">  79      * {@link AppWidgetHost#deleteHost()} is called during database creation.                            </span>
<span class="-788325382909228329" onmouseenter="enter('-788325382909228329');" onmouseout="out('-788325382909228329');" style="">  80      * Use this to recall {@link AppWidgetHost#startListening()} if needed.                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  81      */                                                                                                  </span>
<span class="5515339483970246409" onmouseenter="enter('5515339483970246409');" onmouseout="out('5515339483970246409');" style="">  82     static final Uri CONTENT_APPWIDGET_RESET_URI =                                                       </span>
<span class="3194273355649806706" onmouseenter="enter('3194273355649806706');" onmouseout="out('3194273355649806706');" style="">  83             Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/appWidgetReset&quot;);                                     </span>
<span  style="">  84                                                                                                          </span>
<span class="-35355205086145165" onmouseenter="enter('-35355205086145165');" onmouseout="out('-35355205086145165');" style="">  85     private DatabaseHelper mOpenHelper;                                                                  </span>
<span  style="">  86                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  87     @Override                                                                                            </span>
<span class="5054121129922253104" onmouseenter="enter('5054121129922253104');" onmouseout="out('5054121129922253104');" style="">  88     public boolean onCreate() {                                                                          </span>
<span class="4475688138331124962" onmouseenter="enter('4475688138331124962');" onmouseout="out('4475688138331124962');" style="">  89         final Context context = getContext();                                                            </span>
<span class="-8005318937043312715" onmouseenter="enter('-8005318937043312715');" onmouseout="out('-8005318937043312715');" style="">  90         StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();                          </span>
<span class="-7690576094790651842" onmouseenter="enter('-7690576094790651842');" onmouseout="out('-7690576094790651842');" style="">  91         mOpenHelper = new DatabaseHelper(context);                                                       </span>
<span class="-9120794859598568002" onmouseenter="enter('-9120794859598568002');" onmouseout="out('-9120794859598568002');" style="">  92         StrictMode.setThreadPolicy(oldPolicy);                                                           </span>
<span class="-7305781479923559628" onmouseenter="enter('-7305781479923559628');" onmouseout="out('-7305781479923559628');" style="">  93         LauncherAppState.setLauncherProvider(this);                                                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  94         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95     }                                                                                                    </span>
<span  style="">  96                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style="">  97     public boolean wasNewDbCreated() {                                                                   </span>
<span class="-2120364841155545874" onmouseenter="enter('-2120364841155545874');" onmouseout="out('-2120364841155545874');" style="">  98         return mOpenHelper.wasNewDbCreated();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99     }                                                                                                    </span>
<span  style=""> 100                                                                                                          </span>
<span class="9170464131639972057" onmouseenter="enter('9170464131639972057');" onmouseout="out('9170464131639972057');" style=""> 101     public void setLauncherProviderChangeListener(LauncherProviderChangeListener listener) {             </span>
<span class="9132236250678632099" onmouseenter="enter('9132236250678632099');" onmouseout="out('9132236250678632099');" style=""> 102         mListener = listener;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103     }                                                                                                    </span>
<span  style=""> 104                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 105     @Override                                                                                            </span>
<span class="-1263590755434456926" onmouseenter="enter('-1263590755434456926');" onmouseout="out('-1263590755434456926');" style=""> 106     public String getType(Uri uri) {                                                                     </span>
<span class="336598653403461328" onmouseenter="enter('336598653403461328');" onmouseout="out('336598653403461328');" style=""> 107         SqlArguments args = new SqlArguments(uri, null, null);                                           </span>
<span class="-3811208733585118846" onmouseenter="enter('-3811208733585118846');" onmouseout="out('-3811208733585118846');" style=""> 108         if (TextUtils.isEmpty(args.where)) {                                                             </span>
<span class="4564755247099008741" onmouseenter="enter('4564755247099008741');" onmouseout="out('4564755247099008741');" style=""> 109             return &quot;vnd.android.cursor.dir/&quot; + args.table;                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 110         } else {                                                                                         </span>
<span class="9039528378345344991" onmouseenter="enter('9039528378345344991');" onmouseout="out('9039528378345344991');" style=""> 111             return &quot;vnd.android.cursor.item/&quot; + args.table;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span  style=""> 114                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 115     @Override                                                                                            </span>
<span class="2688381462100157580" onmouseenter="enter('2688381462100157580');" onmouseout="out('2688381462100157580');" style=""> 116     public Cursor query(Uri uri, String[] projection, String selection,                                  </span>
<span class="-8080601171652713678" onmouseenter="enter('-8080601171652713678');" onmouseout="out('-8080601171652713678');" style=""> 117             String[] selectionArgs, String sortOrder) {                                                  </span>
<span  style=""> 118                                                                                                          </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 119         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span class="-631518951729113636" onmouseenter="enter('-631518951729113636');" onmouseout="out('-631518951729113636');" style=""> 120         SQLiteQueryBuilder qb = new SQLiteQueryBuilder();                                                </span>
<span class="2611293065726660593" onmouseenter="enter('2611293065726660593');" onmouseout="out('2611293065726660593');" style=""> 121         qb.setTables(args.table);                                                                        </span>
<span  style=""> 122                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 123         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3134453170380441664" onmouseenter="enter('3134453170380441664');" onmouseout="out('3134453170380441664');" style=""> 124         Cursor result = qb.query(db, projection, args.where, args.args, null, null, sortOrder);          </span>
<span class="-7763164457135943875" onmouseenter="enter('-7763164457135943875');" onmouseout="out('-7763164457135943875');" style=""> 125         result.setNotificationUri(getContext().getContentResolver(), uri);                               </span>
<span  style=""> 126                                                                                                          </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 127         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="9207797122534392164" onmouseenter="enter('9207797122534392164');" onmouseout="out('9207797122534392164');" style=""> 130     private static long dbInsertAndCheck(DatabaseHelper helper,                                          </span>
<span class="-7649003652568167377" onmouseenter="enter('-7649003652568167377');" onmouseout="out('-7649003652568167377');" style=""> 131             SQLiteDatabase db, String table, String nullColumnHack, ContentValues values) {              </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style=""> 132         if (values == null) {                                                                            </span>
<span class="7184965589450928593" onmouseenter="enter('7184965589450928593');" onmouseout="out('7184965589450928593');" style=""> 133             throw new RuntimeException(&quot;Error: attempting to insert null values&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134         }                                                                                                </span>
<span class="7050899094957739080" onmouseenter="enter('7050899094957739080');" onmouseout="out('7050899094957739080');" style=""> 135         if (!values.containsKey(LauncherSettings.ChangeLogColumns._ID)) {                                </span>
<span class="492623150120761321" onmouseenter="enter('492623150120761321');" onmouseout="out('492623150120761321');" style=""> 136             throw new RuntimeException(&quot;Error: attempting to add item without specifying an id&quot;);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="-5706715493188407465" onmouseenter="enter('-5706715493188407465');" onmouseout="out('-5706715493188407465');" style=""> 138         helper.checkId(table, values);                                                                   </span>
<span class="1074556166740873719" onmouseenter="enter('1074556166740873719');" onmouseout="out('1074556166740873719');" style=""> 139         return db.insert(table, nullColumnHack, values);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140     }                                                                                                    </span>
<span  style=""> 141                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 142     @Override                                                                                            </span>
<span class="-734135164912880773" onmouseenter="enter('-734135164912880773');" onmouseout="out('-734135164912880773');" style=""> 143     public Uri insert(Uri uri, ContentValues initialValues) {                                            </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 144         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span class="-8942992855752528468" onmouseenter="enter('-8942992855752528468');" onmouseout="out('-8942992855752528468');" style=""> 145         // In very limited cases, we support system|signature permission apps to add to the db           </span>
<span class="8337919216215113797" onmouseenter="enter('8337919216215113797');" onmouseout="out('8337919216215113797');" style=""> 146         String externalAdd = uri.getQueryParameter(URI_PARAM_IS_EXTERNAL_ADD);                           </span>
<span class="5252109860149656502" onmouseenter="enter('5252109860149656502');" onmouseout="out('5252109860149656502');" style=""> 147         if ((externalAdd != null) &amp;&amp; &quot;true&quot;.equals(externalAdd)) {                                       </span>
<span class="255159610270408066" onmouseenter="enter('255159610270408066');" onmouseout="out('255159610270408066');" style=""> 148             if (!mOpenHelper.initializeExternalAdd(initialValues)) {                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 149                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151         }                                                                                                </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 152         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-6358079444454153819" onmouseenter="enter('-6358079444454153819');" onmouseout="out('-6358079444454153819');" style=""> 153         addModifiedTime(initialValues);                                                                  </span>
<span class="5419112362953263362" onmouseenter="enter('5419112362953263362');" onmouseout="out('5419112362953263362');" style=""> 154         final long rowId = dbInsertAndCheck(mOpenHelper, db, args.table, null, initialValues);           </span>
<span class="4021015844173112187" onmouseenter="enter('4021015844173112187');" onmouseout="out('4021015844173112187');" style=""> 155         if (rowId &lt;= 0) {                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 156             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157         }                                                                                                </span>
<span class="8735878877349428813" onmouseenter="enter('8735878877349428813');" onmouseout="out('8735878877349428813');" style=""> 158         uri = ContentUris.withAppendedId(uri, rowId);                                                    </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 159         sendNotify(uri);                                                                                 </span>
<span class="8673785246827833247" onmouseenter="enter('8673785246827833247');" onmouseout="out('8673785246827833247');" style=""> 160         return uri;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="-327877481205905086" onmouseenter="enter('-327877481205905086');" onmouseout="out('-327877481205905086');" style=""> 164     public int bulkInsert(Uri uri, ContentValues[] values) {                                             </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 165         SqlArguments args = new SqlArguments(uri);                                                       </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 166         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 167         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 168         try {                                                                                            </span>
<span class="7727596149598132072" onmouseenter="enter('7727596149598132072');" onmouseout="out('7727596149598132072');" style=""> 169             int numValues = values.length;                                                               </span>
<span class="805790054769028067" onmouseenter="enter('805790054769028067');" onmouseout="out('805790054769028067');" style=""> 170             for (int i = 0; i &lt; numValues; i++) {                                                        </span>
<span class="2678636525018066730" onmouseenter="enter('2678636525018066730');" onmouseout="out('2678636525018066730');" style=""> 171                 addModifiedTime(values[i]);                                                              </span>
<span class="-5505203781899797586" onmouseenter="enter('-5505203781899797586');" onmouseout="out('-5505203781899797586');" style=""> 172                 if (dbInsertAndCheck(mOpenHelper, db, args.table, null, values[i]) &lt; 0) {                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 173                     return 0;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175             }                                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 176             db.setTransactionSuccessful();                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 177         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 178             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 180         sendNotify(uri);                                                                                 </span>
<span class="6793841392205084718" onmouseenter="enter('6793841392205084718');" onmouseout="out('6793841392205084718');" style=""> 181         return values.length;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182     }                                                                                                    </span>
<span  style=""> 183                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 184     @Override                                                                                            </span>
<span class="5983754597853237276" onmouseenter="enter('5983754597853237276');" onmouseout="out('5983754597853237276');" style=""> 185     public ContentProviderResult[] applyBatch(ArrayList&lt;ContentProviderOperation&gt; operations)            </span>
<span class="-5628895276830175510" onmouseenter="enter('-5628895276830175510');" onmouseout="out('-5628895276830175510');" style=""> 186             throws OperationApplicationException {                                                       </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 187         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 188         db.beginTransaction();                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 189         try {                                                                                            </span>
<span class="3840622082470564062" onmouseenter="enter('3840622082470564062');" onmouseout="out('3840622082470564062');" style=""> 190             ContentProviderResult[] result =  super.applyBatch(operations);                              </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 191             db.setTransactionSuccessful();                                                               </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 192             return result;                                                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 193         } finally {                                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 194             db.endTransaction();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 198     @Override                                                                                            </span>
<span class="-6238796754049684603" onmouseenter="enter('-6238796754049684603');" onmouseout="out('-6238796754049684603');" style=""> 199     public int delete(Uri uri, String selection, String[] selectionArgs) {                               </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 200         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span  style=""> 201                                                                                                          </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 202         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="-848417512188045481" onmouseenter="enter('-848417512188045481');" onmouseout="out('-848417512188045481');" style=""> 203         int count = db.delete(args.table, args.where, args.args);                                        </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 204         if (count &gt; 0) sendNotify(uri);                                                                  </span>
<span  style=""> 205                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 206         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 209     @Override                                                                                            </span>
<span class="-6200308159398621930" onmouseenter="enter('-6200308159398621930');" onmouseout="out('-6200308159398621930');" style=""> 210     public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {         </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 211         SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                             </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 212         addModifiedTime(values);                                                                         </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 213         SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                           </span>
<span class="6692131291033480751" onmouseenter="enter('6692131291033480751');" onmouseout="out('6692131291033480751');" style=""> 214         int count = db.update(args.table, values, args.where, args.args);                                </span>
<span class="7377439406723422491" onmouseenter="enter('7377439406723422491');" onmouseout="out('7377439406723422491');" style=""> 215         if (count &gt; 0) {                                                                                 </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 216             sendNotify(uri);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217         }                                                                                                </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 218         return count;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219     }                                                                                                    </span>
<span  style=""> 220                                                                                                          </span>
<span class="-6137155183451194640" onmouseenter="enter('-6137155183451194640');" onmouseout="out('-6137155183451194640');" style=""> 221     private void sendNotify(Uri uri) {                                                                   </span>
<span class="8087997420167282782" onmouseenter="enter('8087997420167282782');" onmouseout="out('8087997420167282782');" style=""> 222         String notify = uri.getQueryParameter(PARAMETER_NOTIFY);                                         </span>
<span class="-1882364541416460726" onmouseenter="enter('-1882364541416460726');" onmouseout="out('-1882364541416460726');" style=""> 223         if (notify == null || &quot;true&quot;.equals(notify)) {                                                   </span>
<span class="-1009902495160891118" onmouseenter="enter('-1009902495160891118');" onmouseout="out('-1009902495160891118');" style=""> 224             getContext().getContentResolver().notifyChange(uri, null);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225         }                                                                                                </span>
<span  style=""> 226                                                                                                          </span>
<span class="-88474152060363663" onmouseenter="enter('-88474152060363663');" onmouseout="out('-88474152060363663');" style=""> 227         // always notify the backup agent                                                                </span>
<span class="-4136841506633225478" onmouseenter="enter('-4136841506633225478');" onmouseout="out('-4136841506633225478');" style=""> 228         LauncherBackupAgentHelper.dataChanged(getContext());                                             </span>
<span class="3660947493902737932" onmouseenter="enter('3660947493902737932');" onmouseout="out('3660947493902737932');" style=""> 229         if (mListener != null) {                                                                         </span>
<span class="7178241373784368891" onmouseenter="enter('7178241373784368891');" onmouseout="out('7178241373784368891');" style=""> 230             mListener.onLauncherProviderChange();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232     }                                                                                                    </span>
<span  style=""> 233                                                                                                          </span>
<span class="-6084407814327678466" onmouseenter="enter('-6084407814327678466');" onmouseout="out('-6084407814327678466');" style=""> 234     private static void addModifiedTime(ContentValues values) {                                          </span>
<span class="7778574075272931857" onmouseenter="enter('7778574075272931857');" onmouseout="out('7778574075272931857');" style=""> 235         values.put(LauncherSettings.ChangeLogColumns.MODIFIED, System.currentTimeMillis());              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236     }                                                                                                    </span>
<span  style=""> 237                                                                                                          </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 238     public long generateNewItemId() {                                                                    </span>
<span class="4208143222012601660" onmouseenter="enter('4208143222012601660');" onmouseout="out('4208143222012601660');" style=""> 239         return mOpenHelper.generateNewItemId();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240     }                                                                                                    </span>
<span  style=""> 241                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 242     public void updateMaxItemId(long id) {                                                               </span>
<span class="5887752252226734670" onmouseenter="enter('5887752252226734670');" onmouseout="out('5887752252226734670');" style=""> 243         mOpenHelper.updateMaxItemId(id);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244     }                                                                                                    </span>
<span  style=""> 245                                                                                                          </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 246     public long generateNewScreenId() {                                                                  </span>
<span class="1793864293735992917" onmouseenter="enter('1793864293735992917');" onmouseout="out('1793864293735992917');" style=""> 247         return mOpenHelper.generateNewScreenId();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248     }                                                                                                    </span>
<span  style=""> 249                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 250     /**                                                                                                  </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 251      * Clears all the data for a fresh start.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 252      */                                                                                                  </span>
<span class="-8979529877881539007" onmouseenter="enter('-8979529877881539007');" onmouseout="out('-8979529877881539007');" style=""> 253     synchronized public void createEmptyDB() {                                                           </span>
<span class="-257404101089763384" onmouseenter="enter('-257404101089763384');" onmouseout="out('-257404101089763384');" style=""> 254         mOpenHelper.createEmptyDB(mOpenHelper.getWritableDatabase());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255     }                                                                                                    </span>
<span  style=""> 256                                                                                                          </span>
<span class="6671122679064927328" onmouseenter="enter('6671122679064927328');" onmouseout="out('6671122679064927328');" style=""> 257     public void clearFlagEmptyDbCreated() {                                                              </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 258         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="6603172609148556207" onmouseenter="enter('6603172609148556207');" onmouseout="out('6603172609148556207');" style=""> 259         getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE)                                   </span>
<span class="-4990178698661362372" onmouseenter="enter('-4990178698661362372');" onmouseout="out('-4990178698661362372');" style=""> 260             .edit()                                                                                      </span>
<span class="-4523663616686353798" onmouseenter="enter('-4523663616686353798');" onmouseout="out('-4523663616686353798');" style=""> 261             .remove(EMPTY_DATABASE_CREATED)                                                              </span>
<span class="5746476506062343638" onmouseenter="enter('5746476506062343638');" onmouseout="out('5746476506062343638');" style=""> 262             .commit();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263     }                                                                                                    </span>
<span  style=""> 264                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 265     /**                                                                                                  </span>
<span class="277164340629859803" onmouseenter="enter('277164340629859803');" onmouseout="out('277164340629859803');" style=""> 266      * Loads the default workspace based on the following priority scheme:                               </span>
<span class="6191061916552549057" onmouseenter="enter('6191061916552549057');" onmouseout="out('6191061916552549057');" style=""> 267      *   1) From a package provided by play store                                                        </span>
<span class="-1458935321569433020" onmouseenter="enter('-1458935321569433020');" onmouseout="out('-1458935321569433020');" style=""> 268      *   2) From a partner configuration APK, already in the system image                                </span>
<span class="-8497452292409790071" onmouseenter="enter('-8497452292409790071');" onmouseout="out('-8497452292409790071');" style=""> 269      *   3) The default configuration for the particular device                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 270      */                                                                                                  </span>
<span class="-4109341010907676070" onmouseenter="enter('-4109341010907676070');" onmouseout="out('-4109341010907676070');" style=""> 271     synchronized public void loadDefaultFavoritesIfNecessary() {                                         </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 272         String spKey = LauncherAppState.getSharedPreferencesKey();                                       </span>
<span class="-1270995004093477684" onmouseenter="enter('-1270995004093477684');" onmouseout="out('-1270995004093477684');" style=""> 273         SharedPreferences sp = getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span  style=""> 274                                                                                                          </span>
<span class="-1164862040405657048" onmouseenter="enter('-1164862040405657048');" onmouseout="out('-1164862040405657048');" style=""> 275         if (sp.getBoolean(EMPTY_DATABASE_CREATED, false)) {                                              </span>
<span class="-3246698064640464314" onmouseenter="enter('-3246698064640464314');" onmouseout="out('-3246698064640464314');" style=""> 276             Log.d(TAG, &quot;loading default workspace&quot;);                                                     </span>
<span  style=""> 277                                                                                                          </span>
<span class="7358984688962203192" onmouseenter="enter('7358984688962203192');" onmouseout="out('7358984688962203192');" style=""> 278             AutoInstallsLayout loader = AutoInstallsLayout.get(getContext(),                             </span>
<span class="4267100487943846224" onmouseenter="enter('4267100487943846224');" onmouseout="out('4267100487943846224');" style=""> 279                     mOpenHelper.mAppWidgetHost, mOpenHelper);                                            </span>
<span  style=""> 280                                                                                                          </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 281             if (loader == null) {                                                                        </span>
<span class="-7748100060285216458" onmouseenter="enter('-7748100060285216458');" onmouseout="out('-7748100060285216458');" style=""> 282                 final Partner partner = Partner.get(getContext().getPackageManager());                   </span>
<span class="-604675337449948556" onmouseenter="enter('-604675337449948556');" onmouseout="out('-604675337449948556');" style=""> 283                 if (partner != null &amp;&amp; partner.hasDefaultLayout()) {                                     </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 284                     final Resources partnerRes = partner.getResources();                                 </span>
<span class="4481789752192356250" onmouseenter="enter('4481789752192356250');" onmouseout="out('4481789752192356250');" style=""> 285                     int workspaceResId = partnerRes.getIdentifier(Partner.RES_DEFAULT_LAYOUT,            </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 286                             &quot;xml&quot;, partner.getPackageName());                                            </span>
<span class="-1442734434460802886" onmouseenter="enter('-1442734434460802886');" onmouseout="out('-1442734434460802886');" style=""> 287                     if (workspaceResId != 0) {                                                           </span>
<span class="-624367766367819814" onmouseenter="enter('-624367766367819814');" onmouseout="out('-624367766367819814');" style=""> 288                         loader = new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,       </span>
<span class="3991293503056578945" onmouseenter="enter('3991293503056578945');" onmouseout="out('3991293503056578945');" style=""> 289                                 mOpenHelper, partnerRes, workspaceResId);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292             }                                                                                            </span>
<span  style=""> 293                                                                                                          </span>
<span class="-1006525515535848907" onmouseenter="enter('-1006525515535848907');" onmouseout="out('-1006525515535848907');" style=""> 294             final boolean usingExternallyProvidedLayout = loader != null;                                </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 295             if (loader == null) {                                                                        </span>
<span class="-6937254959516916052" onmouseenter="enter('-6937254959516916052');" onmouseout="out('-6937254959516916052');" style=""> 296                 loader = getDefaultLayoutParser();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297             }                                                                                            </span>
<span class="126045670500141" onmouseenter="enter('126045670500141');" onmouseout="out('126045670500141');" style=""> 298             // Populate favorites table with initial favorites                                           </span>
<span class="8206837333293431906" onmouseenter="enter('8206837333293431906');" onmouseout="out('8206837333293431906');" style=""> 299             if ((mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(), loader) &lt;= 0)              </span>
<span class="-363747028825236736" onmouseenter="enter('-363747028825236736');" onmouseout="out('-363747028825236736');" style=""> 300                     &amp;&amp; usingExternallyProvidedLayout) {                                                  </span>
<span class="-5734732948359842282" onmouseenter="enter('-5734732948359842282');" onmouseout="out('-5734732948359842282');" style=""> 301                 // Unable to load external layout. Cleanup and load the internal layout.                 </span>
<span class="5828098457627567319" onmouseenter="enter('5828098457627567319');" onmouseout="out('5828098457627567319');" style=""> 302                 createEmptyDB();                                                                         </span>
<span class="-3956631052588999268" onmouseenter="enter('-3956631052588999268');" onmouseout="out('-3956631052588999268');" style=""> 303                 mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(),                             </span>
<span class="5010356356580148690" onmouseenter="enter('5010356356580148690');" onmouseout="out('5010356356580148690');" style=""> 304                         getDefaultLayoutParser());                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305             }                                                                                            </span>
<span class="-1774667578952654848" onmouseenter="enter('-1774667578952654848');" onmouseout="out('-1774667578952654848');" style=""> 306             clearFlagEmptyDbCreated();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308     }                                                                                                    </span>
<span  style=""> 309                                                                                                          </span>
<span class="1869645688222446570" onmouseenter="enter('1869645688222446570');" onmouseout="out('1869645688222446570');" style=""> 310     private DefaultLayoutParser getDefaultLayoutParser() {                                               </span>
<span class="-4358736250572585751" onmouseenter="enter('-4358736250572585751');" onmouseout="out('-4358736250572585751');" style=""> 311         int defaultLayout = LauncherAppState.getInstance()                                               </span>
<span class="-3651315710070586527" onmouseenter="enter('-3651315710070586527');" onmouseout="out('-3651315710070586527');" style=""> 312                 .getDynamicGrid().getDeviceProfile().defaultLayoutId;                                    </span>
<span class="-4806143495772092322" onmouseenter="enter('-4806143495772092322');" onmouseout="out('-4806143495772092322');" style=""> 313         return new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                         </span>
<span class="-4976455824453899875" onmouseenter="enter('-4976455824453899875');" onmouseout="out('-4976455824453899875');" style=""> 314                 mOpenHelper, getContext().getResources(), defaultLayout);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315     }                                                                                                    </span>
<span  style=""> 316                                                                                                          </span>
<span class="-8499205643032210495" onmouseenter="enter('-8499205643032210495');" onmouseout="out('-8499205643032210495');" style=""> 317     public void migrateLauncher2Shortcuts() {                                                            </span>
<span class="-5770271076267441053" onmouseenter="enter('-5770271076267441053');" onmouseout="out('-5770271076267441053');" style=""> 318         mOpenHelper.migrateLauncher2Shortcuts(mOpenHelper.getWritableDatabase(),                         </span>
<span class="-4855681120160555012" onmouseenter="enter('-4855681120160555012');" onmouseout="out('-4855681120160555012');" style=""> 319                 Uri.parse(getContext().getString(R.string.old_launcher_provider_uri)));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320     }                                                                                                    </span>
<span  style=""> 321                                                                                                          </span>
<span class="-5196105730574921781" onmouseenter="enter('-5196105730574921781');" onmouseout="out('-5196105730574921781');" style=""> 322     public void updateFolderItemsRank() {                                                                </span>
<span class="4982456805094611516" onmouseenter="enter('4982456805094611516');" onmouseout="out('4982456805094611516');" style=""> 323         mOpenHelper.updateFolderItemsRank(mOpenHelper.getWritableDatabase(), false);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324     }                                                                                                    </span>
<span  style=""> 325                                                                                                          </span>
<span class="-7861087353469194327" onmouseenter="enter('-7861087353469194327');" onmouseout="out('-7861087353469194327');" style=""> 326     public void deleteDatabase() {                                                                       </span>
<span class="-3081120555997572478" onmouseenter="enter('-3081120555997572478');" onmouseout="out('-3081120555997572478');" style=""> 327         // Are you sure? (y/n)                                                                           </span>
<span class="7599905409028339447" onmouseenter="enter('7599905409028339447');" onmouseout="out('7599905409028339447');" style=""> 328         final SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                     </span>
<span class="4824670475834221257" onmouseenter="enter('4824670475834221257');" onmouseout="out('4824670475834221257');" style=""> 329         final File dbFile = new File(db.getPath());                                                      </span>
<span class="-4378932496508441297" onmouseenter="enter('-4378932496508441297');" onmouseout="out('-4378932496508441297');" style=""> 330         mOpenHelper.close();                                                                             </span>
<span class="-2168275612742463412" onmouseenter="enter('-2168275612742463412');" onmouseout="out('-2168275612742463412');" style=""> 331         if (dbFile.exists()) {                                                                           </span>
<span class="7055278701412747697" onmouseenter="enter('7055278701412747697');" onmouseout="out('7055278701412747697');" style=""> 332             SQLiteDatabase.deleteDatabase(dbFile);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333         }                                                                                                </span>
<span class="1429708216911350032" onmouseenter="enter('1429708216911350032');" onmouseout="out('1429708216911350032');" style=""> 334         mOpenHelper = new DatabaseHelper(getContext());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335     }                                                                                                    </span>
<span  style=""> 336                                                                                                          </span>
<span class="-8073014385313712586" onmouseenter="enter('-8073014385313712586');" onmouseout="out('-8073014385313712586');" style=""> 337     private static class DatabaseHelper extends SQLiteOpenHelper implements LayoutParserCallback {       </span>
<span class="-2672328117217234149" onmouseenter="enter('-2672328117217234149');" onmouseout="out('-2672328117217234149');" style=""> 338         private final Context mContext;                                                                  </span>
<span  style=""> 339                                                                                                          </span>
<span class="-7815254415381208754" onmouseenter="enter('-7815254415381208754');" onmouseout="out('-7815254415381208754');" style=""> 340         private final AppWidgetHost mAppWidgetHost;                                                      </span>
<span  style=""> 341                                                                                                          </span>
<span class="256431113711786954" onmouseenter="enter('256431113711786954');" onmouseout="out('256431113711786954');" style=""> 342         private long mMaxItemId = -1;                                                                    </span>
<span  style=""> 343                                                                                                          </span>
<span class="3024521003496490102" onmouseenter="enter('3024521003496490102');" onmouseout="out('3024521003496490102');" style=""> 344         private long mMaxScreenId = -1;                                                                  </span>
<span  style=""> 345                                                                                                          </span>
<span class="7342788129695687690" onmouseenter="enter('7342788129695687690');" onmouseout="out('7342788129695687690');" style=""> 346         private boolean mNewDbCreated = false;                                                           </span>
<span  style=""> 347                                                                                                          </span>
<span class="1000156088447424124" onmouseenter="enter('1000156088447424124');" onmouseout="out('1000156088447424124');" style=""> 348         DatabaseHelper(Context context) {                                                                </span>
<span class="5450204288644697643" onmouseenter="enter('5450204288644697643');" onmouseout="out('5450204288644697643');" style=""> 349             super(context, LauncherFiles.LAUNCHER_DB, null, DATABASE_VERSION);                           </span>
<span class="7260904205784329196" onmouseenter="enter('7260904205784329196');" onmouseout="out('7260904205784329196');" style=""> 350             mContext = context;                                                                          </span>
<span class="6731257549223913473" onmouseenter="enter('6731257549223913473');" onmouseout="out('6731257549223913473');" style=""> 351             mAppWidgetHost = new AppWidgetHost(context, Launcher.APPWIDGET_HOST_ID);                     </span>
<span class="-7119307471557363464" onmouseenter="enter('-7119307471557363464');" onmouseout="out('-7119307471557363464');" style=""> 352             // In the case where neither onCreate nor onUpgrade gets called, we read the maxId from      </span>
<span class="-7146491614936969963" onmouseenter="enter('-7146491614936969963');" onmouseout="out('-7146491614936969963');" style=""> 353             // the DB here                                                                               </span>
<span class="-4991170806261126221" onmouseenter="enter('-4991170806261126221');" onmouseout="out('-4991170806261126221');" style=""> 354             if (mMaxItemId == (-1)) {                                                                    </span>
<span class="6514208419145701418" onmouseenter="enter('6514208419145701418');" onmouseout="out('6514208419145701418');" style=""> 355                 mMaxItemId = initializeMaxItemId(getWritableDatabase());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356             }                                                                                            </span>
<span class="-7435754855225565638" onmouseenter="enter('-7435754855225565638');" onmouseout="out('-7435754855225565638');" style=""> 357             if (mMaxScreenId == (-1)) {                                                                  </span>
<span class="-7197865417052699646" onmouseenter="enter('-7197865417052699646');" onmouseout="out('-7197865417052699646');" style=""> 358                 mMaxScreenId = initializeMaxScreenId(getWritableDatabase());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 360         }                                                                                                </span>
<span  style=""> 361                                                                                                          </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 362         public boolean wasNewDbCreated() {                                                               </span>
<span class="1294520975679493300" onmouseenter="enter('1294520975679493300');" onmouseout="out('1294520975679493300');" style=""> 363             return mNewDbCreated;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364         }                                                                                                </span>
<span  style=""> 365                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 366         /**                                                                                              </span>
<span class="-3713204910685876719" onmouseenter="enter('-3713204910685876719');" onmouseout="out('-3713204910685876719');" style=""> 367          * Send notification that we&#x27;ve deleted the {@link AppWidgetHost},                               </span>
<span class="-5398164636189778479" onmouseenter="enter('-5398164636189778479');" onmouseout="out('-5398164636189778479');" style=""> 368          * probably as part of the initial database creation. The receiver may                           </span>
<span class="-284834762183367019" onmouseenter="enter('-284834762183367019');" onmouseout="out('-284834762183367019');" style=""> 369          * want to re-call {@link AppWidgetHost#startListening()} to ensure                              </span>
<span class="1913597860538764992" onmouseenter="enter('1913597860538764992');" onmouseout="out('1913597860538764992');" style=""> 370          * callbacks are correctly set.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 371          */                                                                                              </span>
<span class="3384745401314169661" onmouseenter="enter('3384745401314169661');" onmouseout="out('3384745401314169661');" style=""> 372         private void sendAppWidgetResetNotify() {                                                        </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 373             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="4149774703050814155" onmouseenter="enter('4149774703050814155');" onmouseout="out('4149774703050814155');" style=""> 374             resolver.notifyChange(CONTENT_APPWIDGET_RESET_URI, null);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375         }                                                                                                </span>
<span  style=""> 376                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 377         @Override                                                                                        </span>
<span class="3201464308903999877" onmouseenter="enter('3201464308903999877');" onmouseout="out('3201464308903999877');" style=""> 378         public void onCreate(SQLiteDatabase db) {                                                        </span>
<span class="4744685829155971552" onmouseenter="enter('4744685829155971552');" onmouseout="out('4744685829155971552');" style=""> 379             if (LOGD) Log.d(TAG, &quot;creating new launcher database&quot;);                                      </span>
<span  style=""> 380                                                                                                          </span>
<span class="-5512536783286632376" onmouseenter="enter('-5512536783286632376');" onmouseout="out('-5512536783286632376');" style=""> 381             mMaxItemId = 1;                                                                              </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 382             mMaxScreenId = 0;                                                                            </span>
<span class="-3863035699221776712" onmouseenter="enter('-3863035699221776712');" onmouseout="out('-3863035699221776712');" style=""> 383             mNewDbCreated = true;                                                                        </span>
<span  style=""> 384                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 385             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                     </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 386             long userSerialNumber = userManager.getSerialNumberForUser(                                  </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 387                     UserHandleCompat.myUserHandle());                                                    </span>
<span  style=""> 388                                                                                                          </span>
<span class="-5810771542500139933" onmouseenter="enter('-5810771542500139933');" onmouseout="out('-5810771542500139933');" style=""> 389             db.execSQL(&quot;CREATE TABLE favorites (&quot; +                                                      </span>
<span class="-7286867248755276119" onmouseenter="enter('-7286867248755276119');" onmouseout="out('-7286867248755276119');" style=""> 390                     &quot;_id INTEGER PRIMARY KEY,&quot; +                                                         </span>
<span class="5329137835308229169" onmouseenter="enter('5329137835308229169');" onmouseout="out('5329137835308229169');" style=""> 391                     &quot;title TEXT,&quot; +                                                                      </span>
<span class="-7776152072054589061" onmouseenter="enter('-7776152072054589061');" onmouseout="out('-7776152072054589061');" style=""> 392                     &quot;intent TEXT,&quot; +                                                                     </span>
<span class="4982593742089674958" onmouseenter="enter('4982593742089674958');" onmouseout="out('4982593742089674958');" style=""> 393                     &quot;container INTEGER,&quot; +                                                               </span>
<span class="-1871026270657853169" onmouseenter="enter('-1871026270657853169');" onmouseout="out('-1871026270657853169');" style=""> 394                     &quot;screen INTEGER,&quot; +                                                                  </span>
<span class="-9174211260981343890" onmouseenter="enter('-9174211260981343890');" onmouseout="out('-9174211260981343890');" style=""> 395                     &quot;cellX INTEGER,&quot; +                                                                   </span>
<span class="1584772009960348649" onmouseenter="enter('1584772009960348649');" onmouseout="out('1584772009960348649');" style=""> 396                     &quot;cellY INTEGER,&quot; +                                                                   </span>
<span class="5424055190881126727" onmouseenter="enter('5424055190881126727');" onmouseout="out('5424055190881126727');" style=""> 397                     &quot;spanX INTEGER,&quot; +                                                                   </span>
<span class="6553755327503045229" onmouseenter="enter('6553755327503045229');" onmouseout="out('6553755327503045229');" style=""> 398                     &quot;spanY INTEGER,&quot; +                                                                   </span>
<span class="5229848414421823036" onmouseenter="enter('5229848414421823036');" onmouseout="out('5229848414421823036');" style=""> 399                     &quot;itemType INTEGER,&quot; +                                                                </span>
<span class="-1771151571856416667" onmouseenter="enter('-1771151571856416667');" onmouseout="out('-1771151571856416667');" style=""> 400                     &quot;appWidgetId INTEGER NOT NULL DEFAULT -1,&quot; +                                         </span>
<span class="-9047067707489472437" onmouseenter="enter('-9047067707489472437');" onmouseout="out('-9047067707489472437');" style=""> 401                     &quot;isShortcut INTEGER,&quot; +                                                              </span>
<span class="-3445858598434382544" onmouseenter="enter('-3445858598434382544');" onmouseout="out('-3445858598434382544');" style=""> 402                     &quot;iconType INTEGER,&quot; +                                                                </span>
<span class="4279668316006004948" onmouseenter="enter('4279668316006004948');" onmouseout="out('4279668316006004948');" style=""> 403                     &quot;iconPackage TEXT,&quot; +                                                                </span>
<span class="2008284586023778304" onmouseenter="enter('2008284586023778304');" onmouseout="out('2008284586023778304');" style=""> 404                     &quot;iconResource TEXT,&quot; +                                                               </span>
<span class="-5981868381948376489" onmouseenter="enter('-5981868381948376489');" onmouseout="out('-5981868381948376489');" style=""> 405                     &quot;icon BLOB,&quot; +                                                                       </span>
<span class="5686768105176115842" onmouseenter="enter('5686768105176115842');" onmouseout="out('5686768105176115842');" style=""> 406                     &quot;uri TEXT,&quot; +                                                                        </span>
<span class="-5470568819214956502" onmouseenter="enter('-5470568819214956502');" onmouseout="out('-5470568819214956502');" style=""> 407                     &quot;displayMode INTEGER,&quot; +                                                             </span>
<span class="3582502352252677630" onmouseenter="enter('3582502352252677630');" onmouseout="out('3582502352252677630');" style=""> 408                     &quot;appWidgetProvider TEXT,&quot; +                                                          </span>
<span class="4065658841092455651" onmouseenter="enter('4065658841092455651');" onmouseout="out('4065658841092455651');" style=""> 409                     &quot;modified INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="422282607120493296" onmouseenter="enter('422282607120493296');" onmouseout="out('422282607120493296');" style=""> 410                     &quot;restored INTEGER NOT NULL DEFAULT 0,&quot; +                                             </span>
<span class="823907807759654324" onmouseenter="enter('823907807759654324');" onmouseout="out('823907807759654324');" style=""> 411                     &quot;profileId INTEGER DEFAULT &quot; + userSerialNumber + &quot;,&quot; +                              </span>
<span class="-8486149279194715653" onmouseenter="enter('-8486149279194715653');" onmouseout="out('-8486149279194715653');" style=""> 412                     &quot;rank INTEGER NOT NULL DEFAULT 0&quot; +                                                  </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 413                     &quot;);&quot;);                                                                               </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 414             addWorkspacesTable(db);                                                                      </span>
<span  style=""> 415                                                                                                          </span>
<span class="-1982623284376040662" onmouseenter="enter('-1982623284376040662');" onmouseout="out('-1982623284376040662');" style=""> 416             // Database was just created, so wipe any previous widgets                                   </span>
<span class="35469525966995251" onmouseenter="enter('35469525966995251');" onmouseout="out('35469525966995251');" style=""> 417             if (mAppWidgetHost != null) {                                                                </span>
<span class="2879907381293157546" onmouseenter="enter('2879907381293157546');" onmouseout="out('2879907381293157546');" style=""> 418                 mAppWidgetHost.deleteHost();                                                             </span>
<span class="-5770229164268459929" onmouseenter="enter('-5770229164268459929');" onmouseout="out('-5770229164268459929');" style=""> 419                 sendAppWidgetResetNotify();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420             }                                                                                            </span>
<span  style=""> 421                                                                                                          </span>
<span class="-1063142603395313746" onmouseenter="enter('-1063142603395313746');" onmouseout="out('-1063142603395313746');" style=""> 422             // Fresh and clean launcher DB.                                                              </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 423             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="7629543500667828090" onmouseenter="enter('7629543500667828090');" onmouseout="out('7629543500667828090');" style=""> 424             setFlagEmptyDbCreated();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425         }                                                                                                </span>
<span  style=""> 426                                                                                                          </span>
<span class="6272912136443308513" onmouseenter="enter('6272912136443308513');" onmouseout="out('6272912136443308513');" style=""> 427         private void addWorkspacesTable(SQLiteDatabase db) {                                             </span>
<span class="-3903395311102784039" onmouseenter="enter('-3903395311102784039');" onmouseout="out('-3903395311102784039');" style=""><abbr title=" 428             db.execSQL(((((((((&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS) + &quot; (&quot;) + LauncherSettings.WorkspaceScreens._ID) + &quot; INTEGER PRIMARY KEY,&quot;) + LauncherSettings.WorkspaceScreens.SCREEN_RANK) + &quot; INTEGER,&quot;) + LauncherSettings.ChangeLogColumns.MODIFIED) + &quot; INTEGER NOT NULL DEFAULT 0&quot;) + &quot;);&quot;);"> 428             db.execSQL(((((((((&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS) + &quot; (&quot;) + LauncherSettings.Work🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429         }                                                                                                </span>
<span  style=""> 430                                                                                                          </span>
<span class="-3232037806458942317" onmouseenter="enter('-3232037806458942317');" onmouseout="out('-3232037806458942317');" style=""> 431         private void removeOrphanedItems(SQLiteDatabase db) {                                            </span>
<span class="-3995909494643948388" onmouseenter="enter('-3995909494643948388');" onmouseout="out('-3995909494643948388');" style=""> 432             // Delete items directly on the workspace who&#x27;s screen id doesn&#x27;t exist                      </span>
<span class="6555258266445461688" onmouseenter="enter('6555258266445461688');" onmouseout="out('6555258266445461688');" style=""> 433             //  &quot;DELETE FROM favorites WHERE screen NOT IN (SELECT _id FROM workspaceScreens)            </span>
<span class="-1584785563187965465" onmouseenter="enter('-1584785563187965465');" onmouseout="out('-1584785563187965465');" style=""> 434             //   AND container = -100&quot;                                                                   </span>
<span class="-3502523792993972030" onmouseenter="enter('-3502523792993972030');" onmouseout="out('-3502523792993972030');" style=""> 435             String removeOrphanedDesktopItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                       </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 436                     &quot; WHERE &quot; +                                                                          </span>
<span class="-8781539607986806909" onmouseenter="enter('-8781539607986806909');" onmouseout="out('-8781539607986806909');" style=""> 437                     LauncherSettings.Favorites.SCREEN + &quot; NOT IN (SELECT &quot; +                             </span>
<span class="-3730067412022302503" onmouseenter="enter('-3730067412022302503');" onmouseout="out('-3730067412022302503');" style=""> 438                     LauncherSettings.WorkspaceScreens._ID + &quot; FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot;)&quot; +   </span>
<span class="8831213357842987069" onmouseenter="enter('8831213357842987069');" onmouseout="out('8831213357842987069');" style=""> 439                     &quot; AND &quot; +                                                                            </span>
<span class="-3912897749337440213" onmouseenter="enter('-3912897749337440213');" onmouseout="out('-3912897749337440213');" style=""> 440                     LauncherSettings.Favorites.CONTAINER + &quot; = &quot; +                                       </span>
<span class="-1572782876841487653" onmouseenter="enter('-1572782876841487653');" onmouseout="out('-1572782876841487653');" style=""> 441                     LauncherSettings.Favorites.CONTAINER_DESKTOP;                                        </span>
<span class="-5442680607495552531" onmouseenter="enter('-5442680607495552531');" onmouseout="out('-5442680607495552531');" style=""> 442             db.execSQL(removeOrphanedDesktopItems);                                                      </span>
<span  style=""> 443                                                                                                          </span>
<span class="2150462606818952724" onmouseenter="enter('2150462606818952724');" onmouseout="out('2150462606818952724');" style=""> 444             // Delete items contained in folders which no longer exist (after above statement)           </span>
<span class="7157590486959116676" onmouseenter="enter('7157590486959116676');" onmouseout="out('7157590486959116676');" style=""> 445             //  &quot;DELETE FROM favorites  WHERE container &lt;&gt; -100 AND container &lt;&gt; -101 AND container      </span>
<span class="4713393280747800603" onmouseenter="enter('4713393280747800603');" onmouseout="out('4713393280747800603');" style=""> 446             //   NOT IN (SELECT _id FROM favorites WHERE itemType = 2)&quot;                                  </span>
<span class="-8895952306054120744" onmouseenter="enter('-8895952306054120744');" onmouseout="out('-8895952306054120744');" style=""> 447             String removeOrphanedFolderItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 448                     &quot; WHERE &quot; +                                                                          </span>
<span class="-9165304043886914201" onmouseenter="enter('-9165304043886914201');" onmouseout="out('-9165304043886914201');" style=""> 449                     LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                      </span>
<span class="2430974176390543784" onmouseenter="enter('2430974176390543784');" onmouseout="out('2430974176390543784');" style=""> 450                     LauncherSettings.Favorites.CONTAINER_DESKTOP +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 451                     &quot; AND &quot;                                                                              </span>
<span class="5144458996296891504" onmouseenter="enter('5144458996296891504');" onmouseout="out('5144458996296891504');" style=""> 452                     + LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                    </span>
<span class="20571678636460503" onmouseenter="enter('20571678636460503');" onmouseout="out('20571678636460503');" style=""> 453                     LauncherSettings.Favorites.CONTAINER_HOTSEAT +                                       </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 454                     &quot; AND &quot;                                                                              </span>
<span class="-4280152506863766824" onmouseenter="enter('-4280152506863766824');" onmouseout="out('-4280152506863766824');" style=""> 455                     + LauncherSettings.Favorites.CONTAINER + &quot; NOT IN (SELECT &quot; +                        </span>
<span class="-971280935083657149" onmouseenter="enter('-971280935083657149');" onmouseout="out('-971280935083657149');" style=""> 456                     LauncherSettings.Favorites._ID + &quot; FROM &quot; + TABLE_FAVORITES +                        </span>
<span class="4038942553560789906" onmouseenter="enter('4038942553560789906');" onmouseout="out('4038942553560789906');" style=""> 457                     &quot; WHERE &quot; + LauncherSettings.Favorites.ITEM_TYPE + &quot; = &quot; +                           </span>
<span class="-1734962565729646321" onmouseenter="enter('-1734962565729646321');" onmouseout="out('-1734962565729646321');" style=""> 458                     LauncherSettings.Favorites.ITEM_TYPE_FOLDER + &quot;)&quot;;                                   </span>
<span class="-8852316947474253726" onmouseenter="enter('-8852316947474253726');" onmouseout="out('-8852316947474253726');" style=""> 459             db.execSQL(removeOrphanedFolderItems);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460         }                                                                                                </span>
<span  style=""> 461                                                                                                          </span>
<span class="-2961433455992777066" onmouseenter="enter('-2961433455992777066');" onmouseout="out('-2961433455992777066');" style=""> 462         private void setFlagJustLoadedOldDb() {                                                          </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 463             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 464             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="6248178474895602573" onmouseenter="enter('6248178474895602573');" onmouseout="out('6248178474895602573');" style=""> 465             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, false).commit();                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466         }                                                                                                </span>
<span  style=""> 467                                                                                                          </span>
<span class="3580170518454540960" onmouseenter="enter('3580170518454540960');" onmouseout="out('3580170518454540960');" style=""> 468         private void setFlagEmptyDbCreated() {                                                           </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 469             String spKey = LauncherAppState.getSharedPreferencesKey();                                   </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 470             SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);           </span>
<span class="-1598905447100916131" onmouseenter="enter('-1598905447100916131');" onmouseout="out('-1598905447100916131');" style=""> 471             sp.edit().putBoolean(EMPTY_DATABASE_CREATED, true).commit();                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472         }                                                                                                </span>
<span  style=""> 473                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 474         @Override                                                                                        </span>
<span class="-4655538025867202729" onmouseenter="enter('-4655538025867202729');" onmouseout="out('-4655538025867202729');" style=""> 475         public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {                       </span>
<span class="-4888864949456871457" onmouseenter="enter('-4888864949456871457');" onmouseout="out('-4888864949456871457');" style=""> 476             if (LOGD) {                                                                                  </span>
<span class="6701177882725519399" onmouseenter="enter('6701177882725519399');" onmouseout="out('6701177882725519399');" style=""> 477                 Log.d(TAG, &quot;onUpgrade triggered: &quot; + oldVersion);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478             }                                                                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 479             switch (oldVersion) {                                                                        </span>
<span class="9079869636182330080" onmouseenter="enter('9079869636182330080');" onmouseout="out('9079869636182330080');" style=""> 480                 // The version cannot be lower that 12, as Launcher3 never supported a lower             </span>
<span class="-4883409179661970227" onmouseenter="enter('-4883409179661970227');" onmouseout="out('-4883409179661970227');" style=""> 481                 // version of the DB.                                                                    </span>
<span class="-7608275320547787701" onmouseenter="enter('-7608275320547787701');" onmouseout="out('-7608275320547787701');" style=""> 482                 case 12 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 483                     {                                                                                    </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style=""> 484                         // With the new shrink-wrapped and re-orderable workspaces, it makes sense       </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style=""> 485                         // to persist workspace screens and their relative order.                        </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 486                         mMaxScreenId = 0;                                                                </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 487                         addWorkspacesTable(db);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488                     }                                                                                    </span>
<span class="-872894500592972828" onmouseenter="enter('-872894500592972828');" onmouseout="out('-872894500592972828');" style=""> 489                 case 13 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 490                     {                                                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 491                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 492                         try {                                                                            </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style=""> 493                             // Insert new column for holding widget provider name                        </span>
<span class="2767822635302709950" onmouseenter="enter('2767822635302709950');" onmouseout="out('2767822635302709950');" style=""> 494                             db.execSQL(&quot;ALTER TABLE favorites &quot; + &quot;ADD COLUMN appWidgetProvider TEXT;&quot;); </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 495                             db.setTransactionSuccessful();                                               </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 496                         } catch (SQLException ex) {                                                      </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 497                             Log.e(TAG, ex.getMessage(), ex);                                             </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 498                             // Old version remains, which means we wipe old data                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 499                             break;                                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 500                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 501                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503                     }                                                                                    </span>
<span class="-8894315376321739374" onmouseenter="enter('-8894315376321739374');" onmouseout="out('-8894315376321739374');" style=""> 504                 case 14 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 505                     {                                                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 506                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 507                         try {                                                                            </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style=""> 508                             // Insert new column for holding update timestamp                            </span>
<span class="-821549347676126714" onmouseenter="enter('-821549347676126714');" onmouseout="out('-821549347676126714');" style=""><abbr title=" 509                             db.execSQL(&quot;ALTER TABLE favorites &quot; + &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);"> 509                             db.execSQL(&quot;ALTER TABLE favorites &quot; + &quot;ADD COLUMN modified INTEGER NOT NULL D🔵</abbr></span>
<span class="-7843369480357459954" onmouseenter="enter('-7843369480357459954');" onmouseout="out('-7843369480357459954');" style=""><abbr title=" 510                             db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; + &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);"> 510                             db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; + &quot;ADD COLUMN modified INTEGER NOT🔵</abbr></span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 511                             db.setTransactionSuccessful();                                               </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 512                         } catch (SQLException ex) {                                                      </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 513                             Log.e(TAG, ex.getMessage(), ex);                                             </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 514                             // Old version remains, which means we wipe old data                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 515                             break;                                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 516                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 517                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519                     }                                                                                    </span>
<span class="6613670295395058133" onmouseenter="enter('6613670295395058133');" onmouseout="out('6613670295395058133');" style=""> 520                 case 15 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 521                     {                                                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 522                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 523                         try {                                                                            </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style=""> 524                             // Insert new column for holding restore status                              </span>
<span class="-5063552440003730139" onmouseenter="enter('-5063552440003730139');" onmouseout="out('-5063552440003730139');" style=""><abbr title=" 525                             db.execSQL(&quot;ALTER TABLE favorites &quot; + &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);"> 525                             db.execSQL(&quot;ALTER TABLE favorites &quot; + &quot;ADD COLUMN restored INTEGER NOT NULL D🔵</abbr></span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 526                             db.setTransactionSuccessful();                                               </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 527                         } catch (SQLException ex) {                                                      </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 528                             Log.e(TAG, ex.getMessage(), ex);                                             </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 529                             // Old version remains, which means we wipe old data                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 530                             break;                                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 531                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 532                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534                     }                                                                                    </span>
<span class="-6099013243782766904" onmouseenter="enter('-6099013243782766904');" onmouseout="out('-6099013243782766904');" style=""> 535                 case 16 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 536                     {                                                                                    </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style=""> 537                         // We use the db version upgrade here to identify users who may not have seen    </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style=""> 538                         // clings yet (because they weren&#x27;t available), but for whom the clings are now  </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style=""> 539                         // available (tablet users). Because one of the possible cling flows (migration) </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style=""><abbr title=" 540                         // is very destructive (wipes out workspaces), we want to prevent this from showing"> 540                         // is very destructive (wipes out workspaces), we want to prevent this from showi🔵</abbr></span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style=""> 541                         // until clear data. We do so by marking that the clings have been shown.        </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style=""> 542                         LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543                     }                                                                                    </span>
<span class="-7153102722344096190" onmouseenter="enter('-7153102722344096190');" onmouseout="out('-7153102722344096190');" style=""> 544                 case 17 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 545                     {                                                                                    </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style=""> 546                         // No-op                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547                     }                                                                                    </span>
<span class="-5100331865186121530" onmouseenter="enter('-5100331865186121530');" onmouseout="out('-5100331865186121530');" style=""> 548                 case 18 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 549                     {                                                                                    </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style=""> 550                         // Due to a data loss bug, some users may have items associated with screen ids  </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style=""> 551                         // which no longer exist. Since this can cause other problems, and since the user</span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style=""><abbr title=" 552                         // will never see these items anyway, we use database upgrade as an opportunity to"> 552                         // will never see these items anyway, we use database upgrade as an opportunity t🔵</abbr></span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style=""> 553                         // clean things up.                                                              </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style=""> 554                         removeOrphanedItems(db);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555                     }                                                                                    </span>
<span class="-6252470139172697491" onmouseenter="enter('-6252470139172697491');" onmouseout="out('-6252470139172697491');" style=""> 556                 case 19 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 557                     {                                                                                    </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style=""> 558                 // Add userId column                                                                     </span>
<span class="2862263159714553199" onmouseenter="enter('2862263159714553199');" onmouseout="out('2862263159714553199');" style=""> 559                         if (!addProfileColumn(db)) {                                                     </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 560                             // Old version remains, which means we wipe old data                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 561                             break;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 562                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563                     }                                                                                    </span>
<span class="4868811137032844936" onmouseenter="enter('4868811137032844936');" onmouseout="out('4868811137032844936');" style=""> 564                 case 20 :                                                                                </span>
<span class="-5016813644414129178" onmouseenter="enter('-5016813644414129178');" onmouseout="out('-5016813644414129178');" style=""> 565                     if (!updateFolderItemsRank(db, true)) {                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 566                         break;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567                     }                                                                                    </span>
<span class="-3021279285118457126" onmouseenter="enter('-3021279285118457126');" onmouseout="out('-3021279285118457126');" style=""> 568                 case 21 :                                                                                </span>
<span class="5677081435180812955" onmouseenter="enter('5677081435180812955');" onmouseout="out('5677081435180812955');" style=""> 569                     {                                                                                    </span>
<span class="8949931370118151818" onmouseenter="enter('8949931370118151818');" onmouseout="out('8949931370118151818');" style=""> 570                         // DB Upgraded successfully                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 571                         return;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573             }                                                                                            </span>
<span class="-498940447290760811" onmouseenter="enter('-498940447290760811');" onmouseout="out('-498940447290760811');" style=""> 574             // DB was not upgraded                                                                       </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style=""> 575             Log.w(TAG, &quot;Destroying all old data.&quot;);                                                      </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 576             createEmptyDB(db);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577         }                                                                                                </span>
<span  style=""> 578                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 579         @Override                                                                                        </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style=""> 580         public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                     </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style=""> 581             // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                    </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style=""> 582             Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +          </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style=""> 583                     &quot;. Wiping databse.&quot;);                                                                </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 584             createEmptyDB(db);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585         }                                                                                                </span>
<span  style=""> 586                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 587         /**                                                                                              </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 588          * Clears all the data for a fresh start.                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 589          */                                                                                              </span>
<span class="3436200006891248330" onmouseenter="enter('3436200006891248330');" onmouseout="out('3436200006891248330');" style=""> 590         public void createEmptyDB(SQLiteDatabase db) {                                                   </span>
<span class="-5910745818286558462" onmouseenter="enter('-5910745818286558462');" onmouseout="out('-5910745818286558462');" style=""> 591             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_FAVORITES);                                       </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 592             db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                               </span>
<span class="1466158746107327510" onmouseenter="enter('1466158746107327510');" onmouseout="out('1466158746107327510');" style=""> 593             onCreate(db);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594         }                                                                                                </span>
<span  style=""> 595                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 596         /**                                                                                              </span>
<span class="-1053110313716749360" onmouseenter="enter('-1053110313716749360');" onmouseout="out('-1053110313716749360');" style=""> 597          * Recreates workspace table and migrates data to the new table.                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 598          */                                                                                              </span>
<span class="-7546703806174777110" onmouseenter="enter('-7546703806174777110');" onmouseout="out('-7546703806174777110');" style=""> 599         public boolean recreateWorkspaceTable(SQLiteDatabase db) {                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 600             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 601             try {                                                                                        </span>
<span class="5182132674792153706" onmouseenter="enter('5182132674792153706');" onmouseout="out('5182132674792153706');" style=""> 602                 Cursor c = db.query(TABLE_WORKSPACE_SCREENS,                                             </span>
<span class="3343280592061827584" onmouseenter="enter('3343280592061827584');" onmouseout="out('3343280592061827584');" style=""> 603                         new String[] {LauncherSettings.WorkspaceScreens._ID},                            </span>
<span class="2929567931923591515" onmouseenter="enter('2929567931923591515');" onmouseout="out('2929567931923591515');" style=""> 604                         null, null, null, null,                                                          </span>
<span class="5916017515631826997" onmouseenter="enter('5916017515631826997');" onmouseout="out('5916017515631826997');" style=""> 605                         LauncherSettings.WorkspaceScreens.SCREEN_RANK);                                  </span>
<span class="-1823344416972566514" onmouseenter="enter('-1823344416972566514');" onmouseout="out('-1823344416972566514');" style=""> 606                 ArrayList&lt;Long&gt; sortedIDs = new ArrayList&lt;Long&gt;();                                       </span>
<span class="4402015381954986250" onmouseenter="enter('4402015381954986250');" onmouseout="out('4402015381954986250');" style=""> 607                 long maxId = 0;                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 608                 try {                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 609                     while (c.moveToNext()) {                                                             </span>
<span class="3955822985937591936" onmouseenter="enter('3955822985937591936');" onmouseout="out('3955822985937591936');" style=""> 610                         Long id = c.getLong(0);                                                          </span>
<span class="-8099018151679223899" onmouseenter="enter('-8099018151679223899');" onmouseout="out('-8099018151679223899');" style=""> 611                         if (!sortedIDs.contains(id)) {                                                   </span>
<span class="4916945519325465611" onmouseenter="enter('4916945519325465611');" onmouseout="out('4916945519325465611');" style=""> 612                             sortedIDs.add(id);                                                           </span>
<span class="2021292296450644008" onmouseenter="enter('2021292296450644008');" onmouseout="out('2021292296450644008');" style=""> 613                             maxId = Math.max(maxId, id);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 616                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 617                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 618                 }                                                                                        </span>
<span  style=""> 619                                                                                                          </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 620                 db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                           </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 621                 addWorkspacesTable(db);                                                                  </span>
<span  style=""> 622                                                                                                          </span>
<span class="-8504221546344504536" onmouseenter="enter('-8504221546344504536');" onmouseout="out('-8504221546344504536');" style=""> 623                 // Add all screen ids back                                                               </span>
<span class="-3342479167869315002" onmouseenter="enter('-3342479167869315002');" onmouseout="out('-3342479167869315002');" style=""> 624                 int total = sortedIDs.size();                                                            </span>
<span class="1933062560544426975" onmouseenter="enter('1933062560544426975');" onmouseout="out('1933062560544426975');" style=""> 625                 for (int i = 0; i &lt; total; i++) {                                                        </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 626                     ContentValues values = new ContentValues();                                          </span>
<span class="-1408476222282542161" onmouseenter="enter('-1408476222282542161');" onmouseout="out('-1408476222282542161');" style=""> 627                     values.put(LauncherSettings.WorkspaceScreens._ID, sortedIDs.get(i));                 </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style=""> 628                     values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                        </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 629                     addModifiedTime(values);                                                             </span>
<span class="-5345205574848137989" onmouseenter="enter('-5345205574848137989');" onmouseout="out('-5345205574848137989');" style=""> 630                     db.insertOrThrow(TABLE_WORKSPACE_SCREENS, null, values);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 631                 }                                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 632                 db.setTransactionSuccessful();                                                           </span>
<span class="-777319983275495791" onmouseenter="enter('-777319983275495791');" onmouseout="out('-777319983275495791');" style=""> 633                 mMaxScreenId = maxId;                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 634             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 635                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 636                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 637                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 638             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 639                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 641             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642         }                                                                                                </span>
<span  style=""> 643                                                                                                          </span>
<span class="-7501286576844846445" onmouseenter="enter('-7501286576844846445');" onmouseout="out('-7501286576844846445');" style=""> 644         private boolean updateFolderItemsRank(SQLiteDatabase db, boolean addRankColumn) {                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 645             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 646             try {                                                                                        </span>
<span class="5008547084206266322" onmouseenter="enter('5008547084206266322');" onmouseout="out('5008547084206266322');" style=""> 647                 if (addRankColumn) {                                                                     </span>
<span class="-7289454301230657535" onmouseenter="enter('-7289454301230657535');" onmouseout="out('-7289454301230657535');" style=""> 648                     // Insert new column for holding rank                                                </span>
<span class="-1590113536171608350" onmouseenter="enter('-1590113536171608350');" onmouseout="out('-1590113536171608350');" style=""> 649                     db.execSQL(&quot;ALTER TABLE favorites ADD COLUMN rank INTEGER NOT NULL DEFAULT 0;&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 650                 }                                                                                        </span>
<span  style=""> 651                                                                                                          </span>
<span class="-6084339731876053459" onmouseenter="enter('-6084339731876053459');" onmouseout="out('-6084339731876053459');" style=""> 652                 // Get a map for folder ID to folder width                                               </span>
<span class="7958578721408666232" onmouseenter="enter('7958578721408666232');" onmouseout="out('7958578721408666232');" style=""> 653                 Cursor c = db.rawQuery(&quot;SELECT container, MAX(cellX) FROM favorites&quot;                     </span>
<span class="1296304159181878428" onmouseenter="enter('1296304159181878428');" onmouseout="out('1296304159181878428');" style=""> 654                         + &quot; WHERE container IN (SELECT _id FROM favorites WHERE itemType = ?)&quot;           </span>
<span class="8240981592991850481" onmouseenter="enter('8240981592991850481');" onmouseout="out('8240981592991850481');" style=""> 655                         + &quot; GROUP BY container;&quot;,                                                        </span>
<span class="-3631725497478036647" onmouseenter="enter('-3631725497478036647');" onmouseout="out('-3631725497478036647');" style=""> 656                         new String[] {Integer.toString(LauncherSettings.Favorites.ITEM_TYPE_FOLDER)});   </span>
<span  style=""> 657                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 658                 while (c.moveToNext()) {                                                                 </span>
<span class="-6809072711155135098" onmouseenter="enter('-6809072711155135098');" onmouseout="out('-6809072711155135098');" style=""> 659                     db.execSQL(&quot;UPDATE favorites SET rank=cellX+(cellY*?) WHERE &quot;                        </span>
<span class="8697652523066470339" onmouseenter="enter('8697652523066470339');" onmouseout="out('8697652523066470339');" style=""> 660                             + &quot;container=? AND cellX IS NOT NULL AND cellY IS NOT NULL;&quot;,                </span>
<span class="-3010724386050799789" onmouseenter="enter('-3010724386050799789');" onmouseout="out('-3010724386050799789');" style=""> 661                             new Object[] {c.getLong(1) + 1, c.getLong(0)});                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 662                 }                                                                                        </span>
<span  style=""> 663                                                                                                          </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 664                 c.close();                                                                               </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 665                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 666             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 667                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 668                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 669                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 670             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 671                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 673             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674         }                                                                                                </span>
<span  style=""> 675                                                                                                          </span>
<span class="-4559468305095454841" onmouseenter="enter('-4559468305095454841');" onmouseout="out('-4559468305095454841');" style=""> 676         private boolean addProfileColumn(SQLiteDatabase db) {                                            </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 677             db.beginTransaction();                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 678             try {                                                                                        </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 679                 UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                 </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 680                 // Default to the serial number of this user, for older                                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 681                 // shortcuts.                                                                            </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 682                 long userSerialNumber = userManager.getSerialNumberForUser(                              </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 683                         UserHandleCompat.myUserHandle());                                                </span>
<span class="-7537890297935646580" onmouseenter="enter('-7537890297935646580');" onmouseout="out('-7537890297935646580');" style=""> 684                 // Insert new column for holding user serial number                                      </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 685                 db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                    </span>
<span class="6389325795698900878" onmouseenter="enter('6389325795698900878');" onmouseout="out('6389325795698900878');" style=""> 686                         &quot;ADD COLUMN profileId INTEGER DEFAULT &quot;                                          </span>
<span class="-6027465318491077769" onmouseenter="enter('-6027465318491077769');" onmouseout="out('-6027465318491077769');" style=""> 687                                         + userSerialNumber + &quot;;&quot;);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 688                 db.setTransactionSuccessful();                                                           </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 689             } catch (SQLException ex) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 690                 // Old version remains, which means we wipe old data                                     </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 691                 Log.e(TAG, ex.getMessage(), ex);                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 692                 return false;                                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 693             } finally {                                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 694                 db.endTransaction();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 695             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 696             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 697         }                                                                                                </span>
<span  style=""> 698                                                                                                          </span>
<span class="-8543343401238088250" onmouseenter="enter('-8543343401238088250');" onmouseout="out('-8543343401238088250');" style=""> 699         // Generates a new ID to use for an object in your database. This method should be only          </span>
<span class="-535999813132446250" onmouseenter="enter('-535999813132446250');" onmouseout="out('-535999813132446250');" style=""> 700         // called from the main UI thread. As an exception, we do call it when we call the               </span>
<span class="-3416944691245960228" onmouseenter="enter('-3416944691245960228');" onmouseout="out('-3416944691245960228');" style=""> 701         // constructor from the worker thread; however, this doesn&#x27;t extend until after the              </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 702         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 703         // after that point                                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 704         @Override                                                                                        </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 705         public long generateNewItemId() {                                                                </span>
<span class="2999684209048406821" onmouseenter="enter('2999684209048406821');" onmouseout="out('2999684209048406821');" style=""> 706             if (mMaxItemId &lt; 0) {                                                                        </span>
<span class="-7068859972649181897" onmouseenter="enter('-7068859972649181897');" onmouseout="out('-7068859972649181897');" style=""> 707                 throw new RuntimeException(&quot;Error: max item id was not initialized&quot;);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 708             }                                                                                            </span>
<span class="-2732750815463784999" onmouseenter="enter('-2732750815463784999');" onmouseout="out('-2732750815463784999');" style=""> 709             mMaxItemId += 1;                                                                             </span>
<span class="5456580978366825274" onmouseenter="enter('5456580978366825274');" onmouseout="out('5456580978366825274');" style=""> 710             return mMaxItemId;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 711         }                                                                                                </span>
<span  style=""> 712                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 713         @Override                                                                                        </span>
<span class="329443540154066398" onmouseenter="enter('329443540154066398');" onmouseout="out('329443540154066398');" style=""> 714         public long insertAndCheck(SQLiteDatabase db, ContentValues values) {                            </span>
<span class="-1505151618823806706" onmouseenter="enter('-1505151618823806706');" onmouseout="out('-1505151618823806706');" style=""> 715             return dbInsertAndCheck(this, db, TABLE_FAVORITES, null, values);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 716         }                                                                                                </span>
<span  style=""> 717                                                                                                          </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 718         public void updateMaxItemId(long id) {                                                           </span>
<span class="-6849429476525109058" onmouseenter="enter('-6849429476525109058');" onmouseout="out('-6849429476525109058');" style=""> 719             mMaxItemId = id + 1;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 720         }                                                                                                </span>
<span  style=""> 721                                                                                                          </span>
<span class="-7367368828761155068" onmouseenter="enter('-7367368828761155068');" onmouseout="out('-7367368828761155068');" style=""> 722         public void checkId(String table, ContentValues values) {                                        </span>
<span class="-1608142162103033850" onmouseenter="enter('-1608142162103033850');" onmouseout="out('-1608142162103033850');" style=""> 723             long id = values.getAsLong(LauncherSettings.BaseLauncherColumns._ID);                        </span>
<span class="-6900211224990683940" onmouseenter="enter('-6900211224990683940');" onmouseout="out('-6900211224990683940');" style=""> 724             if (table == LauncherProvider.TABLE_WORKSPACE_SCREENS) {                                     </span>
<span class="9109073648364222254" onmouseenter="enter('9109073648364222254');" onmouseout="out('9109073648364222254');" style=""> 725                 mMaxScreenId = Math.max(id, mMaxScreenId);                                               </span>
<span class="-6240460135729763291" onmouseenter="enter('-6240460135729763291');" onmouseout="out('-6240460135729763291');" style=""> 726             }  else {                                                                                    </span>
<span class="754800730159449376" onmouseenter="enter('754800730159449376');" onmouseout="out('754800730159449376');" style=""> 727                 mMaxItemId = Math.max(id, mMaxItemId);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 728             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 729         }                                                                                                </span>
<span  style=""> 730                                                                                                          </span>
<span class="-8013451254632200820" onmouseenter="enter('-8013451254632200820');" onmouseout="out('-8013451254632200820');" style=""> 731         private long initializeMaxItemId(SQLiteDatabase db) {                                            </span>
<span class="-6457280004469744269" onmouseenter="enter('-6457280004469744269');" onmouseout="out('-6457280004469744269');" style=""> 732             Cursor c = db.rawQuery(&quot;SELECT MAX(_id) FROM favorites&quot;, null);                              </span>
<span  style=""> 733                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 734             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 735             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 736             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 737             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 738                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 740             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 741                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 742             }                                                                                            </span>
<span  style=""> 743                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 744             if (id == -1) {                                                                              </span>
<span class="-8632333559810917367" onmouseenter="enter('-8632333559810917367');" onmouseout="out('-8632333559810917367');" style=""> 745                 throw new RuntimeException(&quot;Error: could not query max item id&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 746             }                                                                                            </span>
<span  style=""> 747                                                                                                          </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 748             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 749         }                                                                                                </span>
<span  style=""> 750                                                                                                          </span>
<span class="3292148501075941248" onmouseenter="enter('3292148501075941248');" onmouseout="out('3292148501075941248');" style=""> 751         // Generates a new ID to use for an workspace screen in your database. This method               </span>
<span class="8169251972405240623" onmouseenter="enter('8169251972405240623');" onmouseout="out('8169251972405240623');" style=""> 752         // should be only called from the main UI thread. As an exception, we do call it when we         </span>
<span class="5354260748737756868" onmouseenter="enter('5354260748737756868');" onmouseout="out('5354260748737756868');" style=""> 753         // call the constructor from the worker thread; however, this doesn&#x27;t extend until after the     </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 754         // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp        </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 755         // after that point                                                                              </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 756         public long generateNewScreenId() {                                                              </span>
<span class="-2601779586206833262" onmouseenter="enter('-2601779586206833262');" onmouseout="out('-2601779586206833262');" style=""> 757             if (mMaxScreenId &lt; 0) {                                                                      </span>
<span class="-8395628436366181623" onmouseenter="enter('-8395628436366181623');" onmouseout="out('-8395628436366181623');" style=""> 758                 throw new RuntimeException(&quot;Error: max screen id was not initialized&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 759             }                                                                                            </span>
<span class="-7600499966171393409" onmouseenter="enter('-7600499966171393409');" onmouseout="out('-7600499966171393409');" style=""> 760             mMaxScreenId += 1;                                                                           </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 761             // Log to disk                                                                               </span>
<span class="-8761729187376845632" onmouseenter="enter('-8761729187376845632');" onmouseout="out('-8761729187376845632');" style=""> 762             Launcher.addDumpLog(TAG, &quot;11683562 - generateNewScreenId(): &quot; + mMaxScreenId, true);         </span>
<span class="-2082539956971430335" onmouseenter="enter('-2082539956971430335');" onmouseout="out('-2082539956971430335');" style=""> 763             return mMaxScreenId;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 764         }                                                                                                </span>
<span  style=""> 765                                                                                                          </span>
<span class="1340022180158952931" onmouseenter="enter('1340022180158952931');" onmouseout="out('1340022180158952931');" style=""> 766         private long initializeMaxScreenId(SQLiteDatabase db) {                                          </span>
<span class="-2625939584691052131" onmouseenter="enter('-2625939584691052131');" onmouseout="out('-2625939584691052131');" style=""><abbr title=" 767             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);"> 767             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TA🔵</abbr></span>
<span  style=""> 768                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 769             // get the result                                                                            </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 770             final int maxIdIndex = 0;                                                                    </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 771             long id = -1;                                                                                </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 772             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 773                 id = c.getLong(maxIdIndex);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 774             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 775             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 776                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 777             }                                                                                            </span>
<span  style=""> 778                                                                                                          </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 779             if (id == -1) {                                                                              </span>
<span class="5981752458110974976" onmouseenter="enter('5981752458110974976');" onmouseout="out('5981752458110974976');" style=""> 780                 throw new RuntimeException(&quot;Error: could not query max screen id&quot;);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 781             }                                                                                            </span>
<span  style=""> 782                                                                                                          </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 783             // Log to disk                                                                               </span>
<span class="27430974887508761" onmouseenter="enter('27430974887508761');" onmouseout="out('27430974887508761');" style=""> 784             Launcher.addDumpLog(TAG, &quot;11683562 - initializeMaxScreenId(): &quot; + id, true);                 </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 785             return id;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 786         }                                                                                                </span>
<span  style=""> 787                                                                                                          </span>
<span class="1383368615032249869" onmouseenter="enter('1383368615032249869');" onmouseout="out('1383368615032249869');" style=""> 788         private boolean initializeExternalAdd(ContentValues values) {                                    </span>
<span class="-4585320292275114767" onmouseenter="enter('-4585320292275114767');" onmouseout="out('-4585320292275114767');" style=""> 789             // 1. Ensure that externally added items have a valid item id                                </span>
<span class="-4828262327370557067" onmouseenter="enter('-4828262327370557067');" onmouseout="out('-4828262327370557067');" style=""> 790             long id = generateNewItemId();                                                               </span>
<span class="-4305015780380424948" onmouseenter="enter('-4305015780380424948');" onmouseout="out('-4305015780380424948');" style=""> 791             values.put(LauncherSettings.Favorites._ID, id);                                              </span>
<span  style=""> 792                                                                                                          </span>
<span class="5555856101718413728" onmouseenter="enter('5555856101718413728');" onmouseout="out('5555856101718413728');" style=""> 793             // 2. In the case of an app widget, and if no app widget id is specified, we                 </span>
<span class="5653436237424007902" onmouseenter="enter('5653436237424007902');" onmouseout="out('5653436237424007902');" style=""> 794             // attempt allocate and bind the widget.                                                     </span>
<span class="7737959233990593661" onmouseenter="enter('7737959233990593661');" onmouseout="out('7737959233990593661');" style=""> 795             Integer itemType = values.getAsInteger(LauncherSettings.Favorites.ITEM_TYPE);                </span>
<span class="2055658702897830579" onmouseenter="enter('2055658702897830579');" onmouseout="out('2055658702897830579');" style=""> 796             if (itemType != null &amp;&amp;                                                                      </span>
<span class="-1739021162756129174" onmouseenter="enter('-1739021162756129174');" onmouseout="out('-1739021162756129174');" style=""> 797                     itemType.intValue() == LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET &amp;&amp;             </span>
<span class="-6215251601594981481" onmouseenter="enter('-6215251601594981481');" onmouseout="out('-6215251601594981481');" style=""> 798                     !values.containsKey(LauncherSettings.Favorites.APPWIDGET_ID)) {                      </span>
<span  style=""> 799                                                                                                          </span>
<span class="328319718470950320" onmouseenter="enter('328319718470950320');" onmouseout="out('328319718470950320');" style=""> 800                 final AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(mContext);        </span>
<span class="7884761264945585321" onmouseenter="enter('7884761264945585321');" onmouseout="out('7884761264945585321');" style=""> 801                 ComponentName cn = ComponentName.unflattenFromString(                                    </span>
<span class="2179911768770688102" onmouseenter="enter('2179911768770688102');" onmouseout="out('2179911768770688102');" style=""> 802                         values.getAsString(Favorites.APPWIDGET_PROVIDER));                               </span>
<span  style=""> 803                                                                                                          </span>
<span class="3459055710499452007" onmouseenter="enter('3459055710499452007');" onmouseout="out('3459055710499452007');" style=""> 804                 if (cn != null) {                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 805                     try {                                                                                </span>
<span class="7176738113779216844" onmouseenter="enter('7176738113779216844');" onmouseout="out('7176738113779216844');" style=""> 806                         int appWidgetId = mAppWidgetHost.allocateAppWidgetId();                          </span>
<span class="3122228588084428979" onmouseenter="enter('3122228588084428979');" onmouseout="out('3122228588084428979');" style=""> 807                         values.put(LauncherSettings.Favorites.APPWIDGET_ID, appWidgetId);                </span>
<span class="2309614617117273311" onmouseenter="enter('2309614617117273311');" onmouseout="out('2309614617117273311');" style=""> 808                         if (!appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn)) {                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 809                             return false;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 810                         }                                                                                </span>
<span class="1200625667814236005" onmouseenter="enter('1200625667814236005');" onmouseout="out('1200625667814236005');" style=""> 811                     } catch (RuntimeException e) {                                                       </span>
<span class="9049318523495391496" onmouseenter="enter('9049318523495391496');" onmouseout="out('9049318523495391496');" style=""> 812                         Log.e(TAG, &quot;Failed to initialize external widget&quot;, e);                           </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 813                         return false;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 814                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 815                 } else {                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 816                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 817                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 818             }                                                                                            </span>
<span  style=""> 819                                                                                                          </span>
<span class="-5393917371757635815" onmouseenter="enter('-5393917371757635815');" onmouseout="out('-5393917371757635815');" style=""> 820             // Add screen id if not present                                                              </span>
<span class="-8492193036384627967" onmouseenter="enter('-8492193036384627967');" onmouseout="out('-8492193036384627967');" style=""> 821             long screenId = values.getAsLong(LauncherSettings.Favorites.SCREEN);                         </span>
<span class="-8472780943665027311" onmouseenter="enter('-8472780943665027311');" onmouseout="out('-8472780943665027311');" style=""> 822             if (!addScreenIdIfNecessary(screenId)) {                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 823                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 824             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 825             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 826         }                                                                                                </span>
<span  style=""> 827                                                                                                          </span>
<span class="7352835902307890843" onmouseenter="enter('7352835902307890843');" onmouseout="out('7352835902307890843');" style=""> 828         // Returns true of screen id exists, or if successfully added                                    </span>
<span class="-4057720447241324922" onmouseenter="enter('-4057720447241324922');" onmouseout="out('-4057720447241324922');" style=""> 829         private boolean addScreenIdIfNecessary(long screenId) {                                          </span>
<span class="-8332527954530563349" onmouseenter="enter('-8332527954530563349');" onmouseout="out('-8332527954530563349');" style=""> 830             if (!hasScreenId(screenId)) {                                                                </span>
<span class="-3380006025674561043" onmouseenter="enter('-3380006025674561043');" onmouseout="out('-3380006025674561043');" style=""> 831                 int rank = getMaxScreenRank() + 1;                                                       </span>
<span  style=""> 832                                                                                                          </span>
<span class="4061202061343128850" onmouseenter="enter('4061202061343128850');" onmouseout="out('4061202061343128850');" style=""> 833                 ContentValues v = new ContentValues();                                                   </span>
<span class="-5112420615000020353" onmouseenter="enter('-5112420615000020353');" onmouseout="out('-5112420615000020353');" style=""> 834                 v.put(LauncherSettings.WorkspaceScreens._ID, screenId);                                  </span>
<span class="6806563186306365402" onmouseenter="enter('6806563186306365402');" onmouseout="out('6806563186306365402');" style=""> 835                 v.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                              </span>
<span class="-1115795847996433461" onmouseenter="enter('-1115795847996433461');" onmouseout="out('-1115795847996433461');" style=""> 836                 if (dbInsertAndCheck(this, getWritableDatabase(),                                        </span>
<span class="3238415722136121635" onmouseenter="enter('3238415722136121635');" onmouseout="out('3238415722136121635');" style=""> 837                         TABLE_WORKSPACE_SCREENS, null, v) &lt; 0) {                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 838                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 840             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 841             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842         }                                                                                                </span>
<span  style=""> 843                                                                                                          </span>
<span class="5478264759768975399" onmouseenter="enter('5478264759768975399');" onmouseout="out('5478264759768975399');" style=""> 844         private boolean hasScreenId(long screenId) {                                                     </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 845             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="7657123469267572077" onmouseenter="enter('7657123469267572077');" onmouseout="out('7657123469267572077');" style=""> 846             Cursor c = db.rawQuery(&quot;SELECT * FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot; WHERE &quot;                </span>
<span class="1858055579641267103" onmouseenter="enter('1858055579641267103');" onmouseout="out('1858055579641267103');" style=""> 847                     + LauncherSettings.WorkspaceScreens._ID + &quot; = &quot; + screenId, null);                   </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 848             if (c != null) {                                                                             </span>
<span class="-7874906179005583875" onmouseenter="enter('-7874906179005583875');" onmouseout="out('-7874906179005583875');" style=""> 849                 int count = c.getCount();                                                                </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 850                 c.close();                                                                               </span>
<span class="4255567607434315929" onmouseenter="enter('4255567607434315929');" onmouseout="out('4255567607434315929');" style=""> 851                 return count &gt; 0;                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 852             } else {                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 853                 return false;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 854             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 855         }                                                                                                </span>
<span  style=""> 856                                                                                                          </span>
<span class="-2708828914383579811" onmouseenter="enter('-2708828914383579811');" onmouseout="out('-2708828914383579811');" style=""> 857         private int getMaxScreenRank() {                                                                 </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 858             SQLiteDatabase db = getWritableDatabase();                                                   </span>
<span class="4567502420956726358" onmouseenter="enter('4567502420956726358');" onmouseout="out('4567502420956726358');" style=""> 859             Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens.SCREEN_RANK         </span>
<span class="-851271521804486447" onmouseenter="enter('-851271521804486447');" onmouseout="out('-851271521804486447');" style=""> 860                     + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);                                        </span>
<span  style=""> 861                                                                                                          </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 862             // get the result                                                                            </span>
<span class="-7089673966704675292" onmouseenter="enter('-7089673966704675292');" onmouseout="out('-7089673966704675292');" style=""> 863             final int maxRankIndex = 0;                                                                  </span>
<span class="8995972804405745177" onmouseenter="enter('8995972804405745177');" onmouseout="out('8995972804405745177');" style=""> 864             int rank = -1;                                                                               </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 865             if (c != null &amp;&amp; c.moveToNext()) {                                                           </span>
<span class="-130706833968251970" onmouseenter="enter('-130706833968251970');" onmouseout="out('-130706833968251970');" style=""> 866                 rank = c.getInt(maxRankIndex);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 867             }                                                                                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 868             if (c != null) {                                                                             </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 869                 c.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 870             }                                                                                            </span>
<span  style=""> 871                                                                                                          </span>
<span class="-5061660947414305561" onmouseenter="enter('-5061660947414305561');" onmouseout="out('-5061660947414305561');" style=""> 872             return rank;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 873         }                                                                                                </span>
<span  style=""> 874                                                                                                          </span>
<span class="7076012940679285170" onmouseenter="enter('7076012940679285170');" onmouseout="out('7076012940679285170');" style=""> 875         private int loadFavorites(SQLiteDatabase db, AutoInstallsLayout loader) {                        </span>
<span class="-517932292017625058" onmouseenter="enter('-517932292017625058');" onmouseout="out('-517932292017625058');" style=""> 876             ArrayList&lt;Long&gt; screenIds = new ArrayList&lt;Long&gt;();                                           </span>
<span class="-1992683231790282850" onmouseenter="enter('-1992683231790282850');" onmouseout="out('-1992683231790282850');" style=""> 877             // TODO: Use multiple loaders with fall-back and transaction.                                </span>
<span class="-198133332043015666" onmouseenter="enter('-198133332043015666');" onmouseout="out('-198133332043015666');" style=""> 878             int count = loader.loadLayout(db, screenIds);                                                </span>
<span  style=""> 879                                                                                                          </span>
<span class="6833875387324148439" onmouseenter="enter('6833875387324148439');" onmouseout="out('6833875387324148439');" style=""> 880             // Add the screens specified by the items above                                              </span>
<span class="2978539432730983390" onmouseenter="enter('2978539432730983390');" onmouseout="out('2978539432730983390');" style=""> 881             Collections.sort(screenIds);                                                                 </span>
<span class="5419352211080831355" onmouseenter="enter('5419352211080831355');" onmouseout="out('5419352211080831355');" style=""> 882             int rank = 0;                                                                                </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 883             ContentValues values = new ContentValues();                                                  </span>
<span class="7152107230041712979" onmouseenter="enter('7152107230041712979');" onmouseout="out('7152107230041712979');" style=""> 884             for (Long id : screenIds) {                                                                  </span>
<span class="6295623415315599771" onmouseenter="enter('6295623415315599771');" onmouseout="out('6295623415315599771');" style=""> 885                 values.clear();                                                                          </span>
<span class="-3523466272369778299" onmouseenter="enter('-3523466272369778299');" onmouseout="out('-3523466272369778299');" style=""> 886                 values.put(LauncherSettings.WorkspaceScreens._ID, id);                                   </span>
<span class="-4819700644573994153" onmouseenter="enter('-4819700644573994153');" onmouseout="out('-4819700644573994153');" style=""> 887                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                         </span>
<span class="-7619796578683976012" onmouseenter="enter('-7619796578683976012');" onmouseout="out('-7619796578683976012');" style=""> 888                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values) &lt; 0) {             </span>
<span class="-4349241721568097596" onmouseenter="enter('-4349241721568097596');" onmouseout="out('-4349241721568097596');" style=""> 889                     throw new RuntimeException(&quot;Failed initialize screen table&quot;                          </span>
<span class="6358788983404305676" onmouseenter="enter('6358788983404305676');" onmouseout="out('6358788983404305676');" style=""> 890                             + &quot;from default layout&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 891                 }                                                                                        </span>
<span class="-39828730810908930" onmouseenter="enter('-39828730810908930');" onmouseout="out('-39828730810908930');" style=""> 892                 rank++;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 893             }                                                                                            </span>
<span  style=""> 894                                                                                                          </span>
<span class="-1496945990523812752" onmouseenter="enter('-1496945990523812752');" onmouseout="out('-1496945990523812752');" style=""> 895             // Ensure that the max ids are initialized                                                   </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 896             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style=""> 897             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span  style=""> 898                                                                                                          </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 899             return count;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 900         }                                                                                                </span>
<span  style=""> 901                                                                                                          </span>
<span class="725730754436415996" onmouseenter="enter('725730754436415996');" onmouseout="out('725730754436415996');" style=""> 902         private void migrateLauncher2Shortcuts(SQLiteDatabase db, Uri uri) {                             </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 903             final ContentResolver resolver = mContext.getContentResolver();                              </span>
<span class="-3774076673393313717" onmouseenter="enter('-3774076673393313717');" onmouseout="out('-3774076673393313717');" style=""> 904             Cursor c = null;                                                                             </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 905             int count = 0;                                                                               </span>
<span class="-3336839334240068207" onmouseenter="enter('-3336839334240068207');" onmouseout="out('-3336839334240068207');" style=""> 906             int curScreen = 0;                                                                           </span>
<span  style=""> 907                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 908             try {                                                                                        </span>
<span class="-9000085593458662527" onmouseenter="enter('-9000085593458662527');" onmouseout="out('-9000085593458662527');" style=""> 909                 c = resolver.query(uri, null, null, null, &quot;title ASC&quot;);                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 910             } catch (Exception e) {                                                                      </span>
<span class="-1642344425252950446" onmouseenter="enter('-1642344425252950446');" onmouseout="out('-1642344425252950446');" style=""> 911                 // Ignore                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 912             }                                                                                            </span>
<span  style=""> 913                                                                                                          </span>
<span class="-8364191572061005786" onmouseenter="enter('-8364191572061005786');" onmouseout="out('-8364191572061005786');" style=""> 914             // We already have a favorites database in the old provider                                  </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 915             if (c != null) {                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 916                 try {                                                                                    </span>
<span class="-7145577210477193493" onmouseenter="enter('-7145577210477193493');" onmouseout="out('-7145577210477193493');" style=""> 917                     if (c.getCount() &gt; 0) {                                                              </span>
<span class="574469590853725413" onmouseenter="enter('574469590853725413');" onmouseout="out('574469590853725413');" style=""> 918                         final int idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);     </span>
<span class="-3305857310034960574" onmouseenter="enter('-3305857310034960574');" onmouseout="out('-3305857310034960574');" style=""> 919                         final int intentIndex                                                            </span>
<span class="7354730669796853916" onmouseenter="enter('7354730669796853916');" onmouseout="out('7354730669796853916');" style=""> 920                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);            </span>
<span class="-5630883347545993547" onmouseenter="enter('-5630883347545993547');" onmouseout="out('-5630883347545993547');" style=""> 921                         final int titleIndex                                                             </span>
<span class="698330273931132471" onmouseenter="enter('698330273931132471');" onmouseout="out('698330273931132471');" style=""> 922                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);             </span>
<span class="-3330891132272232037" onmouseenter="enter('-3330891132272232037');" onmouseout="out('-3330891132272232037');" style=""> 923                         final int iconTypeIndex                                                          </span>
<span class="7801651150775381680" onmouseenter="enter('7801651150775381680');" onmouseout="out('7801651150775381680');" style=""> 924                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);         </span>
<span class="-1496515754016715409" onmouseenter="enter('-1496515754016715409');" onmouseout="out('-1496515754016715409');" style=""> 925                         final int iconIndex                                                              </span>
<span class="-6743710571640483882" onmouseenter="enter('-6743710571640483882');" onmouseout="out('-6743710571640483882');" style=""> 926                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);              </span>
<span class="-4968513115427762421" onmouseenter="enter('-4968513115427762421');" onmouseout="out('-4968513115427762421');" style=""> 927                         final int iconPackageIndex                                                       </span>
<span class="6406994869194943351" onmouseenter="enter('6406994869194943351');" onmouseout="out('6406994869194943351');" style=""> 928                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);      </span>
<span class="7917018656335895183" onmouseenter="enter('7917018656335895183');" onmouseout="out('7917018656335895183');" style=""> 929                         final int iconResourceIndex                                                      </span>
<span class="2805080254532821790" onmouseenter="enter('2805080254532821790');" onmouseout="out('2805080254532821790');" style=""> 930                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);     </span>
<span class="-4237567403763432926" onmouseenter="enter('-4237567403763432926');" onmouseout="out('-4237567403763432926');" style=""> 931                         final int containerIndex                                                         </span>
<span class="-5056484222025497452" onmouseenter="enter('-5056484222025497452');" onmouseout="out('-5056484222025497452');" style=""> 932                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);         </span>
<span class="-1231922168250187193" onmouseenter="enter('-1231922168250187193');" onmouseout="out('-1231922168250187193');" style=""> 933                         final int itemTypeIndex                                                          </span>
<span class="4225538929397018586" onmouseenter="enter('4225538929397018586');" onmouseout="out('4225538929397018586');" style=""> 934                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);         </span>
<span class="1886064968207935621" onmouseenter="enter('1886064968207935621');" onmouseout="out('1886064968207935621');" style=""> 935                         final int screenIndex                                                            </span>
<span class="5823358741192050359" onmouseenter="enter('5823358741192050359');" onmouseout="out('5823358741192050359');" style=""> 936                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);            </span>
<span class="148786652433469700" onmouseenter="enter('148786652433469700');" onmouseout="out('148786652433469700');" style=""> 937                         final int cellXIndex                                                             </span>
<span class="-2420213882448561608" onmouseenter="enter('-2420213882448561608');" onmouseout="out('-2420213882448561608');" style=""> 938                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);             </span>
<span class="7105291823960507491" onmouseenter="enter('7105291823960507491');" onmouseout="out('7105291823960507491');" style=""> 939                         final int cellYIndex                                                             </span>
<span class="570222995967736070" onmouseenter="enter('570222995967736070');" onmouseout="out('570222995967736070');" style=""> 940                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);             </span>
<span class="-6657516663903609513" onmouseenter="enter('-6657516663903609513');" onmouseout="out('-6657516663903609513');" style=""> 941                         final int uriIndex                                                               </span>
<span class="-7627325667289175305" onmouseenter="enter('-7627325667289175305');" onmouseout="out('-7627325667289175305');" style=""> 942                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);               </span>
<span class="3126191733073545935" onmouseenter="enter('3126191733073545935');" onmouseout="out('3126191733073545935');" style=""> 943                         final int displayModeIndex                                                       </span>
<span class="5824024113471232605" onmouseenter="enter('5824024113471232605');" onmouseout="out('5824024113471232605');" style=""> 944                                 = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);      </span>
<span class="6969636044710489163" onmouseenter="enter('6969636044710489163');" onmouseout="out('6969636044710489163');" style=""> 945                         final int profileIndex                                                           </span>
<span class="-4394079448083019726" onmouseenter="enter('-4394079448083019726');" onmouseout="out('-4394079448083019726');" style=""> 946                                 = c.getColumnIndex(LauncherSettings.Favorites.PROFILE_ID);               </span>
<span  style=""> 947                                                                                                          </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style=""> 948                         int i = 0;                                                                       </span>
<span class="3196084964022358374" onmouseenter="enter('3196084964022358374');" onmouseout="out('3196084964022358374');" style=""> 949                         int curX = 0;                                                                    </span>
<span class="-8919994129307273415" onmouseenter="enter('-8919994129307273415');" onmouseout="out('-8919994129307273415');" style=""> 950                         int curY = 0;                                                                    </span>
<span  style=""> 951                                                                                                          </span>
<span class="1185328747399966274" onmouseenter="enter('1185328747399966274');" onmouseout="out('1185328747399966274');" style=""> 952                         final LauncherAppState app = LauncherAppState.getInstance();                     </span>
<span class="7124839587395892858" onmouseenter="enter('7124839587395892858');" onmouseout="out('7124839587395892858');" style=""> 953                         final DeviceProfile grid = app.getDynamicGrid().getDeviceProfile();              </span>
<span class="690371396691664791" onmouseenter="enter('690371396691664791');" onmouseout="out('690371396691664791');" style=""> 954                         final int width = (int) grid.numColumns;                                         </span>
<span class="-5064901428253886355" onmouseenter="enter('-5064901428253886355');" onmouseout="out('-5064901428253886355');" style=""> 955                         final int height = (int) grid.numRows;                                           </span>
<span class="-4109722385928167056" onmouseenter="enter('-4109722385928167056');" onmouseout="out('-4109722385928167056');" style=""> 956                         final int hotseatWidth = (int) grid.numHotseatIcons;                             </span>
<span  style=""> 957                                                                                                          </span>
<span class="-4392487977825691924" onmouseenter="enter('-4392487977825691924');" onmouseout="out('-4392487977825691924');" style=""> 958                         final HashSet&lt;String&gt; seenIntents = new HashSet&lt;String&gt;(c.getCount());           </span>
<span  style=""> 959                                                                                                          </span>
<span class="-1775881703038933069" onmouseenter="enter('-1775881703038933069');" onmouseout="out('-1775881703038933069');" style=""> 960                         final ArrayList&lt;ContentValues&gt; shortcuts = new ArrayList&lt;ContentValues&gt;();       </span>
<span class="-5282219486258454454" onmouseenter="enter('-5282219486258454454');" onmouseout="out('-5282219486258454454');" style=""> 961                         final ArrayList&lt;ContentValues&gt; folders = new ArrayList&lt;ContentValues&gt;();         </span>
<span class="7748304206224281059" onmouseenter="enter('7748304206224281059');" onmouseout="out('7748304206224281059');" style=""> 962                         final SparseArray&lt;ContentValues&gt; hotseat = new SparseArray&lt;ContentValues&gt;();     </span>
<span  style=""> 963                                                                                                          </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 964                         while (c.moveToNext()) {                                                         </span>
<span class="-2982692859195643614" onmouseenter="enter('-2982692859195643614');" onmouseout="out('-2982692859195643614');" style=""> 965                             final int itemType = c.getInt(itemTypeIndex);                                </span>
<span class="-7155300134759553393" onmouseenter="enter('-7155300134759553393');" onmouseout="out('-7155300134759553393');" style=""> 966                             if (itemType != Favorites.ITEM_TYPE_APPLICATION                              </span>
<span class="-6505147694408678007" onmouseenter="enter('-6505147694408678007');" onmouseout="out('-6505147694408678007');" style=""> 967                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_SHORTCUT                          </span>
<span class="-1211279440538129484" onmouseenter="enter('-1211279440538129484');" onmouseout="out('-1211279440538129484');" style=""> 968                                     &amp;&amp; itemType != Favorites.ITEM_TYPE_FOLDER) {                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 969                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 970                             }                                                                            </span>
<span  style=""> 971                                                                                                          </span>
<span class="6546086433507254477" onmouseenter="enter('6546086433507254477');" onmouseout="out('6546086433507254477');" style=""> 972                             final int cellX = c.getInt(cellXIndex);                                      </span>
<span class="-5848765603231722693" onmouseenter="enter('-5848765603231722693');" onmouseout="out('-5848765603231722693');" style=""> 973                             final int cellY = c.getInt(cellYIndex);                                      </span>
<span class="5057139106655212954" onmouseenter="enter('5057139106655212954');" onmouseout="out('5057139106655212954');" style=""> 974                             final int screen = c.getInt(screenIndex);                                    </span>
<span class="-6682259384170717005" onmouseenter="enter('-6682259384170717005');" onmouseout="out('-6682259384170717005');" style=""> 975                             int container = c.getInt(containerIndex);                                    </span>
<span class="-3517014905521526588" onmouseenter="enter('-3517014905521526588');" onmouseout="out('-3517014905521526588');" style=""> 976                             final String intentStr = c.getString(intentIndex);                           </span>
<span  style=""> 977                                                                                                          </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 978                             UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);     </span>
<span class="7210862209025052290" onmouseenter="enter('7210862209025052290');" onmouseout="out('7210862209025052290');" style=""> 979                             UserHandleCompat userHandle;                                                 </span>
<span class="-704754462563124721" onmouseenter="enter('-704754462563124721');" onmouseout="out('-704754462563124721');" style=""> 980                             final long userSerialNumber;                                                 </span>
<span class="-3188525411347809180" onmouseenter="enter('-3188525411347809180');" onmouseout="out('-3188525411347809180');" style=""> 981                             if (profileIndex != -1 &amp;&amp; !c.isNull(profileIndex)) {                         </span>
<span class="3377600326593357797" onmouseenter="enter('3377600326593357797');" onmouseout="out('3377600326593357797');" style=""> 982                                 userSerialNumber = c.getInt(profileIndex);                               </span>
<span class="-5580723935665666817" onmouseenter="enter('-5580723935665666817');" onmouseout="out('-5580723935665666817');" style=""> 983                                 userHandle = userManager.getUserForSerialNumber(userSerialNumber);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 984                             } else {                                                                     </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 985                                 // Default to the serial number of this user, for older                  </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 986                                 // shortcuts.                                                            </span>
<span class="153827185233038497" onmouseenter="enter('153827185233038497');" onmouseout="out('153827185233038497');" style=""> 987                                 userHandle = UserHandleCompat.myUserHandle();                            </span>
<span class="-7992210937529459410" onmouseenter="enter('-7992210937529459410');" onmouseout="out('-7992210937529459410');" style=""> 988                                 userSerialNumber = userManager.getSerialNumberForUser(userHandle);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 989                             }                                                                            </span>
<span  style=""> 990                                                                                                          </span>
<span class="-5734975396466070409" onmouseenter="enter('-5734975396466070409');" onmouseout="out('-5734975396466070409');" style=""> 991                             if (userHandle == null) {                                                    </span>
<span class="8825647937501871391" onmouseenter="enter('8825647937501871391');" onmouseout="out('8825647937501871391');" style=""> 992                                 Launcher.addDumpLog(TAG, &quot;skipping deleted user&quot;, true);                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 993                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 994                             }                                                                            </span>
<span  style=""> 995                                                                                                          </span>
<span class="-8522267007848438017" onmouseenter="enter('-8522267007848438017');" onmouseout="out('-8522267007848438017');" style=""> 996                             Launcher.addDumpLog(TAG, &quot;migrating \&quot;&quot;                                      </span>
<span class="5716371482803525639" onmouseenter="enter('5716371482803525639');" onmouseout="out('5716371482803525639');" style=""> 997                                 + c.getString(titleIndex) + &quot;\&quot; (&quot;                                       </span>
<span class="1581718899431916610" onmouseenter="enter('1581718899431916610');" onmouseout="out('1581718899431916610');" style=""> 998                                 + cellX + &quot;,&quot; + cellY + &quot;@&quot;                                              </span>
<span class="-5433460809722614707" onmouseenter="enter('-5433460809722614707');" onmouseout="out('-5433460809722614707');" style=""> 999                                 + LauncherSettings.Favorites.containerToString(container)                </span>
<span class="7963207375316982791" onmouseenter="enter('7963207375316982791');" onmouseout="out('7963207375316982791');" style="">1000                                 + &quot;/&quot; + screen                                                           </span>
<span class="6018191721230485089" onmouseenter="enter('6018191721230485089');" onmouseout="out('6018191721230485089');" style="">1001                                 + &quot;): &quot; + intentStr, true);                                              </span>
<span  style="">1002                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1003                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span  style="">1004                                                                                                          </span>
<span class="-3217378244605518341" onmouseenter="enter('-3217378244605518341');" onmouseout="out('-3217378244605518341');" style="">1005                                 final Intent intent;                                                     </span>
<span class="-6604091625193940309" onmouseenter="enter('-6604091625193940309');" onmouseout="out('-6604091625193940309');" style="">1006                                 final ComponentName cn;                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1007                                 try {                                                                    </span>
<span class="-5300012287142621419" onmouseenter="enter('-5300012287142621419');" onmouseout="out('-5300012287142621419');" style="">1008                                     intent = Intent.parseUri(intentStr, 0);                              </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style="">1009                                 } catch (URISyntaxException e) {                                         </span>
<span class="4944972948248133238" onmouseenter="enter('4944972948248133238');" onmouseout="out('4944972948248133238');" style="">1010                                     // bogus intent?                                                     </span>
<span class="8337166236749198483" onmouseenter="enter('8337166236749198483');" onmouseout="out('8337166236749198483');" style="">1011                                     Launcher.addDumpLog(TAG,                                             </span>
<span class="7306432149085172440" onmouseenter="enter('7306432149085172440');" onmouseout="out('7306432149085172440');" style="">1012                                             &quot;skipping invalid intent uri&quot;, true);                        </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1013                                     continue;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1014                                 }                                                                        </span>
<span  style="">1015                                                                                                          </span>
<span class="6421562153709548736" onmouseenter="enter('6421562153709548736');" onmouseout="out('6421562153709548736');" style="">1016                                 cn = intent.getComponent();                                              </span>
<span class="1165574592669081424" onmouseenter="enter('1165574592669081424');" onmouseout="out('1165574592669081424');" style="">1017                                 if (TextUtils.isEmpty(intentStr)) {                                      </span>
<span class="1109263052506568546" onmouseenter="enter('1109263052506568546');" onmouseout="out('1109263052506568546');" style="">1018                                     // no intent? no icon                                                </span>
<span class="-2999961336534157526" onmouseenter="enter('-2999961336534157526');" onmouseout="out('-2999961336534157526');" style="">1019                                     Launcher.addDumpLog(TAG, &quot;skipping empty intent&quot;, true);             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1020                                     continue;                                                            </span>
<span class="-9117039092771941538" onmouseenter="enter('-9117039092771941538');" onmouseout="out('-9117039092771941538');" style="">1021                                 } else if (cn != null &amp;&amp;                                                 </span>
<span class="-3538782463140269707" onmouseenter="enter('-3538782463140269707');" onmouseout="out('-3538782463140269707');" style="">1022                                         !LauncherModel.isValidPackageActivity(mContext, cn,              </span>
<span class="2012568974631198883" onmouseenter="enter('2012568974631198883');" onmouseout="out('2012568974631198883');" style="">1023                                                 userHandle)) {                                           </span>
<span class="-8462735888325815955" onmouseenter="enter('-8462735888325815955');" onmouseout="out('-8462735888325815955');" style="">1024                                     // component no longer exists.                                       </span>
<span class="8244127631099782564" onmouseenter="enter('8244127631099782564');" onmouseout="out('8244127631099782564');" style="">1025                                     Launcher.addDumpLog(TAG, &quot;skipping item whose component &quot; +          </span>
<span class="-2271033079359571531" onmouseenter="enter('-2271033079359571531');" onmouseout="out('-2271033079359571531');" style="">1026                                             &quot;no longer exists.&quot;, true);                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1027                                     continue;                                                            </span>
<span class="1808399553142797413" onmouseenter="enter('1808399553142797413');" onmouseout="out('1808399553142797413');" style="">1028                                 } else if (container ==                                                  </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1029                                         LauncherSettings.Favorites.CONTAINER_DESKTOP) {                  </span>
<span class="-6651088913311152009" onmouseenter="enter('-6651088913311152009');" onmouseout="out('-6651088913311152009');" style="">1030                                     // Dedupe icons directly on the workspace                            </span>
<span  style="">1031                                                                                                          </span>
<span class="-7857209544272892433" onmouseenter="enter('-7857209544272892433');" onmouseout="out('-7857209544272892433');" style="">1032                                     // Canonicalize                                                      </span>
<span class="-8986671765649789370" onmouseenter="enter('-8986671765649789370');" onmouseout="out('-8986671765649789370');" style="">1033                                     // the Play Store sets the package parameter, but Launcher           </span>
<span class="-2685712344279555181" onmouseenter="enter('-2685712344279555181');" onmouseout="out('-2685712344279555181');" style="">1034                                     // does not, so we clear that out to keep them the same.             </span>
<span class="-1462576698638737516" onmouseenter="enter('-1462576698638737516');" onmouseout="out('-1462576698638737516');" style="">1035                                     // Also ignore intent flags for the purposes of deduping.            </span>
<span class="-3363694106044374937" onmouseenter="enter('-3363694106044374937');" onmouseout="out('-3363694106044374937');" style="">1036                                     intent.setPackage(null);                                             </span>
<span class="-3409071973040894037" onmouseenter="enter('-3409071973040894037');" onmouseout="out('-3409071973040894037');" style="">1037                                     int flags = intent.getFlags();                                       </span>
<span class="547103070058811611" onmouseenter="enter('547103070058811611');" onmouseout="out('547103070058811611');" style="">1038                                     intent.setFlags(0);                                                  </span>
<span class="-947990318544641084" onmouseenter="enter('-947990318544641084');" onmouseout="out('-947990318544641084');" style="">1039                                     final String key = intent.toUri(0);                                  </span>
<span class="-7327331133269780521" onmouseenter="enter('-7327331133269780521');" onmouseout="out('-7327331133269780521');" style="">1040                                     intent.setFlags(flags);                                              </span>
<span class="7480204102005082432" onmouseenter="enter('7480204102005082432');" onmouseout="out('7480204102005082432');" style="">1041                                     if (seenIntents.contains(key)) {                                     </span>
<span class="2006049222885589498" onmouseenter="enter('2006049222885589498');" onmouseout="out('2006049222885589498');" style="">1042                                         Launcher.addDumpLog(TAG, &quot;skipping duplicate&quot;, true);            </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1043                                         continue;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1044                                     } else {                                                             </span>
<span class="4653019047206831387" onmouseenter="enter('4653019047206831387');" onmouseout="out('4653019047206831387');" style="">1045                                         seenIntents.add(key);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1046                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1047                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1048                             }                                                                            </span>
<span  style="">1049                                                                                                          </span>
<span class="-3805379390248188389" onmouseenter="enter('-3805379390248188389');" onmouseout="out('-3805379390248188389');" style="">1050                             ContentValues values = new ContentValues(c.getColumnCount());                </span>
<span class="2787548740347733717" onmouseenter="enter('2787548740347733717');" onmouseout="out('2787548740347733717');" style="">1051                             values.put(LauncherSettings.Favorites._ID, c.getInt(idIndex));               </span>
<span class="4552396250235420866" onmouseenter="enter('4552396250235420866');" onmouseout="out('4552396250235420866');" style="">1052                             values.put(LauncherSettings.Favorites.INTENT, intentStr);                    </span>
<span class="3080545696092648727" onmouseenter="enter('3080545696092648727');" onmouseout="out('3080545696092648727');" style="">1053                             values.put(LauncherSettings.Favorites.TITLE, c.getString(titleIndex));       </span>
<span class="8877369206974054200" onmouseenter="enter('8877369206974054200');" onmouseout="out('8877369206974054200');" style="">1054                             values.put(LauncherSettings.Favorites.ICON_TYPE,                             </span>
<span class="8705323818259019594" onmouseenter="enter('8705323818259019594');" onmouseout="out('8705323818259019594');" style="">1055                                     c.getInt(iconTypeIndex));                                            </span>
<span class="3857475807367449049" onmouseenter="enter('3857475807367449049');" onmouseout="out('3857475807367449049');" style="">1056                             values.put(LauncherSettings.Favorites.ICON, c.getBlob(iconIndex));           </span>
<span class="-7054095546130863513" onmouseenter="enter('-7054095546130863513');" onmouseout="out('-7054095546130863513');" style="">1057                             values.put(LauncherSettings.Favorites.ICON_PACKAGE,                          </span>
<span class="-4377124255190457588" onmouseenter="enter('-4377124255190457588');" onmouseout="out('-4377124255190457588');" style="">1058                                     c.getString(iconPackageIndex));                                      </span>
<span class="7491883888231273974" onmouseenter="enter('7491883888231273974');" onmouseout="out('7491883888231273974');" style="">1059                             values.put(LauncherSettings.Favorites.ICON_RESOURCE,                         </span>
<span class="-14487948683300389" onmouseenter="enter('-14487948683300389');" onmouseout="out('-14487948683300389');" style="">1060                                     c.getString(iconResourceIndex));                                     </span>
<span class="5180659022499168410" onmouseenter="enter('5180659022499168410');" onmouseout="out('5180659022499168410');" style="">1061                             values.put(LauncherSettings.Favorites.ITEM_TYPE, itemType);                  </span>
<span class="2567875359902744917" onmouseenter="enter('2567875359902744917');" onmouseout="out('2567875359902744917');" style="">1062                             values.put(LauncherSettings.Favorites.APPWIDGET_ID, -1);                     </span>
<span class="-3897523412202294315" onmouseenter="enter('-3897523412202294315');" onmouseout="out('-3897523412202294315');" style="">1063                             values.put(LauncherSettings.Favorites.URI, c.getString(uriIndex));           </span>
<span class="8253479465859182990" onmouseenter="enter('8253479465859182990');" onmouseout="out('8253479465859182990');" style="">1064                             values.put(LauncherSettings.Favorites.DISPLAY_MODE,                          </span>
<span class="-8416795076296111227" onmouseenter="enter('-8416795076296111227');" onmouseout="out('-8416795076296111227');" style="">1065                                     c.getInt(displayModeIndex));                                         </span>
<span class="-1880957120536425376" onmouseenter="enter('-1880957120536425376');" onmouseout="out('-1880957120536425376');" style="">1066                             values.put(LauncherSettings.Favorites.PROFILE_ID, userSerialNumber);         </span>
<span  style="">1067                                                                                                          </span>
<span class="-216205184326719357" onmouseenter="enter('-216205184326719357');" onmouseout="out('-216205184326719357');" style="">1068                             if (container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {             </span>
<span class="2845166931909672251" onmouseenter="enter('2845166931909672251');" onmouseout="out('2845166931909672251');" style="">1069                                 hotseat.put(screen, values);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1070                             }                                                                            </span>
<span  style="">1071                                                                                                          </span>
<span class="-8534427976726701331" onmouseenter="enter('-8534427976726701331');" onmouseout="out('-8534427976726701331');" style="">1072                             if (container != LauncherSettings.Favorites.CONTAINER_DESKTOP) {             </span>
<span class="3724214252155726452" onmouseenter="enter('3724214252155726452');" onmouseout="out('3724214252155726452');" style="">1073                                 // In a folder or in the hotseat, preserve position                      </span>
<span class="4993135311254983149" onmouseenter="enter('4993135311254983149');" onmouseout="out('4993135311254983149');" style="">1074                                 values.put(LauncherSettings.Favorites.SCREEN, screen);                   </span>
<span class="-7735658353589578952" onmouseenter="enter('-7735658353589578952');" onmouseout="out('-7735658353589578952');" style="">1075                                 values.put(LauncherSettings.Favorites.CELLX, cellX);                     </span>
<span class="-6596875348392322090" onmouseenter="enter('-6596875348392322090');" onmouseout="out('-6596875348392322090');" style="">1076                                 values.put(LauncherSettings.Favorites.CELLY, cellY);                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1077                             } else {                                                                     </span>
<span class="-6079732280628496127" onmouseenter="enter('-6079732280628496127');" onmouseout="out('-6079732280628496127');" style="">1078                                 // For items contained directly on one of the workspace screen,          </span>
<span class="-850513443108501253" onmouseenter="enter('-850513443108501253');" onmouseout="out('-850513443108501253');" style="">1079                                 // we&#x27;ll determine their location (screen, x, y) in a second pass.       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1080                             }                                                                            </span>
<span  style="">1081                                                                                                          </span>
<span class="7684212050113439789" onmouseenter="enter('7684212050113439789');" onmouseout="out('7684212050113439789');" style="">1082                             values.put(LauncherSettings.Favorites.CONTAINER, container);                 </span>
<span  style="">1083                                                                                                          </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1084                             if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                </span>
<span class="-7897547558000712151" onmouseenter="enter('-7897547558000712151');" onmouseout="out('-7897547558000712151');" style="">1085                                 shortcuts.add(values);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1086                             } else {                                                                     </span>
<span class="5214044302935278086" onmouseenter="enter('5214044302935278086');" onmouseout="out('5214044302935278086');" style="">1087                                 folders.add(values);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1088                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1089                         }                                                                                </span>
<span  style="">1090                                                                                                          </span>
<span class="3792333482677793462" onmouseenter="enter('3792333482677793462');" onmouseout="out('3792333482677793462');" style="">1091                         // Now that we have all the hotseat icons, let&#x27;s go through them left-right      </span>
<span class="6853065735140319510" onmouseenter="enter('6853065735140319510');" onmouseout="out('6853065735140319510');" style="">1092                         // and assign valid locations for them in the new hotseat                        </span>
<span class="-382900916992065291" onmouseenter="enter('-382900916992065291');" onmouseout="out('-382900916992065291');" style="">1093                         final int N = hotseat.size();                                                    </span>
<span class="9016073461123662191" onmouseenter="enter('9016073461123662191');" onmouseout="out('9016073461123662191');" style="">1094                         for (int idx=0; idx&lt;N; idx++) {                                                  </span>
<span class="-7027280347801461154" onmouseenter="enter('-7027280347801461154');" onmouseout="out('-7027280347801461154');" style="">1095                             int hotseatX = hotseat.keyAt(idx);                                           </span>
<span class="7267222979225491944" onmouseenter="enter('7267222979225491944');" onmouseout="out('7267222979225491944');" style="">1096                             ContentValues values = hotseat.valueAt(idx);                                 </span>
<span  style="">1097                                                                                                          </span>
<span class="-3018245694205955067" onmouseenter="enter('-3018245694205955067');" onmouseout="out('-3018245694205955067');" style="">1098                             if (hotseatX == grid.hotseatAllAppsRank) {                                   </span>
<span class="-8495735509078642350" onmouseenter="enter('-8495735509078642350');" onmouseout="out('-8495735509078642350');" style="">1099                                 // let&#x27;s drop this in the next available hole in the hotseat             </span>
<span class="-2055954181227443816" onmouseenter="enter('-2055954181227443816');" onmouseout="out('-2055954181227443816');" style="">1100                                 while (++hotseatX &lt; hotseatWidth) {                                      </span>
<span class="-5595819560409222327" onmouseenter="enter('-5595819560409222327');" onmouseout="out('-5595819560409222327');" style="">1101                                     if (hotseat.get(hotseatX) == null) {                                 </span>
<span class="2131484666649578366" onmouseenter="enter('2131484666649578366');" onmouseout="out('2131484666649578366');" style="">1102                                         // found a spot! move it here                                    </span>
<span class="325808457439646533" onmouseenter="enter('325808457439646533');" onmouseout="out('325808457439646533');" style="">1103                                         values.put(LauncherSettings.Favorites.SCREEN,                    </span>
<span class="8014085861051867033" onmouseenter="enter('8014085861051867033');" onmouseout="out('8014085861051867033');" style="">1104                                                 hotseatX);                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1105                                         break;                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1106                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1107                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1108                             }                                                                            </span>
<span class="4361559665402156368" onmouseenter="enter('4361559665402156368');" onmouseout="out('4361559665402156368');" style="">1109                             if (hotseatX &gt;= hotseatWidth) {                                              </span>
<span class="198406244599777154" onmouseenter="enter('198406244599777154');" onmouseout="out('198406244599777154');" style="">1110                                 // no room for you in the hotseat? it&#x27;s off to the desktop with you      </span>
<span class="274548545061036766" onmouseenter="enter('274548545061036766');" onmouseout="out('274548545061036766');" style="">1111                                 values.put(LauncherSettings.Favorites.CONTAINER,                         </span>
<span class="951133373394890183" onmouseenter="enter('951133373394890183');" onmouseout="out('951133373394890183');" style="">1112                                            Favorites.CONTAINER_DESKTOP);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1113                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1114                         }                                                                                </span>
<span  style="">1115                                                                                                          </span>
<span class="4538029778921500049" onmouseenter="enter('4538029778921500049');" onmouseout="out('4538029778921500049');" style="">1116                         final ArrayList&lt;ContentValues&gt; allItems = new ArrayList&lt;ContentValues&gt;();        </span>
<span class="-4972040190483698817" onmouseenter="enter('-4972040190483698817');" onmouseout="out('-4972040190483698817');" style="">1117                         // Folders first                                                                 </span>
<span class="1607706518732535744" onmouseenter="enter('1607706518732535744');" onmouseout="out('1607706518732535744');" style="">1118                         allItems.addAll(folders);                                                        </span>
<span class="2106236708914116763" onmouseenter="enter('2106236708914116763');" onmouseout="out('2106236708914116763');" style="">1119                         // Then shortcuts                                                                </span>
<span class="-1250372864837547145" onmouseenter="enter('-1250372864837547145');" onmouseout="out('-1250372864837547145');" style="">1120                         allItems.addAll(shortcuts);                                                      </span>
<span  style="">1121                                                                                                          </span>
<span class="-2195882050879177813" onmouseenter="enter('-2195882050879177813');" onmouseout="out('-2195882050879177813');" style="">1122                         // Layout all the folders                                                        </span>
<span class="-252665973237041297" onmouseenter="enter('-252665973237041297');" onmouseout="out('-252665973237041297');" style="">1123                         for (ContentValues values: allItems) {                                           </span>
<span class="-6238460523304059987" onmouseenter="enter('-6238460523304059987');" onmouseout="out('-6238460523304059987');" style="">1124                             if (values.getAsInteger(LauncherSettings.Favorites.CONTAINER) !=             </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1125                                     LauncherSettings.Favorites.CONTAINER_DESKTOP) {                      </span>
<span class="4544740026899945117" onmouseenter="enter('4544740026899945117');" onmouseout="out('4544740026899945117');" style="">1126                                 // Hotseat items and folder items have already had their                 </span>
<span class="9061827072000509027" onmouseenter="enter('9061827072000509027');" onmouseout="out('9061827072000509027');" style="">1127                                 // location information set. Nothing to be done here.                    </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1128                                 continue;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1129                             }                                                                            </span>
<span class="851641135220662264" onmouseenter="enter('851641135220662264');" onmouseout="out('851641135220662264');" style="">1130                             values.put(LauncherSettings.Favorites.SCREEN, curScreen);                    </span>
<span class="-1049962748703223150" onmouseenter="enter('-1049962748703223150');" onmouseout="out('-1049962748703223150');" style="">1131                             values.put(LauncherSettings.Favorites.CELLX, curX);                          </span>
<span class="-5258025824110848668" onmouseenter="enter('-5258025824110848668');" onmouseout="out('-5258025824110848668');" style="">1132                             values.put(LauncherSettings.Favorites.CELLY, curY);                          </span>
<span class="1910082031532915038" onmouseenter="enter('1910082031532915038');" onmouseout="out('1910082031532915038');" style="">1133                             curX = (curX + 1) % width;                                                   </span>
<span class="-7155276018455302787" onmouseenter="enter('-7155276018455302787');" onmouseout="out('-7155276018455302787');" style="">1134                             if (curX == 0) {                                                             </span>
<span class="2376495568180329749" onmouseenter="enter('2376495568180329749');" onmouseout="out('2376495568180329749');" style="">1135                                 curY = (curY + 1);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1136                             }                                                                            </span>
<span class="-4531638622721531414" onmouseenter="enter('-4531638622721531414');" onmouseout="out('-4531638622721531414');" style="">1137                             // Leave the last row of icons blank on every screen                         </span>
<span class="-5543182397018270277" onmouseenter="enter('-5543182397018270277');" onmouseout="out('-5543182397018270277');" style="">1138                             if (curY == height - 1) {                                                    </span>
<span class="-6657705079427553715" onmouseenter="enter('-6657705079427553715');" onmouseout="out('-6657705079427553715');" style="">1139                                 curScreen = (int) generateNewScreenId();                                 </span>
<span class="4679043716901678926" onmouseenter="enter('4679043716901678926');" onmouseout="out('4679043716901678926');" style="">1140                                 curY = 0;                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1141                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1142                         }                                                                                </span>
<span  style="">1143                                                                                                          </span>
<span class="1853917526349173349" onmouseenter="enter('1853917526349173349');" onmouseout="out('1853917526349173349');" style="">1144                         if (allItems.size() &gt; 0) {                                                       </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1145                             db.beginTransaction();                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1146                             try {                                                                        </span>
<span class="-7256059133012813079" onmouseenter="enter('-7256059133012813079');" onmouseout="out('-7256059133012813079');" style="">1147                                 for (ContentValues row: allItems) {                                      </span>
<span class="3155601228699925770" onmouseenter="enter('3155601228699925770');" onmouseout="out('3155601228699925770');" style="">1148                                     if (row == null) continue;                                           </span>
<span class="-304018147606180100" onmouseenter="enter('-304018147606180100');" onmouseout="out('-304018147606180100');" style="">1149                                     if (dbInsertAndCheck(this, db, TABLE_FAVORITES, null, row)           </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1150                                             &lt; 0) {                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1151                                         return;                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1152                                     } else {                                                             </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style="">1153                                         count++;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1154                                     }                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1155                                 }                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1156                                 db.setTransactionSuccessful();                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1157                             } finally {                                                                  </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1158                                 db.endTransaction();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1159                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1160                         }                                                                                </span>
<span  style="">1161                                                                                                          </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1162                         db.beginTransaction();                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1163                         try {                                                                            </span>
<span class="-7150489321946493056" onmouseenter="enter('-7150489321946493056');" onmouseout="out('-7150489321946493056');" style="">1164                             for (i=0; i&lt;=curScreen; i++) {                                               </span>
<span class="7694375558102178162" onmouseenter="enter('7694375558102178162');" onmouseout="out('7694375558102178162');" style="">1165                                 final ContentValues values = new ContentValues();                        </span>
<span class="-5225632710651404139" onmouseenter="enter('-5225632710651404139');" onmouseout="out('-5225632710651404139');" style="">1166                                 values.put(LauncherSettings.WorkspaceScreens._ID, i);                    </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="">1167                                 values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);            </span>
<span class="-6007460446232002971" onmouseenter="enter('-6007460446232002971');" onmouseout="out('-6007460446232002971');" style="">1168                                 if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values)    </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1169                                         &lt; 0) {                                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1170                                     return;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1171                                 }                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1172                             }                                                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1173                             db.setTransactionSuccessful();                                               </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1174                         } finally {                                                                      </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1175                             db.endTransaction();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1176                         }                                                                                </span>
<span  style="">1177                                                                                                          </span>
<span class="3757730671360045414" onmouseenter="enter('3757730671360045414');" onmouseout="out('3757730671360045414');" style="">1178                         updateFolderItemsRank(db, false);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1179                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1180                 } finally {                                                                              </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1181                     c.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1182                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1183             }                                                                                            </span>
<span  style="">1184                                                                                                          </span>
<span class="-6182516414964240870" onmouseenter="enter('-6182516414964240870');" onmouseout="out('-6182516414964240870');" style="">1185             Launcher.addDumpLog(TAG, &quot;migrated &quot; + count + &quot; icons from Launcher2 into &quot;                 </span>
<span class="3301967416992773508" onmouseenter="enter('3301967416992773508');" onmouseout="out('3301967416992773508');" style="">1186                     + (curScreen+1) + &quot; screens&quot;, true);                                                 </span>
<span  style="">1187                                                                                                          </span>
<span class="3355055744209094121" onmouseenter="enter('3355055744209094121');" onmouseout="out('3355055744209094121');" style="">1188             // ensure that new screens are created to hold these icons                                   </span>
<span class="4167333916835222093" onmouseenter="enter('4167333916835222093');" onmouseout="out('4167333916835222093');" style="">1189             setFlagJustLoadedOldDb();                                                                    </span>
<span  style="">1190                                                                                                          </span>
<span class="2071167438564206442" onmouseenter="enter('2071167438564206442');" onmouseout="out('2071167438564206442');" style="">1191             // Update max IDs; very important since we just grabbed IDs from another database            </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1192             mMaxItemId = initializeMaxItemId(db);                                                        </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1193             mMaxScreenId = initializeMaxScreenId(db);                                                    </span>
<span class="-439077128883569126" onmouseenter="enter('-439077128883569126');" onmouseout="out('-439077128883569126');" style="">1194             if (LOGD) Log.d(TAG, &quot;mMaxItemId: &quot; + mMaxItemId + &quot; mMaxScreenId: &quot; + mMaxScreenId);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1195         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1196     }                                                                                                    </span>
<span  style="">1197                                                                                                          </span>
<span class="8465274381710394045" onmouseenter="enter('8465274381710394045');" onmouseout="out('8465274381710394045');" style="">1198     static class SqlArguments {                                                                          </span>
<span class="8122936482838815352" onmouseenter="enter('8122936482838815352');" onmouseout="out('8122936482838815352');" style="">1199         public final String table;                                                                       </span>
<span  style="">1200                                                                                                          </span>
<span class="5442590397567481633" onmouseenter="enter('5442590397567481633');" onmouseout="out('5442590397567481633');" style="">1201         public final String where;                                                                       </span>
<span  style="">1202                                                                                                          </span>
<span class="-2258632185412795279" onmouseenter="enter('-2258632185412795279');" onmouseout="out('-2258632185412795279');" style="">1203         public final String[] args;                                                                      </span>
<span  style="">1204                                                                                                          </span>
<span class="538735252304320137" onmouseenter="enter('538735252304320137');" onmouseout="out('538735252304320137');" style="">1205         SqlArguments(Uri url, String where, String[] args) {                                             </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1206             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1207                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="7181058370626512064" onmouseenter="enter('7181058370626512064');" onmouseout="out('7181058370626512064');" style="">1208                 this.where = where;                                                                      </span>
<span class="8688716567728705492" onmouseenter="enter('8688716567728705492');" onmouseout="out('8688716567728705492');" style="">1209                 this.args = args;                                                                        </span>
<span class="2325935358302734243" onmouseenter="enter('2325935358302734243');" onmouseout="out('2325935358302734243');" style="">1210             } else if (url.getPathSegments().size() != 2) {                                              </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1211                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="186586201607437821" onmouseenter="enter('186586201607437821');" onmouseout="out('186586201607437821');" style="">1212             } else if (!TextUtils.isEmpty(where)) {                                                      </span>
<span class="2785963644153593875" onmouseenter="enter('2785963644153593875');" onmouseout="out('2785963644153593875');" style="">1213                 throw new UnsupportedOperationException(&quot;WHERE clause not supported: &quot; + url);           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1214             } else {                                                                                     </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1215                 this.table = url.getPathSegments().get(0);                                               </span>
<span class="-834356181554398700" onmouseenter="enter('-834356181554398700');" onmouseout="out('-834356181554398700');" style="">1216                 this.where = &quot;_id=&quot; + ContentUris.parseId(url);                                          </span>
<span class="-7173439380439508667" onmouseenter="enter('-7173439380439508667');" onmouseout="out('-7173439380439508667');" style="">1217                 this.args = null;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1218             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1219         }                                                                                                </span>
<span  style="">1220                                                                                                          </span>
<span class="5705249208777482684" onmouseenter="enter('5705249208777482684');" onmouseout="out('5705249208777482684');" style="">1221         SqlArguments(Uri url) {                                                                          </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1222             if (url.getPathSegments().size() == 1) {                                                     </span>
<span class="-594585027826531892" onmouseenter="enter('-594585027826531892');" onmouseout="out('-594585027826531892');" style="">1223                 table = url.getPathSegments().get(0);                                                    </span>
<span class="3938761229458861077" onmouseenter="enter('3938761229458861077');" onmouseout="out('3938761229458861077');" style="">1224                 where = null;                                                                            </span>
<span class="8940401955607507518" onmouseenter="enter('8940401955607507518');" onmouseout="out('8940401955607507518');" style="">1225                 args = null;                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1226             } else {                                                                                     </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1227                 throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1228             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1229         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1230     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1231 }                                                                                                        </span>















































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="1710841298952644868" onmouseenter="enter('1710841298952644868');" onmouseout="out('1710841298952644868');" style="">   2   * Copyright (C) 2008 The Android Open Source Project                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">  17  package com.android.launcher3;                                                                                    </span>
<span  style="">  18                                                                                                                    </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">  19  import android.appwidget.AppWidgetHost;                                                                           </span>
<span class="8802236814006375919" onmouseenter="enter('8802236814006375919');" onmouseout="out('8802236814006375919');" style="">  20  import android.appwidget.AppWidgetManager;                                                                        </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">  21  import android.content.ComponentName;                                                                             </span>
<span class="550877806393279246" onmouseenter="enter('550877806393279246');" onmouseout="out('550877806393279246');" style="">  22  import android.content.ContentProvider;                                                                           </span>
<span class="3739800667450215943" onmouseenter="enter('3739800667450215943');" onmouseout="out('3739800667450215943');" style="">  23  import android.content.ContentProviderOperation;                                                                  </span>
<span class="-6369732601490611729" onmouseenter="enter('-6369732601490611729');" onmouseout="out('-6369732601490611729');" style="">  24  import android.content.ContentProviderResult;                                                                     </span>
<span class="6126857652515451632" onmouseenter="enter('6126857652515451632');" onmouseout="out('6126857652515451632');" style="">  25  import android.content.ContentResolver;                                                                           </span>
<span class="-9185307499822629" onmouseenter="enter('-9185307499822629');" onmouseout="out('-9185307499822629');" style="">  26  import android.content.ContentUris;                                                                               </span>
<span class="3127723864207259776" onmouseenter="enter('3127723864207259776');" onmouseout="out('3127723864207259776');" style="">  27  import android.content.ContentValues;                                                                             </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  28  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  29  import android.content.Intent;                                                                                    </span>
<span class="-4160670168441716907" onmouseenter="enter('-4160670168441716907');" onmouseout="out('-4160670168441716907');" style="">  30  import android.content.OperationApplicationException;                                                             </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  31  import android.content.SharedPreferences;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  32  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  33  import android.database.Cursor;                                                                                   </span>
<span class="5870833163231201789" onmouseenter="enter('5870833163231201789');" onmouseout="out('5870833163231201789');" style="">  34  import android.database.SQLException;                                                                             </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  35  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="6401548559697116088" onmouseenter="enter('6401548559697116088');" onmouseout="out('6401548559697116088');" style="">  36  import android.database.sqlite.SQLiteOpenHelper;                                                                  </span>
<span class="-1253510085600408435" onmouseenter="enter('-1253510085600408435');" onmouseout="out('-1253510085600408435');" style="">  37  import android.database.sqlite.SQLiteQueryBuilder;                                                                </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  38  import android.net.Uri;                                                                                           </span>
<span class="5635872676092141444" onmouseenter="enter('5635872676092141444');" onmouseout="out('5635872676092141444');" style="">  39  import android.os.StrictMode;                                                                                     </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  40  import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  41  import android.util.Log;                                                                                          </span>
<span class="-1076320969941752510" onmouseenter="enter('-1076320969941752510');" onmouseout="out('-1076320969941752510');" style="">  42  import android.util.SparseArray;                                                                                  </span>
<span  style="">  43                                                                                                                    </span>
<span class="4395110202233918405" onmouseenter="enter('4395110202233918405');" onmouseout="out('4395110202233918405');" style="">  44  import com.android.launcher3.AutoInstallsLayout.LayoutParserCallback;                                             </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  45  import com.android.launcher3.LauncherSettings.Favorites;                                                          </span>
<span class="6372524458266053383" onmouseenter="enter('6372524458266053383');" onmouseout="out('6372524458266053383');" style="">  46  import com.android.launcher3.compat.UserHandleCompat;                                                             </span>
<span class="-8849211230761127863" onmouseenter="enter('-8849211230761127863');" onmouseout="out('-8849211230761127863');" style="">  47  import com.android.launcher3.compat.UserManagerCompat;                                                            </span>
<span class="-7468653447981916815" onmouseenter="enter('-7468653447981916815');" onmouseout="out('-7468653447981916815');" style="">  48  import com.android.launcher3.config.ProviderConfig;                                                               </span>
<span  style="">  49                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  50  import java.io.File;                                                                                              </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  51  import java.net.URISyntaxException;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  52  import java.util.ArrayList;                                                                                       </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53  import java.util.Collections;                                                                                     </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54  import java.util.HashSet;                                                                                         </span>
<span  style="">  55                                                                                                                    </span>
<span class="-5661310118425891821" onmouseenter="enter('-5661310118425891821');" onmouseout="out('-5661310118425891821');" style="">  56  public class LauncherProvider extends ContentProvider {                                                           </span>
<span class="-5301430442842506185" onmouseenter="enter('-5301430442842506185');" onmouseout="out('-5301430442842506185');" style="">  57      private static final String TAG = &quot;Launcher.LauncherProvider&quot;;                                                </span>
<span class="-8469384925954206736" onmouseenter="enter('-8469384925954206736');" onmouseout="out('-8469384925954206736');" style="">  58      private static final boolean LOGD = false;                                                                    </span>
<span  style="">  59                                                                                                                    </span>
<span class="8296161443463465713" onmouseenter="enter('8296161443463465713');" onmouseout="out('8296161443463465713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -    private static final int MIN_DATABASE_VERSION = 12;                                                           </span>
<span class="-4449901048814672092" onmouseenter="enter('-4449901048814672092');" onmouseout="out('-4449901048814672092');" style="">  61      private static final int DATABASE_VERSION = 21;                                                               </span>

<span  style="">  62                                                                                                                    </span>
<span class="-458478327704245810" onmouseenter="enter('-458478327704245810');" onmouseout="out('-458478327704245810');" style="">  63      static final String OLD_AUTHORITY = &quot;com.android.launcher2.settings&quot;;                                         </span>
<span class="-4376021050615906115" onmouseenter="enter('-4376021050615906115');" onmouseout="out('-4376021050615906115');" style="">  64      static final String AUTHORITY = ProviderConfig.AUTHORITY;                                                     </span>
<span  style="">  65                                                                                                                    </span>
<span class="-6626902943579202823" onmouseenter="enter('-6626902943579202823');" onmouseout="out('-6626902943579202823');" style="">  66      static final String TABLE_FAVORITES = &quot;favorites&quot;;                                                            </span>
<span class="-4121112267423691577" onmouseenter="enter('-4121112267423691577');" onmouseout="out('-4121112267423691577');" style="">  67      static final String TABLE_WORKSPACE_SCREENS = &quot;workspaceScreens&quot;;                                             </span>
<span class="5667619940348816611" onmouseenter="enter('5667619940348816611');" onmouseout="out('5667619940348816611');" style="">  68      static final String PARAMETER_NOTIFY = &quot;notify&quot;;                                                              </span>
<span class="-1986119061509854826" onmouseenter="enter('-1986119061509854826');" onmouseout="out('-1986119061509854826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -    static final String UPGRADED_FROM_OLD_DATABASE = &quot;UPGRADED_FROM_OLD_DATABASE&quot;;                                </span>
<span class="4313854869595882016" onmouseenter="enter('4313854869595882016');" onmouseout="out('4313854869595882016');" style="">  70      static final String EMPTY_DATABASE_CREATED = &quot;EMPTY_DATABASE_CREATED&quot;;                                        </span>
<span  style="">  71                                                                                                                    </span>
<span class="-254878042648191521" onmouseenter="enter('-254878042648191521');" onmouseout="out('-254878042648191521');" style="">  72      private static final String URI_PARAM_IS_EXTERNAL_ADD = &quot;isExternalAdd&quot;;                                      </span>
<span  style="">  73                                                                                                                    </span>
<span class="-4555445478569710276" onmouseenter="enter('-4555445478569710276');" onmouseout="out('-4555445478569710276');" style="">  74      private LauncherProviderChangeListener mListener;                                                             </span>
<span  style="">  75                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76      /**                                                                                                           </span>
<span class="-3211764681636990688" onmouseenter="enter('-3211764681636990688');" onmouseout="out('-3211764681636990688');" style="">  77       * {@link Uri} triggered at any registered {@link android.database.ContentObserver} when                      </span>
<span class="-4919300270466303234" onmouseenter="enter('-4919300270466303234');" onmouseout="out('-4919300270466303234');" style="">  78       * {@link AppWidgetHost#deleteHost()} is called during database creation.                                     </span>
<span class="-788325382909228329" onmouseenter="enter('-788325382909228329');" onmouseout="out('-788325382909228329');" style="">  79       * Use this to recall {@link AppWidgetHost#startListening()} if needed.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80       */                                                                                                           </span>
<span class="5515339483970246409" onmouseenter="enter('5515339483970246409');" onmouseout="out('5515339483970246409');" style="">  81      static final Uri CONTENT_APPWIDGET_RESET_URI =                                                                </span>
<span class="3194273355649806706" onmouseenter="enter('3194273355649806706');" onmouseout="out('3194273355649806706');" style="">  82              Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/appWidgetReset&quot;);                                              </span>
<span  style="">  83                                                                                                                    </span>
<span class="-35355205086145165" onmouseenter="enter('-35355205086145165');" onmouseout="out('-35355205086145165');" style="">  84      private DatabaseHelper mOpenHelper;                                                                           </span>
<span  style="">  85                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  86      @Override                                                                                                     </span>
<span class="5054121129922253104" onmouseenter="enter('5054121129922253104');" onmouseout="out('5054121129922253104');" style="">  87      public boolean onCreate() {                                                                                   </span>
<span class="4475688138331124962" onmouseenter="enter('4475688138331124962');" onmouseout="out('4475688138331124962');" style="">  88          final Context context = getContext();                                                                     </span>
<span class="-8005318937043312715" onmouseenter="enter('-8005318937043312715');" onmouseout="out('-8005318937043312715');" style="">  89          StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();                                   </span>
<span class="-7690576094790651842" onmouseenter="enter('-7690576094790651842');" onmouseout="out('-7690576094790651842');" style="">  90          mOpenHelper = new DatabaseHelper(context);                                                                </span>
<span class="-9120794859598568002" onmouseenter="enter('-9120794859598568002');" onmouseout="out('-9120794859598568002');" style="">  91          StrictMode.setThreadPolicy(oldPolicy);                                                                    </span>
<span class="-7305781479923559628" onmouseenter="enter('-7305781479923559628');" onmouseout="out('-7305781479923559628');" style="">  92          LauncherAppState.setLauncherProvider(this);                                                               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  93          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94      }                                                                                                             </span>
<span  style="">  95                                                                                                                    </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style="">  96      public boolean wasNewDbCreated() {                                                                            </span>
<span class="-2120364841155545874" onmouseenter="enter('-2120364841155545874');" onmouseout="out('-2120364841155545874');" style="">  97          return mOpenHelper.wasNewDbCreated();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98      }                                                                                                             </span>
<span  style="">  99                                                                                                                    </span>
<span class="9170464131639972057" onmouseenter="enter('9170464131639972057');" onmouseout="out('9170464131639972057');" style=""> 100      public void setLauncherProviderChangeListener(LauncherProviderChangeListener listener) {                      </span>
<span class="9132236250678632099" onmouseenter="enter('9132236250678632099');" onmouseout="out('9132236250678632099');" style=""> 101          mListener = listener;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102      }                                                                                                             </span>
<span  style=""> 103                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 104      @Override                                                                                                     </span>
<span class="-1263590755434456926" onmouseenter="enter('-1263590755434456926');" onmouseout="out('-1263590755434456926');" style=""> 105      public String getType(Uri uri) {                                                                              </span>
<span class="336598653403461328" onmouseenter="enter('336598653403461328');" onmouseout="out('336598653403461328');" style=""> 106          SqlArguments args = new SqlArguments(uri, null, null);                                                    </span>
<span class="-3811208733585118846" onmouseenter="enter('-3811208733585118846');" onmouseout="out('-3811208733585118846');" style=""> 107          if (TextUtils.isEmpty(args.where)) {                                                                      </span>
<span class="4564755247099008741" onmouseenter="enter('4564755247099008741');" onmouseout="out('4564755247099008741');" style=""> 108              return &quot;vnd.android.cursor.dir/&quot; + args.table;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 109          } else {                                                                                                  </span>
<span class="9039528378345344991" onmouseenter="enter('9039528378345344991');" onmouseout="out('9039528378345344991');" style=""> 110              return &quot;vnd.android.cursor.item/&quot; + args.table;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112      }                                                                                                             </span>
<span  style=""> 113                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 114      @Override                                                                                                     </span>
<span class="2688381462100157580" onmouseenter="enter('2688381462100157580');" onmouseout="out('2688381462100157580');" style=""> 115      public Cursor query(Uri uri, String[] projection, String selection,                                           </span>
<span class="-8080601171652713678" onmouseenter="enter('-8080601171652713678');" onmouseout="out('-8080601171652713678');" style=""> 116              String[] selectionArgs, String sortOrder) {                                                           </span>
<span  style=""> 117                                                                                                                    </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 118          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span class="-631518951729113636" onmouseenter="enter('-631518951729113636');" onmouseout="out('-631518951729113636');" style=""> 119          SQLiteQueryBuilder qb = new SQLiteQueryBuilder();                                                         </span>
<span class="2611293065726660593" onmouseenter="enter('2611293065726660593');" onmouseout="out('2611293065726660593');" style=""> 120          qb.setTables(args.table);                                                                                 </span>
<span  style=""> 121                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 122          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3134453170380441664" onmouseenter="enter('3134453170380441664');" onmouseout="out('3134453170380441664');" style=""> 123          Cursor result = qb.query(db, projection, args.where, args.args, null, null, sortOrder);                   </span>
<span class="-7763164457135943875" onmouseenter="enter('-7763164457135943875');" onmouseout="out('-7763164457135943875');" style=""> 124          result.setNotificationUri(getContext().getContentResolver(), uri);                                        </span>
<span  style=""> 125                                                                                                                    </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 126          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127      }                                                                                                             </span>
<span  style=""> 128                                                                                                                    </span>
<span class="9207797122534392164" onmouseenter="enter('9207797122534392164');" onmouseout="out('9207797122534392164');" style=""> 129      private static long dbInsertAndCheck(DatabaseHelper helper,                                                   </span>
<span class="-7649003652568167377" onmouseenter="enter('-7649003652568167377');" onmouseout="out('-7649003652568167377');" style=""> 130              SQLiteDatabase db, String table, String nullColumnHack, ContentValues values) {                       </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style=""> 131          if (values == null) {                                                                                     </span>
<span class="7184965589450928593" onmouseenter="enter('7184965589450928593');" onmouseout="out('7184965589450928593');" style=""> 132              throw new RuntimeException(&quot;Error: attempting to insert null values&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133          }                                                                                                         </span>
<span class="7050899094957739080" onmouseenter="enter('7050899094957739080');" onmouseout="out('7050899094957739080');" style=""> 134          if (!values.containsKey(LauncherSettings.ChangeLogColumns._ID)) {                                         </span>
<span class="492623150120761321" onmouseenter="enter('492623150120761321');" onmouseout="out('492623150120761321');" style=""> 135              throw new RuntimeException(&quot;Error: attempting to add item without specifying an id&quot;);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span class="-5706715493188407465" onmouseenter="enter('-5706715493188407465');" onmouseout="out('-5706715493188407465');" style=""> 137          helper.checkId(table, values);                                                                            </span>
<span class="1074556166740873719" onmouseenter="enter('1074556166740873719');" onmouseout="out('1074556166740873719');" style=""> 138          return db.insert(table, nullColumnHack, values);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139      }                                                                                                             </span>
<span  style=""> 140                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141      @Override                                                                                                     </span>
<span class="-734135164912880773" onmouseenter="enter('-734135164912880773');" onmouseout="out('-734135164912880773');" style=""> 142      public Uri insert(Uri uri, ContentValues initialValues) {                                                     </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 143          SqlArguments args = new SqlArguments(uri);                                                                </span>
<span  style=""> 144                                                                                                                    </span>
<span class="-8942992855752528468" onmouseenter="enter('-8942992855752528468');" onmouseout="out('-8942992855752528468');" style=""> 145          // In very limited cases, we support system|signature permission apps to add to the db                    </span>
<span class="8337919216215113797" onmouseenter="enter('8337919216215113797');" onmouseout="out('8337919216215113797');" style=""> 146          String externalAdd = uri.getQueryParameter(URI_PARAM_IS_EXTERNAL_ADD);                                    </span>
<span class="-2295815198673808272" onmouseenter="enter('-2295815198673808272');" onmouseout="out('-2295815198673808272');" style=""> 147          if (externalAdd != null &amp;&amp; &quot;true&quot;.equals(externalAdd)) {                                                  </span>
<span class="255159610270408066" onmouseenter="enter('255159610270408066');" onmouseout="out('255159610270408066');" style=""> 148              if (!mOpenHelper.initializeExternalAdd(initialValues)) {                                              </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 149                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151          }                                                                                                         </span>
<span  style=""> 152                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 153          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="-6358079444454153819" onmouseenter="enter('-6358079444454153819');" onmouseout="out('-6358079444454153819');" style=""> 154          addModifiedTime(initialValues);                                                                           </span>
<span class="5419112362953263362" onmouseenter="enter('5419112362953263362');" onmouseout="out('5419112362953263362');" style=""> 155          final long rowId = dbInsertAndCheck(mOpenHelper, db, args.table, null, initialValues);                    </span>
<span class="8445680939324035407" onmouseenter="enter('8445680939324035407');" onmouseout="out('8445680939324035407');" style=""> 156          if (rowId &lt;= 0) return null;                                                                              </span>
<span  style=""> 157                                                                                                                    </span>
<span class="8735878877349428813" onmouseenter="enter('8735878877349428813');" onmouseout="out('8735878877349428813');" style=""> 158          uri = ContentUris.withAppendedId(uri, rowId);                                                             </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 159          sendNotify(uri);                                                                                          </span>
<span  style=""> 160                                                                                                                    </span>
<span class="8673785246827833247" onmouseenter="enter('8673785246827833247');" onmouseout="out('8673785246827833247');" style=""> 161          return uri;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span  style=""> 164                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165      @Override                                                                                                     </span>
<span class="-327877481205905086" onmouseenter="enter('-327877481205905086');" onmouseout="out('-327877481205905086');" style=""> 166      public int bulkInsert(Uri uri, ContentValues[] values) {                                                      </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 167          SqlArguments args = new SqlArguments(uri);                                                                </span>
<span  style=""> 168                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 169          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 170          db.beginTransaction();                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 171          try {                                                                                                     </span>
<span class="7727596149598132072" onmouseenter="enter('7727596149598132072');" onmouseout="out('7727596149598132072');" style=""> 172              int numValues = values.length;                                                                        </span>
<span class="805790054769028067" onmouseenter="enter('805790054769028067');" onmouseout="out('805790054769028067');" style=""> 173              for (int i = 0; i &lt; numValues; i++) {                                                                 </span>
<span class="2678636525018066730" onmouseenter="enter('2678636525018066730');" onmouseout="out('2678636525018066730');" style=""> 174                  addModifiedTime(values[i]);                                                                       </span>
<span class="-5505203781899797586" onmouseenter="enter('-5505203781899797586');" onmouseout="out('-5505203781899797586');" style=""> 175                  if (dbInsertAndCheck(mOpenHelper, db, args.table, null, values[i]) &lt; 0) {                         </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 176                      return 0;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178              }                                                                                                     </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 179              db.setTransactionSuccessful();                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 180          } finally {                                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 181              db.endTransaction();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182          }                                                                                                         </span>
<span  style=""> 183                                                                                                                    </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 184          sendNotify(uri);                                                                                          </span>
<span class="6793841392205084718" onmouseenter="enter('6793841392205084718');" onmouseout="out('6793841392205084718');" style=""> 185          return values.length;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 188      @Override                                                                                                     </span>
<span class="5983754597853237276" onmouseenter="enter('5983754597853237276');" onmouseout="out('5983754597853237276');" style=""> 189      public ContentProviderResult[] applyBatch(ArrayList&lt;ContentProviderOperation&gt; operations)                     </span>
<span class="-5628895276830175510" onmouseenter="enter('-5628895276830175510');" onmouseout="out('-5628895276830175510');" style=""> 190              throws OperationApplicationException {                                                                </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 191          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 192          db.beginTransaction();                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 193          try {                                                                                                     </span>
<span class="3840622082470564062" onmouseenter="enter('3840622082470564062');" onmouseout="out('3840622082470564062');" style=""> 194              ContentProviderResult[] result =  super.applyBatch(operations);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 195              db.setTransactionSuccessful();                                                                        </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 196              return result;                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 197          } finally {                                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 198              db.endTransaction();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200      }                                                                                                             </span>
<span  style=""> 201                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 202      @Override                                                                                                     </span>
<span class="-6238796754049684603" onmouseenter="enter('-6238796754049684603');" onmouseout="out('-6238796754049684603');" style=""> 203      public int delete(Uri uri, String selection, String[] selectionArgs) {                                        </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 204          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span  style=""> 205                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 206          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="-848417512188045481" onmouseenter="enter('-848417512188045481');" onmouseout="out('-848417512188045481');" style=""> 207          int count = db.delete(args.table, args.where, args.args);                                                 </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 208          if (count &gt; 0) sendNotify(uri);                                                                           </span>
<span  style=""> 209                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 210          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211      }                                                                                                             </span>
<span  style=""> 212                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 213      @Override                                                                                                     </span>
<span class="-6200308159398621930" onmouseenter="enter('-6200308159398621930');" onmouseout="out('-6200308159398621930');" style=""> 214      public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {                  </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 215          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span  style=""> 216                                                                                                                    </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 217          addModifiedTime(values);                                                                                  </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 218          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="6692131291033480751" onmouseenter="enter('6692131291033480751');" onmouseout="out('6692131291033480751');" style=""> 219          int count = db.update(args.table, values, args.where, args.args);                                         </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 220          if (count &gt; 0) sendNotify(uri);                                                                           </span>
<span  style=""> 221                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 222          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223      }                                                                                                             </span>
<span  style=""> 224                                                                                                                    </span>
<span class="-6137155183451194640" onmouseenter="enter('-6137155183451194640');" onmouseout="out('-6137155183451194640');" style=""> 225      private void sendNotify(Uri uri) {                                                                            </span>
<span class="8087997420167282782" onmouseenter="enter('8087997420167282782');" onmouseout="out('8087997420167282782');" style=""> 226          String notify = uri.getQueryParameter(PARAMETER_NOTIFY);                                                  </span>
<span class="-1882364541416460726" onmouseenter="enter('-1882364541416460726');" onmouseout="out('-1882364541416460726');" style=""> 227          if (notify == null || &quot;true&quot;.equals(notify)) {                                                            </span>
<span class="-1009902495160891118" onmouseenter="enter('-1009902495160891118');" onmouseout="out('-1009902495160891118');" style=""> 228              getContext().getContentResolver().notifyChange(uri, null);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229          }                                                                                                         </span>
<span  style=""> 230                                                                                                                    </span>
<span class="-88474152060363663" onmouseenter="enter('-88474152060363663');" onmouseout="out('-88474152060363663');" style=""> 231          // always notify the backup agent                                                                         </span>
<span class="-4136841506633225478" onmouseenter="enter('-4136841506633225478');" onmouseout="out('-4136841506633225478');" style=""> 232          LauncherBackupAgentHelper.dataChanged(getContext());                                                      </span>
<span class="3660947493902737932" onmouseenter="enter('3660947493902737932');" onmouseout="out('3660947493902737932');" style=""> 233          if (mListener != null) {                                                                                  </span>
<span class="7178241373784368891" onmouseenter="enter('7178241373784368891');" onmouseout="out('7178241373784368891');" style=""> 234              mListener.onLauncherProviderChange();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236      }                                                                                                             </span>
<span  style=""> 237                                                                                                                    </span>
<span class="-1775729469739138676" onmouseenter="enter('-1775729469739138676');" onmouseout="out('-1775729469739138676');" style=""> 238      private void addModifiedTime(ContentValues values) {                                                          </span>

<span class="7778574075272931857" onmouseenter="enter('7778574075272931857');" onmouseout="out('7778574075272931857');" style=""> 239          values.put(LauncherSettings.ChangeLogColumns.MODIFIED, System.currentTimeMillis());                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240      }                                                                                                             </span>
<span  style=""> 241                                                                                                                    </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 242      public long generateNewItemId() {                                                                             </span>
<span class="4208143222012601660" onmouseenter="enter('4208143222012601660');" onmouseout="out('4208143222012601660');" style=""> 243          return mOpenHelper.generateNewItemId();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244      }                                                                                                             </span>
<span  style=""> 245                                                                                                                    </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 246      public void updateMaxItemId(long id) {                                                                        </span>
<span class="5887752252226734670" onmouseenter="enter('5887752252226734670');" onmouseout="out('5887752252226734670');" style=""> 247          mOpenHelper.updateMaxItemId(id);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248      }                                                                                                             </span>
<span  style=""> 249                                                                                                                    </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 250      public long generateNewScreenId() {                                                                           </span>
<span class="1793864293735992917" onmouseenter="enter('1793864293735992917');" onmouseout="out('1793864293735992917');" style=""> 251          return mOpenHelper.generateNewScreenId();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                                                                                                                  </span>
<span class="6930658551566435877" onmouseenter="enter('6930658551566435877');" onmouseout="out('6930658551566435877');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -    // This is only required one time while loading the workspace during the                                      </span>
<span class="-2970396193784752555" onmouseenter="enter('-2970396193784752555');" onmouseout="out('-2970396193784752555');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -    // upgrade path, and should never be called from anywhere else.                                               </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -    public void updateMaxScreenId(long maxScreenId) {                                                             </span>
<span class="1650077191565319140" onmouseenter="enter('1650077191565319140');" onmouseout="out('1650077191565319140');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -        mOpenHelper.updateMaxScreenId(maxScreenId);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258      }                                                                                                             </span>
<span  style=""> 259                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 260      /**                                                                                                           </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 261       * Clears all the data for a fresh start.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 262       */                                                                                                           </span>
<span class="-8979529877881539007" onmouseenter="enter('-8979529877881539007');" onmouseout="out('-8979529877881539007');" style=""> 263      synchronized public void createEmptyDB() {                                                                    </span>
<span class="-257404101089763384" onmouseenter="enter('-257404101089763384');" onmouseout="out('-257404101089763384');" style=""> 264          mOpenHelper.createEmptyDB(mOpenHelper.getWritableDatabase());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265      }                                                                                                             </span>
<span  style=""> 266                                                                                                                    </span>
<span class="6671122679064927328" onmouseenter="enter('6671122679064927328');" onmouseout="out('6671122679064927328');" style=""> 267      public void clearFlagEmptyDbCreated() {                                                                       </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 268          String spKey = LauncherAppState.getSharedPreferencesKey();                                                </span>
<span class="6603172609148556207" onmouseenter="enter('6603172609148556207');" onmouseout="out('6603172609148556207');" style=""> 269          getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE)                                            </span>
<span class="-4990178698661362372" onmouseenter="enter('-4990178698661362372');" onmouseout="out('-4990178698661362372');" style=""> 270              .edit()                                                                                               </span>
<span class="-4523663616686353798" onmouseenter="enter('-4523663616686353798');" onmouseout="out('-4523663616686353798');" style=""> 271              .remove(EMPTY_DATABASE_CREATED)                                                                       </span>
<span class="5746476506062343638" onmouseenter="enter('5746476506062343638');" onmouseout="out('5746476506062343638');" style=""> 272              .commit();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273      }                                                                                                             </span>
<span  style=""> 274                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 275      /**                                                                                                           </span>
<span class="277164340629859803" onmouseenter="enter('277164340629859803');" onmouseout="out('277164340629859803');" style=""> 276       * Loads the default workspace based on the following priority scheme:                                        </span>
<span class="6191061916552549057" onmouseenter="enter('6191061916552549057');" onmouseout="out('6191061916552549057');" style=""> 277       *   1) From a package provided by play store                                                                 </span>
<span class="-1458935321569433020" onmouseenter="enter('-1458935321569433020');" onmouseout="out('-1458935321569433020');" style=""> 278       *   2) From a partner configuration APK, already in the system image                                         </span>
<span class="-8497452292409790071" onmouseenter="enter('-8497452292409790071');" onmouseout="out('-8497452292409790071');" style=""> 279       *   3) The default configuration for the particular device                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 280       */                                                                                                           </span>
<span class="-4109341010907676070" onmouseenter="enter('-4109341010907676070');" onmouseout="out('-4109341010907676070');" style=""> 281      synchronized public void loadDefaultFavoritesIfNecessary() {                                                  </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 282          String spKey = LauncherAppState.getSharedPreferencesKey();                                                </span>
<span class="-1270995004093477684" onmouseenter="enter('-1270995004093477684');" onmouseout="out('-1270995004093477684');" style=""> 283          SharedPreferences sp = getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span  style=""> 284                                                                                                                    </span>
<span class="-1164862040405657048" onmouseenter="enter('-1164862040405657048');" onmouseout="out('-1164862040405657048');" style=""> 285          if (sp.getBoolean(EMPTY_DATABASE_CREATED, false)) {                                                       </span>
<span class="-3246698064640464314" onmouseenter="enter('-3246698064640464314');" onmouseout="out('-3246698064640464314');" style=""> 286              Log.d(TAG, &quot;loading default workspace&quot;);                                                              </span>
<span  style=""> 287                                                                                                                    </span>
<span class="7358984688962203192" onmouseenter="enter('7358984688962203192');" onmouseout="out('7358984688962203192');" style=""> 288              AutoInstallsLayout loader = AutoInstallsLayout.get(getContext(),                                      </span>
<span class="4267100487943846224" onmouseenter="enter('4267100487943846224');" onmouseout="out('4267100487943846224');" style=""> 289                      mOpenHelper.mAppWidgetHost, mOpenHelper);                                                     </span>
<span  style=""> 290                                                                                                                    </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 291              if (loader == null) {                                                                                 </span>
<span class="-7748100060285216458" onmouseenter="enter('-7748100060285216458');" onmouseout="out('-7748100060285216458');" style=""> 292                  final Partner partner = Partner.get(getContext().getPackageManager());                            </span>
<span class="-604675337449948556" onmouseenter="enter('-604675337449948556');" onmouseout="out('-604675337449948556');" style=""> 293                  if (partner != null &amp;&amp; partner.hasDefaultLayout()) {                                              </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 294                      final Resources partnerRes = partner.getResources();                                          </span>
<span class="4481789752192356250" onmouseenter="enter('4481789752192356250');" onmouseout="out('4481789752192356250');" style=""> 295                      int workspaceResId = partnerRes.getIdentifier(Partner.RES_DEFAULT_LAYOUT,                     </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 296                              &quot;xml&quot;, partner.getPackageName());                                                     </span>
<span class="-1442734434460802886" onmouseenter="enter('-1442734434460802886');" onmouseout="out('-1442734434460802886');" style=""> 297                      if (workspaceResId != 0) {                                                                    </span>
<span class="-624367766367819814" onmouseenter="enter('-624367766367819814');" onmouseout="out('-624367766367819814');" style=""> 298                          loader = new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                </span>
<span class="3991293503056578945" onmouseenter="enter('3991293503056578945');" onmouseout="out('3991293503056578945');" style=""> 299                                  mOpenHelper, partnerRes, workspaceResId);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302              }                                                                                                     </span>
<span  style=""> 303                                                                                                                    </span>
<span class="-1006525515535848907" onmouseenter="enter('-1006525515535848907');" onmouseout="out('-1006525515535848907');" style=""> 304              final boolean usingExternallyProvidedLayout = loader != null;                                         </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 305              if (loader == null) {                                                                                 </span>
<span class="-6937254959516916052" onmouseenter="enter('-6937254959516916052');" onmouseout="out('-6937254959516916052');" style=""> 306                  loader = getDefaultLayoutParser();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307              }                                                                                                     </span>
<span class="126045670500141" onmouseenter="enter('126045670500141');" onmouseout="out('126045670500141');" style=""> 308              // Populate favorites table with initial favorites                                                    </span>
<span class="8206837333293431906" onmouseenter="enter('8206837333293431906');" onmouseout="out('8206837333293431906');" style=""> 309              if ((mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(), loader) &lt;= 0)                       </span>
<span class="-363747028825236736" onmouseenter="enter('-363747028825236736');" onmouseout="out('-363747028825236736');" style=""> 310                      &amp;&amp; usingExternallyProvidedLayout) {                                                           </span>
<span class="-5734732948359842282" onmouseenter="enter('-5734732948359842282');" onmouseout="out('-5734732948359842282');" style=""> 311                  // Unable to load external layout. Cleanup and load the internal layout.                          </span>
<span class="5828098457627567319" onmouseenter="enter('5828098457627567319');" onmouseout="out('5828098457627567319');" style=""> 312                  createEmptyDB();                                                                                  </span>
<span class="-3956631052588999268" onmouseenter="enter('-3956631052588999268');" onmouseout="out('-3956631052588999268');" style=""> 313                  mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(),                                      </span>
<span class="5010356356580148690" onmouseenter="enter('5010356356580148690');" onmouseout="out('5010356356580148690');" style=""> 314                          getDefaultLayoutParser());                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315              }                                                                                                     </span>
<span class="-1774667578952654848" onmouseenter="enter('-1774667578952654848');" onmouseout="out('-1774667578952654848');" style=""> 316              clearFlagEmptyDbCreated();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318      }                                                                                                             </span>
<span  style=""> 319                                                                                                                    </span>
<span class="1869645688222446570" onmouseenter="enter('1869645688222446570');" onmouseout="out('1869645688222446570');" style=""> 320      private DefaultLayoutParser getDefaultLayoutParser() {                                                        </span>
<span class="-4358736250572585751" onmouseenter="enter('-4358736250572585751');" onmouseout="out('-4358736250572585751');" style=""> 321          int defaultLayout = LauncherAppState.getInstance()                                                        </span>
<span class="-3651315710070586527" onmouseenter="enter('-3651315710070586527');" onmouseout="out('-3651315710070586527');" style=""> 322                  .getDynamicGrid().getDeviceProfile().defaultLayoutId;                                             </span>
<span class="-4806143495772092322" onmouseenter="enter('-4806143495772092322');" onmouseout="out('-4806143495772092322');" style=""> 323          return new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                                  </span>
<span class="-4976455824453899875" onmouseenter="enter('-4976455824453899875');" onmouseout="out('-4976455824453899875');" style=""> 324                  mOpenHelper, getContext().getResources(), defaultLayout);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325      }                                                                                                             </span>
<span  style=""> 326                                                                                                                    </span>
<span class="-8499205643032210495" onmouseenter="enter('-8499205643032210495');" onmouseout="out('-8499205643032210495');" style=""> 327      public void migrateLauncher2Shortcuts() {                                                                     </span>
<span class="-5770271076267441053" onmouseenter="enter('-5770271076267441053');" onmouseout="out('-5770271076267441053');" style=""> 328          mOpenHelper.migrateLauncher2Shortcuts(mOpenHelper.getWritableDatabase(),                                  </span>
<span class="-4855681120160555012" onmouseenter="enter('-4855681120160555012');" onmouseout="out('-4855681120160555012');" style=""> 329                  Uri.parse(getContext().getString(R.string.old_launcher_provider_uri)));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330      }                                                                                                             </span>
<span  style=""> 331                                                                                                                    </span>
<span class="-5196105730574921781" onmouseenter="enter('-5196105730574921781');" onmouseout="out('-5196105730574921781');" style=""> 332      public void updateFolderItemsRank() {                                                                         </span>
<span class="4982456805094611516" onmouseenter="enter('4982456805094611516');" onmouseout="out('4982456805094611516');" style=""> 333          mOpenHelper.updateFolderItemsRank(mOpenHelper.getWritableDatabase(), false);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334      }                                                                                                             </span>
<span  style=""> 335                                                                                                                    </span>
<span class="-7861087353469194327" onmouseenter="enter('-7861087353469194327');" onmouseout="out('-7861087353469194327');" style=""> 336      public void deleteDatabase() {                                                                                </span>
<span class="-3081120555997572478" onmouseenter="enter('-3081120555997572478');" onmouseout="out('-3081120555997572478');" style=""> 337          // Are you sure? (y/n)                                                                                    </span>
<span class="7599905409028339447" onmouseenter="enter('7599905409028339447');" onmouseout="out('7599905409028339447');" style=""> 338          final SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                              </span>
<span class="4824670475834221257" onmouseenter="enter('4824670475834221257');" onmouseout="out('4824670475834221257');" style=""> 339          final File dbFile = new File(db.getPath());                                                               </span>
<span class="-4378932496508441297" onmouseenter="enter('-4378932496508441297');" onmouseout="out('-4378932496508441297');" style=""> 340          mOpenHelper.close();                                                                                      </span>
<span class="-2168275612742463412" onmouseenter="enter('-2168275612742463412');" onmouseout="out('-2168275612742463412');" style=""> 341          if (dbFile.exists()) {                                                                                    </span>
<span class="7055278701412747697" onmouseenter="enter('7055278701412747697');" onmouseout="out('7055278701412747697');" style=""> 342              SQLiteDatabase.deleteDatabase(dbFile);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343          }                                                                                                         </span>
<span class="1429708216911350032" onmouseenter="enter('1429708216911350032');" onmouseout="out('1429708216911350032');" style=""> 344          mOpenHelper = new DatabaseHelper(getContext());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345      }                                                                                                             </span>
<span  style=""> 346                                                                                                                    </span>
<span class="-8073014385313712586" onmouseenter="enter('-8073014385313712586');" onmouseout="out('-8073014385313712586');" style=""> 347      private static class DatabaseHelper extends SQLiteOpenHelper implements LayoutParserCallback {                </span>
<span class="-2672328117217234149" onmouseenter="enter('-2672328117217234149');" onmouseout="out('-2672328117217234149');" style=""> 348          private final Context mContext;                                                                           </span>
<span class="-7815254415381208754" onmouseenter="enter('-7815254415381208754');" onmouseout="out('-7815254415381208754');" style=""> 349          private final AppWidgetHost mAppWidgetHost;                                                               </span>
<span class="256431113711786954" onmouseenter="enter('256431113711786954');" onmouseout="out('256431113711786954');" style=""> 350          private long mMaxItemId = -1;                                                                             </span>
<span class="3024521003496490102" onmouseenter="enter('3024521003496490102');" onmouseout="out('3024521003496490102');" style=""> 351          private long mMaxScreenId = -1;                                                                           </span>
<span  style=""> 352                                                                                                                    </span>
<span class="7342788129695687690" onmouseenter="enter('7342788129695687690');" onmouseout="out('7342788129695687690');" style=""> 353          private boolean mNewDbCreated = false;                                                                    </span>
<span  style=""> 354                                                                                                                    </span>
<span class="1000156088447424124" onmouseenter="enter('1000156088447424124');" onmouseout="out('1000156088447424124');" style=""> 355          DatabaseHelper(Context context) {                                                                         </span>
<span class="5450204288644697643" onmouseenter="enter('5450204288644697643');" onmouseout="out('5450204288644697643');" style=""> 356              super(context, LauncherFiles.LAUNCHER_DB, null, DATABASE_VERSION);                                    </span>
<span class="7260904205784329196" onmouseenter="enter('7260904205784329196');" onmouseout="out('7260904205784329196');" style=""> 357              mContext = context;                                                                                   </span>
<span class="6731257549223913473" onmouseenter="enter('6731257549223913473');" onmouseout="out('6731257549223913473');" style=""> 358              mAppWidgetHost = new AppWidgetHost(context, Launcher.APPWIDGET_HOST_ID);                              </span>
<span  style=""> 359                                                                                                                    </span>
<span class="-7119307471557363464" onmouseenter="enter('-7119307471557363464');" onmouseout="out('-7119307471557363464');" style=""> 360              // In the case where neither onCreate nor onUpgrade gets called, we read the maxId from               </span>
<span class="-7146491614936969963" onmouseenter="enter('-7146491614936969963');" onmouseout="out('-7146491614936969963');" style=""> 361              // the DB here                                                                                        </span>
<span class="-8239698715373110075" onmouseenter="enter('-8239698715373110075');" onmouseout="out('-8239698715373110075');" style=""> 362              if (mMaxItemId == -1) {                                                                               </span>
<span class="6514208419145701418" onmouseenter="enter('6514208419145701418');" onmouseout="out('6514208419145701418');" style=""> 363                  mMaxItemId = initializeMaxItemId(getWritableDatabase());                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364              }                                                                                                     </span>
<span class="2158219101093277292" onmouseenter="enter('2158219101093277292');" onmouseout="out('2158219101093277292');" style=""> 365              if (mMaxScreenId == -1) {                                                                             </span>
<span class="-7197865417052699646" onmouseenter="enter('-7197865417052699646');" onmouseout="out('-7197865417052699646');" style=""> 366                  mMaxScreenId = initializeMaxScreenId(getWritableDatabase());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368          }                                                                                                         </span>
<span  style=""> 369                                                                                                                    </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 370          public boolean wasNewDbCreated() {                                                                        </span>
<span class="1294520975679493300" onmouseenter="enter('1294520975679493300');" onmouseout="out('1294520975679493300');" style=""> 371              return mNewDbCreated;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372          }                                                                                                         </span>
<span  style=""> 373                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 374          /**                                                                                                       </span>
<span class="-3713204910685876719" onmouseenter="enter('-3713204910685876719');" onmouseout="out('-3713204910685876719');" style=""> 375           * Send notification that we&#x27;ve deleted the {@link AppWidgetHost},                                        </span>
<span class="-5398164636189778479" onmouseenter="enter('-5398164636189778479');" onmouseout="out('-5398164636189778479');" style=""> 376           * probably as part of the initial database creation. The receiver may                                    </span>
<span class="-284834762183367019" onmouseenter="enter('-284834762183367019');" onmouseout="out('-284834762183367019');" style=""> 377           * want to re-call {@link AppWidgetHost#startListening()} to ensure                                       </span>
<span class="1913597860538764992" onmouseenter="enter('1913597860538764992');" onmouseout="out('1913597860538764992');" style=""> 378           * callbacks are correctly set.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 379           */                                                                                                       </span>
<span class="3384745401314169661" onmouseenter="enter('3384745401314169661');" onmouseout="out('3384745401314169661');" style=""> 380          private void sendAppWidgetResetNotify() {                                                                 </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 381              final ContentResolver resolver = mContext.getContentResolver();                                       </span>
<span class="4149774703050814155" onmouseenter="enter('4149774703050814155');" onmouseout="out('4149774703050814155');" style=""> 382              resolver.notifyChange(CONTENT_APPWIDGET_RESET_URI, null);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383          }                                                                                                         </span>
<span  style=""> 384                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 385          @Override                                                                                                 </span>
<span class="3201464308903999877" onmouseenter="enter('3201464308903999877');" onmouseout="out('3201464308903999877');" style=""> 386          public void onCreate(SQLiteDatabase db) {                                                                 </span>
<span class="4744685829155971552" onmouseenter="enter('4744685829155971552');" onmouseout="out('4744685829155971552');" style=""> 387              if (LOGD) Log.d(TAG, &quot;creating new launcher database&quot;);                                               </span>
<span  style=""> 388                                                                                                                    </span>
<span class="-5512536783286632376" onmouseenter="enter('-5512536783286632376');" onmouseout="out('-5512536783286632376');" style=""> 389              mMaxItemId = 1;                                                                                       </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 390              mMaxScreenId = 0;                                                                                     </span>
<span class="-3863035699221776712" onmouseenter="enter('-3863035699221776712');" onmouseout="out('-3863035699221776712');" style=""> 391              mNewDbCreated = true;                                                                                 </span>
<span  style=""> 392                                                                                                                    </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 393              UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                              </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 394              long userSerialNumber = userManager.getSerialNumberForUser(                                           </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 395                      UserHandleCompat.myUserHandle());                                                             </span>
<span  style=""> 396                                                                                                                    </span>
<span class="-5810771542500139933" onmouseenter="enter('-5810771542500139933');" onmouseout="out('-5810771542500139933');" style=""> 397              db.execSQL(&quot;CREATE TABLE favorites (&quot; +                                                               </span>
<span class="-7286867248755276119" onmouseenter="enter('-7286867248755276119');" onmouseout="out('-7286867248755276119');" style=""> 398                      &quot;_id INTEGER PRIMARY KEY,&quot; +                                                                  </span>
<span class="5329137835308229169" onmouseenter="enter('5329137835308229169');" onmouseout="out('5329137835308229169');" style=""> 399                      &quot;title TEXT,&quot; +                                                                               </span>
<span class="-7776152072054589061" onmouseenter="enter('-7776152072054589061');" onmouseout="out('-7776152072054589061');" style=""> 400                      &quot;intent TEXT,&quot; +                                                                              </span>
<span class="4982593742089674958" onmouseenter="enter('4982593742089674958');" onmouseout="out('4982593742089674958');" style=""> 401                      &quot;container INTEGER,&quot; +                                                                        </span>
<span class="-1871026270657853169" onmouseenter="enter('-1871026270657853169');" onmouseout="out('-1871026270657853169');" style=""> 402                      &quot;screen INTEGER,&quot; +                                                                           </span>
<span class="-9174211260981343890" onmouseenter="enter('-9174211260981343890');" onmouseout="out('-9174211260981343890');" style=""> 403                      &quot;cellX INTEGER,&quot; +                                                                            </span>
<span class="1584772009960348649" onmouseenter="enter('1584772009960348649');" onmouseout="out('1584772009960348649');" style=""> 404                      &quot;cellY INTEGER,&quot; +                                                                            </span>
<span class="5424055190881126727" onmouseenter="enter('5424055190881126727');" onmouseout="out('5424055190881126727');" style=""> 405                      &quot;spanX INTEGER,&quot; +                                                                            </span>
<span class="6553755327503045229" onmouseenter="enter('6553755327503045229');" onmouseout="out('6553755327503045229');" style=""> 406                      &quot;spanY INTEGER,&quot; +                                                                            </span>
<span class="5229848414421823036" onmouseenter="enter('5229848414421823036');" onmouseout="out('5229848414421823036');" style=""> 407                      &quot;itemType INTEGER,&quot; +                                                                         </span>
<span class="-1771151571856416667" onmouseenter="enter('-1771151571856416667');" onmouseout="out('-1771151571856416667');" style=""> 408                      &quot;appWidgetId INTEGER NOT NULL DEFAULT -1,&quot; +                                                  </span>
<span class="-9047067707489472437" onmouseenter="enter('-9047067707489472437');" onmouseout="out('-9047067707489472437');" style=""> 409                      &quot;isShortcut INTEGER,&quot; +                                                                       </span>
<span class="-3445858598434382544" onmouseenter="enter('-3445858598434382544');" onmouseout="out('-3445858598434382544');" style=""> 410                      &quot;iconType INTEGER,&quot; +                                                                         </span>
<span class="4279668316006004948" onmouseenter="enter('4279668316006004948');" onmouseout="out('4279668316006004948');" style=""> 411                      &quot;iconPackage TEXT,&quot; +                                                                         </span>
<span class="2008284586023778304" onmouseenter="enter('2008284586023778304');" onmouseout="out('2008284586023778304');" style=""> 412                      &quot;iconResource TEXT,&quot; +                                                                        </span>
<span class="-5981868381948376489" onmouseenter="enter('-5981868381948376489');" onmouseout="out('-5981868381948376489');" style=""> 413                      &quot;icon BLOB,&quot; +                                                                                </span>
<span class="5686768105176115842" onmouseenter="enter('5686768105176115842');" onmouseout="out('5686768105176115842');" style=""> 414                      &quot;uri TEXT,&quot; +                                                                                 </span>
<span class="-5470568819214956502" onmouseenter="enter('-5470568819214956502');" onmouseout="out('-5470568819214956502');" style=""> 415                      &quot;displayMode INTEGER,&quot; +                                                                      </span>
<span class="3582502352252677630" onmouseenter="enter('3582502352252677630');" onmouseout="out('3582502352252677630');" style=""> 416                      &quot;appWidgetProvider TEXT,&quot; +                                                                   </span>
<span class="4065658841092455651" onmouseenter="enter('4065658841092455651');" onmouseout="out('4065658841092455651');" style=""> 417                      &quot;modified INTEGER NOT NULL DEFAULT 0,&quot; +                                                      </span>
<span class="422282607120493296" onmouseenter="enter('422282607120493296');" onmouseout="out('422282607120493296');" style=""> 418                      &quot;restored INTEGER NOT NULL DEFAULT 0,&quot; +                                                      </span>
<span class="823907807759654324" onmouseenter="enter('823907807759654324');" onmouseout="out('823907807759654324');" style=""> 419                      &quot;profileId INTEGER DEFAULT &quot; + userSerialNumber + &quot;,&quot; +                                       </span>
<span class="-8486149279194715653" onmouseenter="enter('-8486149279194715653');" onmouseout="out('-8486149279194715653');" style=""> 420                      &quot;rank INTEGER NOT NULL DEFAULT 0&quot; +                                                           </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 421                      &quot;);&quot;);                                                                                        </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 422              addWorkspacesTable(db);                                                                               </span>
<span  style=""> 423                                                                                                                    </span>
<span class="-1982623284376040662" onmouseenter="enter('-1982623284376040662');" onmouseout="out('-1982623284376040662');" style=""> 424              // Database was just created, so wipe any previous widgets                                            </span>
<span class="35469525966995251" onmouseenter="enter('35469525966995251');" onmouseout="out('35469525966995251');" style=""> 425              if (mAppWidgetHost != null) {                                                                         </span>
<span class="2879907381293157546" onmouseenter="enter('2879907381293157546');" onmouseout="out('2879907381293157546');" style=""> 426                  mAppWidgetHost.deleteHost();                                                                      </span>
<span class="-5770229164268459929" onmouseenter="enter('-5770229164268459929');" onmouseout="out('-5770229164268459929');" style=""> 427                  sendAppWidgetResetNotify();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428              }                                                                                                     </span>
<span  style=""> 429                                                                                                                    </span>
<span class="-1063142603395313746" onmouseenter="enter('-1063142603395313746');" onmouseout="out('-1063142603395313746');" style=""> 430              // Fresh and clean launcher DB.                                                                       </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 431              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="7629543500667828090" onmouseenter="enter('7629543500667828090');" onmouseout="out('7629543500667828090');" style=""> 432              setFlagEmptyDbCreated();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433          }                                                                                                         </span>
<span  style=""> 434                                                                                                                    </span>
<span class="6272912136443308513" onmouseenter="enter('6272912136443308513');" onmouseout="out('6272912136443308513');" style=""> 435          private void addWorkspacesTable(SQLiteDatabase db) {                                                      </span>
<span class="2730049849658983478" onmouseenter="enter('2730049849658983478');" onmouseout="out('2730049849658983478');" style=""> 436              db.execSQL(&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS + &quot; (&quot; +                                         </span>
<span class="-1469669278065576182" onmouseenter="enter('-1469669278065576182');" onmouseout="out('-1469669278065576182');" style=""> 437                      LauncherSettings.WorkspaceScreens._ID + &quot; INTEGER,&quot; +                                         </span>

<span class="-8340457193420065897" onmouseenter="enter('-8340457193420065897');" onmouseout="out('-8340457193420065897');" style=""> 438                      LauncherSettings.WorkspaceScreens.SCREEN_RANK + &quot; INTEGER,&quot; +                                 </span>
<span class="7771125962287368960" onmouseenter="enter('7771125962287368960');" onmouseout="out('7771125962287368960');" style=""> 439                      LauncherSettings.ChangeLogColumns.MODIFIED + &quot; INTEGER NOT NULL DEFAULT 0&quot; +                  </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 440                      &quot;);&quot;);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441          }                                                                                                         </span>
<span  style=""> 442                                                                                                                    </span>
<span class="-3232037806458942317" onmouseenter="enter('-3232037806458942317');" onmouseout="out('-3232037806458942317');" style=""> 443          private void removeOrphanedItems(SQLiteDatabase db) {                                                     </span>
<span class="-3995909494643948388" onmouseenter="enter('-3995909494643948388');" onmouseout="out('-3995909494643948388');" style=""> 444              // Delete items directly on the workspace who&#x27;s screen id doesn&#x27;t exist                               </span>
<span class="6555258266445461688" onmouseenter="enter('6555258266445461688');" onmouseout="out('6555258266445461688');" style=""> 445              //  &quot;DELETE FROM favorites WHERE screen NOT IN (SELECT _id FROM workspaceScreens)                     </span>
<span class="-1584785563187965465" onmouseenter="enter('-1584785563187965465');" onmouseout="out('-1584785563187965465');" style=""> 446              //   AND container = -100&quot;                                                                            </span>
<span class="-3502523792993972030" onmouseenter="enter('-3502523792993972030');" onmouseout="out('-3502523792993972030');" style=""> 447              String removeOrphanedDesktopItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                                </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 448                      &quot; WHERE &quot; +                                                                                   </span>
<span class="-8781539607986806909" onmouseenter="enter('-8781539607986806909');" onmouseout="out('-8781539607986806909');" style=""> 449                      LauncherSettings.Favorites.SCREEN + &quot; NOT IN (SELECT &quot; +                                      </span>
<span class="-3730067412022302503" onmouseenter="enter('-3730067412022302503');" onmouseout="out('-3730067412022302503');" style=""> 450                      LauncherSettings.WorkspaceScreens._ID + &quot; FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot;)&quot; +            </span>
<span class="8831213357842987069" onmouseenter="enter('8831213357842987069');" onmouseout="out('8831213357842987069');" style=""> 451                      &quot; AND &quot; +                                                                                     </span>
<span class="-3912897749337440213" onmouseenter="enter('-3912897749337440213');" onmouseout="out('-3912897749337440213');" style=""> 452                      LauncherSettings.Favorites.CONTAINER + &quot; = &quot; +                                                </span>
<span class="-1572782876841487653" onmouseenter="enter('-1572782876841487653');" onmouseout="out('-1572782876841487653');" style=""> 453                      LauncherSettings.Favorites.CONTAINER_DESKTOP;                                                 </span>
<span class="-5442680607495552531" onmouseenter="enter('-5442680607495552531');" onmouseout="out('-5442680607495552531');" style=""> 454              db.execSQL(removeOrphanedDesktopItems);                                                               </span>
<span  style=""> 455                                                                                                                    </span>
<span class="2150462606818952724" onmouseenter="enter('2150462606818952724');" onmouseout="out('2150462606818952724');" style=""> 456              // Delete items contained in folders which no longer exist (after above statement)                    </span>
<span class="7157590486959116676" onmouseenter="enter('7157590486959116676');" onmouseout="out('7157590486959116676');" style=""> 457              //  &quot;DELETE FROM favorites  WHERE container &lt;&gt; -100 AND container &lt;&gt; -101 AND container               </span>
<span class="4713393280747800603" onmouseenter="enter('4713393280747800603');" onmouseout="out('4713393280747800603');" style=""> 458              //   NOT IN (SELECT _id FROM favorites WHERE itemType = 2)&quot;                                           </span>
<span class="-8895952306054120744" onmouseenter="enter('-8895952306054120744');" onmouseout="out('-8895952306054120744');" style=""> 459              String removeOrphanedFolderItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                                 </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 460                      &quot; WHERE &quot; +                                                                                   </span>
<span class="-9165304043886914201" onmouseenter="enter('-9165304043886914201');" onmouseout="out('-9165304043886914201');" style=""> 461                      LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                               </span>
<span class="2430974176390543784" onmouseenter="enter('2430974176390543784');" onmouseout="out('2430974176390543784');" style=""> 462                      LauncherSettings.Favorites.CONTAINER_DESKTOP +                                                </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 463                      &quot; AND &quot;                                                                                       </span>
<span class="5144458996296891504" onmouseenter="enter('5144458996296891504');" onmouseout="out('5144458996296891504');" style=""> 464                      + LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                             </span>
<span class="20571678636460503" onmouseenter="enter('20571678636460503');" onmouseout="out('20571678636460503');" style=""> 465                      LauncherSettings.Favorites.CONTAINER_HOTSEAT +                                                </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 466                      &quot; AND &quot;                                                                                       </span>
<span class="-4280152506863766824" onmouseenter="enter('-4280152506863766824');" onmouseout="out('-4280152506863766824');" style=""> 467                      + LauncherSettings.Favorites.CONTAINER + &quot; NOT IN (SELECT &quot; +                                 </span>
<span class="-971280935083657149" onmouseenter="enter('-971280935083657149');" onmouseout="out('-971280935083657149');" style=""> 468                      LauncherSettings.Favorites._ID + &quot; FROM &quot; + TABLE_FAVORITES +                                 </span>
<span class="4038942553560789906" onmouseenter="enter('4038942553560789906');" onmouseout="out('4038942553560789906');" style=""> 469                      &quot; WHERE &quot; + LauncherSettings.Favorites.ITEM_TYPE + &quot; = &quot; +                                    </span>
<span class="-1734962565729646321" onmouseenter="enter('-1734962565729646321');" onmouseout="out('-1734962565729646321');" style=""> 470                      LauncherSettings.Favorites.ITEM_TYPE_FOLDER + &quot;)&quot;;                                            </span>
<span class="-8852316947474253726" onmouseenter="enter('-8852316947474253726');" onmouseout="out('-8852316947474253726');" style=""> 471              db.execSQL(removeOrphanedFolderItems);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472          }                                                                                                         </span>
<span  style=""> 473                                                                                                                    </span>
<span class="-2961433455992777066" onmouseenter="enter('-2961433455992777066');" onmouseout="out('-2961433455992777066');" style=""> 474          private void setFlagJustLoadedOldDb() {                                                                   </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 475              String spKey = LauncherAppState.getSharedPreferencesKey();                                            </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 476              SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span class="2898240485600869061" onmouseenter="enter('2898240485600869061');" onmouseout="out('2898240485600869061');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 477 -            SharedPreferences.Editor editor = sp.edit();                                                          </span>
<span class="6425915141570404948" onmouseenter="enter('6425915141570404948');" onmouseout="out('6425915141570404948');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 478 -            editor.putBoolean(UPGRADED_FROM_OLD_DATABASE, true);                                                  </span>
<span class="-757214322554182598" onmouseenter="enter('-757214322554182598');" onmouseout="out('-757214322554182598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 479 -            editor.putBoolean(EMPTY_DATABASE_CREATED, false);                                                     </span>
<span class="-1350952079334021013" onmouseenter="enter('-1350952079334021013');" onmouseout="out('-1350952079334021013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 480 -            editor.commit();                                                                                      </span>
<span class="6248178474895602573" onmouseenter="enter('6248178474895602573');" onmouseout="out('6248178474895602573');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 481 +            sp.edit().putBoolean(EMPTY_DATABASE_CREATED, false).commit();                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482          }                                                                                                         </span>
<span  style=""> 483                                                                                                                    </span>
<span class="3580170518454540960" onmouseenter="enter('3580170518454540960');" onmouseout="out('3580170518454540960');" style=""> 484          private void setFlagEmptyDbCreated() {                                                                    </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 485              String spKey = LauncherAppState.getSharedPreferencesKey();                                            </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 486              SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span class="2898240485600869061" onmouseenter="enter('2898240485600869061');" onmouseout="out('2898240485600869061');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 487 -            SharedPreferences.Editor editor = sp.edit();                                                          </span>
<span class="-1876450541595142979" onmouseenter="enter('-1876450541595142979');" onmouseout="out('-1876450541595142979');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 488 -            editor.putBoolean(EMPTY_DATABASE_CREATED, true);                                                      </span>
<span class="4517855415574245319" onmouseenter="enter('4517855415574245319');" onmouseout="out('4517855415574245319');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 489 -            editor.putBoolean(UPGRADED_FROM_OLD_DATABASE, false);                                                 </span>
<span class="-1350952079334021013" onmouseenter="enter('-1350952079334021013');" onmouseout="out('-1350952079334021013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 490 -            editor.commit();                                                                                      </span>
<span class="-1598905447100916131" onmouseenter="enter('-1598905447100916131');" onmouseout="out('-1598905447100916131');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 491 +            sp.edit().putBoolean(EMPTY_DATABASE_CREATED, true).commit();                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492          }                                                                                                         </span>
<span  style=""> 493                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 494          @Override                                                                                                 </span>
<span class="-4655538025867202729" onmouseenter="enter('-4655538025867202729');" onmouseout="out('-4655538025867202729');" style=""> 495          public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {                                </span>
<span class="-3337256987478665120" onmouseenter="enter('-3337256987478665120');" onmouseout="out('-3337256987478665120');" style=""> 496              if (LOGD) Log.d(TAG, &quot;onUpgrade triggered: &quot; + oldVersion);                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 497 -                                                                                                                  </span>
<span class="-8802630880728694567" onmouseenter="enter('-8802630880728694567');" onmouseout="out('-8802630880728694567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 498 -            int version = oldVersion;                                                                             </span>
<span class="-5643982476603308557" onmouseenter="enter('-5643982476603308557');" onmouseout="out('-5643982476603308557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 499 -            if (version &lt; MIN_DATABASE_VERSION) {                                                                 </span>
<span class="3921213884195173103" onmouseenter="enter('3921213884195173103');" onmouseout="out('3921213884195173103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 500 -                // The version cannot be lower that this, as Launcher3 never supported a lower                    </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 501 +            switch (oldVersion) {                                                                                 </span>
<span class="9079869636182330080" onmouseenter="enter('9079869636182330080');" onmouseout="out('9079869636182330080');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 502 +                // The version cannot be lower that 12, as Launcher3 never supported a lower                      </span>
<span class="-4883409179661970227" onmouseenter="enter('-4883409179661970227');" onmouseout="out('-4883409179661970227');" style=""> 503                  // version of the DB.                                                                             </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 504 -                createEmptyDB(db);                                                                                </span>
<span class="2097404470120653805" onmouseenter="enter('2097404470120653805');" onmouseout="out('2097404470120653805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 505 -                version = DATABASE_VERSION;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 506 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 507 -                                                                                                                  </span>
<span class="-1127321954793168309" onmouseenter="enter('-1127321954793168309');" onmouseout="out('-1127321954793168309');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 508 -            if (version &lt; 13) {                                                                                   </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 509 -                // With the new shrink-wrapped and re-orderable workspaces, it makes sense                        </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 510 -                // to persist workspace screens and their relative order.                                         </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 511 -                mMaxScreenId = 0;                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 512 -                                                                                                                  </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 513 -                addWorkspacesTable(db);                                                                           </span>
<span class="-1031230936357450444" onmouseenter="enter('-1031230936357450444');" onmouseout="out('-1031230936357450444');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 514 -                version = 13;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 515 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 516 -                                                                                                                  </span>
<span class="-3790290227926597654" onmouseenter="enter('-3790290227926597654');" onmouseout="out('-3790290227926597654');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 517 -            if (version &lt; 14) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 518 -                db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 519 -                try {                                                                                             </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 520 -                    // Insert new column for holding widget provider name                                         </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 521 -                    db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="-1191376551368325446" onmouseenter="enter('-1191376551368325446');" onmouseout="out('-1191376551368325446');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 522 -                            &quot;ADD COLUMN appWidgetProvider TEXT;&quot;);                                                </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 523 -                    db.setTransactionSuccessful();                                                                </span>
<span class="-6853964272080073312" onmouseenter="enter('-6853964272080073312');" onmouseout="out('-6853964272080073312');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 524 -                    version = 14;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 525 -                } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 526 -                    // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 527 -                    Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 528 -                } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 529 -                    db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 530 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 531 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 532 -                                                                                                                  </span>
<span class="4742571203445114157" onmouseenter="enter('4742571203445114157');" onmouseout="out('4742571203445114157');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 533 -            if (version &lt; 15) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 534 -                db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 535 -                try {                                                                                             </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 536 -                    // Insert new column for holding update timestamp                                             </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 537 -                    db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 538 -                            &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 539 -                    db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                                  </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 540 -                            &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 541 -                    db.setTransactionSuccessful();                                                                </span>
<span class="8988210671545584151" onmouseenter="enter('8988210671545584151');" onmouseout="out('8988210671545584151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 542 -                    version = 15;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 543 -                } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 544 -                    // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 545 -                    Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 546 -                } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 547 -                    db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 548 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 549 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 550 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 551 -                                                                                                                  </span>
<span class="1076365416612257192" onmouseenter="enter('1076365416612257192');" onmouseout="out('1076365416612257192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 552 -            if (version &lt; 16) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 553 -                db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 554 -                try {                                                                                             </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 555 -                    // Insert new column for holding restore status                                               </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 556 -                    db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 557 -                            &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 558 -                    db.setTransactionSuccessful();                                                                </span>
<span class="2013829968714493382" onmouseenter="enter('2013829968714493382');" onmouseout="out('2013829968714493382');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 559 -                    version = 16;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -                } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -                    // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -                    Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -                } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -                    db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 565 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -                                                                                                                  </span>
<span class="-6756468306354214848" onmouseenter="enter('-6756468306354214848');" onmouseout="out('-6756468306354214848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -            if (version &lt; 17) {                                                                                   </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -                // We use the db version upgrade here to identify users who may not have seen                     </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -                // clings yet (because they weren&#x27;t available), but for whom the clings are now                   </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -                // available (tablet users). Because one of the possible cling flows (migration)                  </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -                // is very destructive (wipes out workspaces), we want to prevent this from showing               </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -                // until clear data. We do so by marking that the clings have been shown.                         </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -                LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                                  </span>
<span class="-3652383409155171451" onmouseenter="enter('-3652383409155171451');" onmouseout="out('-3652383409155171451');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 575 -                version = 17;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 576 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 577 -                                                                                                                  </span>
<span class="7817650129783202172" onmouseenter="enter('7817650129783202172');" onmouseout="out('7817650129783202172');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 578 -            if (version &lt; 18) {                                                                                   </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -                // No-op                                                                                          </span>
<span class="-862393984298106042" onmouseenter="enter('-862393984298106042');" onmouseout="out('-862393984298106042');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -                version = 18;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -                                                                                                                  </span>
<span class="-3427379715691059477" onmouseenter="enter('-3427379715691059477');" onmouseout="out('-3427379715691059477');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 583 -            if (version &lt; 19) {                                                                                   </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 584 -                // Due to a data loss bug, some users may have items associated with screen ids                   </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 585 -                // which no longer exist. Since this can cause other problems, and since the user                 </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 586 -                // will never see these items anyway, we use database upgrade as an opportunity to                </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 587 -                // clean things up.                                                                               </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 588 -                removeOrphanedItems(db);                                                                          </span>
<span class="-8622797196606405802" onmouseenter="enter('-8622797196606405802');" onmouseout="out('-8622797196606405802');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 589 -                version = 19;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 590 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 591 -                                                                                                                  </span>
<span class="7499725911390962675" onmouseenter="enter('7499725911390962675');" onmouseout="out('7499725911390962675');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 592 -            if (version &lt; 20) {                                                                                   </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 593 -                // Add userId column                                                                              </span>
<span class="3648122535018422218" onmouseenter="enter('3648122535018422218');" onmouseout="out('3648122535018422218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 594 -                if (addProfileColumn(db)) {                                                                       </span>
<span class="-3196204954256045340" onmouseenter="enter('-3196204954256045340');" onmouseout="out('-3196204954256045340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 595 -                    version = 20;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 596 -                }                                                                                                 </span>
<span class="-7922924049235754756" onmouseenter="enter('-7922924049235754756');" onmouseout="out('-7922924049235754756');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 597 -                // else old version remains, which means we wipe old data                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 598 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 599 -                                                                                                                  </span>
<span class="-1689277129606306081" onmouseenter="enter('-1689277129606306081');" onmouseout="out('-1689277129606306081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 600 -            if (version &lt; 21) {                                                                                   </span>
<span class="-7646592925974879249" onmouseenter="enter('-7646592925974879249');" onmouseout="out('-7646592925974879249');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 601 -                if (updateFolderItemsRank(db, true)) {                                                            </span>
<span class="8220648455759030377" onmouseenter="enter('8220648455759030377');" onmouseout="out('8220648455759030377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 602 -                    version  = 21;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 603 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 604 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 605 -                                                                                                                  </span>







<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 606 -            if (version != DATABASE_VERSION) {                                                                    </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 607 -                Log.w(TAG, &quot;Destroying all old data.&quot;);                                                           </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 608 -                createEmptyDB(db);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 609 -            }                                                                                                     </span>
<span class="3359875150199815819" onmouseenter="enter('3359875150199815819');" onmouseout="out('3359875150199815819');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 610 +                case 12: {                                                                                        </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 611 +                    // With the new shrink-wrapped and re-orderable workspaces, it makes sense                    </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 612 +                    // to persist workspace screens and their relative order.                                     </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 613 +                    mMaxScreenId = 0;                                                                             </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 614 +                    addWorkspacesTable(db);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 615 +                }                                                                                                 </span>
<span class="-3873917579330875824" onmouseenter="enter('-3873917579330875824');" onmouseout="out('-3873917579330875824');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 616 +                case 13: {                                                                                        </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 617 +                    db.beginTransaction();                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 618 +                    try {                                                                                         </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 619 +                        // Insert new column for holding widget provider name                                     </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 620 +                        db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                     </span>
<span class="-1191376551368325446" onmouseenter="enter('-1191376551368325446');" onmouseout="out('-1191376551368325446');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 621 +                                &quot;ADD COLUMN appWidgetProvider TEXT;&quot;);                                            </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 622 +                        db.setTransactionSuccessful();                                                            </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 623 +                    } catch (SQLException ex) {                                                                   </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 624 +                        Log.e(TAG, ex.getMessage(), ex);                                                          </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 625 +                        // Old version remains, which means we wipe old data                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 626 +                        break;                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 627 +                    } finally {                                                                                   </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 628 +                        db.endTransaction();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 629 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 630 +                }                                                                                                 </span>
<span class="8507938363259012736" onmouseenter="enter('8507938363259012736');" onmouseout="out('8507938363259012736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 631 +                case 14: {                                                                                        </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 632 +                    db.beginTransaction();                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 633 +                    try {                                                                                         </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 634 +                        // Insert new column for holding update timestamp                                         </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 635 +                        db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                     </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 636 +                                &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                               </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 637 +                        db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                              </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +                                &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                               </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 639 +                        db.setTransactionSuccessful();                                                            </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 640 +                    } catch (SQLException ex) {                                                                   </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 641 +                        Log.e(TAG, ex.getMessage(), ex);                                                          </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 642 +                        // Old version remains, which means we wipe old data                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 643 +                        break;                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 644 +                    } finally {                                                                                   </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 645 +                        db.endTransaction();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 646 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 647 +                }                                                                                                 </span>
<span class="8561964280724983620" onmouseenter="enter('8561964280724983620');" onmouseout="out('8561964280724983620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 648 +                case 15: {                                                                                        </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 649 +                    db.beginTransaction();                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 650 +                    try {                                                                                         </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 651 +                        // Insert new column for holding restore status                                           </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 652 +                        db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                     </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 653 +                                &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                               </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 654 +                        db.setTransactionSuccessful();                                                            </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 655 +                    } catch (SQLException ex) {                                                                   </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 656 +                        Log.e(TAG, ex.getMessage(), ex);                                                          </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 657 +                        // Old version remains, which means we wipe old data                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 658 +                        break;                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 659 +                    } finally {                                                                                   </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 660 +                        db.endTransaction();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 661 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 662 +                }                                                                                                 </span>
<span class="7575290899313355683" onmouseenter="enter('7575290899313355683');" onmouseout="out('7575290899313355683');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 663 +                case 16: {                                                                                        </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 664 +                    // We use the db version upgrade here to identify users who may not have seen                 </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 665 +                    // clings yet (because they weren&#x27;t available), but for whom the clings are now               </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 666 +                    // available (tablet users). Because one of the possible cling flows (migration)              </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 667 +                    // is very destructive (wipes out workspaces), we want to prevent this from showing           </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 668 +                    // until clear data. We do so by marking that the clings have been shown.                     </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 669 +                    LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 670 +                }                                                                                                 </span>
<span class="874358258533148680" onmouseenter="enter('874358258533148680');" onmouseout="out('874358258533148680');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 671 +                case 17: {                                                                                        </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 672 +                    // No-op                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 673 +                }                                                                                                 </span>
<span class="7290242482342203768" onmouseenter="enter('7290242482342203768');" onmouseout="out('7290242482342203768');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 674 +                case 18: {                                                                                        </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 675 +                    // Due to a data loss bug, some users may have items associated with screen ids               </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 676 +                    // which no longer exist. Since this can cause other problems, and since the user             </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 677 +                    // will never see these items anyway, we use database upgrade as an opportunity to            </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 678 +                    // clean things up.                                                                           </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 679 +                    removeOrphanedItems(db);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 680 +                }                                                                                                 </span>
<span class="2857663073964692700" onmouseenter="enter('2857663073964692700');" onmouseout="out('2857663073964692700');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 681 +                case 19: {                                                                                        </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 682 +                    // Add userId column                                                                          </span>
<span class="2862263159714553199" onmouseenter="enter('2862263159714553199');" onmouseout="out('2862263159714553199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 683 +                    if (!addProfileColumn(db)) {                                                                  </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 684 +                        // Old version remains, which means we wipe old data                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 685 +                        break;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 686 +                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 687 +                }                                                                                                 </span>
<span class="-901653241001302481" onmouseenter="enter('-901653241001302481');" onmouseout="out('-901653241001302481');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 688 +                case 20:                                                                                          </span>
<span class="-5016813644414129178" onmouseenter="enter('-5016813644414129178');" onmouseout="out('-5016813644414129178');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 689 +                    if (!updateFolderItemsRank(db, true)) {                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 690 +                        break;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 691 +                    }                                                                                             </span>
<span class="-7447648558388390989" onmouseenter="enter('-7447648558388390989');" onmouseout="out('-7447648558388390989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 692 +                case 21: {                                                                                        </span>
<span class="8949931370118151818" onmouseenter="enter('8949931370118151818');" onmouseout="out('8949931370118151818');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 693 +                    // DB Upgraded successfully                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 694 +                    return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 695 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 696 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 697 +                                                                                                                  </span>
<span class="-498940447290760811" onmouseenter="enter('-498940447290760811');" onmouseout="out('-498940447290760811');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 698 +            // DB was not upgraded                                                                                </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 699 +            Log.w(TAG, &quot;Destroying all old data.&quot;);                                                               </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 700 +            createEmptyDB(db);                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 701          }                                                                                                         </span>
<span  style=""> 702                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 703          @Override                                                                                                 </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style=""> 704          public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                              </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style=""> 705              // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                             </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style=""> 706              Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +                   </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style=""> 707                      &quot;. Wiping databse.&quot;);                                                                         </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 708              createEmptyDB(db);                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 709          }                                                                                                         </span>
<span  style=""> 710                                                                                                                    </span>
<span  style=""> 711                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 712          /**                                                                                                       </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 713           * Clears all the data for a fresh start.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 714           */                                                                                                       </span>
<span class="3436200006891248330" onmouseenter="enter('3436200006891248330');" onmouseout="out('3436200006891248330');" style=""> 715          public void createEmptyDB(SQLiteDatabase db) {                                                            </span>
<span class="-5910745818286558462" onmouseenter="enter('-5910745818286558462');" onmouseout="out('-5910745818286558462');" style=""> 716              db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_FAVORITES);                                                </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 717              db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                                        </span>
<span class="1466158746107327510" onmouseenter="enter('1466158746107327510');" onmouseout="out('1466158746107327510');" style=""> 718              onCreate(db);                                                                                         </span>
















































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 719          }                                                                                                         </span>
<span  style=""> 720                                                                                                                    </span>
<span class="-7501286576844846445" onmouseenter="enter('-7501286576844846445');" onmouseout="out('-7501286576844846445');" style=""> 721          private boolean updateFolderItemsRank(SQLiteDatabase db, boolean addRankColumn) {                         </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 722              db.beginTransaction();                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 723              try {                                                                                                 </span>
<span class="5008547084206266322" onmouseenter="enter('5008547084206266322');" onmouseout="out('5008547084206266322');" style=""> 724                  if (addRankColumn) {                                                                              </span>
<span class="-7289454301230657535" onmouseenter="enter('-7289454301230657535');" onmouseout="out('-7289454301230657535');" style=""> 725                      // Insert new column for holding rank                                                         </span>
<span class="-1590113536171608350" onmouseenter="enter('-1590113536171608350');" onmouseout="out('-1590113536171608350');" style=""> 726                      db.execSQL(&quot;ALTER TABLE favorites ADD COLUMN rank INTEGER NOT NULL DEFAULT 0;&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 727                  }                                                                                                 </span>
<span  style=""> 728                                                                                                                    </span>
<span class="-6084339731876053459" onmouseenter="enter('-6084339731876053459');" onmouseout="out('-6084339731876053459');" style=""> 729                  // Get a map for folder ID to folder width                                                        </span>
<span class="7958578721408666232" onmouseenter="enter('7958578721408666232');" onmouseout="out('7958578721408666232');" style=""> 730                  Cursor c = db.rawQuery(&quot;SELECT container, MAX(cellX) FROM favorites&quot;                              </span>
<span class="1296304159181878428" onmouseenter="enter('1296304159181878428');" onmouseout="out('1296304159181878428');" style=""> 731                          + &quot; WHERE container IN (SELECT _id FROM favorites WHERE itemType = ?)&quot;                    </span>
<span class="8240981592991850481" onmouseenter="enter('8240981592991850481');" onmouseout="out('8240981592991850481');" style=""> 732                          + &quot; GROUP BY container;&quot;,                                                                 </span>
<span class="-3631725497478036647" onmouseenter="enter('-3631725497478036647');" onmouseout="out('-3631725497478036647');" style=""> 733                          new String[] {Integer.toString(LauncherSettings.Favorites.ITEM_TYPE_FOLDER)});            </span>
<span  style=""> 734                                                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 735                  while (c.moveToNext()) {                                                                          </span>
<span class="-6809072711155135098" onmouseenter="enter('-6809072711155135098');" onmouseout="out('-6809072711155135098');" style=""> 736                      db.execSQL(&quot;UPDATE favorites SET rank=cellX+(cellY*?) WHERE &quot;                                 </span>
<span class="8697652523066470339" onmouseenter="enter('8697652523066470339');" onmouseout="out('8697652523066470339');" style=""> 737                              + &quot;container=? AND cellX IS NOT NULL AND cellY IS NOT NULL;&quot;,                         </span>
<span class="-3010724386050799789" onmouseenter="enter('-3010724386050799789');" onmouseout="out('-3010724386050799789');" style=""> 738                              new Object[] {c.getLong(1) + 1, c.getLong(0)});                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739                  }                                                                                                 </span>
<span  style=""> 740                                                                                                                    </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 741                  c.close();                                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 742                  db.setTransactionSuccessful();                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 743              } catch (SQLException ex) {                                                                           </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 744                  // Old version remains, which means we wipe old data                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 745                  Log.e(TAG, ex.getMessage(), ex);                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 746                  return false;                                                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 747              } finally {                                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 748                  db.endTransaction();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 749              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 750              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 751          }                                                                                                         </span>
<span  style=""> 752                                                                                                                    </span>
<span class="-4559468305095454841" onmouseenter="enter('-4559468305095454841');" onmouseout="out('-4559468305095454841');" style=""> 753          private boolean addProfileColumn(SQLiteDatabase db) {                                                     </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 754              db.beginTransaction();                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 755              try {                                                                                                 </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 756                  UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                          </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 757                  // Default to the serial number of this user, for older                                           </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 758                  // shortcuts.                                                                                     </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 759                  long userSerialNumber = userManager.getSerialNumberForUser(                                       </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 760                          UserHandleCompat.myUserHandle());                                                         </span>
<span class="-7537890297935646580" onmouseenter="enter('-7537890297935646580');" onmouseout="out('-7537890297935646580');" style=""> 761                  // Insert new column for holding user serial number                                               </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 762                  db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                             </span>
<span class="6389325795698900878" onmouseenter="enter('6389325795698900878');" onmouseout="out('6389325795698900878');" style=""> 763                          &quot;ADD COLUMN profileId INTEGER DEFAULT &quot;                                                   </span>
<span class="-6027465318491077769" onmouseenter="enter('-6027465318491077769');" onmouseout="out('-6027465318491077769');" style=""> 764                                          + userSerialNumber + &quot;;&quot;);                                                </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 765                  db.setTransactionSuccessful();                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 766              } catch (SQLException ex) {                                                                           </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 767                  // Old version remains, which means we wipe old data                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 768                  Log.e(TAG, ex.getMessage(), ex);                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 769                  return false;                                                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 770              } finally {                                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 771                  db.endTransaction();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 772              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 773              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 774          }                                                                                                         </span>
<span  style=""> 775                                                                                                                    </span>
<span class="-8543343401238088250" onmouseenter="enter('-8543343401238088250');" onmouseout="out('-8543343401238088250');" style=""> 776          // Generates a new ID to use for an object in your database. This method should be only                   </span>
<span class="-535999813132446250" onmouseenter="enter('-535999813132446250');" onmouseout="out('-535999813132446250');" style=""> 777          // called from the main UI thread. As an exception, we do call it when we call the                        </span>
<span class="-3416944691245960228" onmouseenter="enter('-3416944691245960228');" onmouseout="out('-3416944691245960228');" style=""> 778          // constructor from the worker thread; however, this doesn&#x27;t extend until after the                       </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 779          // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp                 </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 780          // after that point                                                                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 781          @Override                                                                                                 </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 782          public long generateNewItemId() {                                                                         </span>
<span class="2999684209048406821" onmouseenter="enter('2999684209048406821');" onmouseout="out('2999684209048406821');" style=""> 783              if (mMaxItemId &lt; 0) {                                                                                 </span>
<span class="-7068859972649181897" onmouseenter="enter('-7068859972649181897');" onmouseout="out('-7068859972649181897');" style=""> 784                  throw new RuntimeException(&quot;Error: max item id was not initialized&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 785              }                                                                                                     </span>
<span class="-2732750815463784999" onmouseenter="enter('-2732750815463784999');" onmouseout="out('-2732750815463784999');" style=""> 786              mMaxItemId += 1;                                                                                      </span>
<span class="5456580978366825274" onmouseenter="enter('5456580978366825274');" onmouseout="out('5456580978366825274');" style=""> 787              return mMaxItemId;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 788          }                                                                                                         </span>
<span  style=""> 789                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 790          @Override                                                                                                 </span>
<span class="329443540154066398" onmouseenter="enter('329443540154066398');" onmouseout="out('329443540154066398');" style=""> 791          public long insertAndCheck(SQLiteDatabase db, ContentValues values) {                                     </span>
<span class="-1505151618823806706" onmouseenter="enter('-1505151618823806706');" onmouseout="out('-1505151618823806706');" style=""> 792              return dbInsertAndCheck(this, db, TABLE_FAVORITES, null, values);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 793          }                                                                                                         </span>
<span  style=""> 794                                                                                                                    </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 795          public void updateMaxItemId(long id) {                                                                    </span>
<span class="-6849429476525109058" onmouseenter="enter('-6849429476525109058');" onmouseout="out('-6849429476525109058');" style=""> 796              mMaxItemId = id + 1;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797          }                                                                                                         </span>
<span  style=""> 798                                                                                                                    </span>
<span class="-7367368828761155068" onmouseenter="enter('-7367368828761155068');" onmouseout="out('-7367368828761155068');" style=""> 799          public void checkId(String table, ContentValues values) {                                                 </span>
<span class="-1608142162103033850" onmouseenter="enter('-1608142162103033850');" onmouseout="out('-1608142162103033850');" style=""> 800              long id = values.getAsLong(LauncherSettings.BaseLauncherColumns._ID);                                 </span>
<span class="-6900211224990683940" onmouseenter="enter('-6900211224990683940');" onmouseout="out('-6900211224990683940');" style=""> 801              if (table == LauncherProvider.TABLE_WORKSPACE_SCREENS) {                                              </span>
<span class="9109073648364222254" onmouseenter="enter('9109073648364222254');" onmouseout="out('9109073648364222254');" style=""> 802                  mMaxScreenId = Math.max(id, mMaxScreenId);                                                        </span>
<span class="-6240460135729763291" onmouseenter="enter('-6240460135729763291');" onmouseout="out('-6240460135729763291');" style=""> 803              }  else {                                                                                             </span>
<span class="754800730159449376" onmouseenter="enter('754800730159449376');" onmouseout="out('754800730159449376');" style=""> 804                  mMaxItemId = Math.max(id, mMaxItemId);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 805              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806          }                                                                                                         </span>
<span  style=""> 807                                                                                                                    </span>
<span class="-8013451254632200820" onmouseenter="enter('-8013451254632200820');" onmouseout="out('-8013451254632200820');" style=""> 808          private long initializeMaxItemId(SQLiteDatabase db) {                                                     </span>
<span class="-6457280004469744269" onmouseenter="enter('-6457280004469744269');" onmouseout="out('-6457280004469744269');" style=""> 809              Cursor c = db.rawQuery(&quot;SELECT MAX(_id) FROM favorites&quot;, null);                                       </span>
<span  style=""> 810                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 811              // get the result                                                                                     </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 812              final int maxIdIndex = 0;                                                                             </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 813              long id = -1;                                                                                         </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 814              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 815                  id = c.getLong(maxIdIndex);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 816              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 817              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 818                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 819              }                                                                                                     </span>
<span  style=""> 820                                                                                                                    </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 821              if (id == -1) {                                                                                       </span>
<span class="-8632333559810917367" onmouseenter="enter('-8632333559810917367');" onmouseout="out('-8632333559810917367');" style=""> 822                  throw new RuntimeException(&quot;Error: could not query max item id&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 823              }                                                                                                     </span>
<span  style=""> 824                                                                                                                    </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 825              return id;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 826          }                                                                                                         </span>
<span  style=""> 827                                                                                                                    </span>
<span class="3292148501075941248" onmouseenter="enter('3292148501075941248');" onmouseout="out('3292148501075941248');" style=""> 828          // Generates a new ID to use for an workspace screen in your database. This method                        </span>
<span class="8169251972405240623" onmouseenter="enter('8169251972405240623');" onmouseout="out('8169251972405240623');" style=""> 829          // should be only called from the main UI thread. As an exception, we do call it when we                  </span>
<span class="5354260748737756868" onmouseenter="enter('5354260748737756868');" onmouseout="out('5354260748737756868');" style=""> 830          // call the constructor from the worker thread; however, this doesn&#x27;t extend until after the              </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 831          // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp                 </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 832          // after that point                                                                                       </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 833          public long generateNewScreenId() {                                                                       </span>
<span class="-2601779586206833262" onmouseenter="enter('-2601779586206833262');" onmouseout="out('-2601779586206833262');" style=""> 834              if (mMaxScreenId &lt; 0) {                                                                               </span>
<span class="-8395628436366181623" onmouseenter="enter('-8395628436366181623');" onmouseout="out('-8395628436366181623');" style=""> 835                  throw new RuntimeException(&quot;Error: max screen id was not initialized&quot;);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 836              }                                                                                                     </span>
<span class="-7600499966171393409" onmouseenter="enter('-7600499966171393409');" onmouseout="out('-7600499966171393409');" style=""> 837              mMaxScreenId += 1;                                                                                    </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 838              // Log to disk                                                                                        </span>
<span class="-8761729187376845632" onmouseenter="enter('-8761729187376845632');" onmouseout="out('-8761729187376845632');" style=""> 839              Launcher.addDumpLog(TAG, &quot;11683562 - generateNewScreenId(): &quot; + mMaxScreenId, true);                  </span>
<span class="-2082539956971430335" onmouseenter="enter('-2082539956971430335');" onmouseout="out('-2082539956971430335');" style=""> 840              return mMaxScreenId;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 841 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 842 -                                                                                                                  </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 843 -        public void updateMaxScreenId(long maxScreenId) {                                                         </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 844 -            // Log to disk                                                                                        </span>
<span class="-6999371015775210769" onmouseenter="enter('-6999371015775210769');" onmouseout="out('-6999371015775210769');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 845 -            Launcher.addDumpLog(TAG, &quot;11683562 - updateMaxScreenId(): &quot; + maxScreenId, true);                     </span>
<span class="-5262779621072196869" onmouseenter="enter('-5262779621072196869');" onmouseout="out('-5262779621072196869');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 846 -            mMaxScreenId = maxScreenId;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 847          }                                                                                                         </span>
<span  style=""> 848                                                                                                                    </span>
<span class="1340022180158952931" onmouseenter="enter('1340022180158952931');" onmouseout="out('1340022180158952931');" style=""> 849          private long initializeMaxScreenId(SQLiteDatabase db) {                                                   </span>
<span class="-2625939584691052131" onmouseenter="enter('-2625939584691052131');" onmouseout="out('-2625939584691052131');" style=""><abbr title=" 850              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);"> 850              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKS🔵</abbr></span>
<span  style=""> 851                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 852              // get the result                                                                                     </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 853              final int maxIdIndex = 0;                                                                             </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 854              long id = -1;                                                                                         </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 855              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 856                  id = c.getLong(maxIdIndex);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 857              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 858              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 859                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 860              }                                                                                                     </span>
<span  style=""> 861                                                                                                                    </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 862              if (id == -1) {                                                                                       </span>
<span class="5981752458110974976" onmouseenter="enter('5981752458110974976');" onmouseout="out('5981752458110974976');" style=""> 863                  throw new RuntimeException(&quot;Error: could not query max screen id&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 864              }                                                                                                     </span>
<span  style=""> 865                                                                                                                    </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 866              // Log to disk                                                                                        </span>
<span class="27430974887508761" onmouseenter="enter('27430974887508761');" onmouseout="out('27430974887508761');" style=""> 867              Launcher.addDumpLog(TAG, &quot;11683562 - initializeMaxScreenId(): &quot; + id, true);                          </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 868              return id;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 869          }                                                                                                         </span>
<span  style=""> 870                                                                                                                    </span>
<span class="1383368615032249869" onmouseenter="enter('1383368615032249869');" onmouseout="out('1383368615032249869');" style=""> 871          private boolean initializeExternalAdd(ContentValues values) {                                             </span>
<span class="-4585320292275114767" onmouseenter="enter('-4585320292275114767');" onmouseout="out('-4585320292275114767');" style=""> 872              // 1. Ensure that externally added items have a valid item id                                         </span>
<span class="-4828262327370557067" onmouseenter="enter('-4828262327370557067');" onmouseout="out('-4828262327370557067');" style=""> 873              long id = generateNewItemId();                                                                        </span>
<span class="-4305015780380424948" onmouseenter="enter('-4305015780380424948');" onmouseout="out('-4305015780380424948');" style=""> 874              values.put(LauncherSettings.Favorites._ID, id);                                                       </span>
<span  style=""> 875                                                                                                                    </span>
<span class="5555856101718413728" onmouseenter="enter('5555856101718413728');" onmouseout="out('5555856101718413728');" style=""> 876              // 2. In the case of an app widget, and if no app widget id is specified, we                          </span>
<span class="5653436237424007902" onmouseenter="enter('5653436237424007902');" onmouseout="out('5653436237424007902');" style=""> 877              // attempt allocate and bind the widget.                                                              </span>
<span class="7737959233990593661" onmouseenter="enter('7737959233990593661');" onmouseout="out('7737959233990593661');" style=""> 878              Integer itemType = values.getAsInteger(LauncherSettings.Favorites.ITEM_TYPE);                         </span>
<span class="2055658702897830579" onmouseenter="enter('2055658702897830579');" onmouseout="out('2055658702897830579');" style=""> 879              if (itemType != null &amp;&amp;                                                                               </span>
<span class="-1739021162756129174" onmouseenter="enter('-1739021162756129174');" onmouseout="out('-1739021162756129174');" style=""> 880                      itemType.intValue() == LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET &amp;&amp;                      </span>
<span class="-6215251601594981481" onmouseenter="enter('-6215251601594981481');" onmouseout="out('-6215251601594981481');" style=""> 881                      !values.containsKey(LauncherSettings.Favorites.APPWIDGET_ID)) {                               </span>
<span  style=""> 882                                                                                                                    </span>
<span class="328319718470950320" onmouseenter="enter('328319718470950320');" onmouseout="out('328319718470950320');" style=""> 883                  final AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(mContext);                 </span>
<span class="7884761264945585321" onmouseenter="enter('7884761264945585321');" onmouseout="out('7884761264945585321');" style=""> 884                  ComponentName cn = ComponentName.unflattenFromString(                                             </span>
<span class="2179911768770688102" onmouseenter="enter('2179911768770688102');" onmouseout="out('2179911768770688102');" style=""> 885                          values.getAsString(Favorites.APPWIDGET_PROVIDER));                                        </span>
<span  style=""> 886                                                                                                                    </span>
<span class="3459055710499452007" onmouseenter="enter('3459055710499452007');" onmouseout="out('3459055710499452007');" style=""> 887                  if (cn != null) {                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 888                      try {                                                                                         </span>
<span class="7176738113779216844" onmouseenter="enter('7176738113779216844');" onmouseout="out('7176738113779216844');" style=""> 889                          int appWidgetId = mAppWidgetHost.allocateAppWidgetId();                                   </span>
<span class="3122228588084428979" onmouseenter="enter('3122228588084428979');" onmouseout="out('3122228588084428979');" style=""> 890                          values.put(LauncherSettings.Favorites.APPWIDGET_ID, appWidgetId);                         </span>
<span class="2309614617117273311" onmouseenter="enter('2309614617117273311');" onmouseout="out('2309614617117273311');" style=""> 891                          if (!appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn)) {                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 892                              return false;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 893                          }                                                                                         </span>
<span class="1200625667814236005" onmouseenter="enter('1200625667814236005');" onmouseout="out('1200625667814236005');" style=""> 894                      } catch (RuntimeException e) {                                                                </span>
<span class="9049318523495391496" onmouseenter="enter('9049318523495391496');" onmouseout="out('9049318523495391496');" style=""> 895                          Log.e(TAG, &quot;Failed to initialize external widget&quot;, e);                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 896                          return false;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 897                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 898                  } else {                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 899                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 900                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 901              }                                                                                                     </span>
<span  style=""> 902                                                                                                                    </span>
<span class="-5393917371757635815" onmouseenter="enter('-5393917371757635815');" onmouseout="out('-5393917371757635815');" style=""> 903              // Add screen id if not present                                                                       </span>
<span class="-8492193036384627967" onmouseenter="enter('-8492193036384627967');" onmouseout="out('-8492193036384627967');" style=""> 904              long screenId = values.getAsLong(LauncherSettings.Favorites.SCREEN);                                  </span>
<span class="-8472780943665027311" onmouseenter="enter('-8472780943665027311');" onmouseout="out('-8472780943665027311');" style=""> 905              if (!addScreenIdIfNecessary(screenId)) {                                                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 906                  return false;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 907              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 908              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 909          }                                                                                                         </span>
<span  style=""> 910                                                                                                                    </span>
<span class="7352835902307890843" onmouseenter="enter('7352835902307890843');" onmouseout="out('7352835902307890843');" style=""> 911          // Returns true of screen id exists, or if successfully added                                             </span>
<span class="-4057720447241324922" onmouseenter="enter('-4057720447241324922');" onmouseout="out('-4057720447241324922');" style=""> 912          private boolean addScreenIdIfNecessary(long screenId) {                                                   </span>
<span class="-8332527954530563349" onmouseenter="enter('-8332527954530563349');" onmouseout="out('-8332527954530563349');" style=""> 913              if (!hasScreenId(screenId)) {                                                                         </span>
<span class="-3380006025674561043" onmouseenter="enter('-3380006025674561043');" onmouseout="out('-3380006025674561043');" style=""> 914                  int rank = getMaxScreenRank() + 1;                                                                </span>
<span  style=""> 915                                                                                                                    </span>
<span class="4061202061343128850" onmouseenter="enter('4061202061343128850');" onmouseout="out('4061202061343128850');" style=""> 916                  ContentValues v = new ContentValues();                                                            </span>
<span class="-5112420615000020353" onmouseenter="enter('-5112420615000020353');" onmouseout="out('-5112420615000020353');" style=""> 917                  v.put(LauncherSettings.WorkspaceScreens._ID, screenId);                                           </span>
<span class="6806563186306365402" onmouseenter="enter('6806563186306365402');" onmouseout="out('6806563186306365402');" style=""> 918                  v.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                                       </span>
<span class="-1115795847996433461" onmouseenter="enter('-1115795847996433461');" onmouseout="out('-1115795847996433461');" style=""> 919                  if (dbInsertAndCheck(this, getWritableDatabase(),                                                 </span>
<span class="3238415722136121635" onmouseenter="enter('3238415722136121635');" onmouseout="out('3238415722136121635');" style=""> 920                          TABLE_WORKSPACE_SCREENS, null, v) &lt; 0) {                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 921                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 922                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 923              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 924              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 925          }                                                                                                         </span>
<span  style=""> 926                                                                                                                    </span>
<span class="5478264759768975399" onmouseenter="enter('5478264759768975399');" onmouseout="out('5478264759768975399');" style=""> 927          private boolean hasScreenId(long screenId) {                                                              </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 928              SQLiteDatabase db = getWritableDatabase();                                                            </span>
<span class="7657123469267572077" onmouseenter="enter('7657123469267572077');" onmouseout="out('7657123469267572077');" style=""> 929              Cursor c = db.rawQuery(&quot;SELECT * FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot; WHERE &quot;                         </span>
<span class="1858055579641267103" onmouseenter="enter('1858055579641267103');" onmouseout="out('1858055579641267103');" style=""> 930                      + LauncherSettings.WorkspaceScreens._ID + &quot; = &quot; + screenId, null);                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 931              if (c != null) {                                                                                      </span>
<span class="-7874906179005583875" onmouseenter="enter('-7874906179005583875');" onmouseout="out('-7874906179005583875');" style=""> 932                  int count = c.getCount();                                                                         </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 933                  c.close();                                                                                        </span>
<span class="4255567607434315929" onmouseenter="enter('4255567607434315929');" onmouseout="out('4255567607434315929');" style=""> 934                  return count &gt; 0;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 935              } else {                                                                                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 936                  return false;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 937              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 938          }                                                                                                         </span>
<span  style=""> 939                                                                                                                    </span>
<span class="-2708828914383579811" onmouseenter="enter('-2708828914383579811');" onmouseout="out('-2708828914383579811');" style=""> 940          private int getMaxScreenRank() {                                                                          </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 941              SQLiteDatabase db = getWritableDatabase();                                                            </span>
<span class="4567502420956726358" onmouseenter="enter('4567502420956726358');" onmouseout="out('4567502420956726358');" style=""> 942              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens.SCREEN_RANK                  </span>
<span class="-851271521804486447" onmouseenter="enter('-851271521804486447');" onmouseout="out('-851271521804486447');" style=""> 943                      + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);                                                 </span>
<span  style=""> 944                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 945              // get the result                                                                                     </span>
<span class="-7089673966704675292" onmouseenter="enter('-7089673966704675292');" onmouseout="out('-7089673966704675292');" style=""> 946              final int maxRankIndex = 0;                                                                           </span>
<span class="8995972804405745177" onmouseenter="enter('8995972804405745177');" onmouseout="out('8995972804405745177');" style=""> 947              int rank = -1;                                                                                        </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 948              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="-130706833968251970" onmouseenter="enter('-130706833968251970');" onmouseout="out('-130706833968251970');" style=""> 949                  rank = c.getInt(maxRankIndex);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 950              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 951              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 952                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 953              }                                                                                                     </span>
<span  style=""> 954                                                                                                                    </span>
<span class="-5061660947414305561" onmouseenter="enter('-5061660947414305561');" onmouseout="out('-5061660947414305561');" style=""> 955              return rank;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 956          }                                                                                                         </span>
<span  style=""> 957                                                                                                                    </span>
<span class="7076012940679285170" onmouseenter="enter('7076012940679285170');" onmouseout="out('7076012940679285170');" style=""> 958          private int loadFavorites(SQLiteDatabase db, AutoInstallsLayout loader) {                                 </span>
<span class="-517932292017625058" onmouseenter="enter('-517932292017625058');" onmouseout="out('-517932292017625058');" style=""> 959              ArrayList&lt;Long&gt; screenIds = new ArrayList&lt;Long&gt;();                                                    </span>
<span class="-1992683231790282850" onmouseenter="enter('-1992683231790282850');" onmouseout="out('-1992683231790282850');" style=""> 960              // TODO: Use multiple loaders with fall-back and transaction.                                         </span>
<span class="-198133332043015666" onmouseenter="enter('-198133332043015666');" onmouseout="out('-198133332043015666');" style=""> 961              int count = loader.loadLayout(db, screenIds);                                                         </span>
<span  style=""> 962                                                                                                                    </span>
<span class="6833875387324148439" onmouseenter="enter('6833875387324148439');" onmouseout="out('6833875387324148439');" style=""> 963              // Add the screens specified by the items above                                                       </span>
<span class="2978539432730983390" onmouseenter="enter('2978539432730983390');" onmouseout="out('2978539432730983390');" style=""> 964              Collections.sort(screenIds);                                                                          </span>
<span class="5419352211080831355" onmouseenter="enter('5419352211080831355');" onmouseout="out('5419352211080831355');" style=""> 965              int rank = 0;                                                                                         </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 966              ContentValues values = new ContentValues();                                                           </span>
<span class="7152107230041712979" onmouseenter="enter('7152107230041712979');" onmouseout="out('7152107230041712979');" style=""> 967              for (Long id : screenIds) {                                                                           </span>
<span class="6295623415315599771" onmouseenter="enter('6295623415315599771');" onmouseout="out('6295623415315599771');" style=""> 968                  values.clear();                                                                                   </span>
<span class="-3523466272369778299" onmouseenter="enter('-3523466272369778299');" onmouseout="out('-3523466272369778299');" style=""> 969                  values.put(LauncherSettings.WorkspaceScreens._ID, id);                                            </span>
<span class="-4819700644573994153" onmouseenter="enter('-4819700644573994153');" onmouseout="out('-4819700644573994153');" style=""> 970                  values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                                  </span>
<span class="-7619796578683976012" onmouseenter="enter('-7619796578683976012');" onmouseout="out('-7619796578683976012');" style=""> 971                  if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values) &lt; 0) {                      </span>
<span class="-4349241721568097596" onmouseenter="enter('-4349241721568097596');" onmouseout="out('-4349241721568097596');" style=""> 972                      throw new RuntimeException(&quot;Failed initialize screen table&quot;                                   </span>
<span class="6358788983404305676" onmouseenter="enter('6358788983404305676');" onmouseout="out('6358788983404305676');" style=""> 973                              + &quot;from default layout&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 974                  }                                                                                                 </span>
<span class="-39828730810908930" onmouseenter="enter('-39828730810908930');" onmouseout="out('-39828730810908930');" style=""> 975                  rank++;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 976              }                                                                                                     </span>
<span  style=""> 977                                                                                                                    </span>
<span class="-1496945990523812752" onmouseenter="enter('-1496945990523812752');" onmouseout="out('-1496945990523812752');" style=""> 978              // Ensure that the max ids are initialized                                                            </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 979              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style=""> 980              mMaxScreenId = initializeMaxScreenId(db);                                                             </span>
<span  style=""> 981                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 982              return count;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 983          }                                                                                                         </span>
<span  style=""> 984                                                                                                                    </span>
<span class="725730754436415996" onmouseenter="enter('725730754436415996');" onmouseout="out('725730754436415996');" style=""> 985          private void migrateLauncher2Shortcuts(SQLiteDatabase db, Uri uri) {                                      </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 986              final ContentResolver resolver = mContext.getContentResolver();                                       </span>
<span class="-3774076673393313717" onmouseenter="enter('-3774076673393313717');" onmouseout="out('-3774076673393313717');" style=""> 987              Cursor c = null;                                                                                      </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 988              int count = 0;                                                                                        </span>
<span class="-3336839334240068207" onmouseenter="enter('-3336839334240068207');" onmouseout="out('-3336839334240068207');" style=""> 989              int curScreen = 0;                                                                                    </span>
<span  style=""> 990                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 991              try {                                                                                                 </span>
<span class="-9000085593458662527" onmouseenter="enter('-9000085593458662527');" onmouseout="out('-9000085593458662527');" style=""> 992                  c = resolver.query(uri, null, null, null, &quot;title ASC&quot;);                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 993              } catch (Exception e) {                                                                               </span>
<span class="-1642344425252950446" onmouseenter="enter('-1642344425252950446');" onmouseout="out('-1642344425252950446');" style=""> 994                  // Ignore                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 995              }                                                                                                     </span>
<span  style=""> 996                                                                                                                    </span>
<span class="-8364191572061005786" onmouseenter="enter('-8364191572061005786');" onmouseout="out('-8364191572061005786');" style=""> 997              // We already have a favorites database in the old provider                                           </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 998              if (c != null) {                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 999                  try {                                                                                             </span>
<span class="-7145577210477193493" onmouseenter="enter('-7145577210477193493');" onmouseout="out('-7145577210477193493');" style="">1000                      if (c.getCount() &gt; 0) {                                                                       </span>
<span class="574469590853725413" onmouseenter="enter('574469590853725413');" onmouseout="out('574469590853725413');" style="">1001                          final int idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);              </span>
<span class="-3305857310034960574" onmouseenter="enter('-3305857310034960574');" onmouseout="out('-3305857310034960574');" style="">1002                          final int intentIndex                                                                     </span>
<span class="7354730669796853916" onmouseenter="enter('7354730669796853916');" onmouseout="out('7354730669796853916');" style="">1003                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);                     </span>
<span class="-5630883347545993547" onmouseenter="enter('-5630883347545993547');" onmouseout="out('-5630883347545993547');" style="">1004                          final int titleIndex                                                                      </span>
<span class="698330273931132471" onmouseenter="enter('698330273931132471');" onmouseout="out('698330273931132471');" style="">1005                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);                      </span>
<span class="-3330891132272232037" onmouseenter="enter('-3330891132272232037');" onmouseout="out('-3330891132272232037');" style="">1006                          final int iconTypeIndex                                                                   </span>
<span class="7801651150775381680" onmouseenter="enter('7801651150775381680');" onmouseout="out('7801651150775381680');" style="">1007                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);                  </span>
<span class="-1496515754016715409" onmouseenter="enter('-1496515754016715409');" onmouseout="out('-1496515754016715409');" style="">1008                          final int iconIndex                                                                       </span>
<span class="-6743710571640483882" onmouseenter="enter('-6743710571640483882');" onmouseout="out('-6743710571640483882');" style="">1009                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);                       </span>
<span class="-4968513115427762421" onmouseenter="enter('-4968513115427762421');" onmouseout="out('-4968513115427762421');" style="">1010                          final int iconPackageIndex                                                                </span>
<span class="6406994869194943351" onmouseenter="enter('6406994869194943351');" onmouseout="out('6406994869194943351');" style="">1011                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);               </span>
<span class="7917018656335895183" onmouseenter="enter('7917018656335895183');" onmouseout="out('7917018656335895183');" style="">1012                          final int iconResourceIndex                                                               </span>
<span class="2805080254532821790" onmouseenter="enter('2805080254532821790');" onmouseout="out('2805080254532821790');" style="">1013                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);              </span>
<span class="-4237567403763432926" onmouseenter="enter('-4237567403763432926');" onmouseout="out('-4237567403763432926');" style="">1014                          final int containerIndex                                                                  </span>
<span class="-5056484222025497452" onmouseenter="enter('-5056484222025497452');" onmouseout="out('-5056484222025497452');" style="">1015                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);                  </span>
<span class="-1231922168250187193" onmouseenter="enter('-1231922168250187193');" onmouseout="out('-1231922168250187193');" style="">1016                          final int itemTypeIndex                                                                   </span>
<span class="4225538929397018586" onmouseenter="enter('4225538929397018586');" onmouseout="out('4225538929397018586');" style="">1017                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);                  </span>
<span class="1886064968207935621" onmouseenter="enter('1886064968207935621');" onmouseout="out('1886064968207935621');" style="">1018                          final int screenIndex                                                                     </span>
<span class="5823358741192050359" onmouseenter="enter('5823358741192050359');" onmouseout="out('5823358741192050359');" style="">1019                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);                     </span>
<span class="148786652433469700" onmouseenter="enter('148786652433469700');" onmouseout="out('148786652433469700');" style="">1020                          final int cellXIndex                                                                      </span>
<span class="-2420213882448561608" onmouseenter="enter('-2420213882448561608');" onmouseout="out('-2420213882448561608');" style="">1021                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);                      </span>
<span class="7105291823960507491" onmouseenter="enter('7105291823960507491');" onmouseout="out('7105291823960507491');" style="">1022                          final int cellYIndex                                                                      </span>
<span class="570222995967736070" onmouseenter="enter('570222995967736070');" onmouseout="out('570222995967736070');" style="">1023                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);                      </span>
<span class="-6657516663903609513" onmouseenter="enter('-6657516663903609513');" onmouseout="out('-6657516663903609513');" style="">1024                          final int uriIndex                                                                        </span>
<span class="-7627325667289175305" onmouseenter="enter('-7627325667289175305');" onmouseout="out('-7627325667289175305');" style="">1025                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);                        </span>
<span class="3126191733073545935" onmouseenter="enter('3126191733073545935');" onmouseout="out('3126191733073545935');" style="">1026                          final int displayModeIndex                                                                </span>
<span class="5824024113471232605" onmouseenter="enter('5824024113471232605');" onmouseout="out('5824024113471232605');" style="">1027                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);               </span>
<span class="6969636044710489163" onmouseenter="enter('6969636044710489163');" onmouseout="out('6969636044710489163');" style="">1028                          final int profileIndex                                                                    </span>
<span class="-4394079448083019726" onmouseenter="enter('-4394079448083019726');" onmouseout="out('-4394079448083019726');" style="">1029                                  = c.getColumnIndex(LauncherSettings.Favorites.PROFILE_ID);                        </span>
<span  style="">1030                                                                                                                    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="">1031                          int i = 0;                                                                                </span>
<span class="3196084964022358374" onmouseenter="enter('3196084964022358374');" onmouseout="out('3196084964022358374');" style="">1032                          int curX = 0;                                                                             </span>
<span class="-8919994129307273415" onmouseenter="enter('-8919994129307273415');" onmouseout="out('-8919994129307273415');" style="">1033                          int curY = 0;                                                                             </span>
<span  style="">1034                                                                                                                    </span>
<span class="1185328747399966274" onmouseenter="enter('1185328747399966274');" onmouseout="out('1185328747399966274');" style="">1035                          final LauncherAppState app = LauncherAppState.getInstance();                              </span>
<span class="7124839587395892858" onmouseenter="enter('7124839587395892858');" onmouseout="out('7124839587395892858');" style="">1036                          final DeviceProfile grid = app.getDynamicGrid().getDeviceProfile();                       </span>
<span class="690371396691664791" onmouseenter="enter('690371396691664791');" onmouseout="out('690371396691664791');" style="">1037                          final int width = (int) grid.numColumns;                                                  </span>
<span class="-5064901428253886355" onmouseenter="enter('-5064901428253886355');" onmouseout="out('-5064901428253886355');" style="">1038                          final int height = (int) grid.numRows;                                                    </span>
<span class="-4109722385928167056" onmouseenter="enter('-4109722385928167056');" onmouseout="out('-4109722385928167056');" style="">1039                          final int hotseatWidth = (int) grid.numHotseatIcons;                                      </span>
<span  style="">1040                                                                                                                    </span>
<span class="-4392487977825691924" onmouseenter="enter('-4392487977825691924');" onmouseout="out('-4392487977825691924');" style="">1041                          final HashSet&lt;String&gt; seenIntents = new HashSet&lt;String&gt;(c.getCount());                    </span>
<span  style="">1042                                                                                                                    </span>
<span class="-1775881703038933069" onmouseenter="enter('-1775881703038933069');" onmouseout="out('-1775881703038933069');" style="">1043                          final ArrayList&lt;ContentValues&gt; shortcuts = new ArrayList&lt;ContentValues&gt;();                </span>
<span class="-5282219486258454454" onmouseenter="enter('-5282219486258454454');" onmouseout="out('-5282219486258454454');" style="">1044                          final ArrayList&lt;ContentValues&gt; folders = new ArrayList&lt;ContentValues&gt;();                  </span>
<span class="7748304206224281059" onmouseenter="enter('7748304206224281059');" onmouseout="out('7748304206224281059');" style="">1045                          final SparseArray&lt;ContentValues&gt; hotseat = new SparseArray&lt;ContentValues&gt;();              </span>
<span  style="">1046                                                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style="">1047                          while (c.moveToNext()) {                                                                  </span>
<span class="-2982692859195643614" onmouseenter="enter('-2982692859195643614');" onmouseout="out('-2982692859195643614');" style="">1048                              final int itemType = c.getInt(itemTypeIndex);                                         </span>
<span class="-7155300134759553393" onmouseenter="enter('-7155300134759553393');" onmouseout="out('-7155300134759553393');" style="">1049                              if (itemType != Favorites.ITEM_TYPE_APPLICATION                                       </span>
<span class="-6505147694408678007" onmouseenter="enter('-6505147694408678007');" onmouseout="out('-6505147694408678007');" style="">1050                                      &amp;&amp; itemType != Favorites.ITEM_TYPE_SHORTCUT                                   </span>
<span class="-1211279440538129484" onmouseenter="enter('-1211279440538129484');" onmouseout="out('-1211279440538129484');" style="">1051                                      &amp;&amp; itemType != Favorites.ITEM_TYPE_FOLDER) {                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1052                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1053                              }                                                                                     </span>
<span  style="">1054                                                                                                                    </span>
<span class="6546086433507254477" onmouseenter="enter('6546086433507254477');" onmouseout="out('6546086433507254477');" style="">1055                              final int cellX = c.getInt(cellXIndex);                                               </span>
<span class="-5848765603231722693" onmouseenter="enter('-5848765603231722693');" onmouseout="out('-5848765603231722693');" style="">1056                              final int cellY = c.getInt(cellYIndex);                                               </span>
<span class="5057139106655212954" onmouseenter="enter('5057139106655212954');" onmouseout="out('5057139106655212954');" style="">1057                              final int screen = c.getInt(screenIndex);                                             </span>
<span class="-6682259384170717005" onmouseenter="enter('-6682259384170717005');" onmouseout="out('-6682259384170717005');" style="">1058                              int container = c.getInt(containerIndex);                                             </span>
<span class="-3517014905521526588" onmouseenter="enter('-3517014905521526588');" onmouseout="out('-3517014905521526588');" style="">1059                              final String intentStr = c.getString(intentIndex);                                    </span>
<span  style="">1060                                                                                                                    </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style="">1061                              UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);              </span>
<span class="7210862209025052290" onmouseenter="enter('7210862209025052290');" onmouseout="out('7210862209025052290');" style="">1062                              UserHandleCompat userHandle;                                                          </span>
<span class="-704754462563124721" onmouseenter="enter('-704754462563124721');" onmouseout="out('-704754462563124721');" style="">1063                              final long userSerialNumber;                                                          </span>
<span class="-3188525411347809180" onmouseenter="enter('-3188525411347809180');" onmouseout="out('-3188525411347809180');" style="">1064                              if (profileIndex != -1 &amp;&amp; !c.isNull(profileIndex)) {                                  </span>
<span class="3377600326593357797" onmouseenter="enter('3377600326593357797');" onmouseout="out('3377600326593357797');" style="">1065                                  userSerialNumber = c.getInt(profileIndex);                                        </span>
<span class="-5580723935665666817" onmouseenter="enter('-5580723935665666817');" onmouseout="out('-5580723935665666817');" style="">1066                                  userHandle = userManager.getUserForSerialNumber(userSerialNumber);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1067                              } else {                                                                              </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style="">1068                                  // Default to the serial number of this user, for older                           </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style="">1069                                  // shortcuts.                                                                     </span>
<span class="153827185233038497" onmouseenter="enter('153827185233038497');" onmouseout="out('153827185233038497');" style="">1070                                  userHandle = UserHandleCompat.myUserHandle();                                     </span>
<span class="-7992210937529459410" onmouseenter="enter('-7992210937529459410');" onmouseout="out('-7992210937529459410');" style="">1071                                  userSerialNumber = userManager.getSerialNumberForUser(userHandle);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1072                              }                                                                                     </span>
<span  style="">1073                                                                                                                    </span>
<span class="-5734975396466070409" onmouseenter="enter('-5734975396466070409');" onmouseout="out('-5734975396466070409');" style="">1074                              if (userHandle == null) {                                                             </span>
<span class="8825647937501871391" onmouseenter="enter('8825647937501871391');" onmouseout="out('8825647937501871391');" style="">1075                                  Launcher.addDumpLog(TAG, &quot;skipping deleted user&quot;, true);                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1076                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1077                              }                                                                                     </span>
<span  style="">1078                                                                                                                    </span>
<span class="-8522267007848438017" onmouseenter="enter('-8522267007848438017');" onmouseout="out('-8522267007848438017');" style="">1079                              Launcher.addDumpLog(TAG, &quot;migrating \&quot;&quot;                                               </span>
<span class="5716371482803525639" onmouseenter="enter('5716371482803525639');" onmouseout="out('5716371482803525639');" style="">1080                                  + c.getString(titleIndex) + &quot;\&quot; (&quot;                                                </span>
<span class="1581718899431916610" onmouseenter="enter('1581718899431916610');" onmouseout="out('1581718899431916610');" style="">1081                                  + cellX + &quot;,&quot; + cellY + &quot;@&quot;                                                       </span>
<span class="-5433460809722614707" onmouseenter="enter('-5433460809722614707');" onmouseout="out('-5433460809722614707');" style="">1082                                  + LauncherSettings.Favorites.containerToString(container)                         </span>
<span class="7963207375316982791" onmouseenter="enter('7963207375316982791');" onmouseout="out('7963207375316982791');" style="">1083                                  + &quot;/&quot; + screen                                                                    </span>
<span class="6018191721230485089" onmouseenter="enter('6018191721230485089');" onmouseout="out('6018191721230485089');" style="">1084                                  + &quot;): &quot; + intentStr, true);                                                       </span>
<span  style="">1085                                                                                                                    </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1086                              if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                         </span>
<span  style="">1087                                                                                                                    </span>
<span class="-3217378244605518341" onmouseenter="enter('-3217378244605518341');" onmouseout="out('-3217378244605518341');" style="">1088                                  final Intent intent;                                                              </span>
<span class="-6604091625193940309" onmouseenter="enter('-6604091625193940309');" onmouseout="out('-6604091625193940309');" style="">1089                                  final ComponentName cn;                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1090                                  try {                                                                             </span>
<span class="-5300012287142621419" onmouseenter="enter('-5300012287142621419');" onmouseout="out('-5300012287142621419');" style="">1091                                      intent = Intent.parseUri(intentStr, 0);                                       </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style="">1092                                  } catch (URISyntaxException e) {                                                  </span>
<span class="4944972948248133238" onmouseenter="enter('4944972948248133238');" onmouseout="out('4944972948248133238');" style="">1093                                      // bogus intent?                                                              </span>
<span class="8337166236749198483" onmouseenter="enter('8337166236749198483');" onmouseout="out('8337166236749198483');" style="">1094                                      Launcher.addDumpLog(TAG,                                                      </span>
<span class="7306432149085172440" onmouseenter="enter('7306432149085172440');" onmouseout="out('7306432149085172440');" style="">1095                                              &quot;skipping invalid intent uri&quot;, true);                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1096                                      continue;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1097                                  }                                                                                 </span>
<span  style="">1098                                                                                                                    </span>
<span class="6421562153709548736" onmouseenter="enter('6421562153709548736');" onmouseout="out('6421562153709548736');" style="">1099                                  cn = intent.getComponent();                                                       </span>
<span class="1165574592669081424" onmouseenter="enter('1165574592669081424');" onmouseout="out('1165574592669081424');" style="">1100                                  if (TextUtils.isEmpty(intentStr)) {                                               </span>
<span class="1109263052506568546" onmouseenter="enter('1109263052506568546');" onmouseout="out('1109263052506568546');" style="">1101                                      // no intent? no icon                                                         </span>
<span class="-2999961336534157526" onmouseenter="enter('-2999961336534157526');" onmouseout="out('-2999961336534157526');" style="">1102                                      Launcher.addDumpLog(TAG, &quot;skipping empty intent&quot;, true);                      </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1103                                      continue;                                                                     </span>
<span class="-9117039092771941538" onmouseenter="enter('-9117039092771941538');" onmouseout="out('-9117039092771941538');" style="">1104                                  } else if (cn != null &amp;&amp;                                                          </span>
<span class="-3538782463140269707" onmouseenter="enter('-3538782463140269707');" onmouseout="out('-3538782463140269707');" style="">1105                                          !LauncherModel.isValidPackageActivity(mContext, cn,                       </span>
<span class="2012568974631198883" onmouseenter="enter('2012568974631198883');" onmouseout="out('2012568974631198883');" style="">1106                                                  userHandle)) {                                                    </span>
<span class="-8462735888325815955" onmouseenter="enter('-8462735888325815955');" onmouseout="out('-8462735888325815955');" style="">1107                                      // component no longer exists.                                                </span>
<span class="8244127631099782564" onmouseenter="enter('8244127631099782564');" onmouseout="out('8244127631099782564');" style="">1108                                      Launcher.addDumpLog(TAG, &quot;skipping item whose component &quot; +                   </span>
<span class="-2271033079359571531" onmouseenter="enter('-2271033079359571531');" onmouseout="out('-2271033079359571531');" style="">1109                                              &quot;no longer exists.&quot;, true);                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1110                                      continue;                                                                     </span>
<span class="1808399553142797413" onmouseenter="enter('1808399553142797413');" onmouseout="out('1808399553142797413');" style="">1111                                  } else if (container ==                                                           </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1112                                          LauncherSettings.Favorites.CONTAINER_DESKTOP) {                           </span>
<span class="-6651088913311152009" onmouseenter="enter('-6651088913311152009');" onmouseout="out('-6651088913311152009');" style="">1113                                      // Dedupe icons directly on the workspace                                     </span>
<span  style="">1114                                                                                                                    </span>
<span class="-7857209544272892433" onmouseenter="enter('-7857209544272892433');" onmouseout="out('-7857209544272892433');" style="">1115                                      // Canonicalize                                                               </span>
<span class="-8986671765649789370" onmouseenter="enter('-8986671765649789370');" onmouseout="out('-8986671765649789370');" style="">1116                                      // the Play Store sets the package parameter, but Launcher                    </span>
<span class="-2685712344279555181" onmouseenter="enter('-2685712344279555181');" onmouseout="out('-2685712344279555181');" style="">1117                                      // does not, so we clear that out to keep them the same.                      </span>
<span class="-1462576698638737516" onmouseenter="enter('-1462576698638737516');" onmouseout="out('-1462576698638737516');" style="">1118                                      // Also ignore intent flags for the purposes of deduping.                     </span>
<span class="-3363694106044374937" onmouseenter="enter('-3363694106044374937');" onmouseout="out('-3363694106044374937');" style="">1119                                      intent.setPackage(null);                                                      </span>
<span class="-3409071973040894037" onmouseenter="enter('-3409071973040894037');" onmouseout="out('-3409071973040894037');" style="">1120                                      int flags = intent.getFlags();                                                </span>
<span class="547103070058811611" onmouseenter="enter('547103070058811611');" onmouseout="out('547103070058811611');" style="">1121                                      intent.setFlags(0);                                                           </span>
<span class="-947990318544641084" onmouseenter="enter('-947990318544641084');" onmouseout="out('-947990318544641084');" style="">1122                                      final String key = intent.toUri(0);                                           </span>
<span class="-7327331133269780521" onmouseenter="enter('-7327331133269780521');" onmouseout="out('-7327331133269780521');" style="">1123                                      intent.setFlags(flags);                                                       </span>
<span class="7480204102005082432" onmouseenter="enter('7480204102005082432');" onmouseout="out('7480204102005082432');" style="">1124                                      if (seenIntents.contains(key)) {                                              </span>
<span class="2006049222885589498" onmouseenter="enter('2006049222885589498');" onmouseout="out('2006049222885589498');" style="">1125                                          Launcher.addDumpLog(TAG, &quot;skipping duplicate&quot;, true);                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1126                                          continue;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1127                                      } else {                                                                      </span>
<span class="4653019047206831387" onmouseenter="enter('4653019047206831387');" onmouseout="out('4653019047206831387');" style="">1128                                          seenIntents.add(key);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1129                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1130                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1131                              }                                                                                     </span>
<span  style="">1132                                                                                                                    </span>
<span class="-3805379390248188389" onmouseenter="enter('-3805379390248188389');" onmouseout="out('-3805379390248188389');" style="">1133                              ContentValues values = new ContentValues(c.getColumnCount());                         </span>
<span class="2787548740347733717" onmouseenter="enter('2787548740347733717');" onmouseout="out('2787548740347733717');" style="">1134                              values.put(LauncherSettings.Favorites._ID, c.getInt(idIndex));                        </span>
<span class="4552396250235420866" onmouseenter="enter('4552396250235420866');" onmouseout="out('4552396250235420866');" style="">1135                              values.put(LauncherSettings.Favorites.INTENT, intentStr);                             </span>
<span class="3080545696092648727" onmouseenter="enter('3080545696092648727');" onmouseout="out('3080545696092648727');" style="">1136                              values.put(LauncherSettings.Favorites.TITLE, c.getString(titleIndex));                </span>
<span class="8877369206974054200" onmouseenter="enter('8877369206974054200');" onmouseout="out('8877369206974054200');" style="">1137                              values.put(LauncherSettings.Favorites.ICON_TYPE,                                      </span>
<span class="8705323818259019594" onmouseenter="enter('8705323818259019594');" onmouseout="out('8705323818259019594');" style="">1138                                      c.getInt(iconTypeIndex));                                                     </span>
<span class="3857475807367449049" onmouseenter="enter('3857475807367449049');" onmouseout="out('3857475807367449049');" style="">1139                              values.put(LauncherSettings.Favorites.ICON, c.getBlob(iconIndex));                    </span>
<span class="-7054095546130863513" onmouseenter="enter('-7054095546130863513');" onmouseout="out('-7054095546130863513');" style="">1140                              values.put(LauncherSettings.Favorites.ICON_PACKAGE,                                   </span>
<span class="-4377124255190457588" onmouseenter="enter('-4377124255190457588');" onmouseout="out('-4377124255190457588');" style="">1141                                      c.getString(iconPackageIndex));                                               </span>
<span class="7491883888231273974" onmouseenter="enter('7491883888231273974');" onmouseout="out('7491883888231273974');" style="">1142                              values.put(LauncherSettings.Favorites.ICON_RESOURCE,                                  </span>
<span class="-14487948683300389" onmouseenter="enter('-14487948683300389');" onmouseout="out('-14487948683300389');" style="">1143                                      c.getString(iconResourceIndex));                                              </span>
<span class="5180659022499168410" onmouseenter="enter('5180659022499168410');" onmouseout="out('5180659022499168410');" style="">1144                              values.put(LauncherSettings.Favorites.ITEM_TYPE, itemType);                           </span>
<span class="2567875359902744917" onmouseenter="enter('2567875359902744917');" onmouseout="out('2567875359902744917');" style="">1145                              values.put(LauncherSettings.Favorites.APPWIDGET_ID, -1);                              </span>
<span class="-3897523412202294315" onmouseenter="enter('-3897523412202294315');" onmouseout="out('-3897523412202294315');" style="">1146                              values.put(LauncherSettings.Favorites.URI, c.getString(uriIndex));                    </span>
<span class="8253479465859182990" onmouseenter="enter('8253479465859182990');" onmouseout="out('8253479465859182990');" style="">1147                              values.put(LauncherSettings.Favorites.DISPLAY_MODE,                                   </span>
<span class="-8416795076296111227" onmouseenter="enter('-8416795076296111227');" onmouseout="out('-8416795076296111227');" style="">1148                                      c.getInt(displayModeIndex));                                                  </span>
<span class="-1880957120536425376" onmouseenter="enter('-1880957120536425376');" onmouseout="out('-1880957120536425376');" style="">1149                              values.put(LauncherSettings.Favorites.PROFILE_ID, userSerialNumber);                  </span>
<span  style="">1150                                                                                                                    </span>
<span class="-216205184326719357" onmouseenter="enter('-216205184326719357');" onmouseout="out('-216205184326719357');" style="">1151                              if (container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {                      </span>
<span class="2845166931909672251" onmouseenter="enter('2845166931909672251');" onmouseout="out('2845166931909672251');" style="">1152                                  hotseat.put(screen, values);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1153                              }                                                                                     </span>
<span  style="">1154                                                                                                                    </span>
<span class="-8534427976726701331" onmouseenter="enter('-8534427976726701331');" onmouseout="out('-8534427976726701331');" style="">1155                              if (container != LauncherSettings.Favorites.CONTAINER_DESKTOP) {                      </span>
<span class="3724214252155726452" onmouseenter="enter('3724214252155726452');" onmouseout="out('3724214252155726452');" style="">1156                                  // In a folder or in the hotseat, preserve position                               </span>
<span class="4993135311254983149" onmouseenter="enter('4993135311254983149');" onmouseout="out('4993135311254983149');" style="">1157                                  values.put(LauncherSettings.Favorites.SCREEN, screen);                            </span>
<span class="-7735658353589578952" onmouseenter="enter('-7735658353589578952');" onmouseout="out('-7735658353589578952');" style="">1158                                  values.put(LauncherSettings.Favorites.CELLX, cellX);                              </span>
<span class="-6596875348392322090" onmouseenter="enter('-6596875348392322090');" onmouseout="out('-6596875348392322090');" style="">1159                                  values.put(LauncherSettings.Favorites.CELLY, cellY);                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1160                              } else {                                                                              </span>
<span class="-6079732280628496127" onmouseenter="enter('-6079732280628496127');" onmouseout="out('-6079732280628496127');" style="">1161                                  // For items contained directly on one of the workspace screen,                   </span>
<span class="-850513443108501253" onmouseenter="enter('-850513443108501253');" onmouseout="out('-850513443108501253');" style="">1162                                  // we&#x27;ll determine their location (screen, x, y) in a second pass.                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1163                              }                                                                                     </span>
<span  style="">1164                                                                                                                    </span>
<span class="7684212050113439789" onmouseenter="enter('7684212050113439789');" onmouseout="out('7684212050113439789');" style="">1165                              values.put(LauncherSettings.Favorites.CONTAINER, container);                          </span>
<span  style="">1166                                                                                                                    </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1167                              if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                         </span>
<span class="-7897547558000712151" onmouseenter="enter('-7897547558000712151');" onmouseout="out('-7897547558000712151');" style="">1168                                  shortcuts.add(values);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1169                              } else {                                                                              </span>
<span class="5214044302935278086" onmouseenter="enter('5214044302935278086');" onmouseout="out('5214044302935278086');" style="">1170                                  folders.add(values);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1171                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1172                          }                                                                                         </span>
<span  style="">1173                                                                                                                    </span>
<span class="3792333482677793462" onmouseenter="enter('3792333482677793462');" onmouseout="out('3792333482677793462');" style="">1174                          // Now that we have all the hotseat icons, let&#x27;s go through them left-right               </span>
<span class="6853065735140319510" onmouseenter="enter('6853065735140319510');" onmouseout="out('6853065735140319510');" style="">1175                          // and assign valid locations for them in the new hotseat                                 </span>
<span class="-382900916992065291" onmouseenter="enter('-382900916992065291');" onmouseout="out('-382900916992065291');" style="">1176                          final int N = hotseat.size();                                                             </span>
<span class="9016073461123662191" onmouseenter="enter('9016073461123662191');" onmouseout="out('9016073461123662191');" style="">1177                          for (int idx=0; idx&lt;N; idx++) {                                                           </span>
<span class="-7027280347801461154" onmouseenter="enter('-7027280347801461154');" onmouseout="out('-7027280347801461154');" style="">1178                              int hotseatX = hotseat.keyAt(idx);                                                    </span>
<span class="7267222979225491944" onmouseenter="enter('7267222979225491944');" onmouseout="out('7267222979225491944');" style="">1179                              ContentValues values = hotseat.valueAt(idx);                                          </span>
<span  style="">1180                                                                                                                    </span>
<span class="-3018245694205955067" onmouseenter="enter('-3018245694205955067');" onmouseout="out('-3018245694205955067');" style="">1181                              if (hotseatX == grid.hotseatAllAppsRank) {                                            </span>
<span class="-8495735509078642350" onmouseenter="enter('-8495735509078642350');" onmouseout="out('-8495735509078642350');" style="">1182                                  // let&#x27;s drop this in the next available hole in the hotseat                      </span>
<span class="-2055954181227443816" onmouseenter="enter('-2055954181227443816');" onmouseout="out('-2055954181227443816');" style="">1183                                  while (++hotseatX &lt; hotseatWidth) {                                               </span>
<span class="-5595819560409222327" onmouseenter="enter('-5595819560409222327');" onmouseout="out('-5595819560409222327');" style="">1184                                      if (hotseat.get(hotseatX) == null) {                                          </span>
<span class="2131484666649578366" onmouseenter="enter('2131484666649578366');" onmouseout="out('2131484666649578366');" style="">1185                                          // found a spot! move it here                                             </span>
<span class="325808457439646533" onmouseenter="enter('325808457439646533');" onmouseout="out('325808457439646533');" style="">1186                                          values.put(LauncherSettings.Favorites.SCREEN,                             </span>
<span class="8014085861051867033" onmouseenter="enter('8014085861051867033');" onmouseout="out('8014085861051867033');" style="">1187                                                  hotseatX);                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1188                                          break;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1189                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1190                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1191                              }                                                                                     </span>
<span class="4361559665402156368" onmouseenter="enter('4361559665402156368');" onmouseout="out('4361559665402156368');" style="">1192                              if (hotseatX &gt;= hotseatWidth) {                                                       </span>
<span class="198406244599777154" onmouseenter="enter('198406244599777154');" onmouseout="out('198406244599777154');" style="">1193                                  // no room for you in the hotseat? it&#x27;s off to the desktop with you               </span>
<span class="274548545061036766" onmouseenter="enter('274548545061036766');" onmouseout="out('274548545061036766');" style="">1194                                  values.put(LauncherSettings.Favorites.CONTAINER,                                  </span>
<span class="951133373394890183" onmouseenter="enter('951133373394890183');" onmouseout="out('951133373394890183');" style="">1195                                             Favorites.CONTAINER_DESKTOP);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1196                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1197                          }                                                                                         </span>
<span  style="">1198                                                                                                                    </span>
<span class="4538029778921500049" onmouseenter="enter('4538029778921500049');" onmouseout="out('4538029778921500049');" style="">1199                          final ArrayList&lt;ContentValues&gt; allItems = new ArrayList&lt;ContentValues&gt;();                 </span>
<span class="-4972040190483698817" onmouseenter="enter('-4972040190483698817');" onmouseout="out('-4972040190483698817');" style="">1200                          // Folders first                                                                          </span>
<span class="1607706518732535744" onmouseenter="enter('1607706518732535744');" onmouseout="out('1607706518732535744');" style="">1201                          allItems.addAll(folders);                                                                 </span>
<span class="2106236708914116763" onmouseenter="enter('2106236708914116763');" onmouseout="out('2106236708914116763');" style="">1202                          // Then shortcuts                                                                         </span>
<span class="-1250372864837547145" onmouseenter="enter('-1250372864837547145');" onmouseout="out('-1250372864837547145');" style="">1203                          allItems.addAll(shortcuts);                                                               </span>
<span  style="">1204                                                                                                                    </span>
<span class="-2195882050879177813" onmouseenter="enter('-2195882050879177813');" onmouseout="out('-2195882050879177813');" style="">1205                          // Layout all the folders                                                                 </span>
<span class="-252665973237041297" onmouseenter="enter('-252665973237041297');" onmouseout="out('-252665973237041297');" style="">1206                          for (ContentValues values: allItems) {                                                    </span>
<span class="-6238460523304059987" onmouseenter="enter('-6238460523304059987');" onmouseout="out('-6238460523304059987');" style="">1207                              if (values.getAsInteger(LauncherSettings.Favorites.CONTAINER) !=                      </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1208                                      LauncherSettings.Favorites.CONTAINER_DESKTOP) {                               </span>
<span class="4544740026899945117" onmouseenter="enter('4544740026899945117');" onmouseout="out('4544740026899945117');" style="">1209                                  // Hotseat items and folder items have already had their                          </span>
<span class="9061827072000509027" onmouseenter="enter('9061827072000509027');" onmouseout="out('9061827072000509027');" style="">1210                                  // location information set. Nothing to be done here.                             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1211                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1212                              }                                                                                     </span>
<span class="851641135220662264" onmouseenter="enter('851641135220662264');" onmouseout="out('851641135220662264');" style="">1213                              values.put(LauncherSettings.Favorites.SCREEN, curScreen);                             </span>
<span class="-1049962748703223150" onmouseenter="enter('-1049962748703223150');" onmouseout="out('-1049962748703223150');" style="">1214                              values.put(LauncherSettings.Favorites.CELLX, curX);                                   </span>
<span class="-5258025824110848668" onmouseenter="enter('-5258025824110848668');" onmouseout="out('-5258025824110848668');" style="">1215                              values.put(LauncherSettings.Favorites.CELLY, curY);                                   </span>
<span class="1910082031532915038" onmouseenter="enter('1910082031532915038');" onmouseout="out('1910082031532915038');" style="">1216                              curX = (curX + 1) % width;                                                            </span>
<span class="-7155276018455302787" onmouseenter="enter('-7155276018455302787');" onmouseout="out('-7155276018455302787');" style="">1217                              if (curX == 0) {                                                                      </span>
<span class="2376495568180329749" onmouseenter="enter('2376495568180329749');" onmouseout="out('2376495568180329749');" style="">1218                                  curY = (curY + 1);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1219                              }                                                                                     </span>
<span class="-4531638622721531414" onmouseenter="enter('-4531638622721531414');" onmouseout="out('-4531638622721531414');" style="">1220                              // Leave the last row of icons blank on every screen                                  </span>
<span class="-5543182397018270277" onmouseenter="enter('-5543182397018270277');" onmouseout="out('-5543182397018270277');" style="">1221                              if (curY == height - 1) {                                                             </span>
<span class="-6657705079427553715" onmouseenter="enter('-6657705079427553715');" onmouseout="out('-6657705079427553715');" style="">1222                                  curScreen = (int) generateNewScreenId();                                          </span>
<span class="4679043716901678926" onmouseenter="enter('4679043716901678926');" onmouseout="out('4679043716901678926');" style="">1223                                  curY = 0;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1224                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1225                          }                                                                                         </span>
<span  style="">1226                                                                                                                    </span>
<span class="1853917526349173349" onmouseenter="enter('1853917526349173349');" onmouseout="out('1853917526349173349');" style="">1227                          if (allItems.size() &gt; 0) {                                                                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1228                              db.beginTransaction();                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1229                              try {                                                                                 </span>
<span class="-7256059133012813079" onmouseenter="enter('-7256059133012813079');" onmouseout="out('-7256059133012813079');" style="">1230                                  for (ContentValues row: allItems) {                                               </span>
<span class="3155601228699925770" onmouseenter="enter('3155601228699925770');" onmouseout="out('3155601228699925770');" style="">1231                                      if (row == null) continue;                                                    </span>
<span class="-304018147606180100" onmouseenter="enter('-304018147606180100');" onmouseout="out('-304018147606180100');" style="">1232                                      if (dbInsertAndCheck(this, db, TABLE_FAVORITES, null, row)                    </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1233                                              &lt; 0) {                                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1234                                          return;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1235                                      } else {                                                                      </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style="">1236                                          count++;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1237                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1238                                  }                                                                                 </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1239                                  db.setTransactionSuccessful();                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1240                              } finally {                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1241                                  db.endTransaction();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1242                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1243                          }                                                                                         </span>
<span  style="">1244                                                                                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1245                          db.beginTransaction();                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1246                          try {                                                                                     </span>
<span class="-7150489321946493056" onmouseenter="enter('-7150489321946493056');" onmouseout="out('-7150489321946493056');" style="">1247                              for (i=0; i&lt;=curScreen; i++) {                                                        </span>
<span class="7694375558102178162" onmouseenter="enter('7694375558102178162');" onmouseout="out('7694375558102178162');" style="">1248                                  final ContentValues values = new ContentValues();                                 </span>
<span class="-5225632710651404139" onmouseenter="enter('-5225632710651404139');" onmouseout="out('-5225632710651404139');" style="">1249                                  values.put(LauncherSettings.WorkspaceScreens._ID, i);                             </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="">1250                                  values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                     </span>
<span class="-6007460446232002971" onmouseenter="enter('-6007460446232002971');" onmouseout="out('-6007460446232002971');" style="">1251                                  if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values)             </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1252                                          &lt; 0) {                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1253                                      return;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1254                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1255                              }                                                                                     </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1256                              db.setTransactionSuccessful();                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1257                          } finally {                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1258                              db.endTransaction();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1259                          }                                                                                         </span>
<span  style="">1260                                                                                                                    </span>
<span class="3757730671360045414" onmouseenter="enter('3757730671360045414');" onmouseout="out('3757730671360045414');" style="">1261                          updateFolderItemsRank(db, false);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1262                      }                                                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1263                  } finally {                                                                                       </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1264                      c.close();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1265                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1266              }                                                                                                     </span>
<span  style="">1267                                                                                                                    </span>
<span class="-6182516414964240870" onmouseenter="enter('-6182516414964240870');" onmouseout="out('-6182516414964240870');" style="">1268              Launcher.addDumpLog(TAG, &quot;migrated &quot; + count + &quot; icons from Launcher2 into &quot;                          </span>
<span class="3301967416992773508" onmouseenter="enter('3301967416992773508');" onmouseout="out('3301967416992773508');" style="">1269                      + (curScreen+1) + &quot; screens&quot;, true);                                                          </span>
<span  style="">1270                                                                                                                    </span>
<span class="3355055744209094121" onmouseenter="enter('3355055744209094121');" onmouseout="out('3355055744209094121');" style="">1271              // ensure that new screens are created to hold these icons                                            </span>
<span class="4167333916835222093" onmouseenter="enter('4167333916835222093');" onmouseout="out('4167333916835222093');" style="">1272              setFlagJustLoadedOldDb();                                                                             </span>
<span  style="">1273                                                                                                                    </span>
<span class="2071167438564206442" onmouseenter="enter('2071167438564206442');" onmouseout="out('2071167438564206442');" style="">1274              // Update max IDs; very important since we just grabbed IDs from another database                     </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1275              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1276              mMaxScreenId = initializeMaxScreenId(db);                                                             </span>
<span class="-439077128883569126" onmouseenter="enter('-439077128883569126');" onmouseout="out('-439077128883569126');" style="">1277              if (LOGD) Log.d(TAG, &quot;mMaxItemId: &quot; + mMaxItemId + &quot; mMaxScreenId: &quot; + mMaxScreenId);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1278          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1279      }                                                                                                             </span>
<span  style="">1280                                                                                                                    </span>
<span class="8465274381710394045" onmouseenter="enter('8465274381710394045');" onmouseout="out('8465274381710394045');" style="">1281      static class SqlArguments {                                                                                   </span>
<span class="8122936482838815352" onmouseenter="enter('8122936482838815352');" onmouseout="out('8122936482838815352');" style="">1282          public final String table;                                                                                </span>
<span class="5442590397567481633" onmouseenter="enter('5442590397567481633');" onmouseout="out('5442590397567481633');" style="">1283          public final String where;                                                                                </span>
<span class="-2258632185412795279" onmouseenter="enter('-2258632185412795279');" onmouseout="out('-2258632185412795279');" style="">1284          public final String[] args;                                                                               </span>
<span  style="">1285                                                                                                                    </span>
<span class="538735252304320137" onmouseenter="enter('538735252304320137');" onmouseout="out('538735252304320137');" style="">1286          SqlArguments(Uri url, String where, String[] args) {                                                      </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1287              if (url.getPathSegments().size() == 1) {                                                              </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1288                  this.table = url.getPathSegments().get(0);                                                        </span>
<span class="7181058370626512064" onmouseenter="enter('7181058370626512064');" onmouseout="out('7181058370626512064');" style="">1289                  this.where = where;                                                                               </span>
<span class="8688716567728705492" onmouseenter="enter('8688716567728705492');" onmouseout="out('8688716567728705492');" style="">1290                  this.args = args;                                                                                 </span>
<span class="2325935358302734243" onmouseenter="enter('2325935358302734243');" onmouseout="out('2325935358302734243');" style="">1291              } else if (url.getPathSegments().size() != 2) {                                                       </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1292                  throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                                        </span>
<span class="186586201607437821" onmouseenter="enter('186586201607437821');" onmouseout="out('186586201607437821');" style="">1293              } else if (!TextUtils.isEmpty(where)) {                                                               </span>
<span class="2785963644153593875" onmouseenter="enter('2785963644153593875');" onmouseout="out('2785963644153593875');" style="">1294                  throw new UnsupportedOperationException(&quot;WHERE clause not supported: &quot; + url);                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1295              } else {                                                                                              </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1296                  this.table = url.getPathSegments().get(0);                                                        </span>
<span class="-834356181554398700" onmouseenter="enter('-834356181554398700');" onmouseout="out('-834356181554398700');" style="">1297                  this.where = &quot;_id=&quot; + ContentUris.parseId(url);                                                   </span>
<span class="-7173439380439508667" onmouseenter="enter('-7173439380439508667');" onmouseout="out('-7173439380439508667');" style="">1298                  this.args = null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1299              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1300          }                                                                                                         </span>
<span  style="">1301                                                                                                                    </span>
<span class="5705249208777482684" onmouseenter="enter('5705249208777482684');" onmouseout="out('5705249208777482684');" style="">1302          SqlArguments(Uri url) {                                                                                   </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1303              if (url.getPathSegments().size() == 1) {                                                              </span>
<span class="-594585027826531892" onmouseenter="enter('-594585027826531892');" onmouseout="out('-594585027826531892');" style="">1304                  table = url.getPathSegments().get(0);                                                             </span>
<span class="3938761229458861077" onmouseenter="enter('3938761229458861077');" onmouseout="out('3938761229458861077');" style="">1305                  where = null;                                                                                     </span>
<span class="8940401955607507518" onmouseenter="enter('8940401955607507518');" onmouseout="out('8940401955607507518');" style="">1306                  args = null;                                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1307              } else {                                                                                              </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1308                  throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1309              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1310          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1311      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1312  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="1710841298952644868" onmouseenter="enter('1710841298952644868');" onmouseout="out('1710841298952644868');" style="">   2   * Copyright (C) 2008 The Android Open Source Project                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">  17  package com.android.launcher3;                                                                                    </span>
<span  style="">  18                                                                                                                    </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">  19  import android.appwidget.AppWidgetHost;                                                                           </span>
<span class="8802236814006375919" onmouseenter="enter('8802236814006375919');" onmouseout="out('8802236814006375919');" style="">  20  import android.appwidget.AppWidgetManager;                                                                        </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">  21  import android.content.ComponentName;                                                                             </span>
<span class="550877806393279246" onmouseenter="enter('550877806393279246');" onmouseout="out('550877806393279246');" style="">  22  import android.content.ContentProvider;                                                                           </span>
<span class="3739800667450215943" onmouseenter="enter('3739800667450215943');" onmouseout="out('3739800667450215943');" style="">  23  import android.content.ContentProviderOperation;                                                                  </span>
<span class="-6369732601490611729" onmouseenter="enter('-6369732601490611729');" onmouseout="out('-6369732601490611729');" style="">  24  import android.content.ContentProviderResult;                                                                     </span>
<span class="6126857652515451632" onmouseenter="enter('6126857652515451632');" onmouseout="out('6126857652515451632');" style="">  25  import android.content.ContentResolver;                                                                           </span>
<span class="-9185307499822629" onmouseenter="enter('-9185307499822629');" onmouseout="out('-9185307499822629');" style="">  26  import android.content.ContentUris;                                                                               </span>
<span class="3127723864207259776" onmouseenter="enter('3127723864207259776');" onmouseout="out('3127723864207259776');" style="">  27  import android.content.ContentValues;                                                                             </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  28  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  29  import android.content.Intent;                                                                                    </span>
<span class="-4160670168441716907" onmouseenter="enter('-4160670168441716907');" onmouseout="out('-4160670168441716907');" style="">  30  import android.content.OperationApplicationException;                                                             </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  31  import android.content.SharedPreferences;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  32  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  33  import android.database.Cursor;                                                                                   </span>
<span class="5870833163231201789" onmouseenter="enter('5870833163231201789');" onmouseout="out('5870833163231201789');" style="">  34  import android.database.SQLException;                                                                             </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  35  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="6401548559697116088" onmouseenter="enter('6401548559697116088');" onmouseout="out('6401548559697116088');" style="">  36  import android.database.sqlite.SQLiteOpenHelper;                                                                  </span>
<span class="-1253510085600408435" onmouseenter="enter('-1253510085600408435');" onmouseout="out('-1253510085600408435');" style="">  37  import android.database.sqlite.SQLiteQueryBuilder;                                                                </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  38  import android.net.Uri;                                                                                           </span>
<span class="5635872676092141444" onmouseenter="enter('5635872676092141444');" onmouseout="out('5635872676092141444');" style="">  39  import android.os.StrictMode;                                                                                     </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  40  import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  41  import android.util.Log;                                                                                          </span>
<span class="-1076320969941752510" onmouseenter="enter('-1076320969941752510');" onmouseout="out('-1076320969941752510');" style="">  42  import android.util.SparseArray;                                                                                  </span>
<span  style="">  43                                                                                                                    </span>
<span class="4395110202233918405" onmouseenter="enter('4395110202233918405');" onmouseout="out('4395110202233918405');" style="">  44  import com.android.launcher3.AutoInstallsLayout.LayoutParserCallback;                                             </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  45  import com.android.launcher3.LauncherSettings.Favorites;                                                          </span>
<span class="6372524458266053383" onmouseenter="enter('6372524458266053383');" onmouseout="out('6372524458266053383');" style="">  46  import com.android.launcher3.compat.UserHandleCompat;                                                             </span>
<span class="-8849211230761127863" onmouseenter="enter('-8849211230761127863');" onmouseout="out('-8849211230761127863');" style="">  47  import com.android.launcher3.compat.UserManagerCompat;                                                            </span>
<span class="-7468653447981916815" onmouseenter="enter('-7468653447981916815');" onmouseout="out('-7468653447981916815');" style="">  48  import com.android.launcher3.config.ProviderConfig;                                                               </span>
<span  style="">  49                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  50  import java.io.File;                                                                                              </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  51  import java.net.URISyntaxException;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  52  import java.util.ArrayList;                                                                                       </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53  import java.util.Collections;                                                                                     </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54  import java.util.HashSet;                                                                                         </span>
<span  style="">  55                                                                                                                    </span>
<span class="-5661310118425891821" onmouseenter="enter('-5661310118425891821');" onmouseout="out('-5661310118425891821');" style="">  56  public class LauncherProvider extends ContentProvider {                                                           </span>
<span class="-5301430442842506185" onmouseenter="enter('-5301430442842506185');" onmouseout="out('-5301430442842506185');" style="">  57      private static final String TAG = &quot;Launcher.LauncherProvider&quot;;                                                </span>
<span class="-8469384925954206736" onmouseenter="enter('-8469384925954206736');" onmouseout="out('-8469384925954206736');" style="">  58      private static final boolean LOGD = false;                                                                    </span>
<span  style="">  59                                                                                                                    </span>
<span class="8296161443463465713" onmouseenter="enter('8296161443463465713');" onmouseout="out('8296161443463465713');" style="">  60      private static final int MIN_DATABASE_VERSION = 12;                                                           </span>
<span class="-4449901048814672092" onmouseenter="enter('-4449901048814672092');" onmouseout="out('-4449901048814672092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -    private static final int DATABASE_VERSION = 21;                                                               </span>
<span class="9152615363478404775" onmouseenter="enter('9152615363478404775');" onmouseout="out('9152615363478404775');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +    private static final int DATABASE_VERSION = 22;                                                               </span>
<span  style="">  63                                                                                                                    </span>
<span class="-458478327704245810" onmouseenter="enter('-458478327704245810');" onmouseout="out('-458478327704245810');" style="">  64      static final String OLD_AUTHORITY = &quot;com.android.launcher2.settings&quot;;                                         </span>
<span class="-4376021050615906115" onmouseenter="enter('-4376021050615906115');" onmouseout="out('-4376021050615906115');" style="">  65      static final String AUTHORITY = ProviderConfig.AUTHORITY;                                                     </span>
<span  style="">  66                                                                                                                    </span>
<span class="-6626902943579202823" onmouseenter="enter('-6626902943579202823');" onmouseout="out('-6626902943579202823');" style="">  67      static final String TABLE_FAVORITES = &quot;favorites&quot;;                                                            </span>
<span class="-4121112267423691577" onmouseenter="enter('-4121112267423691577');" onmouseout="out('-4121112267423691577');" style="">  68      static final String TABLE_WORKSPACE_SCREENS = &quot;workspaceScreens&quot;;                                             </span>
<span class="5667619940348816611" onmouseenter="enter('5667619940348816611');" onmouseout="out('5667619940348816611');" style="">  69      static final String PARAMETER_NOTIFY = &quot;notify&quot;;                                                              </span>
<span class="-1986119061509854826" onmouseenter="enter('-1986119061509854826');" onmouseout="out('-1986119061509854826');" style="">  70      static final String UPGRADED_FROM_OLD_DATABASE = &quot;UPGRADED_FROM_OLD_DATABASE&quot;;                                </span>
<span class="4313854869595882016" onmouseenter="enter('4313854869595882016');" onmouseout="out('4313854869595882016');" style="">  71      static final String EMPTY_DATABASE_CREATED = &quot;EMPTY_DATABASE_CREATED&quot;;                                        </span>
<span  style="">  72                                                                                                                    </span>
<span class="-254878042648191521" onmouseenter="enter('-254878042648191521');" onmouseout="out('-254878042648191521');" style="">  73      private static final String URI_PARAM_IS_EXTERNAL_ADD = &quot;isExternalAdd&quot;;                                      </span>
<span  style="">  74                                                                                                                    </span>
<span class="-4555445478569710276" onmouseenter="enter('-4555445478569710276');" onmouseout="out('-4555445478569710276');" style="">  75      private LauncherProviderChangeListener mListener;                                                             </span>
<span  style="">  76                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  77      /**                                                                                                           </span>
<span class="-3211764681636990688" onmouseenter="enter('-3211764681636990688');" onmouseout="out('-3211764681636990688');" style="">  78       * {@link Uri} triggered at any registered {@link android.database.ContentObserver} when                      </span>
<span class="-4919300270466303234" onmouseenter="enter('-4919300270466303234');" onmouseout="out('-4919300270466303234');" style="">  79       * {@link AppWidgetHost#deleteHost()} is called during database creation.                                     </span>
<span class="-788325382909228329" onmouseenter="enter('-788325382909228329');" onmouseout="out('-788325382909228329');" style="">  80       * Use this to recall {@link AppWidgetHost#startListening()} if needed.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  81       */                                                                                                           </span>
<span class="5515339483970246409" onmouseenter="enter('5515339483970246409');" onmouseout="out('5515339483970246409');" style="">  82      static final Uri CONTENT_APPWIDGET_RESET_URI =                                                                </span>
<span class="3194273355649806706" onmouseenter="enter('3194273355649806706');" onmouseout="out('3194273355649806706');" style="">  83              Uri.parse(&quot;content://&quot; + AUTHORITY + &quot;/appWidgetReset&quot;);                                              </span>
<span  style="">  84                                                                                                                    </span>
<span class="-35355205086145165" onmouseenter="enter('-35355205086145165');" onmouseout="out('-35355205086145165');" style="">  85      private DatabaseHelper mOpenHelper;                                                                           </span>
<span  style="">  86                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  87      @Override                                                                                                     </span>
<span class="5054121129922253104" onmouseenter="enter('5054121129922253104');" onmouseout="out('5054121129922253104');" style="">  88      public boolean onCreate() {                                                                                   </span>
<span class="4475688138331124962" onmouseenter="enter('4475688138331124962');" onmouseout="out('4475688138331124962');" style="">  89          final Context context = getContext();                                                                     </span>
<span class="-8005318937043312715" onmouseenter="enter('-8005318937043312715');" onmouseout="out('-8005318937043312715');" style="">  90          StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();                                   </span>
<span class="-7690576094790651842" onmouseenter="enter('-7690576094790651842');" onmouseout="out('-7690576094790651842');" style="">  91          mOpenHelper = new DatabaseHelper(context);                                                                </span>
<span class="-9120794859598568002" onmouseenter="enter('-9120794859598568002');" onmouseout="out('-9120794859598568002');" style="">  92          StrictMode.setThreadPolicy(oldPolicy);                                                                    </span>
<span class="-7305781479923559628" onmouseenter="enter('-7305781479923559628');" onmouseout="out('-7305781479923559628');" style="">  93          LauncherAppState.setLauncherProvider(this);                                                               </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  94          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95      }                                                                                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style="">  97      public boolean wasNewDbCreated() {                                                                            </span>
<span class="-2120364841155545874" onmouseenter="enter('-2120364841155545874');" onmouseout="out('-2120364841155545874');" style="">  98          return mOpenHelper.wasNewDbCreated();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99      }                                                                                                             </span>
<span  style=""> 100                                                                                                                    </span>
<span class="9170464131639972057" onmouseenter="enter('9170464131639972057');" onmouseout="out('9170464131639972057');" style=""> 101      public void setLauncherProviderChangeListener(LauncherProviderChangeListener listener) {                      </span>
<span class="9132236250678632099" onmouseenter="enter('9132236250678632099');" onmouseout="out('9132236250678632099');" style=""> 102          mListener = listener;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103      }                                                                                                             </span>
<span  style=""> 104                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 105      @Override                                                                                                     </span>
<span class="-1263590755434456926" onmouseenter="enter('-1263590755434456926');" onmouseout="out('-1263590755434456926');" style=""> 106      public String getType(Uri uri) {                                                                              </span>
<span class="336598653403461328" onmouseenter="enter('336598653403461328');" onmouseout="out('336598653403461328');" style=""> 107          SqlArguments args = new SqlArguments(uri, null, null);                                                    </span>
<span class="-3811208733585118846" onmouseenter="enter('-3811208733585118846');" onmouseout="out('-3811208733585118846');" style=""> 108          if (TextUtils.isEmpty(args.where)) {                                                                      </span>
<span class="4564755247099008741" onmouseenter="enter('4564755247099008741');" onmouseout="out('4564755247099008741');" style=""> 109              return &quot;vnd.android.cursor.dir/&quot; + args.table;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 110          } else {                                                                                                  </span>
<span class="9039528378345344991" onmouseenter="enter('9039528378345344991');" onmouseout="out('9039528378345344991');" style=""> 111              return &quot;vnd.android.cursor.item/&quot; + args.table;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113      }                                                                                                             </span>
<span  style=""> 114                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 115      @Override                                                                                                     </span>
<span class="2688381462100157580" onmouseenter="enter('2688381462100157580');" onmouseout="out('2688381462100157580');" style=""> 116      public Cursor query(Uri uri, String[] projection, String selection,                                           </span>
<span class="-8080601171652713678" onmouseenter="enter('-8080601171652713678');" onmouseout="out('-8080601171652713678');" style=""> 117              String[] selectionArgs, String sortOrder) {                                                           </span>
<span  style=""> 118                                                                                                                    </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 119          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span class="-631518951729113636" onmouseenter="enter('-631518951729113636');" onmouseout="out('-631518951729113636');" style=""> 120          SQLiteQueryBuilder qb = new SQLiteQueryBuilder();                                                         </span>
<span class="2611293065726660593" onmouseenter="enter('2611293065726660593');" onmouseout="out('2611293065726660593');" style=""> 121          qb.setTables(args.table);                                                                                 </span>
<span  style=""> 122                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 123          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3134453170380441664" onmouseenter="enter('3134453170380441664');" onmouseout="out('3134453170380441664');" style=""> 124          Cursor result = qb.query(db, projection, args.where, args.args, null, null, sortOrder);                   </span>
<span class="-7763164457135943875" onmouseenter="enter('-7763164457135943875');" onmouseout="out('-7763164457135943875');" style=""> 125          result.setNotificationUri(getContext().getContentResolver(), uri);                                        </span>
<span  style=""> 126                                                                                                                    </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 127          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span  style=""> 129                                                                                                                    </span>
<span class="9207797122534392164" onmouseenter="enter('9207797122534392164');" onmouseout="out('9207797122534392164');" style=""> 130      private static long dbInsertAndCheck(DatabaseHelper helper,                                                   </span>
<span class="-7649003652568167377" onmouseenter="enter('-7649003652568167377');" onmouseout="out('-7649003652568167377');" style=""> 131              SQLiteDatabase db, String table, String nullColumnHack, ContentValues values) {                       </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style=""> 132          if (values == null) {                                                                                     </span>
<span class="7184965589450928593" onmouseenter="enter('7184965589450928593');" onmouseout="out('7184965589450928593');" style=""> 133              throw new RuntimeException(&quot;Error: attempting to insert null values&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134          }                                                                                                         </span>
<span class="7050899094957739080" onmouseenter="enter('7050899094957739080');" onmouseout="out('7050899094957739080');" style=""> 135          if (!values.containsKey(LauncherSettings.ChangeLogColumns._ID)) {                                         </span>
<span class="492623150120761321" onmouseenter="enter('492623150120761321');" onmouseout="out('492623150120761321');" style=""> 136              throw new RuntimeException(&quot;Error: attempting to add item without specifying an id&quot;);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137          }                                                                                                         </span>
<span class="-5706715493188407465" onmouseenter="enter('-5706715493188407465');" onmouseout="out('-5706715493188407465');" style=""> 138          helper.checkId(table, values);                                                                            </span>
<span class="1074556166740873719" onmouseenter="enter('1074556166740873719');" onmouseout="out('1074556166740873719');" style=""> 139          return db.insert(table, nullColumnHack, values);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140      }                                                                                                             </span>
<span  style=""> 141                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 142      @Override                                                                                                     </span>
<span class="-734135164912880773" onmouseenter="enter('-734135164912880773');" onmouseout="out('-734135164912880773');" style=""> 143      public Uri insert(Uri uri, ContentValues initialValues) {                                                     </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 144          SqlArguments args = new SqlArguments(uri);                                                                </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-8942992855752528468" onmouseenter="enter('-8942992855752528468');" onmouseout="out('-8942992855752528468');" style=""> 146          // In very limited cases, we support system|signature permission apps to add to the db                    </span>
<span class="8337919216215113797" onmouseenter="enter('8337919216215113797');" onmouseout="out('8337919216215113797');" style=""> 147          String externalAdd = uri.getQueryParameter(URI_PARAM_IS_EXTERNAL_ADD);                                    </span>
<span class="-2295815198673808272" onmouseenter="enter('-2295815198673808272');" onmouseout="out('-2295815198673808272');" style=""> 148          if (externalAdd != null &amp;&amp; &quot;true&quot;.equals(externalAdd)) {                                                  </span>
<span class="255159610270408066" onmouseenter="enter('255159610270408066');" onmouseout="out('255159610270408066');" style=""> 149              if (!mOpenHelper.initializeExternalAdd(initialValues)) {                                              </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 150                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152          }                                                                                                         </span>
<span  style=""> 153                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 154          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="-6358079444454153819" onmouseenter="enter('-6358079444454153819');" onmouseout="out('-6358079444454153819');" style=""> 155          addModifiedTime(initialValues);                                                                           </span>
<span class="5419112362953263362" onmouseenter="enter('5419112362953263362');" onmouseout="out('5419112362953263362');" style=""> 156          final long rowId = dbInsertAndCheck(mOpenHelper, db, args.table, null, initialValues);                    </span>
<span class="8445680939324035407" onmouseenter="enter('8445680939324035407');" onmouseout="out('8445680939324035407');" style=""> 157          if (rowId &lt;= 0) return null;                                                                              </span>
<span  style=""> 158                                                                                                                    </span>
<span class="8735878877349428813" onmouseenter="enter('8735878877349428813');" onmouseout="out('8735878877349428813');" style=""> 159          uri = ContentUris.withAppendedId(uri, rowId);                                                             </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 160          sendNotify(uri);                                                                                          </span>
<span  style=""> 161                                                                                                                    </span>
<span class="8673785246827833247" onmouseenter="enter('8673785246827833247');" onmouseout="out('8673785246827833247');" style=""> 162          return uri;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163      }                                                                                                             </span>
<span  style=""> 164                                                                                                                    </span>
<span  style=""> 165                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 166      @Override                                                                                                     </span>
<span class="-327877481205905086" onmouseenter="enter('-327877481205905086');" onmouseout="out('-327877481205905086');" style=""> 167      public int bulkInsert(Uri uri, ContentValues[] values) {                                                      </span>
<span class="8811129738693748448" onmouseenter="enter('8811129738693748448');" onmouseout="out('8811129738693748448');" style=""> 168          SqlArguments args = new SqlArguments(uri);                                                                </span>
<span  style=""> 169                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 170          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 171          db.beginTransaction();                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 172          try {                                                                                                     </span>
<span class="7727596149598132072" onmouseenter="enter('7727596149598132072');" onmouseout="out('7727596149598132072');" style=""> 173              int numValues = values.length;                                                                        </span>
<span class="805790054769028067" onmouseenter="enter('805790054769028067');" onmouseout="out('805790054769028067');" style=""> 174              for (int i = 0; i &lt; numValues; i++) {                                                                 </span>
<span class="2678636525018066730" onmouseenter="enter('2678636525018066730');" onmouseout="out('2678636525018066730');" style=""> 175                  addModifiedTime(values[i]);                                                                       </span>
<span class="-5505203781899797586" onmouseenter="enter('-5505203781899797586');" onmouseout="out('-5505203781899797586');" style=""> 176                  if (dbInsertAndCheck(mOpenHelper, db, args.table, null, values[i]) &lt; 0) {                         </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 177                      return 0;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179              }                                                                                                     </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 180              db.setTransactionSuccessful();                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 181          } finally {                                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 182              db.endTransaction();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183          }                                                                                                         </span>
<span  style=""> 184                                                                                                                    </span>
<span class="-4021691463985906436" onmouseenter="enter('-4021691463985906436');" onmouseout="out('-4021691463985906436');" style=""> 185          sendNotify(uri);                                                                                          </span>
<span class="6793841392205084718" onmouseenter="enter('6793841392205084718');" onmouseout="out('6793841392205084718');" style=""> 186          return values.length;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187      }                                                                                                             </span>
<span  style=""> 188                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 189      @Override                                                                                                     </span>
<span class="5983754597853237276" onmouseenter="enter('5983754597853237276');" onmouseout="out('5983754597853237276');" style=""> 190      public ContentProviderResult[] applyBatch(ArrayList&lt;ContentProviderOperation&gt; operations)                     </span>
<span class="-5628895276830175510" onmouseenter="enter('-5628895276830175510');" onmouseout="out('-5628895276830175510');" style=""> 191              throws OperationApplicationException {                                                                </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 192          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 193          db.beginTransaction();                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 194          try {                                                                                                     </span>
<span class="3840622082470564062" onmouseenter="enter('3840622082470564062');" onmouseout="out('3840622082470564062');" style=""> 195              ContentProviderResult[] result =  super.applyBatch(operations);                                       </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 196              db.setTransactionSuccessful();                                                                        </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 197              return result;                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 198          } finally {                                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 199              db.endTransaction();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201      }                                                                                                             </span>
<span  style=""> 202                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 203      @Override                                                                                                     </span>
<span class="-6238796754049684603" onmouseenter="enter('-6238796754049684603');" onmouseout="out('-6238796754049684603');" style=""> 204      public int delete(Uri uri, String selection, String[] selectionArgs) {                                        </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 205          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span  style=""> 206                                                                                                                    </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 207          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="-848417512188045481" onmouseenter="enter('-848417512188045481');" onmouseout="out('-848417512188045481');" style=""> 208          int count = db.delete(args.table, args.where, args.args);                                                 </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 209          if (count &gt; 0) sendNotify(uri);                                                                           </span>
<span  style=""> 210                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 211          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212      }                                                                                                             </span>
<span  style=""> 213                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 214      @Override                                                                                                     </span>
<span class="-6200308159398621930" onmouseenter="enter('-6200308159398621930');" onmouseout="out('-6200308159398621930');" style=""> 215      public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {                  </span>
<span class="-3782003319541019236" onmouseenter="enter('-3782003319541019236');" onmouseout="out('-3782003319541019236');" style=""> 216          SqlArguments args = new SqlArguments(uri, selection, selectionArgs);                                      </span>
<span  style=""> 217                                                                                                                    </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style=""> 218          addModifiedTime(values);                                                                                  </span>
<span class="9176064587072821338" onmouseenter="enter('9176064587072821338');" onmouseout="out('9176064587072821338');" style=""> 219          SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                                    </span>
<span class="6692131291033480751" onmouseenter="enter('6692131291033480751');" onmouseout="out('6692131291033480751');" style=""> 220          int count = db.update(args.table, values, args.where, args.args);                                         </span>
<span class="3046456781272759412" onmouseenter="enter('3046456781272759412');" onmouseout="out('3046456781272759412');" style=""> 221          if (count &gt; 0) sendNotify(uri);                                                                           </span>
<span  style=""> 222                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 223          return count;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224      }                                                                                                             </span>
<span  style=""> 225                                                                                                                    </span>
<span class="-6137155183451194640" onmouseenter="enter('-6137155183451194640');" onmouseout="out('-6137155183451194640');" style=""> 226      private void sendNotify(Uri uri) {                                                                            </span>
<span class="8087997420167282782" onmouseenter="enter('8087997420167282782');" onmouseout="out('8087997420167282782');" style=""> 227          String notify = uri.getQueryParameter(PARAMETER_NOTIFY);                                                  </span>
<span class="-1882364541416460726" onmouseenter="enter('-1882364541416460726');" onmouseout="out('-1882364541416460726');" style=""> 228          if (notify == null || &quot;true&quot;.equals(notify)) {                                                            </span>
<span class="-1009902495160891118" onmouseenter="enter('-1009902495160891118');" onmouseout="out('-1009902495160891118');" style=""> 229              getContext().getContentResolver().notifyChange(uri, null);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230          }                                                                                                         </span>
<span  style=""> 231                                                                                                                    </span>
<span class="-88474152060363663" onmouseenter="enter('-88474152060363663');" onmouseout="out('-88474152060363663');" style=""> 232          // always notify the backup agent                                                                         </span>
<span class="-4136841506633225478" onmouseenter="enter('-4136841506633225478');" onmouseout="out('-4136841506633225478');" style=""> 233          LauncherBackupAgentHelper.dataChanged(getContext());                                                      </span>
<span class="3660947493902737932" onmouseenter="enter('3660947493902737932');" onmouseout="out('3660947493902737932');" style=""> 234          if (mListener != null) {                                                                                  </span>
<span class="7178241373784368891" onmouseenter="enter('7178241373784368891');" onmouseout="out('7178241373784368891');" style=""> 235              mListener.onLauncherProviderChange();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237      }                                                                                                             </span>
<span  style=""> 238                                                                                                                    </span>
<span class="-1775729469739138676" onmouseenter="enter('-1775729469739138676');" onmouseout="out('-1775729469739138676');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -    private void addModifiedTime(ContentValues values) {                                                          </span>
<span class="-6084407814327678466" onmouseenter="enter('-6084407814327678466');" onmouseout="out('-6084407814327678466');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +    private static void addModifiedTime(ContentValues values) {                                                   </span>
<span class="7778574075272931857" onmouseenter="enter('7778574075272931857');" onmouseout="out('7778574075272931857');" style=""> 241          values.put(LauncherSettings.ChangeLogColumns.MODIFIED, System.currentTimeMillis());                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242      }                                                                                                             </span>
<span  style=""> 243                                                                                                                    </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 244      public long generateNewItemId() {                                                                             </span>
<span class="4208143222012601660" onmouseenter="enter('4208143222012601660');" onmouseout="out('4208143222012601660');" style=""> 245          return mOpenHelper.generateNewItemId();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 248      public void updateMaxItemId(long id) {                                                                        </span>
<span class="5887752252226734670" onmouseenter="enter('5887752252226734670');" onmouseout="out('5887752252226734670');" style=""> 249          mOpenHelper.updateMaxItemId(id);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250      }                                                                                                             </span>
<span  style=""> 251                                                                                                                    </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 252      public long generateNewScreenId() {                                                                           </span>
<span class="1793864293735992917" onmouseenter="enter('1793864293735992917');" onmouseout="out('1793864293735992917');" style=""> 253          return mOpenHelper.generateNewScreenId();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254      }                                                                                                             </span>
<span  style=""> 255                                                                                                                    </span>
<span class="6930658551566435877" onmouseenter="enter('6930658551566435877');" onmouseout="out('6930658551566435877');" style=""> 256      // This is only required one time while loading the workspace during the                                      </span>
<span class="-2970396193784752555" onmouseenter="enter('-2970396193784752555');" onmouseout="out('-2970396193784752555');" style=""> 257      // upgrade path, and should never be called from anywhere else.                                               </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style=""> 258      public void updateMaxScreenId(long maxScreenId) {                                                             </span>
<span class="1650077191565319140" onmouseenter="enter('1650077191565319140');" onmouseout="out('1650077191565319140');" style=""> 259          mOpenHelper.updateMaxScreenId(maxScreenId);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260      }                                                                                                             </span>
<span  style=""> 261                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 262      /**                                                                                                           </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 263       * Clears all the data for a fresh start.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 264       */                                                                                                           </span>
<span class="-8979529877881539007" onmouseenter="enter('-8979529877881539007');" onmouseout="out('-8979529877881539007');" style=""> 265      synchronized public void createEmptyDB() {                                                                    </span>
<span class="-257404101089763384" onmouseenter="enter('-257404101089763384');" onmouseout="out('-257404101089763384');" style=""> 266          mOpenHelper.createEmptyDB(mOpenHelper.getWritableDatabase());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267      }                                                                                                             </span>
<span  style=""> 268                                                                                                                    </span>
<span class="6671122679064927328" onmouseenter="enter('6671122679064927328');" onmouseout="out('6671122679064927328');" style=""> 269      public void clearFlagEmptyDbCreated() {                                                                       </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 270          String spKey = LauncherAppState.getSharedPreferencesKey();                                                </span>
<span class="6603172609148556207" onmouseenter="enter('6603172609148556207');" onmouseout="out('6603172609148556207');" style=""> 271          getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE)                                            </span>
<span class="-4990178698661362372" onmouseenter="enter('-4990178698661362372');" onmouseout="out('-4990178698661362372');" style=""> 272              .edit()                                                                                               </span>
<span class="-4523663616686353798" onmouseenter="enter('-4523663616686353798');" onmouseout="out('-4523663616686353798');" style=""> 273              .remove(EMPTY_DATABASE_CREATED)                                                                       </span>
<span class="5746476506062343638" onmouseenter="enter('5746476506062343638');" onmouseout="out('5746476506062343638');" style=""> 274              .commit();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275      }                                                                                                             </span>
<span  style=""> 276                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 277      /**                                                                                                           </span>
<span class="277164340629859803" onmouseenter="enter('277164340629859803');" onmouseout="out('277164340629859803');" style=""> 278       * Loads the default workspace based on the following priority scheme:                                        </span>
<span class="6191061916552549057" onmouseenter="enter('6191061916552549057');" onmouseout="out('6191061916552549057');" style=""> 279       *   1) From a package provided by play store                                                                 </span>
<span class="-1458935321569433020" onmouseenter="enter('-1458935321569433020');" onmouseout="out('-1458935321569433020');" style=""> 280       *   2) From a partner configuration APK, already in the system image                                         </span>
<span class="-8497452292409790071" onmouseenter="enter('-8497452292409790071');" onmouseout="out('-8497452292409790071');" style=""> 281       *   3) The default configuration for the particular device                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 282       */                                                                                                           </span>
<span class="-4109341010907676070" onmouseenter="enter('-4109341010907676070');" onmouseout="out('-4109341010907676070');" style=""> 283      synchronized public void loadDefaultFavoritesIfNecessary() {                                                  </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 284          String spKey = LauncherAppState.getSharedPreferencesKey();                                                </span>
<span class="-1270995004093477684" onmouseenter="enter('-1270995004093477684');" onmouseout="out('-1270995004093477684');" style=""> 285          SharedPreferences sp = getContext().getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span  style=""> 286                                                                                                                    </span>
<span class="-1164862040405657048" onmouseenter="enter('-1164862040405657048');" onmouseout="out('-1164862040405657048');" style=""> 287          if (sp.getBoolean(EMPTY_DATABASE_CREATED, false)) {                                                       </span>
<span class="-3246698064640464314" onmouseenter="enter('-3246698064640464314');" onmouseout="out('-3246698064640464314');" style=""> 288              Log.d(TAG, &quot;loading default workspace&quot;);                                                              </span>
<span  style=""> 289                                                                                                                    </span>
<span class="7358984688962203192" onmouseenter="enter('7358984688962203192');" onmouseout="out('7358984688962203192');" style=""> 290              AutoInstallsLayout loader = AutoInstallsLayout.get(getContext(),                                      </span>
<span class="4267100487943846224" onmouseenter="enter('4267100487943846224');" onmouseout="out('4267100487943846224');" style=""> 291                      mOpenHelper.mAppWidgetHost, mOpenHelper);                                                     </span>
<span  style=""> 292                                                                                                                    </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 293              if (loader == null) {                                                                                 </span>
<span class="-7748100060285216458" onmouseenter="enter('-7748100060285216458');" onmouseout="out('-7748100060285216458');" style=""> 294                  final Partner partner = Partner.get(getContext().getPackageManager());                            </span>
<span class="-604675337449948556" onmouseenter="enter('-604675337449948556');" onmouseout="out('-604675337449948556');" style=""> 295                  if (partner != null &amp;&amp; partner.hasDefaultLayout()) {                                              </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 296                      final Resources partnerRes = partner.getResources();                                          </span>
<span class="4481789752192356250" onmouseenter="enter('4481789752192356250');" onmouseout="out('4481789752192356250');" style=""> 297                      int workspaceResId = partnerRes.getIdentifier(Partner.RES_DEFAULT_LAYOUT,                     </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 298                              &quot;xml&quot;, partner.getPackageName());                                                     </span>
<span class="-1442734434460802886" onmouseenter="enter('-1442734434460802886');" onmouseout="out('-1442734434460802886');" style=""> 299                      if (workspaceResId != 0) {                                                                    </span>
<span class="-624367766367819814" onmouseenter="enter('-624367766367819814');" onmouseout="out('-624367766367819814');" style=""> 300                          loader = new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                </span>
<span class="3991293503056578945" onmouseenter="enter('3991293503056578945');" onmouseout="out('3991293503056578945');" style=""> 301                                  mOpenHelper, partnerRes, workspaceResId);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304              }                                                                                                     </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-1006525515535848907" onmouseenter="enter('-1006525515535848907');" onmouseout="out('-1006525515535848907');" style=""> 306              final boolean usingExternallyProvidedLayout = loader != null;                                         </span>
<span class="-1290919382195344098" onmouseenter="enter('-1290919382195344098');" onmouseout="out('-1290919382195344098');" style=""> 307              if (loader == null) {                                                                                 </span>
<span class="-6937254959516916052" onmouseenter="enter('-6937254959516916052');" onmouseout="out('-6937254959516916052');" style=""> 308                  loader = getDefaultLayoutParser();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309              }                                                                                                     </span>
<span class="126045670500141" onmouseenter="enter('126045670500141');" onmouseout="out('126045670500141');" style=""> 310              // Populate favorites table with initial favorites                                                    </span>
<span class="8206837333293431906" onmouseenter="enter('8206837333293431906');" onmouseout="out('8206837333293431906');" style=""> 311              if ((mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(), loader) &lt;= 0)                       </span>
<span class="-363747028825236736" onmouseenter="enter('-363747028825236736');" onmouseout="out('-363747028825236736');" style=""> 312                      &amp;&amp; usingExternallyProvidedLayout) {                                                           </span>
<span class="-5734732948359842282" onmouseenter="enter('-5734732948359842282');" onmouseout="out('-5734732948359842282');" style=""> 313                  // Unable to load external layout. Cleanup and load the internal layout.                          </span>
<span class="5828098457627567319" onmouseenter="enter('5828098457627567319');" onmouseout="out('5828098457627567319');" style=""> 314                  createEmptyDB();                                                                                  </span>
<span class="-3956631052588999268" onmouseenter="enter('-3956631052588999268');" onmouseout="out('-3956631052588999268');" style=""> 315                  mOpenHelper.loadFavorites(mOpenHelper.getWritableDatabase(),                                      </span>
<span class="5010356356580148690" onmouseenter="enter('5010356356580148690');" onmouseout="out('5010356356580148690');" style=""> 316                          getDefaultLayoutParser());                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317              }                                                                                                     </span>
<span class="-1774667578952654848" onmouseenter="enter('-1774667578952654848');" onmouseout="out('-1774667578952654848');" style=""> 318              clearFlagEmptyDbCreated();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span  style=""> 321                                                                                                                    </span>
<span class="1869645688222446570" onmouseenter="enter('1869645688222446570');" onmouseout="out('1869645688222446570');" style=""> 322      private DefaultLayoutParser getDefaultLayoutParser() {                                                        </span>
<span class="-4358736250572585751" onmouseenter="enter('-4358736250572585751');" onmouseout="out('-4358736250572585751');" style=""> 323          int defaultLayout = LauncherAppState.getInstance()                                                        </span>
<span class="-3651315710070586527" onmouseenter="enter('-3651315710070586527');" onmouseout="out('-3651315710070586527');" style=""> 324                  .getDynamicGrid().getDeviceProfile().defaultLayoutId;                                             </span>
<span class="-4806143495772092322" onmouseenter="enter('-4806143495772092322');" onmouseout="out('-4806143495772092322');" style=""> 325          return new DefaultLayoutParser(getContext(), mOpenHelper.mAppWidgetHost,                                  </span>
<span class="-4976455824453899875" onmouseenter="enter('-4976455824453899875');" onmouseout="out('-4976455824453899875');" style=""> 326                  mOpenHelper, getContext().getResources(), defaultLayout);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327      }                                                                                                             </span>
<span  style=""> 328                                                                                                                    </span>
<span class="-8499205643032210495" onmouseenter="enter('-8499205643032210495');" onmouseout="out('-8499205643032210495');" style=""> 329      public void migrateLauncher2Shortcuts() {                                                                     </span>
<span class="-5770271076267441053" onmouseenter="enter('-5770271076267441053');" onmouseout="out('-5770271076267441053');" style=""> 330          mOpenHelper.migrateLauncher2Shortcuts(mOpenHelper.getWritableDatabase(),                                  </span>
<span class="-4855681120160555012" onmouseenter="enter('-4855681120160555012');" onmouseout="out('-4855681120160555012');" style=""> 331                  Uri.parse(getContext().getString(R.string.old_launcher_provider_uri)));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="-5196105730574921781" onmouseenter="enter('-5196105730574921781');" onmouseout="out('-5196105730574921781');" style=""> 334      public void updateFolderItemsRank() {                                                                         </span>
<span class="4982456805094611516" onmouseenter="enter('4982456805094611516');" onmouseout="out('4982456805094611516');" style=""> 335          mOpenHelper.updateFolderItemsRank(mOpenHelper.getWritableDatabase(), false);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336      }                                                                                                             </span>
<span  style=""> 337                                                                                                                    </span>
<span class="-7861087353469194327" onmouseenter="enter('-7861087353469194327');" onmouseout="out('-7861087353469194327');" style=""> 338      public void deleteDatabase() {                                                                                </span>
<span class="-3081120555997572478" onmouseenter="enter('-3081120555997572478');" onmouseout="out('-3081120555997572478');" style=""> 339          // Are you sure? (y/n)                                                                                    </span>
<span class="7599905409028339447" onmouseenter="enter('7599905409028339447');" onmouseout="out('7599905409028339447');" style=""> 340          final SQLiteDatabase db = mOpenHelper.getWritableDatabase();                                              </span>
<span class="4824670475834221257" onmouseenter="enter('4824670475834221257');" onmouseout="out('4824670475834221257');" style=""> 341          final File dbFile = new File(db.getPath());                                                               </span>
<span class="-4378932496508441297" onmouseenter="enter('-4378932496508441297');" onmouseout="out('-4378932496508441297');" style=""> 342          mOpenHelper.close();                                                                                      </span>
<span class="-2168275612742463412" onmouseenter="enter('-2168275612742463412');" onmouseout="out('-2168275612742463412');" style=""> 343          if (dbFile.exists()) {                                                                                    </span>
<span class="7055278701412747697" onmouseenter="enter('7055278701412747697');" onmouseout="out('7055278701412747697');" style=""> 344              SQLiteDatabase.deleteDatabase(dbFile);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345          }                                                                                                         </span>
<span class="1429708216911350032" onmouseenter="enter('1429708216911350032');" onmouseout="out('1429708216911350032');" style=""> 346          mOpenHelper = new DatabaseHelper(getContext());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347      }                                                                                                             </span>
<span  style=""> 348                                                                                                                    </span>
<span class="-8073014385313712586" onmouseenter="enter('-8073014385313712586');" onmouseout="out('-8073014385313712586');" style=""> 349      private static class DatabaseHelper extends SQLiteOpenHelper implements LayoutParserCallback {                </span>
<span class="-2672328117217234149" onmouseenter="enter('-2672328117217234149');" onmouseout="out('-2672328117217234149');" style=""> 350          private final Context mContext;                                                                           </span>
<span class="-7815254415381208754" onmouseenter="enter('-7815254415381208754');" onmouseout="out('-7815254415381208754');" style=""> 351          private final AppWidgetHost mAppWidgetHost;                                                               </span>
<span class="256431113711786954" onmouseenter="enter('256431113711786954');" onmouseout="out('256431113711786954');" style=""> 352          private long mMaxItemId = -1;                                                                             </span>
<span class="3024521003496490102" onmouseenter="enter('3024521003496490102');" onmouseout="out('3024521003496490102');" style=""> 353          private long mMaxScreenId = -1;                                                                           </span>
<span  style=""> 354                                                                                                                    </span>
<span class="7342788129695687690" onmouseenter="enter('7342788129695687690');" onmouseout="out('7342788129695687690');" style=""> 355          private boolean mNewDbCreated = false;                                                                    </span>
<span  style=""> 356                                                                                                                    </span>
<span class="1000156088447424124" onmouseenter="enter('1000156088447424124');" onmouseout="out('1000156088447424124');" style=""> 357          DatabaseHelper(Context context) {                                                                         </span>
<span class="5450204288644697643" onmouseenter="enter('5450204288644697643');" onmouseout="out('5450204288644697643');" style=""> 358              super(context, LauncherFiles.LAUNCHER_DB, null, DATABASE_VERSION);                                    </span>
<span class="7260904205784329196" onmouseenter="enter('7260904205784329196');" onmouseout="out('7260904205784329196');" style=""> 359              mContext = context;                                                                                   </span>
<span class="6731257549223913473" onmouseenter="enter('6731257549223913473');" onmouseout="out('6731257549223913473');" style=""> 360              mAppWidgetHost = new AppWidgetHost(context, Launcher.APPWIDGET_HOST_ID);                              </span>
<span  style=""> 361                                                                                                                    </span>
<span class="-7119307471557363464" onmouseenter="enter('-7119307471557363464');" onmouseout="out('-7119307471557363464');" style=""> 362              // In the case where neither onCreate nor onUpgrade gets called, we read the maxId from               </span>
<span class="-7146491614936969963" onmouseenter="enter('-7146491614936969963');" onmouseout="out('-7146491614936969963');" style=""> 363              // the DB here                                                                                        </span>
<span class="-8239698715373110075" onmouseenter="enter('-8239698715373110075');" onmouseout="out('-8239698715373110075');" style=""> 364              if (mMaxItemId == -1) {                                                                               </span>
<span class="6514208419145701418" onmouseenter="enter('6514208419145701418');" onmouseout="out('6514208419145701418');" style=""> 365                  mMaxItemId = initializeMaxItemId(getWritableDatabase());                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366              }                                                                                                     </span>
<span class="2158219101093277292" onmouseenter="enter('2158219101093277292');" onmouseout="out('2158219101093277292');" style=""> 367              if (mMaxScreenId == -1) {                                                                             </span>
<span class="-7197865417052699646" onmouseenter="enter('-7197865417052699646');" onmouseout="out('-7197865417052699646');" style=""> 368                  mMaxScreenId = initializeMaxScreenId(getWritableDatabase());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370          }                                                                                                         </span>
<span  style=""> 371                                                                                                                    </span>
<span class="487377169126514768" onmouseenter="enter('487377169126514768');" onmouseout="out('487377169126514768');" style=""> 372          public boolean wasNewDbCreated() {                                                                        </span>
<span class="1294520975679493300" onmouseenter="enter('1294520975679493300');" onmouseout="out('1294520975679493300');" style=""> 373              return mNewDbCreated;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374          }                                                                                                         </span>
<span  style=""> 375                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 376          /**                                                                                                       </span>
<span class="-3713204910685876719" onmouseenter="enter('-3713204910685876719');" onmouseout="out('-3713204910685876719');" style=""> 377           * Send notification that we&#x27;ve deleted the {@link AppWidgetHost},                                        </span>
<span class="-5398164636189778479" onmouseenter="enter('-5398164636189778479');" onmouseout="out('-5398164636189778479');" style=""> 378           * probably as part of the initial database creation. The receiver may                                    </span>
<span class="-284834762183367019" onmouseenter="enter('-284834762183367019');" onmouseout="out('-284834762183367019');" style=""> 379           * want to re-call {@link AppWidgetHost#startListening()} to ensure                                       </span>
<span class="1913597860538764992" onmouseenter="enter('1913597860538764992');" onmouseout="out('1913597860538764992');" style=""> 380           * callbacks are correctly set.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 381           */                                                                                                       </span>
<span class="3384745401314169661" onmouseenter="enter('3384745401314169661');" onmouseout="out('3384745401314169661');" style=""> 382          private void sendAppWidgetResetNotify() {                                                                 </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 383              final ContentResolver resolver = mContext.getContentResolver();                                       </span>
<span class="4149774703050814155" onmouseenter="enter('4149774703050814155');" onmouseout="out('4149774703050814155');" style=""> 384              resolver.notifyChange(CONTENT_APPWIDGET_RESET_URI, null);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385          }                                                                                                         </span>
<span  style=""> 386                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387          @Override                                                                                                 </span>
<span class="3201464308903999877" onmouseenter="enter('3201464308903999877');" onmouseout="out('3201464308903999877');" style=""> 388          public void onCreate(SQLiteDatabase db) {                                                                 </span>
<span class="4744685829155971552" onmouseenter="enter('4744685829155971552');" onmouseout="out('4744685829155971552');" style=""> 389              if (LOGD) Log.d(TAG, &quot;creating new launcher database&quot;);                                               </span>
<span  style=""> 390                                                                                                                    </span>
<span class="-5512536783286632376" onmouseenter="enter('-5512536783286632376');" onmouseout="out('-5512536783286632376');" style=""> 391              mMaxItemId = 1;                                                                                       </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 392              mMaxScreenId = 0;                                                                                     </span>
<span class="-3863035699221776712" onmouseenter="enter('-3863035699221776712');" onmouseout="out('-3863035699221776712');" style=""> 393              mNewDbCreated = true;                                                                                 </span>
<span  style=""> 394                                                                                                                    </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 395              UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                              </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 396              long userSerialNumber = userManager.getSerialNumberForUser(                                           </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 397                      UserHandleCompat.myUserHandle());                                                             </span>
<span  style=""> 398                                                                                                                    </span>
<span class="-5810771542500139933" onmouseenter="enter('-5810771542500139933');" onmouseout="out('-5810771542500139933');" style=""> 399              db.execSQL(&quot;CREATE TABLE favorites (&quot; +                                                               </span>
<span class="-7286867248755276119" onmouseenter="enter('-7286867248755276119');" onmouseout="out('-7286867248755276119');" style=""> 400                      &quot;_id INTEGER PRIMARY KEY,&quot; +                                                                  </span>
<span class="5329137835308229169" onmouseenter="enter('5329137835308229169');" onmouseout="out('5329137835308229169');" style=""> 401                      &quot;title TEXT,&quot; +                                                                               </span>
<span class="-7776152072054589061" onmouseenter="enter('-7776152072054589061');" onmouseout="out('-7776152072054589061');" style=""> 402                      &quot;intent TEXT,&quot; +                                                                              </span>
<span class="4982593742089674958" onmouseenter="enter('4982593742089674958');" onmouseout="out('4982593742089674958');" style=""> 403                      &quot;container INTEGER,&quot; +                                                                        </span>
<span class="-1871026270657853169" onmouseenter="enter('-1871026270657853169');" onmouseout="out('-1871026270657853169');" style=""> 404                      &quot;screen INTEGER,&quot; +                                                                           </span>
<span class="-9174211260981343890" onmouseenter="enter('-9174211260981343890');" onmouseout="out('-9174211260981343890');" style=""> 405                      &quot;cellX INTEGER,&quot; +                                                                            </span>
<span class="1584772009960348649" onmouseenter="enter('1584772009960348649');" onmouseout="out('1584772009960348649');" style=""> 406                      &quot;cellY INTEGER,&quot; +                                                                            </span>
<span class="5424055190881126727" onmouseenter="enter('5424055190881126727');" onmouseout="out('5424055190881126727');" style=""> 407                      &quot;spanX INTEGER,&quot; +                                                                            </span>
<span class="6553755327503045229" onmouseenter="enter('6553755327503045229');" onmouseout="out('6553755327503045229');" style=""> 408                      &quot;spanY INTEGER,&quot; +                                                                            </span>
<span class="5229848414421823036" onmouseenter="enter('5229848414421823036');" onmouseout="out('5229848414421823036');" style=""> 409                      &quot;itemType INTEGER,&quot; +                                                                         </span>
<span class="-1771151571856416667" onmouseenter="enter('-1771151571856416667');" onmouseout="out('-1771151571856416667');" style=""> 410                      &quot;appWidgetId INTEGER NOT NULL DEFAULT -1,&quot; +                                                  </span>
<span class="-9047067707489472437" onmouseenter="enter('-9047067707489472437');" onmouseout="out('-9047067707489472437');" style=""> 411                      &quot;isShortcut INTEGER,&quot; +                                                                       </span>
<span class="-3445858598434382544" onmouseenter="enter('-3445858598434382544');" onmouseout="out('-3445858598434382544');" style=""> 412                      &quot;iconType INTEGER,&quot; +                                                                         </span>
<span class="4279668316006004948" onmouseenter="enter('4279668316006004948');" onmouseout="out('4279668316006004948');" style=""> 413                      &quot;iconPackage TEXT,&quot; +                                                                         </span>
<span class="2008284586023778304" onmouseenter="enter('2008284586023778304');" onmouseout="out('2008284586023778304');" style=""> 414                      &quot;iconResource TEXT,&quot; +                                                                        </span>
<span class="-5981868381948376489" onmouseenter="enter('-5981868381948376489');" onmouseout="out('-5981868381948376489');" style=""> 415                      &quot;icon BLOB,&quot; +                                                                                </span>
<span class="5686768105176115842" onmouseenter="enter('5686768105176115842');" onmouseout="out('5686768105176115842');" style=""> 416                      &quot;uri TEXT,&quot; +                                                                                 </span>
<span class="-5470568819214956502" onmouseenter="enter('-5470568819214956502');" onmouseout="out('-5470568819214956502');" style=""> 417                      &quot;displayMode INTEGER,&quot; +                                                                      </span>
<span class="3582502352252677630" onmouseenter="enter('3582502352252677630');" onmouseout="out('3582502352252677630');" style=""> 418                      &quot;appWidgetProvider TEXT,&quot; +                                                                   </span>
<span class="4065658841092455651" onmouseenter="enter('4065658841092455651');" onmouseout="out('4065658841092455651');" style=""> 419                      &quot;modified INTEGER NOT NULL DEFAULT 0,&quot; +                                                      </span>
<span class="422282607120493296" onmouseenter="enter('422282607120493296');" onmouseout="out('422282607120493296');" style=""> 420                      &quot;restored INTEGER NOT NULL DEFAULT 0,&quot; +                                                      </span>
<span class="823907807759654324" onmouseenter="enter('823907807759654324');" onmouseout="out('823907807759654324');" style=""> 421                      &quot;profileId INTEGER DEFAULT &quot; + userSerialNumber + &quot;,&quot; +                                       </span>
<span class="-8486149279194715653" onmouseenter="enter('-8486149279194715653');" onmouseout="out('-8486149279194715653');" style=""> 422                      &quot;rank INTEGER NOT NULL DEFAULT 0&quot; +                                                           </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 423                      &quot;);&quot;);                                                                                        </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 424              addWorkspacesTable(db);                                                                               </span>
<span  style=""> 425                                                                                                                    </span>
<span class="-1982623284376040662" onmouseenter="enter('-1982623284376040662');" onmouseout="out('-1982623284376040662');" style=""> 426              // Database was just created, so wipe any previous widgets                                            </span>
<span class="35469525966995251" onmouseenter="enter('35469525966995251');" onmouseout="out('35469525966995251');" style=""> 427              if (mAppWidgetHost != null) {                                                                         </span>
<span class="2879907381293157546" onmouseenter="enter('2879907381293157546');" onmouseout="out('2879907381293157546');" style=""> 428                  mAppWidgetHost.deleteHost();                                                                      </span>
<span class="-5770229164268459929" onmouseenter="enter('-5770229164268459929');" onmouseout="out('-5770229164268459929');" style=""> 429                  sendAppWidgetResetNotify();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430              }                                                                                                     </span>
<span  style=""> 431                                                                                                                    </span>
<span class="-1063142603395313746" onmouseenter="enter('-1063142603395313746');" onmouseout="out('-1063142603395313746');" style=""> 432              // Fresh and clean launcher DB.                                                                       </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 433              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="7629543500667828090" onmouseenter="enter('7629543500667828090');" onmouseout="out('7629543500667828090');" style=""> 434              setFlagEmptyDbCreated();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435          }                                                                                                         </span>
<span  style=""> 436                                                                                                                    </span>
<span class="6272912136443308513" onmouseenter="enter('6272912136443308513');" onmouseout="out('6272912136443308513');" style=""> 437          private void addWorkspacesTable(SQLiteDatabase db) {                                                      </span>
<span class="2730049849658983478" onmouseenter="enter('2730049849658983478');" onmouseout="out('2730049849658983478');" style=""> 438              db.execSQL(&quot;CREATE TABLE &quot; + TABLE_WORKSPACE_SCREENS + &quot; (&quot; +                                         </span>
<span class="-1469669278065576182" onmouseenter="enter('-1469669278065576182');" onmouseout="out('-1469669278065576182');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 439 -                    LauncherSettings.WorkspaceScreens._ID + &quot; INTEGER,&quot; +                                         </span>
<span class="3055097616701045664" onmouseenter="enter('3055097616701045664');" onmouseout="out('3055097616701045664');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 440 +                    LauncherSettings.WorkspaceScreens._ID + &quot; INTEGER PRIMARY KEY,&quot; +                             </span>
<span class="-8340457193420065897" onmouseenter="enter('-8340457193420065897');" onmouseout="out('-8340457193420065897');" style=""> 441                      LauncherSettings.WorkspaceScreens.SCREEN_RANK + &quot; INTEGER,&quot; +                                 </span>
<span class="7771125962287368960" onmouseenter="enter('7771125962287368960');" onmouseout="out('7771125962287368960');" style=""> 442                      LauncherSettings.ChangeLogColumns.MODIFIED + &quot; INTEGER NOT NULL DEFAULT 0&quot; +                  </span>
<span class="4525293784515244604" onmouseenter="enter('4525293784515244604');" onmouseout="out('4525293784515244604');" style=""> 443                      &quot;);&quot;);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444          }                                                                                                         </span>
<span  style=""> 445                                                                                                                    </span>
<span class="-3232037806458942317" onmouseenter="enter('-3232037806458942317');" onmouseout="out('-3232037806458942317');" style=""> 446          private void removeOrphanedItems(SQLiteDatabase db) {                                                     </span>
<span class="-3995909494643948388" onmouseenter="enter('-3995909494643948388');" onmouseout="out('-3995909494643948388');" style=""> 447              // Delete items directly on the workspace who&#x27;s screen id doesn&#x27;t exist                               </span>
<span class="6555258266445461688" onmouseenter="enter('6555258266445461688');" onmouseout="out('6555258266445461688');" style=""> 448              //  &quot;DELETE FROM favorites WHERE screen NOT IN (SELECT _id FROM workspaceScreens)                     </span>
<span class="-1584785563187965465" onmouseenter="enter('-1584785563187965465');" onmouseout="out('-1584785563187965465');" style=""> 449              //   AND container = -100&quot;                                                                            </span>
<span class="-3502523792993972030" onmouseenter="enter('-3502523792993972030');" onmouseout="out('-3502523792993972030');" style=""> 450              String removeOrphanedDesktopItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                                </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 451                      &quot; WHERE &quot; +                                                                                   </span>
<span class="-8781539607986806909" onmouseenter="enter('-8781539607986806909');" onmouseout="out('-8781539607986806909');" style=""> 452                      LauncherSettings.Favorites.SCREEN + &quot; NOT IN (SELECT &quot; +                                      </span>
<span class="-3730067412022302503" onmouseenter="enter('-3730067412022302503');" onmouseout="out('-3730067412022302503');" style=""> 453                      LauncherSettings.WorkspaceScreens._ID + &quot; FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot;)&quot; +            </span>
<span class="8831213357842987069" onmouseenter="enter('8831213357842987069');" onmouseout="out('8831213357842987069');" style=""> 454                      &quot; AND &quot; +                                                                                     </span>
<span class="-3912897749337440213" onmouseenter="enter('-3912897749337440213');" onmouseout="out('-3912897749337440213');" style=""> 455                      LauncherSettings.Favorites.CONTAINER + &quot; = &quot; +                                                </span>
<span class="-1572782876841487653" onmouseenter="enter('-1572782876841487653');" onmouseout="out('-1572782876841487653');" style=""> 456                      LauncherSettings.Favorites.CONTAINER_DESKTOP;                                                 </span>
<span class="-5442680607495552531" onmouseenter="enter('-5442680607495552531');" onmouseout="out('-5442680607495552531');" style=""> 457              db.execSQL(removeOrphanedDesktopItems);                                                               </span>
<span  style=""> 458                                                                                                                    </span>
<span class="2150462606818952724" onmouseenter="enter('2150462606818952724');" onmouseout="out('2150462606818952724');" style=""> 459              // Delete items contained in folders which no longer exist (after above statement)                    </span>
<span class="7157590486959116676" onmouseenter="enter('7157590486959116676');" onmouseout="out('7157590486959116676');" style=""> 460              //  &quot;DELETE FROM favorites  WHERE container &lt;&gt; -100 AND container &lt;&gt; -101 AND container               </span>
<span class="4713393280747800603" onmouseenter="enter('4713393280747800603');" onmouseout="out('4713393280747800603');" style=""> 461              //   NOT IN (SELECT _id FROM favorites WHERE itemType = 2)&quot;                                           </span>
<span class="-8895952306054120744" onmouseenter="enter('-8895952306054120744');" onmouseout="out('-8895952306054120744');" style=""> 462              String removeOrphanedFolderItems = &quot;DELETE FROM &quot; + TABLE_FAVORITES +                                 </span>
<span class="-3798755311795862199" onmouseenter="enter('-3798755311795862199');" onmouseout="out('-3798755311795862199');" style=""> 463                      &quot; WHERE &quot; +                                                                                   </span>
<span class="-9165304043886914201" onmouseenter="enter('-9165304043886914201');" onmouseout="out('-9165304043886914201');" style=""> 464                      LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                               </span>
<span class="2430974176390543784" onmouseenter="enter('2430974176390543784');" onmouseout="out('2430974176390543784');" style=""> 465                      LauncherSettings.Favorites.CONTAINER_DESKTOP +                                                </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 466                      &quot; AND &quot;                                                                                       </span>
<span class="5144458996296891504" onmouseenter="enter('5144458996296891504');" onmouseout="out('5144458996296891504');" style=""> 467                      + LauncherSettings.Favorites.CONTAINER + &quot; &lt;&gt; &quot; +                                             </span>
<span class="20571678636460503" onmouseenter="enter('20571678636460503');" onmouseout="out('20571678636460503');" style=""> 468                      LauncherSettings.Favorites.CONTAINER_HOTSEAT +                                                </span>
<span class="3944405145859305700" onmouseenter="enter('3944405145859305700');" onmouseout="out('3944405145859305700');" style=""> 469                      &quot; AND &quot;                                                                                       </span>
<span class="-4280152506863766824" onmouseenter="enter('-4280152506863766824');" onmouseout="out('-4280152506863766824');" style=""> 470                      + LauncherSettings.Favorites.CONTAINER + &quot; NOT IN (SELECT &quot; +                                 </span>
<span class="-971280935083657149" onmouseenter="enter('-971280935083657149');" onmouseout="out('-971280935083657149');" style=""> 471                      LauncherSettings.Favorites._ID + &quot; FROM &quot; + TABLE_FAVORITES +                                 </span>
<span class="4038942553560789906" onmouseenter="enter('4038942553560789906');" onmouseout="out('4038942553560789906');" style=""> 472                      &quot; WHERE &quot; + LauncherSettings.Favorites.ITEM_TYPE + &quot; = &quot; +                                    </span>
<span class="-1734962565729646321" onmouseenter="enter('-1734962565729646321');" onmouseout="out('-1734962565729646321');" style=""> 473                      LauncherSettings.Favorites.ITEM_TYPE_FOLDER + &quot;)&quot;;                                            </span>
<span class="-8852316947474253726" onmouseenter="enter('-8852316947474253726');" onmouseout="out('-8852316947474253726');" style=""> 474              db.execSQL(removeOrphanedFolderItems);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475          }                                                                                                         </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-2961433455992777066" onmouseenter="enter('-2961433455992777066');" onmouseout="out('-2961433455992777066');" style=""> 477          private void setFlagJustLoadedOldDb() {                                                                   </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 478              String spKey = LauncherAppState.getSharedPreferencesKey();                                            </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 479              SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span class="2898240485600869061" onmouseenter="enter('2898240485600869061');" onmouseout="out('2898240485600869061');" style=""> 480              SharedPreferences.Editor editor = sp.edit();                                                          </span>
<span class="6425915141570404948" onmouseenter="enter('6425915141570404948');" onmouseout="out('6425915141570404948');" style=""> 481              editor.putBoolean(UPGRADED_FROM_OLD_DATABASE, true);                                                  </span>
<span class="-757214322554182598" onmouseenter="enter('-757214322554182598');" onmouseout="out('-757214322554182598');" style=""> 482              editor.putBoolean(EMPTY_DATABASE_CREATED, false);                                                     </span>
<span class="-1350952079334021013" onmouseenter="enter('-1350952079334021013');" onmouseout="out('-1350952079334021013');" style=""> 483              editor.commit();                                                                                      </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span  style=""> 485                                                                                                                    </span>
<span class="3580170518454540960" onmouseenter="enter('3580170518454540960');" onmouseout="out('3580170518454540960');" style=""> 486          private void setFlagEmptyDbCreated() {                                                                    </span>
<span class="3234789264345159650" onmouseenter="enter('3234789264345159650');" onmouseout="out('3234789264345159650');" style=""> 487              String spKey = LauncherAppState.getSharedPreferencesKey();                                            </span>
<span class="-5067042237042206848" onmouseenter="enter('-5067042237042206848');" onmouseout="out('-5067042237042206848');" style=""> 488              SharedPreferences sp = mContext.getSharedPreferences(spKey, Context.MODE_PRIVATE);                    </span>
<span class="2898240485600869061" onmouseenter="enter('2898240485600869061');" onmouseout="out('2898240485600869061');" style=""> 489              SharedPreferences.Editor editor = sp.edit();                                                          </span>
<span class="-1876450541595142979" onmouseenter="enter('-1876450541595142979');" onmouseout="out('-1876450541595142979');" style=""> 490              editor.putBoolean(EMPTY_DATABASE_CREATED, true);                                                      </span>
<span class="4517855415574245319" onmouseenter="enter('4517855415574245319');" onmouseout="out('4517855415574245319');" style=""> 491              editor.putBoolean(UPGRADED_FROM_OLD_DATABASE, false);                                                 </span>
<span class="-1350952079334021013" onmouseenter="enter('-1350952079334021013');" onmouseout="out('-1350952079334021013');" style=""> 492              editor.commit();                                                                                      </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493          }                                                                                                         </span>
<span  style=""> 494                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 495          @Override                                                                                                 </span>
<span class="-4655538025867202729" onmouseenter="enter('-4655538025867202729');" onmouseout="out('-4655538025867202729');" style=""> 496          public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {                                </span>
<span class="-3337256987478665120" onmouseenter="enter('-3337256987478665120');" onmouseout="out('-3337256987478665120');" style=""> 497              if (LOGD) Log.d(TAG, &quot;onUpgrade triggered: &quot; + oldVersion);                                           </span>
<span  style=""> 498                                                                                                                    </span>
<span class="-8802630880728694567" onmouseenter="enter('-8802630880728694567');" onmouseout="out('-8802630880728694567');" style=""> 499              int version = oldVersion;                                                                             </span>
<span class="-5643982476603308557" onmouseenter="enter('-5643982476603308557');" onmouseout="out('-5643982476603308557');" style=""> 500              if (version &lt; MIN_DATABASE_VERSION) {                                                                 </span>
<span class="3921213884195173103" onmouseenter="enter('3921213884195173103');" onmouseout="out('3921213884195173103');" style=""> 501                  // The version cannot be lower that this, as Launcher3 never supported a lower                    </span>


<span class="-4883409179661970227" onmouseenter="enter('-4883409179661970227');" onmouseout="out('-4883409179661970227');" style=""> 502                  // version of the DB.                                                                             </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 503                  createEmptyDB(db);                                                                                </span>
<span class="2097404470120653805" onmouseenter="enter('2097404470120653805');" onmouseout="out('2097404470120653805');" style=""> 504                  version = DATABASE_VERSION;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505              }                                                                                                     </span>
<span  style=""> 506                                                                                                                    </span>
<span class="-1127321954793168309" onmouseenter="enter('-1127321954793168309');" onmouseout="out('-1127321954793168309');" style=""> 507              if (version &lt; 13) {                                                                                   </span>
<span class="6699748190088794301" onmouseenter="enter('6699748190088794301');" onmouseout="out('6699748190088794301');" style=""> 508                  // With the new shrink-wrapped and re-orderable workspaces, it makes sense                        </span>
<span class="4525637906322106897" onmouseenter="enter('4525637906322106897');" onmouseout="out('4525637906322106897');" style=""> 509                  // to persist workspace screens and their relative order.                                         </span>
<span class="-1030858145638239039" onmouseenter="enter('-1030858145638239039');" onmouseout="out('-1030858145638239039');" style=""> 510                  mMaxScreenId = 0;                                                                                 </span>
<span  style=""> 511                                                                                                                    </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style=""> 512                  addWorkspacesTable(db);                                                                           </span>
<span class="-1031230936357450444" onmouseenter="enter('-1031230936357450444');" onmouseout="out('-1031230936357450444');" style=""> 513                  version = 13;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514              }                                                                                                     </span>
<span  style=""> 515                                                                                                                    </span>
<span class="-3790290227926597654" onmouseenter="enter('-3790290227926597654');" onmouseout="out('-3790290227926597654');" style=""> 516              if (version &lt; 14) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 517                  db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 518                  try {                                                                                             </span>
<span class="-3399391435431896428" onmouseenter="enter('-3399391435431896428');" onmouseout="out('-3399391435431896428');" style=""> 519                      // Insert new column for holding widget provider name                                         </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 520                      db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="-1191376551368325446" onmouseenter="enter('-1191376551368325446');" onmouseout="out('-1191376551368325446');" style=""> 521                              &quot;ADD COLUMN appWidgetProvider TEXT;&quot;);                                                </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 522                      db.setTransactionSuccessful();                                                                </span>
<span class="-6853964272080073312" onmouseenter="enter('-6853964272080073312');" onmouseout="out('-6853964272080073312');" style=""> 523                      version = 14;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 524                  } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 525                      // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 526                      Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 527                  } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 528                      db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530              }                                                                                                     </span>
<span  style=""> 531                                                                                                                    </span>
<span class="4742571203445114157" onmouseenter="enter('4742571203445114157');" onmouseout="out('4742571203445114157');" style=""> 532              if (version &lt; 15) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 533                  db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 534                  try {                                                                                             </span>
<span class="4980089996717210691" onmouseenter="enter('4980089996717210691');" onmouseout="out('4980089996717210691');" style=""> 535                      // Insert new column for holding update timestamp                                             </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 536                      db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 537                              &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-134194254938928149" onmouseenter="enter('-134194254938928149');" onmouseout="out('-134194254938928149');" style=""> 538                      db.execSQL(&quot;ALTER TABLE workspaceScreens &quot; +                                                  </span>
<span class="-6587870365196648620" onmouseenter="enter('-6587870365196648620');" onmouseout="out('-6587870365196648620');" style=""> 539                              &quot;ADD COLUMN modified INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 540                      db.setTransactionSuccessful();                                                                </span>
<span class="8988210671545584151" onmouseenter="enter('8988210671545584151');" onmouseout="out('8988210671545584151');" style=""> 541                      version = 15;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 542                  } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 543                      // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 544                      Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 545                  } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 546                      db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 548              }                                                                                                     </span>
<span  style=""> 549                                                                                                                    </span>
<span  style=""> 550                                                                                                                    </span>
<span class="1076365416612257192" onmouseenter="enter('1076365416612257192');" onmouseout="out('1076365416612257192');" style=""> 551              if (version &lt; 16) {                                                                                   </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 552                  db.beginTransaction();                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 553                  try {                                                                                             </span>
<span class="4715697150589634772" onmouseenter="enter('4715697150589634772');" onmouseout="out('4715697150589634772');" style=""> 554                      // Insert new column for holding restore status                                               </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 555                      db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                         </span>
<span class="1880054724854477963" onmouseenter="enter('1880054724854477963');" onmouseout="out('1880054724854477963');" style=""> 556                              &quot;ADD COLUMN restored INTEGER NOT NULL DEFAULT 0;&quot;);                                   </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 557                      db.setTransactionSuccessful();                                                                </span>
<span class="2013829968714493382" onmouseenter="enter('2013829968714493382');" onmouseout="out('2013829968714493382');" style=""> 558                      version = 16;                                                                                 </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 559                  } catch (SQLException ex) {                                                                       </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 560                      // Old version remains, which means we wipe old data                                          </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 561                      Log.e(TAG, ex.getMessage(), ex);                                                              </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 562                  } finally {                                                                                       </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 563                      db.endTransaction();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 564                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565              }                                                                                                     </span>
<span  style=""> 566                                                                                                                    </span>
<span class="-6756468306354214848" onmouseenter="enter('-6756468306354214848');" onmouseout="out('-6756468306354214848');" style=""> 567              if (version &lt; 17) {                                                                                   </span>
<span class="-8925898828002148199" onmouseenter="enter('-8925898828002148199');" onmouseout="out('-8925898828002148199');" style=""> 568                  // We use the db version upgrade here to identify users who may not have seen                     </span>
<span class="2421121084363663195" onmouseenter="enter('2421121084363663195');" onmouseout="out('2421121084363663195');" style=""> 569                  // clings yet (because they weren&#x27;t available), but for whom the clings are now                   </span>
<span class="-3819212007201998918" onmouseenter="enter('-3819212007201998918');" onmouseout="out('-3819212007201998918');" style=""> 570                  // available (tablet users). Because one of the possible cling flows (migration)                  </span>
<span class="-6235100359092849352" onmouseenter="enter('-6235100359092849352');" onmouseout="out('-6235100359092849352');" style=""> 571                  // is very destructive (wipes out workspaces), we want to prevent this from showing               </span>
<span class="-2001927373741844508" onmouseenter="enter('-2001927373741844508');" onmouseout="out('-2001927373741844508');" style=""> 572                  // until clear data. We do so by marking that the clings have been shown.                         </span>
<span class="9168128908795605867" onmouseenter="enter('9168128908795605867');" onmouseout="out('9168128908795605867');" style=""> 573                  LauncherClings.synchonouslyMarkFirstRunClingDismissed(mContext);                                  </span>
<span class="-3652383409155171451" onmouseenter="enter('-3652383409155171451');" onmouseout="out('-3652383409155171451');" style=""> 574                  version = 17;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 575              }                                                                                                     </span>
<span  style=""> 576                                                                                                                    </span>
<span class="7817650129783202172" onmouseenter="enter('7817650129783202172');" onmouseout="out('7817650129783202172');" style=""> 577              if (version &lt; 18) {                                                                                   </span>
<span class="-5748373616457914051" onmouseenter="enter('-5748373616457914051');" onmouseout="out('-5748373616457914051');" style=""> 578                  // No-op                                                                                          </span>
<span class="-862393984298106042" onmouseenter="enter('-862393984298106042');" onmouseout="out('-862393984298106042');" style=""> 579                  version = 18;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 580              }                                                                                                     </span>
<span  style=""> 581                                                                                                                    </span>
<span class="-3427379715691059477" onmouseenter="enter('-3427379715691059477');" onmouseout="out('-3427379715691059477');" style=""> 582              if (version &lt; 19) {                                                                                   </span>
<span class="4571181047088430074" onmouseenter="enter('4571181047088430074');" onmouseout="out('4571181047088430074');" style=""> 583                  // Due to a data loss bug, some users may have items associated with screen ids                   </span>
<span class="5190859357842058169" onmouseenter="enter('5190859357842058169');" onmouseout="out('5190859357842058169');" style=""> 584                  // which no longer exist. Since this can cause other problems, and since the user                 </span>
<span class="-6625319271568400514" onmouseenter="enter('-6625319271568400514');" onmouseout="out('-6625319271568400514');" style=""> 585                  // will never see these items anyway, we use database upgrade as an opportunity to                </span>
<span class="2555207824693971320" onmouseenter="enter('2555207824693971320');" onmouseout="out('2555207824693971320');" style=""> 586                  // clean things up.                                                                               </span>
<span class="6001089319165901827" onmouseenter="enter('6001089319165901827');" onmouseout="out('6001089319165901827');" style=""> 587                  removeOrphanedItems(db);                                                                          </span>
<span class="-8622797196606405802" onmouseenter="enter('-8622797196606405802');" onmouseout="out('-8622797196606405802');" style=""> 588                  version = 19;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589              }                                                                                                     </span>
<span  style=""> 590                                                                                                                    </span>
<span class="7499725911390962675" onmouseenter="enter('7499725911390962675');" onmouseout="out('7499725911390962675');" style=""> 591              if (version &lt; 20) {                                                                                   </span>
<span class="7544427300199377589" onmouseenter="enter('7544427300199377589');" onmouseout="out('7544427300199377589');" style=""> 592                  // Add userId column                                                                              </span>
<span class="3648122535018422218" onmouseenter="enter('3648122535018422218');" onmouseout="out('3648122535018422218');" style=""> 593                  if (addProfileColumn(db)) {                                                                       </span>
<span class="-3196204954256045340" onmouseenter="enter('-3196204954256045340');" onmouseout="out('-3196204954256045340');" style=""> 594                      version = 20;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595                  }                                                                                                 </span>
<span class="-7922924049235754756" onmouseenter="enter('-7922924049235754756');" onmouseout="out('-7922924049235754756');" style=""> 596                  // else old version remains, which means we wipe old data                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597              }                                                                                                     </span>
<span  style=""> 598                                                                                                                    </span>
<span class="-1689277129606306081" onmouseenter="enter('-1689277129606306081');" onmouseout="out('-1689277129606306081');" style=""> 599              if (version &lt; 21) {                                                                                   </span>
<span class="-7646592925974879249" onmouseenter="enter('-7646592925974879249');" onmouseout="out('-7646592925974879249');" style=""> 600                  if (updateFolderItemsRank(db, true)) {                                                            </span>
<span class="8220648455759030377" onmouseenter="enter('8220648455759030377');" onmouseout="out('8220648455759030377');" style=""> 601                      version  = 21;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 602                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 603              }                                                                                                     </span>
<span  style=""> 604                                                                                                                    </span>
<span class="-4846602042225353550" onmouseenter="enter('-4846602042225353550');" onmouseout="out('-4846602042225353550');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 605 +            if (version == 21) {                                                                                  </span>
<span class="-5097001155547350088" onmouseenter="enter('-5097001155547350088');" onmouseout="out('-5097001155547350088');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 606 +                // Recreate workspace table with screen id a primary key                                          </span>
<span class="697484093328969732" onmouseenter="enter('697484093328969732');" onmouseout="out('697484093328969732');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 607 +                if (recreateWorkspaceTable(db)) {                                                                 </span>
<span class="987773274296909165" onmouseenter="enter('987773274296909165');" onmouseout="out('987773274296909165');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 608 +                    version = 22;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 609 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 610 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 611 +                                                                                                                  </span>
<span class="114284109908766623" onmouseenter="enter('114284109908766623');" onmouseout="out('114284109908766623');" style=""> 612              if (version != DATABASE_VERSION) {                                                                    </span>
<span class="-7581134992168079572" onmouseenter="enter('-7581134992168079572');" onmouseout="out('-7581134992168079572');" style=""> 613                  Log.w(TAG, &quot;Destroying all old data.&quot;);                                                           </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 614                  createEmptyDB(db);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615              }                                                                                                     </span>



























































































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 616          }                                                                                                         </span>
<span  style=""> 617                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 618          @Override                                                                                                 </span>
<span class="-4280970083266341851" onmouseenter="enter('-4280970083266341851');" onmouseout="out('-4280970083266341851');" style=""> 619          public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {                              </span>
<span class="60635965215078249" onmouseenter="enter('60635965215078249');" onmouseout="out('60635965215078249');" style=""> 620              // This shouldn&#x27;t happen -- throw our hands up in the air and start over.                             </span>
<span class="5860333668228362795" onmouseenter="enter('5860333668228362795');" onmouseout="out('5860333668228362795');" style=""> 621              Log.w(TAG, &quot;Database version downgrade from: &quot; + oldVersion + &quot; to &quot; + newVersion +                   </span>
<span class="-495411336639494791" onmouseenter="enter('-495411336639494791');" onmouseout="out('-495411336639494791');" style=""> 622                      &quot;. Wiping databse.&quot;);                                                                         </span>
<span class="8331352315618770000" onmouseenter="enter('8331352315618770000');" onmouseout="out('8331352315618770000');" style=""> 623              createEmptyDB(db);                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624          }                                                                                                         </span>
<span  style=""> 625                                                                                                                    </span>
<span  style=""> 626                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 627          /**                                                                                                       </span>
<span class="-3404890512310195543" onmouseenter="enter('-3404890512310195543');" onmouseout="out('-3404890512310195543');" style=""> 628           * Clears all the data for a fresh start.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 629           */                                                                                                       </span>
<span class="3436200006891248330" onmouseenter="enter('3436200006891248330');" onmouseout="out('3436200006891248330');" style=""> 630          public void createEmptyDB(SQLiteDatabase db) {                                                            </span>
<span class="-5910745818286558462" onmouseenter="enter('-5910745818286558462');" onmouseout="out('-5910745818286558462');" style=""> 631              db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_FAVORITES);                                                </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style=""> 632              db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                                        </span>
<span class="1466158746107327510" onmouseenter="enter('1466158746107327510');" onmouseout="out('1466158746107327510');" style=""> 633              onCreate(db);                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 634 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 635 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 636 +        /**                                                                                                       </span>
<span class="-1053110313716749360" onmouseenter="enter('-1053110313716749360');" onmouseout="out('-1053110313716749360');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 637 +         * Recreates workspace table and migrates data to the new table.                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +         */                                                                                                       </span>
<span class="-7546703806174777110" onmouseenter="enter('-7546703806174777110');" onmouseout="out('-7546703806174777110');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 639 +        public boolean recreateWorkspaceTable(SQLiteDatabase db) {                                                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 640 +            db.beginTransaction();                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 641 +            try {                                                                                                 </span>
<span class="5182132674792153706" onmouseenter="enter('5182132674792153706');" onmouseout="out('5182132674792153706');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 642 +                Cursor c = db.query(TABLE_WORKSPACE_SCREENS,                                                      </span>
<span class="3343280592061827584" onmouseenter="enter('3343280592061827584');" onmouseout="out('3343280592061827584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 643 +                        new String[] {LauncherSettings.WorkspaceScreens._ID},                                     </span>
<span class="2929567931923591515" onmouseenter="enter('2929567931923591515');" onmouseout="out('2929567931923591515');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 644 +                        null, null, null, null,                                                                   </span>
<span class="5916017515631826997" onmouseenter="enter('5916017515631826997');" onmouseout="out('5916017515631826997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 645 +                        LauncherSettings.WorkspaceScreens.SCREEN_RANK);                                           </span>
<span class="-1823344416972566514" onmouseenter="enter('-1823344416972566514');" onmouseout="out('-1823344416972566514');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 646 +                ArrayList&lt;Long&gt; sortedIDs = new ArrayList&lt;Long&gt;();                                                </span>
<span class="4402015381954986250" onmouseenter="enter('4402015381954986250');" onmouseout="out('4402015381954986250');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 647 +                long maxId = 0;                                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 648 +                try {                                                                                             </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 649 +                    while (c.moveToNext()) {                                                                      </span>
<span class="3955822985937591936" onmouseenter="enter('3955822985937591936');" onmouseout="out('3955822985937591936');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 650 +                        Long id = c.getLong(0);                                                                   </span>
<span class="-8099018151679223899" onmouseenter="enter('-8099018151679223899');" onmouseout="out('-8099018151679223899');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 651 +                        if (!sortedIDs.contains(id)) {                                                            </span>
<span class="4916945519325465611" onmouseenter="enter('4916945519325465611');" onmouseout="out('4916945519325465611');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 652 +                            sortedIDs.add(id);                                                                    </span>
<span class="2021292296450644008" onmouseenter="enter('2021292296450644008');" onmouseout="out('2021292296450644008');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 653 +                            maxId = Math.max(maxId, id);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 654 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 655 +                    }                                                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 656 +                } finally {                                                                                       </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 657 +                    c.close();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 658 +                }                                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 659 +                                                                                                                  </span>
<span class="-5689649720940552120" onmouseenter="enter('-5689649720940552120');" onmouseout="out('-5689649720940552120');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 660 +                db.execSQL(&quot;DROP TABLE IF EXISTS &quot; + TABLE_WORKSPACE_SCREENS);                                    </span>
<span class="4995577433356427338" onmouseenter="enter('4995577433356427338');" onmouseout="out('4995577433356427338');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 661 +                addWorkspacesTable(db);                                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 662 +                                                                                                                  </span>
<span class="-8504221546344504536" onmouseenter="enter('-8504221546344504536');" onmouseout="out('-8504221546344504536');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 663 +                // Add all screen ids back                                                                        </span>
<span class="-3342479167869315002" onmouseenter="enter('-3342479167869315002');" onmouseout="out('-3342479167869315002');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 664 +                int total = sortedIDs.size();                                                                     </span>
<span class="1933062560544426975" onmouseenter="enter('1933062560544426975');" onmouseout="out('1933062560544426975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 665 +                for (int i = 0; i &lt; total; i++) {                                                                 </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 666 +                    ContentValues values = new ContentValues();                                                   </span>
<span class="-1408476222282542161" onmouseenter="enter('-1408476222282542161');" onmouseout="out('-1408476222282542161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 667 +                    values.put(LauncherSettings.WorkspaceScreens._ID, sortedIDs.get(i));                          </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 668 +                    values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                                 </span>
<span class="5593303527651076681" onmouseenter="enter('5593303527651076681');" onmouseout="out('5593303527651076681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 669 +                    addModifiedTime(values);                                                                      </span>
<span class="-5345205574848137989" onmouseenter="enter('-5345205574848137989');" onmouseout="out('-5345205574848137989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 670 +                    db.insertOrThrow(TABLE_WORKSPACE_SCREENS, null, values);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 671 +                }                                                                                                 </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 672 +                db.setTransactionSuccessful();                                                                    </span>
<span class="-777319983275495791" onmouseenter="enter('-777319983275495791');" onmouseout="out('-777319983275495791');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 673 +                mMaxScreenId = maxId;                                                                             </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 674 +            } catch (SQLException ex) {                                                                           </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 675 +                // Old version remains, which means we wipe old data                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 676 +                Log.e(TAG, ex.getMessage(), ex);                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 677 +                return false;                                                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 678 +            } finally {                                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 679 +                db.endTransaction();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 680 +            }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 681 +            return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 682          }                                                                                                         </span>
<span  style=""> 683                                                                                                                    </span>
<span class="-7501286576844846445" onmouseenter="enter('-7501286576844846445');" onmouseout="out('-7501286576844846445');" style=""> 684          private boolean updateFolderItemsRank(SQLiteDatabase db, boolean addRankColumn) {                         </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 685              db.beginTransaction();                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 686              try {                                                                                                 </span>
<span class="5008547084206266322" onmouseenter="enter('5008547084206266322');" onmouseout="out('5008547084206266322');" style=""> 687                  if (addRankColumn) {                                                                              </span>
<span class="-7289454301230657535" onmouseenter="enter('-7289454301230657535');" onmouseout="out('-7289454301230657535');" style=""> 688                      // Insert new column for holding rank                                                         </span>
<span class="-1590113536171608350" onmouseenter="enter('-1590113536171608350');" onmouseout="out('-1590113536171608350');" style=""> 689                      db.execSQL(&quot;ALTER TABLE favorites ADD COLUMN rank INTEGER NOT NULL DEFAULT 0;&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690                  }                                                                                                 </span>
<span  style=""> 691                                                                                                                    </span>
<span class="-6084339731876053459" onmouseenter="enter('-6084339731876053459');" onmouseout="out('-6084339731876053459');" style=""> 692                  // Get a map for folder ID to folder width                                                        </span>
<span class="7958578721408666232" onmouseenter="enter('7958578721408666232');" onmouseout="out('7958578721408666232');" style=""> 693                  Cursor c = db.rawQuery(&quot;SELECT container, MAX(cellX) FROM favorites&quot;                              </span>
<span class="1296304159181878428" onmouseenter="enter('1296304159181878428');" onmouseout="out('1296304159181878428');" style=""> 694                          + &quot; WHERE container IN (SELECT _id FROM favorites WHERE itemType = ?)&quot;                    </span>
<span class="8240981592991850481" onmouseenter="enter('8240981592991850481');" onmouseout="out('8240981592991850481');" style=""> 695                          + &quot; GROUP BY container;&quot;,                                                                 </span>
<span class="-3631725497478036647" onmouseenter="enter('-3631725497478036647');" onmouseout="out('-3631725497478036647');" style=""> 696                          new String[] {Integer.toString(LauncherSettings.Favorites.ITEM_TYPE_FOLDER)});            </span>
<span  style=""> 697                                                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style=""> 698                  while (c.moveToNext()) {                                                                          </span>
<span class="-6809072711155135098" onmouseenter="enter('-6809072711155135098');" onmouseout="out('-6809072711155135098');" style=""> 699                      db.execSQL(&quot;UPDATE favorites SET rank=cellX+(cellY*?) WHERE &quot;                                 </span>
<span class="8697652523066470339" onmouseenter="enter('8697652523066470339');" onmouseout="out('8697652523066470339');" style=""> 700                              + &quot;container=? AND cellX IS NOT NULL AND cellY IS NOT NULL;&quot;,                         </span>
<span class="-3010724386050799789" onmouseenter="enter('-3010724386050799789');" onmouseout="out('-3010724386050799789');" style=""> 701                              new Object[] {c.getLong(1) + 1, c.getLong(0)});                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702                  }                                                                                                 </span>
<span  style=""> 703                                                                                                                    </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 704                  c.close();                                                                                        </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 705                  db.setTransactionSuccessful();                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 706              } catch (SQLException ex) {                                                                           </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 707                  // Old version remains, which means we wipe old data                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 708                  Log.e(TAG, ex.getMessage(), ex);                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 709                  return false;                                                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 710              } finally {                                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 711                  db.endTransaction();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 712              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 713              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 714          }                                                                                                         </span>
<span  style=""> 715                                                                                                                    </span>
<span class="-4559468305095454841" onmouseenter="enter('-4559468305095454841');" onmouseout="out('-4559468305095454841');" style=""> 716          private boolean addProfileColumn(SQLiteDatabase db) {                                                     </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style=""> 717              db.beginTransaction();                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 718              try {                                                                                                 </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style=""> 719                  UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);                          </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style=""> 720                  // Default to the serial number of this user, for older                                           </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style=""> 721                  // shortcuts.                                                                                     </span>
<span class="1087451883287607054" onmouseenter="enter('1087451883287607054');" onmouseout="out('1087451883287607054');" style=""> 722                  long userSerialNumber = userManager.getSerialNumberForUser(                                       </span>
<span class="334342413311659427" onmouseenter="enter('334342413311659427');" onmouseout="out('334342413311659427');" style=""> 723                          UserHandleCompat.myUserHandle());                                                         </span>
<span class="-7537890297935646580" onmouseenter="enter('-7537890297935646580');" onmouseout="out('-7537890297935646580');" style=""> 724                  // Insert new column for holding user serial number                                               </span>
<span class="8053875386236386954" onmouseenter="enter('8053875386236386954');" onmouseout="out('8053875386236386954');" style=""> 725                  db.execSQL(&quot;ALTER TABLE favorites &quot; +                                                             </span>
<span class="6389325795698900878" onmouseenter="enter('6389325795698900878');" onmouseout="out('6389325795698900878');" style=""> 726                          &quot;ADD COLUMN profileId INTEGER DEFAULT &quot;                                                   </span>
<span class="-6027465318491077769" onmouseenter="enter('-6027465318491077769');" onmouseout="out('-6027465318491077769');" style=""> 727                                          + userSerialNumber + &quot;;&quot;);                                                </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style=""> 728                  db.setTransactionSuccessful();                                                                    </span>
<span class="834053493450862597" onmouseenter="enter('834053493450862597');" onmouseout="out('834053493450862597');" style=""> 729              } catch (SQLException ex) {                                                                           </span>
<span class="4871996975441455786" onmouseenter="enter('4871996975441455786');" onmouseout="out('4871996975441455786');" style=""> 730                  // Old version remains, which means we wipe old data                                              </span>
<span class="-1305429537619041081" onmouseenter="enter('-1305429537619041081');" onmouseout="out('-1305429537619041081');" style=""> 731                  Log.e(TAG, ex.getMessage(), ex);                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 732                  return false;                                                                                     </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 733              } finally {                                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style=""> 734                  db.endTransaction();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 735              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 736              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 737          }                                                                                                         </span>
<span  style=""> 738                                                                                                                    </span>
<span class="-8543343401238088250" onmouseenter="enter('-8543343401238088250');" onmouseout="out('-8543343401238088250');" style=""> 739          // Generates a new ID to use for an object in your database. This method should be only                   </span>
<span class="-535999813132446250" onmouseenter="enter('-535999813132446250');" onmouseout="out('-535999813132446250');" style=""> 740          // called from the main UI thread. As an exception, we do call it when we call the                        </span>
<span class="-3416944691245960228" onmouseenter="enter('-3416944691245960228');" onmouseout="out('-3416944691245960228');" style=""> 741          // constructor from the worker thread; however, this doesn&#x27;t extend until after the                       </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 742          // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp                 </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 743          // after that point                                                                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 744          @Override                                                                                                 </span>
<span class="2178013549114956338" onmouseenter="enter('2178013549114956338');" onmouseout="out('2178013549114956338');" style=""> 745          public long generateNewItemId() {                                                                         </span>
<span class="2999684209048406821" onmouseenter="enter('2999684209048406821');" onmouseout="out('2999684209048406821');" style=""> 746              if (mMaxItemId &lt; 0) {                                                                                 </span>
<span class="-7068859972649181897" onmouseenter="enter('-7068859972649181897');" onmouseout="out('-7068859972649181897');" style=""> 747                  throw new RuntimeException(&quot;Error: max item id was not initialized&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 748              }                                                                                                     </span>
<span class="-2732750815463784999" onmouseenter="enter('-2732750815463784999');" onmouseout="out('-2732750815463784999');" style=""> 749              mMaxItemId += 1;                                                                                      </span>
<span class="5456580978366825274" onmouseenter="enter('5456580978366825274');" onmouseout="out('5456580978366825274');" style=""> 750              return mMaxItemId;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 751          }                                                                                                         </span>
<span  style=""> 752                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 753          @Override                                                                                                 </span>
<span class="329443540154066398" onmouseenter="enter('329443540154066398');" onmouseout="out('329443540154066398');" style=""> 754          public long insertAndCheck(SQLiteDatabase db, ContentValues values) {                                     </span>
<span class="-1505151618823806706" onmouseenter="enter('-1505151618823806706');" onmouseout="out('-1505151618823806706');" style=""> 755              return dbInsertAndCheck(this, db, TABLE_FAVORITES, null, values);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 756          }                                                                                                         </span>
<span  style=""> 757                                                                                                                    </span>
<span class="8365827129597185054" onmouseenter="enter('8365827129597185054');" onmouseout="out('8365827129597185054');" style=""> 758          public void updateMaxItemId(long id) {                                                                    </span>
<span class="-6849429476525109058" onmouseenter="enter('-6849429476525109058');" onmouseout="out('-6849429476525109058');" style=""> 759              mMaxItemId = id + 1;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 760          }                                                                                                         </span>
<span  style=""> 761                                                                                                                    </span>
<span class="-7367368828761155068" onmouseenter="enter('-7367368828761155068');" onmouseout="out('-7367368828761155068');" style=""> 762          public void checkId(String table, ContentValues values) {                                                 </span>
<span class="-1608142162103033850" onmouseenter="enter('-1608142162103033850');" onmouseout="out('-1608142162103033850');" style=""> 763              long id = values.getAsLong(LauncherSettings.BaseLauncherColumns._ID);                                 </span>
<span class="-6900211224990683940" onmouseenter="enter('-6900211224990683940');" onmouseout="out('-6900211224990683940');" style=""> 764              if (table == LauncherProvider.TABLE_WORKSPACE_SCREENS) {                                              </span>
<span class="9109073648364222254" onmouseenter="enter('9109073648364222254');" onmouseout="out('9109073648364222254');" style=""> 765                  mMaxScreenId = Math.max(id, mMaxScreenId);                                                        </span>
<span class="-6240460135729763291" onmouseenter="enter('-6240460135729763291');" onmouseout="out('-6240460135729763291');" style=""> 766              }  else {                                                                                             </span>
<span class="754800730159449376" onmouseenter="enter('754800730159449376');" onmouseout="out('754800730159449376');" style=""> 767                  mMaxItemId = Math.max(id, mMaxItemId);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 768              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 769          }                                                                                                         </span>
<span  style=""> 770                                                                                                                    </span>
<span class="-8013451254632200820" onmouseenter="enter('-8013451254632200820');" onmouseout="out('-8013451254632200820');" style=""> 771          private long initializeMaxItemId(SQLiteDatabase db) {                                                     </span>
<span class="-6457280004469744269" onmouseenter="enter('-6457280004469744269');" onmouseout="out('-6457280004469744269');" style=""> 772              Cursor c = db.rawQuery(&quot;SELECT MAX(_id) FROM favorites&quot;, null);                                       </span>
<span  style=""> 773                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 774              // get the result                                                                                     </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 775              final int maxIdIndex = 0;                                                                             </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 776              long id = -1;                                                                                         </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 777              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 778                  id = c.getLong(maxIdIndex);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 779              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 780              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 781                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 782              }                                                                                                     </span>
<span  style=""> 783                                                                                                                    </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 784              if (id == -1) {                                                                                       </span>
<span class="-8632333559810917367" onmouseenter="enter('-8632333559810917367');" onmouseout="out('-8632333559810917367');" style=""> 785                  throw new RuntimeException(&quot;Error: could not query max item id&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 786              }                                                                                                     </span>
<span  style=""> 787                                                                                                                    </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 788              return id;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 789          }                                                                                                         </span>
<span  style=""> 790                                                                                                                    </span>
<span class="3292148501075941248" onmouseenter="enter('3292148501075941248');" onmouseout="out('3292148501075941248');" style=""> 791          // Generates a new ID to use for an workspace screen in your database. This method                        </span>
<span class="8169251972405240623" onmouseenter="enter('8169251972405240623');" onmouseout="out('8169251972405240623');" style=""> 792          // should be only called from the main UI thread. As an exception, we do call it when we                  </span>
<span class="5354260748737756868" onmouseenter="enter('5354260748737756868');" onmouseout="out('5354260748737756868');" style=""> 793          // call the constructor from the worker thread; however, this doesn&#x27;t extend until after the              </span>
<span class="506358615447788975" onmouseenter="enter('506358615447788975');" onmouseout="out('506358615447788975');" style=""> 794          // constructor is called, and we only pass a reference to LauncherProvider to LauncherApp                 </span>
<span class="7265707553198201311" onmouseenter="enter('7265707553198201311');" onmouseout="out('7265707553198201311');" style=""> 795          // after that point                                                                                       </span>
<span class="3794345207933084858" onmouseenter="enter('3794345207933084858');" onmouseout="out('3794345207933084858');" style=""> 796          public long generateNewScreenId() {                                                                       </span>
<span class="-2601779586206833262" onmouseenter="enter('-2601779586206833262');" onmouseout="out('-2601779586206833262');" style=""> 797              if (mMaxScreenId &lt; 0) {                                                                               </span>
<span class="-8395628436366181623" onmouseenter="enter('-8395628436366181623');" onmouseout="out('-8395628436366181623');" style=""> 798                  throw new RuntimeException(&quot;Error: max screen id was not initialized&quot;);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 799              }                                                                                                     </span>
<span class="-7600499966171393409" onmouseenter="enter('-7600499966171393409');" onmouseout="out('-7600499966171393409');" style=""> 800              mMaxScreenId += 1;                                                                                    </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 801              // Log to disk                                                                                        </span>
<span class="-8761729187376845632" onmouseenter="enter('-8761729187376845632');" onmouseout="out('-8761729187376845632');" style=""> 802              Launcher.addDumpLog(TAG, &quot;11683562 - generateNewScreenId(): &quot; + mMaxScreenId, true);                  </span>
<span class="-2082539956971430335" onmouseenter="enter('-2082539956971430335');" onmouseout="out('-2082539956971430335');" style=""> 803              return mMaxScreenId;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804          }                                                                                                         </span>
<span  style=""> 805                                                                                                                    </span>
<span class="-7531165898061832726" onmouseenter="enter('-7531165898061832726');" onmouseout="out('-7531165898061832726');" style=""> 806          public void updateMaxScreenId(long maxScreenId) {                                                         </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 807              // Log to disk                                                                                        </span>
<span class="-6999371015775210769" onmouseenter="enter('-6999371015775210769');" onmouseout="out('-6999371015775210769');" style=""> 808              Launcher.addDumpLog(TAG, &quot;11683562 - updateMaxScreenId(): &quot; + maxScreenId, true);                     </span>
<span class="-5262779621072196869" onmouseenter="enter('-5262779621072196869');" onmouseout="out('-5262779621072196869');" style=""> 809              mMaxScreenId = maxScreenId;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 810          }                                                                                                         </span>
<span  style=""> 811                                                                                                                    </span>
<span class="1340022180158952931" onmouseenter="enter('1340022180158952931');" onmouseout="out('1340022180158952931');" style=""> 812          private long initializeMaxScreenId(SQLiteDatabase db) {                                                   </span>
<span class="-2625939584691052131" onmouseenter="enter('-2625939584691052131');" onmouseout="out('-2625939584691052131');" style=""><abbr title=" 813              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);"> 813              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens._ID + &quot;) FROM &quot; + TABLE_WORKS🔵</abbr></span>
<span  style=""> 814                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 815              // get the result                                                                                     </span>
<span class="-7318978250879363167" onmouseenter="enter('-7318978250879363167');" onmouseout="out('-7318978250879363167');" style=""> 816              final int maxIdIndex = 0;                                                                             </span>
<span class="-3996593593662644650" onmouseenter="enter('-3996593593662644650');" onmouseout="out('-3996593593662644650');" style=""> 817              long id = -1;                                                                                         </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 818              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="6252863560499548901" onmouseenter="enter('6252863560499548901');" onmouseout="out('6252863560499548901');" style=""> 819                  id = c.getLong(maxIdIndex);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 820              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 821              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 822                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 823              }                                                                                                     </span>
<span  style=""> 824                                                                                                                    </span>
<span class="-7988774182034385411" onmouseenter="enter('-7988774182034385411');" onmouseout="out('-7988774182034385411');" style=""> 825              if (id == -1) {                                                                                       </span>
<span class="5981752458110974976" onmouseenter="enter('5981752458110974976');" onmouseout="out('5981752458110974976');" style=""> 826                  throw new RuntimeException(&quot;Error: could not query max screen id&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 827              }                                                                                                     </span>
<span  style=""> 828                                                                                                                    </span>
<span class="-1491903033538594858" onmouseenter="enter('-1491903033538594858');" onmouseout="out('-1491903033538594858');" style=""> 829              // Log to disk                                                                                        </span>
<span class="27430974887508761" onmouseenter="enter('27430974887508761');" onmouseout="out('27430974887508761');" style=""> 830              Launcher.addDumpLog(TAG, &quot;11683562 - initializeMaxScreenId(): &quot; + id, true);                          </span>
<span class="-3074727595953522219" onmouseenter="enter('-3074727595953522219');" onmouseout="out('-3074727595953522219');" style=""> 831              return id;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832          }                                                                                                         </span>
<span  style=""> 833                                                                                                                    </span>
<span class="1383368615032249869" onmouseenter="enter('1383368615032249869');" onmouseout="out('1383368615032249869');" style=""> 834          private boolean initializeExternalAdd(ContentValues values) {                                             </span>
<span class="-4585320292275114767" onmouseenter="enter('-4585320292275114767');" onmouseout="out('-4585320292275114767');" style=""> 835              // 1. Ensure that externally added items have a valid item id                                         </span>
<span class="-4828262327370557067" onmouseenter="enter('-4828262327370557067');" onmouseout="out('-4828262327370557067');" style=""> 836              long id = generateNewItemId();                                                                        </span>
<span class="-4305015780380424948" onmouseenter="enter('-4305015780380424948');" onmouseout="out('-4305015780380424948');" style=""> 837              values.put(LauncherSettings.Favorites._ID, id);                                                       </span>
<span  style=""> 838                                                                                                                    </span>
<span class="5555856101718413728" onmouseenter="enter('5555856101718413728');" onmouseout="out('5555856101718413728');" style=""> 839              // 2. In the case of an app widget, and if no app widget id is specified, we                          </span>
<span class="5653436237424007902" onmouseenter="enter('5653436237424007902');" onmouseout="out('5653436237424007902');" style=""> 840              // attempt allocate and bind the widget.                                                              </span>
<span class="7737959233990593661" onmouseenter="enter('7737959233990593661');" onmouseout="out('7737959233990593661');" style=""> 841              Integer itemType = values.getAsInteger(LauncherSettings.Favorites.ITEM_TYPE);                         </span>
<span class="2055658702897830579" onmouseenter="enter('2055658702897830579');" onmouseout="out('2055658702897830579');" style=""> 842              if (itemType != null &amp;&amp;                                                                               </span>
<span class="-1739021162756129174" onmouseenter="enter('-1739021162756129174');" onmouseout="out('-1739021162756129174');" style=""> 843                      itemType.intValue() == LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET &amp;&amp;                      </span>
<span class="-6215251601594981481" onmouseenter="enter('-6215251601594981481');" onmouseout="out('-6215251601594981481');" style=""> 844                      !values.containsKey(LauncherSettings.Favorites.APPWIDGET_ID)) {                               </span>
<span  style=""> 845                                                                                                                    </span>
<span class="328319718470950320" onmouseenter="enter('328319718470950320');" onmouseout="out('328319718470950320');" style=""> 846                  final AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(mContext);                 </span>
<span class="7884761264945585321" onmouseenter="enter('7884761264945585321');" onmouseout="out('7884761264945585321');" style=""> 847                  ComponentName cn = ComponentName.unflattenFromString(                                             </span>
<span class="2179911768770688102" onmouseenter="enter('2179911768770688102');" onmouseout="out('2179911768770688102');" style=""> 848                          values.getAsString(Favorites.APPWIDGET_PROVIDER));                                        </span>
<span  style=""> 849                                                                                                                    </span>
<span class="3459055710499452007" onmouseenter="enter('3459055710499452007');" onmouseout="out('3459055710499452007');" style=""> 850                  if (cn != null) {                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 851                      try {                                                                                         </span>
<span class="7176738113779216844" onmouseenter="enter('7176738113779216844');" onmouseout="out('7176738113779216844');" style=""> 852                          int appWidgetId = mAppWidgetHost.allocateAppWidgetId();                                   </span>
<span class="3122228588084428979" onmouseenter="enter('3122228588084428979');" onmouseout="out('3122228588084428979');" style=""> 853                          values.put(LauncherSettings.Favorites.APPWIDGET_ID, appWidgetId);                         </span>
<span class="2309614617117273311" onmouseenter="enter('2309614617117273311');" onmouseout="out('2309614617117273311');" style=""> 854                          if (!appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn)) {                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 855                              return false;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 856                          }                                                                                         </span>
<span class="1200625667814236005" onmouseenter="enter('1200625667814236005');" onmouseout="out('1200625667814236005');" style=""> 857                      } catch (RuntimeException e) {                                                                </span>
<span class="9049318523495391496" onmouseenter="enter('9049318523495391496');" onmouseout="out('9049318523495391496');" style=""> 858                          Log.e(TAG, &quot;Failed to initialize external widget&quot;, e);                                    </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 859                          return false;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 860                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 861                  } else {                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 862                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 863                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 864              }                                                                                                     </span>
<span  style=""> 865                                                                                                                    </span>
<span class="-5393917371757635815" onmouseenter="enter('-5393917371757635815');" onmouseout="out('-5393917371757635815');" style=""> 866              // Add screen id if not present                                                                       </span>
<span class="-8492193036384627967" onmouseenter="enter('-8492193036384627967');" onmouseout="out('-8492193036384627967');" style=""> 867              long screenId = values.getAsLong(LauncherSettings.Favorites.SCREEN);                                  </span>
<span class="-8472780943665027311" onmouseenter="enter('-8472780943665027311');" onmouseout="out('-8472780943665027311');" style=""> 868              if (!addScreenIdIfNecessary(screenId)) {                                                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 869                  return false;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 870              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 871              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 872          }                                                                                                         </span>
<span  style=""> 873                                                                                                                    </span>
<span class="7352835902307890843" onmouseenter="enter('7352835902307890843');" onmouseout="out('7352835902307890843');" style=""> 874          // Returns true of screen id exists, or if successfully added                                             </span>
<span class="-4057720447241324922" onmouseenter="enter('-4057720447241324922');" onmouseout="out('-4057720447241324922');" style=""> 875          private boolean addScreenIdIfNecessary(long screenId) {                                                   </span>
<span class="-8332527954530563349" onmouseenter="enter('-8332527954530563349');" onmouseout="out('-8332527954530563349');" style=""> 876              if (!hasScreenId(screenId)) {                                                                         </span>
<span class="-3380006025674561043" onmouseenter="enter('-3380006025674561043');" onmouseout="out('-3380006025674561043');" style=""> 877                  int rank = getMaxScreenRank() + 1;                                                                </span>
<span  style=""> 878                                                                                                                    </span>
<span class="4061202061343128850" onmouseenter="enter('4061202061343128850');" onmouseout="out('4061202061343128850');" style=""> 879                  ContentValues v = new ContentValues();                                                            </span>
<span class="-5112420615000020353" onmouseenter="enter('-5112420615000020353');" onmouseout="out('-5112420615000020353');" style=""> 880                  v.put(LauncherSettings.WorkspaceScreens._ID, screenId);                                           </span>
<span class="6806563186306365402" onmouseenter="enter('6806563186306365402');" onmouseout="out('6806563186306365402');" style=""> 881                  v.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                                       </span>
<span class="-1115795847996433461" onmouseenter="enter('-1115795847996433461');" onmouseout="out('-1115795847996433461');" style=""> 882                  if (dbInsertAndCheck(this, getWritableDatabase(),                                                 </span>
<span class="3238415722136121635" onmouseenter="enter('3238415722136121635');" onmouseout="out('3238415722136121635');" style=""> 883                          TABLE_WORKSPACE_SCREENS, null, v) &lt; 0) {                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 884                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 885                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 886              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 887              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 888          }                                                                                                         </span>
<span  style=""> 889                                                                                                                    </span>
<span class="5478264759768975399" onmouseenter="enter('5478264759768975399');" onmouseout="out('5478264759768975399');" style=""> 890          private boolean hasScreenId(long screenId) {                                                              </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 891              SQLiteDatabase db = getWritableDatabase();                                                            </span>
<span class="7657123469267572077" onmouseenter="enter('7657123469267572077');" onmouseout="out('7657123469267572077');" style=""> 892              Cursor c = db.rawQuery(&quot;SELECT * FROM &quot; + TABLE_WORKSPACE_SCREENS + &quot; WHERE &quot;                         </span>
<span class="1858055579641267103" onmouseenter="enter('1858055579641267103');" onmouseout="out('1858055579641267103');" style=""> 893                      + LauncherSettings.WorkspaceScreens._ID + &quot; = &quot; + screenId, null);                            </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 894              if (c != null) {                                                                                      </span>
<span class="-7874906179005583875" onmouseenter="enter('-7874906179005583875');" onmouseout="out('-7874906179005583875');" style=""> 895                  int count = c.getCount();                                                                         </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 896                  c.close();                                                                                        </span>
<span class="4255567607434315929" onmouseenter="enter('4255567607434315929');" onmouseout="out('4255567607434315929');" style=""> 897                  return count &gt; 0;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 898              } else {                                                                                              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 899                  return false;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 900              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 901          }                                                                                                         </span>
<span  style=""> 902                                                                                                                    </span>
<span class="-2708828914383579811" onmouseenter="enter('-2708828914383579811');" onmouseout="out('-2708828914383579811');" style=""> 903          private int getMaxScreenRank() {                                                                          </span>
<span class="2098776625240525845" onmouseenter="enter('2098776625240525845');" onmouseout="out('2098776625240525845');" style=""> 904              SQLiteDatabase db = getWritableDatabase();                                                            </span>
<span class="4567502420956726358" onmouseenter="enter('4567502420956726358');" onmouseout="out('4567502420956726358');" style=""> 905              Cursor c = db.rawQuery(&quot;SELECT MAX(&quot; + LauncherSettings.WorkspaceScreens.SCREEN_RANK                  </span>
<span class="-851271521804486447" onmouseenter="enter('-851271521804486447');" onmouseout="out('-851271521804486447');" style=""> 906                      + &quot;) FROM &quot; + TABLE_WORKSPACE_SCREENS, null);                                                 </span>
<span  style=""> 907                                                                                                                    </span>
<span class="-7794263827987261163" onmouseenter="enter('-7794263827987261163');" onmouseout="out('-7794263827987261163');" style=""> 908              // get the result                                                                                     </span>
<span class="-7089673966704675292" onmouseenter="enter('-7089673966704675292');" onmouseout="out('-7089673966704675292');" style=""> 909              final int maxRankIndex = 0;                                                                           </span>
<span class="8995972804405745177" onmouseenter="enter('8995972804405745177');" onmouseout="out('8995972804405745177');" style=""> 910              int rank = -1;                                                                                        </span>
<span class="2006356297883322098" onmouseenter="enter('2006356297883322098');" onmouseout="out('2006356297883322098');" style=""> 911              if (c != null &amp;&amp; c.moveToNext()) {                                                                    </span>
<span class="-130706833968251970" onmouseenter="enter('-130706833968251970');" onmouseout="out('-130706833968251970');" style=""> 912                  rank = c.getInt(maxRankIndex);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 913              }                                                                                                     </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 914              if (c != null) {                                                                                      </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style=""> 915                  c.close();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 916              }                                                                                                     </span>
<span  style=""> 917                                                                                                                    </span>
<span class="-5061660947414305561" onmouseenter="enter('-5061660947414305561');" onmouseout="out('-5061660947414305561');" style=""> 918              return rank;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 919          }                                                                                                         </span>
<span  style=""> 920                                                                                                                    </span>
<span class="7076012940679285170" onmouseenter="enter('7076012940679285170');" onmouseout="out('7076012940679285170');" style=""> 921          private int loadFavorites(SQLiteDatabase db, AutoInstallsLayout loader) {                                 </span>
<span class="-517932292017625058" onmouseenter="enter('-517932292017625058');" onmouseout="out('-517932292017625058');" style=""> 922              ArrayList&lt;Long&gt; screenIds = new ArrayList&lt;Long&gt;();                                                    </span>
<span class="-1992683231790282850" onmouseenter="enter('-1992683231790282850');" onmouseout="out('-1992683231790282850');" style=""> 923              // TODO: Use multiple loaders with fall-back and transaction.                                         </span>
<span class="-198133332043015666" onmouseenter="enter('-198133332043015666');" onmouseout="out('-198133332043015666');" style=""> 924              int count = loader.loadLayout(db, screenIds);                                                         </span>
<span  style=""> 925                                                                                                                    </span>
<span class="6833875387324148439" onmouseenter="enter('6833875387324148439');" onmouseout="out('6833875387324148439');" style=""> 926              // Add the screens specified by the items above                                                       </span>
<span class="2978539432730983390" onmouseenter="enter('2978539432730983390');" onmouseout="out('2978539432730983390');" style=""> 927              Collections.sort(screenIds);                                                                          </span>
<span class="5419352211080831355" onmouseenter="enter('5419352211080831355');" onmouseout="out('5419352211080831355');" style=""> 928              int rank = 0;                                                                                         </span>
<span class="-1148718858541057189" onmouseenter="enter('-1148718858541057189');" onmouseout="out('-1148718858541057189');" style=""> 929              ContentValues values = new ContentValues();                                                           </span>
<span class="7152107230041712979" onmouseenter="enter('7152107230041712979');" onmouseout="out('7152107230041712979');" style=""> 930              for (Long id : screenIds) {                                                                           </span>
<span class="6295623415315599771" onmouseenter="enter('6295623415315599771');" onmouseout="out('6295623415315599771');" style=""> 931                  values.clear();                                                                                   </span>
<span class="-3523466272369778299" onmouseenter="enter('-3523466272369778299');" onmouseout="out('-3523466272369778299');" style=""> 932                  values.put(LauncherSettings.WorkspaceScreens._ID, id);                                            </span>
<span class="-4819700644573994153" onmouseenter="enter('-4819700644573994153');" onmouseout="out('-4819700644573994153');" style=""> 933                  values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, rank);                                  </span>
<span class="-7619796578683976012" onmouseenter="enter('-7619796578683976012');" onmouseout="out('-7619796578683976012');" style=""> 934                  if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values) &lt; 0) {                      </span>
<span class="-4349241721568097596" onmouseenter="enter('-4349241721568097596');" onmouseout="out('-4349241721568097596');" style=""> 935                      throw new RuntimeException(&quot;Failed initialize screen table&quot;                                   </span>
<span class="6358788983404305676" onmouseenter="enter('6358788983404305676');" onmouseout="out('6358788983404305676');" style=""> 936                              + &quot;from default layout&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 937                  }                                                                                                 </span>
<span class="-39828730810908930" onmouseenter="enter('-39828730810908930');" onmouseout="out('-39828730810908930');" style=""> 938                  rank++;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939              }                                                                                                     </span>
<span  style=""> 940                                                                                                                    </span>
<span class="-1496945990523812752" onmouseenter="enter('-1496945990523812752');" onmouseout="out('-1496945990523812752');" style=""> 941              // Ensure that the max ids are initialized                                                            </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style=""> 942              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style=""> 943              mMaxScreenId = initializeMaxScreenId(db);                                                             </span>
<span  style=""> 944                                                                                                                    </span>
<span class="7714877839932947695" onmouseenter="enter('7714877839932947695');" onmouseout="out('7714877839932947695');" style=""> 945              return count;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 946          }                                                                                                         </span>
<span  style=""> 947                                                                                                                    </span>
<span class="725730754436415996" onmouseenter="enter('725730754436415996');" onmouseout="out('725730754436415996');" style=""> 948          private void migrateLauncher2Shortcuts(SQLiteDatabase db, Uri uri) {                                      </span>
<span class="-1113390730047466962" onmouseenter="enter('-1113390730047466962');" onmouseout="out('-1113390730047466962');" style=""> 949              final ContentResolver resolver = mContext.getContentResolver();                                       </span>
<span class="-3774076673393313717" onmouseenter="enter('-3774076673393313717');" onmouseout="out('-3774076673393313717');" style=""> 950              Cursor c = null;                                                                                      </span>
<span class="-7835997453776942924" onmouseenter="enter('-7835997453776942924');" onmouseout="out('-7835997453776942924');" style=""> 951              int count = 0;                                                                                        </span>
<span class="-3336839334240068207" onmouseenter="enter('-3336839334240068207');" onmouseout="out('-3336839334240068207');" style=""> 952              int curScreen = 0;                                                                                    </span>
<span  style=""> 953                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 954              try {                                                                                                 </span>
<span class="-9000085593458662527" onmouseenter="enter('-9000085593458662527');" onmouseout="out('-9000085593458662527');" style=""> 955                  c = resolver.query(uri, null, null, null, &quot;title ASC&quot;);                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 956              } catch (Exception e) {                                                                               </span>
<span class="-1642344425252950446" onmouseenter="enter('-1642344425252950446');" onmouseout="out('-1642344425252950446');" style=""> 957                  // Ignore                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 958              }                                                                                                     </span>
<span  style=""> 959                                                                                                                    </span>
<span class="-8364191572061005786" onmouseenter="enter('-8364191572061005786');" onmouseout="out('-8364191572061005786');" style=""> 960              // We already have a favorites database in the old provider                                           </span>
<span class="-6948023604691785621" onmouseenter="enter('-6948023604691785621');" onmouseout="out('-6948023604691785621');" style=""> 961              if (c != null) {                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 962                  try {                                                                                             </span>
<span class="-7145577210477193493" onmouseenter="enter('-7145577210477193493');" onmouseout="out('-7145577210477193493');" style=""> 963                      if (c.getCount() &gt; 0) {                                                                       </span>
<span class="574469590853725413" onmouseenter="enter('574469590853725413');" onmouseout="out('574469590853725413');" style=""> 964                          final int idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);              </span>
<span class="-3305857310034960574" onmouseenter="enter('-3305857310034960574');" onmouseout="out('-3305857310034960574');" style=""> 965                          final int intentIndex                                                                     </span>
<span class="7354730669796853916" onmouseenter="enter('7354730669796853916');" onmouseout="out('7354730669796853916');" style=""> 966                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);                     </span>
<span class="-5630883347545993547" onmouseenter="enter('-5630883347545993547');" onmouseout="out('-5630883347545993547');" style=""> 967                          final int titleIndex                                                                      </span>
<span class="698330273931132471" onmouseenter="enter('698330273931132471');" onmouseout="out('698330273931132471');" style=""> 968                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);                      </span>
<span class="-3330891132272232037" onmouseenter="enter('-3330891132272232037');" onmouseout="out('-3330891132272232037');" style=""> 969                          final int iconTypeIndex                                                                   </span>
<span class="7801651150775381680" onmouseenter="enter('7801651150775381680');" onmouseout="out('7801651150775381680');" style=""> 970                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);                  </span>
<span class="-1496515754016715409" onmouseenter="enter('-1496515754016715409');" onmouseout="out('-1496515754016715409');" style=""> 971                          final int iconIndex                                                                       </span>
<span class="-6743710571640483882" onmouseenter="enter('-6743710571640483882');" onmouseout="out('-6743710571640483882');" style=""> 972                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);                       </span>
<span class="-4968513115427762421" onmouseenter="enter('-4968513115427762421');" onmouseout="out('-4968513115427762421');" style=""> 973                          final int iconPackageIndex                                                                </span>
<span class="6406994869194943351" onmouseenter="enter('6406994869194943351');" onmouseout="out('6406994869194943351');" style=""> 974                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);               </span>
<span class="7917018656335895183" onmouseenter="enter('7917018656335895183');" onmouseout="out('7917018656335895183');" style=""> 975                          final int iconResourceIndex                                                               </span>
<span class="2805080254532821790" onmouseenter="enter('2805080254532821790');" onmouseout="out('2805080254532821790');" style=""> 976                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);              </span>
<span class="-4237567403763432926" onmouseenter="enter('-4237567403763432926');" onmouseout="out('-4237567403763432926');" style=""> 977                          final int containerIndex                                                                  </span>
<span class="-5056484222025497452" onmouseenter="enter('-5056484222025497452');" onmouseout="out('-5056484222025497452');" style=""> 978                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);                  </span>
<span class="-1231922168250187193" onmouseenter="enter('-1231922168250187193');" onmouseout="out('-1231922168250187193');" style=""> 979                          final int itemTypeIndex                                                                   </span>
<span class="4225538929397018586" onmouseenter="enter('4225538929397018586');" onmouseout="out('4225538929397018586');" style=""> 980                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);                  </span>
<span class="1886064968207935621" onmouseenter="enter('1886064968207935621');" onmouseout="out('1886064968207935621');" style=""> 981                          final int screenIndex                                                                     </span>
<span class="5823358741192050359" onmouseenter="enter('5823358741192050359');" onmouseout="out('5823358741192050359');" style=""> 982                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);                     </span>
<span class="148786652433469700" onmouseenter="enter('148786652433469700');" onmouseout="out('148786652433469700');" style=""> 983                          final int cellXIndex                                                                      </span>
<span class="-2420213882448561608" onmouseenter="enter('-2420213882448561608');" onmouseout="out('-2420213882448561608');" style=""> 984                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);                      </span>
<span class="7105291823960507491" onmouseenter="enter('7105291823960507491');" onmouseout="out('7105291823960507491');" style=""> 985                          final int cellYIndex                                                                      </span>
<span class="570222995967736070" onmouseenter="enter('570222995967736070');" onmouseout="out('570222995967736070');" style=""> 986                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);                      </span>
<span class="-6657516663903609513" onmouseenter="enter('-6657516663903609513');" onmouseout="out('-6657516663903609513');" style=""> 987                          final int uriIndex                                                                        </span>
<span class="-7627325667289175305" onmouseenter="enter('-7627325667289175305');" onmouseout="out('-7627325667289175305');" style=""> 988                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);                        </span>
<span class="3126191733073545935" onmouseenter="enter('3126191733073545935');" onmouseout="out('3126191733073545935');" style=""> 989                          final int displayModeIndex                                                                </span>
<span class="5824024113471232605" onmouseenter="enter('5824024113471232605');" onmouseout="out('5824024113471232605');" style=""> 990                                  = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);               </span>
<span class="6969636044710489163" onmouseenter="enter('6969636044710489163');" onmouseout="out('6969636044710489163');" style=""> 991                          final int profileIndex                                                                    </span>
<span class="-4394079448083019726" onmouseenter="enter('-4394079448083019726');" onmouseout="out('-4394079448083019726');" style=""> 992                                  = c.getColumnIndex(LauncherSettings.Favorites.PROFILE_ID);                        </span>
<span  style=""> 993                                                                                                                    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style=""> 994                          int i = 0;                                                                                </span>
<span class="3196084964022358374" onmouseenter="enter('3196084964022358374');" onmouseout="out('3196084964022358374');" style=""> 995                          int curX = 0;                                                                             </span>
<span class="-8919994129307273415" onmouseenter="enter('-8919994129307273415');" onmouseout="out('-8919994129307273415');" style=""> 996                          int curY = 0;                                                                             </span>
<span  style=""> 997                                                                                                                    </span>
<span class="1185328747399966274" onmouseenter="enter('1185328747399966274');" onmouseout="out('1185328747399966274');" style=""> 998                          final LauncherAppState app = LauncherAppState.getInstance();                              </span>
<span class="7124839587395892858" onmouseenter="enter('7124839587395892858');" onmouseout="out('7124839587395892858');" style=""> 999                          final DeviceProfile grid = app.getDynamicGrid().getDeviceProfile();                       </span>
<span class="690371396691664791" onmouseenter="enter('690371396691664791');" onmouseout="out('690371396691664791');" style="">1000                          final int width = (int) grid.numColumns;                                                  </span>
<span class="-5064901428253886355" onmouseenter="enter('-5064901428253886355');" onmouseout="out('-5064901428253886355');" style="">1001                          final int height = (int) grid.numRows;                                                    </span>
<span class="-4109722385928167056" onmouseenter="enter('-4109722385928167056');" onmouseout="out('-4109722385928167056');" style="">1002                          final int hotseatWidth = (int) grid.numHotseatIcons;                                      </span>
<span  style="">1003                                                                                                                    </span>
<span class="-4392487977825691924" onmouseenter="enter('-4392487977825691924');" onmouseout="out('-4392487977825691924');" style="">1004                          final HashSet&lt;String&gt; seenIntents = new HashSet&lt;String&gt;(c.getCount());                    </span>
<span  style="">1005                                                                                                                    </span>
<span class="-1775881703038933069" onmouseenter="enter('-1775881703038933069');" onmouseout="out('-1775881703038933069');" style="">1006                          final ArrayList&lt;ContentValues&gt; shortcuts = new ArrayList&lt;ContentValues&gt;();                </span>
<span class="-5282219486258454454" onmouseenter="enter('-5282219486258454454');" onmouseout="out('-5282219486258454454');" style="">1007                          final ArrayList&lt;ContentValues&gt; folders = new ArrayList&lt;ContentValues&gt;();                  </span>
<span class="7748304206224281059" onmouseenter="enter('7748304206224281059');" onmouseout="out('7748304206224281059');" style="">1008                          final SparseArray&lt;ContentValues&gt; hotseat = new SparseArray&lt;ContentValues&gt;();              </span>
<span  style="">1009                                                                                                                    </span>
<span class="7090462364644597234" onmouseenter="enter('7090462364644597234');" onmouseout="out('7090462364644597234');" style="">1010                          while (c.moveToNext()) {                                                                  </span>
<span class="-2982692859195643614" onmouseenter="enter('-2982692859195643614');" onmouseout="out('-2982692859195643614');" style="">1011                              final int itemType = c.getInt(itemTypeIndex);                                         </span>
<span class="-7155300134759553393" onmouseenter="enter('-7155300134759553393');" onmouseout="out('-7155300134759553393');" style="">1012                              if (itemType != Favorites.ITEM_TYPE_APPLICATION                                       </span>
<span class="-6505147694408678007" onmouseenter="enter('-6505147694408678007');" onmouseout="out('-6505147694408678007');" style="">1013                                      &amp;&amp; itemType != Favorites.ITEM_TYPE_SHORTCUT                                   </span>
<span class="-1211279440538129484" onmouseenter="enter('-1211279440538129484');" onmouseout="out('-1211279440538129484');" style="">1014                                      &amp;&amp; itemType != Favorites.ITEM_TYPE_FOLDER) {                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1015                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1016                              }                                                                                     </span>
<span  style="">1017                                                                                                                    </span>
<span class="6546086433507254477" onmouseenter="enter('6546086433507254477');" onmouseout="out('6546086433507254477');" style="">1018                              final int cellX = c.getInt(cellXIndex);                                               </span>
<span class="-5848765603231722693" onmouseenter="enter('-5848765603231722693');" onmouseout="out('-5848765603231722693');" style="">1019                              final int cellY = c.getInt(cellYIndex);                                               </span>
<span class="5057139106655212954" onmouseenter="enter('5057139106655212954');" onmouseout="out('5057139106655212954');" style="">1020                              final int screen = c.getInt(screenIndex);                                             </span>
<span class="-6682259384170717005" onmouseenter="enter('-6682259384170717005');" onmouseout="out('-6682259384170717005');" style="">1021                              int container = c.getInt(containerIndex);                                             </span>
<span class="-3517014905521526588" onmouseenter="enter('-3517014905521526588');" onmouseout="out('-3517014905521526588');" style="">1022                              final String intentStr = c.getString(intentIndex);                                    </span>
<span  style="">1023                                                                                                                    </span>
<span class="8272328117098122260" onmouseenter="enter('8272328117098122260');" onmouseout="out('8272328117098122260');" style="">1024                              UserManagerCompat userManager = UserManagerCompat.getInstance(mContext);              </span>
<span class="7210862209025052290" onmouseenter="enter('7210862209025052290');" onmouseout="out('7210862209025052290');" style="">1025                              UserHandleCompat userHandle;                                                          </span>
<span class="-704754462563124721" onmouseenter="enter('-704754462563124721');" onmouseout="out('-704754462563124721');" style="">1026                              final long userSerialNumber;                                                          </span>
<span class="-3188525411347809180" onmouseenter="enter('-3188525411347809180');" onmouseout="out('-3188525411347809180');" style="">1027                              if (profileIndex != -1 &amp;&amp; !c.isNull(profileIndex)) {                                  </span>
<span class="3377600326593357797" onmouseenter="enter('3377600326593357797');" onmouseout="out('3377600326593357797');" style="">1028                                  userSerialNumber = c.getInt(profileIndex);                                        </span>
<span class="-5580723935665666817" onmouseenter="enter('-5580723935665666817');" onmouseout="out('-5580723935665666817');" style="">1029                                  userHandle = userManager.getUserForSerialNumber(userSerialNumber);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1030                              } else {                                                                              </span>
<span class="4088992161441330589" onmouseenter="enter('4088992161441330589');" onmouseout="out('4088992161441330589');" style="">1031                                  // Default to the serial number of this user, for older                           </span>
<span class="3257211239898691615" onmouseenter="enter('3257211239898691615');" onmouseout="out('3257211239898691615');" style="">1032                                  // shortcuts.                                                                     </span>
<span class="153827185233038497" onmouseenter="enter('153827185233038497');" onmouseout="out('153827185233038497');" style="">1033                                  userHandle = UserHandleCompat.myUserHandle();                                     </span>
<span class="-7992210937529459410" onmouseenter="enter('-7992210937529459410');" onmouseout="out('-7992210937529459410');" style="">1034                                  userSerialNumber = userManager.getSerialNumberForUser(userHandle);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1035                              }                                                                                     </span>
<span  style="">1036                                                                                                                    </span>
<span class="-5734975396466070409" onmouseenter="enter('-5734975396466070409');" onmouseout="out('-5734975396466070409');" style="">1037                              if (userHandle == null) {                                                             </span>
<span class="8825647937501871391" onmouseenter="enter('8825647937501871391');" onmouseout="out('8825647937501871391');" style="">1038                                  Launcher.addDumpLog(TAG, &quot;skipping deleted user&quot;, true);                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1039                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1040                              }                                                                                     </span>
<span  style="">1041                                                                                                                    </span>
<span class="-8522267007848438017" onmouseenter="enter('-8522267007848438017');" onmouseout="out('-8522267007848438017');" style="">1042                              Launcher.addDumpLog(TAG, &quot;migrating \&quot;&quot;                                               </span>
<span class="5716371482803525639" onmouseenter="enter('5716371482803525639');" onmouseout="out('5716371482803525639');" style="">1043                                  + c.getString(titleIndex) + &quot;\&quot; (&quot;                                                </span>
<span class="1581718899431916610" onmouseenter="enter('1581718899431916610');" onmouseout="out('1581718899431916610');" style="">1044                                  + cellX + &quot;,&quot; + cellY + &quot;@&quot;                                                       </span>
<span class="-5433460809722614707" onmouseenter="enter('-5433460809722614707');" onmouseout="out('-5433460809722614707');" style="">1045                                  + LauncherSettings.Favorites.containerToString(container)                         </span>
<span class="7963207375316982791" onmouseenter="enter('7963207375316982791');" onmouseout="out('7963207375316982791');" style="">1046                                  + &quot;/&quot; + screen                                                                    </span>
<span class="6018191721230485089" onmouseenter="enter('6018191721230485089');" onmouseout="out('6018191721230485089');" style="">1047                                  + &quot;): &quot; + intentStr, true);                                                       </span>
<span  style="">1048                                                                                                                    </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1049                              if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                         </span>
<span  style="">1050                                                                                                                    </span>
<span class="-3217378244605518341" onmouseenter="enter('-3217378244605518341');" onmouseout="out('-3217378244605518341');" style="">1051                                  final Intent intent;                                                              </span>
<span class="-6604091625193940309" onmouseenter="enter('-6604091625193940309');" onmouseout="out('-6604091625193940309');" style="">1052                                  final ComponentName cn;                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1053                                  try {                                                                             </span>
<span class="-5300012287142621419" onmouseenter="enter('-5300012287142621419');" onmouseout="out('-5300012287142621419');" style="">1054                                      intent = Intent.parseUri(intentStr, 0);                                       </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style="">1055                                  } catch (URISyntaxException e) {                                                  </span>
<span class="4944972948248133238" onmouseenter="enter('4944972948248133238');" onmouseout="out('4944972948248133238');" style="">1056                                      // bogus intent?                                                              </span>
<span class="8337166236749198483" onmouseenter="enter('8337166236749198483');" onmouseout="out('8337166236749198483');" style="">1057                                      Launcher.addDumpLog(TAG,                                                      </span>
<span class="7306432149085172440" onmouseenter="enter('7306432149085172440');" onmouseout="out('7306432149085172440');" style="">1058                                              &quot;skipping invalid intent uri&quot;, true);                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1059                                      continue;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1060                                  }                                                                                 </span>
<span  style="">1061                                                                                                                    </span>
<span class="6421562153709548736" onmouseenter="enter('6421562153709548736');" onmouseout="out('6421562153709548736');" style="">1062                                  cn = intent.getComponent();                                                       </span>
<span class="1165574592669081424" onmouseenter="enter('1165574592669081424');" onmouseout="out('1165574592669081424');" style="">1063                                  if (TextUtils.isEmpty(intentStr)) {                                               </span>
<span class="1109263052506568546" onmouseenter="enter('1109263052506568546');" onmouseout="out('1109263052506568546');" style="">1064                                      // no intent? no icon                                                         </span>
<span class="-2999961336534157526" onmouseenter="enter('-2999961336534157526');" onmouseout="out('-2999961336534157526');" style="">1065                                      Launcher.addDumpLog(TAG, &quot;skipping empty intent&quot;, true);                      </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1066                                      continue;                                                                     </span>
<span class="-9117039092771941538" onmouseenter="enter('-9117039092771941538');" onmouseout="out('-9117039092771941538');" style="">1067                                  } else if (cn != null &amp;&amp;                                                          </span>
<span class="-3538782463140269707" onmouseenter="enter('-3538782463140269707');" onmouseout="out('-3538782463140269707');" style="">1068                                          !LauncherModel.isValidPackageActivity(mContext, cn,                       </span>
<span class="2012568974631198883" onmouseenter="enter('2012568974631198883');" onmouseout="out('2012568974631198883');" style="">1069                                                  userHandle)) {                                                    </span>
<span class="-8462735888325815955" onmouseenter="enter('-8462735888325815955');" onmouseout="out('-8462735888325815955');" style="">1070                                      // component no longer exists.                                                </span>
<span class="8244127631099782564" onmouseenter="enter('8244127631099782564');" onmouseout="out('8244127631099782564');" style="">1071                                      Launcher.addDumpLog(TAG, &quot;skipping item whose component &quot; +                   </span>
<span class="-2271033079359571531" onmouseenter="enter('-2271033079359571531');" onmouseout="out('-2271033079359571531');" style="">1072                                              &quot;no longer exists.&quot;, true);                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1073                                      continue;                                                                     </span>
<span class="1808399553142797413" onmouseenter="enter('1808399553142797413');" onmouseout="out('1808399553142797413');" style="">1074                                  } else if (container ==                                                           </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1075                                          LauncherSettings.Favorites.CONTAINER_DESKTOP) {                           </span>
<span class="-6651088913311152009" onmouseenter="enter('-6651088913311152009');" onmouseout="out('-6651088913311152009');" style="">1076                                      // Dedupe icons directly on the workspace                                     </span>
<span  style="">1077                                                                                                                    </span>
<span class="-7857209544272892433" onmouseenter="enter('-7857209544272892433');" onmouseout="out('-7857209544272892433');" style="">1078                                      // Canonicalize                                                               </span>
<span class="-8986671765649789370" onmouseenter="enter('-8986671765649789370');" onmouseout="out('-8986671765649789370');" style="">1079                                      // the Play Store sets the package parameter, but Launcher                    </span>
<span class="-2685712344279555181" onmouseenter="enter('-2685712344279555181');" onmouseout="out('-2685712344279555181');" style="">1080                                      // does not, so we clear that out to keep them the same.                      </span>
<span class="-1462576698638737516" onmouseenter="enter('-1462576698638737516');" onmouseout="out('-1462576698638737516');" style="">1081                                      // Also ignore intent flags for the purposes of deduping.                     </span>
<span class="-3363694106044374937" onmouseenter="enter('-3363694106044374937');" onmouseout="out('-3363694106044374937');" style="">1082                                      intent.setPackage(null);                                                      </span>
<span class="-3409071973040894037" onmouseenter="enter('-3409071973040894037');" onmouseout="out('-3409071973040894037');" style="">1083                                      int flags = intent.getFlags();                                                </span>
<span class="547103070058811611" onmouseenter="enter('547103070058811611');" onmouseout="out('547103070058811611');" style="">1084                                      intent.setFlags(0);                                                           </span>
<span class="-947990318544641084" onmouseenter="enter('-947990318544641084');" onmouseout="out('-947990318544641084');" style="">1085                                      final String key = intent.toUri(0);                                           </span>
<span class="-7327331133269780521" onmouseenter="enter('-7327331133269780521');" onmouseout="out('-7327331133269780521');" style="">1086                                      intent.setFlags(flags);                                                       </span>
<span class="7480204102005082432" onmouseenter="enter('7480204102005082432');" onmouseout="out('7480204102005082432');" style="">1087                                      if (seenIntents.contains(key)) {                                              </span>
<span class="2006049222885589498" onmouseenter="enter('2006049222885589498');" onmouseout="out('2006049222885589498');" style="">1088                                          Launcher.addDumpLog(TAG, &quot;skipping duplicate&quot;, true);                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1089                                          continue;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1090                                      } else {                                                                      </span>
<span class="4653019047206831387" onmouseenter="enter('4653019047206831387');" onmouseout="out('4653019047206831387');" style="">1091                                          seenIntents.add(key);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1092                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1093                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1094                              }                                                                                     </span>
<span  style="">1095                                                                                                                    </span>
<span class="-3805379390248188389" onmouseenter="enter('-3805379390248188389');" onmouseout="out('-3805379390248188389');" style="">1096                              ContentValues values = new ContentValues(c.getColumnCount());                         </span>
<span class="2787548740347733717" onmouseenter="enter('2787548740347733717');" onmouseout="out('2787548740347733717');" style="">1097                              values.put(LauncherSettings.Favorites._ID, c.getInt(idIndex));                        </span>
<span class="4552396250235420866" onmouseenter="enter('4552396250235420866');" onmouseout="out('4552396250235420866');" style="">1098                              values.put(LauncherSettings.Favorites.INTENT, intentStr);                             </span>
<span class="3080545696092648727" onmouseenter="enter('3080545696092648727');" onmouseout="out('3080545696092648727');" style="">1099                              values.put(LauncherSettings.Favorites.TITLE, c.getString(titleIndex));                </span>
<span class="8877369206974054200" onmouseenter="enter('8877369206974054200');" onmouseout="out('8877369206974054200');" style="">1100                              values.put(LauncherSettings.Favorites.ICON_TYPE,                                      </span>
<span class="8705323818259019594" onmouseenter="enter('8705323818259019594');" onmouseout="out('8705323818259019594');" style="">1101                                      c.getInt(iconTypeIndex));                                                     </span>
<span class="3857475807367449049" onmouseenter="enter('3857475807367449049');" onmouseout="out('3857475807367449049');" style="">1102                              values.put(LauncherSettings.Favorites.ICON, c.getBlob(iconIndex));                    </span>
<span class="-7054095546130863513" onmouseenter="enter('-7054095546130863513');" onmouseout="out('-7054095546130863513');" style="">1103                              values.put(LauncherSettings.Favorites.ICON_PACKAGE,                                   </span>
<span class="-4377124255190457588" onmouseenter="enter('-4377124255190457588');" onmouseout="out('-4377124255190457588');" style="">1104                                      c.getString(iconPackageIndex));                                               </span>
<span class="7491883888231273974" onmouseenter="enter('7491883888231273974');" onmouseout="out('7491883888231273974');" style="">1105                              values.put(LauncherSettings.Favorites.ICON_RESOURCE,                                  </span>
<span class="-14487948683300389" onmouseenter="enter('-14487948683300389');" onmouseout="out('-14487948683300389');" style="">1106                                      c.getString(iconResourceIndex));                                              </span>
<span class="5180659022499168410" onmouseenter="enter('5180659022499168410');" onmouseout="out('5180659022499168410');" style="">1107                              values.put(LauncherSettings.Favorites.ITEM_TYPE, itemType);                           </span>
<span class="2567875359902744917" onmouseenter="enter('2567875359902744917');" onmouseout="out('2567875359902744917');" style="">1108                              values.put(LauncherSettings.Favorites.APPWIDGET_ID, -1);                              </span>
<span class="-3897523412202294315" onmouseenter="enter('-3897523412202294315');" onmouseout="out('-3897523412202294315');" style="">1109                              values.put(LauncherSettings.Favorites.URI, c.getString(uriIndex));                    </span>
<span class="8253479465859182990" onmouseenter="enter('8253479465859182990');" onmouseout="out('8253479465859182990');" style="">1110                              values.put(LauncherSettings.Favorites.DISPLAY_MODE,                                   </span>
<span class="-8416795076296111227" onmouseenter="enter('-8416795076296111227');" onmouseout="out('-8416795076296111227');" style="">1111                                      c.getInt(displayModeIndex));                                                  </span>
<span class="-1880957120536425376" onmouseenter="enter('-1880957120536425376');" onmouseout="out('-1880957120536425376');" style="">1112                              values.put(LauncherSettings.Favorites.PROFILE_ID, userSerialNumber);                  </span>
<span  style="">1113                                                                                                                    </span>
<span class="-216205184326719357" onmouseenter="enter('-216205184326719357');" onmouseout="out('-216205184326719357');" style="">1114                              if (container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {                      </span>
<span class="2845166931909672251" onmouseenter="enter('2845166931909672251');" onmouseout="out('2845166931909672251');" style="">1115                                  hotseat.put(screen, values);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1116                              }                                                                                     </span>
<span  style="">1117                                                                                                                    </span>
<span class="-8534427976726701331" onmouseenter="enter('-8534427976726701331');" onmouseout="out('-8534427976726701331');" style="">1118                              if (container != LauncherSettings.Favorites.CONTAINER_DESKTOP) {                      </span>
<span class="3724214252155726452" onmouseenter="enter('3724214252155726452');" onmouseout="out('3724214252155726452');" style="">1119                                  // In a folder or in the hotseat, preserve position                               </span>
<span class="4993135311254983149" onmouseenter="enter('4993135311254983149');" onmouseout="out('4993135311254983149');" style="">1120                                  values.put(LauncherSettings.Favorites.SCREEN, screen);                            </span>
<span class="-7735658353589578952" onmouseenter="enter('-7735658353589578952');" onmouseout="out('-7735658353589578952');" style="">1121                                  values.put(LauncherSettings.Favorites.CELLX, cellX);                              </span>
<span class="-6596875348392322090" onmouseenter="enter('-6596875348392322090');" onmouseout="out('-6596875348392322090');" style="">1122                                  values.put(LauncherSettings.Favorites.CELLY, cellY);                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1123                              } else {                                                                              </span>
<span class="-6079732280628496127" onmouseenter="enter('-6079732280628496127');" onmouseout="out('-6079732280628496127');" style="">1124                                  // For items contained directly on one of the workspace screen,                   </span>
<span class="-850513443108501253" onmouseenter="enter('-850513443108501253');" onmouseout="out('-850513443108501253');" style="">1125                                  // we&#x27;ll determine their location (screen, x, y) in a second pass.                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1126                              }                                                                                     </span>
<span  style="">1127                                                                                                                    </span>
<span class="7684212050113439789" onmouseenter="enter('7684212050113439789');" onmouseout="out('7684212050113439789');" style="">1128                              values.put(LauncherSettings.Favorites.CONTAINER, container);                          </span>
<span  style="">1129                                                                                                                    </span>
<span class="-1936160447019772377" onmouseenter="enter('-1936160447019772377');" onmouseout="out('-1936160447019772377');" style="">1130                              if (itemType != Favorites.ITEM_TYPE_FOLDER) {                                         </span>
<span class="-7897547558000712151" onmouseenter="enter('-7897547558000712151');" onmouseout="out('-7897547558000712151');" style="">1131                                  shortcuts.add(values);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1132                              } else {                                                                              </span>
<span class="5214044302935278086" onmouseenter="enter('5214044302935278086');" onmouseout="out('5214044302935278086');" style="">1133                                  folders.add(values);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1134                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1135                          }                                                                                         </span>
<span  style="">1136                                                                                                                    </span>
<span class="3792333482677793462" onmouseenter="enter('3792333482677793462');" onmouseout="out('3792333482677793462');" style="">1137                          // Now that we have all the hotseat icons, let&#x27;s go through them left-right               </span>
<span class="6853065735140319510" onmouseenter="enter('6853065735140319510');" onmouseout="out('6853065735140319510');" style="">1138                          // and assign valid locations for them in the new hotseat                                 </span>
<span class="-382900916992065291" onmouseenter="enter('-382900916992065291');" onmouseout="out('-382900916992065291');" style="">1139                          final int N = hotseat.size();                                                             </span>
<span class="9016073461123662191" onmouseenter="enter('9016073461123662191');" onmouseout="out('9016073461123662191');" style="">1140                          for (int idx=0; idx&lt;N; idx++) {                                                           </span>
<span class="-7027280347801461154" onmouseenter="enter('-7027280347801461154');" onmouseout="out('-7027280347801461154');" style="">1141                              int hotseatX = hotseat.keyAt(idx);                                                    </span>
<span class="7267222979225491944" onmouseenter="enter('7267222979225491944');" onmouseout="out('7267222979225491944');" style="">1142                              ContentValues values = hotseat.valueAt(idx);                                          </span>
<span  style="">1143                                                                                                                    </span>
<span class="-3018245694205955067" onmouseenter="enter('-3018245694205955067');" onmouseout="out('-3018245694205955067');" style="">1144                              if (hotseatX == grid.hotseatAllAppsRank) {                                            </span>
<span class="-8495735509078642350" onmouseenter="enter('-8495735509078642350');" onmouseout="out('-8495735509078642350');" style="">1145                                  // let&#x27;s drop this in the next available hole in the hotseat                      </span>
<span class="-2055954181227443816" onmouseenter="enter('-2055954181227443816');" onmouseout="out('-2055954181227443816');" style="">1146                                  while (++hotseatX &lt; hotseatWidth) {                                               </span>
<span class="-5595819560409222327" onmouseenter="enter('-5595819560409222327');" onmouseout="out('-5595819560409222327');" style="">1147                                      if (hotseat.get(hotseatX) == null) {                                          </span>
<span class="2131484666649578366" onmouseenter="enter('2131484666649578366');" onmouseout="out('2131484666649578366');" style="">1148                                          // found a spot! move it here                                             </span>
<span class="325808457439646533" onmouseenter="enter('325808457439646533');" onmouseout="out('325808457439646533');" style="">1149                                          values.put(LauncherSettings.Favorites.SCREEN,                             </span>
<span class="8014085861051867033" onmouseenter="enter('8014085861051867033');" onmouseout="out('8014085861051867033');" style="">1150                                                  hotseatX);                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">1151                                          break;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1152                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1153                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1154                              }                                                                                     </span>
<span class="4361559665402156368" onmouseenter="enter('4361559665402156368');" onmouseout="out('4361559665402156368');" style="">1155                              if (hotseatX &gt;= hotseatWidth) {                                                       </span>
<span class="198406244599777154" onmouseenter="enter('198406244599777154');" onmouseout="out('198406244599777154');" style="">1156                                  // no room for you in the hotseat? it&#x27;s off to the desktop with you               </span>
<span class="274548545061036766" onmouseenter="enter('274548545061036766');" onmouseout="out('274548545061036766');" style="">1157                                  values.put(LauncherSettings.Favorites.CONTAINER,                                  </span>
<span class="951133373394890183" onmouseenter="enter('951133373394890183');" onmouseout="out('951133373394890183');" style="">1158                                             Favorites.CONTAINER_DESKTOP);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1159                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1160                          }                                                                                         </span>
<span  style="">1161                                                                                                                    </span>
<span class="4538029778921500049" onmouseenter="enter('4538029778921500049');" onmouseout="out('4538029778921500049');" style="">1162                          final ArrayList&lt;ContentValues&gt; allItems = new ArrayList&lt;ContentValues&gt;();                 </span>
<span class="-4972040190483698817" onmouseenter="enter('-4972040190483698817');" onmouseout="out('-4972040190483698817');" style="">1163                          // Folders first                                                                          </span>
<span class="1607706518732535744" onmouseenter="enter('1607706518732535744');" onmouseout="out('1607706518732535744');" style="">1164                          allItems.addAll(folders);                                                                 </span>
<span class="2106236708914116763" onmouseenter="enter('2106236708914116763');" onmouseout="out('2106236708914116763');" style="">1165                          // Then shortcuts                                                                         </span>
<span class="-1250372864837547145" onmouseenter="enter('-1250372864837547145');" onmouseout="out('-1250372864837547145');" style="">1166                          allItems.addAll(shortcuts);                                                               </span>
<span  style="">1167                                                                                                                    </span>
<span class="-2195882050879177813" onmouseenter="enter('-2195882050879177813');" onmouseout="out('-2195882050879177813');" style="">1168                          // Layout all the folders                                                                 </span>
<span class="-252665973237041297" onmouseenter="enter('-252665973237041297');" onmouseout="out('-252665973237041297');" style="">1169                          for (ContentValues values: allItems) {                                                    </span>
<span class="-6238460523304059987" onmouseenter="enter('-6238460523304059987');" onmouseout="out('-6238460523304059987');" style="">1170                              if (values.getAsInteger(LauncherSettings.Favorites.CONTAINER) !=                      </span>
<span class="-5300505921133380020" onmouseenter="enter('-5300505921133380020');" onmouseout="out('-5300505921133380020');" style="">1171                                      LauncherSettings.Favorites.CONTAINER_DESKTOP) {                               </span>
<span class="4544740026899945117" onmouseenter="enter('4544740026899945117');" onmouseout="out('4544740026899945117');" style="">1172                                  // Hotseat items and folder items have already had their                          </span>
<span class="9061827072000509027" onmouseenter="enter('9061827072000509027');" onmouseout="out('9061827072000509027');" style="">1173                                  // location information set. Nothing to be done here.                             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style="">1174                                  continue;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1175                              }                                                                                     </span>
<span class="851641135220662264" onmouseenter="enter('851641135220662264');" onmouseout="out('851641135220662264');" style="">1176                              values.put(LauncherSettings.Favorites.SCREEN, curScreen);                             </span>
<span class="-1049962748703223150" onmouseenter="enter('-1049962748703223150');" onmouseout="out('-1049962748703223150');" style="">1177                              values.put(LauncherSettings.Favorites.CELLX, curX);                                   </span>
<span class="-5258025824110848668" onmouseenter="enter('-5258025824110848668');" onmouseout="out('-5258025824110848668');" style="">1178                              values.put(LauncherSettings.Favorites.CELLY, curY);                                   </span>
<span class="1910082031532915038" onmouseenter="enter('1910082031532915038');" onmouseout="out('1910082031532915038');" style="">1179                              curX = (curX + 1) % width;                                                            </span>
<span class="-7155276018455302787" onmouseenter="enter('-7155276018455302787');" onmouseout="out('-7155276018455302787');" style="">1180                              if (curX == 0) {                                                                      </span>
<span class="2376495568180329749" onmouseenter="enter('2376495568180329749');" onmouseout="out('2376495568180329749');" style="">1181                                  curY = (curY + 1);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1182                              }                                                                                     </span>
<span class="-4531638622721531414" onmouseenter="enter('-4531638622721531414');" onmouseout="out('-4531638622721531414');" style="">1183                              // Leave the last row of icons blank on every screen                                  </span>
<span class="-5543182397018270277" onmouseenter="enter('-5543182397018270277');" onmouseout="out('-5543182397018270277');" style="">1184                              if (curY == height - 1) {                                                             </span>
<span class="-6657705079427553715" onmouseenter="enter('-6657705079427553715');" onmouseout="out('-6657705079427553715');" style="">1185                                  curScreen = (int) generateNewScreenId();                                          </span>
<span class="4679043716901678926" onmouseenter="enter('4679043716901678926');" onmouseout="out('4679043716901678926');" style="">1186                                  curY = 0;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1187                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1188                          }                                                                                         </span>
<span  style="">1189                                                                                                                    </span>
<span class="1853917526349173349" onmouseenter="enter('1853917526349173349');" onmouseout="out('1853917526349173349');" style="">1190                          if (allItems.size() &gt; 0) {                                                                </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1191                              db.beginTransaction();                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1192                              try {                                                                                 </span>
<span class="-7256059133012813079" onmouseenter="enter('-7256059133012813079');" onmouseout="out('-7256059133012813079');" style="">1193                                  for (ContentValues row: allItems) {                                               </span>
<span class="3155601228699925770" onmouseenter="enter('3155601228699925770');" onmouseout="out('3155601228699925770');" style="">1194                                      if (row == null) continue;                                                    </span>
<span class="-304018147606180100" onmouseenter="enter('-304018147606180100');" onmouseout="out('-304018147606180100');" style="">1195                                      if (dbInsertAndCheck(this, db, TABLE_FAVORITES, null, row)                    </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1196                                              &lt; 0) {                                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1197                                          return;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1198                                      } else {                                                                      </span>
<span class="5122134618962228848" onmouseenter="enter('5122134618962228848');" onmouseout="out('5122134618962228848');" style="">1199                                          count++;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1200                                      }                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1201                                  }                                                                                 </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1202                                  db.setTransactionSuccessful();                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1203                              } finally {                                                                           </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1204                                  db.endTransaction();                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1205                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1206                          }                                                                                         </span>
<span  style="">1207                                                                                                                    </span>
<span class="3708563498510346203" onmouseenter="enter('3708563498510346203');" onmouseout="out('3708563498510346203');" style="">1208                          db.beginTransaction();                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">1209                          try {                                                                                     </span>
<span class="-7150489321946493056" onmouseenter="enter('-7150489321946493056');" onmouseout="out('-7150489321946493056');" style="">1210                              for (i=0; i&lt;=curScreen; i++) {                                                        </span>
<span class="7694375558102178162" onmouseenter="enter('7694375558102178162');" onmouseout="out('7694375558102178162');" style="">1211                                  final ContentValues values = new ContentValues();                                 </span>
<span class="-5225632710651404139" onmouseenter="enter('-5225632710651404139');" onmouseout="out('-5225632710651404139');" style="">1212                                  values.put(LauncherSettings.WorkspaceScreens._ID, i);                             </span>
<span class="8100732723950791653" onmouseenter="enter('8100732723950791653');" onmouseout="out('8100732723950791653');" style="">1213                                  values.put(LauncherSettings.WorkspaceScreens.SCREEN_RANK, i);                     </span>
<span class="-6007460446232002971" onmouseenter="enter('-6007460446232002971');" onmouseout="out('-6007460446232002971');" style="">1214                                  if (dbInsertAndCheck(this, db, TABLE_WORKSPACE_SCREENS, null, values)             </span>
<span class="-5045770407551308114" onmouseenter="enter('-5045770407551308114');" onmouseout="out('-5045770407551308114');" style="">1215                                          &lt; 0) {                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1216                                      return;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1217                                  }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1218                              }                                                                                     </span>
<span class="-999133354836642717" onmouseenter="enter('-999133354836642717');" onmouseout="out('-999133354836642717');" style="">1219                              db.setTransactionSuccessful();                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1220                          } finally {                                                                               </span>
<span class="4555482193573075626" onmouseenter="enter('4555482193573075626');" onmouseout="out('4555482193573075626');" style="">1221                              db.endTransaction();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1222                          }                                                                                         </span>
<span  style="">1223                                                                                                                    </span>
<span class="3757730671360045414" onmouseenter="enter('3757730671360045414');" onmouseout="out('3757730671360045414');" style="">1224                          updateFolderItemsRank(db, false);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1225                      }                                                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">1226                  } finally {                                                                                       </span>
<span class="-835460676370007859" onmouseenter="enter('-835460676370007859');" onmouseout="out('-835460676370007859');" style="">1227                      c.close();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1228                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1229              }                                                                                                     </span>
<span  style="">1230                                                                                                                    </span>
<span class="-6182516414964240870" onmouseenter="enter('-6182516414964240870');" onmouseout="out('-6182516414964240870');" style="">1231              Launcher.addDumpLog(TAG, &quot;migrated &quot; + count + &quot; icons from Launcher2 into &quot;                          </span>
<span class="3301967416992773508" onmouseenter="enter('3301967416992773508');" onmouseout="out('3301967416992773508');" style="">1232                      + (curScreen+1) + &quot; screens&quot;, true);                                                          </span>
<span  style="">1233                                                                                                                    </span>
<span class="3355055744209094121" onmouseenter="enter('3355055744209094121');" onmouseout="out('3355055744209094121');" style="">1234              // ensure that new screens are created to hold these icons                                            </span>
<span class="4167333916835222093" onmouseenter="enter('4167333916835222093');" onmouseout="out('4167333916835222093');" style="">1235              setFlagJustLoadedOldDb();                                                                             </span>
<span  style="">1236                                                                                                                    </span>
<span class="2071167438564206442" onmouseenter="enter('2071167438564206442');" onmouseout="out('2071167438564206442');" style="">1237              // Update max IDs; very important since we just grabbed IDs from another database                     </span>
<span class="6380885951893815732" onmouseenter="enter('6380885951893815732');" onmouseout="out('6380885951893815732');" style="">1238              mMaxItemId = initializeMaxItemId(db);                                                                 </span>
<span class="4730788985981235797" onmouseenter="enter('4730788985981235797');" onmouseout="out('4730788985981235797');" style="">1239              mMaxScreenId = initializeMaxScreenId(db);                                                             </span>
<span class="-439077128883569126" onmouseenter="enter('-439077128883569126');" onmouseout="out('-439077128883569126');" style="">1240              if (LOGD) Log.d(TAG, &quot;mMaxItemId: &quot; + mMaxItemId + &quot; mMaxScreenId: &quot; + mMaxScreenId);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1241          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1242      }                                                                                                             </span>
<span  style="">1243                                                                                                                    </span>
<span class="8465274381710394045" onmouseenter="enter('8465274381710394045');" onmouseout="out('8465274381710394045');" style="">1244      static class SqlArguments {                                                                                   </span>
<span class="8122936482838815352" onmouseenter="enter('8122936482838815352');" onmouseout="out('8122936482838815352');" style="">1245          public final String table;                                                                                </span>
<span class="5442590397567481633" onmouseenter="enter('5442590397567481633');" onmouseout="out('5442590397567481633');" style="">1246          public final String where;                                                                                </span>
<span class="-2258632185412795279" onmouseenter="enter('-2258632185412795279');" onmouseout="out('-2258632185412795279');" style="">1247          public final String[] args;                                                                               </span>
<span  style="">1248                                                                                                                    </span>
<span class="538735252304320137" onmouseenter="enter('538735252304320137');" onmouseout="out('538735252304320137');" style="">1249          SqlArguments(Uri url, String where, String[] args) {                                                      </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1250              if (url.getPathSegments().size() == 1) {                                                              </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1251                  this.table = url.getPathSegments().get(0);                                                        </span>
<span class="7181058370626512064" onmouseenter="enter('7181058370626512064');" onmouseout="out('7181058370626512064');" style="">1252                  this.where = where;                                                                               </span>
<span class="8688716567728705492" onmouseenter="enter('8688716567728705492');" onmouseout="out('8688716567728705492');" style="">1253                  this.args = args;                                                                                 </span>
<span class="2325935358302734243" onmouseenter="enter('2325935358302734243');" onmouseout="out('2325935358302734243');" style="">1254              } else if (url.getPathSegments().size() != 2) {                                                       </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1255                  throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                                        </span>
<span class="186586201607437821" onmouseenter="enter('186586201607437821');" onmouseout="out('186586201607437821');" style="">1256              } else if (!TextUtils.isEmpty(where)) {                                                               </span>
<span class="2785963644153593875" onmouseenter="enter('2785963644153593875');" onmouseout="out('2785963644153593875');" style="">1257                  throw new UnsupportedOperationException(&quot;WHERE clause not supported: &quot; + url);                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1258              } else {                                                                                              </span>
<span class="-6984157551381672872" onmouseenter="enter('-6984157551381672872');" onmouseout="out('-6984157551381672872');" style="">1259                  this.table = url.getPathSegments().get(0);                                                        </span>
<span class="-834356181554398700" onmouseenter="enter('-834356181554398700');" onmouseout="out('-834356181554398700');" style="">1260                  this.where = &quot;_id=&quot; + ContentUris.parseId(url);                                                   </span>
<span class="-7173439380439508667" onmouseenter="enter('-7173439380439508667');" onmouseout="out('-7173439380439508667');" style="">1261                  this.args = null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1262              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1263          }                                                                                                         </span>
<span  style="">1264                                                                                                                    </span>
<span class="5705249208777482684" onmouseenter="enter('5705249208777482684');" onmouseout="out('5705249208777482684');" style="">1265          SqlArguments(Uri url) {                                                                                   </span>
<span class="-7603700663019659468" onmouseenter="enter('-7603700663019659468');" onmouseout="out('-7603700663019659468');" style="">1266              if (url.getPathSegments().size() == 1) {                                                              </span>
<span class="-594585027826531892" onmouseenter="enter('-594585027826531892');" onmouseout="out('-594585027826531892');" style="">1267                  table = url.getPathSegments().get(0);                                                             </span>
<span class="3938761229458861077" onmouseenter="enter('3938761229458861077');" onmouseout="out('3938761229458861077');" style="">1268                  where = null;                                                                                     </span>
<span class="8940401955607507518" onmouseenter="enter('8940401955607507518');" onmouseout="out('8940401955607507518');" style="">1269                  args = null;                                                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">1270              } else {                                                                                              </span>
<span class="-3760623583555134522" onmouseenter="enter('-3760623583555134522');" onmouseout="out('-3760623583555134522');" style="">1271                  throw new IllegalArgumentException(&quot;Invalid URI: &quot; + url);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1272              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1273          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1274      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1275  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            