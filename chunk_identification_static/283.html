<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>283</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    283
                    <a href="282.html">prev</a>
                    <a href="284.html">next</a>
                    <a href="283_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_2dba13ed70429d82aeb4928f597d6e8fc622bed6_admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;2dba13ed70429d82aeb4928f597d6e8fc622bed6:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;2dba13ed70429d82aeb4928f597d6e8fc622bed6^1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;2dba13ed70429d82aeb4928f597d6e8fc622bed6^2:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;60e51975ae7406b8fe23dc528c233868e977b595:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bs]], subset: [[bs]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  20 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  21 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  25 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  26 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  27 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  28 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  29 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  30 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  31 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  32 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  33 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  34 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  35 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  36 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  37 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  38 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  39 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  40 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  41 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  42 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  43 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="">  44 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  45 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  46 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  47 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  48 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  49 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  50 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  51 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  52                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  53 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  54 import java.util.Date;                                                                                   </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  55 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  56 import java.util.List;                                                                                   </span>
<span  style="">  57                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  58 import javax.annotation.Resource;                                                                        </span>
<span  style="">  59                                                                                                          </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  60 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  61 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  62 import net.sf.ehcache.Element;                                                                           </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  66  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  69 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  70 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  71                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  72     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  73                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  74     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  75     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  76                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  77     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  78     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  79                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  80     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  81     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  82                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  83     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  84     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  85                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  86     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  87     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  88                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  89     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  90     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="">  91     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="">  92                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title="  94      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the">  94      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title="  95      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}">  95      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  96      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="">  97     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="">  98     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style="">  99                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 100     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 101     protected EmailService emailService;                                                                 </span>
<span  style=""> 102                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 103     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 104     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 105                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 106     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 107     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 108                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 109 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 110 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 116      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 116      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 117      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 117      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120     protected Object passwordEncoderBean;                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122     /**                                                                                                  </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123      * Optional password salt to be used with the passwordEncoder                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124      *                                                                                                   </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125      * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127     @Deprecated                                                                                          </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128     protected String salt;                                                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130     /**                                                                                                  </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131      * Use a Salt Source ONLY if there&#x27;s one configured                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132      *                                                                                                   </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 133      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2"> 133      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135     @Deprecated                                                                                          </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136     @Autowired(required=false)                                                                           </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137     @Qualifier(&quot;blAdminSaltSource&quot;)                                                                      </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138     protected SaltSource saltSource;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141     protected EmailService emailService;                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149     /**                                                                                                  </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 150      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 150      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@linkðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 151      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 151      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.spriðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152      *                                                                                                   </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153      * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154      *                                                                                                   </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 155      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 155      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which isðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156      *                                                                                                   </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 157      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 157      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance oðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158      */                                                                                                  </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159     @PostConstruct                                                                                       </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     protected void setupPasswordEncoder() {                                                              </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161         passwordEncoderNew = null;                                                                       </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162         passwordEncoder = null;                                                                          </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         if (passwordEncoderBean instanceof PasswordEncoder) {                                            </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164             passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                  </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 165         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 165         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PaðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 166             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 166             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         } else {                                                                                         </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168             throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 178 =======                                                                                                  </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179     @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                           </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182     /**                                                                                                  </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 183      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 183      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@linkðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 184      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 184      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.spriðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185      *                                                                                                   </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186      * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187      *                                                                                                   </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 188      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 188      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which isðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189      *                                                                                                   </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 190      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 190      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance oðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191      */                                                                                                  </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 192     @PostConstruct                                                                                       </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193     protected void setupPasswordEncoder() {                                                              </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194         passwordEncoderNew = null;                                                                       </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195         passwordEncoder = null;                                                                          </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196         if (passwordEncoderBean instanceof PasswordEncoder) {                                            </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197             passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                  </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 198         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 198         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PaðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 199             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 199             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200         } else {                                                                                         </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201             throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204                                                                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 205 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 206     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 207         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208     }                                                                                                    </span>
<span  style=""> 209                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 210     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 211         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212     }                                                                                                    </span>
<span  style=""> 213                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 214     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 215     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 216     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 217         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 218         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219     }                                                                                                    </span>
<span  style=""> 220                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 221     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 222     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 223     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 224         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 225         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226     }                                                                                                    </span>
<span  style=""> 227                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 228     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 229     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 230     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 231         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 232         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 235     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 236     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 237         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238     }                                                                                                    </span>
<span  style=""> 239                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 240     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 241     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 242         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243     }                                                                                                    </span>
<span  style=""> 244                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 245     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 246     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 247         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248     }                                                                                                    </span>
<span  style=""> 249                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 250     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 251     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 252     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 253         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 254         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 255         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256     }                                                                                                    </span>
<span  style=""> 257                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 258     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 259     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 260     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 261         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 262         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 263         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264     }                                                                                                    </span>
<span  style=""> 265                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 266     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 267     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 268     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 269         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 270         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 271                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 272         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 273             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 274             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275         }                                                                                                </span>
<span  style=""> 276                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 277         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 278         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 279             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280         }                                                                                                </span>
<span  style=""> 281                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 282         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 283                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 284         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 285             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286         }                                                                                                </span>
<span  style=""> 287                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 288         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 289         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 290         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 293     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 294     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 295         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 296             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 298         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299     }                                                                                                    </span>
<span  style=""> 300                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 301     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 302         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303     }                                                                                                    </span>
<span  style=""> 304                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 305     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 306     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 307     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 308         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 309         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 310         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 311         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 312         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 312         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 313         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 314         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 315         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 318     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 319     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 319     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 320         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 321         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 322         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 323                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 324         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 325             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 326                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 327             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 328                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span  style=""> 331                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 332         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 333             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 334                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 335                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 335                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 336                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 337                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339             }                                                                                            </span>
<span  style=""> 340                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 341             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 342                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 342                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permiðŸ”µ</abbr></span>
<span  style=""> 343                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 344                 if (!response) {                                                                         </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 345                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 345                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPerðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347             }                                                                                            </span>
<span  style=""> 348                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 349             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 350             cache.put(cacheElement);                                                                     </span>
<span  style=""> 351                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 352             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 353                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355         }                                                                                                </span>
<span  style=""> 356                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 357         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 360     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 360     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 361         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 362                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 363                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 364                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365     }                                                                                                    </span>
<span  style=""> 366                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 367     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 368     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 368     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 369         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 369         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370     }                                                                                                    </span>
<span  style=""> 371                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 372     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 373     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 374         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375     }                                                                                                    </span>
<span  style=""> 376                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 377     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 378     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 379         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380     }                                                                                                    </span>
<span  style=""> 381                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 382     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 383     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 384         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385     }                                                                                                    </span>
<span  style=""> 386                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 388     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 389         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390     }                                                                                                    </span>
<span  style=""> 391                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 392     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 393     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 394         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395     }                                                                                                    </span>
<span  style=""> 396                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 397     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 398     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 399     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 400         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 401         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 402         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 403             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 405         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 406             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 407         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 408             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 409             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 410                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 411                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413             }                                                                                            </span>
<span  style=""> 414                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 415             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 416                 HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                            </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 417                 vars.put(&quot;accountNames&quot;, activeUsernames);                                               </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 418                 emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 419             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 420                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 421                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 424         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425     }                                                                                                    </span>
<span  style=""> 426                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 427     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 428     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 429     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 430         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 431         AdminUser user = null;                                                                           </span>
<span  style=""> 432                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 433         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 434             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span  style=""> 436                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 437         checkUser(user,response);                                                                        </span>
<span  style=""> 438                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 439         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 440             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 441             token = token.toLowerCase();                                                                 </span>
<span  style=""> 442                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 443             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 444             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 445             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 446             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 447             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 448                                                                                                          </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 449             HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 450             vars.put(&quot;token&quot;, token);                                                                    </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 451             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 452             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 453                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 454                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 455                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 456                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458             }                                                                                            </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 459             vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                              </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 460             emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);          </span>
<span  style=""> 461                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 463         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464     }                                                                                                    </span>
<span  style=""> 465                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 466     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 467     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 468     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 468     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 469         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 470         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 471         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 472             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 474         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 475         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 476         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 477             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478         }                                                                                                </span>
<span  style=""> 479                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 480         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 481         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 482             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 483             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 483             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 484             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 485                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 486                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 487                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 490             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 491                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 492             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 493                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 494             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 495                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497         }                                                                                                </span>
<span  style=""> 498                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 499         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 500             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 501                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 502                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 502                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 504                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506         }                                                                                                </span>
<span  style=""> 507                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 508         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 509             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 510             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 511             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512         }                                                                                                </span>
<span  style=""> 513                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 514         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515     }                                                                                                    </span>
<span  style=""> 516                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 517     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 518         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 518         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 519         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 520             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 521             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523     }                                                                                                    </span>
<span  style=""> 524                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 525     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 526         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 527             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 528         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 529             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 530         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 531             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533     }                                                                                                    </span>
<span  style=""> 534                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 535     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 536         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 537             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 538         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 539             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541     }                                                                                                    </span>
<span  style=""> 542                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 543     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 543     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 544         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 545             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547     }                                                                                                    </span>
<span  style=""> 548                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 549     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 550         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 551         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 552         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 553         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 554         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555     }                                                                                                    </span>
<span  style=""> 556                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 557     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 558         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559     }                                                                                                    </span>
<span  style=""> 560                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 561     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 562         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563     }                                                                                                    </span>
<span  style=""> 564                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 565     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 566         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 569     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 570         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 571     }                                                                                                    </span>
<span  style=""> 572                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 573     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 574         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 575     }                                                                                                    </span>
<span  style=""> 576                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 577     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 578         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579     }                                                                                                    </span>
<span  style=""> 580                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 581     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 582     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 583     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 584             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 585         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 586         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 587         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 588             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 590         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 591         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 592                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 593         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 594             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595         }                                                                                                </span>
<span  style=""> 596                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 597         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 598             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 599             saveAdminUser(user);                                                                         </span>
<span  style=""> 600                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601         }                                                                                                </span>
<span  style=""> 602                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 603         return response;                                                                                 </span>
<span  style=""> 604                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 605     }                                                                                                    </span>
<span  style=""> 606                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 607     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 608      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 608      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 609      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 610      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 610      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 611      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 611      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 612      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 613      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 614      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 615      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 616      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 617     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 618         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619     }                                                                                                    </span>
<span  style=""> 620                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 621     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 622      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 623      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 624      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 624      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 625      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 625      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 626      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 626      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 627      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 628      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 629      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 630      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 631      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 632     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 633         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 634     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  20 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  21 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  22 import net.sf.ehcache.Element;                                                                           </span>
<span  style="">  23                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  31 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  32 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  33 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  34 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  35 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  36 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  37 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  38 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  39 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  40 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  41 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  42 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  43 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  44 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  45 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  46 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  47 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="">  48 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  50 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  51 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  52 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  53 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  54 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  55 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  56                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  57 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  58 import java.util.Date;                                                                                   </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  59 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  60 import java.util.List;                                                                                   </span>
<span  style="">  61                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  62 import javax.annotation.Resource;                                                                        </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  66  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  69 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  70 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  71                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  72     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  73                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  74     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  75     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  76                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  77     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  78     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  79                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  80     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  81     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  82                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  83     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  84     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  85                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  86     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  87     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  88                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  89     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  90     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="">  91     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="">  92                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title="  94      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the">  94      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title="  95      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}">  95      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  96      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="">  97     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="">  98     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style="">  99                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 100     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 101     protected EmailService emailService;                                                                 </span>
<span  style=""> 102                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 103     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 104     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 105                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 106     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 107     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 108                                                                                                          </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style=""> 109     @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                           </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style=""> 110     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style=""> 111                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 112     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 113         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114     }                                                                                                    </span>
<span  style=""> 115                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 116     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 117         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 120     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 121     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 122     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 123         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 124         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 128     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 129     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 130         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 131         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 135     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 136     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 137         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 138         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 142     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 143         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144     }                                                                                                    </span>
<span  style=""> 145                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 146     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 147     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 148         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149     }                                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 151     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 152     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 153         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154     }                                                                                                    </span>
<span  style=""> 155                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 156     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 157     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 158     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 159         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 160         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 161         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 165     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 166     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 167         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 168         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 169         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 172     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 173     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 174     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 175         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 176         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 177                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 178         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 179             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 180             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181         }                                                                                                </span>
<span  style=""> 182                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 183         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 184         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 185             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span  style=""> 187                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 188         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 189                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 190         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 191             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span  style=""> 193                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 194         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 195         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 196         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197     }                                                                                                    </span>
<span  style=""> 198                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 199     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 200     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 201         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 202             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 204         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205     }                                                                                                    </span>
<span  style=""> 206                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 207     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 208         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 211     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 212     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 213     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 214         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 215         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 216         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 217         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 218         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 218         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 219         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 220         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 221         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222     }                                                                                                    </span>
<span  style=""> 223                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 225     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 225     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 226         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 227         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 228         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 229                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 230         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 231             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 232                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 233             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 234                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236         }                                                                                                </span>
<span  style=""> 237                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 238         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 239             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 240                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 241                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 241                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 242                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 243                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245             }                                                                                            </span>
<span  style=""> 246                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 247             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 248             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 248             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissioðŸ”µ</abbr></span>
<span  style=""> 249                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 250             if (!response) {                                                                             </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 251                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 251                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253             }                                                                                            </span>
<span  style=""> 254                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 255             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 256             cache.put(cacheElement);                                                                     </span>
<span  style=""> 257                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 258             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 259                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261         }                                                                                                </span>
<span  style=""> 262                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 263         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264     }                                                                                                    </span>
<span  style=""> 265                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 266     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 266     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 267         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 268                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 269                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 270                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 273     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 274     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 274     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 275         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 275         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276     }                                                                                                    </span>
<span  style=""> 277                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 278     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 279     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 280         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281     }                                                                                                    </span>
<span  style=""> 282                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 283     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 284     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 285         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286     }                                                                                                    </span>
<span  style=""> 287                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 288     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 289     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 290         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 293     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 294     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 295         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296     }                                                                                                    </span>
<span  style=""> 297                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 298     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 299     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 300         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 303     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 304     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 305     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 306         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 307         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 308         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 309             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 311         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 312             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 313         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 314             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 315             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 316                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 317                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319             }                                                                                            </span>
<span  style=""> 320                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 321             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 322                 HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                            </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 323                 vars.put(&quot;accountNames&quot;, activeUsernames);                                               </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 324                 emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 325             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 326                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 327                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 330         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331     }                                                                                                    </span>
<span  style=""> 332                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 333     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 334     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 335     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 336         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 337         AdminUser user = null;                                                                           </span>
<span  style=""> 338                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 339         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 340             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341         }                                                                                                </span>
<span  style=""> 342                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 343         checkUser(user,response);                                                                        </span>
<span  style=""> 344                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 345         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 346             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 347             token = token.toLowerCase();                                                                 </span>
<span  style=""> 348                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 349             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 350             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 351             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 352             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 353             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 354                                                                                                          </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 355             HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 356             vars.put(&quot;token&quot;, token);                                                                    </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 357             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 358             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 359                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 360                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 361                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 362                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364             }                                                                                            </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 365             vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                              </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 366             emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);          </span>
<span  style=""> 367                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 369         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370     }                                                                                                    </span>
<span  style=""> 371                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 372     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 373     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 374     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 374     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 375         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 376         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 377         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 378             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 380         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 381         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 382         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 383             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span  style=""> 385                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 386         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 387         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 388             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 389             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 389             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 390             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 391                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 392                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 393                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 396             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 397                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 398             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 399                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 400             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 401                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403         }                                                                                                </span>
<span  style=""> 404                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 405         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 406             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 407                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 408                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 408                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 410                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412         }                                                                                                </span>
<span  style=""> 413                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 414         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 415             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 416             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 417             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418         }                                                                                                </span>
<span  style=""> 419                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 420         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 423     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 424         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 424         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 425         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 426             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 427             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429     }                                                                                                    </span>
<span  style=""> 430                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 431     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 432         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 433             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 434         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 435             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 436         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 437             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439     }                                                                                                    </span>
<span  style=""> 440                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 441     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 442         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 443             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 444         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 445             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447     }                                                                                                    </span>
<span  style=""> 448                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 449     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 449     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 450         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 451             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453     }                                                                                                    </span>
<span  style=""> 454                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 455     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 456         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 457         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 458         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 459         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 460         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461     }                                                                                                    </span>
<span  style=""> 462                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 463     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 464         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465     }                                                                                                    </span>
<span  style=""> 466                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 467     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 468         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469     }                                                                                                    </span>
<span  style=""> 470                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 471     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 472         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473     }                                                                                                    </span>
<span  style=""> 474                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 475     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 476         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477     }                                                                                                    </span>
<span  style=""> 478                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 479     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 480         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481     }                                                                                                    </span>
<span  style=""> 482                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 483     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 484         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485     }                                                                                                    </span>
<span  style=""> 486                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 487     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 488     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 489     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 490             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 491         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 492         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 493         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 494             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 496         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 497         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 498                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 499         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 500             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501         }                                                                                                </span>
<span  style=""> 502                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 503         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 504             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 505             saveAdminUser(user);                                                                         </span>
<span  style=""> 506                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507         }                                                                                                </span>
<span  style=""> 508                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 509         return response;                                                                                 </span>
<span  style=""> 510                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511     }                                                                                                    </span>
<span  style=""> 512                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 513     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 514      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 514      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 515      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 516      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 516      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 517      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 517      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 518      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 519      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 520      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 521      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 522      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 523     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 524         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525     }                                                                                                    </span>
<span  style=""> 526                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 527     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 528      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 529      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 530      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 530      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 531      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 531      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 532      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 532      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 533      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 534      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 535      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 536      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 537      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 538     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 539         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541 }                                                                                                        </span>




























































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  20 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  21 import java.util.Date;                                                                                   </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  22 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  24 import javax.annotation.Resource;                                                                        </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  25 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  26 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  27 import net.sf.ehcache.Element;                                                                           </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  28 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  29 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  30 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  31 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  32 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  33 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  34 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  35 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  36 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  37 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  38 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  39 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  40 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  41 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  42 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  43 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  44 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  45 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  46 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  47 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  48 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  49 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  50 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  51 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="">  52 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  53 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  54 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  55 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  56 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  57 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  58 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  59 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  60                                                                                                          </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  63  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  64  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  67 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  68 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  69                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  70     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  72     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  73     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  74                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  75     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  76     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  77                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  78     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  79     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  80                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  81     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  82     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  83                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  84     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  85     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  86                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  87     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  88     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="">  89     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="">  90                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  91     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title="  92      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the">  92      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title="  93      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}">  93      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="">  95     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="">  96     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style="">  97                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="">  98     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="">  99     protected EmailService emailService;                                                                 </span>
<span  style=""> 100                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 101     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 102     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 103                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 104     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 105     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 106                                                                                                          </span>
<span  style=""> 107                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 108 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 110 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 111 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 111 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 112 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113                                                                                                          </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114     @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                           </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117     /**                                                                                                  </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 118      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 118      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@linkðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 119      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 119      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.spriðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120      *                                                                                                   </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121      * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122      *                                                                                                   </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 123      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 123      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which isðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124      *                                                                                                   </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 125      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 125      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance oðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126      */                                                                                                  </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127     @PostConstruct                                                                                       </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128     protected void setupPasswordEncoder() {                                                              </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129         passwordEncoderNew = null;                                                                       </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130         passwordEncoder = null;                                                                          </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131         if (passwordEncoderBean instanceof PasswordEncoder) {                                            </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132             passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                  </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 133         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 133         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PaðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 134             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 134             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135         } else {                                                                                         </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136             throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140                                                                                                          </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 141 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 142     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 143         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144     }                                                                                                    </span>
<span  style=""> 145                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 146     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 147         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148     }                                                                                                    </span>
<span  style=""> 149                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 150     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 151     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 152     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 153         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 154         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155     }                                                                                                    </span>
<span  style=""> 156                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 157     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 158     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 159     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 160         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 161         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 165     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 166     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 167         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 168         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169     }                                                                                                    </span>
<span  style=""> 170                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 172     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 173         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174     }                                                                                                    </span>
<span  style=""> 175                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 176     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 177     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 178         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 182     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 183         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 186     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 187     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 188     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 189         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 190         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 191         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192     }                                                                                                    </span>
<span  style=""> 193                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 195     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 196     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 197         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 198         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 199         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 202     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 203     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 204     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 205         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 206         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 207                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 208         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 209             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 210             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span  style=""> 212                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 213         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 214         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 215             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216         }                                                                                                </span>
<span  style=""> 217                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 218         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 219                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 220         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 221             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222         }                                                                                                </span>
<span  style=""> 223                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 224         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 225         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 226         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 229     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 230     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 231         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 232             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 234         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235     }                                                                                                    </span>
<span  style=""> 236                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 237     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 238         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239     }                                                                                                    </span>
<span  style=""> 240                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 241     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 242     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 243     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 244         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 245         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 246         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 247         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 248         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 248         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 249         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 250         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 251         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252     }                                                                                                    </span>
<span  style=""> 253                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 254     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 255     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 255     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 256         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 257         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 258         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 259                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 260         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 261             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 262                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 263             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 264                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266         }                                                                                                </span>
<span  style=""> 267                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 268         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 269             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 270                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 271                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 271                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 272                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 273                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275             }                                                                                            </span>
<span  style=""> 276                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 277             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 278                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 278                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permiðŸ”µ</abbr></span>
<span  style=""> 279                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 280                 if (!response) {                                                                         </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 281                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 281                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPerðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283             }                                                                                            </span>
<span  style=""> 284                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 285             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 286             cache.put(cacheElement);                                                                     </span>
<span  style=""> 287                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 288             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 289                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291         }                                                                                                </span>
<span  style=""> 292                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 293         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 296     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 296     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 297         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 298                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 299                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 300                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 303     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 304     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 304     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 305         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 305         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 308     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 309     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 310         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 313     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 314     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 315         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 318     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 319     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 320         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321     }                                                                                                    </span>
<span  style=""> 322                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 323     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 324     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 325         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326     }                                                                                                    </span>
<span  style=""> 327                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 328     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 329     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 330         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331     }                                                                                                    </span>
<span  style=""> 332                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 333     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 334     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 335     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 336         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 337         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 338         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 339             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 341         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 342             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 343         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 344             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 345             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 346                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 347                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349             }                                                                                            </span>
<span  style=""> 350                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 351             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 352                 HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                            </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 353                 vars.put(&quot;accountNames&quot;, activeUsernames);                                               </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 354                 emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 355             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 356                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 357                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 360         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361     }                                                                                                    </span>
<span  style=""> 362                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 363     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 364     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 365     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 366         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 367         AdminUser user = null;                                                                           </span>
<span  style=""> 368                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 369         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 370             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371         }                                                                                                </span>
<span  style=""> 372                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 373         checkUser(user,response);                                                                        </span>
<span  style=""> 374                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 375         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 376             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 377             token = token.toLowerCase();                                                                 </span>
<span  style=""> 378                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 379             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 380             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 381             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 382             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 383             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 384                                                                                                          </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 385             HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 386             vars.put(&quot;token&quot;, token);                                                                    </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 387             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 388             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 389                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 390                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 391                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 392                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394             }                                                                                            </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 395             vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                              </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 396             emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);          </span>
<span  style=""> 397                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 399         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400     }                                                                                                    </span>
<span  style=""> 401                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 402     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 403     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 404     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 404     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 405         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 406         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 407         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 408             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 410         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 411         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 412         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 413             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414         }                                                                                                </span>
<span  style=""> 415                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 416         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 417         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 418             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 419             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 419             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 420             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 421                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 422                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 423                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 426             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 427                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 428             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 429                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 430             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 431                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433         }                                                                                                </span>
<span  style=""> 434                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 435         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 436             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 437                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 438                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 438                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 440                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442         }                                                                                                </span>
<span  style=""> 443                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 444         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 445             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 446             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 447             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448         }                                                                                                </span>
<span  style=""> 449                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 450         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 451     }                                                                                                    </span>
<span  style=""> 452                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 453     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 454         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 454         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 455         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 456             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 457             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459     }                                                                                                    </span>
<span  style=""> 460                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 461     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 462         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 463             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 464         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 465             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 466         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 467             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469     }                                                                                                    </span>
<span  style=""> 470                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 471     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 472         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 473             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 474         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 475             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477     }                                                                                                    </span>
<span  style=""> 478                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 479     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 479     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 480         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 481             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483     }                                                                                                    </span>
<span  style=""> 484                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 485     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 486         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 487         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 488         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 489         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 490         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491     }                                                                                                    </span>
<span  style=""> 492                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 493     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 494         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495     }                                                                                                    </span>
<span  style=""> 496                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 497     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 498         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499     }                                                                                                    </span>
<span  style=""> 500                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 501     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 502         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503     }                                                                                                    </span>
<span  style=""> 504                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 505     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 506         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507     }                                                                                                    </span>
<span  style=""> 508                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 509     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 510         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511     }                                                                                                    </span>
<span  style=""> 512                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 513     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 514         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515     }                                                                                                    </span>
<span  style=""> 516                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 517     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 518     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 519     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 520             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 521         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 522         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 523         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 524             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 526         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 527         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 528                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 529         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 530             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span  style=""> 532                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 533         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 534             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 535             saveAdminUser(user);                                                                         </span>
<span  style=""> 536                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537         }                                                                                                </span>
<span  style=""> 538                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 539         return response;                                                                                 </span>
<span  style=""> 540                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541     }                                                                                                    </span>
<span  style=""> 542                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 543     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 544      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 544      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 545      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 546      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 546      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 547      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 547      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 548      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 549      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 550      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 551      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 552      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 553     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 554         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555     }                                                                                                    </span>
<span  style=""> 556                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 557     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 558      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 559      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 560      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 560      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 561      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 561      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 562      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 562      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 563      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 564      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 565      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 566      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 567      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 568     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 569         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 570     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 571 }                                                                                                        </span>






























































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -                                                                                                                  </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  23                                                                                                                    </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>


<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  31  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  32  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  33  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  34  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  35  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  36  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  37  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  38  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  41  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  42  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>

<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  46  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  51  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  53  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  55  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  56  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  57  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  58  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  59                                                                                                                    </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  61  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  62  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  63  import java.util.List;                                                                                            </span>
<span  style="">  64                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  66  import javax.annotation.Resource;                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                                                                                                                  </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  71                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  72  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  74   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  75   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  76   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  77  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  78  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  79                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  80      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  81                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  82      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  83      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  84                                                                                                                    </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  85      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  86      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  87                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  88      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  89      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  90                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  91      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  92      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style="">  93                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  94      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  95      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -    /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -     *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -     * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -    @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -    protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -    /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -     */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -    protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -                                                                                                                  </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 110      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 111      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 112      protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>
<span  style=""> 113                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 114      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 115       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 115       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 116       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 116       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 117       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 118      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -    protected Object passwordEncoderBean;                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -    /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -     * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -     *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -     * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -    @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -    protected String salt;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -    /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -     * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -    @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -    @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -    @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -    protected SaltSource saltSource;                                                                              </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +    protected PasswordEncoder passwordEncoderBean;                                                                </span>
<span  style=""> 139                                                                                                                    </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 140      @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 141      protected EmailService emailService;                                                                          </span>
<span  style=""> 142                                                                                                                    </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 143      @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 144      protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 146      @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 147      protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                                                                                                                  </span>



<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -    /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 150 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 150 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 151 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 151 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -     *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -     * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -     *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 155 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 155 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -     *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 157 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 157 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -     */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -    @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -    protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -        passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -        passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -        if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -            passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 165 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 165 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 166 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 166 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -        } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -            throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -    }                                                                                                             </span>
<span  style=""> 171                                                                                                                    </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 172      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 173          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174      }                                                                                                             </span>
<span  style=""> 175                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 176      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 177          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178      }                                                                                                             </span>
<span  style=""> 179                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 180      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 181      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 182      public void deleteAdminPermission(AdminPermission permission) {                                               </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 183          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 184          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185      }                                                                                                             </span>
<span  style=""> 186                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 187      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 188      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 189      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 190          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 191          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192      }                                                                                                             </span>
<span  style=""> 193                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 195      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 196      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 197          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 198          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199      }                                                                                                             </span>
<span  style=""> 200                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 201      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 202      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 203          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 207      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 208          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209      }                                                                                                             </span>
<span  style=""> 210                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 211      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 212      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 213          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 217      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 218      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 219          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 220          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 221          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222      }                                                                                                             </span>
<span  style=""> 223                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 225      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 226      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 227          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 228          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 229          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 232      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 233      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 234      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 235          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 236          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 237                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 238          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 239              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 240              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span  style=""> 242                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 243          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 244          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 245              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246          }                                                                                                         </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 248          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 249                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 250          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -            returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +            returnUser.setPassword(encodePassword(unencodedPassword));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253          }                                                                                                         </span>
<span  style=""> 254                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 255          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 256          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 257          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258      }                                                                                                             </span>
<span  style=""> 259                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 260      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 261      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 262          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 263              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 265          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266      }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 268      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 269          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270      }                                                                                                             </span>
<span  style=""> 271                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 272      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 273      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 274      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 275          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 276          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 277          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 278          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 280          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 281          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 282          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 287          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 288          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 289          Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style=""> 290                                                                                                                    </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 291          if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 292              response = (Boolean) cacheElement.getObjectValue();                                                   </span>
<span  style=""> 293                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 294              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 295                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span  style=""> 298                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 299          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 300              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 300              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style=""> 301                                                                                                                    </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 302              if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 303                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 303                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>














<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304              }                                                                                                     </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 306              cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 307              cache.put(cacheElement);                                                                              </span>
<span  style=""> 308                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 309              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 310                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312          }                                                                                                         </span>
<span  style=""> 313                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 314          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315      }                                                                                                             </span>
<span  style=""> 316                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 317      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 317      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 318          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 319                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 320                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 321                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322      }                                                                                                             </span>
<span  style=""> 323                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 324      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 325      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 325      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 326          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 326          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327      }                                                                                                             </span>
<span  style=""> 328                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 329      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 330      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 331          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 334      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 335      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 336          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337      }                                                                                                             </span>
<span  style=""> 338                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 339      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 340      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 341          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342      }                                                                                                             </span>
<span  style=""> 343                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 344      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 345      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 346          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347      }                                                                                                             </span>
<span  style=""> 348                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 349      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 350      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 351          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352      }                                                                                                             </span>
<span  style=""> 353                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 354      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 355      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 356      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 357          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 358          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 359          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 360              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 362          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 363              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 364          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 365              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 366              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 367                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 368                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370              }                                                                                                     </span>
<span  style=""> 371                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 372              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 373                  HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 374                  vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 375                  emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 376              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 377                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 378                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 381          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382      }                                                                                                             </span>
<span  style=""> 383                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 384      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 385      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 386      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 387          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 388          AdminUser user = null;                                                                                    </span>
<span  style=""> 389                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 390          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 391              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392          }                                                                                                         </span>
<span  style=""> 393                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 394          checkUser(user,response);                                                                                 </span>
<span  style=""> 395                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 396          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 397              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 398              token = token.toLowerCase();                                                                          </span>
<span  style=""> 399                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 400              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 401              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 402 -            fpst.setToken(encodePassword(token, null));                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 403 +            fpst.setToken(encodePassword(token));                                                                 </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 404              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 405              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 406                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 407              HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 408              vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 409              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 410              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 411                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 412                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 414                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 417              vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 418              emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style=""> 419                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 421          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422      }                                                                                                             </span>
<span  style=""> 423                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 424      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 425      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 426      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 426      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 427          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 428          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 429          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 430              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 432          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 433          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 434          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 435              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436          }                                                                                                         </span>
<span  style=""> 437                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 438          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 439          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 440              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 441              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 441              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 442              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 443 -                if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 444 +                if (isPasswordValid(fpstok.getToken(), token)) {                                                  </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 445                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 446                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 449              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 450                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 451              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 452                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 453              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 454                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456          }                                                                                                         </span>
<span  style=""> 457                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 458          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 459              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 460                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 461                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 461                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 463                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465          }                                                                                                         </span>
<span  style=""> 466                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 467          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 468              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 469              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 470              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 471          }                                                                                                         </span>
<span  style=""> 472                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 473          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474      }                                                                                                             </span>
<span  style=""> 475                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 476      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 477          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 477          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 478          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 479              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 480              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482      }                                                                                                             </span>
<span  style=""> 483                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 484      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 485          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 486              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 487          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 488              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 489          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 490              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492      }                                                                                                             </span>
<span  style=""> 493                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 494      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 495          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 496              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 497          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 498              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500      }                                                                                                             </span>
<span  style=""> 501                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 502      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 503 -        if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 504 +        if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                            </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 505              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507      }                                                                                                             </span>
<span  style=""> 508                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 509      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 510          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 511          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 512          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 513          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 514          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515      }                                                                                                             </span>
<span  style=""> 516                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 517      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 518          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519      }                                                                                                             </span>
<span  style=""> 520                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 521      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 522          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523      }                                                                                                             </span>
<span  style=""> 524                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 525      public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 526          return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527      }                                                                                                             </span>
<span  style=""> 528                                                                                                                    </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 529      public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 530          this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531      }                                                                                                             </span>
<span  style=""> 532                                                                                                                    </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 533      public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 534          return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535      }                                                                                                             </span>
<span  style=""> 536                                                                                                                    </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 537      public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 538          this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539      }                                                                                                             </span>
<span  style=""> 540                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 541 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 542 -    @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 543 -    public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 544 -        Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 545 -        if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 546 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 546 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 547 -        }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 548 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 549 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 550 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 551 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 552 -    @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 553 -    public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 554 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 555 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 556 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 557 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 558 -    @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 559 -    public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -        this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -    @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 565 -    public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -        return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -    @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -    public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -        this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 575      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 576      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 577      public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 578              String oldPassword, String password, String confirmPassword) {                                        </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 579          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 580          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 581          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 582              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 584          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 585          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 586                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 587          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 588              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589          }                                                                                                         </span>
<span  style=""> 590                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 591          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 592              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 593              saveAdminUser(user);                                                                                  </span>
<span  style=""> 594                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595          }                                                                                                         </span>
<span  style=""> 596                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 597          return response;                                                                                          </span>
<span  style=""> 598                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 599 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 600 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 601 -    /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 602 -     * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 603 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 604 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 604 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 605 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 605 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 606 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 606 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 607 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 607 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 608 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 608 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 609 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 610 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 611 -     *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 612 -     * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 613 -     * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 614 -     * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 615 -     * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 616 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 617 -    @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 618 -    protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 619 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 620 -            return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 621 -        } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 622 -            return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 623 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624      }                                                                                                             </span>
<span  style=""> 625                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 626      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 627       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 627       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 628       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 629       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 629       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 630       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 630       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 631       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 632       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 633       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 634       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 635       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 636      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 637 -        return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +        return passwordEncoderBean.matches(rawPassword, encodedPassword);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639      }                                                                                                             </span>
<span  style=""> 640                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 641      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -     * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 643 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 644 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 644 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 645 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 645 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 646 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 646 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 647 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 647 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 648 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 648 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 649 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 650 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 651 -     *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 652 -     * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 653 -     * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 654 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 655 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 656 -    @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 657 -    protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 658 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 659 -            return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 660 -        } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 661 -            return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 662 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 663 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 664 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 665 -    /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 666 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 666 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 667 +     * Generate an encoded password from a raw password                                                           </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 668       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 672       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 673       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 674       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 675       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 676       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 677      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 678 -        return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 679 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 680 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 681 -    @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 682 -    protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 683 -        return passwordEncoder != null;                                                                           </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 684 +        return passwordEncoderBean.encode(rawPassword);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="">  19                                                                                                                    </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  20  import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  21  import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  22  import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  23                                                                                                                    </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                              </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                          </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  33  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  34  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  35  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  36  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  37  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  38  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  41  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  42  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  46  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  47  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;            </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="">  50  import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="">  51  import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="">  52  import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="">  53  import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  54  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="">  55  import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  56  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="">  57  import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  58  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  59  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  60  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  61  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  62                                                                                                                    </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  63  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  64  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  65  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  66  import java.util.List;                                                                                            </span>
<span  style="">  67                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="">  68  import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  69  import javax.annotation.Resource;                                                                                 </span>




<span  style="">  70                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  71  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  72   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  73   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  74   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  75   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  76  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  77  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  78                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  79      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  80                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  81      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  82      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  83                                                                                                                    </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  84      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  85      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  86                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  87      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  88      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  89                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  90      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  91      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style="">  92                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  93      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  94      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style="">  95                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96      /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style="">  97       * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  98       *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style="">  99       * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 101      @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style=""> 102      protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style=""> 103                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 104      /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style=""> 105       * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 106       */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style=""> 107      protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style=""> 108                                                                                                                    </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 109      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 110      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 111      protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>
<span  style=""> 112                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 113      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 114       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 114       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 115       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 115       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 116       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 117      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style=""> 118      protected Object passwordEncoderBean;                                                                         </span>
<span  style=""> 119                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 120      /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style=""> 121       * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 122       *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style=""> 123       * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 124       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 125      @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style=""> 126      protected String salt;                                                                                        </span>
<span  style=""> 127                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 128      /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style=""> 129       * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 130       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 131       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 132       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 133      @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style=""> 134      @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style=""> 135      @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style=""> 136      protected SaltSource saltSource;                                                                              </span>

<span  style=""> 137                                                                                                                    </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 138      @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 139      protected EmailService emailService;                                                                          </span>
<span  style=""> 140                                                                                                                    </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 141      @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 142      protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style=""> 143                                                                                                                    </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 144      @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 145      protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style=""> 146                                                                                                                    </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +    @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                                    </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +    protected AdminSecurityServiceExtensionManager extensionManager;                                              </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 150      /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style=""><abbr title=" 151       * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 151       * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style=""><abbr title=" 152       * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 152       * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 153       *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style=""> 154       * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 155       *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style=""><abbr title=" 156       * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 156       * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 157       *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style=""><abbr title=" 158       * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 158       * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 159       */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style=""> 160      @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style=""> 161      protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style=""> 162          passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style=""> 163          passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style=""> 164          if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style=""> 165              passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style=""><abbr title=" 166          } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 166          } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style=""><abbr title=" 167              passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 167              passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 168          } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style=""> 169              throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171      }                                                                                                             </span>
<span  style=""> 172                                                                                                                    </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 173      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 174          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175      }                                                                                                             </span>
<span  style=""> 176                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 177      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 178          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179      }                                                                                                             </span>
<span  style=""> 180                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 182      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 183      public void deleteAdminPermission(AdminPermission permission) {                                               </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 184          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 185          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 188      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 189      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 190      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 191          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 192          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 195      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 196      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 197      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 198          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 199          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200      }                                                                                                             </span>
<span  style=""> 201                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 202      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 203      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 204          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205      }                                                                                                             </span>
<span  style=""> 206                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 207      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 208      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 209          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210      }                                                                                                             </span>
<span  style=""> 211                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 212      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 213      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 214          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215      }                                                                                                             </span>
<span  style=""> 216                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 217      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 218      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 219      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 220          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 221          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 222          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223      }                                                                                                             </span>
<span  style=""> 224                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 225      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 226      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 227      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 228          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 229          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 230          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231      }                                                                                                             </span>
<span  style=""> 232                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 233      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 234      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 235      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 236          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 237          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 238                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 239          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 240              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 241              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242          }                                                                                                         </span>
<span  style=""> 243                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 244          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 245          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 246              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247          }                                                                                                         </span>
<span  style=""> 248                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 249          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 250                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 251          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style=""> 252              returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253          }                                                                                                         </span>
<span  style=""> 254                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 255          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 256          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 257          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258      }                                                                                                             </span>
<span  style=""> 259                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 260      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 261      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 262          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 263              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 265          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266      }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 268      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 269          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270      }                                                                                                             </span>
<span  style=""> 271                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 272      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 273      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 274      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 275          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 276          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 277          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 278          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 280          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 281          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 282          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 287          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 288          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 289          Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style=""> 290                                                                                                                    </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 291          if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 292              response = (Boolean) cacheElement.getObjectValue();                                                   </span>
<span  style=""> 293                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 294              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 295                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span  style=""> 298                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 299          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 300 -            response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 300 -            response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -                                                                                                                  </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -            if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 303 -                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 303 -                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +            if (extensionManager != null) {                                                                       </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();                     </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 306 +                ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 306 +                ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperationðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 307 +                if (ExtensionResultStatusType.HANDLED == resultStatusType) {                                      </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 308 +                    response = result.getResult();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +                                                                                                                  </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +            if (response == null || !response) {                                                                  </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 313 +                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 313 +                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionTypeðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 314 +                                                                                                                  </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +                if (!response) {                                                                                  </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 316 +                    response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 316 +                    response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318              }                                                                                                     </span>
<span  style=""> 319                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 320              cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 321              cache.put(cacheElement);                                                                              </span>
<span  style=""> 322                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 323              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 324                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326          }                                                                                                         </span>
<span  style=""> 327                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 328          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329      }                                                                                                             </span>
<span  style=""> 330                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 331      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 331      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 332          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 333                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 334                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 335                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336      }                                                                                                             </span>
<span  style=""> 337                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 338      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 339      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 339      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 340          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 340          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341      }                                                                                                             </span>
<span  style=""> 342                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 343      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 344      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 345          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346      }                                                                                                             </span>
<span  style=""> 347                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 348      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 349      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 350          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351      }                                                                                                             </span>
<span  style=""> 352                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 353      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 354      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 355          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356      }                                                                                                             </span>
<span  style=""> 357                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 358      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 359      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 360          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361      }                                                                                                             </span>
<span  style=""> 362                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 363      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 364      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 365          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366      }                                                                                                             </span>
<span  style=""> 367                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 368      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 369      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 370      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 371          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 372          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 373          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 374              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 376          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 377              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 378          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 379              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 380              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 381                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 382                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384              }                                                                                                     </span>
<span  style=""> 385                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 386              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 387                  HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 388                  vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 389                  emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 390              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 391                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 392                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 395          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396      }                                                                                                             </span>
<span  style=""> 397                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 398      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 399      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 400      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 401          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 402          AdminUser user = null;                                                                                    </span>
<span  style=""> 403                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 404          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 405              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406          }                                                                                                         </span>
<span  style=""> 407                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 408          checkUser(user,response);                                                                                 </span>
<span  style=""> 409                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 410          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 411              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 412              token = token.toLowerCase();                                                                          </span>
<span  style=""> 413                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 414              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 415              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style=""> 416              fpst.setToken(encodePassword(token, null));                                                           </span>

<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 417              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 418              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 419                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 420              HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 421              vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 422              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 423              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 424                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 425                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 426                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 427                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 430              vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 431              emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style=""> 432                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 434          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435      }                                                                                                             </span>
<span  style=""> 436                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 437      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 438      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 439      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 439      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 440          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 441          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 442          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 443              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 445          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 446          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 447          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 448              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449          }                                                                                                         </span>
<span  style=""> 450                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 451          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 452          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 453              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 454              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 454              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 455              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style=""> 456                  if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>

<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 457                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 458                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 461              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 462                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 463              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 464                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 465              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 466                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468          }                                                                                                         </span>
<span  style=""> 469                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 470          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 471              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 472                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 473                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 473                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 475                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477          }                                                                                                         </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 479          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 480              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 481              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 482              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483          }                                                                                                         </span>
<span  style=""> 484                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 485          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486      }                                                                                                             </span>
<span  style=""> 487                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 488      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 489          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 489          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 490          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 491              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 492              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494      }                                                                                                             </span>
<span  style=""> 495                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 496      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 497          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 498              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 499          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 500              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 501          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 502              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504      }                                                                                                             </span>
<span  style=""> 505                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 506      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 507          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 508              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 509          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 510              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512      }                                                                                                             </span>
<span  style=""> 513                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 514      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style=""> 515          if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>

<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 516              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518      }                                                                                                             </span>
<span  style=""> 519                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 520      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 521          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 522          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 523          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 524          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 525          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526      }                                                                                                             </span>
<span  style=""> 527                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 528      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 529          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530      }                                                                                                             </span>
<span  style=""> 531                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 532      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 533          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534      }                                                                                                             </span>
<span  style=""> 535                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 536      public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 537          return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538      }                                                                                                             </span>
<span  style=""> 539                                                                                                                    </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 540      public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 541          this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542      }                                                                                                             </span>
<span  style=""> 543                                                                                                                    </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 544      public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 545          return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546      }                                                                                                             </span>
<span  style=""> 547                                                                                                                    </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 548      public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 549          this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550      }                                                                                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 552      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 553      @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style=""> 554      public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style=""> 555          Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style=""> 556          if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style=""><abbr title=" 557              salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 557              salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558          }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style=""> 559          return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 560      }                                                                                                             </span>
<span  style=""> 561                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 562      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 563      @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style=""> 564      public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style=""> 565          return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566      }                                                                                                             </span>
<span  style=""> 567                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 568      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 569      @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style=""> 570      public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style=""> 571          this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572      }                                                                                                             </span>
<span  style=""> 573                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 574      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 575      @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style=""> 576      public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style=""> 577          return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578      }                                                                                                             </span>
<span  style=""> 579                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 580      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 581      @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style=""> 582      public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style=""> 583          this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 584      }                                                                                                             </span>
<span  style=""> 585                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 586      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 587      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 588      public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 589              String oldPassword, String password, String confirmPassword) {                                        </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 590          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 591          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 592          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 593              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 595          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 596          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 597                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 598          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 599              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600          }                                                                                                         </span>
<span  style=""> 601                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 602          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 603              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 604              saveAdminUser(user);                                                                                  </span>
<span  style=""> 605                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606          }                                                                                                         </span>
<span  style=""> 607                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 608          return response;                                                                                          </span>
<span  style=""> 609                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 610      }                                                                                                             </span>
<span  style=""> 611                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 612      /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style=""> 613       * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 614       * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style=""><abbr title=" 615       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 615       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style=""><abbr title=" 616       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 616       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style=""><abbr title=" 617       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 617       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style=""><abbr title=" 618       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 618       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style=""><abbr title=" 619       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 619       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 620       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 621       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 622       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 623       * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style=""> 624       * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style=""> 625       * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 626       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 627       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 628      @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style=""> 629      protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style=""> 630          if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style=""> 631              return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 632          } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style=""> 633              return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 634          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635      }                                                                                                             </span>
<span  style=""> 636                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 637      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 638       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 638       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 639       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 640       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 640       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 641       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 641       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 642       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 643       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 644       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 645       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 646       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 647      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style=""> 648          return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649      }                                                                                                             </span>
<span  style=""> 650                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 651      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style=""> 652       * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 653       * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style=""><abbr title=" 654       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 654       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style=""><abbr title=" 655       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 655       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style=""><abbr title=" 656       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 656       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style=""><abbr title=" 657       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 657       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style=""><abbr title=" 658       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 658       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 659       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 660       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 661       *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style=""> 662       * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style=""> 663       * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 664       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 665       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 666      @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style=""> 667      protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style=""> 668          if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style=""> 669              return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 670          } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style=""> 671              return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 673      }                                                                                                             </span>
<span  style=""> 674                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 675      /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style=""><abbr title=" 676       * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 676       * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>

<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 677       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 678       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 678       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 679       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 679       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 680       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 680       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 681       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 682       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 683       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 684       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 685       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 686      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style=""> 687          return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688      }                                                                                                             </span>
<span  style=""> 689                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 690      @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style=""> 691      protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style=""> 692          return passwordEncoder != null;                                                                           </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            