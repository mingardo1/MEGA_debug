<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>271</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    271
                    <a href="270.html">prev</a>
                    <a href="272.html">next</a>
                    <a href="271_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_7372a30b9f3190df28e61f8437f110c95d36b4fa_admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;7372a30b9f3190df28e61f8437f110c95d36b4fa:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;7372a30b9f3190df28e61f8437f110c95d36b4fa^1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;7372a30b9f3190df28e61f8437f110c95d36b4fa^2:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;65989a8b6469e6f21626a6b7292822865b1618ba:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b]], subset: [[b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  20 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  21 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  25 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  26 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  27 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  29 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  32 =======                                                                                                  </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  35 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  36 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  37 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  38 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  39 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  40 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  41 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  42 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  43 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  44 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  45 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  46 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  47 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  48 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  49 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  50 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  51 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  53 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  54 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 import org.springframework.security.core.Authentication;                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  57 =======                                                                                                  </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  59 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  60 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="">  61 import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                    </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="">  62 import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                  </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="">  63 import org.springframework.beans.factory.annotation.Autowired;                                           </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="">  64 import org.springframework.beans.factory.annotation.Qualifier;                                           </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="">  65 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  66 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  67 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  68 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  69 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  70 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  71 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  72                                                                                                          </span>
<span class="2176915478347320398" onmouseenter="enter('2176915478347320398');" onmouseout="out('2176915478347320398');" style="">  73 import java.net.URI;                                                                                     </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  74 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  75 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  76 import java.util.List;                                                                                   </span>
<span  style="">  77                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  78 import javax.annotation.Resource;                                                                        </span>
<span class="-6258432847510010429" onmouseenter="enter('-6258432847510010429');" onmouseout="out('-6258432847510010429');" style="">  79 import javax.cache.Cache;                                                                                </span>
<span class="-8383493572114423063" onmouseenter="enter('-8383493572114423063');" onmouseout="out('-8383493572114423063');" style="">  80 import javax.cache.Caching;                                                                              </span>
<span  style="">  81                                                                                                          </span>
<span  style="">  82                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  84  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  85  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  86  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  88 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  89 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  90                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  91     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  92                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  93     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  94     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  95                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  96     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  97     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  98     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style="">  99                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style=""> 100     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style=""> 101     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style=""> 102                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 103     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 104     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style=""> 105                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style=""> 106     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style=""> 107     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style=""> 108                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style=""> 109     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style=""> 110     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style=""> 111                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 112     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 113     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span  style=""> 114                                                                                                          </span>
<span class="-5568530179629633614" onmouseenter="enter('-5568530179629633614');" onmouseout="out('-5568530179629633614');" style=""><abbr title=" 115     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcache:fakeuri&quot;), getClass().getClassLoader()).getCache(CACHE_NAME);"> 115     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcaðŸ”µ</abbr></span>
<span  style=""> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 118      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 118      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 119      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 119      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 120      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 121     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 122     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 123                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 124     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 125     protected EmailService emailService;                                                                 </span>
<span  style=""> 126                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 127     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 128     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 129                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 130     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 131     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 132                                                                                                          </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style=""> 133     @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                           </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style=""> 134     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style=""> 135                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 136     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 137         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138     }                                                                                                    </span>
<span  style=""> 139                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 140     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 141         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142     }                                                                                                    </span>
<span  style=""> 143                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 145     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 146     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span  style=""> 147                                                                                                          </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 148         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 149         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150     }                                                                                                    </span>
<span  style=""> 151                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 152     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 153     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 154     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 155         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 156         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 159     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 160     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 161     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 162         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 163         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164     }                                                                                                    </span>
<span  style=""> 165                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 166     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 167     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 168         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169     }                                                                                                    </span>
<span  style=""> 170                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 172     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 173         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174     }                                                                                                    </span>
<span  style=""> 175                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 176     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 177     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 178         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 182     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 183     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 184         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 185         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 186         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187     }                                                                                                    </span>
<span  style=""> 188                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 189     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 190     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 191     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 192         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 193         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 194         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195     }                                                                                                    </span>
<span  style=""> 196                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 197     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 198     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 199     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 200         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 201         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 202                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 203         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 204             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 205             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206         }                                                                                                </span>
<span  style=""> 207                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 208         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 209         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 210             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span  style=""> 212                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 213         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 214                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 215         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 216             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217         }                                                                                                </span>
<span  style=""> 218                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 219         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 220         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 221         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222     }                                                                                                    </span>
<span  style=""> 223                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 225     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 226         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 227             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 229         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230     }                                                                                                    </span>
<span  style=""> 231                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 232     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 233         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 237     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 238     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 239         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 240         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 241         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 242         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 243         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 243         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 244         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 245         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 246         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247     }                                                                                                    </span>
<span  style=""> 248                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 249     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 250     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 250     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 251         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 252         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="-9117095426186861798" onmouseenter="enter('-9117095426186861798');" onmouseout="out('-9117095426186861798');" style=""> 253         Object objectValue = cache.get(cacheKey);                                                        </span>
<span  style=""> 254                                                                                                          </span>
<span class="7848582689449128669" onmouseenter="enter('7848582689449128669');" onmouseout="out('7848582689449128669');" style=""> 255         if (objectValue != null) {                                                                       </span>
<span class="2053565259445118661" onmouseenter="enter('2053565259445118661');" onmouseout="out('2053565259445118661');" style=""> 256             response = (Boolean) objectValue;                                                            </span>
<span  style=""> 257                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 258             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 259                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261         }                                                                                                </span>
<span  style=""> 262                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 263         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 264             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 265                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 266                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 266                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 267                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 268                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270             }                                                                                            </span>
<span  style=""> 271                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 272             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 273                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 273                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permiðŸ”µ</abbr></span>
<span  style=""> 274                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 275                 if (!response) {                                                                         </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 276                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 276                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPerðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278             }                                                                                            </span>
<span  style=""> 279                                                                                                          </span>
<span class="-5755607343946391756" onmouseenter="enter('-5755607343946391756');" onmouseout="out('-5755607343946391756');" style=""> 280             cache.put(cacheKey, response);                                                               </span>
<span  style=""> 281                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 282             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 283                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285         }                                                                                                </span>
<span  style=""> 286                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 287         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288     }                                                                                                    </span>
<span  style=""> 289                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 290     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 290     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 291         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 292                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 293                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 294                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295     }                                                                                                    </span>
<span  style=""> 296                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 297     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 298     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 298     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 299         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 299         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300     }                                                                                                    </span>
<span  style=""> 301                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 302     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 303     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 304         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305     }                                                                                                    </span>
<span  style=""> 306                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 307     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 308     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 309         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310     }                                                                                                    </span>
<span  style=""> 311                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 312     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 313     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 314         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315     }                                                                                                    </span>
<span  style=""> 316                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 317     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 318     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 319         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320     }                                                                                                    </span>
<span  style=""> 321                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 322     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 323     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 324         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325     }                                                                                                    </span>
<span  style=""> 326                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 327     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 328     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 329     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 330         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 331         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 332         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 333             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 335         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 336             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 337         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 338             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 339             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 340                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 341                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343             }                                                                                            </span>
<span  style=""> 344                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 345             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 346                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 346                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 347             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 348                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 349                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 352         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353     }                                                                                                    </span>
<span  style=""> 354                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 355     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 356     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 357     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 358         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 359         AdminUser user = null;                                                                           </span>
<span  style=""> 360                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 361         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 362             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363         }                                                                                                </span>
<span  style=""> 364                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 365         checkUser(user,response);                                                                        </span>
<span  style=""> 366                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 367         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 368             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 369             token = token.toLowerCase();                                                                 </span>
<span  style=""> 370                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 371             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 372             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 373             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 374             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 375             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 376                                                                                                          </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 377             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 378             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 379                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 380                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 381                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 382                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384             }                                                                                            </span>
<span  style=""> 385                                                                                                          </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style=""><abbr title=" 386             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 386             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 388         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389     }                                                                                                    </span>
<span  style=""> 390                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 391     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 392     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 393     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 393     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 394         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 395         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 396         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 397             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 399         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 400         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 401         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 402             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403         }                                                                                                </span>
<span  style=""> 404                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 405         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 406         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 407             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 408             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 408             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 409             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 410                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 411                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 412                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 415             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 416                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 417             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 418                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 419             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 420                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422         }                                                                                                </span>
<span  style=""> 423                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 424         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 425             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 426                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 427                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 427                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 429                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span  style=""> 432                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 433         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 434             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 435             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 436             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 437         }                                                                                                </span>
<span  style=""> 438                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 439         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440     }                                                                                                    </span>
<span  style=""> 441                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 442     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 443         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 443         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 444         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 445             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 446             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 450     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 451         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 452             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 453         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 454             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 455         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 456             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458     }                                                                                                    </span>
<span  style=""> 459                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 460     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 461         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 462             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 463         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 464             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466     }                                                                                                    </span>
<span  style=""> 467                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 468     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 468     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 469         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 470             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 471         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span  style=""> 473                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 474     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 475         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 476         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 477         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 478         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 479         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 482     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 483         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 486     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 487         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488     }                                                                                                    </span>
<span  style=""> 489                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 490     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 491         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 494     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 495         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496     }                                                                                                    </span>
<span  style=""> 497                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 498     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 499         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500     }                                                                                                    </span>
<span  style=""> 501                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 502     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 503         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504     }                                                                                                    </span>
<span  style=""> 505                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 506     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 507     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1599922521012886573" onmouseenter="enter('-1599922521012886573');" onmouseout="out('-1599922521012886573');" style=""><abbr title=" 508     public GenericResponse changePassword(String username, String oldPassword, String password, String confirmPassword) {"> 508     public GenericResponse changePassword(String username, String oldPassword, String password, String coðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 509         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 510         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 511         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 512             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 514         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 515         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 516                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 517         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 518             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519         }                                                                                                </span>
<span  style=""> 520                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 521         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 522             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 523             saveAdminUser(user);                                                                         </span>
<span  style=""> 524                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525         }                                                                                                </span>
<span  style=""> 526                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 527         return response;                                                                                 </span>
<span  style=""> 528                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529     }                                                                                                    </span>
<span  style=""> 530                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 531     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 532      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 532      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 533      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 534      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 534      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 535      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 535      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 536      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 537      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 538      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 539      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 540      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 541     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 542         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543     }                                                                                                    </span>
<span  style=""> 544                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 545     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 546      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 547      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 548      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 548      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 549      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 549      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 550      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 550      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 551      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 552      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 553      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 554      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 555      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 556     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 557         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  20 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  21 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  25 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  26 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="">  27 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  28 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  29 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  30 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  31 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  32 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  33 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  34 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  35 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  36 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  37 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  38 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  39 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  40 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  41 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  42 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  43 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  44 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="">  45 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="">  46 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="">  47 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  48 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="">  49 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  50 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  51 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  52 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  53 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  54 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  55 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  56                                                                                                          </span>
<span class="2176915478347320398" onmouseenter="enter('2176915478347320398');" onmouseout="out('2176915478347320398');" style="">  57 import java.net.URI;                                                                                     </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  58 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  59 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  60 import java.util.List;                                                                                   </span>
<span  style="">  61                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  62 import javax.annotation.Resource;                                                                        </span>
<span class="-6258432847510010429" onmouseenter="enter('-6258432847510010429');" onmouseout="out('-6258432847510010429');" style="">  63 import javax.cache.Cache;                                                                                </span>
<span class="-8383493572114423063" onmouseenter="enter('-8383493572114423063');" onmouseout="out('-8383493572114423063');" style="">  64 import javax.cache.Caching;                                                                              </span>
<span  style="">  65                                                                                                          </span>
<span  style="">  66                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  67 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  68  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  69  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  70  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  71  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  72 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  73 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  74                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  75     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  76                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  77     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  78     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  79                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  80     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  81     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  82     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style="">  83                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  84     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  85     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  86                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  87     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  88     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  89                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  90     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  91     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  92                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  93     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  94     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  95                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  96     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  97     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span  style="">  98                                                                                                          </span>
<span class="-5568530179629633614" onmouseenter="enter('-5568530179629633614');" onmouseout="out('-5568530179629633614');" style=""><abbr title="  99     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcache:fakeuri&quot;), getClass().getClassLoader()).getCache(CACHE_NAME);">  99     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcaðŸ”µ</abbr></span>
<span  style=""> 100                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 101     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 102      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 102      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 103      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 103      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 104      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 105     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 106     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 107                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 108     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 109     protected EmailService emailService;                                                                 </span>
<span  style=""> 110                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 111     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 112     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 113                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 114     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 115     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 116                                                                                                          </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style=""> 117     @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                           </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style=""> 118     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style=""> 119                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 120     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 121         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 124     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 125         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126     }                                                                                                    </span>
<span  style=""> 127                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 128     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 129     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 130     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span  style=""> 131                                                                                                          </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 132         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 133         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134     }                                                                                                    </span>
<span  style=""> 135                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 136     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 137     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 138     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 139         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 140         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141     }                                                                                                    </span>
<span  style=""> 142                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 143     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 144     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 145     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 146         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 147         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148     }                                                                                                    </span>
<span  style=""> 149                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 150     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 151     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 152         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153     }                                                                                                    </span>
<span  style=""> 154                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 155     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 156     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 157         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 160     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 161     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 162         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163     }                                                                                                    </span>
<span  style=""> 164                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 166     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 167     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 168         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 169         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 170         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 173     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 174     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 175     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 176         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 177         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 178         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 182     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 183     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 184         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 185         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 186                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 187         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 188             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 189             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190         }                                                                                                </span>
<span  style=""> 191                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 192         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 193         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 194             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span  style=""> 196                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 197         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 198                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 199         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 200             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201         }                                                                                                </span>
<span  style=""> 202                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 203         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 204         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 205         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206     }                                                                                                    </span>
<span  style=""> 207                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 208     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 209     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 210         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 211             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 213         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 216     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 217         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 220     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 221     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 222     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 223         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 224         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 225         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 226         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 227         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 227         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 228         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 229         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 230         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231     }                                                                                                    </span>
<span  style=""> 232                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 233     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 234     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 234     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 235         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 236         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="-9117095426186861798" onmouseenter="enter('-9117095426186861798');" onmouseout="out('-9117095426186861798');" style=""> 237         Object objectValue = cache.get(cacheKey);                                                        </span>
<span  style=""> 238                                                                                                          </span>
<span class="7848582689449128669" onmouseenter="enter('7848582689449128669');" onmouseout="out('7848582689449128669');" style=""> 239         if (objectValue != null) {                                                                       </span>
<span class="2053565259445118661" onmouseenter="enter('2053565259445118661');" onmouseout="out('2053565259445118661');" style=""> 240             response = (Boolean) objectValue;                                                            </span>
<span  style=""> 241                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 242             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 243                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span  style=""> 246                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 247         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 248             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 249                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 250                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 250                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 251                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 252                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254             }                                                                                            </span>
<span  style=""> 255                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 256             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 257             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 257             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissioðŸ”µ</abbr></span>
<span  style=""> 258                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 259             if (!response) {                                                                             </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 260                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 260                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262             }                                                                                            </span>
<span  style=""> 263                                                                                                          </span>
<span class="-5755607343946391756" onmouseenter="enter('-5755607343946391756');" onmouseout="out('-5755607343946391756');" style=""> 264             cache.put(cacheKey, response);                                                               </span>
<span  style=""> 265                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 266             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 267                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269         }                                                                                                </span>
<span  style=""> 270                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 271         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272     }                                                                                                    </span>
<span  style=""> 273                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 274     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 274     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 275         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 276                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 277                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 278                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 281     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 282     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 282     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 283         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 283         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284     }                                                                                                    </span>
<span  style=""> 285                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 286     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 287     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 288         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 291     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 292     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 293         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 296     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 297     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 298         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299     }                                                                                                    </span>
<span  style=""> 300                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 301     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 302     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 303         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304     }                                                                                                    </span>
<span  style=""> 305                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 306     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 307     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 308         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309     }                                                                                                    </span>
<span  style=""> 310                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 311     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 312     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 313     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 314         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 315         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 316         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 317             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 319         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 320             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 321         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 322             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 323             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 324                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 325                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327             }                                                                                            </span>
<span  style=""> 328                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 329             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 330                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 330                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 331             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 332                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 333                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 336         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337     }                                                                                                    </span>
<span  style=""> 338                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 339     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 340     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 341     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 342         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 343         AdminUser user = null;                                                                           </span>
<span  style=""> 344                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 345         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 346             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347         }                                                                                                </span>
<span  style=""> 348                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 349         checkUser(user,response);                                                                        </span>
<span  style=""> 350                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 351         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 352             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 353             token = token.toLowerCase();                                                                 </span>
<span  style=""> 354                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 355             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 356             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 357             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 358             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 359             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 360                                                                                                          </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 361             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 362             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 363                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 364                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 365                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 366                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368             }                                                                                            </span>
<span  style=""> 369                                                                                                          </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style=""><abbr title=" 370             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 370             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 372         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373     }                                                                                                    </span>
<span  style=""> 374                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 375     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 376     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 377     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 377     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 378         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 379         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 380         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 381             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 383         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 384         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 385         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 386             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387         }                                                                                                </span>
<span  style=""> 388                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 389         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 390         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 391             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 392             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 392             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 393             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 394                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 395                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 396                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 399             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 400                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 401             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 402                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 403             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 404                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406         }                                                                                                </span>
<span  style=""> 407                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 408         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 409             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 410                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 411                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 411                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 413                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415         }                                                                                                </span>
<span  style=""> 416                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 417         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 418             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 419             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 420             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421         }                                                                                                </span>
<span  style=""> 422                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 423         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424     }                                                                                                    </span>
<span  style=""> 425                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 426     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 427         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 427         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 428         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 429             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 430             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432     }                                                                                                    </span>
<span  style=""> 433                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 434     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 435         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 436             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 437         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 438             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 439         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 440             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 444     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 445         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 446             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 447         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 448             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450     }                                                                                                    </span>
<span  style=""> 451                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 452     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 452     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 453         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 454             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456     }                                                                                                    </span>
<span  style=""> 457                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 458     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 459         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 460         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 461         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 462         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 463         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464     }                                                                                                    </span>
<span  style=""> 465                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 466     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 467         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 470     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 471         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span  style=""> 473                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 474     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 475         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476     }                                                                                                    </span>
<span  style=""> 477                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 478     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 479         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 482     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 483         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 486     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 487         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488     }                                                                                                    </span>
<span  style=""> 489                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 490     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 491     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1599922521012886573" onmouseenter="enter('-1599922521012886573');" onmouseout="out('-1599922521012886573');" style=""><abbr title=" 492     public GenericResponse changePassword(String username, String oldPassword, String password, String confirmPassword) {"> 492     public GenericResponse changePassword(String username, String oldPassword, String password, String coðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 493         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 494         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 495         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 496             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 498         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 499         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 500                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 501         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 502             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503         }                                                                                                </span>
<span  style=""> 504                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 505         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 506             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 507             saveAdminUser(user);                                                                         </span>
<span  style=""> 508                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 509         }                                                                                                </span>
<span  style=""> 510                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 511         return response;                                                                                 </span>
<span  style=""> 512                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513     }                                                                                                    </span>
<span  style=""> 514                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 515     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 516      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 516      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 517      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 518      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 518      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 519      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 519      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 520      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 521      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 522      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 523      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 524      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 525     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 526         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527     }                                                                                                    </span>
<span  style=""> 528                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 529     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 530      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 531      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 532      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 532      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 533      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 533      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 534      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 534      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 535      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 536      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 537      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 538      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 539      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 540     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 541         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543 }                                                                                                        </span>














</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="2176915478347320398" onmouseenter="enter('2176915478347320398');" onmouseout="out('2176915478347320398');" style="">  20 import java.net.URI;                                                                                     </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  21 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  22 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  24 import javax.annotation.Resource;                                                                        </span>
<span class="-6258432847510010429" onmouseenter="enter('-6258432847510010429');" onmouseout="out('-6258432847510010429');" style="">  25 import javax.cache.Cache;                                                                                </span>
<span class="-8383493572114423063" onmouseenter="enter('-8383493572114423063');" onmouseout="out('-8383493572114423063');" style="">  26 import javax.cache.Caching;                                                                              </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  27 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  28 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  29 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  30 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  31 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  32 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  33 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="">  34 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="">  35 import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                     </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="">  36 import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                 </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  37 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  38 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  39 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  40 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  41 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  42 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  43 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  44 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  45 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  46 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  47 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  48 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  49 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  50 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  51 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="">  52 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="">  53 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="">  54 import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  55 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="">  56 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  57 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  58 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  59 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  60 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  61 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  62 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  63                                                                                                          </span>
<span  style="">  64                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  65 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  66  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  67  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  68  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  70 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  71 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  72     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  73                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  74     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span  style="">  75                                                                                                          </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  76     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  77                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  78     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  79     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  80     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style="">  81                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  82     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  83     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  84                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  85     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  86     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  87                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  88     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  89     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  90                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  91     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  92     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  93                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  94     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span  style="">  95                                                                                                          </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  96     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span  style="">  97                                                                                                          </span>
<span class="-5568530179629633614" onmouseenter="enter('-5568530179629633614');" onmouseout="out('-5568530179629633614');" style=""><abbr title="  98     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcache:fakeuri&quot;), getClass().getClassLoader()).getCache(CACHE_NAME);">  98     protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcaðŸ”µ</abbr></span>
<span  style="">  99                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 100     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 101      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 101      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 102      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 102      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 103      */                                                                                                  </span>
<span class="3388729103228334489" onmouseenter="enter('3388729103228334489');" onmouseout="out('3388729103228334489');" style=""> 104     @Resource(name = &quot;blAdminPasswordEncoder&quot;)                                                           </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 105     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 106                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 107     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 108     protected EmailService emailService;                                                                 </span>
<span  style=""> 109                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 110     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 111     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style=""> 112                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 113     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 114     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style=""> 115                                                                                                          </span>
<span class="-8950016723861818775" onmouseenter="enter('-8950016723861818775');" onmouseout="out('-8950016723861818775');" style=""> 116     @Resource(&quot;blAdminSecurityServiceExtensionManager&quot;)                                                  </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style=""> 117     protected AdminSecurityServiceExtensionManager extensionManager;                                     </span>
<span  style=""> 118                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 119     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 120         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121     }                                                                                                    </span>
<span  style=""> 122                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 123     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 124         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 128     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 129     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 130         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 131         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 135     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 136     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 137         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 138         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 142     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 143     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 144         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 145         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146     }                                                                                                    </span>
<span  style=""> 147                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 148     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 149     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 150         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span  style=""> 152                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 153     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 154     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 155         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156     }                                                                                                    </span>
<span  style=""> 157                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 158     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 159     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 160         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 164     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 165     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 166         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 167         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 168         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169     }                                                                                                    </span>
<span  style=""> 170                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 172     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 173     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 174         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 175         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 176         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177     }                                                                                                    </span>
<span  style=""> 178                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 179     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 180     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 181     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 182         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 183         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 184         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 185             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 186             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 188         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 189         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 190             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191         }                                                                                                </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 192         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 193         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 194             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 196         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 197         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 198         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 201     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 202     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 203         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 204             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 206         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 209     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 210         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 213     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 214     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 215     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 216         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 217         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 218         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 219         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 220         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 220         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 221         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 222         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 223         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 226     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 227     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 227     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 228         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 229         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="-9117095426186861798" onmouseenter="enter('-9117095426186861798');" onmouseout="out('-9117095426186861798');" style=""> 230         Object objectValue = cache.get(cacheKey);                                                        </span>
<span class="7848582689449128669" onmouseenter="enter('7848582689449128669');" onmouseout="out('7848582689449128669');" style=""> 231         if (objectValue != null) {                                                                       </span>
<span class="2923547330183272944" onmouseenter="enter('2923547330183272944');" onmouseout="out('2923547330183272944');" style=""> 232             response = ((Boolean) (objectValue));                                                        </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 233             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="2363112910071373709" onmouseenter="enter('2363112910071373709');" onmouseout="out('2363112910071373709');" style=""> 234                 LOG.trace(((&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey) + &quot;\&quot; = &quot;) + response);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236         }                                                                                                </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 237         if (response == null) {                                                                          </span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style=""> 238             if (extensionManager != null) {                                                              </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style=""> 239                 ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();            </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style=""><abbr title=" 240                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 240                 ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style=""> 241                 if (ExtensionResultStatusType.HANDLED == resultStatusType) {                             </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style=""> 242                     response = result.getResult();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244             }                                                                                            </span>
<span  style=""> 245                                                                                                          </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style=""> 246             if (response == null || !response) {                                                         </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 247                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 247                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permiðŸ”µ</abbr></span>
<span  style=""> 248                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 249                 if (!response) {                                                                         </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 250                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 250                     response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPerðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span  style=""> 253                                                                                                          </span>
<span class="-5755607343946391756" onmouseenter="enter('-5755607343946391756');" onmouseout="out('-5755607343946391756');" style=""> 254             cache.put(cacheKey, response);                                                               </span>
<span  style=""> 255                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 256             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 257                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 260         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261     }                                                                                                    </span>
<span  style=""> 262                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 263     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 263     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 264         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 265                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 266                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 267                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268     }                                                                                                    </span>
<span  style=""> 269                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 270     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 271     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 271     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 272         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 272         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 275     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 276     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 277         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 280     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 281     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 282         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 286     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 287         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288     }                                                                                                    </span>
<span  style=""> 289                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 290     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 291     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 292         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293     }                                                                                                    </span>
<span  style=""> 294                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 295     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 296     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 297         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298     }                                                                                                    </span>
<span  style=""> 299                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 300     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 301     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 302     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 303         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 304         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 305         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 306             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 308         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 309             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 310         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 311             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 312             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 313                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 314                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316             }                                                                                            </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 317             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 318                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 318                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 319             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 320                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 321                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 324         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325     }                                                                                                    </span>
<span  style=""> 326                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 327     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 328     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 329     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 330         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 331         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 332         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 333             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 335         checkUser(user, response);                                                                       </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 336         if (!response.getHasErrors()) {                                                                  </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 337             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 338             token = token.toLowerCase();                                                                 </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 339             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 340             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 341             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 342             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 343             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 344             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 345             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 346                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-7837803505903017372" onmouseenter="enter('-7837803505903017372');" onmouseout="out('-7837803505903017372');" style=""> 347                     resetPasswordUrl = (resetPasswordUrl + &quot;&amp;token=&quot;) + token;                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 348                 } else {                                                                                 </span>
<span class="3468614332503463797" onmouseenter="enter('3468614332503463797');" onmouseout="out('3468614332503463797');" style=""> 349                     resetPasswordUrl = (resetPasswordUrl + &quot;?token=&quot;) + token;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351             }                                                                                            </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style=""><abbr title=" 352             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 352             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 354         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355     }                                                                                                    </span>
<span  style=""> 356                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 357     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 358     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 359     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 359     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 360         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 361         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 362         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 363             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 365         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 366         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 367         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 368             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369         }                                                                                                </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 370         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 371         if (!response.getHasErrors()) {                                                                  </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 372             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 373             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 373             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 374             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 375                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 376                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 377                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 380             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 381                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 382             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 383                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 384             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 385                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387         }                                                                                                </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 388         if (!response.getHasErrors()) {                                                                  </span>
<span class="2895087559057502627" onmouseenter="enter('2895087559057502627');" onmouseout="out('2895087559057502627');" style=""> 389             if (!user.getId().equals(fpst.getAdminUserId())) {                                           </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 390                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-4195400670463742016" onmouseenter="enter('-4195400670463742016');" onmouseout="out('-4195400670463742016');" style=""><abbr title=" 391                     LOG.warn(((&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId()) + &quot;, &quot;) + StringUtil.sanitize(token));"> 391                     LOG.warn(((&quot;Password reset attempt tried with mismatched user and token &quot; + user.getIðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 393                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395         }                                                                                                </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 396         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 397             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 398             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 399             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 401         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402     }                                                                                                    </span>
<span  style=""> 403                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 404     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 405         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 405         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 406         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 407             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 408             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410     }                                                                                                    </span>
<span  style=""> 411                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 412     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 413         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 414             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 415         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 416             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 417         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 418             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420     }                                                                                                    </span>
<span  style=""> 421                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 422     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 423         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 424             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 425         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 426             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428     }                                                                                                    </span>
<span  style=""> 429                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 430     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 430     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 431         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 432             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434     }                                                                                                    </span>
<span  style=""> 435                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 436     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 437         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 438         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 439         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 440         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 441         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 444     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 445         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446     }                                                                                                    </span>
<span  style=""> 447                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 448     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 449         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450     }                                                                                                    </span>
<span  style=""> 451                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 452     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 453         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454     }                                                                                                    </span>
<span  style=""> 455                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 456     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 457         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458     }                                                                                                    </span>
<span  style=""> 459                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 460     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 461         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462     }                                                                                                    </span>
<span  style=""> 463                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 464     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 465         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466     }                                                                                                    </span>
<span  style=""> 467                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 468     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 469     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 470     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 471             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 472         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 473         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 474         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 475             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 477         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 478         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 479                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 480         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 481             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482         }                                                                                                </span>
<span  style=""> 483                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 484         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 485             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 486             saveAdminUser(user);                                                                         </span>
<span  style=""> 487                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488         }                                                                                                </span>
<span  style=""> 489                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 490         return response;                                                                                 </span>
<span  style=""> 491                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 494     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 495      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 495      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 496      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 497      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 497      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 498      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 498      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 499      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 500      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 501      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 502      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 503      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 504     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 505         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506     }                                                                                                    </span>
<span  style=""> 507                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 508     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 509      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 510      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 511      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 511      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 512      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 512      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 513      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 513      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 514      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 515      *                                                                                                   </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style=""> 516      * @param rawPassword                                                                                </span>
<span class="3716399659875152737" onmouseenter="enter('3716399659875152737');" onmouseout="out('3716399659875152737');" style=""> 517      * 		the unencoded password to encode                                                                </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 518      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 519      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 520     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 521         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523 }                                                                                                        </span>


































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="">  19                                                                                                                    </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import net.sf.ehcache.Element;                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -                                                                                                                  </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                                     </span>

<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  32  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  33  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  34  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  35  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  36  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  37  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  38  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  41  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  42  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  46  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                            </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                            </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="">  50  import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="">  51  import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="">  52  import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="">  53  import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import org.springframework.context.ApplicationContext;                                                            </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  55  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  57  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  59  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  60  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  61  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  62  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  63                                                                                                                    </span>
<span class="2176915478347320398" onmouseenter="enter('2176915478347320398');" onmouseout="out('2176915478347320398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +import java.net.URI;                                                                                              </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  65  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  66  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  68  import java.util.List;                                                                                            </span>
<span  style="">  69                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  71  import javax.annotation.Resource;                                                                                 </span>
<span class="-6258432847510010429" onmouseenter="enter('-6258432847510010429');" onmouseout="out('-6258432847510010429');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +import javax.cache.Cache;                                                                                         </span>
<span class="-8383493572114423063" onmouseenter="enter('-8383493572114423063');" onmouseout="out('-8383493572114423063');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +import javax.cache.Caching;                                                                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +                                                                                                                  </span>

<span  style="">  75                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  77   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  78   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  79   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  81  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  82  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  83                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  84      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  85                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  86      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  87      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  88                                                                                                                    </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +    @Autowired                                                                                                    </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +    @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                                     </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +    protected BroadleafApplicationEventPublisher eventPublisher;                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +                                                                                                                  </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  93      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  94      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  95                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  96      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  97      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  98                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  99      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style=""> 100      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style=""> 101                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style=""> 102      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style=""> 103      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style=""> 104                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -    /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -     *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -     * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -    @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -    protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -    /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -     */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -    protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -                                                                                                                  </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 118      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 119      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -    protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +                                                                                                                  </span>
<span class="-5568530179629633614" onmouseenter="enter('-5568530179629633614');" onmouseout="out('-5568530179629633614');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 122 +    protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcache:fakeuri&quot;), getClass().getClassLoader()).getCache(CACHE_NAME);"> 122 +    protected Cache&lt;Object, Object&gt; cache = Caching.getCachingProvider().getCacheManager(URI.create(&quot;ehcache:fakeuðŸ”µ</abbr></span>
<span  style=""> 123                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 124      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 125       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 125       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 126       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 126       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 127       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 128      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -    protected Object passwordEncoderBean;                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -    /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -     * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -     *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -     * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -    @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -    protected String salt;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -    /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -     * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -    @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -    @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -    @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -    protected SaltSource saltSource;                                                                              </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +    protected PasswordEncoder passwordEncoderBean;                                                                </span>
<span  style=""> 149                                                                                                                    </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 150      @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 151      protected EmailService emailService;                                                                          </span>
<span  style=""> 152                                                                                                                    </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 153      @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 154      protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style=""> 155                                                                                                                    </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 156      @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 157      protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style=""> 158                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -    /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 160 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 160 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 161 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 161 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -     *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -     * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -     *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 165 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 165 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -     *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 167 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 167 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -     */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -    @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -    protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -        passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -        passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -        if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -            passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 175 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 175 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 176 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 176 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -        } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -            throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -    }                                                                                                             </span>


<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                                                                                                                  </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 182      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 183          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184      }                                                                                                             </span>
<span  style=""> 185                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 186      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 187          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188      }                                                                                                             </span>
<span  style=""> 189                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 190      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 191      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 192      public void deleteAdminPermission(AdminPermission permission) {                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +                                                                                                                  </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 194          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 195          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196      }                                                                                                             </span>
<span  style=""> 197                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 198      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 199      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 200      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 201          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 202          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203      }                                                                                                             </span>
<span  style=""> 204                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 205      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 206      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 207      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 208          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 209          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210      }                                                                                                             </span>
<span  style=""> 211                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 212      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 213      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 214          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215      }                                                                                                             </span>
<span  style=""> 216                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 217      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 218      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 219          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220      }                                                                                                             </span>
<span  style=""> 221                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 222      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 223      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 224          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225      }                                                                                                             </span>
<span  style=""> 226                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 227      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 228      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 229      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 230          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 231          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 232          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233      }                                                                                                             </span>
<span  style=""> 234                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 235      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 236      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 237      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 238          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 239          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 240          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241      }                                                                                                             </span>
<span  style=""> 242                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 243      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 244      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 245      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 246          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 247          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 248                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 249          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 250              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 251              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252          }                                                                                                         </span>
<span  style=""> 253                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 254          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 255          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 256              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257          }                                                                                                         </span>
<span  style=""> 258                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 259          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 260                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 261          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -            returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 263 +            returnUser.setPassword(encodePassword(unencodedPassword));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span  style=""> 265                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 266          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 267          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 268          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269      }                                                                                                             </span>
<span  style=""> 270                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 271      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 272      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 273          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 274              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 276          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277      }                                                                                                             </span>
<span  style=""> 278                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 279      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 280          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281      }                                                                                                             </span>
<span  style=""> 282                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 283      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 284      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 285      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 286          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 287          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 288          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 289          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 290          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 290          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 291          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 292          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 293          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294      }                                                                                                             </span>
<span  style=""> 295                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 296      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 297      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 297      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 298          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 299          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -        Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -                                                                                                                  </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -        if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -            response = (Boolean) cacheElement.getObjectValue();                                                   </span>
<span class="-9117095426186861798" onmouseenter="enter('-9117095426186861798');" onmouseout="out('-9117095426186861798');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +        Object objectValue = cache.get(cacheKey);                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                                                                                                                  </span>
<span class="7848582689449128669" onmouseenter="enter('7848582689449128669');" onmouseout="out('7848582689449128669');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 306 +        if (objectValue != null) {                                                                                </span>
<span class="2053565259445118661" onmouseenter="enter('2053565259445118661');" onmouseout="out('2053565259445118661');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 307 +            response = (Boolean) objectValue;                                                                     </span>
<span  style=""> 308                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 309              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 310                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312          }                                                                                                         </span>
<span  style=""> 313                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 314          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 315              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 315              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style=""> 316                                                                                                                    </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 317              if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 318                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 318                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>














<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319              }                                                                                                     </span>
<span  style=""> 320                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 321 -            cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 322 -            cache.put(cacheElement);                                                                              </span>
<span class="-5755607343946391756" onmouseenter="enter('-5755607343946391756');" onmouseout="out('-5755607343946391756');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 323 +            cache.put(cacheKey, response);                                                                        </span>
<span  style=""> 324                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 325              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 326                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328          }                                                                                                         </span>
<span  style=""> 329                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 330          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331      }                                                                                                             </span>
<span  style=""> 332                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 333      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 333      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 334          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 335                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 336                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 337                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338      }                                                                                                             </span>
<span  style=""> 339                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 340      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 341      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 341      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 342          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 342          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343      }                                                                                                             </span>
<span  style=""> 344                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 345      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 346      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 347          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348      }                                                                                                             </span>
<span  style=""> 349                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 350      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 351      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 352          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353      }                                                                                                             </span>
<span  style=""> 354                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 355      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 356      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 357          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358      }                                                                                                             </span>
<span  style=""> 359                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 360      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 361      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 362          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363      }                                                                                                             </span>
<span  style=""> 364                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 365      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 366      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 367          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368      }                                                                                                             </span>
<span  style=""> 369                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 370      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 371      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 372      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 373          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 374          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 375          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 376              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 378          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 379              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 380          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 381              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 382              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 383                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 384                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386              }                                                                                                     </span>
<span  style=""> 387                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 388              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 389 -                HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 390 -                vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 391 -                emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 392 +                eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 392 +                eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernamesðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 393              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 394                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 395                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 398          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399      }                                                                                                             </span>
<span  style=""> 400                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 401      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 402      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 403      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 404          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 405          AdminUser user = null;                                                                                    </span>
<span  style=""> 406                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 407          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 408              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409          }                                                                                                         </span>
<span  style=""> 410                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 411          checkUser(user,response);                                                                                 </span>
<span  style=""> 412                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 413          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 414              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 415              token = token.toLowerCase();                                                                          </span>
<span  style=""> 416                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 417              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 418              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 419 -            fpst.setToken(encodePassword(token, null));                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 420 +            fpst.setToken(encodePassword(token));                                                                 </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 421              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 422              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 423                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 424 -            HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 425 -            vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 426              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 427              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 428                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 429                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 430                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 431                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 434 -            vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 435 -            emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 436 -                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 437 +                                                                                                                  </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 438 +            eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 438 +            eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl))ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 440          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441      }                                                                                                             </span>
<span  style=""> 442                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 443      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 444      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 445      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 445      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 446          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 447          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 448          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 449              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 451          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 452          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 453          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 454              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455          }                                                                                                         </span>
<span  style=""> 456                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 457          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 458          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 459              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 460              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 460              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 461              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 462 -                if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 463 +                if (isPasswordValid(fpstok.getToken(), token)) {                                                  </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 464                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 465                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 468              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 469                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 470              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 471                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 472              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 473                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475          }                                                                                                         </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 477          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 478              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 479                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 480                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 480                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 482                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span  style=""> 485                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 486          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 487              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 488              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 489              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490          }                                                                                                         </span>
<span  style=""> 491                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 492          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493      }                                                                                                             </span>
<span  style=""> 494                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 495      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 496          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 496          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 497          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 498              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 499              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501      }                                                                                                             </span>
<span  style=""> 502                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 503      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 504          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 505              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 506          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 507              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 508          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 509              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511      }                                                                                                             </span>
<span  style=""> 512                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 513      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 514          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 515              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 516          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 517              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519      }                                                                                                             </span>
<span  style=""> 520                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 521      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 522 -        if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 523 +        if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                            </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 524              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526      }                                                                                                             </span>
<span  style=""> 527                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 528      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 529          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 530          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 531          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 532          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 533          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534      }                                                                                                             </span>
<span  style=""> 535                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 536      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 537          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538      }                                                                                                             </span>
<span  style=""> 539                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 540      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 541          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542      }                                                                                                             </span>
<span  style=""> 543                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 544      public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 545          return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546      }                                                                                                             </span>
<span  style=""> 547                                                                                                                    </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 548      public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 549          this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550      }                                                                                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 552      public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 553          return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 554      }                                                                                                             </span>
<span  style=""> 555                                                                                                                    </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 556      public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 557          this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558      }                                                                                                             </span>
<span  style=""> 559                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -    @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -    public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -        Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -        if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 565 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 565 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -        }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -    @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -    public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 575 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 576 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 577 -    @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 578 -    public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -        this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 583 -    @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 584 -    public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 585 -        return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 586 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 587 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 588 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 589 -    @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 590 -    public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 591 -        this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 592 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 593 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 594      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 595      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 596      public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 597              String oldPassword, String password, String confirmPassword) {                                        </span>



<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 598          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 599          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 600          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 601              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 602          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 603          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 604          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 605                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 606          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 607              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 608          }                                                                                                         </span>
<span  style=""> 609                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 610          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 611              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 612              saveAdminUser(user);                                                                                  </span>
<span  style=""> 613                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614          }                                                                                                         </span>
<span  style=""> 615                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 616          return response;                                                                                          </span>
<span  style=""> 617                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 618 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 619 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 620 -    /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 621 -     * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 622 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 623 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 623 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 624 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 624 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 625 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 625 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 626 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 626 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 627 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 627 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 628 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 629 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 630 -     *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 631 -     * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 632 -     * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 633 -     * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 634 -     * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 635 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 636 -    @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 637 -    protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 638 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 639 -            return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 640 -        } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 641 -            return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 643      }                                                                                                             </span>
<span  style=""> 644                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 645      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 646       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 646       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 647       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 648       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 648       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 649       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 649       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 650       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 651       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 652       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 653       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 654       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 655      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 656 -        return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 657 +        return passwordEncoderBean.matches(rawPassword, encodedPassword);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 658      }                                                                                                             </span>
<span  style=""> 659                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 660      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 661 -     * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 662 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 663 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 663 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 664 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 664 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 665 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 665 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 666 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 666 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 667 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 667 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 668 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 669 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 670 -     *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 671 -     * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 672 -     * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 673 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 674 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 675 -    @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 676 -    protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 677 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 678 -            return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 679 -        } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 680 -            return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 681 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 682 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 683 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 684 -    /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 685 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 685 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 686 +     * Generate an encoded password from a raw password                                                           </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 687       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 688       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 688       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 689       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 689       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 690       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 690       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 691       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 692       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 693       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 694       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 695       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 696      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 697 -        return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 698 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 699 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 700 -    @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 701 -    protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 702 -        return passwordEncoder != null;                                                                           </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 703 +        return passwordEncoderBean.encode(rawPassword);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 705  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="">  19                                                                                                                    </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import net.sf.ehcache.Element;                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -                                                                                                                  </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>
<span class="-7911969485500261220" onmouseenter="enter('-7911969485500261220');" onmouseout="out('-7911969485500261220');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import org.broadleafcommerce.common.extension.ExtensionResultHolder;                                              </span>
<span class="-8339254235515724670" onmouseenter="enter('-8339254235515724670');" onmouseout="out('-8339254235515724670');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import org.broadleafcommerce.common.extension.ExtensionResultStatusType;                                          </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  33  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  34  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  35  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  36  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  37  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  38  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  41  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  42  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  46  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  47  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>
<span class="-3312098673961135394" onmouseenter="enter('-3312098673961135394');" onmouseout="out('-3312098673961135394');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import org.broadleafcommerce.openadmin.server.security.extension.AdminSecurityServiceExtensionManager;            </span>

<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>

<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  54  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  56  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  58  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  59  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  60  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  61  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  62                                                                                                                    </span>

<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  63  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  64  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  65  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  66  import java.util.List;                                                                                            </span>
<span  style="">  67                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  69  import javax.annotation.Resource;                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +                                                                                                                  </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  74                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  77   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  79   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  80  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  81  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  82                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  83      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  84                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  85      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  86      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  87                                                                                                                    </span>




<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  88      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  89      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  90                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  91      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  92      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  93                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  94      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  95      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style="">  96                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  97      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  98      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style="">  99                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -    /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -     *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -     * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -    @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -    protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -    /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -     */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -    protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                                                                                                                  </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 113      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 114      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 115      protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>


<span  style=""> 116                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 118       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 118       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 119       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 119       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 120       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 121      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -    protected Object passwordEncoderBean;                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -    /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -     * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -     *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -     * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -    @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -    protected String salt;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -    /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -     * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -    @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -    @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -    @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -    protected SaltSource saltSource;                                                                              </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +    protected PasswordEncoder passwordEncoderBean;                                                                </span>
<span  style=""> 142                                                                                                                    </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 143      @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 144      protected EmailService emailService;                                                                          </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 146      @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 147      protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style=""> 148                                                                                                                    </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 149      @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 150      protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style=""> 151                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -    /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 153 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 153 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 154 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 154 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -     *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -     * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -     *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 158 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 158 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -     *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 160 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 160 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -     */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -    @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -    protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -        passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -        passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -        if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -            passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 168 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 168 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 169 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 169 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -        } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -            throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -    }                                                                                                             </span>
<span class="5365351345933562919" onmouseenter="enter('5365351345933562919');" onmouseout="out('5365351345933562919');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +    @Resource(name = &quot;blAdminSecurityServiceExtensionManager&quot;)                                                    </span>
<span class="-1417110353729421730" onmouseenter="enter('-1417110353729421730');" onmouseout="out('-1417110353729421730');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +    protected AdminSecurityServiceExtensionManager extensionManager;                                              </span>
<span  style=""> 176                                                                                                                    </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 177      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 178          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179      }                                                                                                             </span>
<span  style=""> 180                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 181      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 182          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183      }                                                                                                             </span>
<span  style=""> 184                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 185      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 186      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 187      public void deleteAdminPermission(AdminPermission permission) {                                               </span>

<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 188          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 189          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190      }                                                                                                             </span>
<span  style=""> 191                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 192      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 193      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 194      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 195          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 196          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197      }                                                                                                             </span>
<span  style=""> 198                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 199      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 200      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 201      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 202          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 203          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 207      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 208          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209      }                                                                                                             </span>
<span  style=""> 210                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 211      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 212      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 213          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 217      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 218          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219      }                                                                                                             </span>
<span  style=""> 220                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 221      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 222      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 223      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 224          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 225          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 226          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227      }                                                                                                             </span>
<span  style=""> 228                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 229      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 230      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 231      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 232          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 233          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 234          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235      }                                                                                                             </span>
<span  style=""> 236                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 237      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 238      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 239      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 240          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 241          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 242                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 243          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 244              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 245              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246          }                                                                                                         </span>
<span  style=""> 247                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 248          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 249          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 250              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251          }                                                                                                         </span>
<span  style=""> 252                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 253          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 254                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 255          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -            returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 257 +            returnUser.setPassword(encodePassword(unencodedPassword));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258          }                                                                                                         </span>
<span  style=""> 259                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 260          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 261          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 262          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263      }                                                                                                             </span>
<span  style=""> 264                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 266      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 267          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 268              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 270          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271      }                                                                                                             </span>
<span  style=""> 272                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 273      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 274          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275      }                                                                                                             </span>
<span  style=""> 276                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 277      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 278      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 279      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 280          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 281          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 282          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 283          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 284          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 284          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 285          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 286          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 287          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288      }                                                                                                             </span>
<span  style=""> 289                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 290      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 291      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 291      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 292          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 293          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 294          Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style=""> 295                                                                                                                    </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 296          if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 297              response = (Boolean) cacheElement.getObjectValue();                                                   </span>




<span  style=""> 298                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 299              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 300                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302          }                                                                                                         </span>
<span  style=""> 303                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 304          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 305 -            response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 305 -            response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -                                                                                                                  </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -            if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 308 -                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 308 -                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>
<span class="955805546394053652" onmouseenter="enter('955805546394053652');" onmouseout="out('955805546394053652');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +            if (extensionManager != null) {                                                                       </span>
<span class="4550825166906581018" onmouseenter="enter('4550825166906581018');" onmouseout="out('4550825166906581018');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +                ExtensionResultHolder&lt;Boolean&gt; result = new ExtensionResultHolder&lt;Boolean&gt;();                     </span>
<span class="5849757963776299131" onmouseenter="enter('5849757963776299131');" onmouseout="out('5849757963776299131');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 311 +                ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperation(adminUser, permissionType, result);"> 311 +                ExtensionResultStatusType resultStatusType = extensionManager.getProxy().hasPrivilegesForOperationðŸ”µ</abbr></span>
<span class="8717425377459845728" onmouseenter="enter('8717425377459845728');" onmouseout="out('8717425377459845728');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +                if (ExtensionResultStatusType.HANDLED == resultStatusType) {                                      </span>
<span class="8610574675635672166" onmouseenter="enter('8610574675635672166');" onmouseout="out('8610574675635672166');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 313 +                    response = result.getResult();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 314 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +            }                                                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +                                                                                                                  </span>
<span class="4202997373718197189" onmouseenter="enter('4202997373718197189');" onmouseout="out('4202997373718197189');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +            if (response == null || !response) {                                                                  </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 318 +                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 318 +                response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionTypeðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +                                                                                                                  </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 320 +                if (!response) {                                                                                  </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 321 +                    response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 321 +                    response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 322 +                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323              }                                                                                                     </span>
<span  style=""> 324                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 325              cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 326              cache.put(cacheElement);                                                                              </span>

<span  style=""> 327                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 328              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 329                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331          }                                                                                                         </span>
<span  style=""> 332                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 333          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334      }                                                                                                             </span>
<span  style=""> 335                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 336      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 336      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 337          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 338                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 339                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 340                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341      }                                                                                                             </span>
<span  style=""> 342                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 343      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 344      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 344      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 345          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 345          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346      }                                                                                                             </span>
<span  style=""> 347                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 348      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 349      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 350          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351      }                                                                                                             </span>
<span  style=""> 352                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 353      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 354      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 355          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356      }                                                                                                             </span>
<span  style=""> 357                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 358      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 359      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 360          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361      }                                                                                                             </span>
<span  style=""> 362                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 363      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 364      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 365          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366      }                                                                                                             </span>
<span  style=""> 367                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 368      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 369      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 370          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371      }                                                                                                             </span>
<span  style=""> 372                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 373      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 374      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 375      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 376          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 377          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 378          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 379              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 381          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 382              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 383          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 384              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 385              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 386                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 387                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389              }                                                                                                     </span>
<span  style=""> 390                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 391              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 392                  HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 393                  vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 394                  emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>

<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 395              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 396                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 397                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 400          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401      }                                                                                                             </span>
<span  style=""> 402                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 403      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 404      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 405      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 406          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 407          AdminUser user = null;                                                                                    </span>
<span  style=""> 408                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 409          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 410              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411          }                                                                                                         </span>
<span  style=""> 412                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 413          checkUser(user,response);                                                                                 </span>
<span  style=""> 414                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 415          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 416              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 417              token = token.toLowerCase();                                                                          </span>
<span  style=""> 418                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 419              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 420              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 421 -            fpst.setToken(encodePassword(token, null));                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 422 +            fpst.setToken(encodePassword(token));                                                                 </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 423              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 424              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 425                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 426              HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 427              vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 428              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 429              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 430                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 431                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 432                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 433                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 436              vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 437              emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style=""> 438                                                                                                                    </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 440          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441      }                                                                                                             </span>
<span  style=""> 442                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 443      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 444      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 445      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 445      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 446          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 447          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 448          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 449              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 451          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 452          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 453          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 454              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455          }                                                                                                         </span>
<span  style=""> 456                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 457          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 458          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 459              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 460              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 460              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 461              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 462 -                if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 463 +                if (isPasswordValid(fpstok.getToken(), token)) {                                                  </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 464                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 465                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 468              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 469                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 470              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 471                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 472              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 473                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475          }                                                                                                         </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 477          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 478              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 479                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 480                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 480                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 482                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span  style=""> 485                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 486          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 487              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 488              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 489              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490          }                                                                                                         </span>
<span  style=""> 491                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 492          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493      }                                                                                                             </span>
<span  style=""> 494                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 495      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 496          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 496          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 497          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 498              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 499              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501      }                                                                                                             </span>
<span  style=""> 502                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 503      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 504          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 505              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 506          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 507              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 508          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 509              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511      }                                                                                                             </span>
<span  style=""> 512                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 513      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 514          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 515              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 516          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 517              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519      }                                                                                                             </span>
<span  style=""> 520                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 521      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 522 -        if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 523 +        if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                            </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 524              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526      }                                                                                                             </span>
<span  style=""> 527                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 528      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 529          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 530          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 531          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 532          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 533          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534      }                                                                                                             </span>
<span  style=""> 535                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 536      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 537          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538      }                                                                                                             </span>
<span  style=""> 539                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 540      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 541          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542      }                                                                                                             </span>
<span  style=""> 543                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 544      public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 545          return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546      }                                                                                                             </span>
<span  style=""> 547                                                                                                                    </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 548      public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 549          this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550      }                                                                                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 552      public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 553          return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 554      }                                                                                                             </span>
<span  style=""> 555                                                                                                                    </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 556      public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 557          this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 558      }                                                                                                             </span>
<span  style=""> 559                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -    @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -    public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -        Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -        if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 565 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 565 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -        }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -    @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -    public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 575 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 576 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 577 -    @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 578 -    public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -        this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 583 -    @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 584 -    public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 585 -        return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 586 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 587 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 588 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 589 -    @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 590 -    public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 591 -        this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 592 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 593 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 594 -    @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 595 -    @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 596 -    public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 597 -            String oldPassword, String password, String confirmPassword) {                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 598 +    @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 599 +    @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1599922521012886573" onmouseenter="enter('-1599922521012886573');" onmouseout="out('-1599922521012886573');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 600 +    public GenericResponse changePassword(String username, String oldPassword, String password, String confirmPassword) {"> 600 +    public GenericResponse changePassword(String username, String oldPassword, String password, String confirmPassðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 601          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 602          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 603          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 604              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 605          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 606          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 607          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 608                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 609          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 610              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 611          }                                                                                                         </span>
<span  style=""> 612                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 613          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 614              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 615              saveAdminUser(user);                                                                                  </span>
<span  style=""> 616                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 617          }                                                                                                         </span>
<span  style=""> 618                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 619          return response;                                                                                          </span>
<span  style=""> 620                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 621 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 622 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 623 -    /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 624 -     * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 625 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 626 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 626 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 627 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 627 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 628 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 628 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 629 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 629 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 630 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 630 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 631 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 632 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 633 -     *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 634 -     * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 635 -     * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 636 -     * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 637 -     * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 638 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 639 -    @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 640 -    protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 641 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -            return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 643 -        } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 644 -            return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 645 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 646      }                                                                                                             </span>
<span  style=""> 647                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 648      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 649       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 649       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 650       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 651       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 651       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 652       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 652       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 653       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 654       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 655       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 656       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 657       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 658      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 659 -        return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 660 +        return passwordEncoderBean.matches(rawPassword, encodedPassword);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661      }                                                                                                             </span>
<span  style=""> 662                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 663      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 664 -     * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 665 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 666 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 666 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 667 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 667 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 668 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 668 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 669 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 669 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 670 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 670 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 671 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 672 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 673 -     *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 674 -     * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 675 -     * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 676 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 677 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 678 -    @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 679 -    protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 680 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 681 -            return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 682 -        } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 683 -            return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 684 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 685 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 686 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 687 -    /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 688 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 688 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 689 +     * Generate an encoded password from a raw password                                                           </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 690       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 691       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 691       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 692       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 692       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 693       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 693       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 694       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 695       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 696       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 697       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 698       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 699      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 700 -        return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 701 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 702 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 703 -    @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 704 -    protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 705 -        return passwordEncoder != null;                                                                           </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 706 +        return passwordEncoderBean.encode(rawPassword);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 707      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 708  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            