<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>170</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    170
                    <a href="169.html">prev</a>
                    <a href="171.html">next</a>
                    <a href="170_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_f3b83d347352a2bc71ea8543a5fe93d8d9d52c77_common/src/main/java/org/broadleafcommerce/common/copy/MultiTenantCopier.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;f3b83d347352a2bc71ea8543a5fe93d8d9d52c77:common/src/main/java/org/broadleafcommerce/common/copy/MultiTenantCopier.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;f3b83d347352a2bc71ea8543a5fe93d8d9d52c77^1:common/src/main/java/org/broadleafcommerce/common/copy/MultiTenantCopier.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;f3b83d347352a2bc71ea8543a5fe93d8d9d52c77^2:common/src/main/java/org/broadleafcommerce/common/copy/MultiTenantCopier.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;ac0e9fad0e533cee585bebc82a58a18aa38a05cf:common/src/main/java/org/broadleafcommerce/common/copy/MultiTenantCopier.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [j]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-4573490878212285276" onmouseenter="enter('-4573490878212285276');" onmouseout="out('-4573490878212285276');" style="">   3  * BroadleafCommerce Common Libraries                                                                    </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-1160938633668984164" onmouseenter="enter('-1160938633668984164');" onmouseout="out('-1160938633668984164');" style="">  18 package org.broadleafcommerce.common.copy;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  20 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  21 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="-9066890226896155571" onmouseenter="enter('-9066890226896155571');" onmouseout="out('-9066890226896155571');" style="">  22 import org.broadleafcommerce.common.exception.ExceptionHelper;                                           </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  23 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="4081669836921876898" onmouseenter="enter('4081669836921876898');" onmouseout="out('4081669836921876898');" style="">  24 import org.broadleafcommerce.common.sandbox.domain.SandBox;                                              </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  25 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="-4286566313930798693" onmouseenter="enter('-4286566313930798693');" onmouseout="out('-4286566313930798693');" style="">  26 import org.broadleafcommerce.common.site.domain.Catalog;                                                 </span>
<span class="3350833871385260454" onmouseenter="enter('3350833871385260454');" onmouseout="out('3350833871385260454');" style="">  27 import org.broadleafcommerce.common.site.domain.Site;                                                    </span>
<span class="5712948414688687719" onmouseenter="enter('5712948414688687719');" onmouseout="out('5712948414688687719');" style="">  28 import org.broadleafcommerce.common.util.StreamCapableTransactionalOperationAdapter;                     </span>
<span class="3798869978454175791" onmouseenter="enter('3798869978454175791');" onmouseout="out('3798869978454175791');" style="">  29 import org.broadleafcommerce.common.util.StreamingTransactionCapableUtil;                                </span>
<span class="5413521702958049593" onmouseenter="enter('5413521702958049593');" onmouseout="out('5413521702958049593');" style="">  30 import org.broadleafcommerce.common.util.tenant.IdentityExecutionUtils;                                  </span>
<span class="2334451492079531669" onmouseenter="enter('2334451492079531669');" onmouseout="out('2334451492079531669');" style="">  31 import org.broadleafcommerce.common.util.tenant.IdentityOperation;                                       </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  32 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="2584309252308847990" onmouseenter="enter('2584309252308847990');" onmouseout="out('2584309252308847990');" style="">  33 import org.broadleafcommerce.common.web.DeployState;                                                     </span>
<span class="6105195614559590838" onmouseenter="enter('6105195614559590838');" onmouseout="out('6105195614559590838');" style="">  34 import org.broadleafcommerce.common.web.EnforceEnterpriseCollectionBehaviorState;                        </span>
<span class="-5036922012441036669" onmouseenter="enter('-5036922012441036669');" onmouseout="out('-5036922012441036669');" style="">  35 import org.springframework.core.Ordered;                                                                 </span>
<span  style="">  36                                                                                                          </span>
<span class="507320133330553151" onmouseenter="enter('507320133330553151');" onmouseout="out('507320133330553151');" style="">  37 import java.lang.reflect.Field;                                                                          </span>
<span class="1546464639948964552" onmouseenter="enter('1546464639948964552');" onmouseout="out('1546464639948964552');" style="">  38 import java.lang.reflect.Modifier;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  39 import java.util.ArrayList;                                                                              </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  40 import java.util.Collection;                                                                             </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  43 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  44 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  45 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  46 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  48 import javax.annotation.Resource;                                                                        </span>
<span class="5429236160528371227" onmouseenter="enter('5429236160528371227');" onmouseout="out('5429236160528371227');" style="">  49 import javax.persistence.Embeddable;                                                                     </span>
<span class="634040011956091835" onmouseenter="enter('634040011956091835');" onmouseout="out('634040011956091835');" style="">  50 import javax.persistence.ManyToMany;                                                                     </span>
<span class="-2638882474121018940" onmouseenter="enter('-2638882474121018940');" onmouseout="out('-2638882474121018940');" style="">  51 import javax.persistence.ManyToOne;                                                                      </span>
<span class="4490236759922497400" onmouseenter="enter('4490236759922497400');" onmouseout="out('4490236759922497400');" style="">  52 import javax.persistence.OneToMany;                                                                      </span>
<span class="-1278149683069486932" onmouseenter="enter('-1278149683069486932');" onmouseout="out('-1278149683069486932');" style="">  53 import javax.persistence.OneToOne;                                                                       </span>
<span  style="">  54                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="-8041280944155159385" onmouseenter="enter('-8041280944155159385');" onmouseout="out('-8041280944155159385');" style=""><abbr title="  56  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. Subclasses generally">  56  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. SðŸ”µ</abbr></span>
<span class="-627018466353991606" onmouseenter="enter('-627018466353991606');" onmouseout="out('-627018466353991606');" style=""><abbr title="  57  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.common.site.domain.Catalog, MultiTenantCopyContext)}">  57  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcomðŸ”µ</abbr></span>
<span class="-416790415154158937" onmouseenter="enter('-416790415154158937');" onmouseout="out('-416790415154158937');" style=""><abbr title="  58  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and persist">  58  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clonðŸ”µ</abbr></span>
<span class="5445624896446749929" onmouseenter="enter('5445624896446749929');" onmouseout="out('5445624896446749929');" style="">  59  * an entity object tree.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  60  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style="">  61  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style="">  62  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63  */                                                                                                      </span>
<span class="-1737666508653679295" onmouseenter="enter('-1737666508653679295');" onmouseout="out('-1737666508653679295');" style="">  64 public abstract class MultiTenantCopier implements Ordered {                                             </span>
<span class="7878007665356847965" onmouseenter="enter('7878007665356847965');" onmouseout="out('7878007665356847965');" style="">  65     protected static final Log LOG = LogFactory.getLog(MultiTenantCopier.class);                         </span>
<span  style="">  66                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="">  67     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="">  68     protected GenericEntityService genericEntityService;                                                 </span>
<span  style="">  69                                                                                                          </span>
<span class="-4045496854230922802" onmouseenter="enter('-4045496854230922802');" onmouseout="out('-4045496854230922802');" style="">  70     @Resource(name = &quot;blMultiTenantCopierExtensionManager&quot;)                                              </span>
<span class="9132557441157356873" onmouseenter="enter('9132557441157356873');" onmouseout="out('9132557441157356873');" style="">  71     protected MultiTenantCopierExtensionManager extensionManager;                                        </span>
<span  style="">  72                                                                                                          </span>
<span class="6302352000387574659" onmouseenter="enter('6302352000387574659');" onmouseout="out('6302352000387574659');" style="">  73     @Resource(name=&quot;blStreamingTransactionCapableUtil&quot;)                                                  </span>
<span class="-8080662791692885473" onmouseenter="enter('-8080662791692885473');" onmouseout="out('-8080662791692885473');" style="">  74     protected StreamingTransactionCapableUtil transUtil;                                                 </span>
<span  style="">  75                                                                                                          </span>
<span class="3478346643346744503" onmouseenter="enter('3478346643346744503');" onmouseout="out('3478346643346744503');" style="">  76     protected int order = 0;                                                                             </span>
<span  style="">  77                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  78     /**                                                                                                  </span>
<span class="-122049322422344857" onmouseenter="enter('-122049322422344857');" onmouseout="out('-122049322422344857');" style="">  79      * To add elements use {@link #addPattern(Pattern)}                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80      */                                                                                                  </span>
<span class="-4573832410677620492" onmouseenter="enter('-4573832410677620492');" onmouseout="out('-4573832410677620492');" style="">  81     protected List&lt;Pattern&gt; classExcludeRegexPatternList = new ArrayList&lt;&gt;();                            </span>
<span  style="">  82                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83     /**                                                                                                  </span>
<span class="2044942771211883310" onmouseenter="enter('2044942771211883310');" onmouseout="out('2044942771211883310');" style="">  84      * Main method that should be implemented by each {@link MultiTenantCopier} to drive the logic of    </span>
<span class="3580574424461635495" onmouseenter="enter('3580574424461635495');" onmouseout="out('3580574424461635495');" style="">  85      * copying that particular entity to the new derived catalog.                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  86      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="">  87      * @param context                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  88      */                                                                                                  </span>
<span class="-6235588905422461924" onmouseenter="enter('-6235588905422461924');" onmouseout="out('-6235588905422461924');" style="">  89     public abstract void copyEntities(MultiTenantCopyContext context) throws Exception;                  </span>
<span  style="">  90                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  91     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  92      *                                                                                                   </span>
<span class="2985577248159931846" onmouseenter="enter('2985577248159931846');" onmouseout="out('2985577248159931846');" style="">  93      * @return the order of this {@link MultiTenantCopier}                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  95     @Override                                                                                            </span>
<span class="-1157866401688879802" onmouseenter="enter('-1157866401688879802');" onmouseout="out('-1157866401688879802');" style="">  96     public int getOrder() {                                                                              </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style="">  97         return order;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98     }                                                                                                    </span>
<span  style="">  99                                                                                                          </span>
<span class="8078611052580382973" onmouseenter="enter('8078611052580382973');" onmouseout="out('8078611052580382973');" style=""> 100     public void setOrder(int order) {                                                                    </span>
<span class="-6754869500416241760" onmouseenter="enter('-6754869500416241760');" onmouseout="out('-6754869500416241760');" style=""> 101         this.order = order;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102     }                                                                                                    </span>
<span  style=""> 103                                                                                                          </span>
<span class="-3615357639229759469" onmouseenter="enter('-3615357639229759469');" onmouseout="out('-3615357639229759469');" style=""><abbr title=" 104     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazz, T original, MultiTenantCopyContext context) throws G {"> 104     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, ClassðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 105         try {                                                                                            </span>
<span class="8848439591475072064" onmouseenter="enter('8848439591475072064');" onmouseout="out('8848439591475072064');" style=""> 106             //don&#x27;t persist if there is already an equivalent present                                    </span>
<span class="-3623402225573308912" onmouseenter="enter('-3623402225573308912');" onmouseout="out('-3623402225573308912');" style=""><abbr title=" 107             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) != null) {"> 107             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) !=ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 108                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109             }                                                                                            </span>
<span  style=""> 110                                                                                                          </span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 111             context.clearOriginalIdentifiers();                                                          </span>
<span class="-4760173204145292260" onmouseenter="enter('-4760173204145292260');" onmouseout="out('-4760173204145292260');" style=""> 112             genericEntityService.clearAutoFlushMode();                                                   </span>
<span class="-8326881612018417764" onmouseenter="enter('-8326881612018417764');" onmouseout="out('-8326881612018417764');" style=""> 113             Object copy = copyOperation.execute(original);                                               </span>
<span class="3128798615968492125" onmouseenter="enter('3128798615968492125');" onmouseout="out('3128798615968492125');" style=""> 114             SandBox sandBox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();         </span>
<span class="6492445518569294809" onmouseenter="enter('6492445518569294809');" onmouseout="out('6492445518569294809');" style=""><abbr title=" 115             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployState();"> 115             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployStateðŸ”µ</abbr></span>
<span class="2163142151434548972" onmouseenter="enter('2163142151434548972');" onmouseout="out('2163142151434548972');" style=""> 116             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(DeployState.PRODUCTION); </span>
<span class="6572079192165011753" onmouseenter="enter('6572079192165011753');" onmouseout="out('6572079192165011753');" style=""> 117             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(null);                       </span>
<span class="-6104353510353355986" onmouseenter="enter('-6104353510353355986');" onmouseout="out('-6104353510353355986');" style=""><abbr title=" 118             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.FALSE);"> 118             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-2148155577856476410" onmouseenter="enter('-2148155577856476410');" onmouseout="out('-2148155577856476410');" style=""> 119             persistCopyObjectTreeInternal(copy, new HashSet&lt;Integer&gt;(), context);                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 120             genericEntityService.flush();                                                                </span>
<span class="1952764089697360447" onmouseenter="enter('1952764089697360447');" onmouseout="out('1952764089697360447');" style=""> 121             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(sandBox);                    </span>
<span class="2444831964480057831" onmouseenter="enter('2444831964480057831');" onmouseout="out('2444831964480057831');" style=""> 122             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(deployState);            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 123         } catch (Exception e) {                                                                          </span>
<span class="3675438560154002673" onmouseenter="enter('3675438560154002673');" onmouseout="out('3675438560154002673');" style=""> 124             LOG.error(&quot;Unable to persist the copy object tree&quot;, e);                                      </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 125             throw ExceptionHelper.refineException(e);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 126         } finally {                                                                                      </span>
<span class="7199875090489075677" onmouseenter="enter('7199875090489075677');" onmouseout="out('7199875090489075677');" style=""><abbr title=" 127             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.TRUE);"> 127             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 128             context.clearOriginalIdentifiers();                                                          </span>
<span class="-5390342410291425165" onmouseenter="enter('-5390342410291425165');" onmouseout="out('-5390342410291425165');" style=""> 129             genericEntityService.enableAutoFlushMode();                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="813863986067248403" onmouseenter="enter('813863986067248403');" onmouseout="out('813863986067248403');" style=""><abbr title=" 133     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext context) {"> 133     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContexðŸ”µ</abbr></span>
<span class="5726455157241988222" onmouseenter="enter('5726455157241988222');" onmouseout="out('5726455157241988222');" style=""> 134         if (library.contains(System.identityHashCode(copy)) || !(copy instanceof MultiTenantCloneable)   </span>
<span class="-6757188153093146979" onmouseenter="enter('-6757188153093146979');" onmouseout="out('-6757188153093146979');" style=""> 135                 || this.excludeFromCopyRegexPattern(copy)) {                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 136             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="6099587390698254391" onmouseenter="enter('6099587390698254391');" onmouseout="out('6099587390698254391');" style=""> 138         library.add(System.identityHashCode(copy));                                                      </span>
<span class="-4798752894315625699" onmouseenter="enter('-4798752894315625699');" onmouseout="out('-4798752894315625699');" style=""> 139         List&lt;Object[]&gt; collections = new ArrayList&lt;Object[]&gt;();                                          </span>
<span class="1437989156315370335" onmouseenter="enter('1437989156315370335');" onmouseout="out('1437989156315370335');" style=""> 140         Field[] allFields = context.getAllFields(copy.getClass());                                       </span>
<span class="2968462139034023970" onmouseenter="enter('2968462139034023970');" onmouseout="out('2968462139034023970');" style=""> 141         for (Field field : allFields) {                                                                  </span>
<span class="-6028825997928669487" onmouseenter="enter('-6028825997928669487');" onmouseout="out('-6028825997928669487');" style=""> 142             if (field.getName().equals(&quot;embeddableSiteDiscriminator&quot;)) {                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 143                 continue;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144             }                                                                                            </span>
<span class="2215334239672037801" onmouseenter="enter('2215334239672037801');" onmouseout="out('2215334239672037801');" style=""> 145             if (!Modifier.isStatic(field.getModifiers())) {                                              </span>
<span class="-242302875073644057" onmouseenter="enter('-242302875073644057');" onmouseout="out('-242302875073644057');" style=""> 146                 field.setAccessible(true);                                                               </span>
<span class="-3119387060603195319" onmouseenter="enter('-3119387060603195319');" onmouseout="out('-3119387060603195319');" style=""> 147                 Object newTarget;                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 148                 try {                                                                                    </span>
<span class="-1788169810723093055" onmouseenter="enter('-1788169810723093055');" onmouseout="out('-1788169810723093055');" style=""> 149                     newTarget = field.get(copy);                                                         </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style=""> 150                 } catch (IllegalAccessException e) {                                                     </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 151                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152                 }                                                                                        </span>
<span class="5292471581137077546" onmouseenter="enter('5292471581137077546');" onmouseout="out('5292471581137077546');" style=""> 153                 if (newTarget != null) {                                                                 </span>
<span class="-4896034365120653328" onmouseenter="enter('-4896034365120653328');" onmouseout="out('-4896034365120653328');" style=""><abbr title=" 154                     if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != null) {"> 154                     if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.clasðŸ”µ</abbr></span>
<span class="-1779560011655050958" onmouseenter="enter('-1779560011655050958');" onmouseout="out('-1779560011655050958');" style=""> 155                         if (library.contains(System.identityHashCode(newTarget))) {                      </span>
<span class="-6882820149046221397" onmouseenter="enter('-6882820149046221397');" onmouseout="out('-6882820149046221397');" style=""> 156                             persistNode(newTarget, context);                                             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 157                             continue;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                         }                                                                                </span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 159                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-6556217836886273986" onmouseenter="enter('-6556217836886273986');" onmouseout="out('-6556217836886273986');" style=""><abbr title=" 160                     } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.class) != null) {"> 160                     } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToðŸ”µ</abbr></span>
<span class="6570005356546170417" onmouseenter="enter('6570005356546170417');" onmouseout="out('6570005356546170417');" style=""> 161                         collections.add(new Object[]{field, newTarget});                                 </span>
<span class="-1287323088547185838" onmouseenter="enter('-1287323088547185838');" onmouseout="out('-1287323088547185838');" style=""><abbr title=" 162                     } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.class.isAssignableFrom(field.getType())) {"> 162                     } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantClonðŸ”µ</abbr></span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 163                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167         }                                                                                                </span>
<span class="5522223281117737932" onmouseenter="enter('5522223281117737932');" onmouseout="out('5522223281117737932');" style=""> 168         if (copy.getClass().getAnnotation(Embeddable.class) == null) {                                   </span>
<span class="8489885264009154572" onmouseenter="enter('8489885264009154572');" onmouseout="out('8489885264009154572');" style=""> 169             persistNode(copy, context);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="7328299556920669788" onmouseenter="enter('7328299556920669788');" onmouseout="out('7328299556920669788');" style=""> 171         for (Object[] collectionItem : collections) {                                                    </span>
<span class="6509881775537642462" onmouseenter="enter('6509881775537642462');" onmouseout="out('6509881775537642462');" style=""> 172             if (collectionItem[1] instanceof Collection) {                                               </span>
<span class="-4625848514609956673" onmouseenter="enter('-4625848514609956673');" onmouseout="out('-4625848514609956673');" style=""> 173                 Collection newCollection = (Collection) collectionItem[1];                               </span>
<span class="2236280788008259197" onmouseenter="enter('2236280788008259197');" onmouseout="out('2236280788008259197');" style=""> 174                 for (Object member : newCollection) {                                                    </span>
<span class="559928666155877213" onmouseenter="enter('559928666155877213');" onmouseout="out('559928666155877213');" style=""> 175                     persistCopyObjectTreeInternal(member, library, context);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176                 }                                                                                        </span>
<span class="-358290731378005197" onmouseenter="enter('-358290731378005197');" onmouseout="out('-358290731378005197');" style=""> 177             } else if (collectionItem[1] instanceof Map) {                                               </span>
<span class="-8530282384745692595" onmouseenter="enter('-8530282384745692595');" onmouseout="out('-8530282384745692595');" style=""> 178                 Map newMap = (Map) collectionItem[1];                                                    </span>
<span class="-3046213999695776442" onmouseenter="enter('-3046213999695776442');" onmouseout="out('-3046213999695776442');" style=""> 179                 for (Object key : newMap.keySet()) {                                                     </span>
<span class="-4861713825562612226" onmouseenter="enter('-4861713825562612226');" onmouseout="out('-4861713825562612226');" style=""> 180                     persistCopyObjectTreeInternal(newMap.get(key), library, context);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 182             } else {                                                                                     </span>
<span class="2428600337084572914" onmouseenter="enter('2428600337084572914');" onmouseout="out('2428600337084572914');" style=""> 183                 throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; +    </span>
<span class="-7690968681915381732" onmouseenter="enter('-7690968681915381732');" onmouseout="out('-7690968681915381732');" style=""><abbr title=" 184                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; +"> 184                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The systeðŸ”µ</abbr></span>
<span class="858209187721340375" onmouseenter="enter('858209187721340375');" onmouseout="out('858209187721340375');" style=""><abbr title=" 185                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItem[0]).getName()));"> 185                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188     }                                                                                                    </span>
<span  style=""> 189                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 190     /**                                                                                                  </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 191 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 192 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7690968681915381732" onmouseenter="enter('-7690968681915381732');" onmouseout="out('-7690968681915381732');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 193                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; +"> 193                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The systeðŸ”µ</abbr></span>
<span class="858209187721340375" onmouseenter="enter('858209187721340375');" onmouseout="out('858209187721340375');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 194                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItem[0]).getName()));"> 194                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199     /**                                                                                                  </span>
<span class="-2109755167911965892" onmouseenter="enter('-2109755167911965892');" onmouseout="out('-2109755167911965892');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200      * @deprecated Please use `excludeFromCopyRegexPattern()`                                            </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201      * @param copy Copy object                                                                           </span>
<span class="-3117498416103589290" onmouseenter="enter('-3117498416103589290');" onmouseout="out('-3117498416103589290');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202      * @return excluded or not in Regex                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204     @Deprecated                                                                                          </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205     protected Boolean excludeFromCopyRegex(final Object copy) {                                          </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206         boolean match = false;                                                                           </span>
<span class="6056842869149907005" onmouseenter="enter('6056842869149907005');" onmouseout="out('6056842869149907005');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207         if (this.classExcludeRegexPatternList.isEmpty()) {                                               </span>
<span class="2905094200958410231" onmouseenter="enter('2905094200958410231');" onmouseout="out('2905094200958410231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208             LOG.warn(&quot;classExcludeRegexPatternList is empty, deprecated classExcludeRegexList is used&quot;); </span>
<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209             for (Matcher regex : this.classExcludeRegexList) {                                           </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                 if (regex.reset(copy.getClass().toString()).matches()) {                                 </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                     match = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215         } else {                                                                                         </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216            match = this.excludeFromCopyRegexPattern(copy);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221     /**                                                                                                  </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 222 =======                                                                                                  </span>
<span class="-2109755167911965892" onmouseenter="enter('-2109755167911965892');" onmouseout="out('-2109755167911965892');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223      * @deprecated Please use `excludeFromCopyRegexPattern()`                                            </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224      * @param copy Copy object                                                                           </span>
<span class="-3117498416103589290" onmouseenter="enter('-3117498416103589290');" onmouseout="out('-3117498416103589290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225      * @return excluded or not in Regex                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227     @Deprecated                                                                                          </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228     protected Boolean excludeFromCopyRegex(final Object copy) {                                          </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229         boolean match = false;                                                                           </span>
<span class="1887246492796491771" onmouseenter="enter('1887246492796491771');" onmouseout="out('1887246492796491771');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 230         if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.classExcludeRegexList.isEmpty()) {"> 230         if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.clasðŸ”µ</abbr></span>
<span class="-2273049754217814272" onmouseenter="enter('-2273049754217814272');" onmouseout="out('-2273049754217814272');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231             LOG.warn(&quot;classExcludeRegexList is deprecated, please use excludeFromCopyRegexPattern&quot;);     </span>
<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232             for (Matcher regex : this.classExcludeRegexList) {                                           </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233                 if (regex.reset(copy.getClass().toString()).matches()) {                                 </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234                     match = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238         } else {                                                                                         </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239            match = this.excludeFromCopyRegexPattern(copy);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244     /**                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 245 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 246      *                                                                                                   </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 247      * @param copy Copy object                                                                           </span>
<span class="-794768860455465512" onmouseenter="enter('-794768860455465512');" onmouseout="out('-794768860455465512');" style=""> 248      * @return excluded or not in patterns                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 249      */                                                                                                  </span>
<span class="6972780348503080990" onmouseenter="enter('6972780348503080990');" onmouseout="out('6972780348503080990');" style=""> 250     protected Boolean excludeFromCopyRegexPattern(final Object copy) {                                   </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 251         boolean match = false;                                                                           </span>
<span class="-3926064167940700035" onmouseenter="enter('-3926064167940700035');" onmouseout="out('-3926064167940700035');" style=""> 252         for (final Pattern pattern : this.classExcludeRegexPatternList) {                                </span>
<span class="6367080919039942315" onmouseenter="enter('6367080919039942315');" onmouseout="out('6367080919039942315');" style=""> 253             final Matcher matcher = pattern.matcher(copy.getClass().toString());                         </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 254             if (matcher.matches()) {                                                                     </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 255                 match = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 256                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 259         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260     }                                                                                                    </span>
<span  style=""> 261                                                                                                          </span>
<span class="-8032468969933703819" onmouseenter="enter('-8032468969933703819');" onmouseout="out('-8032468969933703819');" style=""> 262     protected void persistNode(final Object copy, final MultiTenantCopyContext context) {                </span>
<span class="7987568954533399833" onmouseenter="enter('7987568954533399833');" onmouseout="out('7987568954533399833');" style=""> 263         if (!genericEntityService.sessionContains(copy) &amp;&amp; !genericEntityService.idAssigned(copy)) {     </span>
<span class="8681842502075417653" onmouseenter="enter('8681842502075417653');" onmouseout="out('8681842502075417653');" style=""><abbr title=" 264             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.removeOriginalIdentifier(copy));"> 264             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), conðŸ”µ</abbr></span>
<span class="-5090759614318459505" onmouseenter="enter('-5090759614318459505');" onmouseout="out('-5090759614318459505');" style=""> 265             extensionManager.getProxy().transformCopy(context, original, copy);                          </span>
<span class="4297838893803910408" onmouseenter="enter('4297838893803910408');" onmouseout="out('4297838893803910408');" style=""> 266             extensionManager.getProxy().prepareForSave(context, original, copy);                         </span>
<span  style=""> 267                                                                                                          </span>
<span class="-8752421726777980004" onmouseenter="enter('-8752421726777980004');" onmouseout="out('-8752421726777980004');" style=""><abbr title=" 268             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;() {"> 268             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 269                 @Override                                                                                </span>
<span class="-8659131798736023396" onmouseenter="enter('-8659131798736023396');" onmouseout="out('-8659131798736023396');" style=""> 270                 public Void execute() {                                                                  </span>
<span class="-9045674711737912799" onmouseenter="enter('-9045674711737912799');" onmouseout="out('-9045674711737912799');" style=""> 271                     genericEntityService.persist(copy);                                                  </span>
<span class="2025772996566147876" onmouseenter="enter('2025772996566147876');" onmouseout="out('2025772996566147876');" style=""> 272                     extensionManager.getProxy().postSave(context, original, copy);                       </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 273                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274                 }                                                                                        </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 275             }, context.getToSite(), context.getToSite(), context.getToCatalog());                        </span>
<span  style=""> 276                                                                                                          </span>
<span class="-7681066818147012496" onmouseenter="enter('-7681066818147012496');" onmouseout="out('-7681066818147012496');" style=""><abbr title=" 277             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), context.getIdentifier(copy));"> 277             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original)ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 281     /**                                                                                                  </span>
<span class="-8073168593296919506" onmouseenter="enter('-8073168593296919506');" onmouseout="out('-8073168593296919506');" style=""><abbr title=" 282      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementation."> 282      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 283      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 284      * @param clazz                                                                                      </span>
<span class="3646661620596311758" onmouseenter="enter('3646661620596311758');" onmouseout="out('3646661620596311758');" style=""> 285      * @param fromSite                                                                                   </span>
<span class="8125408689844361908" onmouseenter="enter('8125408689844361908');" onmouseout="out('8125408689844361908');" style=""> 286      * @param fromCatalog                                                                                </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 287      * @param context                                                                                    </span>
<span class="5977767735151043102" onmouseenter="enter('5977767735151043102');" onmouseout="out('5977767735151043102');" style=""> 288      * @param &lt;T&gt;                                                                                        </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 289      * @throws ServiceException                                                                          </span>
<span class="-2651377028902862562" onmouseenter="enter('-2651377028902862562');" onmouseout="out('-2651377028902862562');" style=""> 290      * @throws CloneNotSupportedException                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 291      */                                                                                                  </span>
<span class="872769015085653006" onmouseenter="enter('872769015085653006');" onmouseout="out('872769015085653006');" style=""><abbr title=" 292     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, final Catalog fromCatalog, final MultiTenantCopyContext context)"> 292     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fðŸ”µ</abbr></span>
<span class="8092245223016329648" onmouseenter="enter('8092245223016329648');" onmouseout="out('8092245223016329648');" style=""> 293             throws ServiceException, CloneNotSupportedException {                                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 294         genericEntityService.flush();                                                                    </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 295         genericEntityService.clear();                                                                    </span>
<span class="6078548138955406640" onmouseenter="enter('6078548138955406640');" onmouseout="out('6078548138955406640');" style=""> 296         transUtil.runStreamingTransactionalOperation(new StreamCapableTransactionalOperationAdapter() {  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 297             @Override                                                                                    </span>
<span class="-4097688009913453744" onmouseenter="enter('-4097688009913453744');" onmouseout="out('-4097688009913453744');" style=""> 298             public Object[] retrievePage(int startPos, int pageSize) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 299                 try {                                                                                    </span>
<span class="-6654678464986381896" onmouseenter="enter('-6654678464986381896');" onmouseout="out('-6654678464986381896');" style=""> 300                     Object[] temp = new Object[1];                                                       </span>
<span class="-1074208970495142702" onmouseenter="enter('-1074208970495142702');" onmouseout="out('-1074208970495142702');" style=""> 301                     List&lt;T&gt; results = readAll(clazz, pageSize, startPos, fromSite, fromCatalog);         </span>
<span class="2620576066975874715" onmouseenter="enter('2620576066975874715');" onmouseout="out('2620576066975874715');" style=""> 302                     temp[0] = results;                                                                   </span>
<span class="-3847030593865588422" onmouseenter="enter('-3847030593865588422');" onmouseout="out('-3847030593865588422');" style=""> 303                     return temp;                                                                         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 304                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 305                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307             }                                                                                            </span>
<span  style=""> 308                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 309             @Override                                                                                    </span>
<span class="6279129438695530603" onmouseenter="enter('6279129438695530603');" onmouseout="out('6279129438695530603');" style=""> 310             public void pagedExecute(Object[] param) throws Throwable {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 311                 try {                                                                                    </span>
<span class="2324184862033110442" onmouseenter="enter('2324184862033110442');" onmouseout="out('2324184862033110442');" style=""> 312                     List&lt;T&gt; results = (List&lt;T&gt;) param[0];                                                </span>
<span class="-7383605119906788487" onmouseenter="enter('-7383605119906788487');" onmouseout="out('-7383605119906788487');" style=""> 313                     for (T result : results) {                                                           </span>
<span class="-2673391330205902743" onmouseenter="enter('-2673391330205902743');" onmouseout="out('-2673391330205902743');" style=""> 314                         persistCopyObjectTree(new CopyOperation&lt;T, CloneNotSupportedException&gt;() {       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 315                             @Override                                                                    </span>
<span class="-8939809480293479644" onmouseenter="enter('-8939809480293479644');" onmouseout="out('-8939809480293479644');" style=""> 316                             public T execute(T original) throws CloneNotSupportedException {             </span>
<span class="-5091972823585019460" onmouseenter="enter('-5091972823585019460');" onmouseout="out('-5091972823585019460');" style=""> 317                                 return (T) original.createOrRetrieveCopyInstance(context).getClone();    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318                             }                                                                            </span>
<span class="3899565736356446794" onmouseenter="enter('3899565736356446794');" onmouseout="out('3899565736356446794');" style=""> 319                         }, clazz, result, context);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 321                 } finally {                                                                              </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 322                     genericEntityService.clear();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324             }                                                                                            </span>
<span  style=""> 325                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 326             @Override                                                                                    </span>
<span class="-2604993651595386294" onmouseenter="enter('-2604993651595386294');" onmouseout="out('-2604993651595386294');" style=""> 327             public Long retrieveTotalCount() {                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 328                 try {                                                                                    </span>
<span class="6601113330436234291" onmouseenter="enter('6601113330436234291');" onmouseout="out('6601113330436234291');" style=""> 329                     return readCount(clazz, fromSite, fromCatalog);                                      </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 330                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 331                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333             }                                                                                            </span>
<span  style=""> 334                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 335             @Override                                                                                    </span>
<span class="1336357167460974281" onmouseenter="enter('1336357167460974281');" onmouseout="out('1336357167460974281');" style=""> 336             public boolean shouldRetryOnTransactionLockAcquisitionFailure() {                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 337                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338             }                                                                                            </span>
<span class="-3417072119495989863" onmouseenter="enter('-3417072119495989863');" onmouseout="out('-3417072119495989863');" style=""> 339         }, RuntimeException.class);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340     }                                                                                                    </span>
<span  style=""> 341                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 342     /**                                                                                                  </span>
<span class="-8433738365892647070" onmouseenter="enter('-8433738365892647070');" onmouseout="out('-8433738365892647070');" style=""> 343      * Saves the specified object in the toSite and toCatalog of the given context.                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 344      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 345      * @param context                                                                                    </span>
<span class="7689578750101732801" onmouseenter="enter('7689578750101732801');" onmouseout="out('7689578750101732801');" style=""> 346      * @param object                                                                                     </span>
<span class="6893734882299737905" onmouseenter="enter('6893734882299737905');" onmouseout="out('6893734882299737905');" style=""> 347      * @return the saved entity                                                                          </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 348      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 349      */                                                                                                  </span>
<span class="5212394141372864718" onmouseenter="enter('5212394141372864718');" onmouseout="out('5212394141372864718');" style=""> 350     protected &lt;T&gt; T save(MultiTenantCopyContext context, final T object) throws ServiceException {       </span>
<span class="-1099504713577842018" onmouseenter="enter('-1099504713577842018');" onmouseout="out('-1099504713577842018');" style=""><abbr title=" 351         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;() {"> 351         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 352             @Override                                                                                    </span>
<span class="4151681128977710489" onmouseenter="enter('4151681128977710489');" onmouseout="out('4151681128977710489');" style=""> 353             public T execute() throws ServiceException {                                                 </span>
<span class="-380270513562060751" onmouseenter="enter('-380270513562060751');" onmouseout="out('-380270513562060751');" style=""> 354                 return genericEntityService.save(object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355             }                                                                                            </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 356         }, context.getToSite(), context.getToSite(), context.getToCatalog());                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 359     /**                                                                                                  </span>
<span class="-7601540533988835340" onmouseenter="enter('-7601540533988835340');" onmouseout="out('-7601540533988835340');" style=""> 360      * Returns the count of the given entity class for the specified site and catalog                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 361      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 362      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 363      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 364      * @param catalog                                                                                    </span>
<span class="-3150840522218520736" onmouseenter="enter('-3150840522218520736');" onmouseout="out('-3150840522218520736');" style=""> 365      * @return the count                                                                                 </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 366      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 367      */                                                                                                  </span>
<span class="-3128834492857774013" onmouseenter="enter('-3128834492857774013');" onmouseout="out('-3128834492857774013');" style=""><abbr title=" 368     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 368     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceExceptioðŸ”µ</abbr></span>
<span class="2183944127153439224" onmouseenter="enter('2183944127153439224');" onmouseout="out('2183944127153439224');" style=""><abbr title=" 369         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceException&gt;() {"> 369         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceExceptiðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 370             @Override                                                                                    </span>
<span class="3590332160508681130" onmouseenter="enter('3590332160508681130');" onmouseout="out('3590332160508681130');" style=""> 371             public Long execute() throws ServiceException {                                              </span>
<span class="-8909345086268725459" onmouseenter="enter('-8909345086268725459');" onmouseout="out('-8909345086268725459');" style=""> 372                 return genericEntityService.readCountGenericEntity(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 374         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375     }                                                                                                    </span>
<span  style=""> 376                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 377     /**                                                                                                  </span>
<span class="-8874952311237548171" onmouseenter="enter('-8874952311237548171');" onmouseout="out('-8874952311237548171');" style=""> 378      * @see #readAll(Class, int, int, Site, Catalog)                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 379      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 380      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 381      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 382      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 383      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 384      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 385      */                                                                                                  </span>
<span class="-2591408295637802722" onmouseenter="enter('-2591408295637802722');" onmouseout="out('-2591408295637802722');" style=""> 386     protected &lt;T&gt; List&lt;T&gt; readAll(Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {  </span>
<span class="6989523363313544241" onmouseenter="enter('6989523363313544241');" onmouseout="out('6989523363313544241');" style=""> 387         return readAll(clazz, Integer.MAX_VALUE, 0, site, catalog);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388     }                                                                                                    </span>
<span  style=""> 389                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 390     /**                                                                                                  </span>
<span class="-7182426246277913548" onmouseenter="enter('-7182426246277913548');" onmouseout="out('-7182426246277913548');" style=""> 391      * Returns the primary key values for all entities of the specified type in the site or catalog.     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 392      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 393      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 394      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 395      * @param catalog                                                                                    </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 396      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 397      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 398      */                                                                                                  </span>
<span class="5724457752579000562" onmouseenter="enter('5724457752579000562');" onmouseout="out('5724457752579000562');" style=""><abbr title=" 399     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 399     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceExcepðŸ”µ</abbr></span>
<span class="1548172976235084004" onmouseenter="enter('1548172976235084004');" onmouseout="out('1548172976235084004');" style=""><abbr title=" 400         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;() {"> 400         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceEðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 401             @Override                                                                                    </span>
<span class="-1864674537507723626" onmouseenter="enter('-1864674537507723626');" onmouseout="out('-1864674537507723626');" style=""> 402             public List&lt;Long&gt; execute() throws ServiceException {                                        </span>
<span class="1470706729559019118" onmouseenter="enter('1470706729559019118');" onmouseout="out('1470706729559019118');" style=""> 403                 return genericEntityService.readAllGenericEntityId(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 405         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406     }                                                                                                    </span>
<span  style=""> 407                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 408     /**                                                                                                  </span>
<span class="-9001665139725221341" onmouseenter="enter('-9001665139725221341');" onmouseout="out('-9001665139725221341');" style=""> 409      * Returns a list of all entities in the system for the given class, site, and catalog. Additionally,</span>
<span class="8612534793136264631" onmouseenter="enter('8612534793136264631');" onmouseout="out('8612534793136264631');" style=""> 410      * this method supports pagination.                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 411      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 412      * @param clazz                                                                                      </span>
<span class="-2517112653327253967" onmouseenter="enter('-2517112653327253967');" onmouseout="out('-2517112653327253967');" style=""> 413      * @param limit                                                                                      </span>
<span class="-1129619468702068661" onmouseenter="enter('-1129619468702068661');" onmouseout="out('-1129619468702068661');" style=""> 414      * @param offset                                                                                     </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 415      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 416      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 417      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 418      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 419      */                                                                                                  </span>
<span class="3970621926802578022" onmouseenter="enter('3970621926802578022');" onmouseout="out('3970621926802578022');" style=""> 420     protected &lt;T&gt; List&lt;T&gt; readAll(final Class&lt;T&gt; clazz, final int limit, final int offset, Site site,    </span>
<span class="-1250257878122023702" onmouseenter="enter('-1250257878122023702');" onmouseout="out('-1250257878122023702');" style=""> 421             Catalog catalog) throws ServiceException {                                                   </span>
<span class="466374425591711697" onmouseenter="enter('466374425591711697');" onmouseout="out('466374425591711697');" style=""><abbr title=" 422         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() {"> 422         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceExceðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 423             @Override                                                                                    </span>
<span class="2544604179721060437" onmouseenter="enter('2544604179721060437');" onmouseout="out('2544604179721060437');" style=""> 424             public List&lt;T&gt; execute() throws ServiceException {                                           </span>
<span class="-7182433549032782374" onmouseenter="enter('-7182433549032782374');" onmouseout="out('-7182433549032782374');" style=""> 425                 return genericEntityService.readAllGenericEntity(clazz, limit, offset);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 427         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428     }                                                                                                    </span>
<span  style=""> 429                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 430     /**                                                                                                  </span>
<span class="-2791201834401909051" onmouseenter="enter('-2791201834401909051');" onmouseout="out('-2791201834401909051');" style=""> 431      * Checks for similar items before adding to avoid duplication                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 432      *                                                                                                   </span>
<span class="-3657783928704768726" onmouseenter="enter('-3657783928704768726');" onmouseout="out('-3657783928704768726');" style=""> 433      * @param pattern input pattern                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 434      */                                                                                                  </span>
<span class="-4846906708761894704" onmouseenter="enter('-4846906708761894704');" onmouseout="out('-4846906708761894704');" style=""> 435     protected void addPattern(final Pattern pattern) {                                                   </span>
<span class="5859550306873716729" onmouseenter="enter('5859550306873716729');" onmouseout="out('5859550306873716729');" style=""> 436         if (this.needToAdd(pattern)) {                                                                   </span>
<span class="4416844535423030775" onmouseenter="enter('4416844535423030775');" onmouseout="out('4416844535423030775');" style=""> 437             this.classExcludeRegexPatternList.add(pattern);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439     }                                                                                                    </span>
<span  style=""> 440                                                                                                          </span>
<span class="-7848998461890921050" onmouseenter="enter('-7848998461890921050');" onmouseout="out('-7848998461890921050');" style=""> 441     protected boolean needToAdd(final Pattern pattern) {                                                 </span>
<span class="-6062616619578034043" onmouseenter="enter('-6062616619578034043');" onmouseout="out('-6062616619578034043');" style=""> 442         boolean exist = false;                                                                           </span>
<span class="5993689843013964459" onmouseenter="enter('5993689843013964459');" onmouseout="out('5993689843013964459');" style=""> 443         for (Pattern item : this.classExcludeRegexPatternList) {                                         </span>
<span class="-2198741654006431688" onmouseenter="enter('-2198741654006431688');" onmouseout="out('-2198741654006431688');" style=""> 444             if (item.pattern().equals(pattern.pattern())) {                                              </span>
<span class="-4447673499306073413" onmouseenter="enter('-4447673499306073413');" onmouseout="out('-4447673499306073413');" style=""> 445                 exist = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 446                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448         }                                                                                                </span>
<span class="-2598905690734194618" onmouseenter="enter('-2598905690734194618');" onmouseout="out('-2598905690734194618');" style=""> 449         return !exist;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450     }                                                                                                    </span>
<span  style=""> 451                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-4573490878212285276" onmouseenter="enter('-4573490878212285276');" onmouseout="out('-4573490878212285276');" style="">   3  * BroadleafCommerce Common Libraries                                                                    </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-1160938633668984164" onmouseenter="enter('-1160938633668984164');" onmouseout="out('-1160938633668984164');" style="">  18 package org.broadleafcommerce.common.copy;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  20 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  21 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="-9066890226896155571" onmouseenter="enter('-9066890226896155571');" onmouseout="out('-9066890226896155571');" style="">  22 import org.broadleafcommerce.common.exception.ExceptionHelper;                                           </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  23 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="4081669836921876898" onmouseenter="enter('4081669836921876898');" onmouseout="out('4081669836921876898');" style="">  24 import org.broadleafcommerce.common.sandbox.domain.SandBox;                                              </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  25 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="-4286566313930798693" onmouseenter="enter('-4286566313930798693');" onmouseout="out('-4286566313930798693');" style="">  26 import org.broadleafcommerce.common.site.domain.Catalog;                                                 </span>
<span class="3350833871385260454" onmouseenter="enter('3350833871385260454');" onmouseout="out('3350833871385260454');" style="">  27 import org.broadleafcommerce.common.site.domain.Site;                                                    </span>
<span class="5712948414688687719" onmouseenter="enter('5712948414688687719');" onmouseout="out('5712948414688687719');" style="">  28 import org.broadleafcommerce.common.util.StreamCapableTransactionalOperationAdapter;                     </span>
<span class="3798869978454175791" onmouseenter="enter('3798869978454175791');" onmouseout="out('3798869978454175791');" style="">  29 import org.broadleafcommerce.common.util.StreamingTransactionCapableUtil;                                </span>
<span class="5413521702958049593" onmouseenter="enter('5413521702958049593');" onmouseout="out('5413521702958049593');" style="">  30 import org.broadleafcommerce.common.util.tenant.IdentityExecutionUtils;                                  </span>
<span class="2334451492079531669" onmouseenter="enter('2334451492079531669');" onmouseout="out('2334451492079531669');" style="">  31 import org.broadleafcommerce.common.util.tenant.IdentityOperation;                                       </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  32 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="2584309252308847990" onmouseenter="enter('2584309252308847990');" onmouseout="out('2584309252308847990');" style="">  33 import org.broadleafcommerce.common.web.DeployState;                                                     </span>
<span class="6105195614559590838" onmouseenter="enter('6105195614559590838');" onmouseout="out('6105195614559590838');" style="">  34 import org.broadleafcommerce.common.web.EnforceEnterpriseCollectionBehaviorState;                        </span>
<span class="-5036922012441036669" onmouseenter="enter('-5036922012441036669');" onmouseout="out('-5036922012441036669');" style="">  35 import org.springframework.core.Ordered;                                                                 </span>
<span  style="">  36                                                                                                          </span>
<span class="507320133330553151" onmouseenter="enter('507320133330553151');" onmouseout="out('507320133330553151');" style="">  37 import java.lang.reflect.Field;                                                                          </span>
<span class="1546464639948964552" onmouseenter="enter('1546464639948964552');" onmouseout="out('1546464639948964552');" style="">  38 import java.lang.reflect.Modifier;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  39 import java.util.ArrayList;                                                                              </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  40 import java.util.Collection;                                                                             </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  43 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  44 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  45 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  46 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  48 import javax.annotation.Resource;                                                                        </span>
<span class="5429236160528371227" onmouseenter="enter('5429236160528371227');" onmouseout="out('5429236160528371227');" style="">  49 import javax.persistence.Embeddable;                                                                     </span>
<span class="634040011956091835" onmouseenter="enter('634040011956091835');" onmouseout="out('634040011956091835');" style="">  50 import javax.persistence.ManyToMany;                                                                     </span>
<span class="-2638882474121018940" onmouseenter="enter('-2638882474121018940');" onmouseout="out('-2638882474121018940');" style="">  51 import javax.persistence.ManyToOne;                                                                      </span>
<span class="4490236759922497400" onmouseenter="enter('4490236759922497400');" onmouseout="out('4490236759922497400');" style="">  52 import javax.persistence.OneToMany;                                                                      </span>
<span class="-1278149683069486932" onmouseenter="enter('-1278149683069486932');" onmouseout="out('-1278149683069486932');" style="">  53 import javax.persistence.OneToOne;                                                                       </span>
<span  style="">  54                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="-8041280944155159385" onmouseenter="enter('-8041280944155159385');" onmouseout="out('-8041280944155159385');" style=""><abbr title="  56  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. Subclasses generally">  56  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. SðŸ”µ</abbr></span>
<span class="-627018466353991606" onmouseenter="enter('-627018466353991606');" onmouseout="out('-627018466353991606');" style=""><abbr title="  57  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.common.site.domain.Catalog, MultiTenantCopyContext)}">  57  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcomðŸ”µ</abbr></span>
<span class="-416790415154158937" onmouseenter="enter('-416790415154158937');" onmouseout="out('-416790415154158937');" style=""><abbr title="  58  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and persist">  58  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clonðŸ”µ</abbr></span>
<span class="5445624896446749929" onmouseenter="enter('5445624896446749929');" onmouseout="out('5445624896446749929');" style="">  59  * an entity object tree.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  60  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style="">  61  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style="">  62  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63  */                                                                                                      </span>
<span class="-1737666508653679295" onmouseenter="enter('-1737666508653679295');" onmouseout="out('-1737666508653679295');" style="">  64 public abstract class MultiTenantCopier implements Ordered {                                             </span>
<span class="7878007665356847965" onmouseenter="enter('7878007665356847965');" onmouseout="out('7878007665356847965');" style="">  65     protected static final Log LOG = LogFactory.getLog(MultiTenantCopier.class);                         </span>
<span  style="">  66                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="">  67     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="">  68     protected GenericEntityService genericEntityService;                                                 </span>
<span  style="">  69                                                                                                          </span>
<span class="-4045496854230922802" onmouseenter="enter('-4045496854230922802');" onmouseout="out('-4045496854230922802');" style="">  70     @Resource(name = &quot;blMultiTenantCopierExtensionManager&quot;)                                              </span>
<span class="9132557441157356873" onmouseenter="enter('9132557441157356873');" onmouseout="out('9132557441157356873');" style="">  71     protected MultiTenantCopierExtensionManager extensionManager;                                        </span>
<span  style="">  72                                                                                                          </span>
<span class="6302352000387574659" onmouseenter="enter('6302352000387574659');" onmouseout="out('6302352000387574659');" style="">  73     @Resource(name=&quot;blStreamingTransactionCapableUtil&quot;)                                                  </span>
<span class="-8080662791692885473" onmouseenter="enter('-8080662791692885473');" onmouseout="out('-8080662791692885473');" style="">  74     protected StreamingTransactionCapableUtil transUtil;                                                 </span>
<span  style="">  75                                                                                                          </span>
<span class="3478346643346744503" onmouseenter="enter('3478346643346744503');" onmouseout="out('3478346643346744503');" style="">  76     protected int order = 0;                                                                             </span>
<span  style="">  77                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  78     /**                                                                                                  </span>
<span class="-122049322422344857" onmouseenter="enter('-122049322422344857');" onmouseout="out('-122049322422344857');" style="">  79      * To add elements use {@link #addPattern(Pattern)}                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80      */                                                                                                  </span>
<span class="-4573832410677620492" onmouseenter="enter('-4573832410677620492');" onmouseout="out('-4573832410677620492');" style="">  81     protected List&lt;Pattern&gt; classExcludeRegexPatternList = new ArrayList&lt;&gt;();                            </span>
<span  style="">  82                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83     /**                                                                                                  </span>
<span class="2044942771211883310" onmouseenter="enter('2044942771211883310');" onmouseout="out('2044942771211883310');" style="">  84      * Main method that should be implemented by each {@link MultiTenantCopier} to drive the logic of    </span>
<span class="3580574424461635495" onmouseenter="enter('3580574424461635495');" onmouseout="out('3580574424461635495');" style="">  85      * copying that particular entity to the new derived catalog.                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  86      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="">  87      * @param context                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  88      */                                                                                                  </span>
<span class="-6235588905422461924" onmouseenter="enter('-6235588905422461924');" onmouseout="out('-6235588905422461924');" style="">  89     public abstract void copyEntities(MultiTenantCopyContext context) throws Exception;                  </span>
<span  style="">  90                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  91     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  92      *                                                                                                   </span>
<span class="2985577248159931846" onmouseenter="enter('2985577248159931846');" onmouseout="out('2985577248159931846');" style="">  93      * @return the order of this {@link MultiTenantCopier}                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  95     @Override                                                                                            </span>
<span class="-1157866401688879802" onmouseenter="enter('-1157866401688879802');" onmouseout="out('-1157866401688879802');" style="">  96     public int getOrder() {                                                                              </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style="">  97         return order;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98     }                                                                                                    </span>
<span  style="">  99                                                                                                          </span>
<span class="8078611052580382973" onmouseenter="enter('8078611052580382973');" onmouseout="out('8078611052580382973');" style=""> 100     public void setOrder(int order) {                                                                    </span>
<span class="-6754869500416241760" onmouseenter="enter('-6754869500416241760');" onmouseout="out('-6754869500416241760');" style=""> 101         this.order = order;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102     }                                                                                                    </span>
<span  style=""> 103                                                                                                          </span>
<span class="-3615357639229759469" onmouseenter="enter('-3615357639229759469');" onmouseout="out('-3615357639229759469');" style=""><abbr title=" 104     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazz, T original, MultiTenantCopyContext context) throws G {"> 104     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, ClassðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 105         try {                                                                                            </span>
<span class="8848439591475072064" onmouseenter="enter('8848439591475072064');" onmouseout="out('8848439591475072064');" style=""> 106             //don&#x27;t persist if there is already an equivalent present                                    </span>
<span class="-3623402225573308912" onmouseenter="enter('-3623402225573308912');" onmouseout="out('-3623402225573308912');" style=""><abbr title=" 107             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) != null) {"> 107             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) !=ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 108                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109             }                                                                                            </span>
<span  style=""> 110                                                                                                          </span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 111             context.clearOriginalIdentifiers();                                                          </span>
<span class="-4760173204145292260" onmouseenter="enter('-4760173204145292260');" onmouseout="out('-4760173204145292260');" style=""> 112             genericEntityService.clearAutoFlushMode();                                                   </span>
<span class="-8326881612018417764" onmouseenter="enter('-8326881612018417764');" onmouseout="out('-8326881612018417764');" style=""> 113             Object copy = copyOperation.execute(original);                                               </span>
<span class="3128798615968492125" onmouseenter="enter('3128798615968492125');" onmouseout="out('3128798615968492125');" style=""> 114             SandBox sandBox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();         </span>
<span class="6492445518569294809" onmouseenter="enter('6492445518569294809');" onmouseout="out('6492445518569294809');" style=""><abbr title=" 115             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployState();"> 115             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployStateðŸ”µ</abbr></span>
<span class="2163142151434548972" onmouseenter="enter('2163142151434548972');" onmouseout="out('2163142151434548972');" style=""> 116             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(DeployState.PRODUCTION); </span>
<span class="6572079192165011753" onmouseenter="enter('6572079192165011753');" onmouseout="out('6572079192165011753');" style=""> 117             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(null);                       </span>
<span class="-6104353510353355986" onmouseenter="enter('-6104353510353355986');" onmouseout="out('-6104353510353355986');" style=""><abbr title=" 118             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.FALSE);"> 118             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-2148155577856476410" onmouseenter="enter('-2148155577856476410');" onmouseout="out('-2148155577856476410');" style=""> 119             persistCopyObjectTreeInternal(copy, new HashSet&lt;Integer&gt;(), context);                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 120             genericEntityService.flush();                                                                </span>
<span class="1952764089697360447" onmouseenter="enter('1952764089697360447');" onmouseout="out('1952764089697360447');" style=""> 121             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(sandBox);                    </span>
<span class="2444831964480057831" onmouseenter="enter('2444831964480057831');" onmouseout="out('2444831964480057831');" style=""> 122             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(deployState);            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 123         } catch (Exception e) {                                                                          </span>
<span class="3675438560154002673" onmouseenter="enter('3675438560154002673');" onmouseout="out('3675438560154002673');" style=""> 124             LOG.error(&quot;Unable to persist the copy object tree&quot;, e);                                      </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 125             throw ExceptionHelper.refineException(e);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 126         } finally {                                                                                      </span>
<span class="7199875090489075677" onmouseenter="enter('7199875090489075677');" onmouseout="out('7199875090489075677');" style=""><abbr title=" 127             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.TRUE);"> 127             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 128             context.clearOriginalIdentifiers();                                                          </span>
<span class="-5390342410291425165" onmouseenter="enter('-5390342410291425165');" onmouseout="out('-5390342410291425165');" style=""> 129             genericEntityService.enableAutoFlushMode();                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="813863986067248403" onmouseenter="enter('813863986067248403');" onmouseout="out('813863986067248403');" style=""><abbr title=" 133     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext context) {"> 133     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContexðŸ”µ</abbr></span>
<span class="5726455157241988222" onmouseenter="enter('5726455157241988222');" onmouseout="out('5726455157241988222');" style=""> 134         if (library.contains(System.identityHashCode(copy)) || !(copy instanceof MultiTenantCloneable)   </span>
<span class="-6757188153093146979" onmouseenter="enter('-6757188153093146979');" onmouseout="out('-6757188153093146979');" style=""> 135                 || this.excludeFromCopyRegexPattern(copy)) {                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 136             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="6099587390698254391" onmouseenter="enter('6099587390698254391');" onmouseout="out('6099587390698254391');" style=""> 138         library.add(System.identityHashCode(copy));                                                      </span>
<span class="-4798752894315625699" onmouseenter="enter('-4798752894315625699');" onmouseout="out('-4798752894315625699');" style=""> 139         List&lt;Object[]&gt; collections = new ArrayList&lt;Object[]&gt;();                                          </span>
<span class="1437989156315370335" onmouseenter="enter('1437989156315370335');" onmouseout="out('1437989156315370335');" style=""> 140         Field[] allFields = context.getAllFields(copy.getClass());                                       </span>
<span class="2968462139034023970" onmouseenter="enter('2968462139034023970');" onmouseout="out('2968462139034023970');" style=""> 141         for (Field field : allFields) {                                                                  </span>
<span class="-6028825997928669487" onmouseenter="enter('-6028825997928669487');" onmouseout="out('-6028825997928669487');" style=""> 142             if (field.getName().equals(&quot;embeddableSiteDiscriminator&quot;)) {                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 143                 continue;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144             }                                                                                            </span>
<span class="2215334239672037801" onmouseenter="enter('2215334239672037801');" onmouseout="out('2215334239672037801');" style=""> 145             if (!Modifier.isStatic(field.getModifiers())) {                                              </span>
<span class="-242302875073644057" onmouseenter="enter('-242302875073644057');" onmouseout="out('-242302875073644057');" style=""> 146                 field.setAccessible(true);                                                               </span>
<span class="-3119387060603195319" onmouseenter="enter('-3119387060603195319');" onmouseout="out('-3119387060603195319');" style=""> 147                 Object newTarget;                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 148                 try {                                                                                    </span>
<span class="-1788169810723093055" onmouseenter="enter('-1788169810723093055');" onmouseout="out('-1788169810723093055');" style=""> 149                     newTarget = field.get(copy);                                                         </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style=""> 150                 } catch (IllegalAccessException e) {                                                     </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 151                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152                 }                                                                                        </span>
<span class="5292471581137077546" onmouseenter="enter('5292471581137077546');" onmouseout="out('5292471581137077546');" style=""> 153                 if (newTarget != null) {                                                                 </span>
<span class="-4896034365120653328" onmouseenter="enter('-4896034365120653328');" onmouseout="out('-4896034365120653328');" style=""><abbr title=" 154                     if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != null) {"> 154                     if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.clasðŸ”µ</abbr></span>
<span class="-1779560011655050958" onmouseenter="enter('-1779560011655050958');" onmouseout="out('-1779560011655050958');" style=""> 155                         if (library.contains(System.identityHashCode(newTarget))) {                      </span>
<span class="-6882820149046221397" onmouseenter="enter('-6882820149046221397');" onmouseout="out('-6882820149046221397');" style=""> 156                             persistNode(newTarget, context);                                             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 157                             continue;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                         }                                                                                </span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 159                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-6556217836886273986" onmouseenter="enter('-6556217836886273986');" onmouseout="out('-6556217836886273986');" style=""><abbr title=" 160                     } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.class) != null) {"> 160                     } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToðŸ”µ</abbr></span>
<span class="6570005356546170417" onmouseenter="enter('6570005356546170417');" onmouseout="out('6570005356546170417');" style=""> 161                         collections.add(new Object[]{field, newTarget});                                 </span>
<span class="-1287323088547185838" onmouseenter="enter('-1287323088547185838');" onmouseout="out('-1287323088547185838');" style=""><abbr title=" 162                     } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.class.isAssignableFrom(field.getType())) {"> 162                     } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantClonðŸ”µ</abbr></span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 163                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167         }                                                                                                </span>
<span class="5522223281117737932" onmouseenter="enter('5522223281117737932');" onmouseout="out('5522223281117737932');" style=""> 168         if (copy.getClass().getAnnotation(Embeddable.class) == null) {                                   </span>
<span class="8489885264009154572" onmouseenter="enter('8489885264009154572');" onmouseout="out('8489885264009154572');" style=""> 169             persistNode(copy, context);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="7328299556920669788" onmouseenter="enter('7328299556920669788');" onmouseout="out('7328299556920669788');" style=""> 171         for (Object[] collectionItem : collections) {                                                    </span>
<span class="6509881775537642462" onmouseenter="enter('6509881775537642462');" onmouseout="out('6509881775537642462');" style=""> 172             if (collectionItem[1] instanceof Collection) {                                               </span>
<span class="-4625848514609956673" onmouseenter="enter('-4625848514609956673');" onmouseout="out('-4625848514609956673');" style=""> 173                 Collection newCollection = (Collection) collectionItem[1];                               </span>
<span class="2236280788008259197" onmouseenter="enter('2236280788008259197');" onmouseout="out('2236280788008259197');" style=""> 174                 for (Object member : newCollection) {                                                    </span>
<span class="559928666155877213" onmouseenter="enter('559928666155877213');" onmouseout="out('559928666155877213');" style=""> 175                     persistCopyObjectTreeInternal(member, library, context);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176                 }                                                                                        </span>
<span class="-358290731378005197" onmouseenter="enter('-358290731378005197');" onmouseout="out('-358290731378005197');" style=""> 177             } else if (collectionItem[1] instanceof Map) {                                               </span>
<span class="-8530282384745692595" onmouseenter="enter('-8530282384745692595');" onmouseout="out('-8530282384745692595');" style=""> 178                 Map newMap = (Map) collectionItem[1];                                                    </span>
<span class="-3046213999695776442" onmouseenter="enter('-3046213999695776442');" onmouseout="out('-3046213999695776442');" style=""> 179                 for (Object key : newMap.keySet()) {                                                     </span>
<span class="-4861713825562612226" onmouseenter="enter('-4861713825562612226');" onmouseout="out('-4861713825562612226');" style=""> 180                     persistCopyObjectTreeInternal(newMap.get(key), library, context);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 182             } else {                                                                                     </span>
<span class="2428600337084572914" onmouseenter="enter('2428600337084572914');" onmouseout="out('2428600337084572914');" style=""> 183                 throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; +    </span>
<span class="-7690968681915381732" onmouseenter="enter('-7690968681915381732');" onmouseout="out('-7690968681915381732');" style=""><abbr title=" 184                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; +"> 184                         &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The systeðŸ”µ</abbr></span>
<span class="858209187721340375" onmouseenter="enter('858209187721340375');" onmouseout="out('858209187721340375');" style=""><abbr title=" 185                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItem[0]).getName()));"> 185                         &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) colðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 189 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 190 ||||||| BASE                                                                                             </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191 @Deprecated                                                                                              </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192     protected Boolean excludeFromCopyRegex(final Object copy) {                                          </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193         boolean match = false;                                                                           </span>
<span class="6056842869149907005" onmouseenter="enter('6056842869149907005');" onmouseout="out('6056842869149907005');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194         if (this.classExcludeRegexPatternList.isEmpty()) {                                               </span>
<span class="2905094200958410231" onmouseenter="enter('2905094200958410231');" onmouseout="out('2905094200958410231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             LOG.warn(&quot;classExcludeRegexPatternList is empty, deprecated classExcludeRegexList is used&quot;); </span>
<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196             for (Matcher regex : this.classExcludeRegexList) {                                           </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                 if (regex.reset(copy.getClass().toString()).matches()) {                                 </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                     match = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202         } else {                                                                                         </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203            match = this.excludeFromCopyRegexPattern(copy);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 207 =======                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208 @Deprecated                                                                                              </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209     protected Boolean excludeFromCopyRegex(final Object copy) {                                          </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210         boolean match = false;                                                                           </span>
<span class="1887246492796491771" onmouseenter="enter('1887246492796491771');" onmouseout="out('1887246492796491771');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 211         if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.classExcludeRegexList.isEmpty()) {"> 211         if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.clasðŸ”µ</abbr></span>
<span class="-2273049754217814272" onmouseenter="enter('-2273049754217814272');" onmouseout="out('-2273049754217814272');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212             LOG.warn(&quot;classExcludeRegexList is deprecated, please use excludeFromCopyRegexPattern&quot;);     </span>
<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213             for (Matcher regex : this.classExcludeRegexList) {                                           </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214                 if (regex.reset(copy.getClass().toString()).matches()) {                                 </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215                     match = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219         } else {                                                                                         </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220            match = this.excludeFromCopyRegexPattern(copy);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 224 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 225                                                                                                          </span>
<span  style=""> 226                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 227     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 228      *                                                                                                   </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 229      * @param copy Copy object                                                                           </span>
<span class="-794768860455465512" onmouseenter="enter('-794768860455465512');" onmouseout="out('-794768860455465512');" style=""> 230      * @return excluded or not in patterns                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 231      */                                                                                                  </span>
<span class="6972780348503080990" onmouseenter="enter('6972780348503080990');" onmouseout="out('6972780348503080990');" style=""> 232     protected Boolean excludeFromCopyRegexPattern(final Object copy) {                                   </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 233         boolean match = false;                                                                           </span>
<span class="-3926064167940700035" onmouseenter="enter('-3926064167940700035');" onmouseout="out('-3926064167940700035');" style=""> 234         for (final Pattern pattern : this.classExcludeRegexPatternList) {                                </span>
<span class="6367080919039942315" onmouseenter="enter('6367080919039942315');" onmouseout="out('6367080919039942315');" style=""> 235             final Matcher matcher = pattern.matcher(copy.getClass().toString());                         </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 236             if (matcher.matches()) {                                                                     </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 237                 match = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 238                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 241         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span  style=""> 243                                                                                                          </span>
<span class="-8032468969933703819" onmouseenter="enter('-8032468969933703819');" onmouseout="out('-8032468969933703819');" style=""> 244     protected void persistNode(final Object copy, final MultiTenantCopyContext context) {                </span>
<span class="7987568954533399833" onmouseenter="enter('7987568954533399833');" onmouseout="out('7987568954533399833');" style=""> 245         if (!genericEntityService.sessionContains(copy) &amp;&amp; !genericEntityService.idAssigned(copy)) {     </span>
<span class="8681842502075417653" onmouseenter="enter('8681842502075417653');" onmouseout="out('8681842502075417653');" style=""><abbr title=" 246             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.removeOriginalIdentifier(copy));"> 246             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), conðŸ”µ</abbr></span>
<span class="-5090759614318459505" onmouseenter="enter('-5090759614318459505');" onmouseout="out('-5090759614318459505');" style=""> 247             extensionManager.getProxy().transformCopy(context, original, copy);                          </span>
<span class="4297838893803910408" onmouseenter="enter('4297838893803910408');" onmouseout="out('4297838893803910408');" style=""> 248             extensionManager.getProxy().prepareForSave(context, original, copy);                         </span>
<span  style=""> 249                                                                                                          </span>
<span class="-8752421726777980004" onmouseenter="enter('-8752421726777980004');" onmouseout="out('-8752421726777980004');" style=""><abbr title=" 250             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;() {"> 250             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 251                 @Override                                                                                </span>
<span class="-8659131798736023396" onmouseenter="enter('-8659131798736023396');" onmouseout="out('-8659131798736023396');" style=""> 252                 public Void execute() {                                                                  </span>
<span class="-9045674711737912799" onmouseenter="enter('-9045674711737912799');" onmouseout="out('-9045674711737912799');" style=""> 253                     genericEntityService.persist(copy);                                                  </span>
<span class="2025772996566147876" onmouseenter="enter('2025772996566147876');" onmouseout="out('2025772996566147876');" style=""> 254                     extensionManager.getProxy().postSave(context, original, copy);                       </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 255                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256                 }                                                                                        </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 257             }, context.getToSite(), context.getToSite(), context.getToCatalog());                        </span>
<span  style=""> 258                                                                                                          </span>
<span class="-7681066818147012496" onmouseenter="enter('-7681066818147012496');" onmouseout="out('-7681066818147012496');" style=""><abbr title=" 259             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), context.getIdentifier(copy));"> 259             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original)ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261     }                                                                                                    </span>
<span  style=""> 262                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 263     /**                                                                                                  </span>
<span class="-8073168593296919506" onmouseenter="enter('-8073168593296919506');" onmouseout="out('-8073168593296919506');" style=""><abbr title=" 264      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementation."> 264      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 265      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 266      * @param clazz                                                                                      </span>
<span class="3646661620596311758" onmouseenter="enter('3646661620596311758');" onmouseout="out('3646661620596311758');" style=""> 267      * @param fromSite                                                                                   </span>
<span class="8125408689844361908" onmouseenter="enter('8125408689844361908');" onmouseout="out('8125408689844361908');" style=""> 268      * @param fromCatalog                                                                                </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 269      * @param context                                                                                    </span>
<span class="5977767735151043102" onmouseenter="enter('5977767735151043102');" onmouseout="out('5977767735151043102');" style=""> 270      * @param &lt;T&gt;                                                                                        </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 271      * @throws ServiceException                                                                          </span>
<span class="-2651377028902862562" onmouseenter="enter('-2651377028902862562');" onmouseout="out('-2651377028902862562');" style=""> 272      * @throws CloneNotSupportedException                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 273      */                                                                                                  </span>
<span class="872769015085653006" onmouseenter="enter('872769015085653006');" onmouseout="out('872769015085653006');" style=""><abbr title=" 274     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, final Catalog fromCatalog, final MultiTenantCopyContext context)"> 274     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fðŸ”µ</abbr></span>
<span class="8092245223016329648" onmouseenter="enter('8092245223016329648');" onmouseout="out('8092245223016329648');" style=""> 275             throws ServiceException, CloneNotSupportedException {                                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 276         genericEntityService.flush();                                                                    </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 277         genericEntityService.clear();                                                                    </span>
<span class="6078548138955406640" onmouseenter="enter('6078548138955406640');" onmouseout="out('6078548138955406640');" style=""> 278         transUtil.runStreamingTransactionalOperation(new StreamCapableTransactionalOperationAdapter() {  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 279             @Override                                                                                    </span>
<span class="-4097688009913453744" onmouseenter="enter('-4097688009913453744');" onmouseout="out('-4097688009913453744');" style=""> 280             public Object[] retrievePage(int startPos, int pageSize) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 281                 try {                                                                                    </span>
<span class="-6654678464986381896" onmouseenter="enter('-6654678464986381896');" onmouseout="out('-6654678464986381896');" style=""> 282                     Object[] temp = new Object[1];                                                       </span>
<span class="-1074208970495142702" onmouseenter="enter('-1074208970495142702');" onmouseout="out('-1074208970495142702');" style=""> 283                     List&lt;T&gt; results = readAll(clazz, pageSize, startPos, fromSite, fromCatalog);         </span>
<span class="2620576066975874715" onmouseenter="enter('2620576066975874715');" onmouseout="out('2620576066975874715');" style=""> 284                     temp[0] = results;                                                                   </span>
<span class="-3847030593865588422" onmouseenter="enter('-3847030593865588422');" onmouseout="out('-3847030593865588422');" style=""> 285                     return temp;                                                                         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 286                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 287                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289             }                                                                                            </span>
<span  style=""> 290                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 291             @Override                                                                                    </span>
<span class="6279129438695530603" onmouseenter="enter('6279129438695530603');" onmouseout="out('6279129438695530603');" style=""> 292             public void pagedExecute(Object[] param) throws Throwable {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 293                 try {                                                                                    </span>
<span class="2324184862033110442" onmouseenter="enter('2324184862033110442');" onmouseout="out('2324184862033110442');" style=""> 294                     List&lt;T&gt; results = (List&lt;T&gt;) param[0];                                                </span>
<span class="-7383605119906788487" onmouseenter="enter('-7383605119906788487');" onmouseout="out('-7383605119906788487');" style=""> 295                     for (T result : results) {                                                           </span>
<span class="-2673391330205902743" onmouseenter="enter('-2673391330205902743');" onmouseout="out('-2673391330205902743');" style=""> 296                         persistCopyObjectTree(new CopyOperation&lt;T, CloneNotSupportedException&gt;() {       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 297                             @Override                                                                    </span>
<span class="-8939809480293479644" onmouseenter="enter('-8939809480293479644');" onmouseout="out('-8939809480293479644');" style=""> 298                             public T execute(T original) throws CloneNotSupportedException {             </span>
<span class="-5091972823585019460" onmouseenter="enter('-5091972823585019460');" onmouseout="out('-5091972823585019460');" style=""> 299                                 return (T) original.createOrRetrieveCopyInstance(context).getClone();    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300                             }                                                                            </span>
<span class="3899565736356446794" onmouseenter="enter('3899565736356446794');" onmouseout="out('3899565736356446794');" style=""> 301                         }, clazz, result, context);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 303                 } finally {                                                                              </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 304                     genericEntityService.clear();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306             }                                                                                            </span>
<span  style=""> 307                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 308             @Override                                                                                    </span>
<span class="-2604993651595386294" onmouseenter="enter('-2604993651595386294');" onmouseout="out('-2604993651595386294');" style=""> 309             public Long retrieveTotalCount() {                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 310                 try {                                                                                    </span>
<span class="6601113330436234291" onmouseenter="enter('6601113330436234291');" onmouseout="out('6601113330436234291');" style=""> 311                     return readCount(clazz, fromSite, fromCatalog);                                      </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 312                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 313                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span  style=""> 316                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 317             @Override                                                                                    </span>
<span class="1336357167460974281" onmouseenter="enter('1336357167460974281');" onmouseout="out('1336357167460974281');" style=""> 318             public boolean shouldRetryOnTransactionLockAcquisitionFailure() {                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 319                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320             }                                                                                            </span>
<span class="-3417072119495989863" onmouseenter="enter('-3417072119495989863');" onmouseout="out('-3417072119495989863');" style=""> 321         }, RuntimeException.class);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322     }                                                                                                    </span>
<span  style=""> 323                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 324     /**                                                                                                  </span>
<span class="-8433738365892647070" onmouseenter="enter('-8433738365892647070');" onmouseout="out('-8433738365892647070');" style=""> 325      * Saves the specified object in the toSite and toCatalog of the given context.                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 326      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 327      * @param context                                                                                    </span>
<span class="7689578750101732801" onmouseenter="enter('7689578750101732801');" onmouseout="out('7689578750101732801');" style=""> 328      * @param object                                                                                     </span>
<span class="6893734882299737905" onmouseenter="enter('6893734882299737905');" onmouseout="out('6893734882299737905');" style=""> 329      * @return the saved entity                                                                          </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 330      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 331      */                                                                                                  </span>
<span class="5212394141372864718" onmouseenter="enter('5212394141372864718');" onmouseout="out('5212394141372864718');" style=""> 332     protected &lt;T&gt; T save(MultiTenantCopyContext context, final T object) throws ServiceException {       </span>
<span class="-1099504713577842018" onmouseenter="enter('-1099504713577842018');" onmouseout="out('-1099504713577842018');" style=""><abbr title=" 333         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;() {"> 333         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 334             @Override                                                                                    </span>
<span class="4151681128977710489" onmouseenter="enter('4151681128977710489');" onmouseout="out('4151681128977710489');" style=""> 335             public T execute() throws ServiceException {                                                 </span>
<span class="-380270513562060751" onmouseenter="enter('-380270513562060751');" onmouseout="out('-380270513562060751');" style=""> 336                 return genericEntityService.save(object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337             }                                                                                            </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 338         }, context.getToSite(), context.getToSite(), context.getToCatalog());                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339     }                                                                                                    </span>
<span  style=""> 340                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 341     /**                                                                                                  </span>
<span class="-7601540533988835340" onmouseenter="enter('-7601540533988835340');" onmouseout="out('-7601540533988835340');" style=""> 342      * Returns the count of the given entity class for the specified site and catalog                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 343      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 344      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 345      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 346      * @param catalog                                                                                    </span>
<span class="-3150840522218520736" onmouseenter="enter('-3150840522218520736');" onmouseout="out('-3150840522218520736');" style=""> 347      * @return the count                                                                                 </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 348      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 349      */                                                                                                  </span>
<span class="-3128834492857774013" onmouseenter="enter('-3128834492857774013');" onmouseout="out('-3128834492857774013');" style=""><abbr title=" 350     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 350     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceExceptioðŸ”µ</abbr></span>
<span class="2183944127153439224" onmouseenter="enter('2183944127153439224');" onmouseout="out('2183944127153439224');" style=""><abbr title=" 351         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceException&gt;() {"> 351         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceExceptiðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 352             @Override                                                                                    </span>
<span class="3590332160508681130" onmouseenter="enter('3590332160508681130');" onmouseout="out('3590332160508681130');" style=""> 353             public Long execute() throws ServiceException {                                              </span>
<span class="-8909345086268725459" onmouseenter="enter('-8909345086268725459');" onmouseout="out('-8909345086268725459');" style=""> 354                 return genericEntityService.readCountGenericEntity(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 356         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 359     /**                                                                                                  </span>
<span class="-8874952311237548171" onmouseenter="enter('-8874952311237548171');" onmouseout="out('-8874952311237548171');" style=""> 360      * @see #readAll(Class, int, int, Site, Catalog)                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 361      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 362      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 363      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 364      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 365      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 366      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 367      */                                                                                                  </span>
<span class="-2591408295637802722" onmouseenter="enter('-2591408295637802722');" onmouseout="out('-2591408295637802722');" style=""> 368     protected &lt;T&gt; List&lt;T&gt; readAll(Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {  </span>
<span class="6989523363313544241" onmouseenter="enter('6989523363313544241');" onmouseout="out('6989523363313544241');" style=""> 369         return readAll(clazz, Integer.MAX_VALUE, 0, site, catalog);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370     }                                                                                                    </span>
<span  style=""> 371                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 372     /**                                                                                                  </span>
<span class="-7182426246277913548" onmouseenter="enter('-7182426246277913548');" onmouseout="out('-7182426246277913548');" style=""> 373      * Returns the primary key values for all entities of the specified type in the site or catalog.     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 374      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 375      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 376      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 377      * @param catalog                                                                                    </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 378      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 379      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 380      */                                                                                                  </span>
<span class="5724457752579000562" onmouseenter="enter('5724457752579000562');" onmouseout="out('5724457752579000562');" style=""><abbr title=" 381     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 381     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceExcepðŸ”µ</abbr></span>
<span class="1548172976235084004" onmouseenter="enter('1548172976235084004');" onmouseout="out('1548172976235084004');" style=""><abbr title=" 382         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;() {"> 382         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceEðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 383             @Override                                                                                    </span>
<span class="-1864674537507723626" onmouseenter="enter('-1864674537507723626');" onmouseout="out('-1864674537507723626');" style=""> 384             public List&lt;Long&gt; execute() throws ServiceException {                                        </span>
<span class="1470706729559019118" onmouseenter="enter('1470706729559019118');" onmouseout="out('1470706729559019118');" style=""> 385                 return genericEntityService.readAllGenericEntityId(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 387         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388     }                                                                                                    </span>
<span  style=""> 389                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 390     /**                                                                                                  </span>
<span class="-9001665139725221341" onmouseenter="enter('-9001665139725221341');" onmouseout="out('-9001665139725221341');" style=""> 391      * Returns a list of all entities in the system for the given class, site, and catalog. Additionally,</span>
<span class="8612534793136264631" onmouseenter="enter('8612534793136264631');" onmouseout="out('8612534793136264631');" style=""> 392      * this method supports pagination.                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 393      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 394      * @param clazz                                                                                      </span>
<span class="-2517112653327253967" onmouseenter="enter('-2517112653327253967');" onmouseout="out('-2517112653327253967');" style=""> 395      * @param limit                                                                                      </span>
<span class="-1129619468702068661" onmouseenter="enter('-1129619468702068661');" onmouseout="out('-1129619468702068661');" style=""> 396      * @param offset                                                                                     </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 397      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 398      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 399      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 400      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 401      */                                                                                                  </span>
<span class="3970621926802578022" onmouseenter="enter('3970621926802578022');" onmouseout="out('3970621926802578022');" style=""> 402     protected &lt;T&gt; List&lt;T&gt; readAll(final Class&lt;T&gt; clazz, final int limit, final int offset, Site site,    </span>
<span class="-1250257878122023702" onmouseenter="enter('-1250257878122023702');" onmouseout="out('-1250257878122023702');" style=""> 403             Catalog catalog) throws ServiceException {                                                   </span>
<span class="466374425591711697" onmouseenter="enter('466374425591711697');" onmouseout="out('466374425591711697');" style=""><abbr title=" 404         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() {"> 404         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceExceðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 405             @Override                                                                                    </span>
<span class="2544604179721060437" onmouseenter="enter('2544604179721060437');" onmouseout="out('2544604179721060437');" style=""> 406             public List&lt;T&gt; execute() throws ServiceException {                                           </span>
<span class="-7182433549032782374" onmouseenter="enter('-7182433549032782374');" onmouseout="out('-7182433549032782374');" style=""> 407                 return genericEntityService.readAllGenericEntity(clazz, limit, offset);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 409         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410     }                                                                                                    </span>
<span  style=""> 411                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 412     /**                                                                                                  </span>
<span class="-2791201834401909051" onmouseenter="enter('-2791201834401909051');" onmouseout="out('-2791201834401909051');" style=""> 413      * Checks for similar items before adding to avoid duplication                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 414      *                                                                                                   </span>
<span class="-3657783928704768726" onmouseenter="enter('-3657783928704768726');" onmouseout="out('-3657783928704768726');" style=""> 415      * @param pattern input pattern                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 416      */                                                                                                  </span>
<span class="-4846906708761894704" onmouseenter="enter('-4846906708761894704');" onmouseout="out('-4846906708761894704');" style=""> 417     protected void addPattern(final Pattern pattern) {                                                   </span>
<span class="5859550306873716729" onmouseenter="enter('5859550306873716729');" onmouseout="out('5859550306873716729');" style=""> 418         if (this.needToAdd(pattern)) {                                                                   </span>
<span class="4416844535423030775" onmouseenter="enter('4416844535423030775');" onmouseout="out('4416844535423030775');" style=""> 419             this.classExcludeRegexPatternList.add(pattern);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="-7848998461890921050" onmouseenter="enter('-7848998461890921050');" onmouseout="out('-7848998461890921050');" style=""> 423     protected boolean needToAdd(final Pattern pattern) {                                                 </span>
<span class="-6062616619578034043" onmouseenter="enter('-6062616619578034043');" onmouseout="out('-6062616619578034043');" style=""> 424         boolean exist = false;                                                                           </span>
<span class="5993689843013964459" onmouseenter="enter('5993689843013964459');" onmouseout="out('5993689843013964459');" style=""> 425         for (Pattern item : this.classExcludeRegexPatternList) {                                         </span>
<span class="-2198741654006431688" onmouseenter="enter('-2198741654006431688');" onmouseout="out('-2198741654006431688');" style=""> 426             if (item.pattern().equals(pattern.pattern())) {                                              </span>
<span class="-4447673499306073413" onmouseenter="enter('-4447673499306073413');" onmouseout="out('-4447673499306073413');" style=""> 427                 exist = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 428                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430         }                                                                                                </span>
<span class="-2598905690734194618" onmouseenter="enter('-2598905690734194618');" onmouseout="out('-2598905690734194618');" style=""> 431         return !exist;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432     }                                                                                                    </span>
<span  style=""> 433                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434 }                                                                                                        </span>
















</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-4573490878212285276" onmouseenter="enter('-4573490878212285276');" onmouseout="out('-4573490878212285276');" style="">   3  * BroadleafCommerce Common Libraries                                                                    </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-1160938633668984164" onmouseenter="enter('-1160938633668984164');" onmouseout="out('-1160938633668984164');" style="">  18 package org.broadleafcommerce.common.copy;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="507320133330553151" onmouseenter="enter('507320133330553151');" onmouseout="out('507320133330553151');" style="">  20 import java.lang.reflect.Field;                                                                          </span>
<span class="1546464639948964552" onmouseenter="enter('1546464639948964552');" onmouseout="out('1546464639948964552');" style="">  21 import java.lang.reflect.Modifier;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  22 import java.util.ArrayList;                                                                              </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  23 import java.util.Collection;                                                                             </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  24 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  25 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  26 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  27 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  28 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  29 import java.util.regex.Pattern;                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  30 import javax.annotation.Resource;                                                                        </span>
<span class="5429236160528371227" onmouseenter="enter('5429236160528371227');" onmouseout="out('5429236160528371227');" style="">  31 import javax.persistence.Embeddable;                                                                     </span>
<span class="634040011956091835" onmouseenter="enter('634040011956091835');" onmouseout="out('634040011956091835');" style="">  32 import javax.persistence.ManyToMany;                                                                     </span>
<span class="-2638882474121018940" onmouseenter="enter('-2638882474121018940');" onmouseout="out('-2638882474121018940');" style="">  33 import javax.persistence.ManyToOne;                                                                      </span>
<span class="4490236759922497400" onmouseenter="enter('4490236759922497400');" onmouseout="out('4490236759922497400');" style="">  34 import javax.persistence.OneToMany;                                                                      </span>
<span class="-1278149683069486932" onmouseenter="enter('-1278149683069486932');" onmouseout="out('-1278149683069486932');" style="">  35 import javax.persistence.OneToOne;                                                                       </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  36 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  37 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="-9066890226896155571" onmouseenter="enter('-9066890226896155571');" onmouseout="out('-9066890226896155571');" style="">  38 import org.broadleafcommerce.common.exception.ExceptionHelper;                                           </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  39 import org.broadleafcommerce.common.exception.ServiceException;                                          </span>
<span class="4081669836921876898" onmouseenter="enter('4081669836921876898');" onmouseout="out('4081669836921876898');" style="">  40 import org.broadleafcommerce.common.sandbox.domain.SandBox;                                              </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  41 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="-4286566313930798693" onmouseenter="enter('-4286566313930798693');" onmouseout="out('-4286566313930798693');" style="">  42 import org.broadleafcommerce.common.site.domain.Catalog;                                                 </span>
<span class="3350833871385260454" onmouseenter="enter('3350833871385260454');" onmouseout="out('3350833871385260454');" style="">  43 import org.broadleafcommerce.common.site.domain.Site;                                                    </span>
<span class="5712948414688687719" onmouseenter="enter('5712948414688687719');" onmouseout="out('5712948414688687719');" style="">  44 import org.broadleafcommerce.common.util.StreamCapableTransactionalOperationAdapter;                     </span>
<span class="3798869978454175791" onmouseenter="enter('3798869978454175791');" onmouseout="out('3798869978454175791');" style="">  45 import org.broadleafcommerce.common.util.StreamingTransactionCapableUtil;                                </span>
<span class="5413521702958049593" onmouseenter="enter('5413521702958049593');" onmouseout="out('5413521702958049593');" style="">  46 import org.broadleafcommerce.common.util.tenant.IdentityExecutionUtils;                                  </span>
<span class="2334451492079531669" onmouseenter="enter('2334451492079531669');" onmouseout="out('2334451492079531669');" style="">  47 import org.broadleafcommerce.common.util.tenant.IdentityOperation;                                       </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  48 import org.broadleafcommerce.common.web.BroadleafRequestContext;                                         </span>
<span class="2584309252308847990" onmouseenter="enter('2584309252308847990');" onmouseout="out('2584309252308847990');" style="">  49 import org.broadleafcommerce.common.web.DeployState;                                                     </span>
<span class="6105195614559590838" onmouseenter="enter('6105195614559590838');" onmouseout="out('6105195614559590838');" style="">  50 import org.broadleafcommerce.common.web.EnforceEnterpriseCollectionBehaviorState;                        </span>
<span class="-5036922012441036669" onmouseenter="enter('-5036922012441036669');" onmouseout="out('-5036922012441036669');" style="">  51 import org.springframework.core.Ordered;                                                                 </span>
<span  style="">  52                                                                                                          </span>
<span  style="">  53                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54 /**                                                                                                      </span>
<span class="-8041280944155159385" onmouseenter="enter('-8041280944155159385');" onmouseout="out('-8041280944155159385');" style=""><abbr title="  55  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. Subclasses generally">  55  * Abstract class for copying entities to a new catalog as required during derived catalog propagation. SðŸ”µ</abbr></span>
<span class="-627018466353991606" onmouseenter="enter('-627018466353991606');" onmouseout="out('-627018466353991606');" style=""><abbr title="  56  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.common.site.domain.Catalog, MultiTenantCopyContext)}">  56  * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcomðŸ”µ</abbr></span>
<span class="-416790415154158937" onmouseenter="enter('-416790415154158937');" onmouseout="out('-416790415154158937');" style=""><abbr title="  57  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and persist">  57  * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clonðŸ”µ</abbr></span>
<span class="5445624896446749929" onmouseenter="enter('5445624896446749929');" onmouseout="out('5445624896446749929');" style="">  58  * an entity object tree.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  59  *                                                                                                       </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style="">  60  * @author Andre Azzolini (apazzolini)                                                                   </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style="">  61  * @author Jeff Fischer                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  62  */                                                                                                      </span>
<span class="-1737666508653679295" onmouseenter="enter('-1737666508653679295');" onmouseout="out('-1737666508653679295');" style="">  63 public abstract class MultiTenantCopier implements Ordered {                                             </span>
<span class="7878007665356847965" onmouseenter="enter('7878007665356847965');" onmouseout="out('7878007665356847965');" style="">  64     protected static final Log LOG = LogFactory.getLog(MultiTenantCopier.class);                         </span>
<span  style="">  65                                                                                                          </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="">  66     @Resource(name = &quot;blGenericEntityService&quot;)                                                           </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="">  67     protected GenericEntityService genericEntityService;                                                 </span>
<span  style="">  68                                                                                                          </span>
<span class="-4045496854230922802" onmouseenter="enter('-4045496854230922802');" onmouseout="out('-4045496854230922802');" style="">  69     @Resource(name = &quot;blMultiTenantCopierExtensionManager&quot;)                                              </span>
<span class="9132557441157356873" onmouseenter="enter('9132557441157356873');" onmouseout="out('9132557441157356873');" style="">  70     protected MultiTenantCopierExtensionManager extensionManager;                                        </span>
<span  style="">  71                                                                                                          </span>
<span class="6302352000387574659" onmouseenter="enter('6302352000387574659');" onmouseout="out('6302352000387574659');" style="">  72     @Resource(name=&quot;blStreamingTransactionCapableUtil&quot;)                                                  </span>
<span class="-8080662791692885473" onmouseenter="enter('-8080662791692885473');" onmouseout="out('-8080662791692885473');" style="">  73     protected StreamingTransactionCapableUtil transUtil;                                                 </span>
<span  style="">  74                                                                                                          </span>
<span class="3478346643346744503" onmouseenter="enter('3478346643346744503');" onmouseout="out('3478346643346744503');" style="">  75     protected int order = 0;                                                                             </span>
<span  style="">  76                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  77     /**                                                                                                  </span>
<span class="-122049322422344857" onmouseenter="enter('-122049322422344857');" onmouseout="out('-122049322422344857');" style="">  78      * To add elements use {@link #addPattern(Pattern)}                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  79      */                                                                                                  </span>
<span class="-4573832410677620492" onmouseenter="enter('-4573832410677620492');" onmouseout="out('-4573832410677620492');" style="">  80     protected List&lt;Pattern&gt; classExcludeRegexPatternList = new ArrayList&lt;&gt;();                            </span>
<span  style="">  81                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  82     /**                                                                                                  </span>
<span class="2044942771211883310" onmouseenter="enter('2044942771211883310');" onmouseout="out('2044942771211883310');" style="">  83      * Main method that should be implemented by each {@link MultiTenantCopier} to drive the logic of    </span>
<span class="3580574424461635495" onmouseenter="enter('3580574424461635495');" onmouseout="out('3580574424461635495');" style="">  84      * copying that particular entity to the new derived catalog.                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  85      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="">  86      * @param context                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87      */                                                                                                  </span>
<span class="-6235588905422461924" onmouseenter="enter('-6235588905422461924');" onmouseout="out('-6235588905422461924');" style="">  88     public abstract void copyEntities(MultiTenantCopyContext context) throws Exception;                  </span>
<span  style="">  89                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  90     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  91      *                                                                                                   </span>
<span class="2985577248159931846" onmouseenter="enter('2985577248159931846');" onmouseout="out('2985577248159931846');" style="">  92      * @return the order of this {@link MultiTenantCopier}                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  93      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  94     @Override                                                                                            </span>
<span class="-1157866401688879802" onmouseenter="enter('-1157866401688879802');" onmouseout="out('-1157866401688879802');" style="">  95     public int getOrder() {                                                                              </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style="">  96         return order;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97     }                                                                                                    </span>
<span  style="">  98                                                                                                          </span>
<span class="8078611052580382973" onmouseenter="enter('8078611052580382973');" onmouseout="out('8078611052580382973');" style="">  99     public void setOrder(int order) {                                                                    </span>
<span class="-6754869500416241760" onmouseenter="enter('-6754869500416241760');" onmouseout="out('-6754869500416241760');" style=""> 100         this.order = order;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101     }                                                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="-3615357639229759469" onmouseenter="enter('-3615357639229759469');" onmouseout="out('-3615357639229759469');" style=""><abbr title=" 103     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazz, T original, MultiTenantCopyContext context) throws G {"> 103     protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, ClassðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 104         try {                                                                                            </span>
<span class="8848439591475072064" onmouseenter="enter('8848439591475072064');" onmouseout="out('8848439591475072064');" style=""> 105             //don&#x27;t persist if there is already an equivalent present                                    </span>
<span class="-3623402225573308912" onmouseenter="enter('-3623402225573308912');" onmouseout="out('-3623402225573308912');" style=""><abbr title=" 106             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) != null) {"> 106             if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) !=ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 107                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108             }                                                                                            </span>
<span  style=""> 109                                                                                                          </span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 110             context.clearOriginalIdentifiers();                                                          </span>
<span class="-4760173204145292260" onmouseenter="enter('-4760173204145292260');" onmouseout="out('-4760173204145292260');" style=""> 111             genericEntityService.clearAutoFlushMode();                                                   </span>
<span class="-8326881612018417764" onmouseenter="enter('-8326881612018417764');" onmouseout="out('-8326881612018417764');" style=""> 112             Object copy = copyOperation.execute(original);                                               </span>
<span class="3128798615968492125" onmouseenter="enter('3128798615968492125');" onmouseout="out('3128798615968492125');" style=""> 113             SandBox sandBox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();         </span>
<span class="6492445518569294809" onmouseenter="enter('6492445518569294809');" onmouseout="out('6492445518569294809');" style=""><abbr title=" 114             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployState();"> 114             DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployStateðŸ”µ</abbr></span>
<span class="2163142151434548972" onmouseenter="enter('2163142151434548972');" onmouseout="out('2163142151434548972');" style=""> 115             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(DeployState.PRODUCTION); </span>
<span class="6572079192165011753" onmouseenter="enter('6572079192165011753');" onmouseout="out('6572079192165011753');" style=""> 116             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(null);                       </span>
<span class="-6104353510353355986" onmouseenter="enter('-6104353510353355986');" onmouseout="out('-6104353510353355986');" style=""><abbr title=" 117             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.FALSE);"> 117             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-2148155577856476410" onmouseenter="enter('-2148155577856476410');" onmouseout="out('-2148155577856476410');" style=""> 118             persistCopyObjectTreeInternal(copy, new HashSet&lt;Integer&gt;(), context);                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 119             genericEntityService.flush();                                                                </span>
<span class="1952764089697360447" onmouseenter="enter('1952764089697360447');" onmouseout="out('1952764089697360447');" style=""> 120             BroadleafRequestContext.getBroadleafRequestContext().setSandBox(sandBox);                    </span>
<span class="2444831964480057831" onmouseenter="enter('2444831964480057831');" onmouseout="out('2444831964480057831');" style=""> 121             BroadleafRequestContext.getBroadleafRequestContext().setDeployState(deployState);            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 122         } catch (Exception e) {                                                                          </span>
<span class="3675438560154002673" onmouseenter="enter('3675438560154002673');" onmouseout="out('3675438560154002673');" style=""> 123             LOG.error(&quot;Unable to persist the copy object tree&quot;, e);                                      </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 124             throw ExceptionHelper.refineException(e);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 125         } finally {                                                                                      </span>
<span class="7199875090489075677" onmouseenter="enter('7199875090489075677');" onmouseout="out('7199875090489075677');" style=""><abbr title=" 126             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.TRUE);"> 126             BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorStðŸ”µ</abbr></span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 127             context.clearOriginalIdentifiers();                                                          </span>
<span class="-5390342410291425165" onmouseenter="enter('-5390342410291425165');" onmouseout="out('-5390342410291425165');" style=""> 128             genericEntityService.enableAutoFlushMode();                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="813863986067248403" onmouseenter="enter('813863986067248403');" onmouseout="out('813863986067248403');" style=""><abbr title=" 132     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext context) {"> 132     protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContexðŸ”µ</abbr></span>
<span class="9024670618470737245" onmouseenter="enter('9024670618470737245');" onmouseout="out('9024670618470737245');" style=""><abbr title=" 133         if ((library.contains(System.identityHashCode(copy)) || (!(copy instanceof MultiTenantCloneable))) || this.excludeFromCopyRegexPattern(copy)) {"> 133         if ((library.contains(System.identityHashCode(copy)) || (!(copy instanceof MultiTenantCloneable))ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 134             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="6099587390698254391" onmouseenter="enter('6099587390698254391');" onmouseout="out('6099587390698254391');" style=""> 136         library.add(System.identityHashCode(copy));                                                      </span>
<span class="-4798752894315625699" onmouseenter="enter('-4798752894315625699');" onmouseout="out('-4798752894315625699');" style=""> 137         List&lt;Object[]&gt; collections = new ArrayList&lt;Object[]&gt;();                                          </span>
<span class="1437989156315370335" onmouseenter="enter('1437989156315370335');" onmouseout="out('1437989156315370335');" style=""> 138         Field[] allFields = context.getAllFields(copy.getClass());                                       </span>
<span class="2968462139034023970" onmouseenter="enter('2968462139034023970');" onmouseout="out('2968462139034023970');" style=""> 139         for (Field field : allFields) {                                                                  </span>
<span class="-6028825997928669487" onmouseenter="enter('-6028825997928669487');" onmouseout="out('-6028825997928669487');" style=""> 140             if (field.getName().equals(&quot;embeddableSiteDiscriminator&quot;)) {                                 </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 141                 continue;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142             }                                                                                            </span>
<span class="2215334239672037801" onmouseenter="enter('2215334239672037801');" onmouseout="out('2215334239672037801');" style=""> 143             if (!Modifier.isStatic(field.getModifiers())) {                                              </span>
<span class="-242302875073644057" onmouseenter="enter('-242302875073644057');" onmouseout="out('-242302875073644057');" style=""> 144                 field.setAccessible(true);                                                               </span>
<span class="-3119387060603195319" onmouseenter="enter('-3119387060603195319');" onmouseout="out('-3119387060603195319');" style=""> 145                 Object newTarget;                                                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 146                 try {                                                                                    </span>
<span class="-1788169810723093055" onmouseenter="enter('-1788169810723093055');" onmouseout="out('-1788169810723093055');" style=""> 147                     newTarget = field.get(copy);                                                         </span>
<span class="1719180133827210930" onmouseenter="enter('1719180133827210930');" onmouseout="out('1719180133827210930');" style=""> 148                 } catch (java.lang.IllegalAccessException e) {                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 149                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150                 }                                                                                        </span>
<span class="5292471581137077546" onmouseenter="enter('5292471581137077546');" onmouseout="out('5292471581137077546');" style=""> 151                 if (newTarget != null) {                                                                 </span>
<span class="-1783838220137734117" onmouseenter="enter('-1783838220137734117');" onmouseout="out('-1783838220137734117');" style=""><abbr title=" 152                     if ((field.getAnnotation(ManyToOne.class) != null) || (field.getAnnotation(OneToOne.class) != null)) {"> 152                     if ((field.getAnnotation(ManyToOne.class) != null) || (field.getAnnotation(OneToOne.cðŸ”µ</abbr></span>
<span class="-1779560011655050958" onmouseenter="enter('-1779560011655050958');" onmouseout="out('-1779560011655050958');" style=""> 153                         if (library.contains(System.identityHashCode(newTarget))) {                      </span>
<span class="-6882820149046221397" onmouseenter="enter('-6882820149046221397');" onmouseout="out('-6882820149046221397');" style=""> 154                             persistNode(newTarget, context);                                             </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 155                             continue;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156                         }                                                                                </span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 157                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-6561395712020771233" onmouseenter="enter('-6561395712020771233');" onmouseout="out('-6561395712020771233');" style=""><abbr title=" 158                     } else if ((field.getAnnotation(ManyToMany.class) != null) || (field.getAnnotation(OneToMany.class) != null)) {"> 158                     } else if ((field.getAnnotation(ManyToMany.class) != null) || (field.getAnnotation(OnðŸ”µ</abbr></span>
<span class="-759098201543025384" onmouseenter="enter('-759098201543025384');" onmouseout="out('-759098201543025384');" style=""> 159                         collections.add(new Object[]{ field, newTarget });                               </span>
<span class="-3133844694608496972" onmouseenter="enter('-3133844694608496972');" onmouseout="out('-3133844694608496972');" style=""><abbr title=" 160                     } else if ((field.getType().getAnnotation(Embeddable.class) != null) &amp;&amp; MultiTenantCloneable.class.isAssignableFrom(field.getType())) {"> 160                     } else if ((field.getType().getAnnotation(Embeddable.class) != null) &amp;&amp; MultiTenantClðŸ”µ</abbr></span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 161                         persistCopyObjectTreeInternal(newTarget, library, context);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165         }                                                                                                </span>
<span class="5522223281117737932" onmouseenter="enter('5522223281117737932');" onmouseout="out('5522223281117737932');" style=""> 166         if (copy.getClass().getAnnotation(Embeddable.class) == null) {                                   </span>
<span class="8489885264009154572" onmouseenter="enter('8489885264009154572');" onmouseout="out('8489885264009154572');" style=""> 167             persistNode(copy, context);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168         }                                                                                                </span>
<span class="7328299556920669788" onmouseenter="enter('7328299556920669788');" onmouseout="out('7328299556920669788');" style=""> 169         for (Object[] collectionItem : collections) {                                                    </span>
<span class="6509881775537642462" onmouseenter="enter('6509881775537642462');" onmouseout="out('6509881775537642462');" style=""> 170             if (collectionItem[1] instanceof Collection) {                                               </span>
<span class="-4470984885310271967" onmouseenter="enter('-4470984885310271967');" onmouseout="out('-4470984885310271967');" style=""> 171                 Collection newCollection = ((Collection) (collectionItem[1]));                           </span>
<span class="2236280788008259197" onmouseenter="enter('2236280788008259197');" onmouseout="out('2236280788008259197');" style=""> 172                 for (Object member : newCollection) {                                                    </span>
<span class="559928666155877213" onmouseenter="enter('559928666155877213');" onmouseout="out('559928666155877213');" style=""> 173                     persistCopyObjectTreeInternal(member, library, context);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174                 }                                                                                        </span>
<span class="-358290731378005197" onmouseenter="enter('-358290731378005197');" onmouseout="out('-358290731378005197');" style=""> 175             } else if (collectionItem[1] instanceof Map) {                                               </span>
<span class="5207287694996546243" onmouseenter="enter('5207287694996546243');" onmouseout="out('5207287694996546243');" style=""> 176                 Map newMap = ((Map) (collectionItem[1]));                                                </span>
<span class="-3046213999695776442" onmouseenter="enter('-3046213999695776442');" onmouseout="out('-3046213999695776442');" style=""> 177                 for (Object key : newMap.keySet()) {                                                     </span>
<span class="-4861713825562612226" onmouseenter="enter('-4861713825562612226');" onmouseout="out('-4861713825562612226');" style=""> 178                     persistCopyObjectTreeInternal(newMap.get(key), library, context);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180             } else {                                                                                     </span>
<span class="-4532391539265997909" onmouseenter="enter('-4532391539265997909');" onmouseout="out('-4532391539265997909');" style=""><abbr title=" 181                 throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; + (&quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; + &quot;recognizes Collection and Map. (%s.%s)&quot;), copy.getClass().getName(), ((Field) (collectionItem[0])).getName()));"> 181                 throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; + (&quot;aðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 186     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 187      *                                                                                                   </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 188      * @param copy Copy object                                                                           </span>
<span class="-794768860455465512" onmouseenter="enter('-794768860455465512');" onmouseout="out('-794768860455465512');" style=""> 189      * @return excluded or not in patterns                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 190      */                                                                                                  </span>
<span class="6972780348503080990" onmouseenter="enter('6972780348503080990');" onmouseout="out('6972780348503080990');" style=""> 191     protected Boolean excludeFromCopyRegexPattern(final Object copy) {                                   </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 192         boolean match = false;                                                                           </span>
<span class="-3926064167940700035" onmouseenter="enter('-3926064167940700035');" onmouseout="out('-3926064167940700035');" style=""> 193         for (final Pattern pattern : this.classExcludeRegexPatternList) {                                </span>
<span class="6367080919039942315" onmouseenter="enter('6367080919039942315');" onmouseout="out('6367080919039942315');" style=""> 194             final Matcher matcher = pattern.matcher(copy.getClass().toString());                         </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 195             if (matcher.matches()) {                                                                     </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 196                 match = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 197                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199         }                                                                                                </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 200         return match;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="-8032468969933703819" onmouseenter="enter('-8032468969933703819');" onmouseout="out('-8032468969933703819');" style=""> 203     protected void persistNode(final Object copy, final MultiTenantCopyContext context) {                </span>
<span class="7987568954533399833" onmouseenter="enter('7987568954533399833');" onmouseout="out('7987568954533399833');" style=""> 204         if (!genericEntityService.sessionContains(copy) &amp;&amp; !genericEntityService.idAssigned(copy)) {     </span>
<span class="8681842502075417653" onmouseenter="enter('8681842502075417653');" onmouseout="out('8681842502075417653');" style=""><abbr title=" 205             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.removeOriginalIdentifier(copy));"> 205             final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), conðŸ”µ</abbr></span>
<span class="-5090759614318459505" onmouseenter="enter('-5090759614318459505');" onmouseout="out('-5090759614318459505');" style=""> 206             extensionManager.getProxy().transformCopy(context, original, copy);                          </span>
<span class="4297838893803910408" onmouseenter="enter('4297838893803910408');" onmouseout="out('4297838893803910408');" style=""> 207             extensionManager.getProxy().prepareForSave(context, original, copy);                         </span>
<span  style=""> 208                                                                                                          </span>
<span class="-8752421726777980004" onmouseenter="enter('-8752421726777980004');" onmouseout="out('-8752421726777980004');" style=""><abbr title=" 209             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;() {"> 209             IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 210                 @Override                                                                                </span>
<span class="-8659131798736023396" onmouseenter="enter('-8659131798736023396');" onmouseout="out('-8659131798736023396');" style=""> 211                 public Void execute() {                                                                  </span>
<span class="-9045674711737912799" onmouseenter="enter('-9045674711737912799');" onmouseout="out('-9045674711737912799');" style=""> 212                     genericEntityService.persist(copy);                                                  </span>
<span class="2025772996566147876" onmouseenter="enter('2025772996566147876');" onmouseout="out('2025772996566147876');" style=""> 213                     extensionManager.getProxy().postSave(context, original, copy);                       </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 214                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215                 }                                                                                        </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 216             }, context.getToSite(), context.getToSite(), context.getToCatalog());                        </span>
<span  style=""> 217                                                                                                          </span>
<span class="-7681066818147012496" onmouseenter="enter('-7681066818147012496');" onmouseout="out('-7681066818147012496');" style=""><abbr title=" 218             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), context.getIdentifier(copy));"> 218             context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original)ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 222     /**                                                                                                  </span>
<span class="-8073168593296919506" onmouseenter="enter('-8073168593296919506');" onmouseout="out('-8073168593296919506');" style=""><abbr title=" 223      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementation."> 223      * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} ðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 224      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 225      * @param clazz                                                                                      </span>
<span class="3646661620596311758" onmouseenter="enter('3646661620596311758');" onmouseout="out('3646661620596311758');" style=""> 226      * @param fromSite                                                                                   </span>
<span class="8125408689844361908" onmouseenter="enter('8125408689844361908');" onmouseout="out('8125408689844361908');" style=""> 227      * @param fromCatalog                                                                                </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 228      * @param context                                                                                    </span>
<span class="5977767735151043102" onmouseenter="enter('5977767735151043102');" onmouseout="out('5977767735151043102');" style=""> 229      * @param &lt;T&gt;                                                                                        </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 230      * @throws ServiceException                                                                          </span>
<span class="-2651377028902862562" onmouseenter="enter('-2651377028902862562');" onmouseout="out('-2651377028902862562');" style=""> 231      * @throws CloneNotSupportedException                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 232      */                                                                                                  </span>
<span class="872769015085653006" onmouseenter="enter('872769015085653006');" onmouseout="out('872769015085653006');" style=""><abbr title=" 233     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, final Catalog fromCatalog, final MultiTenantCopyContext context)"> 233     protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fðŸ”µ</abbr></span>
<span class="8092245223016329648" onmouseenter="enter('8092245223016329648');" onmouseout="out('8092245223016329648');" style=""> 234             throws ServiceException, CloneNotSupportedException {                                        </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 235         genericEntityService.flush();                                                                    </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 236         genericEntityService.clear();                                                                    </span>
<span class="6078548138955406640" onmouseenter="enter('6078548138955406640');" onmouseout="out('6078548138955406640');" style=""> 237         transUtil.runStreamingTransactionalOperation(new StreamCapableTransactionalOperationAdapter() {  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 238             @Override                                                                                    </span>
<span class="-4097688009913453744" onmouseenter="enter('-4097688009913453744');" onmouseout="out('-4097688009913453744');" style=""> 239             public Object[] retrievePage(int startPos, int pageSize) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 240                 try {                                                                                    </span>
<span class="-6654678464986381896" onmouseenter="enter('-6654678464986381896');" onmouseout="out('-6654678464986381896');" style=""> 241                     Object[] temp = new Object[1];                                                       </span>
<span class="-1074208970495142702" onmouseenter="enter('-1074208970495142702');" onmouseout="out('-1074208970495142702');" style=""> 242                     List&lt;T&gt; results = readAll(clazz, pageSize, startPos, fromSite, fromCatalog);         </span>
<span class="2620576066975874715" onmouseenter="enter('2620576066975874715');" onmouseout="out('2620576066975874715');" style=""> 243                     temp[0] = results;                                                                   </span>
<span class="-3847030593865588422" onmouseenter="enter('-3847030593865588422');" onmouseout="out('-3847030593865588422');" style=""> 244                     return temp;                                                                         </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 245                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 246                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248             }                                                                                            </span>
<span  style=""> 249                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 250             @Override                                                                                    </span>
<span class="6279129438695530603" onmouseenter="enter('6279129438695530603');" onmouseout="out('6279129438695530603');" style=""> 251             public void pagedExecute(Object[] param) throws Throwable {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 252                 try {                                                                                    </span>
<span class="2324184862033110442" onmouseenter="enter('2324184862033110442');" onmouseout="out('2324184862033110442');" style=""> 253                     List&lt;T&gt; results = (List&lt;T&gt;) param[0];                                                </span>
<span class="-7383605119906788487" onmouseenter="enter('-7383605119906788487');" onmouseout="out('-7383605119906788487');" style=""> 254                     for (T result : results) {                                                           </span>
<span class="-2673391330205902743" onmouseenter="enter('-2673391330205902743');" onmouseout="out('-2673391330205902743');" style=""> 255                         persistCopyObjectTree(new CopyOperation&lt;T, CloneNotSupportedException&gt;() {       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 256                             @Override                                                                    </span>
<span class="-8939809480293479644" onmouseenter="enter('-8939809480293479644');" onmouseout="out('-8939809480293479644');" style=""> 257                             public T execute(T original) throws CloneNotSupportedException {             </span>
<span class="-5091972823585019460" onmouseenter="enter('-5091972823585019460');" onmouseout="out('-5091972823585019460');" style=""> 258                                 return (T) original.createOrRetrieveCopyInstance(context).getClone();    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259                             }                                                                            </span>
<span class="3899565736356446794" onmouseenter="enter('3899565736356446794');" onmouseout="out('3899565736356446794');" style=""> 260                         }, clazz, result, context);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                     }                                                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 262                 } finally {                                                                              </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 263                     genericEntityService.clear();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265             }                                                                                            </span>
<span  style=""> 266                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 267             @Override                                                                                    </span>
<span class="-2604993651595386294" onmouseenter="enter('-2604993651595386294');" onmouseout="out('-2604993651595386294');" style=""> 268             public Long retrieveTotalCount() {                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 269                 try {                                                                                    </span>
<span class="6601113330436234291" onmouseenter="enter('6601113330436234291');" onmouseout="out('6601113330436234291');" style=""> 270                     return readCount(clazz, fromSite, fromCatalog);                                      </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 271                 } catch (ServiceException e) {                                                           </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 272                     throw ExceptionHelper.refineException(e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274             }                                                                                            </span>
<span  style=""> 275                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 276             @Override                                                                                    </span>
<span class="1336357167460974281" onmouseenter="enter('1336357167460974281');" onmouseout="out('1336357167460974281');" style=""> 277             public boolean shouldRetryOnTransactionLockAcquisitionFailure() {                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 278                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279             }                                                                                            </span>
<span class="-3417072119495989863" onmouseenter="enter('-3417072119495989863');" onmouseout="out('-3417072119495989863');" style=""> 280         }, RuntimeException.class);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281     }                                                                                                    </span>
<span  style=""> 282                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 283     /**                                                                                                  </span>
<span class="-8433738365892647070" onmouseenter="enter('-8433738365892647070');" onmouseout="out('-8433738365892647070');" style=""> 284      * Saves the specified object in the toSite and toCatalog of the given context.                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 285      *                                                                                                   </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 286      * @param context                                                                                    </span>
<span class="7689578750101732801" onmouseenter="enter('7689578750101732801');" onmouseout="out('7689578750101732801');" style=""> 287      * @param object                                                                                     </span>
<span class="6893734882299737905" onmouseenter="enter('6893734882299737905');" onmouseout="out('6893734882299737905');" style=""> 288      * @return the saved entity                                                                          </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 289      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 290      */                                                                                                  </span>
<span class="5212394141372864718" onmouseenter="enter('5212394141372864718');" onmouseout="out('5212394141372864718');" style=""> 291     protected &lt;T&gt; T save(MultiTenantCopyContext context, final T object) throws ServiceException {       </span>
<span class="-1099504713577842018" onmouseenter="enter('-1099504713577842018');" onmouseout="out('-1099504713577842018');" style=""><abbr title=" 292         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;() {"> 292         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 293             @Override                                                                                    </span>
<span class="4151681128977710489" onmouseenter="enter('4151681128977710489');" onmouseout="out('4151681128977710489');" style=""> 294             public T execute() throws ServiceException {                                                 </span>
<span class="-380270513562060751" onmouseenter="enter('-380270513562060751');" onmouseout="out('-380270513562060751');" style=""> 295                 return genericEntityService.save(object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296             }                                                                                            </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 297         }, context.getToSite(), context.getToSite(), context.getToCatalog());                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298     }                                                                                                    </span>
<span  style=""> 299                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 300     /**                                                                                                  </span>
<span class="-7601540533988835340" onmouseenter="enter('-7601540533988835340');" onmouseout="out('-7601540533988835340');" style=""> 301      * Returns the count of the given entity class for the specified site and catalog                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 302      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 303      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 304      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 305      * @param catalog                                                                                    </span>
<span class="-3150840522218520736" onmouseenter="enter('-3150840522218520736');" onmouseout="out('-3150840522218520736');" style=""> 306      * @return the count                                                                                 </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 307      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 308      */                                                                                                  </span>
<span class="-3128834492857774013" onmouseenter="enter('-3128834492857774013');" onmouseout="out('-3128834492857774013');" style=""><abbr title=" 309     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 309     protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceExceptioðŸ”µ</abbr></span>
<span class="2183944127153439224" onmouseenter="enter('2183944127153439224');" onmouseout="out('2183944127153439224');" style=""><abbr title=" 310         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceException&gt;() {"> 310         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceExceptiðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 311             @Override                                                                                    </span>
<span class="3590332160508681130" onmouseenter="enter('3590332160508681130');" onmouseout="out('3590332160508681130');" style=""> 312             public Long execute() throws ServiceException {                                              </span>
<span class="-8909345086268725459" onmouseenter="enter('-8909345086268725459');" onmouseout="out('-8909345086268725459');" style=""> 313                 return genericEntityService.readCountGenericEntity(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 315         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 318     /**                                                                                                  </span>
<span class="-8874952311237548171" onmouseenter="enter('-8874952311237548171');" onmouseout="out('-8874952311237548171');" style=""> 319      * @see #readAll(Class, int, int, Site, Catalog)                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 320      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 321      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 322      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 323      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 324      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 325      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 326      */                                                                                                  </span>
<span class="-2591408295637802722" onmouseenter="enter('-2591408295637802722');" onmouseout="out('-2591408295637802722');" style=""> 327     protected &lt;T&gt; List&lt;T&gt; readAll(Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {  </span>
<span class="6989523363313544241" onmouseenter="enter('6989523363313544241');" onmouseout="out('6989523363313544241');" style=""> 328         return readAll(clazz, Integer.MAX_VALUE, 0, site, catalog);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329     }                                                                                                    </span>
<span  style=""> 330                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 331     /**                                                                                                  </span>
<span class="-7182426246277913548" onmouseenter="enter('-7182426246277913548');" onmouseout="out('-7182426246277913548');" style=""> 332      * Returns the primary key values for all entities of the specified type in the site or catalog.     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 333      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 334      * @param clazz                                                                                      </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 335      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 336      * @param catalog                                                                                    </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 337      * @return                                                                                           </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 338      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 339      */                                                                                                  </span>
<span class="5724457752579000562" onmouseenter="enter('5724457752579000562');" onmouseout="out('5724457752579000562');" style=""><abbr title=" 340     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceException {"> 340     protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceExcepðŸ”µ</abbr></span>
<span class="1548172976235084004" onmouseenter="enter('1548172976235084004');" onmouseout="out('1548172976235084004');" style=""><abbr title=" 341         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;() {"> 341         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceEðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 342             @Override                                                                                    </span>
<span class="-1864674537507723626" onmouseenter="enter('-1864674537507723626');" onmouseout="out('-1864674537507723626');" style=""> 343             public List&lt;Long&gt; execute() throws ServiceException {                                        </span>
<span class="1470706729559019118" onmouseenter="enter('1470706729559019118');" onmouseout="out('1470706729559019118');" style=""> 344                 return genericEntityService.readAllGenericEntityId(clazz);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 346         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 349     /**                                                                                                  </span>
<span class="-9001665139725221341" onmouseenter="enter('-9001665139725221341');" onmouseout="out('-9001665139725221341');" style=""> 350      * Returns a list of all entities in the system for the given class, site, and catalog. Additionally,</span>
<span class="8612534793136264631" onmouseenter="enter('8612534793136264631');" onmouseout="out('8612534793136264631');" style=""> 351      * this method supports pagination.                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 352      *                                                                                                   </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 353      * @param clazz                                                                                      </span>
<span class="-2517112653327253967" onmouseenter="enter('-2517112653327253967');" onmouseout="out('-2517112653327253967');" style=""> 354      * @param limit                                                                                      </span>
<span class="-1129619468702068661" onmouseenter="enter('-1129619468702068661');" onmouseout="out('-1129619468702068661');" style=""> 355      * @param offset                                                                                     </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 356      * @param site                                                                                       </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 357      * @param catalog                                                                                    </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 358      * @return the list of entities for the specified parameters                                         </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 359      * @throws ServiceException                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 360      */                                                                                                  </span>
<span class="3970621926802578022" onmouseenter="enter('3970621926802578022');" onmouseout="out('3970621926802578022');" style=""> 361     protected &lt;T&gt; List&lt;T&gt; readAll(final Class&lt;T&gt; clazz, final int limit, final int offset, Site site,    </span>
<span class="-1250257878122023702" onmouseenter="enter('-1250257878122023702');" onmouseout="out('-1250257878122023702');" style=""> 362             Catalog catalog) throws ServiceException {                                                   </span>
<span class="466374425591711697" onmouseenter="enter('466374425591711697');" onmouseout="out('466374425591711697');" style=""><abbr title=" 363         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() {"> 363         return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceExceðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 364             @Override                                                                                    </span>
<span class="2544604179721060437" onmouseenter="enter('2544604179721060437');" onmouseout="out('2544604179721060437');" style=""> 365             public List&lt;T&gt; execute() throws ServiceException {                                           </span>
<span class="-7182433549032782374" onmouseenter="enter('-7182433549032782374');" onmouseout="out('-7182433549032782374');" style=""> 366                 return genericEntityService.readAllGenericEntity(clazz, limit, offset);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367             }                                                                                            </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 368         }, site, site, catalog);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369     }                                                                                                    </span>
<span  style=""> 370                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 371     /**                                                                                                  </span>
<span class="-2791201834401909051" onmouseenter="enter('-2791201834401909051');" onmouseout="out('-2791201834401909051');" style=""> 372      * Checks for similar items before adding to avoid duplication                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 373      *                                                                                                   </span>
<span class="-3657783928704768726" onmouseenter="enter('-3657783928704768726');" onmouseout="out('-3657783928704768726');" style=""> 374      * @param pattern input pattern                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 375      */                                                                                                  </span>
<span class="-4846906708761894704" onmouseenter="enter('-4846906708761894704');" onmouseout="out('-4846906708761894704');" style=""> 376     protected void addPattern(final Pattern pattern) {                                                   </span>
<span class="5859550306873716729" onmouseenter="enter('5859550306873716729');" onmouseout="out('5859550306873716729');" style=""> 377         if (this.needToAdd(pattern)) {                                                                   </span>
<span class="4416844535423030775" onmouseenter="enter('4416844535423030775');" onmouseout="out('4416844535423030775');" style=""> 378             this.classExcludeRegexPatternList.add(pattern);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380     }                                                                                                    </span>
<span  style=""> 381                                                                                                          </span>
<span class="-7848998461890921050" onmouseenter="enter('-7848998461890921050');" onmouseout="out('-7848998461890921050');" style=""> 382     protected boolean needToAdd(final Pattern pattern) {                                                 </span>
<span class="-6062616619578034043" onmouseenter="enter('-6062616619578034043');" onmouseout="out('-6062616619578034043');" style=""> 383         boolean exist = false;                                                                           </span>
<span class="5993689843013964459" onmouseenter="enter('5993689843013964459');" onmouseout="out('5993689843013964459');" style=""> 384         for (Pattern item : this.classExcludeRegexPatternList) {                                         </span>
<span class="-2198741654006431688" onmouseenter="enter('-2198741654006431688');" onmouseout="out('-2198741654006431688');" style=""> 385             if (item.pattern().equals(pattern.pattern())) {                                              </span>
<span class="-4447673499306073413" onmouseenter="enter('-4447673499306073413');" onmouseout="out('-4447673499306073413');" style=""> 386                 exist = true;                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 387                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389         }                                                                                                </span>
<span class="-2598905690734194618" onmouseenter="enter('-2598905690734194618');" onmouseout="out('-2598905690734194618');" style=""> 390         return !exist;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392 }                                                                                                        </span>


























































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-4573490878212285276" onmouseenter="enter('-4573490878212285276');" onmouseout="out('-4573490878212285276');" style="">   3   * BroadleafCommerce Common Libraries                                                                             </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-1160938633668984164" onmouseenter="enter('-1160938633668984164');" onmouseout="out('-1160938633668984164');" style="">  18  package org.broadleafcommerce.common.copy;                                                                        </span>
<span  style="">  19                                                                                                                    </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  20  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  21  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="-9066890226896155571" onmouseenter="enter('-9066890226896155571');" onmouseout="out('-9066890226896155571');" style="">  22  import org.broadleafcommerce.common.exception.ExceptionHelper;                                                    </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  23  import org.broadleafcommerce.common.exception.ServiceException;                                                   </span>
<span class="4081669836921876898" onmouseenter="enter('4081669836921876898');" onmouseout="out('4081669836921876898');" style="">  24  import org.broadleafcommerce.common.sandbox.domain.SandBox;                                                       </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  25  import org.broadleafcommerce.common.service.GenericEntityService;                                                 </span>
<span class="-4286566313930798693" onmouseenter="enter('-4286566313930798693');" onmouseout="out('-4286566313930798693');" style="">  26  import org.broadleafcommerce.common.site.domain.Catalog;                                                          </span>
<span class="3350833871385260454" onmouseenter="enter('3350833871385260454');" onmouseout="out('3350833871385260454');" style="">  27  import org.broadleafcommerce.common.site.domain.Site;                                                             </span>
<span class="5712948414688687719" onmouseenter="enter('5712948414688687719');" onmouseout="out('5712948414688687719');" style="">  28  import org.broadleafcommerce.common.util.StreamCapableTransactionalOperationAdapter;                              </span>
<span class="3798869978454175791" onmouseenter="enter('3798869978454175791');" onmouseout="out('3798869978454175791');" style="">  29  import org.broadleafcommerce.common.util.StreamingTransactionCapableUtil;                                         </span>
<span class="5413521702958049593" onmouseenter="enter('5413521702958049593');" onmouseout="out('5413521702958049593');" style="">  30  import org.broadleafcommerce.common.util.tenant.IdentityExecutionUtils;                                           </span>
<span class="2334451492079531669" onmouseenter="enter('2334451492079531669');" onmouseout="out('2334451492079531669');" style="">  31  import org.broadleafcommerce.common.util.tenant.IdentityOperation;                                                </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  32  import org.broadleafcommerce.common.web.BroadleafRequestContext;                                                  </span>
<span class="2584309252308847990" onmouseenter="enter('2584309252308847990');" onmouseout="out('2584309252308847990');" style="">  33  import org.broadleafcommerce.common.web.DeployState;                                                              </span>
<span class="6105195614559590838" onmouseenter="enter('6105195614559590838');" onmouseout="out('6105195614559590838');" style="">  34  import org.broadleafcommerce.common.web.EnforceEnterpriseCollectionBehaviorState;                                 </span>
<span class="-5036922012441036669" onmouseenter="enter('-5036922012441036669');" onmouseout="out('-5036922012441036669');" style="">  35  import org.springframework.core.Ordered;                                                                          </span>
<span  style="">  36                                                                                                                    </span>
<span class="507320133330553151" onmouseenter="enter('507320133330553151');" onmouseout="out('507320133330553151');" style="">  37  import java.lang.reflect.Field;                                                                                   </span>
<span class="1546464639948964552" onmouseenter="enter('1546464639948964552');" onmouseout="out('1546464639948964552');" style="">  38  import java.lang.reflect.Modifier;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  39  import java.util.ArrayList;                                                                                       </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  40  import java.util.Collection;                                                                                      </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  43  import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  44  import java.util.Set;                                                                                             </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  45  import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  46  import java.util.regex.Pattern;                                                                                   </span>
<span  style="">  47                                                                                                                    </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  48  import javax.annotation.Resource;                                                                                 </span>
<span class="5429236160528371227" onmouseenter="enter('5429236160528371227');" onmouseout="out('5429236160528371227');" style="">  49  import javax.persistence.Embeddable;                                                                              </span>
<span class="634040011956091835" onmouseenter="enter('634040011956091835');" onmouseout="out('634040011956091835');" style="">  50  import javax.persistence.ManyToMany;                                                                              </span>
<span class="-2638882474121018940" onmouseenter="enter('-2638882474121018940');" onmouseout="out('-2638882474121018940');" style="">  51  import javax.persistence.ManyToOne;                                                                               </span>
<span class="4490236759922497400" onmouseenter="enter('4490236759922497400');" onmouseout="out('4490236759922497400');" style="">  52  import javax.persistence.OneToMany;                                                                               </span>
<span class="-1278149683069486932" onmouseenter="enter('-1278149683069486932');" onmouseout="out('-1278149683069486932');" style="">  53  import javax.persistence.OneToOne;                                                                                </span>
<span  style="">  54                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55  /**                                                                                                               </span>
<span class="-8041280944155159385" onmouseenter="enter('-8041280944155159385');" onmouseout="out('-8041280944155159385');" style=""><abbr title="  56   * Abstract class for copying entities to a new catalog as required during derived catalog propagation. Subclasses generally">  56   * Abstract class for copying entities to a new catalog as required during derived catalog propagation. SubclassesðŸ”µ</abbr></span>
<span class="-627018466353991606" onmouseenter="enter('-627018466353991606');" onmouseout="out('-627018466353991606');" style=""><abbr title="  57   * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.common.site.domain.Catalog, MultiTenantCopyContext)}">  57   * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.comðŸ”µ</abbr></span>
<span class="-416790415154158937" onmouseenter="enter('-416790415154158937');" onmouseout="out('-416790415154158937');" style=""><abbr title="  58   * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and persist">  58   * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and perðŸ”µ</abbr></span>
<span class="5445624896446749929" onmouseenter="enter('5445624896446749929');" onmouseout="out('5445624896446749929');" style="">  59   * an entity object tree.                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  60   *                                                                                                                </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style="">  61   * @author Andre Azzolini (apazzolini)                                                                            </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style="">  62   * @author Jeff Fischer                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63   */                                                                                                               </span>
<span class="-1737666508653679295" onmouseenter="enter('-1737666508653679295');" onmouseout="out('-1737666508653679295');" style="">  64  public abstract class MultiTenantCopier implements Ordered {                                                      </span>
<span class="7878007665356847965" onmouseenter="enter('7878007665356847965');" onmouseout="out('7878007665356847965');" style="">  65      protected static final Log LOG = LogFactory.getLog(MultiTenantCopier.class);                                  </span>
<span  style="">  66                                                                                                                    </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="">  67      @Resource(name = &quot;blGenericEntityService&quot;)                                                                    </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="">  68      protected GenericEntityService genericEntityService;                                                          </span>
<span  style="">  69                                                                                                                    </span>
<span class="-4045496854230922802" onmouseenter="enter('-4045496854230922802');" onmouseout="out('-4045496854230922802');" style="">  70      @Resource(name = &quot;blMultiTenantCopierExtensionManager&quot;)                                                       </span>
<span class="9132557441157356873" onmouseenter="enter('9132557441157356873');" onmouseout="out('9132557441157356873');" style="">  71      protected MultiTenantCopierExtensionManager extensionManager;                                                 </span>
<span  style="">  72                                                                                                                    </span>
<span class="6302352000387574659" onmouseenter="enter('6302352000387574659');" onmouseout="out('6302352000387574659');" style="">  73      @Resource(name=&quot;blStreamingTransactionCapableUtil&quot;)                                                           </span>
<span class="-8080662791692885473" onmouseenter="enter('-8080662791692885473');" onmouseout="out('-8080662791692885473');" style="">  74      protected StreamingTransactionCapableUtil transUtil;                                                          </span>
<span  style="">  75                                                                                                                    </span>
<span class="3478346643346744503" onmouseenter="enter('3478346643346744503');" onmouseout="out('3478346643346744503');" style="">  76      protected int order = 0;                                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -    /**                                                                                                           </span>
<span class="-281239993481985083" onmouseenter="enter('-281239993481985083');" onmouseout="out('-281239993481985083');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -     * @deprecated Please use `classExcludeRegexPatternList`                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -    @Deprecated                                                                                                   </span>
<span class="5650770266649922559" onmouseenter="enter('5650770266649922559');" onmouseout="out('5650770266649922559');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -    protected List&lt;Matcher&gt; classExcludeRegexList = new ArrayList&lt;&gt;();                                            </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84      /**                                                                                                           </span>
<span class="-122049322422344857" onmouseenter="enter('-122049322422344857');" onmouseout="out('-122049322422344857');" style="">  85       * To add elements use {@link #addPattern(Pattern)}                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86       */                                                                                                           </span>
<span class="-4573832410677620492" onmouseenter="enter('-4573832410677620492');" onmouseout="out('-4573832410677620492');" style="">  87      protected List&lt;Pattern&gt; classExcludeRegexPatternList = new ArrayList&lt;&gt;();                                     </span>
<span  style="">  88                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  89      /**                                                                                                           </span>
<span class="2044942771211883310" onmouseenter="enter('2044942771211883310');" onmouseout="out('2044942771211883310');" style="">  90       * Main method that should be implemented by each {@link MultiTenantCopier} to drive the logic of             </span>
<span class="3580574424461635495" onmouseenter="enter('3580574424461635495');" onmouseout="out('3580574424461635495');" style="">  91       * copying that particular entity to the new derived catalog.                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  92       *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="">  93       * @param context                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94       */                                                                                                           </span>
<span class="-6235588905422461924" onmouseenter="enter('-6235588905422461924');" onmouseout="out('-6235588905422461924');" style="">  95      public abstract void copyEntities(MultiTenantCopyContext context) throws Exception;                           </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  97      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  98       *                                                                                                            </span>
<span class="2985577248159931846" onmouseenter="enter('2985577248159931846');" onmouseout="out('2985577248159931846');" style="">  99       * @return the order of this {@link MultiTenantCopier}                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101      @Override                                                                                                     </span>
<span class="-1157866401688879802" onmouseenter="enter('-1157866401688879802');" onmouseout="out('-1157866401688879802');" style=""> 102      public int getOrder() {                                                                                       </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 103          return order;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104      }                                                                                                             </span>
<span  style=""> 105                                                                                                                    </span>
<span class="8078611052580382973" onmouseenter="enter('8078611052580382973');" onmouseout="out('8078611052580382973');" style=""> 106      public void setOrder(int order) {                                                                             </span>
<span class="-6754869500416241760" onmouseenter="enter('-6754869500416241760');" onmouseout="out('-6754869500416241760');" style=""> 107          this.order = order;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108      }                                                                                                             </span>
<span  style=""> 109                                                                                                                    </span>
<span class="-3615357639229759469" onmouseenter="enter('-3615357639229759469');" onmouseout="out('-3615357639229759469');" style=""><abbr title=" 110      protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazz, T original, MultiTenantCopyContext context) throws G {"> 110      protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazzðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 111          try {                                                                                                     </span>
<span class="8848439591475072064" onmouseenter="enter('8848439591475072064');" onmouseout="out('8848439591475072064');" style=""> 112              //don&#x27;t persist if there is already an equivalent present                                             </span>
<span class="-3623402225573308912" onmouseenter="enter('-3623402225573308912');" onmouseout="out('-3623402225573308912');" style=""> 113              if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) != null) { </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 114                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115              }                                                                                                     </span>
<span  style=""> 116                                                                                                                    </span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 117              context.clearOriginalIdentifiers();                                                                   </span>
<span class="-4760173204145292260" onmouseenter="enter('-4760173204145292260');" onmouseout="out('-4760173204145292260');" style=""> 118              genericEntityService.clearAutoFlushMode();                                                            </span>
<span class="-8326881612018417764" onmouseenter="enter('-8326881612018417764');" onmouseout="out('-8326881612018417764');" style=""> 119              Object copy = copyOperation.execute(original);                                                        </span>
<span class="3128798615968492125" onmouseenter="enter('3128798615968492125');" onmouseout="out('3128798615968492125');" style=""> 120              SandBox sandBox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();                  </span>
<span class="6492445518569294809" onmouseenter="enter('6492445518569294809');" onmouseout="out('6492445518569294809');" style=""> 121              DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployState();      </span>
<span class="2163142151434548972" onmouseenter="enter('2163142151434548972');" onmouseout="out('2163142151434548972');" style=""> 122              BroadleafRequestContext.getBroadleafRequestContext().setDeployState(DeployState.PRODUCTION);          </span>
<span class="6572079192165011753" onmouseenter="enter('6572079192165011753');" onmouseout="out('6572079192165011753');" style=""> 123              BroadleafRequestContext.getBroadleafRequestContext().setSandBox(null);                                </span>
<span class="-6104353510353355986" onmouseenter="enter('-6104353510353355986');" onmouseout="out('-6104353510353355986');" style=""><abbr title=" 124              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.FALSE);"> 124              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforðŸ”µ</abbr></span>
<span class="-2148155577856476410" onmouseenter="enter('-2148155577856476410');" onmouseout="out('-2148155577856476410');" style=""> 125              persistCopyObjectTreeInternal(copy, new HashSet&lt;Integer&gt;(), context);                                 </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 126              genericEntityService.flush();                                                                         </span>
<span class="1952764089697360447" onmouseenter="enter('1952764089697360447');" onmouseout="out('1952764089697360447');" style=""> 127              BroadleafRequestContext.getBroadleafRequestContext().setSandBox(sandBox);                             </span>
<span class="2444831964480057831" onmouseenter="enter('2444831964480057831');" onmouseout="out('2444831964480057831');" style=""> 128              BroadleafRequestContext.getBroadleafRequestContext().setDeployState(deployState);                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 129          } catch (Exception e) {                                                                                   </span>
<span class="3675438560154002673" onmouseenter="enter('3675438560154002673');" onmouseout="out('3675438560154002673');" style=""> 130              LOG.error(&quot;Unable to persist the copy object tree&quot;, e);                                               </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 131              throw ExceptionHelper.refineException(e);                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 132          } finally {                                                                                               </span>
<span class="7199875090489075677" onmouseenter="enter('7199875090489075677');" onmouseout="out('7199875090489075677');" style=""><abbr title=" 133              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.TRUE);"> 133              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforðŸ”µ</abbr></span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 134              context.clearOriginalIdentifiers();                                                                   </span>
<span class="-5390342410291425165" onmouseenter="enter('-5390342410291425165');" onmouseout="out('-5390342410291425165');" style=""> 135              genericEntityService.enableAutoFlushMode();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137      }                                                                                                             </span>
<span  style=""> 138                                                                                                                    </span>
<span class="813863986067248403" onmouseenter="enter('813863986067248403');" onmouseout="out('813863986067248403');" style=""><abbr title=" 139      protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext context) {"> 139      protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext contextðŸ”µ</abbr></span>
<span class="4691853715276726963" onmouseenter="enter('4691853715276726963');" onmouseout="out('4691853715276726963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 140 -        // TODO: 1/19/2022 replace excludeFromCopyRegex() with excludeFromCopyRegexPattern() after remove property classExcludeRegexList"> 140 -        // TODO: 1/19/2022 replace excludeFromCopyRegex() with excludeFromCopyRegexPattern() after remove propertyðŸ”µ</abbr></span>
<span class="5726455157241988222" onmouseenter="enter('5726455157241988222');" onmouseout="out('5726455157241988222');" style=""> 141          if (library.contains(System.identityHashCode(copy)) || !(copy instanceof MultiTenantCloneable)            </span>
<span class="-7498285784952003449" onmouseenter="enter('-7498285784952003449');" onmouseout="out('-7498285784952003449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -                || excludeFromCopyRegex(copy)) {                                                                  </span>
<span class="-6757188153093146979" onmouseenter="enter('-6757188153093146979');" onmouseout="out('-6757188153093146979');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +                || this.excludeFromCopyRegexPattern(copy)) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 144              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145          }                                                                                                         </span>
<span class="6099587390698254391" onmouseenter="enter('6099587390698254391');" onmouseout="out('6099587390698254391');" style=""> 146          library.add(System.identityHashCode(copy));                                                               </span>
<span class="-4798752894315625699" onmouseenter="enter('-4798752894315625699');" onmouseout="out('-4798752894315625699');" style=""> 147          List&lt;Object[]&gt; collections = new ArrayList&lt;Object[]&gt;();                                                   </span>
<span class="1437989156315370335" onmouseenter="enter('1437989156315370335');" onmouseout="out('1437989156315370335');" style=""> 148          Field[] allFields = context.getAllFields(copy.getClass());                                                </span>
<span class="2968462139034023970" onmouseenter="enter('2968462139034023970');" onmouseout="out('2968462139034023970');" style=""> 149          for (Field field : allFields) {                                                                           </span>
<span class="-6028825997928669487" onmouseenter="enter('-6028825997928669487');" onmouseout="out('-6028825997928669487');" style=""> 150              if (field.getName().equals(&quot;embeddableSiteDiscriminator&quot;)) {                                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 151                  continue;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152              }                                                                                                     </span>
<span class="2215334239672037801" onmouseenter="enter('2215334239672037801');" onmouseout="out('2215334239672037801');" style=""> 153              if (!Modifier.isStatic(field.getModifiers())) {                                                       </span>
<span class="-242302875073644057" onmouseenter="enter('-242302875073644057');" onmouseout="out('-242302875073644057');" style=""> 154                  field.setAccessible(true);                                                                        </span>
<span class="-3119387060603195319" onmouseenter="enter('-3119387060603195319');" onmouseout="out('-3119387060603195319');" style=""> 155                  Object newTarget;                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 156                  try {                                                                                             </span>
<span class="-1788169810723093055" onmouseenter="enter('-1788169810723093055');" onmouseout="out('-1788169810723093055');" style=""> 157                      newTarget = field.get(copy);                                                                  </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style=""> 158                  } catch (IllegalAccessException e) {                                                              </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 159                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160                  }                                                                                                 </span>
<span class="5292471581137077546" onmouseenter="enter('5292471581137077546');" onmouseout="out('5292471581137077546');" style=""> 161                  if (newTarget != null) {                                                                          </span>
<span class="-4896034365120653328" onmouseenter="enter('-4896034365120653328');" onmouseout="out('-4896034365120653328');" style=""><abbr title=" 162                      if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != null) {"> 162                      if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != nulðŸ”µ</abbr></span>
<span class="-1779560011655050958" onmouseenter="enter('-1779560011655050958');" onmouseout="out('-1779560011655050958');" style=""> 163                          if (library.contains(System.identityHashCode(newTarget))) {                               </span>
<span class="-6882820149046221397" onmouseenter="enter('-6882820149046221397');" onmouseout="out('-6882820149046221397');" style=""> 164                              persistNode(newTarget, context);                                                      </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 165                              continue;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                          }                                                                                         </span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 167                          persistCopyObjectTreeInternal(newTarget, library, context);                               </span>
<span class="-6556217836886273986" onmouseenter="enter('-6556217836886273986');" onmouseout="out('-6556217836886273986');" style=""><abbr title=" 168                      } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.class) != null) {"> 168                      } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.clasðŸ”µ</abbr></span>
<span class="6570005356546170417" onmouseenter="enter('6570005356546170417');" onmouseout="out('6570005356546170417');" style=""> 169                          collections.add(new Object[]{field, newTarget});                                          </span>
<span class="-1287323088547185838" onmouseenter="enter('-1287323088547185838');" onmouseout="out('-1287323088547185838');" style=""><abbr title=" 170                      } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.class.isAssignableFrom(field.getType())) {"> 170                      } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.claðŸ”µ</abbr></span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 171                          persistCopyObjectTreeInternal(newTarget, library, context);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span class="5522223281117737932" onmouseenter="enter('5522223281117737932');" onmouseout="out('5522223281117737932');" style=""> 176          if (copy.getClass().getAnnotation(Embeddable.class) == null) {                                            </span>
<span class="8489885264009154572" onmouseenter="enter('8489885264009154572');" onmouseout="out('8489885264009154572');" style=""> 177              persistNode(copy, context);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178          }                                                                                                         </span>
<span class="7328299556920669788" onmouseenter="enter('7328299556920669788');" onmouseout="out('7328299556920669788');" style=""> 179          for (Object[] collectionItem : collections) {                                                             </span>
<span class="6509881775537642462" onmouseenter="enter('6509881775537642462');" onmouseout="out('6509881775537642462');" style=""> 180              if (collectionItem[1] instanceof Collection) {                                                        </span>
<span class="-4625848514609956673" onmouseenter="enter('-4625848514609956673');" onmouseout="out('-4625848514609956673');" style=""> 181                  Collection newCollection = (Collection) collectionItem[1];                                        </span>
<span class="2236280788008259197" onmouseenter="enter('2236280788008259197');" onmouseout="out('2236280788008259197');" style=""> 182                  for (Object member : newCollection) {                                                             </span>
<span class="559928666155877213" onmouseenter="enter('559928666155877213');" onmouseout="out('559928666155877213');" style=""> 183                      persistCopyObjectTreeInternal(member, library, context);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184                  }                                                                                                 </span>
<span class="-358290731378005197" onmouseenter="enter('-358290731378005197');" onmouseout="out('-358290731378005197');" style=""> 185              } else if (collectionItem[1] instanceof Map) {                                                        </span>
<span class="-8530282384745692595" onmouseenter="enter('-8530282384745692595');" onmouseout="out('-8530282384745692595');" style=""> 186                  Map newMap = (Map) collectionItem[1];                                                             </span>
<span class="-3046213999695776442" onmouseenter="enter('-3046213999695776442');" onmouseout="out('-3046213999695776442');" style=""> 187                  for (Object key : newMap.keySet()) {                                                              </span>
<span class="-4861713825562612226" onmouseenter="enter('-4861713825562612226');" onmouseout="out('-4861713825562612226');" style=""> 188                      persistCopyObjectTreeInternal(newMap.get(key), library, context);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 190              } else {                                                                                              </span>
<span class="2428600337084572914" onmouseenter="enter('2428600337084572914');" onmouseout="out('2428600337084572914');" style=""> 191                  throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; +             </span>
<span class="-7690968681915381732" onmouseenter="enter('-7690968681915381732');" onmouseout="out('-7690968681915381732');" style=""><abbr title=" 192                          &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; +"> 192                          &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currentðŸ”µ</abbr></span>
<span class="858209187721340375" onmouseenter="enter('858209187721340375');" onmouseout="out('858209187721340375');" style=""><abbr title=" 193                          &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItem[0]).getName()));"> 193                          &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -    /**                                                                                                           </span>
<span class="-2109755167911965892" onmouseenter="enter('-2109755167911965892');" onmouseout="out('-2109755167911965892');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -     * @deprecated Please use `excludeFromCopyRegexPattern()`                                                     </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -     * @param copy Copy object                                                                                    </span>
<span class="-3117498416103589290" onmouseenter="enter('-3117498416103589290');" onmouseout="out('-3117498416103589290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -     * @return excluded or not in Regex                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -    @Deprecated                                                                                                   </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -    protected Boolean excludeFromCopyRegex(final Object copy) {                                                   </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -        boolean match = false;                                                                                    </span>
<span class="6056842869149907005" onmouseenter="enter('6056842869149907005');" onmouseout="out('6056842869149907005');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -        if (this.classExcludeRegexPatternList.isEmpty()) {                                                        </span>
<span class="2905094200958410231" onmouseenter="enter('2905094200958410231');" onmouseout="out('2905094200958410231');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            LOG.warn(&quot;classExcludeRegexPatternList is empty, deprecated classExcludeRegexList is used&quot;);          </span>


<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -            for (Matcher regex : this.classExcludeRegexList) {                                                    </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                if (regex.reset(copy.getClass().toString()).matches()) {                                          </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -                    match = true;                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                    break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -        } else {                                                                                                  </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -           match = this.excludeFromCopyRegexPattern(copy);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -        }                                                                                                         </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -        return match;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218      }                                                                                                             </span>
<span  style=""> 219                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 220      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 221       *                                                                                                            </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 222       * @param copy Copy object                                                                                    </span>
<span class="-794768860455465512" onmouseenter="enter('-794768860455465512');" onmouseout="out('-794768860455465512');" style=""> 223       * @return excluded or not in patterns                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 224       */                                                                                                           </span>
<span class="6972780348503080990" onmouseenter="enter('6972780348503080990');" onmouseout="out('6972780348503080990');" style=""> 225      protected Boolean excludeFromCopyRegexPattern(final Object copy) {                                            </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 226          boolean match = false;                                                                                    </span>
<span class="-3926064167940700035" onmouseenter="enter('-3926064167940700035');" onmouseout="out('-3926064167940700035');" style=""> 227          for (final Pattern pattern : this.classExcludeRegexPatternList) {                                         </span>
<span class="6367080919039942315" onmouseenter="enter('6367080919039942315');" onmouseout="out('6367080919039942315');" style=""> 228              final Matcher matcher = pattern.matcher(copy.getClass().toString());                                  </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 229              if (matcher.matches()) {                                                                              </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 230                  match = true;                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 231                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233          }                                                                                                         </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 234          return match;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235      }                                                                                                             </span>
<span  style=""> 236                                                                                                                    </span>
<span class="-8032468969933703819" onmouseenter="enter('-8032468969933703819');" onmouseout="out('-8032468969933703819');" style=""> 237      protected void persistNode(final Object copy, final MultiTenantCopyContext context) {                         </span>
<span class="7987568954533399833" onmouseenter="enter('7987568954533399833');" onmouseout="out('7987568954533399833');" style=""> 238          if (!genericEntityService.sessionContains(copy) &amp;&amp; !genericEntityService.idAssigned(copy)) {              </span>
<span class="8681842502075417653" onmouseenter="enter('8681842502075417653');" onmouseout="out('8681842502075417653');" style=""><abbr title=" 239              final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.removeOriginalIdentifier(copy));"> 239              final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.remoðŸ”µ</abbr></span>
<span class="-5090759614318459505" onmouseenter="enter('-5090759614318459505');" onmouseout="out('-5090759614318459505');" style=""> 240              extensionManager.getProxy().transformCopy(context, original, copy);                                   </span>
<span class="4297838893803910408" onmouseenter="enter('4297838893803910408');" onmouseout="out('4297838893803910408');" style=""> 241              extensionManager.getProxy().prepareForSave(context, original, copy);                                  </span>
<span  style=""> 242                                                                                                                    </span>
<span class="-8752421726777980004" onmouseenter="enter('-8752421726777980004');" onmouseout="out('-8752421726777980004');" style=""> 243              IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;() {     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 244                  @Override                                                                                         </span>
<span class="-8659131798736023396" onmouseenter="enter('-8659131798736023396');" onmouseout="out('-8659131798736023396');" style=""> 245                  public Void execute() {                                                                           </span>
<span class="-9045674711737912799" onmouseenter="enter('-9045674711737912799');" onmouseout="out('-9045674711737912799');" style=""> 246                      genericEntityService.persist(copy);                                                           </span>
<span class="2025772996566147876" onmouseenter="enter('2025772996566147876');" onmouseout="out('2025772996566147876');" style=""> 247                      extensionManager.getProxy().postSave(context, original, copy);                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 248                      return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249                  }                                                                                                 </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 250              }, context.getToSite(), context.getToSite(), context.getToCatalog());                                 </span>
<span  style=""> 251                                                                                                                    </span>
<span class="-7681066818147012496" onmouseenter="enter('-7681066818147012496');" onmouseout="out('-7681066818147012496');" style=""><abbr title=" 252              context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), context.getIdentifier(copy));"> 252              context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), contextðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254      }                                                                                                             </span>
<span  style=""> 255                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 256      /**                                                                                                           </span>
<span class="-8073168593296919506" onmouseenter="enter('-8073168593296919506');" onmouseout="out('-8073168593296919506');" style=""><abbr title=" 257       * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementation."> 257       * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 258       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 259       * @param clazz                                                                                               </span>
<span class="3646661620596311758" onmouseenter="enter('3646661620596311758');" onmouseout="out('3646661620596311758');" style=""> 260       * @param fromSite                                                                                            </span>
<span class="8125408689844361908" onmouseenter="enter('8125408689844361908');" onmouseout="out('8125408689844361908');" style=""> 261       * @param fromCatalog                                                                                         </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 262       * @param context                                                                                             </span>
<span class="5977767735151043102" onmouseenter="enter('5977767735151043102');" onmouseout="out('5977767735151043102');" style=""> 263       * @param &lt;T&gt;                                                                                                 </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 264       * @throws ServiceException                                                                                   </span>
<span class="-2651377028902862562" onmouseenter="enter('-2651377028902862562');" onmouseout="out('-2651377028902862562');" style=""> 265       * @throws CloneNotSupportedException                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 266       */                                                                                                           </span>
<span class="872769015085653006" onmouseenter="enter('872769015085653006');" onmouseout="out('872769015085653006');" style=""><abbr title=" 267      protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, final Catalog fromCatalog, final MultiTenantCopyContext context)"> 267      protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, ðŸ”µ</abbr></span>
<span class="8092245223016329648" onmouseenter="enter('8092245223016329648');" onmouseout="out('8092245223016329648');" style=""> 268              throws ServiceException, CloneNotSupportedException {                                                 </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 269          genericEntityService.flush();                                                                             </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 270          genericEntityService.clear();                                                                             </span>
<span class="6078548138955406640" onmouseenter="enter('6078548138955406640');" onmouseout="out('6078548138955406640');" style=""> 271          transUtil.runStreamingTransactionalOperation(new StreamCapableTransactionalOperationAdapter() {           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 272              @Override                                                                                             </span>
<span class="-4097688009913453744" onmouseenter="enter('-4097688009913453744');" onmouseout="out('-4097688009913453744');" style=""> 273              public Object[] retrievePage(int startPos, int pageSize) {                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 274                  try {                                                                                             </span>
<span class="-6654678464986381896" onmouseenter="enter('-6654678464986381896');" onmouseout="out('-6654678464986381896');" style=""> 275                      Object[] temp = new Object[1];                                                                </span>
<span class="-1074208970495142702" onmouseenter="enter('-1074208970495142702');" onmouseout="out('-1074208970495142702');" style=""> 276                      List&lt;T&gt; results = readAll(clazz, pageSize, startPos, fromSite, fromCatalog);                  </span>
<span class="2620576066975874715" onmouseenter="enter('2620576066975874715');" onmouseout="out('2620576066975874715');" style=""> 277                      temp[0] = results;                                                                            </span>
<span class="-3847030593865588422" onmouseenter="enter('-3847030593865588422');" onmouseout="out('-3847030593865588422');" style=""> 278                      return temp;                                                                                  </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 279                  } catch (ServiceException e) {                                                                    </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 280                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282              }                                                                                                     </span>
<span  style=""> 283                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 284              @Override                                                                                             </span>
<span class="6279129438695530603" onmouseenter="enter('6279129438695530603');" onmouseout="out('6279129438695530603');" style=""> 285              public void pagedExecute(Object[] param) throws Throwable {                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 286                  try {                                                                                             </span>
<span class="2324184862033110442" onmouseenter="enter('2324184862033110442');" onmouseout="out('2324184862033110442');" style=""> 287                      List&lt;T&gt; results = (List&lt;T&gt;) param[0];                                                         </span>
<span class="-7383605119906788487" onmouseenter="enter('-7383605119906788487');" onmouseout="out('-7383605119906788487');" style=""> 288                      for (T result : results) {                                                                    </span>
<span class="-2673391330205902743" onmouseenter="enter('-2673391330205902743');" onmouseout="out('-2673391330205902743');" style=""> 289                          persistCopyObjectTree(new CopyOperation&lt;T, CloneNotSupportedException&gt;() {                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 290                              @Override                                                                             </span>
<span class="-8939809480293479644" onmouseenter="enter('-8939809480293479644');" onmouseout="out('-8939809480293479644');" style=""> 291                              public T execute(T original) throws CloneNotSupportedException {                      </span>
<span class="-5091972823585019460" onmouseenter="enter('-5091972823585019460');" onmouseout="out('-5091972823585019460');" style=""> 292                                  return (T) original.createOrRetrieveCopyInstance(context).getClone();             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293                              }                                                                                     </span>
<span class="3899565736356446794" onmouseenter="enter('3899565736356446794');" onmouseout="out('3899565736356446794');" style=""> 294                          }, clazz, result, context);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295                      }                                                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 296                  } finally {                                                                                       </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 297                      genericEntityService.clear();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299              }                                                                                                     </span>
<span  style=""> 300                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 301              @Override                                                                                             </span>
<span class="-2604993651595386294" onmouseenter="enter('-2604993651595386294');" onmouseout="out('-2604993651595386294');" style=""> 302              public Long retrieveTotalCount() {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 303                  try {                                                                                             </span>
<span class="6601113330436234291" onmouseenter="enter('6601113330436234291');" onmouseout="out('6601113330436234291');" style=""> 304                      return readCount(clazz, fromSite, fromCatalog);                                               </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 305                  } catch (ServiceException e) {                                                                    </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 306                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308              }                                                                                                     </span>
<span  style=""> 309                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 310              @Override                                                                                             </span>
<span class="1336357167460974281" onmouseenter="enter('1336357167460974281');" onmouseout="out('1336357167460974281');" style=""> 311              public boolean shouldRetryOnTransactionLockAcquisitionFailure() {                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 312                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313              }                                                                                                     </span>
<span class="-3417072119495989863" onmouseenter="enter('-3417072119495989863');" onmouseout="out('-3417072119495989863');" style=""> 314          }, RuntimeException.class);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315      }                                                                                                             </span>
<span  style=""> 316                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 317      /**                                                                                                           </span>
<span class="-8433738365892647070" onmouseenter="enter('-8433738365892647070');" onmouseout="out('-8433738365892647070');" style=""> 318       * Saves the specified object in the toSite and toCatalog of the given context.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 319       *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 320       * @param context                                                                                             </span>
<span class="7689578750101732801" onmouseenter="enter('7689578750101732801');" onmouseout="out('7689578750101732801');" style=""> 321       * @param object                                                                                              </span>
<span class="6893734882299737905" onmouseenter="enter('6893734882299737905');" onmouseout="out('6893734882299737905');" style=""> 322       * @return the saved entity                                                                                   </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 323       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 324       */                                                                                                           </span>
<span class="5212394141372864718" onmouseenter="enter('5212394141372864718');" onmouseout="out('5212394141372864718');" style=""> 325      protected &lt;T&gt; T save(MultiTenantCopyContext context, final T object) throws ServiceException {                </span>
<span class="-1099504713577842018" onmouseenter="enter('-1099504713577842018');" onmouseout="out('-1099504713577842018');" style=""> 326          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;() {     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 327              @Override                                                                                             </span>
<span class="4151681128977710489" onmouseenter="enter('4151681128977710489');" onmouseout="out('4151681128977710489');" style=""> 328              public T execute() throws ServiceException {                                                          </span>
<span class="-380270513562060751" onmouseenter="enter('-380270513562060751');" onmouseout="out('-380270513562060751');" style=""> 329                  return genericEntityService.save(object);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330              }                                                                                                     </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 331          }, context.getToSite(), context.getToSite(), context.getToCatalog());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 334      /**                                                                                                           </span>
<span class="-7601540533988835340" onmouseenter="enter('-7601540533988835340');" onmouseout="out('-7601540533988835340');" style=""> 335       * Returns the count of the given entity class for the specified site and catalog                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 336       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 337       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 338       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 339       * @param catalog                                                                                             </span>
<span class="-3150840522218520736" onmouseenter="enter('-3150840522218520736');" onmouseout="out('-3150840522218520736');" style=""> 340       * @return the count                                                                                          </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 341       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 342       */                                                                                                           </span>
<span class="-3128834492857774013" onmouseenter="enter('-3128834492857774013');" onmouseout="out('-3128834492857774013');" style=""> 343      protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {      </span>
<span class="2183944127153439224" onmouseenter="enter('2183944127153439224');" onmouseout="out('2183944127153439224');" style=""> 344          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceException&gt;() {  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 345              @Override                                                                                             </span>
<span class="3590332160508681130" onmouseenter="enter('3590332160508681130');" onmouseout="out('3590332160508681130');" style=""> 346              public Long execute() throws ServiceException {                                                       </span>
<span class="-8909345086268725459" onmouseenter="enter('-8909345086268725459');" onmouseout="out('-8909345086268725459');" style=""> 347                  return genericEntityService.readCountGenericEntity(clazz);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 349          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350      }                                                                                                             </span>
<span  style=""> 351                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 352      /**                                                                                                           </span>
<span class="-8874952311237548171" onmouseenter="enter('-8874952311237548171');" onmouseout="out('-8874952311237548171');" style=""> 353       * @see #readAll(Class, int, int, Site, Catalog)                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 354       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 355       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 356       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 357       * @param catalog                                                                                             </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 358       * @return the list of entities for the specified parameters                                                  </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 359       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 360       */                                                                                                           </span>
<span class="-2591408295637802722" onmouseenter="enter('-2591408295637802722');" onmouseout="out('-2591408295637802722');" style=""> 361      protected &lt;T&gt; List&lt;T&gt; readAll(Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {           </span>
<span class="6989523363313544241" onmouseenter="enter('6989523363313544241');" onmouseout="out('6989523363313544241');" style=""> 362          return readAll(clazz, Integer.MAX_VALUE, 0, site, catalog);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363      }                                                                                                             </span>
<span  style=""> 364                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 365      /**                                                                                                           </span>
<span class="-7182426246277913548" onmouseenter="enter('-7182426246277913548');" onmouseout="out('-7182426246277913548');" style=""> 366       * Returns the primary key values for all entities of the specified type in the site or catalog.              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 367       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 368       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 369       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 370       * @param catalog                                                                                             </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 371       * @return                                                                                                    </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 372       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 373       */                                                                                                           </span>
<span class="5724457752579000562" onmouseenter="enter('5724457752579000562');" onmouseout="out('5724457752579000562');" style=""> 374      protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceException {   </span>
<span class="1548172976235084004" onmouseenter="enter('1548172976235084004');" onmouseout="out('1548172976235084004');" style=""><abbr title=" 375          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;() {"> 375          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 376              @Override                                                                                             </span>
<span class="-1864674537507723626" onmouseenter="enter('-1864674537507723626');" onmouseout="out('-1864674537507723626');" style=""> 377              public List&lt;Long&gt; execute() throws ServiceException {                                                 </span>
<span class="1470706729559019118" onmouseenter="enter('1470706729559019118');" onmouseout="out('1470706729559019118');" style=""> 378                  return genericEntityService.readAllGenericEntityId(clazz);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 380          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381      }                                                                                                             </span>
<span  style=""> 382                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 383      /**                                                                                                           </span>
<span class="-9001665139725221341" onmouseenter="enter('-9001665139725221341');" onmouseout="out('-9001665139725221341');" style=""> 384       * Returns a list of all entities in the system for the given class, site, and catalog. Additionally,         </span>
<span class="8612534793136264631" onmouseenter="enter('8612534793136264631');" onmouseout="out('8612534793136264631');" style=""> 385       * this method supports pagination.                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 386       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 387       * @param clazz                                                                                               </span>
<span class="-2517112653327253967" onmouseenter="enter('-2517112653327253967');" onmouseout="out('-2517112653327253967');" style=""> 388       * @param limit                                                                                               </span>
<span class="-1129619468702068661" onmouseenter="enter('-1129619468702068661');" onmouseout="out('-1129619468702068661');" style=""> 389       * @param offset                                                                                              </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 390       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 391       * @param catalog                                                                                             </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 392       * @return the list of entities for the specified parameters                                                  </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 393       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 394       */                                                                                                           </span>
<span class="3970621926802578022" onmouseenter="enter('3970621926802578022');" onmouseout="out('3970621926802578022');" style=""> 395      protected &lt;T&gt; List&lt;T&gt; readAll(final Class&lt;T&gt; clazz, final int limit, final int offset, Site site,             </span>
<span class="-1250257878122023702" onmouseenter="enter('-1250257878122023702');" onmouseout="out('-1250257878122023702');" style=""> 396              Catalog catalog) throws ServiceException {                                                            </span>
<span class="466374425591711697" onmouseenter="enter('466374425591711697');" onmouseout="out('466374425591711697');" style=""><abbr title=" 397          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() {"> 397          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 398              @Override                                                                                             </span>
<span class="2544604179721060437" onmouseenter="enter('2544604179721060437');" onmouseout="out('2544604179721060437');" style=""> 399              public List&lt;T&gt; execute() throws ServiceException {                                                    </span>
<span class="-7182433549032782374" onmouseenter="enter('-7182433549032782374');" onmouseout="out('-7182433549032782374');" style=""> 400                  return genericEntityService.readAllGenericEntity(clazz, limit, offset);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 402          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403      }                                                                                                             </span>
<span  style=""> 404                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 405      /**                                                                                                           </span>
<span class="-2791201834401909051" onmouseenter="enter('-2791201834401909051');" onmouseout="out('-2791201834401909051');" style=""> 406       * Checks for similar items before adding to avoid duplication                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 407       *                                                                                                            </span>
<span class="-3657783928704768726" onmouseenter="enter('-3657783928704768726');" onmouseout="out('-3657783928704768726');" style=""> 408       * @param pattern input pattern                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 409       */                                                                                                           </span>
<span class="-4846906708761894704" onmouseenter="enter('-4846906708761894704');" onmouseout="out('-4846906708761894704');" style=""> 410      protected void addPattern(final Pattern pattern) {                                                            </span>
<span class="5859550306873716729" onmouseenter="enter('5859550306873716729');" onmouseout="out('5859550306873716729');" style=""> 411          if (this.needToAdd(pattern)) {                                                                            </span>
<span class="4416844535423030775" onmouseenter="enter('4416844535423030775');" onmouseout="out('4416844535423030775');" style=""> 412              this.classExcludeRegexPatternList.add(pattern);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414      }                                                                                                             </span>
<span  style=""> 415                                                                                                                    </span>
<span class="-7848998461890921050" onmouseenter="enter('-7848998461890921050');" onmouseout="out('-7848998461890921050');" style=""> 416      protected boolean needToAdd(final Pattern pattern) {                                                          </span>
<span class="-6062616619578034043" onmouseenter="enter('-6062616619578034043');" onmouseout="out('-6062616619578034043');" style=""> 417          boolean exist = false;                                                                                    </span>
<span class="5993689843013964459" onmouseenter="enter('5993689843013964459');" onmouseout="out('5993689843013964459');" style=""> 418          for (Pattern item : this.classExcludeRegexPatternList) {                                                  </span>
<span class="-2198741654006431688" onmouseenter="enter('-2198741654006431688');" onmouseout="out('-2198741654006431688');" style=""> 419              if (item.pattern().equals(pattern.pattern())) {                                                       </span>
<span class="-4447673499306073413" onmouseenter="enter('-4447673499306073413');" onmouseout="out('-4447673499306073413');" style=""> 420                  exist = true;                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 421                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423          }                                                                                                         </span>
<span class="-2598905690734194618" onmouseenter="enter('-2598905690734194618');" onmouseout="out('-2598905690734194618');" style=""> 424          return !exist;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425      }                                                                                                             </span>
<span  style=""> 426                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-4573490878212285276" onmouseenter="enter('-4573490878212285276');" onmouseout="out('-4573490878212285276');" style="">   3   * BroadleafCommerce Common Libraries                                                                             </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-1160938633668984164" onmouseenter="enter('-1160938633668984164');" onmouseout="out('-1160938633668984164');" style="">  18  package org.broadleafcommerce.common.copy;                                                                        </span>
<span  style="">  19                                                                                                                    </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  20  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  21  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="-9066890226896155571" onmouseenter="enter('-9066890226896155571');" onmouseout="out('-9066890226896155571');" style="">  22  import org.broadleafcommerce.common.exception.ExceptionHelper;                                                    </span>
<span class="5945096539699516699" onmouseenter="enter('5945096539699516699');" onmouseout="out('5945096539699516699');" style="">  23  import org.broadleafcommerce.common.exception.ServiceException;                                                   </span>
<span class="4081669836921876898" onmouseenter="enter('4081669836921876898');" onmouseout="out('4081669836921876898');" style="">  24  import org.broadleafcommerce.common.sandbox.domain.SandBox;                                                       </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  25  import org.broadleafcommerce.common.service.GenericEntityService;                                                 </span>
<span class="-4286566313930798693" onmouseenter="enter('-4286566313930798693');" onmouseout="out('-4286566313930798693');" style="">  26  import org.broadleafcommerce.common.site.domain.Catalog;                                                          </span>
<span class="3350833871385260454" onmouseenter="enter('3350833871385260454');" onmouseout="out('3350833871385260454');" style="">  27  import org.broadleafcommerce.common.site.domain.Site;                                                             </span>
<span class="5712948414688687719" onmouseenter="enter('5712948414688687719');" onmouseout="out('5712948414688687719');" style="">  28  import org.broadleafcommerce.common.util.StreamCapableTransactionalOperationAdapter;                              </span>
<span class="3798869978454175791" onmouseenter="enter('3798869978454175791');" onmouseout="out('3798869978454175791');" style="">  29  import org.broadleafcommerce.common.util.StreamingTransactionCapableUtil;                                         </span>
<span class="5413521702958049593" onmouseenter="enter('5413521702958049593');" onmouseout="out('5413521702958049593');" style="">  30  import org.broadleafcommerce.common.util.tenant.IdentityExecutionUtils;                                           </span>
<span class="2334451492079531669" onmouseenter="enter('2334451492079531669');" onmouseout="out('2334451492079531669');" style="">  31  import org.broadleafcommerce.common.util.tenant.IdentityOperation;                                                </span>
<span class="8689743329875302887" onmouseenter="enter('8689743329875302887');" onmouseout="out('8689743329875302887');" style="">  32  import org.broadleafcommerce.common.web.BroadleafRequestContext;                                                  </span>
<span class="2584309252308847990" onmouseenter="enter('2584309252308847990');" onmouseout="out('2584309252308847990');" style="">  33  import org.broadleafcommerce.common.web.DeployState;                                                              </span>
<span class="6105195614559590838" onmouseenter="enter('6105195614559590838');" onmouseout="out('6105195614559590838');" style="">  34  import org.broadleafcommerce.common.web.EnforceEnterpriseCollectionBehaviorState;                                 </span>
<span class="-5036922012441036669" onmouseenter="enter('-5036922012441036669');" onmouseout="out('-5036922012441036669');" style="">  35  import org.springframework.core.Ordered;                                                                          </span>
<span  style="">  36                                                                                                                    </span>
<span class="507320133330553151" onmouseenter="enter('507320133330553151');" onmouseout="out('507320133330553151');" style="">  37  import java.lang.reflect.Field;                                                                                   </span>
<span class="1546464639948964552" onmouseenter="enter('1546464639948964552');" onmouseout="out('1546464639948964552');" style="">  38  import java.lang.reflect.Modifier;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  39  import java.util.ArrayList;                                                                                       </span>
<span class="-112105277767313938" onmouseenter="enter('-112105277767313938');" onmouseout="out('-112105277767313938');" style="">  40  import java.util.Collection;                                                                                      </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  43  import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  44  import java.util.Set;                                                                                             </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  45  import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  46  import java.util.regex.Pattern;                                                                                   </span>
<span  style="">  47                                                                                                                    </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  48  import javax.annotation.Resource;                                                                                 </span>
<span class="5429236160528371227" onmouseenter="enter('5429236160528371227');" onmouseout="out('5429236160528371227');" style="">  49  import javax.persistence.Embeddable;                                                                              </span>
<span class="634040011956091835" onmouseenter="enter('634040011956091835');" onmouseout="out('634040011956091835');" style="">  50  import javax.persistence.ManyToMany;                                                                              </span>
<span class="-2638882474121018940" onmouseenter="enter('-2638882474121018940');" onmouseout="out('-2638882474121018940');" style="">  51  import javax.persistence.ManyToOne;                                                                               </span>
<span class="4490236759922497400" onmouseenter="enter('4490236759922497400');" onmouseout="out('4490236759922497400');" style="">  52  import javax.persistence.OneToMany;                                                                               </span>
<span class="-1278149683069486932" onmouseenter="enter('-1278149683069486932');" onmouseout="out('-1278149683069486932');" style="">  53  import javax.persistence.OneToOne;                                                                                </span>
<span  style="">  54                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55  /**                                                                                                               </span>
<span class="-8041280944155159385" onmouseenter="enter('-8041280944155159385');" onmouseout="out('-8041280944155159385');" style=""><abbr title="  56   * Abstract class for copying entities to a new catalog as required during derived catalog propagation. Subclasses generally">  56   * Abstract class for copying entities to a new catalog as required during derived catalog propagation. SubclassesðŸ”µ</abbr></span>
<span class="-627018466353991606" onmouseenter="enter('-627018466353991606');" onmouseout="out('-627018466353991606');" style=""><abbr title="  57   * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.common.site.domain.Catalog, MultiTenantCopyContext)}">  57   * call {@link #copyEntitiesOfType(Class, org.broadleafcommerce.common.site.domain.Site, org.broadleafcommerce.comðŸ”µ</abbr></span>
<span class="-416790415154158937" onmouseenter="enter('-416790415154158937');" onmouseout="out('-416790415154158937');" style=""><abbr title="  58   * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and persist">  58   * one or more times inside of their {@link #copyEntities(MultiTenantCopyContext)} implementation to clone and perðŸ”µ</abbr></span>
<span class="5445624896446749929" onmouseenter="enter('5445624896446749929');" onmouseout="out('5445624896446749929');" style="">  59   * an entity object tree.                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  60   *                                                                                                                </span>
<span class="-346667533686466806" onmouseenter="enter('-346667533686466806');" onmouseout="out('-346667533686466806');" style="">  61   * @author Andre Azzolini (apazzolini)                                                                            </span>
<span class="-7311139588847938491" onmouseenter="enter('-7311139588847938491');" onmouseout="out('-7311139588847938491');" style="">  62   * @author Jeff Fischer                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63   */                                                                                                               </span>
<span class="-1737666508653679295" onmouseenter="enter('-1737666508653679295');" onmouseout="out('-1737666508653679295');" style="">  64  public abstract class MultiTenantCopier implements Ordered {                                                      </span>
<span class="7878007665356847965" onmouseenter="enter('7878007665356847965');" onmouseout="out('7878007665356847965');" style="">  65      protected static final Log LOG = LogFactory.getLog(MultiTenantCopier.class);                                  </span>
<span  style="">  66                                                                                                                    </span>
<span class="2258512980686044159" onmouseenter="enter('2258512980686044159');" onmouseout="out('2258512980686044159');" style="">  67      @Resource(name = &quot;blGenericEntityService&quot;)                                                                    </span>
<span class="7024198528514174971" onmouseenter="enter('7024198528514174971');" onmouseout="out('7024198528514174971');" style="">  68      protected GenericEntityService genericEntityService;                                                          </span>
<span  style="">  69                                                                                                                    </span>
<span class="-4045496854230922802" onmouseenter="enter('-4045496854230922802');" onmouseout="out('-4045496854230922802');" style="">  70      @Resource(name = &quot;blMultiTenantCopierExtensionManager&quot;)                                                       </span>
<span class="9132557441157356873" onmouseenter="enter('9132557441157356873');" onmouseout="out('9132557441157356873');" style="">  71      protected MultiTenantCopierExtensionManager extensionManager;                                                 </span>
<span  style="">  72                                                                                                                    </span>
<span class="6302352000387574659" onmouseenter="enter('6302352000387574659');" onmouseout="out('6302352000387574659');" style="">  73      @Resource(name=&quot;blStreamingTransactionCapableUtil&quot;)                                                           </span>
<span class="-8080662791692885473" onmouseenter="enter('-8080662791692885473');" onmouseout="out('-8080662791692885473');" style="">  74      protected StreamingTransactionCapableUtil transUtil;                                                          </span>
<span  style="">  75                                                                                                                    </span>
<span class="3478346643346744503" onmouseenter="enter('3478346643346744503');" onmouseout="out('3478346643346744503');" style="">  76      protected int order = 0;                                                                                      </span>
<span  style="">  77                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  78      /**                                                                                                           </span>
<span class="-281239993481985083" onmouseenter="enter('-281239993481985083');" onmouseout="out('-281239993481985083');" style="">  79       * @deprecated Please use `classExcludeRegexPatternList`                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  81      @Deprecated                                                                                                   </span>
<span class="5650770266649922559" onmouseenter="enter('5650770266649922559');" onmouseout="out('5650770266649922559');" style="">  82      protected List&lt;Matcher&gt; classExcludeRegexList = new ArrayList&lt;&gt;();                                            </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84      /**                                                                                                           </span>
<span class="-122049322422344857" onmouseenter="enter('-122049322422344857');" onmouseout="out('-122049322422344857');" style="">  85       * To add elements use {@link #addPattern(Pattern)}                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86       */                                                                                                           </span>
<span class="-4573832410677620492" onmouseenter="enter('-4573832410677620492');" onmouseout="out('-4573832410677620492');" style="">  87      protected List&lt;Pattern&gt; classExcludeRegexPatternList = new ArrayList&lt;&gt;();                                     </span>
<span  style="">  88                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  89      /**                                                                                                           </span>
<span class="2044942771211883310" onmouseenter="enter('2044942771211883310');" onmouseout="out('2044942771211883310');" style="">  90       * Main method that should be implemented by each {@link MultiTenantCopier} to drive the logic of             </span>
<span class="3580574424461635495" onmouseenter="enter('3580574424461635495');" onmouseout="out('3580574424461635495');" style="">  91       * copying that particular entity to the new derived catalog.                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  92       *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="">  93       * @param context                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94       */                                                                                                           </span>
<span class="-6235588905422461924" onmouseenter="enter('-6235588905422461924');" onmouseout="out('-6235588905422461924');" style="">  95      public abstract void copyEntities(MultiTenantCopyContext context) throws Exception;                           </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  97      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  98       *                                                                                                            </span>
<span class="2985577248159931846" onmouseenter="enter('2985577248159931846');" onmouseout="out('2985577248159931846');" style="">  99       * @return the order of this {@link MultiTenantCopier}                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101      @Override                                                                                                     </span>
<span class="-1157866401688879802" onmouseenter="enter('-1157866401688879802');" onmouseout="out('-1157866401688879802');" style=""> 102      public int getOrder() {                                                                                       </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 103          return order;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104      }                                                                                                             </span>
<span  style=""> 105                                                                                                                    </span>
<span class="8078611052580382973" onmouseenter="enter('8078611052580382973');" onmouseout="out('8078611052580382973');" style=""> 106      public void setOrder(int order) {                                                                             </span>
<span class="-6754869500416241760" onmouseenter="enter('-6754869500416241760');" onmouseout="out('-6754869500416241760');" style=""> 107          this.order = order;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108      }                                                                                                             </span>
<span  style=""> 109                                                                                                                    </span>
<span class="-3615357639229759469" onmouseenter="enter('-3615357639229759469');" onmouseout="out('-3615357639229759469');" style=""><abbr title=" 110      protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazz, T original, MultiTenantCopyContext context) throws G {"> 110      protected &lt;T, G extends Exception&gt; void persistCopyObjectTree(CopyOperation&lt;T,G&gt; copyOperation, Class&lt;T&gt; clazzðŸ”µ</abbr></span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 111          try {                                                                                                     </span>
<span class="8848439591475072064" onmouseenter="enter('8848439591475072064');" onmouseout="out('8848439591475072064');" style=""> 112              //don&#x27;t persist if there is already an equivalent present                                             </span>
<span class="-3623402225573308912" onmouseenter="enter('-3623402225573308912');" onmouseout="out('-3623402225573308912');" style=""> 113              if (context.getEquivalentId(clazz.getName(), genericEntityService.getIdentifier(original)) != null) { </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 114                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115              }                                                                                                     </span>
<span  style=""> 116                                                                                                                    </span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 117              context.clearOriginalIdentifiers();                                                                   </span>
<span class="-4760173204145292260" onmouseenter="enter('-4760173204145292260');" onmouseout="out('-4760173204145292260');" style=""> 118              genericEntityService.clearAutoFlushMode();                                                            </span>
<span class="-8326881612018417764" onmouseenter="enter('-8326881612018417764');" onmouseout="out('-8326881612018417764');" style=""> 119              Object copy = copyOperation.execute(original);                                                        </span>
<span class="3128798615968492125" onmouseenter="enter('3128798615968492125');" onmouseout="out('3128798615968492125');" style=""> 120              SandBox sandBox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();                  </span>
<span class="6492445518569294809" onmouseenter="enter('6492445518569294809');" onmouseout="out('6492445518569294809');" style=""> 121              DeployState deployState = BroadleafRequestContext.getBroadleafRequestContext().getDeployState();      </span>
<span class="2163142151434548972" onmouseenter="enter('2163142151434548972');" onmouseout="out('2163142151434548972');" style=""> 122              BroadleafRequestContext.getBroadleafRequestContext().setDeployState(DeployState.PRODUCTION);          </span>
<span class="6572079192165011753" onmouseenter="enter('6572079192165011753');" onmouseout="out('6572079192165011753');" style=""> 123              BroadleafRequestContext.getBroadleafRequestContext().setSandBox(null);                                </span>
<span class="-6104353510353355986" onmouseenter="enter('-6104353510353355986');" onmouseout="out('-6104353510353355986');" style=""><abbr title=" 124              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.FALSE);"> 124              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforðŸ”µ</abbr></span>
<span class="-2148155577856476410" onmouseenter="enter('-2148155577856476410');" onmouseout="out('-2148155577856476410');" style=""> 125              persistCopyObjectTreeInternal(copy, new HashSet&lt;Integer&gt;(), context);                                 </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 126              genericEntityService.flush();                                                                         </span>
<span class="1952764089697360447" onmouseenter="enter('1952764089697360447');" onmouseout="out('1952764089697360447');" style=""> 127              BroadleafRequestContext.getBroadleafRequestContext().setSandBox(sandBox);                             </span>
<span class="2444831964480057831" onmouseenter="enter('2444831964480057831');" onmouseout="out('2444831964480057831');" style=""> 128              BroadleafRequestContext.getBroadleafRequestContext().setDeployState(deployState);                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 129          } catch (Exception e) {                                                                                   </span>
<span class="3675438560154002673" onmouseenter="enter('3675438560154002673');" onmouseout="out('3675438560154002673');" style=""> 130              LOG.error(&quot;Unable to persist the copy object tree&quot;, e);                                               </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 131              throw ExceptionHelper.refineException(e);                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 132          } finally {                                                                                               </span>
<span class="7199875090489075677" onmouseenter="enter('7199875090489075677');" onmouseout="out('7199875090489075677');" style=""><abbr title=" 133              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforceEnterpriseCollectionBehaviorState.TRUE);"> 133              BroadleafRequestContext.getBroadleafRequestContext().setEnforceEnterpriseCollectionBehaviorState(EnforðŸ”µ</abbr></span>
<span class="-6720950436976592470" onmouseenter="enter('-6720950436976592470');" onmouseout="out('-6720950436976592470');" style=""> 134              context.clearOriginalIdentifiers();                                                                   </span>
<span class="-5390342410291425165" onmouseenter="enter('-5390342410291425165');" onmouseout="out('-5390342410291425165');" style=""> 135              genericEntityService.enableAutoFlushMode();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137      }                                                                                                             </span>
<span  style=""> 138                                                                                                                    </span>
<span class="813863986067248403" onmouseenter="enter('813863986067248403');" onmouseout="out('813863986067248403');" style=""><abbr title=" 139      protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext context) {"> 139      protected void persistCopyObjectTreeInternal(Object copy, Set&lt;Integer&gt; library, MultiTenantCopyContext contextðŸ”µ</abbr></span>
<span class="4691853715276726963" onmouseenter="enter('4691853715276726963');" onmouseout="out('4691853715276726963');" style=""><abbr title=" 140          // TODO: 1/19/2022 replace excludeFromCopyRegex() with excludeFromCopyRegexPattern() after remove property classExcludeRegexList"> 140          // TODO: 1/19/2022 replace excludeFromCopyRegex() with excludeFromCopyRegexPattern() after remove propertyðŸ”µ</abbr></span>
<span class="5726455157241988222" onmouseenter="enter('5726455157241988222');" onmouseout="out('5726455157241988222');" style=""> 141          if (library.contains(System.identityHashCode(copy)) || !(copy instanceof MultiTenantCloneable)            </span>
<span class="-7498285784952003449" onmouseenter="enter('-7498285784952003449');" onmouseout="out('-7498285784952003449');" style=""> 142                  || excludeFromCopyRegex(copy)) {                                                                  </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 143              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144          }                                                                                                         </span>
<span class="6099587390698254391" onmouseenter="enter('6099587390698254391');" onmouseout="out('6099587390698254391');" style=""> 145          library.add(System.identityHashCode(copy));                                                               </span>
<span class="-4798752894315625699" onmouseenter="enter('-4798752894315625699');" onmouseout="out('-4798752894315625699');" style=""> 146          List&lt;Object[]&gt; collections = new ArrayList&lt;Object[]&gt;();                                                   </span>
<span class="1437989156315370335" onmouseenter="enter('1437989156315370335');" onmouseout="out('1437989156315370335');" style=""> 147          Field[] allFields = context.getAllFields(copy.getClass());                                                </span>
<span class="2968462139034023970" onmouseenter="enter('2968462139034023970');" onmouseout="out('2968462139034023970');" style=""> 148          for (Field field : allFields) {                                                                           </span>
<span class="-6028825997928669487" onmouseenter="enter('-6028825997928669487');" onmouseout="out('-6028825997928669487');" style=""> 149              if (field.getName().equals(&quot;embeddableSiteDiscriminator&quot;)) {                                          </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 150                  continue;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151              }                                                                                                     </span>
<span class="2215334239672037801" onmouseenter="enter('2215334239672037801');" onmouseout="out('2215334239672037801');" style=""> 152              if (!Modifier.isStatic(field.getModifiers())) {                                                       </span>
<span class="-242302875073644057" onmouseenter="enter('-242302875073644057');" onmouseout="out('-242302875073644057');" style=""> 153                  field.setAccessible(true);                                                                        </span>
<span class="-3119387060603195319" onmouseenter="enter('-3119387060603195319');" onmouseout="out('-3119387060603195319');" style=""> 154                  Object newTarget;                                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 155                  try {                                                                                             </span>
<span class="-1788169810723093055" onmouseenter="enter('-1788169810723093055');" onmouseout="out('-1788169810723093055');" style=""> 156                      newTarget = field.get(copy);                                                                  </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style=""> 157                  } catch (IllegalAccessException e) {                                                              </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 158                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159                  }                                                                                                 </span>
<span class="5292471581137077546" onmouseenter="enter('5292471581137077546');" onmouseout="out('5292471581137077546');" style=""> 160                  if (newTarget != null) {                                                                          </span>
<span class="-4896034365120653328" onmouseenter="enter('-4896034365120653328');" onmouseout="out('-4896034365120653328');" style=""><abbr title=" 161                      if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != null) {"> 161                      if (field.getAnnotation(ManyToOne.class) != null || field.getAnnotation(OneToOne.class) != nulðŸ”µ</abbr></span>
<span class="-1779560011655050958" onmouseenter="enter('-1779560011655050958');" onmouseout="out('-1779560011655050958');" style=""> 162                          if (library.contains(System.identityHashCode(newTarget))) {                               </span>
<span class="-6882820149046221397" onmouseenter="enter('-6882820149046221397');" onmouseout="out('-6882820149046221397');" style=""> 163                              persistNode(newTarget, context);                                                      </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 164                              continue;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165                          }                                                                                         </span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 166                          persistCopyObjectTreeInternal(newTarget, library, context);                               </span>
<span class="-6556217836886273986" onmouseenter="enter('-6556217836886273986');" onmouseout="out('-6556217836886273986');" style=""><abbr title=" 167                      } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.class) != null) {"> 167                      } else if (field.getAnnotation(ManyToMany.class) != null || field.getAnnotation(OneToMany.clasðŸ”µ</abbr></span>
<span class="6570005356546170417" onmouseenter="enter('6570005356546170417');" onmouseout="out('6570005356546170417');" style=""> 168                          collections.add(new Object[]{field, newTarget});                                          </span>
<span class="-1287323088547185838" onmouseenter="enter('-1287323088547185838');" onmouseout="out('-1287323088547185838');" style=""><abbr title=" 169                      } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.class.isAssignableFrom(field.getType())) {"> 169                      } else if (field.getType().getAnnotation(Embeddable.class) != null &amp;&amp; MultiTenantCloneable.claðŸ”µ</abbr></span>
<span class="-1275949606548442650" onmouseenter="enter('-1275949606548442650');" onmouseout="out('-1275949606548442650');" style=""> 170                          persistCopyObjectTreeInternal(newTarget, library, context);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174          }                                                                                                         </span>
<span class="5522223281117737932" onmouseenter="enter('5522223281117737932');" onmouseout="out('5522223281117737932');" style=""> 175          if (copy.getClass().getAnnotation(Embeddable.class) == null) {                                            </span>
<span class="8489885264009154572" onmouseenter="enter('8489885264009154572');" onmouseout="out('8489885264009154572');" style=""> 176              persistNode(copy, context);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177          }                                                                                                         </span>
<span class="7328299556920669788" onmouseenter="enter('7328299556920669788');" onmouseout="out('7328299556920669788');" style=""> 178          for (Object[] collectionItem : collections) {                                                             </span>
<span class="6509881775537642462" onmouseenter="enter('6509881775537642462');" onmouseout="out('6509881775537642462');" style=""> 179              if (collectionItem[1] instanceof Collection) {                                                        </span>
<span class="-4625848514609956673" onmouseenter="enter('-4625848514609956673');" onmouseout="out('-4625848514609956673');" style=""> 180                  Collection newCollection = (Collection) collectionItem[1];                                        </span>
<span class="2236280788008259197" onmouseenter="enter('2236280788008259197');" onmouseout="out('2236280788008259197');" style=""> 181                  for (Object member : newCollection) {                                                             </span>
<span class="559928666155877213" onmouseenter="enter('559928666155877213');" onmouseout="out('559928666155877213');" style=""> 182                      persistCopyObjectTreeInternal(member, library, context);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183                  }                                                                                                 </span>
<span class="-358290731378005197" onmouseenter="enter('-358290731378005197');" onmouseout="out('-358290731378005197');" style=""> 184              } else if (collectionItem[1] instanceof Map) {                                                        </span>
<span class="-8530282384745692595" onmouseenter="enter('-8530282384745692595');" onmouseout="out('-8530282384745692595');" style=""> 185                  Map newMap = (Map) collectionItem[1];                                                             </span>
<span class="-3046213999695776442" onmouseenter="enter('-3046213999695776442');" onmouseout="out('-3046213999695776442');" style=""> 186                  for (Object key : newMap.keySet()) {                                                              </span>
<span class="-4861713825562612226" onmouseenter="enter('-4861713825562612226');" onmouseout="out('-4861713825562612226');" style=""> 187                      persistCopyObjectTreeInternal(newMap.get(key), library, context);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 189              } else {                                                                                              </span>
<span class="2428600337084572914" onmouseenter="enter('2428600337084572914');" onmouseout="out('2428600337084572914');" style=""> 190                  throw new IllegalArgumentException(String.format(&quot;During copy object persistence, &quot; +             </span>
<span class="-7690968681915381732" onmouseenter="enter('-7690968681915381732');" onmouseout="out('-7690968681915381732');" style=""><abbr title=" 191                          &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currently only &quot; +"> 191                          &quot;an unrecognized type was detected for a OneToMany or ManyToMany field. The system currentðŸ”µ</abbr></span>
<span class="858209187721340375" onmouseenter="enter('858209187721340375');" onmouseout="out('858209187721340375');" style=""><abbr title=" 192                          &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItem[0]).getName()));"> 192                          &quot;recognizes Collection and Map. (%s.%s)&quot;, copy.getClass().getName(), ((Field) collectionItðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 197      /**                                                                                                           </span>
<span class="-2109755167911965892" onmouseenter="enter('-2109755167911965892');" onmouseout="out('-2109755167911965892');" style=""> 198       * @deprecated Please use `excludeFromCopyRegexPattern()`                                                     </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 199       * @param copy Copy object                                                                                    </span>
<span class="-3117498416103589290" onmouseenter="enter('-3117498416103589290');" onmouseout="out('-3117498416103589290');" style=""> 200       * @return excluded or not in Regex                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 201       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 202      @Deprecated                                                                                                   </span>
<span class="-8261755492427087281" onmouseenter="enter('-8261755492427087281');" onmouseout="out('-8261755492427087281');" style=""> 203      protected Boolean excludeFromCopyRegex(final Object copy) {                                                   </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 204          boolean match = false;                                                                                    </span>
<span class="6056842869149907005" onmouseenter="enter('6056842869149907005');" onmouseout="out('6056842869149907005');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -        if (this.classExcludeRegexPatternList.isEmpty()) {                                                        </span>
<span class="2905094200958410231" onmouseenter="enter('2905094200958410231');" onmouseout="out('2905094200958410231');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            LOG.warn(&quot;classExcludeRegexPatternList is empty, deprecated classExcludeRegexList is used&quot;);          </span>
<span class="1887246492796491771" onmouseenter="enter('1887246492796491771');" onmouseout="out('1887246492796491771');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 207 +        if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.classExcludeRegexList.isEmpty()) {"> 207 +        if (this.classExcludeRegexPatternList.isEmpty() &amp;&amp; this.classExcludeRegexList!=null &amp;&amp; !this.classExcludeRðŸ”µ</abbr></span>
<span class="-2273049754217814272" onmouseenter="enter('-2273049754217814272');" onmouseout="out('-2273049754217814272');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 208 +            LOG.warn(&quot;classExcludeRegexList is deprecated, please use excludeFromCopyRegexPattern&quot;);              </span>
<span class="-8465419059765369921" onmouseenter="enter('-8465419059765369921');" onmouseout="out('-8465419059765369921');" style=""> 209              for (Matcher regex : this.classExcludeRegexList) {                                                    </span>
<span class="5579778321350642821" onmouseenter="enter('5579778321350642821');" onmouseout="out('5579778321350642821');" style=""> 210                  if (regex.reset(copy.getClass().toString()).matches()) {                                          </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 211                      match = true;                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 212                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 215          } else {                                                                                                  </span>
<span class="-8657816627360388161" onmouseenter="enter('-8657816627360388161');" onmouseout="out('-8657816627360388161');" style=""> 216             match = this.excludeFromCopyRegexPattern(copy);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217          }                                                                                                         </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 218          return match;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219      }                                                                                                             </span>
<span  style=""> 220                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 221      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 222       *                                                                                                            </span>
<span class="-41113129756321704" onmouseenter="enter('-41113129756321704');" onmouseout="out('-41113129756321704');" style=""> 223       * @param copy Copy object                                                                                    </span>
<span class="-794768860455465512" onmouseenter="enter('-794768860455465512');" onmouseout="out('-794768860455465512');" style=""> 224       * @return excluded or not in patterns                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 225       */                                                                                                           </span>
<span class="6972780348503080990" onmouseenter="enter('6972780348503080990');" onmouseout="out('6972780348503080990');" style=""> 226      protected Boolean excludeFromCopyRegexPattern(final Object copy) {                                            </span>
<span class="5621962555482743154" onmouseenter="enter('5621962555482743154');" onmouseout="out('5621962555482743154');" style=""> 227          boolean match = false;                                                                                    </span>
<span class="-3926064167940700035" onmouseenter="enter('-3926064167940700035');" onmouseout="out('-3926064167940700035');" style=""> 228          for (final Pattern pattern : this.classExcludeRegexPatternList) {                                         </span>
<span class="6367080919039942315" onmouseenter="enter('6367080919039942315');" onmouseout="out('6367080919039942315');" style=""> 229              final Matcher matcher = pattern.matcher(copy.getClass().toString());                                  </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 230              if (matcher.matches()) {                                                                              </span>
<span class="7490956173827231322" onmouseenter="enter('7490956173827231322');" onmouseout="out('7490956173827231322');" style=""> 231                  match = true;                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 232                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234          }                                                                                                         </span>
<span class="-6303193278298097701" onmouseenter="enter('-6303193278298097701');" onmouseout="out('-6303193278298097701');" style=""> 235          return match;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236      }                                                                                                             </span>
<span  style=""> 237                                                                                                                    </span>
<span class="-8032468969933703819" onmouseenter="enter('-8032468969933703819');" onmouseout="out('-8032468969933703819');" style=""> 238      protected void persistNode(final Object copy, final MultiTenantCopyContext context) {                         </span>
<span class="7987568954533399833" onmouseenter="enter('7987568954533399833');" onmouseout="out('7987568954533399833');" style=""> 239          if (!genericEntityService.sessionContains(copy) &amp;&amp; !genericEntityService.idAssigned(copy)) {              </span>
<span class="8681842502075417653" onmouseenter="enter('8681842502075417653');" onmouseout="out('8681842502075417653');" style=""><abbr title=" 240              final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.removeOriginalIdentifier(copy));"> 240              final Object original = genericEntityService.readGenericEntity(copy.getClass().getName(), context.remoðŸ”µ</abbr></span>
<span class="-5090759614318459505" onmouseenter="enter('-5090759614318459505');" onmouseout="out('-5090759614318459505');" style=""> 241              extensionManager.getProxy().transformCopy(context, original, copy);                                   </span>
<span class="4297838893803910408" onmouseenter="enter('4297838893803910408');" onmouseout="out('4297838893803910408');" style=""> 242              extensionManager.getProxy().prepareForSave(context, original, copy);                                  </span>
<span  style=""> 243                                                                                                                    </span>
<span class="-8752421726777980004" onmouseenter="enter('-8752421726777980004');" onmouseout="out('-8752421726777980004');" style=""> 244              IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Void, RuntimeException&gt;() {     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 245                  @Override                                                                                         </span>
<span class="-8659131798736023396" onmouseenter="enter('-8659131798736023396');" onmouseout="out('-8659131798736023396');" style=""> 246                  public Void execute() {                                                                           </span>
<span class="-9045674711737912799" onmouseenter="enter('-9045674711737912799');" onmouseout="out('-9045674711737912799');" style=""> 247                      genericEntityService.persist(copy);                                                           </span>
<span class="2025772996566147876" onmouseenter="enter('2025772996566147876');" onmouseout="out('2025772996566147876');" style=""> 248                      extensionManager.getProxy().postSave(context, original, copy);                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 249                      return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250                  }                                                                                                 </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 251              }, context.getToSite(), context.getToSite(), context.getToCatalog());                                 </span>
<span  style=""> 252                                                                                                                    </span>
<span class="-7681066818147012496" onmouseenter="enter('-7681066818147012496');" onmouseout="out('-7681066818147012496');" style=""><abbr title=" 253              context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), context.getIdentifier(copy));"> 253              context.storeEquivalentMapping(original.getClass().getName(), context.getIdentifier(original), contextðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255      }                                                                                                             </span>
<span  style=""> 256                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 257      /**                                                                                                           </span>
<span class="-8073168593296919506" onmouseenter="enter('-8073168593296919506');" onmouseout="out('-8073168593296919506');" style=""><abbr title=" 258       * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementation."> 258       * Subclasses will generally call this method in their {@link #copyEntities(MultiTenantCopyContext)} implementðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 259       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 260       * @param clazz                                                                                               </span>
<span class="3646661620596311758" onmouseenter="enter('3646661620596311758');" onmouseout="out('3646661620596311758');" style=""> 261       * @param fromSite                                                                                            </span>
<span class="8125408689844361908" onmouseenter="enter('8125408689844361908');" onmouseout="out('8125408689844361908');" style=""> 262       * @param fromCatalog                                                                                         </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 263       * @param context                                                                                             </span>
<span class="5977767735151043102" onmouseenter="enter('5977767735151043102');" onmouseout="out('5977767735151043102');" style=""> 264       * @param &lt;T&gt;                                                                                                 </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 265       * @throws ServiceException                                                                                   </span>
<span class="-2651377028902862562" onmouseenter="enter('-2651377028902862562');" onmouseout="out('-2651377028902862562');" style=""> 266       * @throws CloneNotSupportedException                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 267       */                                                                                                           </span>
<span class="872769015085653006" onmouseenter="enter('872769015085653006');" onmouseout="out('872769015085653006');" style=""><abbr title=" 268      protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, final Catalog fromCatalog, final MultiTenantCopyContext context)"> 268      protected &lt;T extends MultiTenantCloneable&gt; void copyEntitiesOfType(final Class&lt;T&gt; clazz, final Site fromSite, ðŸ”µ</abbr></span>
<span class="8092245223016329648" onmouseenter="enter('8092245223016329648');" onmouseout="out('8092245223016329648');" style=""> 269              throws ServiceException, CloneNotSupportedException {                                                 </span>
<span class="4293027928449017715" onmouseenter="enter('4293027928449017715');" onmouseout="out('4293027928449017715');" style=""> 270          genericEntityService.flush();                                                                             </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 271          genericEntityService.clear();                                                                             </span>
<span class="6078548138955406640" onmouseenter="enter('6078548138955406640');" onmouseout="out('6078548138955406640');" style=""> 272          transUtil.runStreamingTransactionalOperation(new StreamCapableTransactionalOperationAdapter() {           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 273              @Override                                                                                             </span>
<span class="-4097688009913453744" onmouseenter="enter('-4097688009913453744');" onmouseout="out('-4097688009913453744');" style=""> 274              public Object[] retrievePage(int startPos, int pageSize) {                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 275                  try {                                                                                             </span>
<span class="-6654678464986381896" onmouseenter="enter('-6654678464986381896');" onmouseout="out('-6654678464986381896');" style=""> 276                      Object[] temp = new Object[1];                                                                </span>
<span class="-1074208970495142702" onmouseenter="enter('-1074208970495142702');" onmouseout="out('-1074208970495142702');" style=""> 277                      List&lt;T&gt; results = readAll(clazz, pageSize, startPos, fromSite, fromCatalog);                  </span>
<span class="2620576066975874715" onmouseenter="enter('2620576066975874715');" onmouseout="out('2620576066975874715');" style=""> 278                      temp[0] = results;                                                                            </span>
<span class="-3847030593865588422" onmouseenter="enter('-3847030593865588422');" onmouseout="out('-3847030593865588422');" style=""> 279                      return temp;                                                                                  </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 280                  } catch (ServiceException e) {                                                                    </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 281                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283              }                                                                                                     </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285              @Override                                                                                             </span>
<span class="6279129438695530603" onmouseenter="enter('6279129438695530603');" onmouseout="out('6279129438695530603');" style=""> 286              public void pagedExecute(Object[] param) throws Throwable {                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 287                  try {                                                                                             </span>
<span class="2324184862033110442" onmouseenter="enter('2324184862033110442');" onmouseout="out('2324184862033110442');" style=""> 288                      List&lt;T&gt; results = (List&lt;T&gt;) param[0];                                                         </span>
<span class="-7383605119906788487" onmouseenter="enter('-7383605119906788487');" onmouseout="out('-7383605119906788487');" style=""> 289                      for (T result : results) {                                                                    </span>
<span class="-2673391330205902743" onmouseenter="enter('-2673391330205902743');" onmouseout="out('-2673391330205902743');" style=""> 290                          persistCopyObjectTree(new CopyOperation&lt;T, CloneNotSupportedException&gt;() {                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 291                              @Override                                                                             </span>
<span class="-8939809480293479644" onmouseenter="enter('-8939809480293479644');" onmouseout="out('-8939809480293479644');" style=""> 292                              public T execute(T original) throws CloneNotSupportedException {                      </span>
<span class="-5091972823585019460" onmouseenter="enter('-5091972823585019460');" onmouseout="out('-5091972823585019460');" style=""> 293                                  return (T) original.createOrRetrieveCopyInstance(context).getClone();             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294                              }                                                                                     </span>
<span class="3899565736356446794" onmouseenter="enter('3899565736356446794');" onmouseout="out('3899565736356446794');" style=""> 295                          }, clazz, result, context);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296                      }                                                                                             </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 297                  } finally {                                                                                       </span>
<span class="-5066901638979941371" onmouseenter="enter('-5066901638979941371');" onmouseout="out('-5066901638979941371');" style=""> 298                      genericEntityService.clear();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300              }                                                                                                     </span>
<span  style=""> 301                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 302              @Override                                                                                             </span>
<span class="-2604993651595386294" onmouseenter="enter('-2604993651595386294');" onmouseout="out('-2604993651595386294');" style=""> 303              public Long retrieveTotalCount() {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 304                  try {                                                                                             </span>
<span class="6601113330436234291" onmouseenter="enter('6601113330436234291');" onmouseout="out('6601113330436234291');" style=""> 305                      return readCount(clazz, fromSite, fromCatalog);                                               </span>
<span class="9220844322816084446" onmouseenter="enter('9220844322816084446');" onmouseout="out('9220844322816084446');" style=""> 306                  } catch (ServiceException e) {                                                                    </span>
<span class="-1035238313469204420" onmouseenter="enter('-1035238313469204420');" onmouseout="out('-1035238313469204420');" style=""> 307                      throw ExceptionHelper.refineException(e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309              }                                                                                                     </span>
<span  style=""> 310                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 311              @Override                                                                                             </span>
<span class="1336357167460974281" onmouseenter="enter('1336357167460974281');" onmouseout="out('1336357167460974281');" style=""> 312              public boolean shouldRetryOnTransactionLockAcquisitionFailure() {                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 313                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314              }                                                                                                     </span>
<span class="-3417072119495989863" onmouseenter="enter('-3417072119495989863');" onmouseout="out('-3417072119495989863');" style=""> 315          }, RuntimeException.class);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316      }                                                                                                             </span>
<span  style=""> 317                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 318      /**                                                                                                           </span>
<span class="-8433738365892647070" onmouseenter="enter('-8433738365892647070');" onmouseout="out('-8433738365892647070');" style=""> 319       * Saves the specified object in the toSite and toCatalog of the given context.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 320       *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style=""> 321       * @param context                                                                                             </span>
<span class="7689578750101732801" onmouseenter="enter('7689578750101732801');" onmouseout="out('7689578750101732801');" style=""> 322       * @param object                                                                                              </span>
<span class="6893734882299737905" onmouseenter="enter('6893734882299737905');" onmouseout="out('6893734882299737905');" style=""> 323       * @return the saved entity                                                                                   </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 324       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 325       */                                                                                                           </span>
<span class="5212394141372864718" onmouseenter="enter('5212394141372864718');" onmouseout="out('5212394141372864718');" style=""> 326      protected &lt;T&gt; T save(MultiTenantCopyContext context, final T object) throws ServiceException {                </span>
<span class="-1099504713577842018" onmouseenter="enter('-1099504713577842018');" onmouseout="out('-1099504713577842018');" style=""> 327          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;T, ServiceException&gt;() {     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 328              @Override                                                                                             </span>
<span class="4151681128977710489" onmouseenter="enter('4151681128977710489');" onmouseout="out('4151681128977710489');" style=""> 329              public T execute() throws ServiceException {                                                          </span>
<span class="-380270513562060751" onmouseenter="enter('-380270513562060751');" onmouseout="out('-380270513562060751');" style=""> 330                  return genericEntityService.save(object);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331              }                                                                                                     </span>
<span class="4757538537599158288" onmouseenter="enter('4757538537599158288');" onmouseout="out('4757538537599158288');" style=""> 332          }, context.getToSite(), context.getToSite(), context.getToCatalog());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333      }                                                                                                             </span>
<span  style=""> 334                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 335      /**                                                                                                           </span>
<span class="-7601540533988835340" onmouseenter="enter('-7601540533988835340');" onmouseout="out('-7601540533988835340');" style=""> 336       * Returns the count of the given entity class for the specified site and catalog                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 337       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 338       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 339       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 340       * @param catalog                                                                                             </span>
<span class="-3150840522218520736" onmouseenter="enter('-3150840522218520736');" onmouseout="out('-3150840522218520736');" style=""> 341       * @return the count                                                                                          </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 342       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 343       */                                                                                                           </span>
<span class="-3128834492857774013" onmouseenter="enter('-3128834492857774013');" onmouseout="out('-3128834492857774013');" style=""> 344      protected &lt;T&gt; Long readCount(final Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {      </span>
<span class="2183944127153439224" onmouseenter="enter('2183944127153439224');" onmouseout="out('2183944127153439224');" style=""> 345          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;Long, ServiceException&gt;() {  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 346              @Override                                                                                             </span>
<span class="3590332160508681130" onmouseenter="enter('3590332160508681130');" onmouseout="out('3590332160508681130');" style=""> 347              public Long execute() throws ServiceException {                                                       </span>
<span class="-8909345086268725459" onmouseenter="enter('-8909345086268725459');" onmouseout="out('-8909345086268725459');" style=""> 348                  return genericEntityService.readCountGenericEntity(clazz);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 350          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351      }                                                                                                             </span>
<span  style=""> 352                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 353      /**                                                                                                           </span>
<span class="-8874952311237548171" onmouseenter="enter('-8874952311237548171');" onmouseout="out('-8874952311237548171');" style=""> 354       * @see #readAll(Class, int, int, Site, Catalog)                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 355       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 356       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 357       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 358       * @param catalog                                                                                             </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 359       * @return the list of entities for the specified parameters                                                  </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 360       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 361       */                                                                                                           </span>
<span class="-2591408295637802722" onmouseenter="enter('-2591408295637802722');" onmouseout="out('-2591408295637802722');" style=""> 362      protected &lt;T&gt; List&lt;T&gt; readAll(Class&lt;T&gt; clazz, Site site, Catalog catalog) throws ServiceException {           </span>
<span class="6989523363313544241" onmouseenter="enter('6989523363313544241');" onmouseout="out('6989523363313544241');" style=""> 363          return readAll(clazz, Integer.MAX_VALUE, 0, site, catalog);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364      }                                                                                                             </span>
<span  style=""> 365                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 366      /**                                                                                                           </span>
<span class="-7182426246277913548" onmouseenter="enter('-7182426246277913548');" onmouseout="out('-7182426246277913548');" style=""> 367       * Returns the primary key values for all entities of the specified type in the site or catalog.              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 368       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 369       * @param clazz                                                                                               </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 370       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 371       * @param catalog                                                                                             </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 372       * @return                                                                                                    </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 373       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 374       */                                                                                                           </span>
<span class="5724457752579000562" onmouseenter="enter('5724457752579000562');" onmouseout="out('5724457752579000562');" style=""> 375      protected List&lt;Long&gt; readAllIds(final Class&lt;?&gt; clazz, Site site, Catalog catalog) throws ServiceException {   </span>
<span class="1548172976235084004" onmouseenter="enter('1548172976235084004');" onmouseout="out('1548172976235084004');" style=""><abbr title=" 376          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;() {"> 376          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;Long&gt;, ServiceException&gt;ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 377              @Override                                                                                             </span>
<span class="-1864674537507723626" onmouseenter="enter('-1864674537507723626');" onmouseout="out('-1864674537507723626');" style=""> 378              public List&lt;Long&gt; execute() throws ServiceException {                                                 </span>
<span class="1470706729559019118" onmouseenter="enter('1470706729559019118');" onmouseout="out('1470706729559019118');" style=""> 379                  return genericEntityService.readAllGenericEntityId(clazz);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 381          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382      }                                                                                                             </span>
<span  style=""> 383                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 384      /**                                                                                                           </span>
<span class="-9001665139725221341" onmouseenter="enter('-9001665139725221341');" onmouseout="out('-9001665139725221341');" style=""> 385       * Returns a list of all entities in the system for the given class, site, and catalog. Additionally,         </span>
<span class="8612534793136264631" onmouseenter="enter('8612534793136264631');" onmouseout="out('8612534793136264631');" style=""> 386       * this method supports pagination.                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 387       *                                                                                                            </span>
<span class="-1010432721666394719" onmouseenter="enter('-1010432721666394719');" onmouseout="out('-1010432721666394719');" style=""> 388       * @param clazz                                                                                               </span>
<span class="-2517112653327253967" onmouseenter="enter('-2517112653327253967');" onmouseout="out('-2517112653327253967');" style=""> 389       * @param limit                                                                                               </span>
<span class="-1129619468702068661" onmouseenter="enter('-1129619468702068661');" onmouseout="out('-1129619468702068661');" style=""> 390       * @param offset                                                                                              </span>
<span class="-3969369595605470057" onmouseenter="enter('-3969369595605470057');" onmouseout="out('-3969369595605470057');" style=""> 391       * @param site                                                                                                </span>
<span class="-736589774527067681" onmouseenter="enter('-736589774527067681');" onmouseout="out('-736589774527067681');" style=""> 392       * @param catalog                                                                                             </span>
<span class="3754768187017727675" onmouseenter="enter('3754768187017727675');" onmouseout="out('3754768187017727675');" style=""> 393       * @return the list of entities for the specified parameters                                                  </span>
<span class="8449301783782133383" onmouseenter="enter('8449301783782133383');" onmouseout="out('8449301783782133383');" style=""> 394       * @throws ServiceException                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 395       */                                                                                                           </span>
<span class="3970621926802578022" onmouseenter="enter('3970621926802578022');" onmouseout="out('3970621926802578022');" style=""> 396      protected &lt;T&gt; List&lt;T&gt; readAll(final Class&lt;T&gt; clazz, final int limit, final int offset, Site site,             </span>
<span class="-1250257878122023702" onmouseenter="enter('-1250257878122023702');" onmouseout="out('-1250257878122023702');" style=""> 397              Catalog catalog) throws ServiceException {                                                            </span>
<span class="466374425591711697" onmouseenter="enter('466374425591711697');" onmouseout="out('466374425591711697');" style=""><abbr title=" 398          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() {"> 398          return IdentityExecutionUtils.runOperationByIdentifier(new IdentityOperation&lt;List&lt;T&gt;, ServiceException&gt;() ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 399              @Override                                                                                             </span>
<span class="2544604179721060437" onmouseenter="enter('2544604179721060437');" onmouseout="out('2544604179721060437');" style=""> 400              public List&lt;T&gt; execute() throws ServiceException {                                                    </span>
<span class="-7182433549032782374" onmouseenter="enter('-7182433549032782374');" onmouseout="out('-7182433549032782374');" style=""> 401                  return genericEntityService.readAllGenericEntity(clazz, limit, offset);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402              }                                                                                                     </span>
<span class="-4150172629765370975" onmouseenter="enter('-4150172629765370975');" onmouseout="out('-4150172629765370975');" style=""> 403          }, site, site, catalog);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404      }                                                                                                             </span>
<span  style=""> 405                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 406      /**                                                                                                           </span>
<span class="-2791201834401909051" onmouseenter="enter('-2791201834401909051');" onmouseout="out('-2791201834401909051');" style=""> 407       * Checks for similar items before adding to avoid duplication                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 408       *                                                                                                            </span>
<span class="-3657783928704768726" onmouseenter="enter('-3657783928704768726');" onmouseout="out('-3657783928704768726');" style=""> 409       * @param pattern input pattern                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 410       */                                                                                                           </span>
<span class="-4846906708761894704" onmouseenter="enter('-4846906708761894704');" onmouseout="out('-4846906708761894704');" style=""> 411      protected void addPattern(final Pattern pattern) {                                                            </span>
<span class="5859550306873716729" onmouseenter="enter('5859550306873716729');" onmouseout="out('5859550306873716729');" style=""> 412          if (this.needToAdd(pattern)) {                                                                            </span>
<span class="4416844535423030775" onmouseenter="enter('4416844535423030775');" onmouseout="out('4416844535423030775');" style=""> 413              this.classExcludeRegexPatternList.add(pattern);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415      }                                                                                                             </span>
<span  style=""> 416                                                                                                                    </span>
<span class="-7848998461890921050" onmouseenter="enter('-7848998461890921050');" onmouseout="out('-7848998461890921050');" style=""> 417      protected boolean needToAdd(final Pattern pattern) {                                                          </span>
<span class="-6062616619578034043" onmouseenter="enter('-6062616619578034043');" onmouseout="out('-6062616619578034043');" style=""> 418          boolean exist = false;                                                                                    </span>
<span class="5993689843013964459" onmouseenter="enter('5993689843013964459');" onmouseout="out('5993689843013964459');" style=""> 419          for (Pattern item : this.classExcludeRegexPatternList) {                                                  </span>
<span class="-2198741654006431688" onmouseenter="enter('-2198741654006431688');" onmouseout="out('-2198741654006431688');" style=""> 420              if (item.pattern().equals(pattern.pattern())) {                                                       </span>
<span class="-4447673499306073413" onmouseenter="enter('-4447673499306073413');" onmouseout="out('-4447673499306073413');" style=""> 421                  exist = true;                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 422                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424          }                                                                                                         </span>
<span class="-2598905690734194618" onmouseenter="enter('-2598905690734194618');" onmouseout="out('-2598905690734194618');" style=""> 425          return !exist;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426      }                                                                                                             </span>
<span  style=""> 427                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            