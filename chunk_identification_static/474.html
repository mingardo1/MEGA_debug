<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>474</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    474
                    <a href="473.html">prev</a>
                    <a href="475.html">next</a>
                    <a href="474_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_e346a804d69c8cd0124b4eb3d35156cfb5cd0779_kudu/kudu-side/kudu-async-side/src/main/java/com/dtstack/flink/sql/side/kudu/KuduAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779:kudu/kudu-side/kudu-async-side/src/main/java/com/dtstack/flink/sql/side/kudu/KuduAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^1:kudu/kudu-side/kudu-async-side/src/main/java/com/dtstack/flink/sql/side/kudu/KuduAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^2:kudu/kudu-side/kudu-async-side/src/main/java/com/dtstack/flink/sql/side/kudu/KuduAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6e351a99f6e8449c76ad55e517a5da6cbb108379:kudu/kudu-side/kudu-async-side/src/main/java/com/dtstack/flink/sql/side/kudu/KuduAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [j]], subset: [[b], [b], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-8840953368027741170" onmouseenter="enter('-8840953368027741170');" onmouseout="out('-8840953368027741170');" style="">   1 package com.dtstack.flink.sql.side.kudu;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">   3 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">   4 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">   5 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">   6 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">   7 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">   8 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">   9 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  10 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5710642889135375263" onmouseenter="enter('5710642889135375263');" onmouseout="out('5710642889135375263');" style="">  11 import com.dtstack.flink.sql.side.kudu.table.KuduSideTableInfo;                                          </span>
<span class="1164335795537447661" onmouseenter="enter('1164335795537447661');" onmouseout="out('1164335795537447661');" style="">  12 import com.dtstack.flink.sql.side.kudu.utils.KuduUtil;                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  13 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  14 import com.google.common.collect.Maps;                                                                   </span>
<span class="-5750625329012831967" onmouseenter="enter('-5750625329012831967');" onmouseout="out('-5750625329012831967');" style="">  15 import com.stumbleupon.async.Callback;                                                                   </span>
<span class="-5487067255628915347" onmouseenter="enter('-5487067255628915347');" onmouseout="out('-5487067255628915347');" style="">  16 import com.stumbleupon.async.Deferred;                                                                   </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  17 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  18 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  19 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  20 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  21 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  22 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  23 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  24 import org.apache.flink.util.Preconditions;                                                              </span>
<span class="1631232015531818624" onmouseenter="enter('1631232015531818624');" onmouseout="out('1631232015531818624');" style="">  25 import org.apache.kudu.ColumnSchema;                                                                     </span>
<span class="-1755042893780385624" onmouseenter="enter('-1755042893780385624');" onmouseout="out('-1755042893780385624');" style="">  26 import org.apache.kudu.Schema;                                                                           </span>
<span class="7204708202450962745" onmouseenter="enter('7204708202450962745');" onmouseout="out('7204708202450962745');" style="">  27 import org.apache.kudu.client.AsyncKuduClient;                                                           </span>
<span class="3400841229030892477" onmouseenter="enter('3400841229030892477');" onmouseout="out('3400841229030892477');" style="">  28 import org.apache.kudu.client.AsyncKuduScanner;                                                          </span>
<span class="1860194643195428903" onmouseenter="enter('1860194643195428903');" onmouseout="out('1860194643195428903');" style="">  29 import org.apache.kudu.client.KuduException;                                                             </span>
<span class="128288131530978478" onmouseenter="enter('128288131530978478');" onmouseout="out('128288131530978478');" style="">  30 import org.apache.kudu.client.KuduPredicate;                                                             </span>
<span class="-342692776902705676" onmouseenter="enter('-342692776902705676');" onmouseout="out('-342692776902705676');" style="">  31 import org.apache.kudu.client.KuduTable;                                                                 </span>
<span class="-6157621177665621032" onmouseenter="enter('-6157621177665621032');" onmouseout="out('-6157621177665621032');" style="">  32 import org.apache.kudu.client.RowResult;                                                                 </span>
<span class="-1845673204769190809" onmouseenter="enter('-1845673204769190809');" onmouseout="out('-1845673204769190809');" style="">  33 import org.apache.kudu.client.RowResultIterator;                                                         </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  34 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  35 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  36                                                                                                          </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  37 import java.util.Arrays;                                                                                 </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  38 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40 import java.util.Map;                                                                                    </span>
<span  style="">  41                                                                                                          </span>
<span class="3638139650453766874" onmouseenter="enter('3638139650453766874');" onmouseout="out('3638139650453766874');" style="">  42 public class KuduAsyncReqRow extends BaseAsyncReqRow {                                                   </span>
<span  style="">  43                                                                                                          </span>
<span class="-2074213480282018260" onmouseenter="enter('-2074213480282018260');" onmouseout="out('-2074213480282018260');" style="">  44     private static final Logger LOG = LoggerFactory.getLogger(KuduAsyncReqRow.class);                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45     /**                                                                                                  </span>
<span class="-8285284077529796986" onmouseenter="enter('-8285284077529796986');" onmouseout="out('-8285284077529796986');" style="">  46      * 获取连接的尝试次数                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47      */                                                                                                  </span>
<span class="-1089202172816726338" onmouseenter="enter('-1089202172816726338');" onmouseout="out('-1089202172816726338');" style="">  48     private static final int CONN_RETRY_NUM = 3;                                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  49     /**                                                                                                  </span>
<span class="4062789252244833512" onmouseenter="enter('4062789252244833512');" onmouseout="out('4062789252244833512');" style="">  50      * 缓存条数                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  51      */                                                                                                  </span>
<span class="1004470848600586149" onmouseenter="enter('1004470848600586149');" onmouseout="out('1004470848600586149');" style="">  52     private static final Long FETCH_SIZE = 1000L;                                                        </span>
<span  style="">  53                                                                                                          </span>
<span class="5253634271646137455" onmouseenter="enter('5253634271646137455');" onmouseout="out('5253634271646137455');" style="">  54     private static final long serialVersionUID = 5028583854989267753L;                                   </span>
<span  style="">  55                                                                                                          </span>
<span  style="">  56                                                                                                          </span>
<span class="6513367378672126597" onmouseenter="enter('6513367378672126597');" onmouseout="out('6513367378672126597');" style="">  57     private AsyncKuduClient asyncClient;                                                                 </span>
<span  style="">  58                                                                                                          </span>
<span class="1317689277640300307" onmouseenter="enter('1317689277640300307');" onmouseout="out('1317689277640300307');" style="">  59     private KuduTable table;                                                                             </span>
<span  style="">  60                                                                                                          </span>
<span class="4635177141603060317" onmouseenter="enter('4635177141603060317');" onmouseout="out('4635177141603060317');" style="">  61     private KuduSideTableInfo kuduSideTableInfo;                                                         </span>
<span  style="">  62                                                                                                          </span>
<span class="4170992710598328570" onmouseenter="enter('4170992710598328570');" onmouseout="out('4170992710598328570');" style="">  63     private AsyncKuduScanner.AsyncKuduScannerBuilder scannerBuilder;                                     </span>
<span  style="">  64                                                                                                          </span>
<span class="-5994744104468733303" onmouseenter="enter('-5994744104468733303');" onmouseout="out('-5994744104468733303');" style=""><abbr title="  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, 🔵</abbr></span>
<span class="6563035163892178349" onmouseenter="enter('6563035163892178349');" onmouseout="out('6563035163892178349');" style="">  66         super(new KuduAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  69     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  70     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  71         super.open(parameters);                                                                          </span>
<span class="-7685679746867905609" onmouseenter="enter('-7685679746867905609');" onmouseout="out('-7685679746867905609');" style="">  72         kuduSideTableInfo = (KuduSideTableInfo) sideInfo.getSideTableInfo();                             </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="">  73         connKuDu();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76     /**                                                                                                  </span>
<span class="803083353752398343" onmouseenter="enter('803083353752398343');" onmouseout="out('803083353752398343');" style="">  77      * 连接kudu中的表                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78      *                                                                                                   </span>
<span class="-5432256053392020081" onmouseenter="enter('-5432256053392020081');" onmouseout="out('-5432256053392020081');" style="">  79      * @throws KuduException                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80      */                                                                                                  </span>
<span class="-5290115760614089350" onmouseenter="enter('-5290115760614089350');" onmouseout="out('-5290115760614089350');" style="">  81     private void connKuDu() throws KuduException {                                                       </span>
<span class="-56179035184578959" onmouseenter="enter('-56179035184578959');" onmouseout="out('-56179035184578959');" style="">  82         if (null == table) {                                                                             </span>
<span class="4308396336047168888" onmouseenter="enter('4308396336047168888');" onmouseout="out('4308396336047168888');" style="">  83             String kuduMasters = kuduSideTableInfo.getKuduMasters();                                     </span>
<span class="-4444229447990232757" onmouseenter="enter('-4444229447990232757');" onmouseout="out('-4444229447990232757');" style="">  84             String tableName = kuduSideTableInfo.getTableName();                                         </span>
<span class="4427587995392923155" onmouseenter="enter('4427587995392923155');" onmouseout="out('4427587995392923155');" style="">  85             Integer workerCount = kuduSideTableInfo.getWorkerCount();                                    </span>
<span class="-5299851536099138671" onmouseenter="enter('-5299851536099138671');" onmouseout="out('-5299851536099138671');" style="">  86             Integer defaultSocketReadTimeoutMs = kuduSideTableInfo.getDefaultSocketReadTimeoutMs();      </span>
<span class="-2694307185983387776" onmouseenter="enter('-2694307185983387776');" onmouseout="out('-2694307185983387776');" style="">  87             Integer defaultOperationTimeoutMs = kuduSideTableInfo.getDefaultOperationTimeoutMs();        </span>
<span  style="">  88                                                                                                          </span>
<span class="-6052455991030570635" onmouseenter="enter('-6052455991030570635');" onmouseout="out('-6052455991030570635');" style="">  89             Preconditions.checkNotNull(kuduMasters, &quot;kuduMasters could not be null&quot;);                    </span>
<span  style="">  90                                                                                                          </span>
<span class="-6520194397411128459" onmouseenter="enter('-6520194397411128459');" onmouseout="out('-6520194397411128459');" style=""><abbr title="  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBuilder(kuduMasters);">  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKudu🔵</abbr></span>
<span class="-8227759523178082238" onmouseenter="enter('-8227759523178082238');" onmouseout="out('-8227759523178082238');" style="">  92             if (null != workerCount) {                                                                   </span>
<span class="-5467062577113570128" onmouseenter="enter('-5467062577113570128');" onmouseout="out('-5467062577113570128');" style="">  93                 asyncKuduClientBuilder.workerCount(workerCount);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94             }                                                                                            </span>
<span  style="">  95                                                                                                          </span>
<span class="-2397215110746175709" onmouseenter="enter('-2397215110746175709');" onmouseout="out('-2397215110746175709');" style="">  96             if (null != defaultOperationTimeoutMs) {                                                     </span>
<span class="7366215511831154275" onmouseenter="enter('7366215511831154275');" onmouseout="out('7366215511831154275');" style="">  97                 asyncKuduClientBuilder.defaultOperationTimeoutMs(defaultOperationTimeoutMs);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98             }                                                                                            </span>
<span class="2560969904046492964" onmouseenter="enter('2560969904046492964');" onmouseout="out('2560969904046492964');" style="">  99             asyncClient = asyncKuduClientBuilder.build();                                                </span>
<span class="441886789095796306" onmouseenter="enter('441886789095796306');" onmouseout="out('441886789095796306');" style=""> 100             if (!asyncClient.syncClient().tableExists(tableName)) {                                      </span>
<span class="4123299035781055923" onmouseenter="enter('4123299035781055923');" onmouseout="out('4123299035781055923');" style=""> 101                 throw new IllegalArgumentException(&quot;Table Open Failed , please check table exists&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102             }                                                                                            </span>
<span class="4092827604202793861" onmouseenter="enter('4092827604202793861');" onmouseout="out('4092827604202793861');" style=""> 103             table = asyncClient.syncClient().openTable(tableName);                                       </span>
<span class="4177758485368982030" onmouseenter="enter('4177758485368982030');" onmouseout="out('4177758485368982030');" style=""> 104             LOG.info(&quot;connect kudu is successed!&quot;);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span class="2924668647776163983" onmouseenter="enter('2924668647776163983');" onmouseout="out('2924668647776163983');" style=""> 106         scannerBuilder = asyncClient.newScannerBuilder(table);                                           </span>
<span class="-4404448253596110496" onmouseenter="enter('-4404448253596110496');" onmouseout="out('-4404448253596110496');" style=""> 107         Integer batchSizeBytes = kuduSideTableInfo.getBatchSizeBytes();                                  </span>
<span class="-7735055932391271380" onmouseenter="enter('-7735055932391271380');" onmouseout="out('-7735055932391271380');" style=""> 108         Long limitNum = kuduSideTableInfo.getLimitNum();                                                 </span>
<span class="1611473127340759637" onmouseenter="enter('1611473127340759637');" onmouseout="out('1611473127340759637');" style=""> 109         Boolean isFaultTolerant = kuduSideTableInfo.getFaultTolerant();                                  </span>
<span class="-8526639943056837274" onmouseenter="enter('-8526639943056837274');" onmouseout="out('-8526639943056837274');" style=""> 110         //查询需要的字段                                                                                        </span>
<span class="2090107689800818740" onmouseenter="enter('2090107689800818740');" onmouseout="out('2090107689800818740');" style=""> 111         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;);                </span>
<span  style=""> 112                                                                                                          </span>
<span class="-8080913465496496419" onmouseenter="enter('-8080913465496496419');" onmouseout="out('-8080913465496496419');" style=""> 113         if (null == limitNum || limitNum &lt;= 0) {                                                         </span>
<span class="7767157001459171317" onmouseenter="enter('7767157001459171317');" onmouseout="out('7767157001459171317');" style=""> 114             scannerBuilder.limit(FETCH_SIZE);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 115         } else {                                                                                         </span>
<span class="6087958399625777057" onmouseenter="enter('6087958399625777057');" onmouseout="out('6087958399625777057');" style=""> 116             scannerBuilder.limit(limitNum);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="-5740110908714073879" onmouseenter="enter('-5740110908714073879');" onmouseout="out('-5740110908714073879');" style=""> 118         if (null != batchSizeBytes) {                                                                    </span>
<span class="-3929060200025616829" onmouseenter="enter('-3929060200025616829');" onmouseout="out('-3929060200025616829');" style=""> 119             scannerBuilder.batchSizeBytes(batchSizeBytes);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120         }                                                                                                </span>
<span class="-8680730272034558637" onmouseenter="enter('-8680730272034558637');" onmouseout="out('-8680730272034558637');" style=""> 121         if (null != isFaultTolerant) {                                                                   </span>
<span class="-5364988782144201666" onmouseenter="enter('-5364988782144201666');" onmouseout="out('-5364988782144201666');" style=""> 122             scannerBuilder.setFaultTolerant(isFaultTolerant);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span  style=""> 124                                                                                                          </span>
<span class="6330664272177173056" onmouseenter="enter('6330664272177173056');" onmouseout="out('6330664272177173056');" style=""> 125         List&lt;String&gt; projectColumns = Arrays.asList(sideFieldNames);                                     </span>
<span class="2684072470806705647" onmouseenter="enter('2684072470806705647');" onmouseout="out('2684072470806705647');" style=""> 126         scannerBuilder.setProjectedColumnNames(projectColumns);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 130 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 131     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 131     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) th🔵</abbr></span>
<span class="-9200276852123234128" onmouseenter="enter('-9200276852123234128');" onmouseout="out('-9200276852123234128');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132         Tuple2&lt;Boolean, Row&gt; inputCopy = Tuple2.of(input.f0, input.f1);                                  </span>
<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133         //scannerBuilder 设置为null重新加载过滤条件                                                                 </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 134 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139         //scannerBuilder 设置为null重新加载过滤条件                                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 140 =======                                                                                                  </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 141     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 141     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="5065834272723126023" onmouseenter="enter('5065834272723126023');" onmouseout="out('5065834272723126023');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143         //scannerBuilder 设置为null重新加载过滤条件,然后connkudu重新赋值                                                  </span>
<span class="2495891823177141345" onmouseenter="enter('2495891823177141345');" onmouseout="out('2495891823177141345');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144         //todo:代码需要优化                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 145 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style=""> 146         scannerBuilder = null;                                                                           </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style=""> 147         connKuDu();                                                                                      </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style=""> 148         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style=""> 149         //  @wenbaoup fix bug                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 150 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 151         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="6195831313044354975" onmouseenter="enter('6195831313044354975');" onmouseout="out('6195831313044354975');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152             Object equalObj = inputCopy.f1.getField(sideInfo.getEqualValIndex().get(i));                 </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 155                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156             }                                                                                            </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157             //增加过滤条件                                                                                     </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 158             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 158             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqu🔵</abbr></span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 159             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 160         }                                                                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 161 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         //  @wenbaoup fix bug                                                                            </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="520421449260192980" onmouseenter="enter('520421449260192980');" onmouseout="out('520421449260192980');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165             Object equalObj = inputCopy.row().getField(sideInfo.getEqualValIndex().get(i));              </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169             }                                                                                            </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170             //增加过滤条件                                                                                     </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 171             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 171             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqu🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 172 =======                                                                                                  </span>
<span class="-2762964740504478972" onmouseenter="enter('-2762964740504478972');" onmouseout="out('-2762964740504478972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173         inputParams.entrySet().forEach(e -&gt;{                                                             </span>
<span class="-44569786791220301" onmouseenter="enter('-44569786791220301');" onmouseout="out('-44569786791220301');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 174             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Collections.singletonList(e.getValue())));"> 174             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Co🔵</abbr></span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175         });                                                                                              </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 176 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 177                                                                                                          </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style=""> 178         //  填充谓词信息                                                                                       </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style=""> 179         List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();          </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style=""> 180         if (predicateInfoes.size() &gt; 0) {                                                                </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style=""> 181             predicateInfoes.stream().map(info -&gt; {                                                       </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style=""> 182                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style=""> 183                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style=""> 184                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style=""> 186                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style=""> 187             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span  style=""> 189                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 190 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 191                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 192         String key = buildCacheKey(inputParams);                                                         </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 193                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 194         if (openCache()) {                                                                               </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 195             //判断数据是否已经加载到缓存中                                                                             </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 196             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 197             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 198                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 199                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 200                     return;                                                                              </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 201                 } else if (ECacheContentType.SingleLine == val.getType()) {                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 202                     try {                                                                                </span>
<span class="7656694764601850900" onmouseenter="enter('7656694764601850900');" onmouseout="out('7656694764601850900');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 203                         Row row = fillData(inputCopy.f1, val);                                           </span>
<span class="2870017647032456198" onmouseenter="enter('2870017647032456198');" onmouseout="out('2870017647032456198');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 204                         resultFuture.complete(Collections.singleton(Tuple2.of(inputCopy.f0,row)));       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 205                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 206                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 207                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 208                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 209                     try {                                                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 210                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                        </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 211                         for (Object jsonArray : (List) val.getContent()) {                               </span>
<span class="6489207833882754223" onmouseenter="enter('6489207833882754223');" onmouseout="out('6489207833882754223');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 212                             Row row = fillData(inputCopy.f1, jsonArray);                                 </span>
<span class="-9103127993782963860" onmouseenter="enter('-9103127993782963860');" onmouseout="out('-9103127993782963860');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 213                             rowList.add(Tuple2.of(inputCopy.f0, row));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 214                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 215                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 216                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 217                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 218                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 219                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 220                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 220                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 221                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 222                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 223             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 224         }                                                                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 225 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235         String key = buildCacheKey(inputParams);                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237         if (openCache()) {                                                                               </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238             //判断数据是否已经加载到缓存中                                                                             </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                     return;                                                                              </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                 } else if (ECacheContentType.SingleLine == val.getType()) {                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                     try {                                                                                </span>
<span class="6604686668491627706" onmouseenter="enter('6604686668491627706');" onmouseout="out('6604686668491627706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                         Row row = fillData(inputCopy.row(), val);                                        </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                         for (Object jsonArray : (List) val.getContent()) {                               </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                             Row row = fillData(inputCopy.row(), jsonArray);                              </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                             rowList.add(new CRow(row, inputCopy.change()));                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 263                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 263                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                 return;                                                                                  </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 266 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 267 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style=""> 268         List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                   </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style=""> 269         AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                      </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style=""> 270         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                        </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style=""> 271         Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                  </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style=""> 272         //从之前的同步修改为调用异步的Callback                                                                         </span>
<span class="278649099550089909" onmouseenter="enter('278649099550089909');" onmouseout="out('278649099550089909');" style=""><abbr title=" 273         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, buildCacheKey(inputParams)));"> 273         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, re🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274     }                                                                                                    </span>
<span  style=""> 275                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 276     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 277     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 278         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 279         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 280             sb.append(ele.toString())                                                                    </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 281                     .append(&quot;_&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282         }                                                                                                </span>
<span  style=""> 283                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 284         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285     }                                                                                                    </span>
<span  style=""> 286                                                                                                          </span>
<span  style=""> 287                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 288     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 289     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="7096347511226230072" onmouseenter="enter('7096347511226230072');" onmouseout="out('7096347511226230072');" style=""> 290         Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) sideInput;                                 </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 291         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 292         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 293             Object obj = input.getField(entry.getValue());                                               </span>
<span class="-7569211455899402285" onmouseenter="enter('-7569211455899402285');" onmouseout="out('-7569211455899402285');" style=""> 294             obj = convertTimeIndictorTypeInfo(entry.getValue(), obj);                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 295             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296         }                                                                                                </span>
<span  style=""> 297                                                                                                          </span>
<span class="-4063777341066712786" onmouseenter="enter('-4063777341066712786');" onmouseout="out('-4063777341066712786');" style=""> 298         for (Map.Entry&lt;Integer, String&gt; entry : sideInfo.getSideFieldNameIndex().entrySet()) {           </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 299             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 300                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 301             } else {                                                                                     </span>
<span class="-6152510067760557074" onmouseenter="enter('-6152510067760557074');" onmouseout="out('-6152510067760557074');" style=""> 302                 row.setField(entry.getKey(), cacheInfo.get(entry.getValue()));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304         }                                                                                                </span>
<span  style=""> 305                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 306         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307     }                                                                                                    </span>
<span  style=""> 308                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 309     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 310     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 311         super.close();                                                                                   </span>
<span class="-466861721853404898" onmouseenter="enter('-466861721853404898');" onmouseout="out('-466861721853404898');" style=""> 312         if (null != asyncClient) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 313             try {                                                                                        </span>
<span class="-2833913701521345427" onmouseenter="enter('-2833913701521345427');" onmouseout="out('-2833913701521345427');" style=""> 314                 asyncClient.close();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 315             } catch (Exception e) {                                                                      </span>
<span class="7169708839653618971" onmouseenter="enter('7169708839653618971');" onmouseout="out('7169708839653618971');" style=""> 316                 LOG.error(&quot;Error while closing client.&quot;, e);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319     }                                                                                                    </span>
<span  style=""> 320                                                                                                          </span>
<span class="3638800353225348075" onmouseenter="enter('3638800353225348075');" onmouseout="out('3638800353225348075');" style=""> 321     class GetListRowCB implements Callback&lt;Deferred&lt;List&lt;Row&gt;&gt;, RowResultIterator&gt; {                     </span>
<span class="4696852104916231563" onmouseenter="enter('4696852104916231563');" onmouseout="out('4696852104916231563');" style=""> 322         private Tuple2&lt;Boolean,Row&gt; input;                                                               </span>
<span class="-3461178940071231317" onmouseenter="enter('-3461178940071231317');" onmouseout="out('-3461178940071231317');" style=""> 323         private List&lt;Map&lt;String, Object&gt;&gt; cacheContent;                                                  </span>
<span class="1247274010491913930" onmouseenter="enter('1247274010491913930');" onmouseout="out('1247274010491913930');" style=""> 324         private List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList;                                                       </span>
<span class="5723031173307092846" onmouseenter="enter('5723031173307092846');" onmouseout="out('5723031173307092846');" style=""> 325         private AsyncKuduScanner asyncKuduScanner;                                                       </span>
<span class="1809246968026899685" onmouseenter="enter('1809246968026899685');" onmouseout="out('1809246968026899685');" style=""> 326         private ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture;                                          </span>
<span class="-1449703644783381384" onmouseenter="enter('-1449703644783381384');" onmouseout="out('-1449703644783381384');" style=""> 327         private String key;                                                                              </span>
<span  style=""> 328                                                                                                          </span>
<span  style=""> 329                                                                                                          </span>
<span class="1613753735602313740" onmouseenter="enter('1613753735602313740');" onmouseout="out('1613753735602313740');" style=""> 330         public GetListRowCB() {                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331         }                                                                                                </span>
<span  style=""> 332                                                                                                          </span>
<span class="7340517348292441638" onmouseenter="enter('7340517348292441638');" onmouseout="out('7340517348292441638');" style=""><abbr title=" 333         GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList,"> 333         GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boole🔵</abbr></span>
<span class="-8589978589073406776" onmouseenter="enter('-8589978589073406776');" onmouseout="out('-8589978589073406776');" style=""><abbr title=" 334                      AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, String key) {"> 334                      AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, S🔵</abbr></span>
<span class="8214429602983504200" onmouseenter="enter('8214429602983504200');" onmouseout="out('8214429602983504200');" style=""> 335             this.input = input;                                                                          </span>
<span class="-7432664925500830597" onmouseenter="enter('-7432664925500830597');" onmouseout="out('-7432664925500830597');" style=""> 336             this.cacheContent = cacheContent;                                                            </span>
<span class="5762471889889938429" onmouseenter="enter('5762471889889938429');" onmouseout="out('5762471889889938429');" style=""> 337             this.rowList = rowList;                                                                      </span>
<span class="4954020228022176436" onmouseenter="enter('4954020228022176436');" onmouseout="out('4954020228022176436');" style=""> 338             this.asyncKuduScanner = asyncKuduScanner;                                                    </span>
<span class="592225705701792215" onmouseenter="enter('592225705701792215');" onmouseout="out('592225705701792215');" style=""> 339             this.resultFuture = resultFuture;                                                            </span>
<span class="5062295098979135982" onmouseenter="enter('5062295098979135982');" onmouseout="out('5062295098979135982');" style=""> 340             this.key = key;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341         }                                                                                                </span>
<span  style=""> 342                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 343         @Override                                                                                        </span>
<span class="8767874272678853351" onmouseenter="enter('8767874272678853351');" onmouseout="out('8767874272678853351');" style=""> 344         public Deferred&lt;List&lt;Row&gt;&gt; call(RowResultIterator results) throws Exception {                    </span>
<span class="-8941030450012249491" onmouseenter="enter('-8941030450012249491');" onmouseout="out('-8941030450012249491');" style=""> 345             for (RowResult result : results) {                                                           </span>
<span class="-7707387193564908050" onmouseenter="enter('-7707387193564908050');" onmouseout="out('-7707387193564908050');" style=""> 346                 Map&lt;String, Object&gt; oneRow = Maps.newHashMap();                                          </span>
<span class="4786776012437782338" onmouseenter="enter('4786776012437782338');" onmouseout="out('4786776012437782338');" style=""> 347                 for (String sideFieldName1 : StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;)) {   </span>
<span class="5422300911827801712" onmouseenter="enter('5422300911827801712');" onmouseout="out('5422300911827801712');" style=""> 348                     String sideFieldName = sideFieldName1.trim();                                        </span>
<span class="-7396994512053753949" onmouseenter="enter('-7396994512053753949');" onmouseout="out('-7396994512053753949');" style=""> 349                     ColumnSchema columnSchema = table.getSchema().getColumn(sideFieldName);              </span>
<span class="-1551001954350423389" onmouseenter="enter('-1551001954350423389');" onmouseout="out('-1551001954350423389');" style=""> 350                     if (null != columnSchema) {                                                          </span>
<span class="-9080618923968214410" onmouseenter="enter('-9080618923968214410');" onmouseout="out('-9080618923968214410');" style=""> 351                         KuduUtil.setMapValue(columnSchema.getType(), oneRow, sideFieldName, result);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353                 }                                                                                        </span>
<span class="5830289147325916559" onmouseenter="enter('5830289147325916559');" onmouseout="out('5830289147325916559');" style=""> 354                 Row row = fillData(input.f1, oneRow);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 355                 if (openCache()) {                                                                       </span>
<span class="1888587301705190474" onmouseenter="enter('1888587301705190474');" onmouseout="out('1888587301705190474');" style=""> 356                     cacheContent.add(oneRow);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357                 }                                                                                        </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 358                 rowList.add(Tuple2.of(input.f0, row));                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359             }                                                                                            </span>
<span class="-5880917173204222408" onmouseenter="enter('-5880917173204222408');" onmouseout="out('-5880917173204222408');" style=""> 360             if (asyncKuduScanner.hasMoreRows()) {                                                        </span>
<span class="411290205859931493" onmouseenter="enter('411290205859931493');" onmouseout="out('411290205859931493');" style=""> 361                 return asyncKuduScanner.nextRows().addCallbackDeferring(this);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362             }                                                                                            </span>
<span  style=""> 363                                                                                                          </span>
<span class="-5182000486454444757" onmouseenter="enter('-5182000486454444757');" onmouseout="out('-5182000486454444757');" style=""> 364             if (rowList.size() &gt; 0) {                                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 365                 if (openCache()) {                                                                       </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 366                     putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367                 }                                                                                        </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 368                 resultFuture.complete(rowList);                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 369             } else {                                                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 370                 dealMissKey(input, resultFuture);                                                        </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 371                 if (openCache()) {                                                                       </span>
<span class="-7075096462798044408" onmouseenter="enter('-7075096462798044408');" onmouseout="out('-7075096462798044408');" style=""> 372                     //放置在putCache的Miss中 一段时间内同一个key都会直接返回                                                </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 373                     putCache(key, CacheMissVal.getMissKeyObj());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375             }                                                                                            </span>
<span  style=""> 376                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 377             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379     }                                                                                                    </span>
<span  style=""> 380                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381 }                                                                                                        </span>





































</pre></td>
                            <td><pre><span class="-8840953368027741170" onmouseenter="enter('-8840953368027741170');" onmouseout="out('-8840953368027741170');" style="">   1 package com.dtstack.flink.sql.side.kudu;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">   3 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">   4 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">   5 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">   6 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">   7 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">   8 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">   9 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  10 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5710642889135375263" onmouseenter="enter('5710642889135375263');" onmouseout="out('5710642889135375263');" style="">  11 import com.dtstack.flink.sql.side.kudu.table.KuduSideTableInfo;                                          </span>
<span class="1164335795537447661" onmouseenter="enter('1164335795537447661');" onmouseout="out('1164335795537447661');" style="">  12 import com.dtstack.flink.sql.side.kudu.utils.KuduUtil;                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  13 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  14 import com.google.common.collect.Maps;                                                                   </span>
<span class="-5750625329012831967" onmouseenter="enter('-5750625329012831967');" onmouseout="out('-5750625329012831967');" style="">  15 import com.stumbleupon.async.Callback;                                                                   </span>
<span class="-5487067255628915347" onmouseenter="enter('-5487067255628915347');" onmouseout="out('-5487067255628915347');" style="">  16 import com.stumbleupon.async.Deferred;                                                                   </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  17 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  18 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  19 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  20 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  21 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  22 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  23 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  24 import org.apache.flink.util.Preconditions;                                                              </span>
<span class="1631232015531818624" onmouseenter="enter('1631232015531818624');" onmouseout="out('1631232015531818624');" style="">  25 import org.apache.kudu.ColumnSchema;                                                                     </span>
<span class="-1755042893780385624" onmouseenter="enter('-1755042893780385624');" onmouseout="out('-1755042893780385624');" style="">  26 import org.apache.kudu.Schema;                                                                           </span>
<span class="7204708202450962745" onmouseenter="enter('7204708202450962745');" onmouseout="out('7204708202450962745');" style="">  27 import org.apache.kudu.client.AsyncKuduClient;                                                           </span>
<span class="3400841229030892477" onmouseenter="enter('3400841229030892477');" onmouseout="out('3400841229030892477');" style="">  28 import org.apache.kudu.client.AsyncKuduScanner;                                                          </span>
<span class="1860194643195428903" onmouseenter="enter('1860194643195428903');" onmouseout="out('1860194643195428903');" style="">  29 import org.apache.kudu.client.KuduException;                                                             </span>
<span class="128288131530978478" onmouseenter="enter('128288131530978478');" onmouseout="out('128288131530978478');" style="">  30 import org.apache.kudu.client.KuduPredicate;                                                             </span>
<span class="-342692776902705676" onmouseenter="enter('-342692776902705676');" onmouseout="out('-342692776902705676');" style="">  31 import org.apache.kudu.client.KuduTable;                                                                 </span>
<span class="-6157621177665621032" onmouseenter="enter('-6157621177665621032');" onmouseout="out('-6157621177665621032');" style="">  32 import org.apache.kudu.client.RowResult;                                                                 </span>
<span class="-1845673204769190809" onmouseenter="enter('-1845673204769190809');" onmouseout="out('-1845673204769190809');" style="">  33 import org.apache.kudu.client.RowResultIterator;                                                         </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  34 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  35 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  36                                                                                                          </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  37 import java.util.Arrays;                                                                                 </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  38 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40 import java.util.Map;                                                                                    </span>
<span  style="">  41                                                                                                          </span>
<span class="3638139650453766874" onmouseenter="enter('3638139650453766874');" onmouseout="out('3638139650453766874');" style="">  42 public class KuduAsyncReqRow extends BaseAsyncReqRow {                                                   </span>
<span  style="">  43                                                                                                          </span>
<span class="-2074213480282018260" onmouseenter="enter('-2074213480282018260');" onmouseout="out('-2074213480282018260');" style="">  44     private static final Logger LOG = LoggerFactory.getLogger(KuduAsyncReqRow.class);                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45     /**                                                                                                  </span>
<span class="-8285284077529796986" onmouseenter="enter('-8285284077529796986');" onmouseout="out('-8285284077529796986');" style="">  46      * 获取连接的尝试次数                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47      */                                                                                                  </span>
<span class="-1089202172816726338" onmouseenter="enter('-1089202172816726338');" onmouseout="out('-1089202172816726338');" style="">  48     private static final int CONN_RETRY_NUM = 3;                                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  49     /**                                                                                                  </span>
<span class="4062789252244833512" onmouseenter="enter('4062789252244833512');" onmouseout="out('4062789252244833512');" style="">  50      * 缓存条数                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  51      */                                                                                                  </span>
<span class="1004470848600586149" onmouseenter="enter('1004470848600586149');" onmouseout="out('1004470848600586149');" style="">  52     private static final Long FETCH_SIZE = 1000L;                                                        </span>
<span  style="">  53                                                                                                          </span>
<span class="5253634271646137455" onmouseenter="enter('5253634271646137455');" onmouseout="out('5253634271646137455');" style="">  54     private static final long serialVersionUID = 5028583854989267753L;                                   </span>
<span  style="">  55                                                                                                          </span>
<span  style="">  56                                                                                                          </span>
<span class="6513367378672126597" onmouseenter="enter('6513367378672126597');" onmouseout="out('6513367378672126597');" style="">  57     private AsyncKuduClient asyncClient;                                                                 </span>
<span  style="">  58                                                                                                          </span>
<span class="1317689277640300307" onmouseenter="enter('1317689277640300307');" onmouseout="out('1317689277640300307');" style="">  59     private KuduTable table;                                                                             </span>
<span  style="">  60                                                                                                          </span>
<span class="4635177141603060317" onmouseenter="enter('4635177141603060317');" onmouseout="out('4635177141603060317');" style="">  61     private KuduSideTableInfo kuduSideTableInfo;                                                         </span>
<span  style="">  62                                                                                                          </span>
<span class="4170992710598328570" onmouseenter="enter('4170992710598328570');" onmouseout="out('4170992710598328570');" style="">  63     private AsyncKuduScanner.AsyncKuduScannerBuilder scannerBuilder;                                     </span>
<span  style="">  64                                                                                                          </span>
<span class="-5994744104468733303" onmouseenter="enter('-5994744104468733303');" onmouseout="out('-5994744104468733303');" style=""><abbr title="  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, 🔵</abbr></span>
<span class="6563035163892178349" onmouseenter="enter('6563035163892178349');" onmouseout="out('6563035163892178349');" style="">  66         super(new KuduAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  69     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  70     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  71         super.open(parameters);                                                                          </span>
<span class="-7685679746867905609" onmouseenter="enter('-7685679746867905609');" onmouseout="out('-7685679746867905609');" style="">  72         kuduSideTableInfo = (KuduSideTableInfo) sideInfo.getSideTableInfo();                             </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="">  73         connKuDu();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76     /**                                                                                                  </span>
<span class="803083353752398343" onmouseenter="enter('803083353752398343');" onmouseout="out('803083353752398343');" style="">  77      * 连接kudu中的表                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78      *                                                                                                   </span>
<span class="-5432256053392020081" onmouseenter="enter('-5432256053392020081');" onmouseout="out('-5432256053392020081');" style="">  79      * @throws KuduException                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80      */                                                                                                  </span>
<span class="-5290115760614089350" onmouseenter="enter('-5290115760614089350');" onmouseout="out('-5290115760614089350');" style="">  81     private void connKuDu() throws KuduException {                                                       </span>
<span class="-56179035184578959" onmouseenter="enter('-56179035184578959');" onmouseout="out('-56179035184578959');" style="">  82         if (null == table) {                                                                             </span>
<span class="4308396336047168888" onmouseenter="enter('4308396336047168888');" onmouseout="out('4308396336047168888');" style="">  83             String kuduMasters = kuduSideTableInfo.getKuduMasters();                                     </span>
<span class="-4444229447990232757" onmouseenter="enter('-4444229447990232757');" onmouseout="out('-4444229447990232757');" style="">  84             String tableName = kuduSideTableInfo.getTableName();                                         </span>
<span class="4427587995392923155" onmouseenter="enter('4427587995392923155');" onmouseout="out('4427587995392923155');" style="">  85             Integer workerCount = kuduSideTableInfo.getWorkerCount();                                    </span>
<span class="-5299851536099138671" onmouseenter="enter('-5299851536099138671');" onmouseout="out('-5299851536099138671');" style="">  86             Integer defaultSocketReadTimeoutMs = kuduSideTableInfo.getDefaultSocketReadTimeoutMs();      </span>
<span class="-2694307185983387776" onmouseenter="enter('-2694307185983387776');" onmouseout="out('-2694307185983387776');" style="">  87             Integer defaultOperationTimeoutMs = kuduSideTableInfo.getDefaultOperationTimeoutMs();        </span>
<span  style="">  88                                                                                                          </span>
<span class="-6052455991030570635" onmouseenter="enter('-6052455991030570635');" onmouseout="out('-6052455991030570635');" style="">  89             Preconditions.checkNotNull(kuduMasters, &quot;kuduMasters could not be null&quot;);                    </span>
<span  style="">  90                                                                                                          </span>
<span class="-6520194397411128459" onmouseenter="enter('-6520194397411128459');" onmouseout="out('-6520194397411128459');" style=""><abbr title="  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBuilder(kuduMasters);">  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKudu🔵</abbr></span>
<span class="-8227759523178082238" onmouseenter="enter('-8227759523178082238');" onmouseout="out('-8227759523178082238');" style="">  92             if (null != workerCount) {                                                                   </span>
<span class="-5467062577113570128" onmouseenter="enter('-5467062577113570128');" onmouseout="out('-5467062577113570128');" style="">  93                 asyncKuduClientBuilder.workerCount(workerCount);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94             }                                                                                            </span>
<span  style="">  95                                                                                                          </span>
<span class="-2397215110746175709" onmouseenter="enter('-2397215110746175709');" onmouseout="out('-2397215110746175709');" style="">  96             if (null != defaultOperationTimeoutMs) {                                                     </span>
<span class="7366215511831154275" onmouseenter="enter('7366215511831154275');" onmouseout="out('7366215511831154275');" style="">  97                 asyncKuduClientBuilder.defaultOperationTimeoutMs(defaultOperationTimeoutMs);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98             }                                                                                            </span>
<span class="2560969904046492964" onmouseenter="enter('2560969904046492964');" onmouseout="out('2560969904046492964');" style="">  99             asyncClient = asyncKuduClientBuilder.build();                                                </span>
<span class="441886789095796306" onmouseenter="enter('441886789095796306');" onmouseout="out('441886789095796306');" style=""> 100             if (!asyncClient.syncClient().tableExists(tableName)) {                                      </span>
<span class="4123299035781055923" onmouseenter="enter('4123299035781055923');" onmouseout="out('4123299035781055923');" style=""> 101                 throw new IllegalArgumentException(&quot;Table Open Failed , please check table exists&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102             }                                                                                            </span>
<span class="4092827604202793861" onmouseenter="enter('4092827604202793861');" onmouseout="out('4092827604202793861');" style=""> 103             table = asyncClient.syncClient().openTable(tableName);                                       </span>
<span class="4177758485368982030" onmouseenter="enter('4177758485368982030');" onmouseout="out('4177758485368982030');" style=""> 104             LOG.info(&quot;connect kudu is successed!&quot;);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span class="2924668647776163983" onmouseenter="enter('2924668647776163983');" onmouseout="out('2924668647776163983');" style=""> 106         scannerBuilder = asyncClient.newScannerBuilder(table);                                           </span>
<span class="-4404448253596110496" onmouseenter="enter('-4404448253596110496');" onmouseout="out('-4404448253596110496');" style=""> 107         Integer batchSizeBytes = kuduSideTableInfo.getBatchSizeBytes();                                  </span>
<span class="-7735055932391271380" onmouseenter="enter('-7735055932391271380');" onmouseout="out('-7735055932391271380');" style=""> 108         Long limitNum = kuduSideTableInfo.getLimitNum();                                                 </span>
<span class="1611473127340759637" onmouseenter="enter('1611473127340759637');" onmouseout="out('1611473127340759637');" style=""> 109         Boolean isFaultTolerant = kuduSideTableInfo.getFaultTolerant();                                  </span>
<span class="-8526639943056837274" onmouseenter="enter('-8526639943056837274');" onmouseout="out('-8526639943056837274');" style=""> 110         //查询需要的字段                                                                                        </span>
<span class="2090107689800818740" onmouseenter="enter('2090107689800818740');" onmouseout="out('2090107689800818740');" style=""> 111         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;);                </span>
<span  style=""> 112                                                                                                          </span>
<span class="-8080913465496496419" onmouseenter="enter('-8080913465496496419');" onmouseout="out('-8080913465496496419');" style=""> 113         if (null == limitNum || limitNum &lt;= 0) {                                                         </span>
<span class="7767157001459171317" onmouseenter="enter('7767157001459171317');" onmouseout="out('7767157001459171317');" style=""> 114             scannerBuilder.limit(FETCH_SIZE);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 115         } else {                                                                                         </span>
<span class="6087958399625777057" onmouseenter="enter('6087958399625777057');" onmouseout="out('6087958399625777057');" style=""> 116             scannerBuilder.limit(limitNum);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="-5740110908714073879" onmouseenter="enter('-5740110908714073879');" onmouseout="out('-5740110908714073879');" style=""> 118         if (null != batchSizeBytes) {                                                                    </span>
<span class="-3929060200025616829" onmouseenter="enter('-3929060200025616829');" onmouseout="out('-3929060200025616829');" style=""> 119             scannerBuilder.batchSizeBytes(batchSizeBytes);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120         }                                                                                                </span>
<span class="-8680730272034558637" onmouseenter="enter('-8680730272034558637');" onmouseout="out('-8680730272034558637');" style=""> 121         if (null != isFaultTolerant) {                                                                   </span>
<span class="-5364988782144201666" onmouseenter="enter('-5364988782144201666');" onmouseout="out('-5364988782144201666');" style=""> 122             scannerBuilder.setFaultTolerant(isFaultTolerant);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span  style=""> 124                                                                                                          </span>
<span class="6330664272177173056" onmouseenter="enter('6330664272177173056');" onmouseout="out('6330664272177173056');" style=""> 125         List&lt;String&gt; projectColumns = Arrays.asList(sideFieldNames);                                     </span>
<span class="2684072470806705647" onmouseenter="enter('2684072470806705647');" onmouseout="out('2684072470806705647');" style=""> 126         scannerBuilder.setProjectedColumnNames(projectColumns);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span  style=""> 129                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 130 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131     @Override                                                                                            </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 132     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 132     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) th🔵</abbr></span>
<span class="-9200276852123234128" onmouseenter="enter('-9200276852123234128');" onmouseout="out('-9200276852123234128');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133         Tuple2&lt;Boolean, Row&gt; inputCopy = Tuple2.of(input.f0, input.f1);                                  </span>
<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134         //scannerBuilder 设置为null重新加载过滤条件                                                                 </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135         scannerBuilder = null;                                                                           </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136         connKuDu();                                                                                      </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137         JsonArray inputParams = new JsonArray();                                                         </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139         //  @wenbaoup fix bug                                                                            </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="6195831313044354975" onmouseenter="enter('6195831313044354975');" onmouseout="out('6195831313044354975');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141             Object equalObj = inputCopy.f1.getField(sideInfo.getEqualValIndex().get(i));                 </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145             }                                                                                            </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146             //增加过滤条件                                                                                     </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 147             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 147             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqu🔵</abbr></span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 148             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 149         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150                                                                                                          </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 151         //  填充谓词信息                                                                                       </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152         List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();          </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153         if (predicateInfoes.size() &gt; 0) {                                                                </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154             predicateInfoes.stream().map(info -&gt; {                                                       </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 155                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 158                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 159                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 160             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 161         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 162                                                                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 163                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 164         String key = buildCacheKey(inputParams);                                                         </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 165                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 166         if (openCache()) {                                                                               </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 167             //判断数据是否已经加载到缓存中                                                                             </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 168             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 169             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 170                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 171                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 172                     return;                                                                              </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 173                 } else if (ECacheContentType.SingleLine == val.getType()) {                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 174                     try {                                                                                </span>
<span class="7656694764601850900" onmouseenter="enter('7656694764601850900');" onmouseout="out('7656694764601850900');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 175                         Row row = fillData(inputCopy.f1, val);                                           </span>
<span class="2870017647032456198" onmouseenter="enter('2870017647032456198');" onmouseout="out('2870017647032456198');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 176                         resultFuture.complete(Collections.singleton(Tuple2.of(inputCopy.f0,row)));       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 177                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 178                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 179                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181                     try {                                                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                        </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 183                         for (Object jsonArray : (List) val.getContent()) {                               </span>
<span class="6489207833882754223" onmouseenter="enter('6489207833882754223');" onmouseout="out('6489207833882754223');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 184                             Row row = fillData(inputCopy.f1, jsonArray);                                 </span>
<span class="-9103127993782963860" onmouseenter="enter('-9103127993782963860');" onmouseout="out('-9103127993782963860');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 185                             rowList.add(Tuple2.of(inputCopy.f0, row));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 186                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 187                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 188                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 189                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 190                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 191                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 192                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 192                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 193                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 194                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 195             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 196         }                                                                                                </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 197         List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                   </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 198         AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                      </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 199         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                        </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 200         Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                  </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 201         //从之前的同步修改为调用异步的Callback                                                                         </span>
<span class="-8947877439631582721" onmouseenter="enter('-8947877439631582721');" onmouseout="out('-8947877439631582721');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 202         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, key));"> 202         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, re🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 203     }                                                                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 204 ||||||| BASE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208         //scannerBuilder 设置为null重新加载过滤条件                                                                 </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209         scannerBuilder = null;                                                                           </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210         connKuDu();                                                                                      </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211         JsonArray inputParams = new JsonArray();                                                         </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213         //  @wenbaoup fix bug                                                                            </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="520421449260192980" onmouseenter="enter('520421449260192980');" onmouseout="out('520421449260192980');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             Object equalObj = inputCopy.row().getField(sideInfo.getEqualValIndex().get(i));              </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219             }                                                                                            </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220             //增加过滤条件                                                                                     </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 221             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 221             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqu🔵</abbr></span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224                                                                                                          </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225         //  填充谓词信息                                                                                       </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226         List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();          </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227         if (predicateInfoes.size() &gt; 0) {                                                                </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228             predicateInfoes.stream().map(info -&gt; {                                                       </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238         String key = buildCacheKey(inputParams);                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240         if (openCache()) {                                                                               </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241             //判断数据是否已经加载到缓存中                                                                             </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                     return;                                                                              </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                 } else if (ECacheContentType.SingleLine == val.getType()) {                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                     try {                                                                                </span>
<span class="6604686668491627706" onmouseenter="enter('6604686668491627706');" onmouseout="out('6604686668491627706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                         Row row = fillData(inputCopy.row(), val);                                        </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                         for (Object jsonArray : (List) val.getContent()) {                               </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                             Row row = fillData(inputCopy.row(), jsonArray);                              </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                             rowList.add(new CRow(row, inputCopy.change()));                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 266                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 266                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270         }                                                                                                </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271         List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                   </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272         AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                      </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273         List&lt;CRow&gt; rowList = Lists.newArrayList();                                                       </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274         Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                  </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275         //从之前的同步修改为调用异步的Callback                                                                         </span>
<span class="-8947877439631582721" onmouseenter="enter('-8947877439631582721');" onmouseout="out('-8947877439631582721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 276         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, key));"> 276         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, re🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 278 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279                                                                                                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 280 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 281                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 282     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 283     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 283     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style=""> 284         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="5065834272723126023" onmouseenter="enter('5065834272723126023');" onmouseout="out('5065834272723126023');" style=""> 285         //scannerBuilder 设置为null重新加载过滤条件,然后connkudu重新赋值                                                  </span>
<span class="2495891823177141345" onmouseenter="enter('2495891823177141345');" onmouseout="out('2495891823177141345');" style=""> 286         //todo:代码需要优化                                                                                    </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style=""> 287         scannerBuilder = null;                                                                           </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style=""> 288         connKuDu();                                                                                      </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style=""> 289         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style=""> 290         //  @wenbaoup fix bug                                                                            </span>
<span class="-2762964740504478972" onmouseenter="enter('-2762964740504478972');" onmouseout="out('-2762964740504478972');" style=""> 291         inputParams.entrySet().forEach(e -&gt;{                                                             </span>
<span class="-44569786791220301" onmouseenter="enter('-44569786791220301');" onmouseout="out('-44569786791220301');" style=""><abbr title=" 292             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Collections.singletonList(e.getValue())));"> 292             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Co🔵</abbr></span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 293         });                                                                                              </span>
<span  style=""> 294                                                                                                          </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style=""> 295         //  填充谓词信息                                                                                       </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style=""> 296         List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();          </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style=""> 297         if (predicateInfoes.size() &gt; 0) {                                                                </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style=""> 298             predicateInfoes.stream().map(info -&gt; {                                                       </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style=""> 299                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style=""> 300                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style=""> 301                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style=""> 303                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style=""> 304             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305         }                                                                                                </span>
<span  style=""> 306                                                                                                          </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style=""> 307         List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                   </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style=""> 308         AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                      </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 309         List&lt;CRow&gt; rowList = Lists.newArrayList();                                                       </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style=""> 310         Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                  </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style=""> 311         //从之前的同步修改为调用异步的Callback                                                                         </span>
<span class="278649099550089909" onmouseenter="enter('278649099550089909');" onmouseout="out('278649099550089909');" style=""><abbr title=" 312         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, buildCacheKey(inputParams)));"> 312         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, re🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313     }                                                                                                    </span>
<span  style=""> 314                                                                                                          </span>
<span  style=""> 315                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 316     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 317     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="7096347511226230072" onmouseenter="enter('7096347511226230072');" onmouseout="out('7096347511226230072');" style=""> 318         Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) sideInput;                                 </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 319         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 320         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 321             Object obj = input.getField(entry.getValue());                                               </span>
<span class="-7569211455899402285" onmouseenter="enter('-7569211455899402285');" onmouseout="out('-7569211455899402285');" style=""> 322             obj = convertTimeIndictorTypeInfo(entry.getValue(), obj);                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 323             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324         }                                                                                                </span>
<span  style=""> 325                                                                                                          </span>
<span class="-4063777341066712786" onmouseenter="enter('-4063777341066712786');" onmouseout="out('-4063777341066712786');" style=""> 326         for (Map.Entry&lt;Integer, String&gt; entry : sideInfo.getSideFieldNameIndex().entrySet()) {           </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 327             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 328                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 329             } else {                                                                                     </span>
<span class="-6152510067760557074" onmouseenter="enter('-6152510067760557074');" onmouseout="out('-6152510067760557074');" style=""> 330                 row.setField(entry.getKey(), cacheInfo.get(entry.getValue()));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332         }                                                                                                </span>
<span  style=""> 333                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 334         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335     }                                                                                                    </span>
<span  style=""> 336                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 337     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 338     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 339         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 340         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 341             sb.append(ele.toString())                                                                    </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 342                     .append(&quot;_&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343         }                                                                                                </span>
<span  style=""> 344                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 345         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346     }                                                                                                    </span>
<span  style=""> 347                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 348     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 349     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 350         super.close();                                                                                   </span>
<span class="-466861721853404898" onmouseenter="enter('-466861721853404898');" onmouseout="out('-466861721853404898');" style=""> 351         if (null != asyncClient) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 352             try {                                                                                        </span>
<span class="-2833913701521345427" onmouseenter="enter('-2833913701521345427');" onmouseout="out('-2833913701521345427');" style=""> 353                 asyncClient.close();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 354             } catch (Exception e) {                                                                      </span>
<span class="7169708839653618971" onmouseenter="enter('7169708839653618971');" onmouseout="out('7169708839653618971');" style=""> 355                 LOG.error(&quot;Error while closing client.&quot;, e);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="3638800353225348075" onmouseenter="enter('3638800353225348075');" onmouseout="out('3638800353225348075');" style=""> 360     class GetListRowCB implements Callback&lt;Deferred&lt;List&lt;Row&gt;&gt;, RowResultIterator&gt; {                     </span>
<span class="4696852104916231563" onmouseenter="enter('4696852104916231563');" onmouseout="out('4696852104916231563');" style=""> 361         private Tuple2&lt;Boolean,Row&gt; input;                                                               </span>
<span class="-3461178940071231317" onmouseenter="enter('-3461178940071231317');" onmouseout="out('-3461178940071231317');" style=""> 362         private List&lt;Map&lt;String, Object&gt;&gt; cacheContent;                                                  </span>
<span class="1247274010491913930" onmouseenter="enter('1247274010491913930');" onmouseout="out('1247274010491913930');" style=""> 363         private List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList;                                                       </span>
<span class="5723031173307092846" onmouseenter="enter('5723031173307092846');" onmouseout="out('5723031173307092846');" style=""> 364         private AsyncKuduScanner asyncKuduScanner;                                                       </span>
<span class="1809246968026899685" onmouseenter="enter('1809246968026899685');" onmouseout="out('1809246968026899685');" style=""> 365         private ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture;                                          </span>
<span class="-1449703644783381384" onmouseenter="enter('-1449703644783381384');" onmouseout="out('-1449703644783381384');" style=""> 366         private String key;                                                                              </span>
<span  style=""> 367                                                                                                          </span>
<span  style=""> 368                                                                                                          </span>
<span class="1613753735602313740" onmouseenter="enter('1613753735602313740');" onmouseout="out('1613753735602313740');" style=""> 369         public GetListRowCB() {                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370         }                                                                                                </span>
<span  style=""> 371                                                                                                          </span>
<span class="7340517348292441638" onmouseenter="enter('7340517348292441638');" onmouseout="out('7340517348292441638');" style=""><abbr title=" 372         GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList,"> 372         GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boole🔵</abbr></span>
<span class="-8589978589073406776" onmouseenter="enter('-8589978589073406776');" onmouseout="out('-8589978589073406776');" style=""><abbr title=" 373                      AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, String key) {"> 373                      AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, S🔵</abbr></span>
<span class="8214429602983504200" onmouseenter="enter('8214429602983504200');" onmouseout="out('8214429602983504200');" style=""> 374             this.input = input;                                                                          </span>
<span class="-7432664925500830597" onmouseenter="enter('-7432664925500830597');" onmouseout="out('-7432664925500830597');" style=""> 375             this.cacheContent = cacheContent;                                                            </span>
<span class="5762471889889938429" onmouseenter="enter('5762471889889938429');" onmouseout="out('5762471889889938429');" style=""> 376             this.rowList = rowList;                                                                      </span>
<span class="4954020228022176436" onmouseenter="enter('4954020228022176436');" onmouseout="out('4954020228022176436');" style=""> 377             this.asyncKuduScanner = asyncKuduScanner;                                                    </span>
<span class="592225705701792215" onmouseenter="enter('592225705701792215');" onmouseout="out('592225705701792215');" style=""> 378             this.resultFuture = resultFuture;                                                            </span>
<span class="5062295098979135982" onmouseenter="enter('5062295098979135982');" onmouseout="out('5062295098979135982');" style=""> 379             this.key = key;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380         }                                                                                                </span>
<span  style=""> 381                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 382         @Override                                                                                        </span>
<span class="8767874272678853351" onmouseenter="enter('8767874272678853351');" onmouseout="out('8767874272678853351');" style=""> 383         public Deferred&lt;List&lt;Row&gt;&gt; call(RowResultIterator results) throws Exception {                    </span>
<span class="-8941030450012249491" onmouseenter="enter('-8941030450012249491');" onmouseout="out('-8941030450012249491');" style=""> 384             for (RowResult result : results) {                                                           </span>
<span class="-7707387193564908050" onmouseenter="enter('-7707387193564908050');" onmouseout="out('-7707387193564908050');" style=""> 385                 Map&lt;String, Object&gt; oneRow = Maps.newHashMap();                                          </span>
<span class="4786776012437782338" onmouseenter="enter('4786776012437782338');" onmouseout="out('4786776012437782338');" style=""> 386                 for (String sideFieldName1 : StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;)) {   </span>
<span class="5422300911827801712" onmouseenter="enter('5422300911827801712');" onmouseout="out('5422300911827801712');" style=""> 387                     String sideFieldName = sideFieldName1.trim();                                        </span>
<span class="-7396994512053753949" onmouseenter="enter('-7396994512053753949');" onmouseout="out('-7396994512053753949');" style=""> 388                     ColumnSchema columnSchema = table.getSchema().getColumn(sideFieldName);              </span>
<span class="-1551001954350423389" onmouseenter="enter('-1551001954350423389');" onmouseout="out('-1551001954350423389');" style=""> 389                     if (null != columnSchema) {                                                          </span>
<span class="-9080618923968214410" onmouseenter="enter('-9080618923968214410');" onmouseout="out('-9080618923968214410');" style=""> 390                         KuduUtil.setMapValue(columnSchema.getType(), oneRow, sideFieldName, result);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392                 }                                                                                        </span>
<span class="5830289147325916559" onmouseenter="enter('5830289147325916559');" onmouseout="out('5830289147325916559');" style=""> 393                 Row row = fillData(input.f1, oneRow);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 394                 if (openCache()) {                                                                       </span>
<span class="1888587301705190474" onmouseenter="enter('1888587301705190474');" onmouseout="out('1888587301705190474');" style=""> 395                     cacheContent.add(oneRow);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396                 }                                                                                        </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 397                 rowList.add(Tuple2.of(input.f0, row));                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398             }                                                                                            </span>
<span class="-5880917173204222408" onmouseenter="enter('-5880917173204222408');" onmouseout="out('-5880917173204222408');" style=""> 399             if (asyncKuduScanner.hasMoreRows()) {                                                        </span>
<span class="411290205859931493" onmouseenter="enter('411290205859931493');" onmouseout="out('411290205859931493');" style=""> 400                 return asyncKuduScanner.nextRows().addCallbackDeferring(this);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401             }                                                                                            </span>
<span  style=""> 402                                                                                                          </span>
<span class="-5182000486454444757" onmouseenter="enter('-5182000486454444757');" onmouseout="out('-5182000486454444757');" style=""> 403             if (rowList.size() &gt; 0) {                                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 404                 if (openCache()) {                                                                       </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 405                     putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406                 }                                                                                        </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 407                 resultFuture.complete(rowList);                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 408             } else {                                                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 409                 dealMissKey(input, resultFuture);                                                        </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 410                 if (openCache()) {                                                                       </span>
<span class="-7075096462798044408" onmouseenter="enter('-7075096462798044408');" onmouseout="out('-7075096462798044408');" style=""> 411                     //放置在putCache的Miss中 一段时间内同一个key都会直接返回                                                </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 412                     putCache(key, CacheMissVal.getMissKeyObj());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414             }                                                                                            </span>
<span  style=""> 415                                                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 416             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418     }                                                                                                    </span>
<span  style=""> 419                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-8840953368027741170" onmouseenter="enter('-8840953368027741170');" onmouseout="out('-8840953368027741170');" style="">   1 package com.dtstack.flink.sql.side.kudu;                                                                 </span>
<span  style="">   2                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">   3 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">   4 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">   5 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">   6 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">   7 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">   8 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">   9 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  10 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5710642889135375263" onmouseenter="enter('5710642889135375263');" onmouseout="out('5710642889135375263');" style="">  11 import com.dtstack.flink.sql.side.kudu.table.KuduSideTableInfo;                                          </span>
<span class="1164335795537447661" onmouseenter="enter('1164335795537447661');" onmouseout="out('1164335795537447661');" style="">  12 import com.dtstack.flink.sql.side.kudu.utils.KuduUtil;                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  13 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  14 import com.google.common.collect.Maps;                                                                   </span>
<span class="-5750625329012831967" onmouseenter="enter('-5750625329012831967');" onmouseout="out('-5750625329012831967');" style="">  15 import com.stumbleupon.async.Callback;                                                                   </span>
<span class="-5487067255628915347" onmouseenter="enter('-5487067255628915347');" onmouseout="out('-5487067255628915347');" style="">  16 import com.stumbleupon.async.Deferred;                                                                   </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  17 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  18 import java.util.Arrays;                                                                                 </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  19 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  20 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  21 import java.util.Map;                                                                                    </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  23 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  24 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  25 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  26 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  28 import org.apache.flink.util.Preconditions;                                                              </span>
<span class="1631232015531818624" onmouseenter="enter('1631232015531818624');" onmouseout="out('1631232015531818624');" style="">  29 import org.apache.kudu.ColumnSchema;                                                                     </span>
<span class="-1755042893780385624" onmouseenter="enter('-1755042893780385624');" onmouseout="out('-1755042893780385624');" style="">  30 import org.apache.kudu.Schema;                                                                           </span>
<span class="7204708202450962745" onmouseenter="enter('7204708202450962745');" onmouseout="out('7204708202450962745');" style="">  31 import org.apache.kudu.client.AsyncKuduClient;                                                           </span>
<span class="3400841229030892477" onmouseenter="enter('3400841229030892477');" onmouseout="out('3400841229030892477');" style="">  32 import org.apache.kudu.client.AsyncKuduScanner;                                                          </span>
<span class="1860194643195428903" onmouseenter="enter('1860194643195428903');" onmouseout="out('1860194643195428903');" style="">  33 import org.apache.kudu.client.KuduException;                                                             </span>
<span class="128288131530978478" onmouseenter="enter('128288131530978478');" onmouseout="out('128288131530978478');" style="">  34 import org.apache.kudu.client.KuduPredicate;                                                             </span>
<span class="-342692776902705676" onmouseenter="enter('-342692776902705676');" onmouseout="out('-342692776902705676');" style="">  35 import org.apache.kudu.client.KuduTable;                                                                 </span>
<span class="-6157621177665621032" onmouseenter="enter('-6157621177665621032');" onmouseout="out('-6157621177665621032');" style="">  36 import org.apache.kudu.client.RowResult;                                                                 </span>
<span class="-1845673204769190809" onmouseenter="enter('-1845673204769190809');" onmouseout="out('-1845673204769190809');" style="">  37 import org.apache.kudu.client.RowResultIterator;                                                         </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  38 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  39 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  40                                                                                                          </span>
<span  style="">  41                                                                                                          </span>
<span class="3638139650453766874" onmouseenter="enter('3638139650453766874');" onmouseout="out('3638139650453766874');" style="">  42 public class KuduAsyncReqRow extends BaseAsyncReqRow {                                                   </span>
<span class="-2074213480282018260" onmouseenter="enter('-2074213480282018260');" onmouseout="out('-2074213480282018260');" style="">  43     private static final Logger LOG = LoggerFactory.getLogger(KuduAsyncReqRow.class);                    </span>
<span  style="">  44                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45     /**                                                                                                  </span>
<span class="-8285284077529796986" onmouseenter="enter('-8285284077529796986');" onmouseout="out('-8285284077529796986');" style="">  46      * 获取连接的尝试次数                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47      */                                                                                                  </span>
<span class="-1089202172816726338" onmouseenter="enter('-1089202172816726338');" onmouseout="out('-1089202172816726338');" style="">  48     private static final int CONN_RETRY_NUM = 3;                                                         </span>
<span  style="">  49                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  50     /**                                                                                                  </span>
<span class="4062789252244833512" onmouseenter="enter('4062789252244833512');" onmouseout="out('4062789252244833512');" style="">  51      * 缓存条数                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  52      */                                                                                                  </span>
<span class="1004470848600586149" onmouseenter="enter('1004470848600586149');" onmouseout="out('1004470848600586149');" style="">  53     private static final Long FETCH_SIZE = 1000L;                                                        </span>
<span  style="">  54                                                                                                          </span>
<span class="5253634271646137455" onmouseenter="enter('5253634271646137455');" onmouseout="out('5253634271646137455');" style="">  55     private static final long serialVersionUID = 5028583854989267753L;                                   </span>
<span  style="">  56                                                                                                          </span>
<span class="6513367378672126597" onmouseenter="enter('6513367378672126597');" onmouseout="out('6513367378672126597');" style="">  57     private AsyncKuduClient asyncClient;                                                                 </span>
<span  style="">  58                                                                                                          </span>
<span class="1317689277640300307" onmouseenter="enter('1317689277640300307');" onmouseout="out('1317689277640300307');" style="">  59     private KuduTable table;                                                                             </span>
<span  style="">  60                                                                                                          </span>
<span class="4635177141603060317" onmouseenter="enter('4635177141603060317');" onmouseout="out('4635177141603060317');" style="">  61     private KuduSideTableInfo kuduSideTableInfo;                                                         </span>
<span  style="">  62                                                                                                          </span>
<span class="4170992710598328570" onmouseenter="enter('4170992710598328570');" onmouseout="out('4170992710598328570');" style="">  63     private AsyncKuduScanner.AsyncKuduScannerBuilder scannerBuilder;                                     </span>
<span  style="">  64                                                                                                          </span>
<span class="-5994744104468733303" onmouseenter="enter('-5994744104468733303');" onmouseout="out('-5994744104468733303');" style=""><abbr title="  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  65     public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, 🔵</abbr></span>
<span class="6563035163892178349" onmouseenter="enter('6563035163892178349');" onmouseout="out('6563035163892178349');" style="">  66         super(new KuduAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  69     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  70     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  71         super.open(parameters);                                                                          </span>
<span class="-7685679746867905609" onmouseenter="enter('-7685679746867905609');" onmouseout="out('-7685679746867905609');" style="">  72         kuduSideTableInfo = (KuduSideTableInfo) sideInfo.getSideTableInfo();                             </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="">  73         connKuDu();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  76     /**                                                                                                  </span>
<span class="803083353752398343" onmouseenter="enter('803083353752398343');" onmouseout="out('803083353752398343');" style="">  77      * 连接kudu中的表                                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78      *                                                                                                   </span>
<span class="-5432256053392020081" onmouseenter="enter('-5432256053392020081');" onmouseout="out('-5432256053392020081');" style="">  79      * @throws KuduException                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  80      */                                                                                                  </span>
<span class="-5290115760614089350" onmouseenter="enter('-5290115760614089350');" onmouseout="out('-5290115760614089350');" style="">  81     private void connKuDu() throws KuduException {                                                       </span>
<span class="-56179035184578959" onmouseenter="enter('-56179035184578959');" onmouseout="out('-56179035184578959');" style="">  82         if (null == table) {                                                                             </span>
<span class="4308396336047168888" onmouseenter="enter('4308396336047168888');" onmouseout="out('4308396336047168888');" style="">  83             String kuduMasters = kuduSideTableInfo.getKuduMasters();                                     </span>
<span class="-4444229447990232757" onmouseenter="enter('-4444229447990232757');" onmouseout="out('-4444229447990232757');" style="">  84             String tableName = kuduSideTableInfo.getTableName();                                         </span>
<span class="4427587995392923155" onmouseenter="enter('4427587995392923155');" onmouseout="out('4427587995392923155');" style="">  85             Integer workerCount = kuduSideTableInfo.getWorkerCount();                                    </span>
<span class="-5299851536099138671" onmouseenter="enter('-5299851536099138671');" onmouseout="out('-5299851536099138671');" style="">  86             Integer defaultSocketReadTimeoutMs = kuduSideTableInfo.getDefaultSocketReadTimeoutMs();      </span>
<span class="-2694307185983387776" onmouseenter="enter('-2694307185983387776');" onmouseout="out('-2694307185983387776');" style="">  87             Integer defaultOperationTimeoutMs = kuduSideTableInfo.getDefaultOperationTimeoutMs();        </span>
<span  style="">  88                                                                                                          </span>
<span class="-6052455991030570635" onmouseenter="enter('-6052455991030570635');" onmouseout="out('-6052455991030570635');" style="">  89             Preconditions.checkNotNull(kuduMasters, &quot;kuduMasters could not be null&quot;);                    </span>
<span  style="">  90                                                                                                          </span>
<span class="-6520194397411128459" onmouseenter="enter('-6520194397411128459');" onmouseout="out('-6520194397411128459');" style=""><abbr title="  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBuilder(kuduMasters);">  91             AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKudu🔵</abbr></span>
<span class="-8227759523178082238" onmouseenter="enter('-8227759523178082238');" onmouseout="out('-8227759523178082238');" style="">  92             if (null != workerCount) {                                                                   </span>
<span class="-5467062577113570128" onmouseenter="enter('-5467062577113570128');" onmouseout="out('-5467062577113570128');" style="">  93                 asyncKuduClientBuilder.workerCount(workerCount);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94             }                                                                                            </span>
<span  style="">  95                                                                                                          </span>
<span class="-2397215110746175709" onmouseenter="enter('-2397215110746175709');" onmouseout="out('-2397215110746175709');" style="">  96             if (null != defaultOperationTimeoutMs) {                                                     </span>
<span class="7366215511831154275" onmouseenter="enter('7366215511831154275');" onmouseout="out('7366215511831154275');" style="">  97                 asyncKuduClientBuilder.defaultOperationTimeoutMs(defaultOperationTimeoutMs);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98             }                                                                                            </span>
<span class="2560969904046492964" onmouseenter="enter('2560969904046492964');" onmouseout="out('2560969904046492964');" style="">  99             asyncClient = asyncKuduClientBuilder.build();                                                </span>
<span class="441886789095796306" onmouseenter="enter('441886789095796306');" onmouseout="out('441886789095796306');" style=""> 100             if (!asyncClient.syncClient().tableExists(tableName)) {                                      </span>
<span class="4123299035781055923" onmouseenter="enter('4123299035781055923');" onmouseout="out('4123299035781055923');" style=""> 101                 throw new IllegalArgumentException(&quot;Table Open Failed , please check table exists&quot;);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102             }                                                                                            </span>
<span class="4092827604202793861" onmouseenter="enter('4092827604202793861');" onmouseout="out('4092827604202793861');" style=""> 103             table = asyncClient.syncClient().openTable(tableName);                                       </span>
<span class="4177758485368982030" onmouseenter="enter('4177758485368982030');" onmouseout="out('4177758485368982030');" style=""> 104             LOG.info(&quot;connect kudu is successed!&quot;);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span class="2924668647776163983" onmouseenter="enter('2924668647776163983');" onmouseout="out('2924668647776163983');" style=""> 106         scannerBuilder = asyncClient.newScannerBuilder(table);                                           </span>
<span class="-4404448253596110496" onmouseenter="enter('-4404448253596110496');" onmouseout="out('-4404448253596110496');" style=""> 107         Integer batchSizeBytes = kuduSideTableInfo.getBatchSizeBytes();                                  </span>
<span class="-7735055932391271380" onmouseenter="enter('-7735055932391271380');" onmouseout="out('-7735055932391271380');" style=""> 108         Long limitNum = kuduSideTableInfo.getLimitNum();                                                 </span>
<span class="1611473127340759637" onmouseenter="enter('1611473127340759637');" onmouseout="out('1611473127340759637');" style=""> 109         Boolean isFaultTolerant = kuduSideTableInfo.getFaultTolerant();                                  </span>
<span class="-8526639943056837274" onmouseenter="enter('-8526639943056837274');" onmouseout="out('-8526639943056837274');" style=""> 110         //查询需要的字段                                                                                        </span>
<span class="2090107689800818740" onmouseenter="enter('2090107689800818740');" onmouseout="out('2090107689800818740');" style=""> 111         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;);                </span>
<span  style=""> 112                                                                                                          </span>
<span class="-8080913465496496419" onmouseenter="enter('-8080913465496496419');" onmouseout="out('-8080913465496496419');" style=""> 113         if (null == limitNum || limitNum &lt;= 0) {                                                         </span>
<span class="7767157001459171317" onmouseenter="enter('7767157001459171317');" onmouseout="out('7767157001459171317');" style=""> 114             scannerBuilder.limit(FETCH_SIZE);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 115         } else {                                                                                         </span>
<span class="6087958399625777057" onmouseenter="enter('6087958399625777057');" onmouseout="out('6087958399625777057');" style=""> 116             scannerBuilder.limit(limitNum);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117         }                                                                                                </span>
<span class="-5740110908714073879" onmouseenter="enter('-5740110908714073879');" onmouseout="out('-5740110908714073879');" style=""> 118         if (null != batchSizeBytes) {                                                                    </span>
<span class="-3929060200025616829" onmouseenter="enter('-3929060200025616829');" onmouseout="out('-3929060200025616829');" style=""> 119             scannerBuilder.batchSizeBytes(batchSizeBytes);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120         }                                                                                                </span>
<span class="-8680730272034558637" onmouseenter="enter('-8680730272034558637');" onmouseout="out('-8680730272034558637');" style=""> 121         if (null != isFaultTolerant) {                                                                   </span>
<span class="-5364988782144201666" onmouseenter="enter('-5364988782144201666');" onmouseout="out('-5364988782144201666');" style=""> 122             scannerBuilder.setFaultTolerant(isFaultTolerant);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span  style=""> 124                                                                                                          </span>
<span class="6330664272177173056" onmouseenter="enter('6330664272177173056');" onmouseout="out('6330664272177173056');" style=""> 125         List&lt;String&gt; projectColumns = Arrays.asList(sideFieldNames);                                     </span>
<span class="2684072470806705647" onmouseenter="enter('2684072470806705647');" onmouseout="out('2684072470806705647');" style=""> 126         scannerBuilder.setProjectedColumnNames(projectColumns);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="2104652039667641752" onmouseenter="enter('2104652039667641752');" onmouseout="out('2104652039667641752');" style=""><abbr title=" 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception {"> 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFutu🔵</abbr></span>
<span class="-9200276852123234128" onmouseenter="enter('-9200276852123234128');" onmouseout="out('-9200276852123234128');" style=""> 131         Tuple2&lt;Boolean, Row&gt; inputCopy = Tuple2.of(input.f0, input.f1);                                  </span>
<span class="8095734502037569780" onmouseenter="enter('8095734502037569780');" onmouseout="out('8095734502037569780');" style=""> 132         // scannerBuilder 设置为null重新加载过滤条件,然后connkudu重新赋值                                                 </span>
<span class="2495891823177141345" onmouseenter="enter('2495891823177141345');" onmouseout="out('2495891823177141345');" style=""> 133         //todo:代码需要优化                                                                                    </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style=""> 134         scannerBuilder = null;                                                                           </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style=""> 135         connKuDu();                                                                                      </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style=""> 136         Schema schema = table.getSchema();                                                               </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style=""> 137         //  @wenbaoup fix bug                                                                            </span>
<span class="-359741823083691063" onmouseenter="enter('-359741823083691063');" onmouseout="out('-359741823083691063');" style=""> 138         inputParams.entrySet().forEach(( e) -&gt; {                                                         </span>
<span class="-44569786791220301" onmouseenter="enter('-44569786791220301');" onmouseout="out('-44569786791220301');" style=""><abbr title=" 139             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Collections.singletonList(e.getValue())));"> 139             scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Co🔵</abbr></span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 140         });                                                                                              </span>
<span class="4576239084201927411" onmouseenter="enter('4576239084201927411');" onmouseout="out('4576239084201927411');" style=""> 141         // 填充谓词信息                                                                                        </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style=""> 142         List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();          </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style=""> 143         if (predicateInfoes.size() &gt; 0) {                                                                </span>
<span class="3439458092021767207" onmouseenter="enter('3439458092021767207');" onmouseout="out('3439458092021767207');" style=""> 144             predicateInfoes.stream().map(( info) -&gt; {                                                    </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style=""> 145                 KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                 </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style=""> 146                 if (null != kuduPredicate) {                                                             </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style=""> 147                     scannerBuilder.addPredicate(kuduPredicate);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148                 }                                                                                        </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style=""> 149                 return info;                                                                             </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style=""> 150             }).count();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151         }                                                                                                </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style=""> 152         List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                   </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style=""> 153         AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                      </span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style=""> 154         List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                                       </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style=""> 155         Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                  </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style=""> 156         //从之前的同步修改为调用异步的Callback                                                                         </span>
<span class="278649099550089909" onmouseenter="enter('278649099550089909');" onmouseout="out('278649099550089909');" style=""><abbr title=" 157         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, buildCacheKey(inputParams)));"> 157         data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, re🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 160     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 161     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 162         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 163         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style=""> 164             sb.append(ele.toString()).append(&quot;_&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 166         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span  style=""> 168                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 169     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 170     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="2926391945845903809" onmouseenter="enter('2926391945845903809');" onmouseout="out('2926391945845903809');" style=""> 171         Map&lt;String, Object&gt; cacheInfo = ((Map&lt;String, Object&gt;) (sideInput));                             </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 172         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 173         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 174             Object obj = input.getField(entry.getValue());                                               </span>
<span class="-7569211455899402285" onmouseenter="enter('-7569211455899402285');" onmouseout="out('-7569211455899402285');" style=""> 175             obj = convertTimeIndictorTypeInfo(entry.getValue(), obj);                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 176             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177         }                                                                                                </span>
<span class="-4063777341066712786" onmouseenter="enter('-4063777341066712786');" onmouseout="out('-4063777341066712786');" style=""> 178         for (Map.Entry&lt;Integer, String&gt; entry : sideInfo.getSideFieldNameIndex().entrySet()) {           </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 179             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 180                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 181             } else {                                                                                     </span>
<span class="-6152510067760557074" onmouseenter="enter('-6152510067760557074');" onmouseout="out('-6152510067760557074');" style=""> 182                 row.setField(entry.getKey(), cacheInfo.get(entry.getValue()));                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184         }                                                                                                </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 185         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186     }                                                                                                    </span>
<span  style=""> 187                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 188     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 189     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 190         super.close();                                                                                   </span>
<span class="-466861721853404898" onmouseenter="enter('-466861721853404898');" onmouseout="out('-466861721853404898');" style=""> 191         if (null != asyncClient) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 192             try {                                                                                        </span>
<span class="-2833913701521345427" onmouseenter="enter('-2833913701521345427');" onmouseout="out('-2833913701521345427');" style=""> 193                 asyncClient.close();                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 194             } catch (Exception e) {                                                                      </span>
<span class="7169708839653618971" onmouseenter="enter('7169708839653618971');" onmouseout="out('7169708839653618971');" style=""> 195                 LOG.error(&quot;Error while closing client.&quot;, e);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="3638800353225348075" onmouseenter="enter('3638800353225348075');" onmouseout="out('3638800353225348075');" style=""> 200     class GetListRowCB implements Callback&lt;Deferred&lt;List&lt;Row&gt;&gt;, RowResultIterator&gt; {                     </span>
<span class="4935185106490032462" onmouseenter="enter('4935185106490032462');" onmouseout="out('4935185106490032462');" style=""> 201         private Tuple2&lt;Boolean, Row&gt; input;                                                              </span>
<span  style=""> 202                                                                                                          </span>
<span class="-3461178940071231317" onmouseenter="enter('-3461178940071231317');" onmouseout="out('-3461178940071231317');" style=""> 203         private List&lt;Map&lt;String, Object&gt;&gt; cacheContent;                                                  </span>
<span  style=""> 204                                                                                                          </span>
<span class="-7106574304701525789" onmouseenter="enter('-7106574304701525789');" onmouseout="out('-7106574304701525789');" style=""> 205         private List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList;                                                      </span>
<span  style=""> 206                                                                                                          </span>
<span class="5723031173307092846" onmouseenter="enter('5723031173307092846');" onmouseout="out('5723031173307092846');" style=""> 207         private AsyncKuduScanner asyncKuduScanner;                                                       </span>
<span  style=""> 208                                                                                                          </span>
<span class="-2086964647275595508" onmouseenter="enter('-2086964647275595508');" onmouseout="out('-2086964647275595508');" style=""> 209         private ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture;                                         </span>
<span  style=""> 210                                                                                                          </span>
<span class="-1449703644783381384" onmouseenter="enter('-1449703644783381384');" onmouseout="out('-1449703644783381384');" style=""> 211         private String key;                                                                              </span>
<span  style=""> 212                                                                                                          </span>
<span class="1613753735602313740" onmouseenter="enter('1613753735602313740');" onmouseout="out('1613753735602313740');" style=""> 213         public GetListRowCB() {                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214         }                                                                                                </span>
<span  style=""> 215                                                                                                          </span>
<span class="-2082719423868106186" onmouseenter="enter('-2082719423868106186');" onmouseout="out('-2082719423868106186');" style=""><abbr title=" 216         GetListRowCB(Tuple2&lt;Boolean, Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList, AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture, String key) {"> 216         GetListRowCB(Tuple2&lt;Boolean, Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Bool🔵</abbr></span>
<span class="8214429602983504200" onmouseenter="enter('8214429602983504200');" onmouseout="out('8214429602983504200');" style=""> 217             this.input = input;                                                                          </span>
<span class="-7432664925500830597" onmouseenter="enter('-7432664925500830597');" onmouseout="out('-7432664925500830597');" style=""> 218             this.cacheContent = cacheContent;                                                            </span>
<span class="5762471889889938429" onmouseenter="enter('5762471889889938429');" onmouseout="out('5762471889889938429');" style=""> 219             this.rowList = rowList;                                                                      </span>
<span class="4954020228022176436" onmouseenter="enter('4954020228022176436');" onmouseout="out('4954020228022176436');" style=""> 220             this.asyncKuduScanner = asyncKuduScanner;                                                    </span>
<span class="592225705701792215" onmouseenter="enter('592225705701792215');" onmouseout="out('592225705701792215');" style=""> 221             this.resultFuture = resultFuture;                                                            </span>
<span class="5062295098979135982" onmouseenter="enter('5062295098979135982');" onmouseout="out('5062295098979135982');" style=""> 222             this.key = key;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223         }                                                                                                </span>
<span  style=""> 224                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 225         @Override                                                                                        </span>
<span class="8767874272678853351" onmouseenter="enter('8767874272678853351');" onmouseout="out('8767874272678853351');" style=""> 226         public Deferred&lt;List&lt;Row&gt;&gt; call(RowResultIterator results) throws Exception {                    </span>
<span class="-8941030450012249491" onmouseenter="enter('-8941030450012249491');" onmouseout="out('-8941030450012249491');" style=""> 227             for (RowResult result : results) {                                                           </span>
<span class="-7707387193564908050" onmouseenter="enter('-7707387193564908050');" onmouseout="out('-7707387193564908050');" style=""> 228                 Map&lt;String, Object&gt; oneRow = Maps.newHashMap();                                          </span>
<span class="4786776012437782338" onmouseenter="enter('4786776012437782338');" onmouseout="out('4786776012437782338');" style=""> 229                 for (String sideFieldName1 : StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;)) {   </span>
<span class="5422300911827801712" onmouseenter="enter('5422300911827801712');" onmouseout="out('5422300911827801712');" style=""> 230                     String sideFieldName = sideFieldName1.trim();                                        </span>
<span class="-7396994512053753949" onmouseenter="enter('-7396994512053753949');" onmouseout="out('-7396994512053753949');" style=""> 231                     ColumnSchema columnSchema = table.getSchema().getColumn(sideFieldName);              </span>
<span class="-1551001954350423389" onmouseenter="enter('-1551001954350423389');" onmouseout="out('-1551001954350423389');" style=""> 232                     if (null != columnSchema) {                                                          </span>
<span class="-9080618923968214410" onmouseenter="enter('-9080618923968214410');" onmouseout="out('-9080618923968214410');" style=""> 233                         KuduUtil.setMapValue(columnSchema.getType(), oneRow, sideFieldName, result);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235                 }                                                                                        </span>
<span class="5830289147325916559" onmouseenter="enter('5830289147325916559');" onmouseout="out('5830289147325916559');" style=""> 236                 Row row = fillData(input.f1, oneRow);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 237                 if (openCache()) {                                                                       </span>
<span class="1888587301705190474" onmouseenter="enter('1888587301705190474');" onmouseout="out('1888587301705190474');" style=""> 238                     cacheContent.add(oneRow);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239                 }                                                                                        </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 240                 rowList.add(Tuple2.of(input.f0, row));                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241             }                                                                                            </span>
<span class="-5880917173204222408" onmouseenter="enter('-5880917173204222408');" onmouseout="out('-5880917173204222408');" style=""> 242             if (asyncKuduScanner.hasMoreRows()) {                                                        </span>
<span class="411290205859931493" onmouseenter="enter('411290205859931493');" onmouseout="out('411290205859931493');" style=""> 243                 return asyncKuduScanner.nextRows().addCallbackDeferring(this);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244             }                                                                                            </span>
<span class="-5182000486454444757" onmouseenter="enter('-5182000486454444757');" onmouseout="out('-5182000486454444757');" style=""> 245             if (rowList.size() &gt; 0) {                                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 246                 if (openCache()) {                                                                       </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 247                     putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248                 }                                                                                        </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 249                 resultFuture.complete(rowList);                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 250             } else {                                                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 251                 dealMissKey(input, resultFuture);                                                        </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 252                 if (openCache()) {                                                                       </span>
<span class="-8441501593343926173" onmouseenter="enter('-8441501593343926173');" onmouseout="out('-8441501593343926173');" style=""> 253                     // 放置在putCache的Miss中 一段时间内同一个key都会直接返回                                               </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 254                     putCache(key, CacheMissVal.getMissKeyObj());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 257             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260 }                                                                                                        </span>






























































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-8840953368027741170" onmouseenter="enter('-8840953368027741170');" onmouseout="out('-8840953368027741170');" style="">   1  package com.dtstack.flink.sql.side.kudu;                                                                          </span>
<span  style="">   2                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">   3  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">   4  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">   5  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">   6  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">   7  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">   8  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">   9  import com.dtstack.flink.sql.side.PredicateInfo;                                                                  </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  10  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5710642889135375263" onmouseenter="enter('5710642889135375263');" onmouseout="out('5710642889135375263');" style="">  11  import com.dtstack.flink.sql.side.kudu.table.KuduSideTableInfo;                                                   </span>
<span class="1164335795537447661" onmouseenter="enter('1164335795537447661');" onmouseout="out('1164335795537447661');" style="">  12  import com.dtstack.flink.sql.side.kudu.utils.KuduUtil;                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  13  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  14  import com.google.common.collect.Maps;                                                                            </span>
<span class="-5750625329012831967" onmouseenter="enter('-5750625329012831967');" onmouseout="out('-5750625329012831967');" style="">  15  import com.stumbleupon.async.Callback;                                                                            </span>
<span class="-5487067255628915347" onmouseenter="enter('-5487067255628915347');" onmouseout="out('-5487067255628915347');" style="">  16  import com.stumbleupon.async.Deferred;                                                                            </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  17  import io.vertx.core.json.JsonArray;                                                                              </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  18  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  19 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  20  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  21  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  22  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  25  import org.apache.flink.types.Row;                                                                                </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  26  import org.apache.flink.util.Preconditions;                                                                       </span>
<span class="1631232015531818624" onmouseenter="enter('1631232015531818624');" onmouseout="out('1631232015531818624');" style="">  27  import org.apache.kudu.ColumnSchema;                                                                              </span>
<span class="-1755042893780385624" onmouseenter="enter('-1755042893780385624');" onmouseout="out('-1755042893780385624');" style="">  28  import org.apache.kudu.Schema;                                                                                    </span>
<span class="7204708202450962745" onmouseenter="enter('7204708202450962745');" onmouseout="out('7204708202450962745');" style="">  29  import org.apache.kudu.client.AsyncKuduClient;                                                                    </span>
<span class="3400841229030892477" onmouseenter="enter('3400841229030892477');" onmouseout="out('3400841229030892477');" style="">  30  import org.apache.kudu.client.AsyncKuduScanner;                                                                   </span>
<span class="1860194643195428903" onmouseenter="enter('1860194643195428903');" onmouseout="out('1860194643195428903');" style="">  31  import org.apache.kudu.client.KuduException;                                                                      </span>
<span class="128288131530978478" onmouseenter="enter('128288131530978478');" onmouseout="out('128288131530978478');" style="">  32  import org.apache.kudu.client.KuduPredicate;                                                                      </span>
<span class="-342692776902705676" onmouseenter="enter('-342692776902705676');" onmouseout="out('-342692776902705676');" style="">  33  import org.apache.kudu.client.KuduTable;                                                                          </span>
<span class="-6157621177665621032" onmouseenter="enter('-6157621177665621032');" onmouseout="out('-6157621177665621032');" style="">  34  import org.apache.kudu.client.RowResult;                                                                          </span>
<span class="-1845673204769190809" onmouseenter="enter('-1845673204769190809');" onmouseout="out('-1845673204769190809');" style="">  35  import org.apache.kudu.client.RowResultIterator;                                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  36  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  37  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  38                                                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import java.sql.Timestamp;                                                                                        </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  40  import java.util.Arrays;                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  41  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  43  import java.util.Map;                                                                                             </span>
<span  style="">  44                                                                                                                    </span>
<span class="3638139650453766874" onmouseenter="enter('3638139650453766874');" onmouseout="out('3638139650453766874');" style="">  45  public class KuduAsyncReqRow extends BaseAsyncReqRow {                                                            </span>
<span  style="">  46                                                                                                                    </span>
<span class="-2074213480282018260" onmouseenter="enter('-2074213480282018260');" onmouseout="out('-2074213480282018260');" style="">  47      private static final Logger LOG = LoggerFactory.getLogger(KuduAsyncReqRow.class);                             </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  48      /**                                                                                                           </span>
<span class="-8285284077529796986" onmouseenter="enter('-8285284077529796986');" onmouseout="out('-8285284077529796986');" style="">  49       * 获取连接的尝试次数                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50       */                                                                                                           </span>
<span class="-1089202172816726338" onmouseenter="enter('-1089202172816726338');" onmouseout="out('-1089202172816726338');" style="">  51      private static final int CONN_RETRY_NUM = 3;                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52      /**                                                                                                           </span>
<span class="4062789252244833512" onmouseenter="enter('4062789252244833512');" onmouseout="out('4062789252244833512');" style="">  53       * 缓存条数                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54       */                                                                                                           </span>
<span class="1004470848600586149" onmouseenter="enter('1004470848600586149');" onmouseout="out('1004470848600586149');" style="">  55      private static final Long FETCH_SIZE = 1000L;                                                                 </span>
<span  style="">  56                                                                                                                    </span>
<span class="5253634271646137455" onmouseenter="enter('5253634271646137455');" onmouseout="out('5253634271646137455');" style="">  57      private static final long serialVersionUID = 5028583854989267753L;                                            </span>
<span  style="">  58                                                                                                                    </span>
<span  style="">  59                                                                                                                    </span>
<span class="6513367378672126597" onmouseenter="enter('6513367378672126597');" onmouseout="out('6513367378672126597');" style="">  60      private AsyncKuduClient asyncClient;                                                                          </span>
<span  style="">  61                                                                                                                    </span>
<span class="1317689277640300307" onmouseenter="enter('1317689277640300307');" onmouseout="out('1317689277640300307');" style="">  62      private KuduTable table;                                                                                      </span>
<span  style="">  63                                                                                                                    </span>
<span class="4635177141603060317" onmouseenter="enter('4635177141603060317');" onmouseout="out('4635177141603060317');" style="">  64      private KuduSideTableInfo kuduSideTableInfo;                                                                  </span>
<span  style="">  65                                                                                                                    </span>
<span class="4170992710598328570" onmouseenter="enter('4170992710598328570');" onmouseout="out('4170992710598328570');" style="">  66      private AsyncKuduScanner.AsyncKuduScannerBuilder scannerBuilder;                                              </span>
<span  style="">  67                                                                                                                    </span>
<span class="-5994744104468733303" onmouseenter="enter('-5994744104468733303');" onmouseout="out('-5994744104468733303');" style=""><abbr title="  68      public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  68      public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractS🔵</abbr></span>
<span class="6563035163892178349" onmouseenter="enter('6563035163892178349');" onmouseout="out('6563035163892178349');" style="">  69          super(new KuduAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70      }                                                                                                             </span>
<span  style="">  71                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  72      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  73      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  74          super.open(parameters);                                                                                   </span>
<span class="-7685679746867905609" onmouseenter="enter('-7685679746867905609');" onmouseout="out('-7685679746867905609');" style="">  75          kuduSideTableInfo = (KuduSideTableInfo) sideInfo.getSideTableInfo();                                      </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="">  76          connKuDu();                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77      }                                                                                                             </span>
<span  style="">  78                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  79      /**                                                                                                           </span>
<span class="803083353752398343" onmouseenter="enter('803083353752398343');" onmouseout="out('803083353752398343');" style="">  80       * 连接kudu中的表                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  81       *                                                                                                            </span>
<span class="-5432256053392020081" onmouseenter="enter('-5432256053392020081');" onmouseout="out('-5432256053392020081');" style="">  82       * @throws KuduException                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  83       */                                                                                                           </span>
<span class="-5290115760614089350" onmouseenter="enter('-5290115760614089350');" onmouseout="out('-5290115760614089350');" style="">  84      private void connKuDu() throws KuduException {                                                                </span>
<span class="-56179035184578959" onmouseenter="enter('-56179035184578959');" onmouseout="out('-56179035184578959');" style="">  85          if (null == table) {                                                                                      </span>
<span class="4308396336047168888" onmouseenter="enter('4308396336047168888');" onmouseout="out('4308396336047168888');" style="">  86              String kuduMasters = kuduSideTableInfo.getKuduMasters();                                              </span>
<span class="-4444229447990232757" onmouseenter="enter('-4444229447990232757');" onmouseout="out('-4444229447990232757');" style="">  87              String tableName = kuduSideTableInfo.getTableName();                                                  </span>
<span class="4427587995392923155" onmouseenter="enter('4427587995392923155');" onmouseout="out('4427587995392923155');" style="">  88              Integer workerCount = kuduSideTableInfo.getWorkerCount();                                             </span>
<span class="-5299851536099138671" onmouseenter="enter('-5299851536099138671');" onmouseout="out('-5299851536099138671');" style="">  89              Integer defaultSocketReadTimeoutMs = kuduSideTableInfo.getDefaultSocketReadTimeoutMs();               </span>
<span class="-2694307185983387776" onmouseenter="enter('-2694307185983387776');" onmouseout="out('-2694307185983387776');" style="">  90              Integer defaultOperationTimeoutMs = kuduSideTableInfo.getDefaultOperationTimeoutMs();                 </span>
<span  style="">  91                                                                                                                    </span>
<span class="-6052455991030570635" onmouseenter="enter('-6052455991030570635');" onmouseout="out('-6052455991030570635');" style="">  92              Preconditions.checkNotNull(kuduMasters, &quot;kuduMasters could not be null&quot;);                             </span>
<span  style="">  93                                                                                                                    </span>
<span class="-6520194397411128459" onmouseenter="enter('-6520194397411128459');" onmouseout="out('-6520194397411128459');" style=""><abbr title="  94              AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBuilder(kuduMasters);">  94              AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBui🔵</abbr></span>
<span class="-8227759523178082238" onmouseenter="enter('-8227759523178082238');" onmouseout="out('-8227759523178082238');" style="">  95              if (null != workerCount) {                                                                            </span>
<span class="-5467062577113570128" onmouseenter="enter('-5467062577113570128');" onmouseout="out('-5467062577113570128');" style="">  96                  asyncKuduClientBuilder.workerCount(workerCount);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97              }                                                                                                     </span>
<span  style="">  98                                                                                                                    </span>
<span class="-2397215110746175709" onmouseenter="enter('-2397215110746175709');" onmouseout="out('-2397215110746175709');" style="">  99              if (null != defaultOperationTimeoutMs) {                                                              </span>
<span class="7366215511831154275" onmouseenter="enter('7366215511831154275');" onmouseout="out('7366215511831154275');" style=""> 100                  asyncKuduClientBuilder.defaultOperationTimeoutMs(defaultOperationTimeoutMs);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101              }                                                                                                     </span>
<span class="2560969904046492964" onmouseenter="enter('2560969904046492964');" onmouseout="out('2560969904046492964');" style=""> 102              asyncClient = asyncKuduClientBuilder.build();                                                         </span>
<span class="441886789095796306" onmouseenter="enter('441886789095796306');" onmouseout="out('441886789095796306');" style=""> 103              if (!asyncClient.syncClient().tableExists(tableName)) {                                               </span>
<span class="4123299035781055923" onmouseenter="enter('4123299035781055923');" onmouseout="out('4123299035781055923');" style=""> 104                  throw new IllegalArgumentException(&quot;Table Open Failed , please check table exists&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105              }                                                                                                     </span>
<span class="4092827604202793861" onmouseenter="enter('4092827604202793861');" onmouseout="out('4092827604202793861');" style=""> 106              table = asyncClient.syncClient().openTable(tableName);                                                </span>
<span class="4177758485368982030" onmouseenter="enter('4177758485368982030');" onmouseout="out('4177758485368982030');" style=""> 107              LOG.info(&quot;connect kudu is successed!&quot;);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108          }                                                                                                         </span>
<span class="2924668647776163983" onmouseenter="enter('2924668647776163983');" onmouseout="out('2924668647776163983');" style=""> 109          scannerBuilder = asyncClient.newScannerBuilder(table);                                                    </span>
<span class="-4404448253596110496" onmouseenter="enter('-4404448253596110496');" onmouseout="out('-4404448253596110496');" style=""> 110          Integer batchSizeBytes = kuduSideTableInfo.getBatchSizeBytes();                                           </span>
<span class="-7735055932391271380" onmouseenter="enter('-7735055932391271380');" onmouseout="out('-7735055932391271380');" style=""> 111          Long limitNum = kuduSideTableInfo.getLimitNum();                                                          </span>
<span class="1611473127340759637" onmouseenter="enter('1611473127340759637');" onmouseout="out('1611473127340759637');" style=""> 112          Boolean isFaultTolerant = kuduSideTableInfo.getFaultTolerant();                                           </span>
<span class="-8526639943056837274" onmouseenter="enter('-8526639943056837274');" onmouseout="out('-8526639943056837274');" style=""> 113          //查询需要的字段                                                                                                 </span>
<span class="2090107689800818740" onmouseenter="enter('2090107689800818740');" onmouseout="out('2090107689800818740');" style=""> 114          String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;);                         </span>
<span  style=""> 115                                                                                                                    </span>
<span class="-8080913465496496419" onmouseenter="enter('-8080913465496496419');" onmouseout="out('-8080913465496496419');" style=""> 116          if (null == limitNum || limitNum &lt;= 0) {                                                                  </span>
<span class="7767157001459171317" onmouseenter="enter('7767157001459171317');" onmouseout="out('7767157001459171317');" style=""> 117              scannerBuilder.limit(FETCH_SIZE);                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 118          } else {                                                                                                  </span>
<span class="6087958399625777057" onmouseenter="enter('6087958399625777057');" onmouseout="out('6087958399625777057');" style=""> 119              scannerBuilder.limit(limitNum);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span class="-5740110908714073879" onmouseenter="enter('-5740110908714073879');" onmouseout="out('-5740110908714073879');" style=""> 121          if (null != batchSizeBytes) {                                                                             </span>
<span class="-3929060200025616829" onmouseenter="enter('-3929060200025616829');" onmouseout="out('-3929060200025616829');" style=""> 122              scannerBuilder.batchSizeBytes(batchSizeBytes);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span class="-8680730272034558637" onmouseenter="enter('-8680730272034558637');" onmouseout="out('-8680730272034558637');" style=""> 124          if (null != isFaultTolerant) {                                                                            </span>
<span class="-5364988782144201666" onmouseenter="enter('-5364988782144201666');" onmouseout="out('-5364988782144201666');" style=""> 125              scannerBuilder.setFaultTolerant(isFaultTolerant);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126          }                                                                                                         </span>
<span  style=""> 127                                                                                                                    </span>
<span class="6330664272177173056" onmouseenter="enter('6330664272177173056');" onmouseout="out('6330664272177173056');" style=""> 128          List&lt;String&gt; projectColumns = Arrays.asList(sideFieldNames);                                              </span>
<span class="2684072470806705647" onmouseenter="enter('2684072470806705647');" onmouseout="out('2684072470806705647');" style=""> 129          scannerBuilder.setProjectedColumnNames(projectColumns);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130      }                                                                                                             </span>
<span  style=""> 131                                                                                                                    </span>
<span  style=""> 132                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 133      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>


<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        CRow inputCopy = new CRow(input.row(), input.change());                                                   </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 136 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 136 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exce🔵</abbr></span>
<span class="-9200276852123234128" onmouseenter="enter('-9200276852123234128');" onmouseout="out('-9200276852123234128');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +        Tuple2&lt;Boolean, Row&gt; inputCopy = Tuple2.of(input.f0, input.f1);                                           </span>
<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style=""> 138          //scannerBuilder 设置为null重新加载过滤条件                                                                          </span>


<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style=""> 139          scannerBuilder = null;                                                                                    </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style=""> 140          connKuDu();                                                                                               </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style=""> 141          JsonArray inputParams = new JsonArray();                                                                  </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style=""> 142          Schema schema = table.getSchema();                                                                        </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style=""> 143          //  @wenbaoup fix bug                                                                                     </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 144          for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="520421449260192980" onmouseenter="enter('520421449260192980');" onmouseout="out('520421449260192980');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -            Object equalObj = inputCopy.row().getField(sideInfo.getEqualValIndex().get(i));                       </span>
<span class="6195831313044354975" onmouseenter="enter('6195831313044354975');" onmouseout="out('6195831313044354975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +            Object equalObj = inputCopy.f1.getField(sideInfo.getEqualValIndex().get(i));                          </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style=""> 147              if (equalObj == null) {                                                                               </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 148                  dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 149                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150              }                                                                                                     </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style=""> 151              //增加过滤条件                                                                                              </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style=""><abbr title=" 152              scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 152              scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldLi🔵</abbr></span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style=""> 153              inputParams.add(equalObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154          }                                                                                                         </span>



<span  style=""> 155                                                                                                                    </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style=""> 156          //  填充谓词信息                                                                                                </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style=""> 157          List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();                   </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style=""> 158          if (predicateInfoes.size() &gt; 0) {                                                                         </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style=""> 159              predicateInfoes.stream().map(info -&gt; {                                                                </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style=""> 160                  KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                          </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style=""> 161                  if (null != kuduPredicate) {                                                                      </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style=""> 162                      scannerBuilder.addPredicate(kuduPredicate);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                  }                                                                                                 </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style=""> 164                  return info;                                                                                      </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style=""> 165              }).count();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166          }                                                                                                         </span>
<span  style=""> 167                                                                                                                    </span>
<span  style=""> 168                                                                                                                    </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 169          String key = buildCacheKey(inputParams);                                                                  </span>
<span  style=""> 170                                                                                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 171          if (openCache()) {                                                                                        </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style=""> 172              //判断数据是否已经加载到缓存中                                                                                      </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style=""> 173              CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 174              if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 175                  if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 176                      dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 177                      return;                                                                                       </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style=""> 178                  } else if (ECacheContentType.SingleLine == val.getType()) {                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 179                      try {                                                                                         </span>
<span class="6604686668491627706" onmouseenter="enter('6604686668491627706');" onmouseout="out('6604686668491627706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                        Row row = fillData(inputCopy.row(), val);                                                 </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                        resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));          </span>
<span class="7656694764601850900" onmouseenter="enter('7656694764601850900');" onmouseout="out('7656694764601850900');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +                        Row row = fillData(inputCopy.f1, val);                                                    </span>
<span class="2870017647032456198" onmouseenter="enter('2870017647032456198');" onmouseout="out('2870017647032456198');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +                        resultFuture.complete(Collections.singleton(Tuple2.of(inputCopy.f0,row)));                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 184                      } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style=""> 185                          dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186                      }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 187                  } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 188                      try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +                        List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                 </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style=""> 191                          for (Object jsonArray : (List) val.getContent()) {                                        </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                            Row row = fillData(inputCopy.row(), jsonArray);                                       </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                            rowList.add(new CRow(row, inputCopy.change()));                                       </span>
<span class="6489207833882754223" onmouseenter="enter('6489207833882754223');" onmouseout="out('6489207833882754223');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +                            Row row = fillData(inputCopy.f1, jsonArray);                                          </span>
<span class="-9103127993782963860" onmouseenter="enter('-9103127993782963860');" onmouseout="out('-9103127993782963860');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +                            rowList.add(Tuple2.of(inputCopy.f0, row));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196                          }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 197                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 198                      } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style=""> 199                          dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 201                  } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 202                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 202                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 204                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206          }                                                                                                         </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style=""> 207          List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                            </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style=""> 208          AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                               </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +        List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                                 </span>
<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style=""> 211          Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                           </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style=""> 212          //从之前的同步修改为调用异步的Callback                                                                                  </span>
<span class="-8947877439631582721" onmouseenter="enter('-8947877439631582721');" onmouseout="out('-8947877439631582721');" style=""><abbr title=" 213          data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, key));"> 213          data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFutur🔵</abbr></span>












<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span  style=""> 216                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 217      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 218      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="7096347511226230072" onmouseenter="enter('7096347511226230072');" onmouseout="out('7096347511226230072');" style=""> 219          Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) sideInput;                                          </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 220          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 221          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 222              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 223 -            boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 223 -            boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -                                                                                                                  </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 225 -            //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 225 -            //Type information for indicating event or processing time. However, it behaves like a regular SQL tim🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -            if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -                obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -            }                                                                                                     </span>
<span class="-7569211455899402285" onmouseenter="enter('-7569211455899402285');" onmouseout="out('-7569211455899402285');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +            obj = convertTimeIndictorTypeInfo(entry.getValue(), obj);                                             </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 230              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231          }                                                                                                         </span>
<span  style=""> 232                                                                                                                    </span>
<span class="-4063777341066712786" onmouseenter="enter('-4063777341066712786');" onmouseout="out('-4063777341066712786');" style=""> 233          for (Map.Entry&lt;Integer, String&gt; entry : sideInfo.getSideFieldNameIndex().entrySet()) {                    </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 234              if (cacheInfo == null) {                                                                              </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 235                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 236              } else {                                                                                              </span>
<span class="-6152510067760557074" onmouseenter="enter('-6152510067760557074');" onmouseout="out('-6152510067760557074');" style=""> 237                  row.setField(entry.getKey(), cacheInfo.get(entry.getValue()));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239          }                                                                                                         </span>
<span  style=""> 240                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 241          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242      }                                                                                                             </span>
<span  style=""> 243                                                                                                                    </span>
<span class="-3405798300685646496" onmouseenter="enter('-3405798300685646496');" onmouseout="out('-3405798300685646496');" style=""> 244      public String buildCacheKey(JsonArray jsonArray) {                                                            </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 245          StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="5542959958101405176" onmouseenter="enter('5542959958101405176');" onmouseout="out('5542959958101405176');" style=""> 246          for (Object ele : jsonArray.getList()) {                                                                  </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 247              sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 248                      .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249          }                                                                                                         </span>
<span  style=""> 250                                                                                                                    </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 251          return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252      }                                                                                                             </span>
<span  style=""> 253                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 254      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 255      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 256          super.close();                                                                                            </span>
<span class="-466861721853404898" onmouseenter="enter('-466861721853404898');" onmouseout="out('-466861721853404898');" style=""> 257          if (null != asyncClient) {                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 258              try {                                                                                                 </span>
<span class="-2833913701521345427" onmouseenter="enter('-2833913701521345427');" onmouseout="out('-2833913701521345427');" style=""> 259                  asyncClient.close();                                                                              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 260              } catch (Exception e) {                                                                               </span>
<span class="7169708839653618971" onmouseenter="enter('7169708839653618971');" onmouseout="out('7169708839653618971');" style=""> 261                  LOG.error(&quot;Error while closing client.&quot;, e);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264      }                                                                                                             </span>
<span  style=""> 265                                                                                                                    </span>
<span class="3638800353225348075" onmouseenter="enter('3638800353225348075');" onmouseout="out('3638800353225348075');" style=""> 266      class GetListRowCB implements Callback&lt;Deferred&lt;List&lt;Row&gt;&gt;, RowResultIterator&gt; {                              </span>
<span class="2001251848416688346" onmouseenter="enter('2001251848416688346');" onmouseout="out('2001251848416688346');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -        private CRow input;                                                                                       </span>
<span class="4696852104916231563" onmouseenter="enter('4696852104916231563');" onmouseout="out('4696852104916231563');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 268 +        private Tuple2&lt;Boolean,Row&gt; input;                                                                        </span>
<span class="-3461178940071231317" onmouseenter="enter('-3461178940071231317');" onmouseout="out('-3461178940071231317');" style=""> 269          private List&lt;Map&lt;String, Object&gt;&gt; cacheContent;                                                           </span>
<span class="-5357459632477081071" onmouseenter="enter('-5357459632477081071');" onmouseout="out('-5357459632477081071');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -        private List&lt;CRow&gt; rowList;                                                                               </span>
<span class="1247274010491913930" onmouseenter="enter('1247274010491913930');" onmouseout="out('1247274010491913930');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 271 +        private List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList;                                                                </span>
<span class="5723031173307092846" onmouseenter="enter('5723031173307092846');" onmouseout="out('5723031173307092846');" style=""> 272          private AsyncKuduScanner asyncKuduScanner;                                                                </span>
<span class="5555801037685047910" onmouseenter="enter('5555801037685047910');" onmouseout="out('5555801037685047910');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -        private ResultFuture&lt;CRow&gt; resultFuture;                                                                  </span>
<span class="1809246968026899685" onmouseenter="enter('1809246968026899685');" onmouseout="out('1809246968026899685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 274 +        private ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture;                                                   </span>
<span class="-1449703644783381384" onmouseenter="enter('-1449703644783381384');" onmouseout="out('-1449703644783381384');" style=""> 275          private String key;                                                                                       </span>
<span  style=""> 276                                                                                                                    </span>
<span  style=""> 277                                                                                                                    </span>
<span class="1613753735602313740" onmouseenter="enter('1613753735602313740');" onmouseout="out('1613753735602313740');" style=""> 278          public GetListRowCB() {                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279          }                                                                                                         </span>
<span  style=""> 280                                                                                                                    </span>
<span class="-1210642425124689079" onmouseenter="enter('-1210642425124689079');" onmouseout="out('-1210642425124689079');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 281 -        GetListRowCB(CRow input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;CRow&gt; rowList, AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;CRow&gt; resultFuture, String key) {"> 281 -        GetListRowCB(CRow input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;CRow&gt; rowList, AsyncKuduScanner asyn🔵</abbr></span>
<span class="7340517348292441638" onmouseenter="enter('7340517348292441638');" onmouseout="out('7340517348292441638');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 282 +        GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList,"> 282 +        GetListRowCB(Tuple2&lt;Boolean,Row&gt; input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; 🔵</abbr></span>
<span class="-8589978589073406776" onmouseenter="enter('-8589978589073406776');" onmouseout="out('-8589978589073406776');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 283 +                     AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, String key) {"> 283 +                     AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, String key🔵</abbr></span>
<span class="8214429602983504200" onmouseenter="enter('8214429602983504200');" onmouseout="out('8214429602983504200');" style=""> 284              this.input = input;                                                                                   </span>
<span class="-7432664925500830597" onmouseenter="enter('-7432664925500830597');" onmouseout="out('-7432664925500830597');" style=""> 285              this.cacheContent = cacheContent;                                                                     </span>
<span class="5762471889889938429" onmouseenter="enter('5762471889889938429');" onmouseout="out('5762471889889938429');" style=""> 286              this.rowList = rowList;                                                                               </span>
<span class="4954020228022176436" onmouseenter="enter('4954020228022176436');" onmouseout="out('4954020228022176436');" style=""> 287              this.asyncKuduScanner = asyncKuduScanner;                                                             </span>
<span class="592225705701792215" onmouseenter="enter('592225705701792215');" onmouseout="out('592225705701792215');" style=""> 288              this.resultFuture = resultFuture;                                                                     </span>
<span class="5062295098979135982" onmouseenter="enter('5062295098979135982');" onmouseout="out('5062295098979135982');" style=""> 289              this.key = key;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290          }                                                                                                         </span>
<span  style=""> 291                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 292          @Override                                                                                                 </span>
<span class="8767874272678853351" onmouseenter="enter('8767874272678853351');" onmouseout="out('8767874272678853351');" style=""> 293          public Deferred&lt;List&lt;Row&gt;&gt; call(RowResultIterator results) throws Exception {                             </span>
<span class="-8941030450012249491" onmouseenter="enter('-8941030450012249491');" onmouseout="out('-8941030450012249491');" style=""> 294              for (RowResult result : results) {                                                                    </span>
<span class="-7707387193564908050" onmouseenter="enter('-7707387193564908050');" onmouseout="out('-7707387193564908050');" style=""> 295                  Map&lt;String, Object&gt; oneRow = Maps.newHashMap();                                                   </span>
<span class="4786776012437782338" onmouseenter="enter('4786776012437782338');" onmouseout="out('4786776012437782338');" style=""> 296                  for (String sideFieldName1 : StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;)) {            </span>
<span class="5422300911827801712" onmouseenter="enter('5422300911827801712');" onmouseout="out('5422300911827801712');" style=""> 297                      String sideFieldName = sideFieldName1.trim();                                                 </span>
<span class="-7396994512053753949" onmouseenter="enter('-7396994512053753949');" onmouseout="out('-7396994512053753949');" style=""> 298                      ColumnSchema columnSchema = table.getSchema().getColumn(sideFieldName);                       </span>
<span class="-1551001954350423389" onmouseenter="enter('-1551001954350423389');" onmouseout="out('-1551001954350423389');" style=""> 299                      if (null != columnSchema) {                                                                   </span>
<span class="-9080618923968214410" onmouseenter="enter('-9080618923968214410');" onmouseout="out('-9080618923968214410');" style=""> 300                          KuduUtil.setMapValue(columnSchema.getType(), oneRow, sideFieldName, result);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                  }                                                                                                 </span>
<span class="-209789566031535321" onmouseenter="enter('-209789566031535321');" onmouseout="out('-209789566031535321');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -                Row row = fillData(input.row(), oneRow);                                                          </span>
<span class="5830289147325916559" onmouseenter="enter('5830289147325916559');" onmouseout="out('5830289147325916559');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +                Row row = fillData(input.f1, oneRow);                                                             </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 305                  if (openCache()) {                                                                                </span>
<span class="1888587301705190474" onmouseenter="enter('1888587301705190474');" onmouseout="out('1888587301705190474');" style=""> 306                      cacheContent.add(oneRow);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307                  }                                                                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                rowList.add(new CRow(row, input.change()));                                                       </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +                rowList.add(Tuple2.of(input.f0, row));                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310              }                                                                                                     </span>
<span class="-5880917173204222408" onmouseenter="enter('-5880917173204222408');" onmouseout="out('-5880917173204222408');" style=""> 311              if (asyncKuduScanner.hasMoreRows()) {                                                                 </span>
<span class="411290205859931493" onmouseenter="enter('411290205859931493');" onmouseout="out('411290205859931493');" style=""> 312                  return asyncKuduScanner.nextRows().addCallbackDeferring(this);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313              }                                                                                                     </span>
<span  style=""> 314                                                                                                                    </span>
<span class="-5182000486454444757" onmouseenter="enter('-5182000486454444757');" onmouseout="out('-5182000486454444757');" style=""> 315              if (rowList.size() &gt; 0) {                                                                             </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 316                  if (openCache()) {                                                                                </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 317                      putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318                  }                                                                                                 </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 319                  resultFuture.complete(rowList);                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 320              } else {                                                                                              </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 321                  dealMissKey(input, resultFuture);                                                                 </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 322                  if (openCache()) {                                                                                </span>
<span class="-7075096462798044408" onmouseenter="enter('-7075096462798044408');" onmouseout="out('-7075096462798044408');" style=""> 323                      //放置在putCache的Miss中 一段时间内同一个key都会直接返回                                                         </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 324                      putCache(key, CacheMissVal.getMissKeyObj());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326              }                                                                                                     </span>
<span  style=""> 327                                                                                                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 328              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330      }                                                                                                             </span>
<span  style=""> 331                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="-8840953368027741170" onmouseenter="enter('-8840953368027741170');" onmouseout="out('-8840953368027741170');" style="">   1  package com.dtstack.flink.sql.side.kudu;                                                                          </span>
<span  style="">   2                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">   3  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">   4  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">   5  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">   6  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">   7  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">   8  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">   9  import com.dtstack.flink.sql.side.PredicateInfo;                                                                  </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  10  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5710642889135375263" onmouseenter="enter('5710642889135375263');" onmouseout="out('5710642889135375263');" style="">  11  import com.dtstack.flink.sql.side.kudu.table.KuduSideTableInfo;                                                   </span>
<span class="1164335795537447661" onmouseenter="enter('1164335795537447661');" onmouseout="out('1164335795537447661');" style="">  12  import com.dtstack.flink.sql.side.kudu.utils.KuduUtil;                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  13  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  14  import com.google.common.collect.Maps;                                                                            </span>
<span class="-5750625329012831967" onmouseenter="enter('-5750625329012831967');" onmouseout="out('-5750625329012831967');" style="">  15  import com.stumbleupon.async.Callback;                                                                            </span>
<span class="-5487067255628915347" onmouseenter="enter('-5487067255628915347');" onmouseout="out('-5487067255628915347');" style="">  16  import com.stumbleupon.async.Deferred;                                                                            </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  17  import io.vertx.core.json.JsonArray;                                                                              </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  18  import org.apache.commons.lang3.StringUtils;                                                                      </span>

<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  19  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  20  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  21  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  22  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  23  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  24  import org.apache.flink.types.Row;                                                                                </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  25  import org.apache.flink.util.Preconditions;                                                                       </span>
<span class="1631232015531818624" onmouseenter="enter('1631232015531818624');" onmouseout="out('1631232015531818624');" style="">  26  import org.apache.kudu.ColumnSchema;                                                                              </span>
<span class="-1755042893780385624" onmouseenter="enter('-1755042893780385624');" onmouseout="out('-1755042893780385624');" style="">  27  import org.apache.kudu.Schema;                                                                                    </span>
<span class="7204708202450962745" onmouseenter="enter('7204708202450962745');" onmouseout="out('7204708202450962745');" style="">  28  import org.apache.kudu.client.AsyncKuduClient;                                                                    </span>
<span class="3400841229030892477" onmouseenter="enter('3400841229030892477');" onmouseout="out('3400841229030892477');" style="">  29  import org.apache.kudu.client.AsyncKuduScanner;                                                                   </span>
<span class="1860194643195428903" onmouseenter="enter('1860194643195428903');" onmouseout="out('1860194643195428903');" style="">  30  import org.apache.kudu.client.KuduException;                                                                      </span>
<span class="128288131530978478" onmouseenter="enter('128288131530978478');" onmouseout="out('128288131530978478');" style="">  31  import org.apache.kudu.client.KuduPredicate;                                                                      </span>
<span class="-342692776902705676" onmouseenter="enter('-342692776902705676');" onmouseout="out('-342692776902705676');" style="">  32  import org.apache.kudu.client.KuduTable;                                                                          </span>
<span class="-6157621177665621032" onmouseenter="enter('-6157621177665621032');" onmouseout="out('-6157621177665621032');" style="">  33  import org.apache.kudu.client.RowResult;                                                                          </span>
<span class="-1845673204769190809" onmouseenter="enter('-1845673204769190809');" onmouseout="out('-1845673204769190809');" style="">  34  import org.apache.kudu.client.RowResultIterator;                                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  35  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  36  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  37                                                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  38  import java.sql.Timestamp;                                                                                        </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  39  import java.util.Arrays;                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  40  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  41  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  42  import java.util.Map;                                                                                             </span>
<span  style="">  43                                                                                                                    </span>
<span class="3638139650453766874" onmouseenter="enter('3638139650453766874');" onmouseout="out('3638139650453766874');" style="">  44  public class KuduAsyncReqRow extends BaseAsyncReqRow {                                                            </span>
<span  style="">  45                                                                                                                    </span>
<span class="-2074213480282018260" onmouseenter="enter('-2074213480282018260');" onmouseout="out('-2074213480282018260');" style="">  46      private static final Logger LOG = LoggerFactory.getLogger(KuduAsyncReqRow.class);                             </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  47      /**                                                                                                           </span>
<span class="-8285284077529796986" onmouseenter="enter('-8285284077529796986');" onmouseout="out('-8285284077529796986');" style="">  48       * 获取连接的尝试次数                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  49       */                                                                                                           </span>
<span class="-1089202172816726338" onmouseenter="enter('-1089202172816726338');" onmouseout="out('-1089202172816726338');" style="">  50      private static final int CONN_RETRY_NUM = 3;                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  51      /**                                                                                                           </span>
<span class="4062789252244833512" onmouseenter="enter('4062789252244833512');" onmouseout="out('4062789252244833512');" style="">  52       * 缓存条数                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53       */                                                                                                           </span>
<span class="1004470848600586149" onmouseenter="enter('1004470848600586149');" onmouseout="out('1004470848600586149');" style="">  54      private static final Long FETCH_SIZE = 1000L;                                                                 </span>
<span  style="">  55                                                                                                                    </span>
<span class="5253634271646137455" onmouseenter="enter('5253634271646137455');" onmouseout="out('5253634271646137455');" style="">  56      private static final long serialVersionUID = 5028583854989267753L;                                            </span>
<span  style="">  57                                                                                                                    </span>
<span  style="">  58                                                                                                                    </span>
<span class="6513367378672126597" onmouseenter="enter('6513367378672126597');" onmouseout="out('6513367378672126597');" style="">  59      private AsyncKuduClient asyncClient;                                                                          </span>
<span  style="">  60                                                                                                                    </span>
<span class="1317689277640300307" onmouseenter="enter('1317689277640300307');" onmouseout="out('1317689277640300307');" style="">  61      private KuduTable table;                                                                                      </span>
<span  style="">  62                                                                                                                    </span>
<span class="4635177141603060317" onmouseenter="enter('4635177141603060317');" onmouseout="out('4635177141603060317');" style="">  63      private KuduSideTableInfo kuduSideTableInfo;                                                                  </span>
<span  style="">  64                                                                                                                    </span>
<span class="4170992710598328570" onmouseenter="enter('4170992710598328570');" onmouseout="out('4170992710598328570');" style="">  65      private AsyncKuduScanner.AsyncKuduScannerBuilder scannerBuilder;                                              </span>
<span  style="">  66                                                                                                                    </span>
<span class="-5994744104468733303" onmouseenter="enter('-5994744104468733303');" onmouseout="out('-5994744104468733303');" style=""><abbr title="  67      public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  67      public KuduAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractS🔵</abbr></span>
<span class="6563035163892178349" onmouseenter="enter('6563035163892178349');" onmouseout="out('6563035163892178349');" style="">  68          super(new KuduAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69      }                                                                                                             </span>
<span  style="">  70                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  71      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  72      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  73          super.open(parameters);                                                                                   </span>
<span class="-7685679746867905609" onmouseenter="enter('-7685679746867905609');" onmouseout="out('-7685679746867905609');" style="">  74          kuduSideTableInfo = (KuduSideTableInfo) sideInfo.getSideTableInfo();                                      </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style="">  75          connKuDu();                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  78      /**                                                                                                           </span>
<span class="803083353752398343" onmouseenter="enter('803083353752398343');" onmouseout="out('803083353752398343');" style="">  79       * 连接kudu中的表                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  80       *                                                                                                            </span>
<span class="-5432256053392020081" onmouseenter="enter('-5432256053392020081');" onmouseout="out('-5432256053392020081');" style="">  81       * @throws KuduException                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  82       */                                                                                                           </span>
<span class="-5290115760614089350" onmouseenter="enter('-5290115760614089350');" onmouseout="out('-5290115760614089350');" style="">  83      private void connKuDu() throws KuduException {                                                                </span>
<span class="-56179035184578959" onmouseenter="enter('-56179035184578959');" onmouseout="out('-56179035184578959');" style="">  84          if (null == table) {                                                                                      </span>
<span class="4308396336047168888" onmouseenter="enter('4308396336047168888');" onmouseout="out('4308396336047168888');" style="">  85              String kuduMasters = kuduSideTableInfo.getKuduMasters();                                              </span>
<span class="-4444229447990232757" onmouseenter="enter('-4444229447990232757');" onmouseout="out('-4444229447990232757');" style="">  86              String tableName = kuduSideTableInfo.getTableName();                                                  </span>
<span class="4427587995392923155" onmouseenter="enter('4427587995392923155');" onmouseout="out('4427587995392923155');" style="">  87              Integer workerCount = kuduSideTableInfo.getWorkerCount();                                             </span>
<span class="-5299851536099138671" onmouseenter="enter('-5299851536099138671');" onmouseout="out('-5299851536099138671');" style="">  88              Integer defaultSocketReadTimeoutMs = kuduSideTableInfo.getDefaultSocketReadTimeoutMs();               </span>
<span class="-2694307185983387776" onmouseenter="enter('-2694307185983387776');" onmouseout="out('-2694307185983387776');" style="">  89              Integer defaultOperationTimeoutMs = kuduSideTableInfo.getDefaultOperationTimeoutMs();                 </span>
<span  style="">  90                                                                                                                    </span>
<span class="-6052455991030570635" onmouseenter="enter('-6052455991030570635');" onmouseout="out('-6052455991030570635');" style="">  91              Preconditions.checkNotNull(kuduMasters, &quot;kuduMasters could not be null&quot;);                             </span>
<span  style="">  92                                                                                                                    </span>
<span class="-6520194397411128459" onmouseenter="enter('-6520194397411128459');" onmouseout="out('-6520194397411128459');" style=""><abbr title="  93              AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBuilder(kuduMasters);">  93              AsyncKuduClient.AsyncKuduClientBuilder asyncKuduClientBuilder = new AsyncKuduClient.AsyncKuduClientBui🔵</abbr></span>
<span class="-8227759523178082238" onmouseenter="enter('-8227759523178082238');" onmouseout="out('-8227759523178082238');" style="">  94              if (null != workerCount) {                                                                            </span>
<span class="-5467062577113570128" onmouseenter="enter('-5467062577113570128');" onmouseout="out('-5467062577113570128');" style="">  95                  asyncKuduClientBuilder.workerCount(workerCount);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96              }                                                                                                     </span>
<span  style="">  97                                                                                                                    </span>
<span class="-2397215110746175709" onmouseenter="enter('-2397215110746175709');" onmouseout="out('-2397215110746175709');" style="">  98              if (null != defaultOperationTimeoutMs) {                                                              </span>
<span class="7366215511831154275" onmouseenter="enter('7366215511831154275');" onmouseout="out('7366215511831154275');" style="">  99                  asyncKuduClientBuilder.defaultOperationTimeoutMs(defaultOperationTimeoutMs);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100              }                                                                                                     </span>
<span class="2560969904046492964" onmouseenter="enter('2560969904046492964');" onmouseout="out('2560969904046492964');" style=""> 101              asyncClient = asyncKuduClientBuilder.build();                                                         </span>
<span class="441886789095796306" onmouseenter="enter('441886789095796306');" onmouseout="out('441886789095796306');" style=""> 102              if (!asyncClient.syncClient().tableExists(tableName)) {                                               </span>
<span class="4123299035781055923" onmouseenter="enter('4123299035781055923');" onmouseout="out('4123299035781055923');" style=""> 103                  throw new IllegalArgumentException(&quot;Table Open Failed , please check table exists&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104              }                                                                                                     </span>
<span class="4092827604202793861" onmouseenter="enter('4092827604202793861');" onmouseout="out('4092827604202793861');" style=""> 105              table = asyncClient.syncClient().openTable(tableName);                                                </span>
<span class="4177758485368982030" onmouseenter="enter('4177758485368982030');" onmouseout="out('4177758485368982030');" style=""> 106              LOG.info(&quot;connect kudu is successed!&quot;);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107          }                                                                                                         </span>
<span class="2924668647776163983" onmouseenter="enter('2924668647776163983');" onmouseout="out('2924668647776163983');" style=""> 108          scannerBuilder = asyncClient.newScannerBuilder(table);                                                    </span>
<span class="-4404448253596110496" onmouseenter="enter('-4404448253596110496');" onmouseout="out('-4404448253596110496');" style=""> 109          Integer batchSizeBytes = kuduSideTableInfo.getBatchSizeBytes();                                           </span>
<span class="-7735055932391271380" onmouseenter="enter('-7735055932391271380');" onmouseout="out('-7735055932391271380');" style=""> 110          Long limitNum = kuduSideTableInfo.getLimitNum();                                                          </span>
<span class="1611473127340759637" onmouseenter="enter('1611473127340759637');" onmouseout="out('1611473127340759637');" style=""> 111          Boolean isFaultTolerant = kuduSideTableInfo.getFaultTolerant();                                           </span>
<span class="-8526639943056837274" onmouseenter="enter('-8526639943056837274');" onmouseout="out('-8526639943056837274');" style=""> 112          //查询需要的字段                                                                                                 </span>
<span class="2090107689800818740" onmouseenter="enter('2090107689800818740');" onmouseout="out('2090107689800818740');" style=""> 113          String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;);                         </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-8080913465496496419" onmouseenter="enter('-8080913465496496419');" onmouseout="out('-8080913465496496419');" style=""> 115          if (null == limitNum || limitNum &lt;= 0) {                                                                  </span>
<span class="7767157001459171317" onmouseenter="enter('7767157001459171317');" onmouseout="out('7767157001459171317');" style=""> 116              scannerBuilder.limit(FETCH_SIZE);                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 117          } else {                                                                                                  </span>
<span class="6087958399625777057" onmouseenter="enter('6087958399625777057');" onmouseout="out('6087958399625777057');" style=""> 118              scannerBuilder.limit(limitNum);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119          }                                                                                                         </span>
<span class="-5740110908714073879" onmouseenter="enter('-5740110908714073879');" onmouseout="out('-5740110908714073879');" style=""> 120          if (null != batchSizeBytes) {                                                                             </span>
<span class="-3929060200025616829" onmouseenter="enter('-3929060200025616829');" onmouseout="out('-3929060200025616829');" style=""> 121              scannerBuilder.batchSizeBytes(batchSizeBytes);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122          }                                                                                                         </span>
<span class="-8680730272034558637" onmouseenter="enter('-8680730272034558637');" onmouseout="out('-8680730272034558637');" style=""> 123          if (null != isFaultTolerant) {                                                                            </span>
<span class="-5364988782144201666" onmouseenter="enter('-5364988782144201666');" onmouseout="out('-5364988782144201666');" style=""> 124              scannerBuilder.setFaultTolerant(isFaultTolerant);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125          }                                                                                                         </span>
<span  style=""> 126                                                                                                                    </span>
<span class="6330664272177173056" onmouseenter="enter('6330664272177173056');" onmouseout="out('6330664272177173056');" style=""> 127          List&lt;String&gt; projectColumns = Arrays.asList(sideFieldNames);                                              </span>
<span class="2684072470806705647" onmouseenter="enter('2684072470806705647');" onmouseout="out('2684072470806705647');" style=""> 128          scannerBuilder.setProjectedColumnNames(projectColumns);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -    @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +    @Override                                                                                                     </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 135 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 135 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) th🔵</abbr></span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style=""> 136          CRow inputCopy = new CRow(input.row(), input.change());                                                   </span>


<span class="-628786131648949035" onmouseenter="enter('-628786131648949035');" onmouseout="out('-628786131648949035');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -        //scannerBuilder 设置为null重新加载过滤条件                                                                          </span>
<span class="5065834272723126023" onmouseenter="enter('5065834272723126023');" onmouseout="out('5065834272723126023');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +        //scannerBuilder 设置为null重新加载过滤条件,然后connkudu重新赋值                                                           </span>
<span class="2495891823177141345" onmouseenter="enter('2495891823177141345');" onmouseout="out('2495891823177141345');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +        //todo:代码需要优化                                                                                             </span>
<span class="3515238287407101771" onmouseenter="enter('3515238287407101771');" onmouseout="out('3515238287407101771');" style=""> 140          scannerBuilder = null;                                                                                    </span>
<span class="-4562633082775627441" onmouseenter="enter('-4562633082775627441');" onmouseout="out('-4562633082775627441');" style=""> 141          connKuDu();                                                                                               </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        JsonArray inputParams = new JsonArray();                                                                  </span>
<span class="6789989036272871448" onmouseenter="enter('6789989036272871448');" onmouseout="out('6789989036272871448');" style=""> 143          Schema schema = table.getSchema();                                                                        </span>
<span class="-6874703698410301106" onmouseenter="enter('-6874703698410301106');" onmouseout="out('-6874703698410301106');" style=""> 144          //  @wenbaoup fix bug                                                                                     </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="520421449260192980" onmouseenter="enter('520421449260192980');" onmouseout="out('520421449260192980');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -            Object equalObj = inputCopy.row().getField(sideInfo.getEqualValIndex().get(i));                       </span>

<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -            if (equalObj == null) {                                                                               </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -            }                                                                                                     </span>
<span class="4110012413316229747" onmouseenter="enter('4110012413316229747');" onmouseout="out('4110012413316229747');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -            //增加过滤条件                                                                                              </span>
<span class="-5891309738839423702" onmouseenter="enter('-5891309738839423702');" onmouseout="out('-5891309738839423702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 152 -            scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldList().get(i)), Collections.singletonList(equalObj)));"> 152 -            scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(sideInfo.getEqualFieldLi🔵</abbr></span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -            inputParams.add(equalObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -        }                                                                                                         </span>
<span class="-2762964740504478972" onmouseenter="enter('-2762964740504478972');" onmouseout="out('-2762964740504478972');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        inputParams.entrySet().forEach(e -&gt;{                                                                      </span>
<span class="-44569786791220301" onmouseenter="enter('-44569786791220301');" onmouseout="out('-44569786791220301');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 156 +            scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Collections.singletonList(e.getValue())));"> 156 +            scannerBuilder.addPredicate(KuduPredicate.newInListPredicate(schema.getColumn(e.getKey()), Collections🔵</abbr></span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +        });                                                                                                       </span>
<span  style=""> 158                                                                                                                    </span>
<span class="-5863912479223093982" onmouseenter="enter('-5863912479223093982');" onmouseout="out('-5863912479223093982');" style=""> 159          //  填充谓词信息                                                                                                </span>
<span class="-8839623202504591157" onmouseenter="enter('-8839623202504591157');" onmouseout="out('-8839623202504591157');" style=""> 160          List&lt;PredicateInfo&gt; predicateInfoes = sideInfo.getSideTableInfo().getPredicateInfoes();                   </span>
<span class="1131384255148676390" onmouseenter="enter('1131384255148676390');" onmouseout="out('1131384255148676390');" style=""> 161          if (predicateInfoes.size() &gt; 0) {                                                                         </span>
<span class="7087000648291367893" onmouseenter="enter('7087000648291367893');" onmouseout="out('7087000648291367893');" style=""> 162              predicateInfoes.stream().map(info -&gt; {                                                                </span>
<span class="-3754680470381432050" onmouseenter="enter('-3754680470381432050');" onmouseout="out('-3754680470381432050');" style=""> 163                  KuduPredicate kuduPredicate = KuduUtil.buildKuduPredicate(schema, info);                          </span>
<span class="8493928812165156395" onmouseenter="enter('8493928812165156395');" onmouseout="out('8493928812165156395');" style=""> 164                  if (null != kuduPredicate) {                                                                      </span>
<span class="-8515842596395934222" onmouseenter="enter('-8515842596395934222');" onmouseout="out('-8515842596395934222');" style=""> 165                      scannerBuilder.addPredicate(kuduPredicate);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                  }                                                                                                 </span>
<span class="-3556780733195614200" onmouseenter="enter('-3556780733195614200');" onmouseout="out('-3556780733195614200');" style=""> 167                  return info;                                                                                      </span>
<span class="3075434854107094892" onmouseenter="enter('3075434854107094892');" onmouseout="out('3075434854107094892');" style=""> 168              }).count();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169          }                                                                                                         </span>
<span  style=""> 170                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -                                                                                                                  </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -        String key = buildCacheKey(inputParams);                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -                                                                                                                  </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -        if (openCache()) {                                                                                        </span>
<span class="-6696585048147397382" onmouseenter="enter('-6696585048147397382');" onmouseout="out('-6696585048147397382');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -            //判断数据是否已经加载到缓存中                                                                                      </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -            CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -            if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -                if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -                    dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                    return;                                                                                       </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                } else if (ECacheContentType.SingleLine == val.getType()) {                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                    try {                                                                                         </span>
<span class="6604686668491627706" onmouseenter="enter('6604686668491627706');" onmouseout="out('6604686668491627706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                        Row row = fillData(inputCopy.row(), val);                                                 </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -                        resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));          </span>


<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                    } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -                        dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -                    }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                    try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>

<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                        for (Object jsonArray : (List) val.getContent()) {                                        </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                            Row row = fillData(inputCopy.row(), jsonArray);                                       </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                            rowList.add(new CRow(row, inputCopy.change()));                                       </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                        }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                        resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -                    } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                        dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -                } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 200 -                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 200 -                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -        }                                                                                                         </span>
<span class="510800137927766729" onmouseenter="enter('510800137927766729');" onmouseout="out('510800137927766729');" style=""> 205          List&lt;Map&lt;String, Object&gt;&gt; cacheContent = Lists.newArrayList();                                            </span>
<span class="-5519708164731405413" onmouseenter="enter('-5519708164731405413');" onmouseout="out('-5519708164731405413');" style=""> 206          AsyncKuduScanner asyncKuduScanner = scannerBuilder.build();                                               </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 207          List&lt;CRow&gt; rowList = Lists.newArrayList();                                                                </span>

<span class="6180779613695836367" onmouseenter="enter('6180779613695836367');" onmouseout="out('6180779613695836367');" style=""> 208          Deferred&lt;RowResultIterator&gt; data = asyncKuduScanner.nextRows();                                           </span>
<span class="-7087386879750881573" onmouseenter="enter('-7087386879750881573');" onmouseout="out('-7087386879750881573');" style=""> 209          //从之前的同步修改为调用异步的Callback                                                                                  </span>
<span class="-8947877439631582721" onmouseenter="enter('-8947877439631582721');" onmouseout="out('-8947877439631582721');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 210 -        data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, key));"> 210 -        data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFutur🔵</abbr></span>
<span class="278649099550089909" onmouseenter="enter('278649099550089909');" onmouseout="out('278649099550089909');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 211 +        data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFuture, buildCacheKey(inputParams)));"> 211 +        data.addCallbackDeferring(new GetListRowCB(inputCopy, cacheContent, rowList, asyncKuduScanner, resultFutur🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +    @Override                                                                                                     </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +    public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                                </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +        for (Object ele : inputParams.values()) {                                                                 </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +            sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +                    .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223      }                                                                                                             </span>
<span  style=""> 224                                                                                                                    </span>
<span  style=""> 225                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 226      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 227      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="7096347511226230072" onmouseenter="enter('7096347511226230072');" onmouseout="out('7096347511226230072');" style=""> 228          Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) sideInput;                                          </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 229          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 230          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 231              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 232              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 232              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span  style=""> 233                                                                                                                    </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 234              //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 234              //Type information for indicating event or processing time. However, it behaves like a regular SQL tim🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 235              if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 236                  obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237              }                                                                                                     </span>

<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 238              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239          }                                                                                                         </span>
<span  style=""> 240                                                                                                                    </span>
<span class="-4063777341066712786" onmouseenter="enter('-4063777341066712786');" onmouseout="out('-4063777341066712786');" style=""> 241          for (Map.Entry&lt;Integer, String&gt; entry : sideInfo.getSideFieldNameIndex().entrySet()) {                    </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 242              if (cacheInfo == null) {                                                                              </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 243                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 244              } else {                                                                                              </span>
<span class="-6152510067760557074" onmouseenter="enter('-6152510067760557074');" onmouseout="out('-6152510067760557074');" style=""> 245                  row.setField(entry.getKey(), cacheInfo.get(entry.getValue()));                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247          }                                                                                                         </span>
<span  style=""> 248                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 249          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                                                                                                                  </span>
<span class="-3405798300685646496" onmouseenter="enter('-3405798300685646496');" onmouseout="out('-3405798300685646496');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -    public String buildCacheKey(JsonArray jsonArray) {                                                            </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="5542959958101405176" onmouseenter="enter('5542959958101405176');" onmouseout="out('5542959958101405176');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -        for (Object ele : jsonArray.getList()) {                                                                  </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -            sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                    .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260      }                                                                                                             </span>
<span  style=""> 261                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 262      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 263      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 264          super.close();                                                                                            </span>
<span class="-466861721853404898" onmouseenter="enter('-466861721853404898');" onmouseout="out('-466861721853404898');" style=""> 265          if (null != asyncClient) {                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 266              try {                                                                                                 </span>
<span class="-2833913701521345427" onmouseenter="enter('-2833913701521345427');" onmouseout="out('-2833913701521345427');" style=""> 267                  asyncClient.close();                                                                              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 268              } catch (Exception e) {                                                                               </span>
<span class="7169708839653618971" onmouseenter="enter('7169708839653618971');" onmouseout="out('7169708839653618971');" style=""> 269                  LOG.error(&quot;Error while closing client.&quot;, e);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span class="3638800353225348075" onmouseenter="enter('3638800353225348075');" onmouseout="out('3638800353225348075');" style=""> 274      class GetListRowCB implements Callback&lt;Deferred&lt;List&lt;Row&gt;&gt;, RowResultIterator&gt; {                              </span>
<span class="2001251848416688346" onmouseenter="enter('2001251848416688346');" onmouseout="out('2001251848416688346');" style=""> 275          private CRow input;                                                                                       </span>

<span class="-3461178940071231317" onmouseenter="enter('-3461178940071231317');" onmouseout="out('-3461178940071231317');" style=""> 276          private List&lt;Map&lt;String, Object&gt;&gt; cacheContent;                                                           </span>
<span class="-5357459632477081071" onmouseenter="enter('-5357459632477081071');" onmouseout="out('-5357459632477081071');" style=""> 277          private List&lt;CRow&gt; rowList;                                                                               </span>

<span class="5723031173307092846" onmouseenter="enter('5723031173307092846');" onmouseout="out('5723031173307092846');" style=""> 278          private AsyncKuduScanner asyncKuduScanner;                                                                </span>
<span class="5555801037685047910" onmouseenter="enter('5555801037685047910');" onmouseout="out('5555801037685047910');" style=""> 279          private ResultFuture&lt;CRow&gt; resultFuture;                                                                  </span>

<span class="-1449703644783381384" onmouseenter="enter('-1449703644783381384');" onmouseout="out('-1449703644783381384');" style=""> 280          private String key;                                                                                       </span>
<span  style=""> 281                                                                                                                    </span>
<span  style=""> 282                                                                                                                    </span>
<span class="1613753735602313740" onmouseenter="enter('1613753735602313740');" onmouseout="out('1613753735602313740');" style=""> 283          public GetListRowCB() {                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284          }                                                                                                         </span>
<span  style=""> 285                                                                                                                    </span>
<span class="-1210642425124689079" onmouseenter="enter('-1210642425124689079');" onmouseout="out('-1210642425124689079');" style=""><abbr title=" 286          GetListRowCB(CRow input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;CRow&gt; rowList, AsyncKuduScanner asyncKuduScanner, ResultFuture&lt;CRow&gt; resultFuture, String key) {"> 286          GetListRowCB(CRow input, List&lt;Map&lt;String, Object&gt;&gt; cacheContent, List&lt;CRow&gt; rowList, AsyncKuduScanner asyn🔵</abbr></span>


<span class="8214429602983504200" onmouseenter="enter('8214429602983504200');" onmouseout="out('8214429602983504200');" style=""> 287              this.input = input;                                                                                   </span>
<span class="-7432664925500830597" onmouseenter="enter('-7432664925500830597');" onmouseout="out('-7432664925500830597');" style=""> 288              this.cacheContent = cacheContent;                                                                     </span>
<span class="5762471889889938429" onmouseenter="enter('5762471889889938429');" onmouseout="out('5762471889889938429');" style=""> 289              this.rowList = rowList;                                                                               </span>
<span class="4954020228022176436" onmouseenter="enter('4954020228022176436');" onmouseout="out('4954020228022176436');" style=""> 290              this.asyncKuduScanner = asyncKuduScanner;                                                             </span>
<span class="592225705701792215" onmouseenter="enter('592225705701792215');" onmouseout="out('592225705701792215');" style=""> 291              this.resultFuture = resultFuture;                                                                     </span>
<span class="5062295098979135982" onmouseenter="enter('5062295098979135982');" onmouseout="out('5062295098979135982');" style=""> 292              this.key = key;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293          }                                                                                                         </span>
<span  style=""> 294                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 295          @Override                                                                                                 </span>
<span class="8767874272678853351" onmouseenter="enter('8767874272678853351');" onmouseout="out('8767874272678853351');" style=""> 296          public Deferred&lt;List&lt;Row&gt;&gt; call(RowResultIterator results) throws Exception {                             </span>
<span class="-8941030450012249491" onmouseenter="enter('-8941030450012249491');" onmouseout="out('-8941030450012249491');" style=""> 297              for (RowResult result : results) {                                                                    </span>
<span class="-7707387193564908050" onmouseenter="enter('-7707387193564908050');" onmouseout="out('-7707387193564908050');" style=""> 298                  Map&lt;String, Object&gt; oneRow = Maps.newHashMap();                                                   </span>
<span class="4786776012437782338" onmouseenter="enter('4786776012437782338');" onmouseout="out('4786776012437782338');" style=""> 299                  for (String sideFieldName1 : StringUtils.split(sideInfo.getSideSelectFields(), &quot;,&quot;)) {            </span>
<span class="5422300911827801712" onmouseenter="enter('5422300911827801712');" onmouseout="out('5422300911827801712');" style=""> 300                      String sideFieldName = sideFieldName1.trim();                                                 </span>
<span class="-7396994512053753949" onmouseenter="enter('-7396994512053753949');" onmouseout="out('-7396994512053753949');" style=""> 301                      ColumnSchema columnSchema = table.getSchema().getColumn(sideFieldName);                       </span>
<span class="-1551001954350423389" onmouseenter="enter('-1551001954350423389');" onmouseout="out('-1551001954350423389');" style=""> 302                      if (null != columnSchema) {                                                                   </span>
<span class="-9080618923968214410" onmouseenter="enter('-9080618923968214410');" onmouseout="out('-9080618923968214410');" style=""> 303                          KuduUtil.setMapValue(columnSchema.getType(), oneRow, sideFieldName, result);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305                  }                                                                                                 </span>
<span class="-209789566031535321" onmouseenter="enter('-209789566031535321');" onmouseout="out('-209789566031535321');" style=""> 306                  Row row = fillData(input.row(), oneRow);                                                          </span>

<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 307                  if (openCache()) {                                                                                </span>
<span class="1888587301705190474" onmouseenter="enter('1888587301705190474');" onmouseout="out('1888587301705190474');" style=""> 308                      cacheContent.add(oneRow);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309                  }                                                                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 310                  rowList.add(new CRow(row, input.change()));                                                       </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="-5880917173204222408" onmouseenter="enter('-5880917173204222408');" onmouseout="out('-5880917173204222408');" style=""> 312              if (asyncKuduScanner.hasMoreRows()) {                                                                 </span>
<span class="411290205859931493" onmouseenter="enter('411290205859931493');" onmouseout="out('411290205859931493');" style=""> 313                  return asyncKuduScanner.nextRows().addCallbackDeferring(this);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314              }                                                                                                     </span>
<span  style=""> 315                                                                                                                    </span>
<span class="-5182000486454444757" onmouseenter="enter('-5182000486454444757');" onmouseout="out('-5182000486454444757');" style=""> 316              if (rowList.size() &gt; 0) {                                                                             </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 317                  if (openCache()) {                                                                                </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 318                      putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319                  }                                                                                                 </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 320                  resultFuture.complete(rowList);                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 321              } else {                                                                                              </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 322                  dealMissKey(input, resultFuture);                                                                 </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 323                  if (openCache()) {                                                                                </span>
<span class="-7075096462798044408" onmouseenter="enter('-7075096462798044408');" onmouseout="out('-7075096462798044408');" style=""> 324                      //放置在putCache的Miss中 一段时间内同一个key都会直接返回                                                         </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 325                      putCache(key, CacheMissVal.getMissKeyObj());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327              }                                                                                                     </span>
<span  style=""> 328                                                                                                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 329              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331      }                                                                                                             </span>
<span  style=""> 332                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            