<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>336 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save(); \n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\t\t\t\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save(); \n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\t\t\t\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;package com.automattic.simplenote;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import android.app.ActionBar;\n&#x27;
                           &#x27;import android.app.Activity;\n&#x27;
                           &#x27;import android.app.ListFragment;\n&#x27;
                           &#x27;import android.content.Context;\n&#x27;
                           &#x27;import android.content.SharedPreferences;\n&#x27;
                           &#x27;import android.content.res.Configuration;\n&#x27;
                           &#x27;import android.database.Cursor;\n&#x27;
                           &#x27;import android.os.Bundle;\n&#x27;
                           &#x27;import android.preference.PreferenceManager;\n&#x27;
                           &#x27;import android.text.Html;\n&#x27;
                           &#x27;import android.util.Log;\n&#x27;
                           &#x27;import android.view.LayoutInflater;\n&#x27;
                           &#x27;import android.view.View;\n&#x27;
                           &#x27;import android.view.ViewGroup;\n&#x27;
                           &#x27;import android.widget.AbsListView;\n&#x27;
                           &#x27;import android.widget.ArrayAdapter;\n&#x27;
                           &#x27;import android.widget.CursorAdapter;\n&#x27;
                           &#x27;import android.widget.ImageView;\n&#x27;
                           &#x27;import android.widget.LinearLayout;\n&#x27;
                           &#x27;import android.widget.ListView;\n&#x27;
                           &#x27;import android.widget.TextView;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Note;\n&#x27;
                           &#x27;import com.automattic.simplenote.models.Tag;\n&#x27;
                           &#x27;import com.automattic.simplenote.utils.PrefUtils;\n&#x27;
                           &#x27;import com.simperium.client.Bucket;\n&#x27;
                           &#x27;import com.simperium.client.Bucket.ObjectCursor;\n&#x27;
                           &#x27;import com.simperium.client.Query;\n&#x27;
                           &#x27;import com.simperium.client.Query.SortType;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Calendar;\n&#x27;
                           &#x27;import java.util.prefs.Preferences;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;/**\n&#x27;
                           &#x27; * A list fragment representing a list of Notes. &#x27;
                           &#x27;This fragment also supports\n&#x27;
                           &#x27; * tablet devices by allowing list items to be &#x27;
                           &quot;given an &#x27;activated&#x27; state upon\n&quot;
                           &#x27; * selection. This helps indicate which item is &#x27;
                           &#x27;currently being viewed in a\n&#x27;
                           &#x27; * {@link NoteEditorFragment}.\n&#x27;
                           &#x27; * &lt;p&gt;\n&#x27;
                           &#x27; * Activities containing this fragment MUST &#x27;
                           &#x27;implement the {@link Callbacks}\n&#x27;
                           &#x27; * interface.\n&#x27;
                           &#x27; */\n&#x27;
                           &#x27;public class NoteListFragment extends ListFragment &#x27;
                           &#x27;implements ActionBar.OnNavigationListener {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES=0;\n&#x27;
                           &#x27;    private static final int &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH=1;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate NotesCursorAdapter mNotesAdapter;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Note&gt; mNotesBucket;\n&#x27;
                           &#x27;\tprivate Bucket&lt;Tag&gt; mTagsBucket;\n&#x27;
                           &#x27;    private TextView mEmptyListTextView;\n&#x27;
                           &#x27;    private LinearLayout mDividerShadow;\n&#x27;
                           &#x27;\tprivate int mNumPreviewLines;\n&#x27;
                           &#x27;\tprivate String[] mMenuItems;\n&#x27;
                           &#x27;    private String mSelectedTag;\n&#x27;
                           &#x27;    private String mSearchString;\n&#x27;
                           &#x27;\tprivate int mNavigationItem;\n&#x27;
                           &#x27;    private boolean mNavListLoaded;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The preferences key representing the &#x27;
                           &#x27;activated item position. Only used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static final String &#x27;
                           &#x27;STATE_ACTIVATED_POSITION = &quot;activated_position&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &quot;\t * The fragment&#x27;s current callback object, which &quot;
                           &#x27;is notified of list item\n&#x27;
                           &#x27;\t * clicks.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate Callbacks mCallbacks = sCallbacks;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * The current activated item position. Only &#x27;
                           &#x27;used on tablets.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate int mActivatedPosition = &#x27;
                           &#x27;ListView.INVALID_POSITION;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * A callback interface that all activities &#x27;
                           &#x27;containing this fragment must\n&#x27;
                           &#x27;\t * implement. This mechanism allows activities &#x27;
                           &#x27;to be notified of item\n&#x27;
                           &#x27;\t * selections.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic interface Callbacks {\n&#x27;
                           &#x27;\t\t/**\n&#x27;
                           &#x27;\t\t * Callback for when a note has been &#x27;
                           &#x27;selected.\n&#x27;
                           &#x27;\t\t */\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * A dummy implementation of the {@link &#x27;
                           &#x27;Callbacks} interface that does\n&#x27;
                           &#x27;\t * nothing. Used only when this fragment is not &#x27;
                           &#x27;attached to an activity.\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tprivate static Callbacks sCallbacks = new &#x27;
                           &#x27;Callbacks() {\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic void onNoteSelected(Note note) {\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t};\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Mandatory empty constructor for the fragment &#x27;
                           &#x27;manager to instantiate the\n&#x27;
                           &#x27;\t * fragment (e.g. upon screen orientation &#x27;
                           &#x27;changes).\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic NoteListFragment() {\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onCreate(Bundle savedInstanceState) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;\t\tsuper.onCreate(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tmNotesBucket = application.getNotesBucket();\n&#x27;
                           &#x27;        mTagsBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        ObjectCursor&lt;Note&gt; cursor = queryNotes();\n&#x27;
                           &#x27;\t\tmNotesAdapter = new &#x27;
                           &#x27;NotesCursorAdapter(getActivity().getBaseContext(), &#x27;
                           &#x27;cursor, 0);\n&#x27;
                           &#x27;\t\tsetListAdapter(mNotesAdapter);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onActivityCreated(Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;        &#x27;
                           &#x27;super.onActivityCreated(savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    // nbradbury - load values from preferences\n&#x27;
                           &#x27;\tprotected void getPrefs() {\n&#x27;
                           &#x27;\t\tmNumPreviewLines = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_NUM_PREVIEW_LINES, 2);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public View onCreateView(LayoutInflater &#x27;
                           &#x27;inflater, ViewGroup container, Bundle &#x27;
                           &#x27;savedInstanceState)\n&#x27;
                           &#x27;    {\n&#x27;
                           &#x27;        View view = &#x27;
                           &#x27;inflater.inflate(R.layout.notes_list, container, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;        return view;\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onViewCreated(View view, Bundle &#x27;
                           &#x27;savedInstanceState) {\n&#x27;
                           &#x27;\t\tsuper.onViewCreated(view, &#x27;
                           &#x27;savedInstanceState);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mEmptyListTextView = &#x27;
                           &#x27;(TextView)view.findViewById(android.R.id.empty);\n&#x27;
                           &#x27;        mDividerShadow = &#x27;
                           &#x27;(LinearLayout)view.findViewById(R.id.divider_shadow);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            setActivateOnItemClick(true);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setDivider(getResources().getDrawable(R.drawable.list_divider));\n&#x27;
                           &#x27;        getListView().setDividerHeight(2);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;getListView().setBackgroundColor(getResources().getColor(R.color.white));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onAttach(Activity activity) {\n&#x27;
                           &#x27;\t\tsuper.onAttach(activity);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Activities containing this fragment must &#x27;
                           &#x27;implement its callbacks.\n&#x27;
                           &#x27;\t\tif (!(activity instanceof Callbacks)) {\n&#x27;
                           &#x27;\t\t\tthrow new IllegalStateException(&quot;Activity &#x27;
                           &#x27;must implement fragment\&#x27;s callbacks.&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tmCallbacks = (Callbacks) activity;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onResume() {\n&#x27;
                           &#x27;\t\tsuper.onResume();\n&#x27;
                           &#x27;        mNavListLoaded = false;\n&#x27;
                           &#x27;        getPrefs();\n&#x27;
                           &#x27;        refreshList();\n&#x27;
                           &#x27;        updateMenuItems();\n&#x27;
                           &#x27;        // update the view again\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.addListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onPause(){\n&#x27;
                           &#x27;        super.onPause();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mTagsBucket.removeListener(mTagsMenuUpdater);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onDetach() {\n&#x27;
                           &#x27;\t\tsuper.onDetach();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// Reset the active callbacks interface to the &#x27;
                           &#x27;dummy implementation.\n&#x27;
                           &#x27;\t\tmCallbacks = sCallbacks;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onDestroy(){\n&#x27;
                           &#x27;        super.onDestroy();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic void onListItemClick(ListView listView, &#x27;
                           &#x27;View view, int position, long id) {\n&#x27;
                           &#x27;\t\tsuper.onListItemClick(listView, view, &#x27;
                           &#x27;position, id);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tNote note = &#x27;
                           &#x27;(Note)getListAdapter().getItem(position);\n&#x27;
                           &#x27;        if (note != null)\n&#x27;
                           &#x27;            mCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        mActivatedPosition = position;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Selects first row in the list if available\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void selectFirstNote() {\n&#x27;
                           &#x27;        if (mNotesAdapter.getCount() &gt; 0) {\n&#x27;
                           &#x27;            Note selectedNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mCallbacks.onNoteSelected(selectedNote);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    @Override\n&#x27;
                           &#x27;    public void onSaveInstanceState(Bundle &#x27;
                           &#x27;outState) {\n&#x27;
                           &#x27;        super.onSaveInstanceState(outState);\n&#x27;
                           &#x27;        if (mActivatedPosition != &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;            // Serialize and persist the activated &#x27;
                           &#x27;item position.\n&#x27;
                           &#x27;            &#x27;
                           &#x27;outState.putInt(STATE_ACTIVATED_POSITION, &#x27;
                           &#x27;mActivatedPosition);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * Turns on activate-on-click mode. When this &#x27;
                           &#x27;mode is on, list items will be\n&#x27;
                           &quot;\t * given the &#x27;activated&#x27; state when touched.\n&quot;
                           &#x27;\t */\n&#x27;
                           &#x27;\tpublic void setActivateOnItemClick(boolean &#x27;
                           &#x27;activateOnItemClick) {\n&#x27;
                           &#x27;\t\t// When setting CHOICE_MODE_SINGLE, ListView &#x27;
                           &#x27;will automatically\n&#x27;
                           &quot;\t\t// give items the &#x27;activated&#x27; state when &quot;
                           &#x27;touched.\n&#x27;
                           &#x27;\t\t&#x27;
                           &#x27;getListView().setChoiceMode(activateOnItemClick ? &#x27;
                           &#x27;ListView.CHOICE_MODE_SINGLE : &#x27;
                           &#x27;ListView.CHOICE_MODE_NONE);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void setActivatedPosition(int position) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (getListView() != null) {\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;ListView.INVALID_POSITION) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(mActivatedPosition, &#x27;
                           &#x27;false);\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getListView().setItemChecked(position, true);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            mActivatedPosition = position;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setDividerVisible(boolean visible) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        if (visible)\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.VISIBLE);\n&#x27;
                           &#x27;        else\n&#x27;
                           &#x27;            &#x27;
                           &#x27;mDividerShadow.setVisibility(View.GONE);\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;deprecation&quot;)\n&#x27;
                           &#x27;\tpublic void refreshList() {\n&#x27;
                           &#x27;\t\tLog.d(Simplenote.TAG, &quot;Refresh the list&quot;);\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t\tmNotesAdapter.notifyDataSetChanged();\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public ObjectCursor&lt;Note&gt; queryNotes(){\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;String.format(&quot;Querying %d %s&quot;, mNavigationItem, &#x27;
                           &#x27;mSelectedTag));\n&#x27;
                           &#x27;        Query&lt;Note&gt; query = null;\n&#x27;
                           &#x27;        if (mSearchString != null) {\n&#x27;
                           &#x27;            query = Note.search(mNotesBucket, &#x27;
                           &#x27;mSearchString);\n&#x27;
                           &#x27;        } else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_ALL_NOTES) {\n&#x27;
                           &#x27;\t\t\t// All notes\n&#x27;
                           &#x27;\t\t\tquery = Note.all(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else if (mNavigationItem == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH) {\n&#x27;
                           &#x27;\t\t\t// Trashed notes\n&#x27;
                           &#x27;\t\t\tquery = Note.allDeleted(mNotesBucket);\n&#x27;
                           &#x27;\t\t} else {\n&#x27;
                           &#x27;\t\t\tquery = Note.allInTag(mNotesBucket, &#x27;
                           &#x27;mSelectedTag);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;        query.include(&quot;title&quot;, &quot;contentPreview&quot;, &#x27;
                           &#x27;&quot;pinned&quot;, &quot;modificationDate&quot;);\n&#x27;
                           &#x27;        sortNoteQuery(query);\n&#x27;
                           &#x27;        return query.execute();\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate void updateMenuItems() {\n&#x27;
                           &#x27;\t\t// Update ActionBar menu\n&#x27;
                           &#x27;\t\tSimplenote application = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;        Bucket&lt;Tag&gt; tagBucket = &#x27;
                           &#x27;application.getTagsBucket();\n&#x27;
                           &#x27;        ObjectCursor&lt;Tag&gt; tagCursor = &#x27;
                           &#x27;Tag.all(tagBucket).execute();\n&#x27;
                           &#x27;\t\tString[] tags = new &#x27;
                           &#x27;String[tagCursor.getCount()];\n&#x27;
                           &#x27;        while (tagCursor.moveToNext()) {\n&#x27;
                           &#x27;            Tag tag = tagCursor.getObject();\n&#x27;
                           &#x27;            tags[tagCursor.getPosition()] = &#x27;
                           &#x27;tag.getName();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        tagCursor.close();\n&#x27;
                           &#x27;\t\tString[] topItems = { &#x27;
                           &#x27;getResources().getString(R.string.notes), &#x27;
                           &#x27;getResources().getString(R.string.trash) };\n&#x27;
                           &#x27;\t\tmMenuItems = Arrays.copyOf(topItems, &#x27;
                           &#x27;tags.length + 2);\n&#x27;
                           &#x27;        ActionBar ab = &#x27;
                           &#x27;getActivity().getActionBar();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;ab.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);\n&#x27;
                           &#x27;\t\tSystem.arraycopy(tags, 0, mMenuItems, 2, &#x27;
                           &#x27;tags.length);\n&#x27;
                           &#x27;\t\tArrayAdapter mSpinnerAdapter = new &#x27;
                           &#x27;ArrayAdapter&lt;String&gt;(ab.getThemedContext(), &#x27;
                           &#x27;android.R.layout.simple_spinner_item, &#x27;
                           &#x27;mMenuItems);\n&#x27;
                           &#x27;        &#x27;
                           &#x27;mSpinnerAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\n&#x27;
                           &#x27;\t\tab.setListNavigationCallbacks(mSpinnerAdapter, &#x27;
                           &#x27;this);\n&#x27;
                           &#x27;        if (mNavigationItem &lt; mMenuItems.length) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            &#x27;
                           &#x27;ab.setSelectedNavigationItem(mNavigationItem);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void addNote() {\n&#x27;
                           &#x27;\t\t// create &amp; save new note\n&#x27;
                           &#x27;\t\tSimplenote simplenote = (Simplenote) &#x27;
                           &#x27;getActivity().getApplication();\n&#x27;
                           &#x27;\t\tBucket&lt;Note&gt; notesBucket = &#x27;
                           &#x27;simplenote.getNotesBucket();\n&#x27;
                           &#x27;\t\tNote note = notesBucket.newObject();\n&#x27;
                           &#x27;        &#x27;
                           &#x27;note.setCreationDate(Calendar.getInstance());\n&#x27;
                           &#x27;\t\tnote.save();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// refresh listview so new note appears\n&#x27;
                           &#x27;\t\trefreshList();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// nbradbury - call onNoteSelected() directly &#x27;
                           &#x27;rather than using code below, since code below may &#x27;
                           &#x27;not always select the correct note depending on &#x27;
                           &quot;user&#x27;s sort preference\n&quot;
                           &#x27;\t\tmCallbacks.onNoteSelected(note);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void setNoteSelected(Note selectedNote) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;        // Loop through notes and set note &#x27;
                           &#x27;selected if found\n&#x27;
                           &#x27;        for(int i=0; i &lt; mNotesAdapter.getCount(); &#x27;
                           &#x27;i++) {\n&#x27;
                           &#x27;            Note note = &#x27;
                           &#x27;(Note)mNotesAdapter.getItem(i);\n&#x27;
                           &#x27;            if &#x27;
                           &#x27;(note.getSimperiumKey().equals(selectedNote.getSimperiumKey())) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;                setActivatedPosition(i);\n&#x27;
                           &#x27;                break;\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic class NotesCursorAdapter extends &#x27;
                           &#x27;CursorAdapter {\n&#x27;
                           &#x27;        private ObjectCursor&lt;Note&gt; mCursor;\n&#x27;
                           &#x27;        public NotesCursorAdapter(Context context, &#x27;
                           &#x27;ObjectCursor&lt;Note&gt; c, int flags) {\n&#x27;
                           &#x27;            super(context, c, flags);\n&#x27;
                           &#x27;            mCursor = c;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void &#x27;
                           &#x27;changeCursor(ObjectCursor&lt;Note&gt; cursor){\n&#x27;
                           &#x27;            mCursor = cursor;\n&#x27;
                           &#x27;            super.changeCursor(cursor);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public Note getItem(int position) {\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            return mCursor.getObject();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        /*\n&#x27;
                           &#x27;        *  nbradbury - implemented &quot;holder &#x27;
                           &#x27;pattern&quot; to boost performance with large note &#x27;
                           &#x27;lists\n&#x27;
                           &#x27;        */\n&#x27;
                           &#x27;\t\t@Override\n&#x27;
                           &#x27;\t\tpublic View getView(int position, View view, &#x27;
                           &#x27;ViewGroup parent) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\tNoteViewHolder holder;\n&#x27;
                           &#x27;\t\t\tif (view == null) {\n&#x27;
                           &#x27;\t\t\t\tview = &#x27;
                           &#x27;View.inflate(getActivity().getBaseContext(), &#x27;
                           &#x27;R.layout.note_list_row, null);\n&#x27;
                           &#x27;\t\t\t\tholder = new NoteViewHolder();\n&#x27;
                           &#x27;\t\t\t\tholder.titleTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_title);\n&#x27;
                           &#x27;\t\t\t\tholder.contentTextView = (TextView) &#x27;
                           &#x27;view.findViewById(R.id.note_content);\n&#x27;
                           &#x27;\t\t\t\tholder.pinImageView = (ImageView) &#x27;
                           &#x27;view.findViewById(R.id.note_pin);\n&#x27;
                           &#x27;\t\t\t\tview.setTag(holder);\n&#x27;
                           &#x27;\t\t\t} else {\n&#x27;
                           &#x27;\t\t\t\tholder = (NoteViewHolder) view.getTag();\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (position == &#x27;
                           &#x27;getListView().getCheckedItemPosition())\n&#x27;
                           &#x27;                view.setActivated(true);\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                view.setActivated(false);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // for performance reasons we are &#x27;
                           &#x27;going to get indexed values\n&#x27;
                           &#x27;            // from the cursor instead of &#x27;
                           &#x27;instantiating the entire bucket object\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.contentTextView.setMaxLines(mNumPreviewLines);\n&#x27;
                           &#x27;            mCursor.moveToPosition(position);\n&#x27;
                           &#x27;            int pinned = &#x27;
                           &#x27;mCursor.getInt(mCursor.getColumnIndex(&quot;pinned&quot;));\n&#x27;
                           &#x27;            &#x27;
                           &#x27;holder.pinImageView.setVisibility(pinned == 1 ? &#x27;
                           &#x27;View.VISIBLE : View.GONE);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String title = &#x27;
                           &#x27;mCursor.getString(mCursor.getColumnIndex(&quot;title&quot;));\n&#x27;
                           &#x27;            if (title == null) {\n&#x27;
                           &#x27;                title = &#x27;
                           &#x27;getString(R.string.new_note);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;            holder.titleTextView.setText(title);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            if (mNumPreviewLines &gt; 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;holder.contentTextView.setText(mCursor.getString(mCursor.getColumnIndex(&quot;contentPreview&quot;)));\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\treturn view;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public View newView(Context context, &#x27;
                           &#x27;Cursor cursor, ViewGroup viewGroup) {\n&#x27;
                           &#x27;            return null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        @Override\n&#x27;
                           &#x27;        public void bindView(View view, Context &#x27;
                           &#x27;context, Cursor cursor) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t// view holder for NotesCursorAdapter\n&#x27;
                           &#x27;\tprivate static class NoteViewHolder {\n&#x27;
                           &#x27;\t\tTextView titleTextView;\n&#x27;
                           &#x27;\t\tTextView contentTextView;\n&#x27;
                           &#x27;\t\tImageView pinImageView;\n&#x27;
                           &#x27;        private String mNoteId;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void setNoteId(String noteId) {\n&#x27;
                           &#x27;            mNoteId = noteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public String getNoteId() {\n&#x27;
                           &#x27;            return mNoteId;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tpublic void searchNotes(String searchString) {\n&#x27;
                           &#x27;        mSearchString = searchString;\n&#x27;
                           &#x27;\t\tmNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;     * Clear search and load all notes\n&#x27;
                           &#x27;     */\n&#x27;
                           &#x27;    public void clearSearch() {\n&#x27;
                           &#x27;        mSearchString = null;\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@Override\n&#x27;
                           &#x27;\tpublic boolean onNavigationItemSelected(int &#x27;
                           &#x27;itemPosition, long itemId) {\n&#x27;
                           &#x27;        Log.d(Simplenote.TAG, &#x27;
                           &#x27;&quot;onNavigationItemSelected&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (!mNavListLoaded) {\n&#x27;
                           &#x27;            mNavListLoaded = true;\n&#x27;
                           &#x27;            return false;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // Update empty list placeholder text\n&#x27;
                           &#x27;        if (mEmptyListTextView != null) {\n&#x27;
                           &#x27;            if (itemPosition == &#x27;
                           &#x27;NAVIGATION_ITEM_TRASH)\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.trash_is_empty)));\n&#x27;
                           &#x27;            else\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mEmptyListTextView.setText(Html.fromHtml(getString(R.string.no_notes)));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        NotesActivity notesActivity = &#x27;
                           &#x27;(NotesActivity)getActivity();\n&#x27;
                           &#x27;\t\tmNavigationItem = itemPosition;\n&#x27;
                           &#x27;        if (itemPosition &gt; 1) {\n&#x27;
                           &#x27;            mSelectedTag = &#x27;
                           &#x27;mMenuItems[itemPosition];\n&#x27;
                           &#x27;        } else {\n&#x27;
                           &#x27;            mSelectedTag = null;\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        mNotesAdapter.changeCursor(queryNotes());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        notesActivity.invalidateOptionsMenu();\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(notesActivity.isLargeScreenLandscape()) {\n&#x27;
                           &#x27;            if (mNotesAdapter.getCount() == 0) {\n&#x27;
                           &#x27;                &#x27;
                           &#x27;notesActivity.showDetailPlaceholder();\n&#x27;
                           &#x27;            } else {\n&#x27;
                           &#x27;                // Select the first note\n&#x27;
                           &#x27;                Note firstNote = &#x27;
                           &#x27;mNotesAdapter.getItem(0);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;mCallbacks.onNoteSelected(firstNote);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn true;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    public void sortNoteQuery(Query&lt;Note&gt; &#x27;
                           &#x27;noteQuery){\n&#x27;
                           &#x27;        noteQuery.order(&quot;pinned&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\tint sortPref = &#x27;
                           &#x27;PrefUtils.getIntPref(getActivity(), &#x27;
                           &#x27;PrefUtils.PREF_SORT_ORDER);\n&#x27;
                           &#x27;\t\tswitch (sortPref) {\n&#x27;
                           &#x27;        case 0:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;            break;\n&#x27;
                           &#x27;\t\tcase 1:\n&#x27;
                           &#x27;            noteQuery.order(&quot;modificationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 2:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 3:\n&#x27;
                           &#x27;            noteQuery.order(&quot;creationDate&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 4:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.ASCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\tcase 5:\n&#x27;
                           &#x27;            noteQuery.order(&quot;content&quot;, &#x27;
                           &#x27;SortType.DESCENDING);\n&#x27;
                           &#x27;\t\t\tbreak;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;    }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    private Bucket.Listener&lt;Tag&gt; mTagsMenuUpdater &#x27;
                           &#x27;= new Bucket.Listener&lt;Tag&gt;(){\n&#x27;
                           &#x27;        void updateMenu(){\n&#x27;
                           &#x27;            getActivity().runOnUiThread(new &#x27;
                           &#x27;Runnable() {\n&#x27;
                           &#x27;                public void run() {\n&#x27;
                           &#x27;                    updateMenuItems();\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            });\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onSaveObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onDeleteObject(Bucket&lt;Tag&gt; &#x27;
                           &#x27;bucket, Tag tag){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        public void onChange(Bucket&lt;Tag&gt; bucket, &#x27;
                           &#x27;Bucket.ChangeType type, String key){\n&#x27;
                           &#x27;            updateMenu();\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;    };\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        