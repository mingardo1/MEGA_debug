<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>458</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    458
                    <a href="457.html">prev</a>
                    <a href="459.html">next</a>
                    <a href="458_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_e346a804d69c8cd0124b4eb3d35156cfb5cd0779_core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^1:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^2:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6e351a99f6e8449c76ad55e517a5da6cbb108379:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [j]], subset: [[b], [b], [b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  29 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  32 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  33 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  34 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  40 =======                                                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  41 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  43 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  44 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  45 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  46 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  47 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  48 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  49 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  50 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import java.util.Collections;                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59  * only support Left join / inner join(join),not support right join                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  60 =======                                                                                                  </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62 import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                      </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  66 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  67 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  68 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  69 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  70                                                                                                          </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  71 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  72 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  73 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  74 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  75 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  76 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  77 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  78 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  79 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  81 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  82  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  83  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  84  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  85  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  86  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87  */                                                                                                      </span>
<span  style="">  88                                                                                                          </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style=""><abbr title="  89 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  89 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt;🔵</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  90     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  91     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  92     private RuntimeContext runtimeContext;                                                               </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  93     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  94     private int timeOutNum = 0;                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  95     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  96     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  97                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  98     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  99         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style=""> 102     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style=""> 103         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style=""> 104         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 106     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style=""> 107     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style=""> 108         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style=""> 109         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 110         initMetric();                                                                                    </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style=""> 111         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span  style=""> 113                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style=""> 114     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style=""> 115         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title=" 116         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){"> 116         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 117             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118         }                                                                                                </span>
<span  style=""> 119                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 120         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 121         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 122             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 123             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 124         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 125             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 125             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span  style=""> 127                                                                                                          </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 128         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129     }                                                                                                    </span>
<span  style=""> 130                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 131     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 132         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 132         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span  style=""> 135                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 136     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 137         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 137         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style=""> 138                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 139         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 139         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 140         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 141             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 143         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144     }                                                                                                    </span>
<span  style=""> 145                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 146     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 147         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148     }                                                                                                    </span>
<span  style=""> 149                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 150     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 151         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152     }                                                                                                    </span>
<span  style=""> 153                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 154     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 155         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156     }                                                                                                    </span>
<span  style=""> 157                                                                                                          </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style=""><abbr title=" 158     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 158     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)🔵</abbr></span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 159         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 160             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 161             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 162                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 163                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 164             } catch (Exception e) {                                                                      </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 165                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 167         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 168             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 172     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 173         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 174             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span  style=""> 177                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 178     @Override                                                                                            </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style=""><abbr title=" 179     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 179     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws🔵</abbr></span>
<span  style=""> 180                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 181         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 182             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 182             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeO🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 184         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 185         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 186             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 187             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 189         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 190             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 190             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 191             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 193         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 196     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 197         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 198         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 201     @Override                                                                                            </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style=""> 202     public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style=""> 203         CRow input = new CRow(Row.copy(row.row()), row.change());                                        </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 204         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 205         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 206         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 207             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 208             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 210         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 211             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 212             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 214         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215     }                                                                                                    </span>
<span  style=""> 216                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 217     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 218         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 219         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 220             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 221             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 222             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 223                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 225             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 226             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 228         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 231     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 232         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 235     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 235     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 236         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 237             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 238             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 239                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 240                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 241                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 242                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 243                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style=""> 244                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 245                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 246                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 247                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 249                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 250                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 251                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 252                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 253                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 254                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 256                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 257                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 258                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 260                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 261                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 261                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 263                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span  style=""> 267                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 268     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 268     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 269                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 270 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="8365930102045704377" onmouseenter="enter('8365930102045704377');" onmouseout="out('8365930102045704377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 271     protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object sourceData) {"> 271     protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object 🔵</abbr></span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 272         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 273         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 274 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 275 =======                                                                                                  </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 283         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 283         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 294     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 294     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 295         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 295         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 299                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303                                                                                                          </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304     protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {         </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 305 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 306         parseErrorRecords.inc();                                                                         </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""><abbr title=" 307         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){"> 307         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE))🔵</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 308             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 309             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 310         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 311             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313     }                                                                                                    </span>
<span  style=""> 314                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 315     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 316     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 317         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  29 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  32 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  33 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  34 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  35 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  36 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  37 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  38 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  39 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  40 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="">  41 import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                      </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  42 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  43 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  44 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  45 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  46 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  48 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  49 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  50 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  51 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  52 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  53 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  54 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  55 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  56 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  57                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  58 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  59  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  60  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  61  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  62  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  63  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64  */                                                                                                      </span>
<span  style="">  65                                                                                                          </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style=""><abbr title="  66 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  66 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt;🔵</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  67     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  68     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  69     private RuntimeContext runtimeContext;                                                               </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  70     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  71     private int timeOutNum = 0;                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  72     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  73     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  74                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  75     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  76         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  79     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  80         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  81         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  84     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  85         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  86         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  87         initMetric();                                                                                    </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  88         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span  style="">  90                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  91     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  92         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  93         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  93         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  94             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span  style="">  96                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  97         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  98         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  99             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 100             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 101         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 102             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 102             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103         }                                                                                                </span>
<span  style=""> 104                                                                                                          </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 105         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 108     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 109         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 109         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span  style=""> 111                                                                                                          </span>
<span  style=""> 112                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 113     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 114         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 114         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style=""> 115                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 116         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 116         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 117         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 118             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 120         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121     }                                                                                                    </span>
<span  style=""> 122                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 123     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 124         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 127     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 128         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129     }                                                                                                    </span>
<span  style=""> 130                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 131     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 132         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133     }                                                                                                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style=""><abbr title=" 135     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 135     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)🔵</abbr></span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 136         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 137             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 138             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 139                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 140                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 141             } catch (Exception e) {                                                                      </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 142                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 144         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 145             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147     }                                                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 149     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 150         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 151             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153     }                                                                                                    </span>
<span  style=""> 154                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 155     @Override                                                                                            </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style=""><abbr title=" 156     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 156     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws🔵</abbr></span>
<span  style=""> 157                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 158         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 159             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 159             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeO🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 161         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 162         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 163             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 164             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 166         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 167             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 167             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 168             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 170         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span  style=""> 173                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 174 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="8365930102045704377" onmouseenter="enter('8365930102045704377');" onmouseout="out('8365930102045704377');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 175     protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object sourceData) {"> 175     protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object 🔵</abbr></span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 176         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 177         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 178         parseErrorRecords.inc();                                                                         </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 179         resultFuture.complete(Collections.emptyList());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180     }                                                                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 181 ||||||| BASE                                                                                             </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182     protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {  </span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183         LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                  </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184         LOG.debug(&quot;async buid row error..{}&quot;, e);                                                        </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185         parseErrorRecords.inc();                                                                         </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186         resultFuture.complete(Collections.emptyList());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 188 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189                                                                                                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 190 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 191                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 192     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 193         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 194         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195     }                                                                                                    </span>
<span  style=""> 196                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 197     @Override                                                                                            </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style=""> 198     public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style=""> 199         CRow input = new CRow(Row.copy(row.row()), row.change());                                        </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 200         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 201         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 202         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 203             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 204             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 206         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 207             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 208             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 210         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 213     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 214         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 215         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 216             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 217             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 218             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 219                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 221             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 222             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 224         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225     }                                                                                                    </span>
<span  style=""> 226                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 227     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 228         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 231     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 231     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 232         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 233             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 234             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 235                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 236                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 237                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 238                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 239                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style=""> 240                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 241                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 242                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 243                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 245                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 246                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 247                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 248                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 249                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 250                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 252                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 253                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 254                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 256                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 257                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 257                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 259                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262     }                                                                                                    </span>
<span  style=""> 263                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 264     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 264     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 265                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 266     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 267                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 268     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 269         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270     }                                                                                                    </span>
<span  style=""> 271                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 272     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 273         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 273         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 274         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 275                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 276                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 277                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 278                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 279                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 281                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282     }                                                                                                    </span>
<span  style=""> 283                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""><abbr title=" 284     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 284     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style=""><abbr title=" 285         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 285         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 286         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 287             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 288             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 289                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style=""> 290             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292     }                                                                                                    </span>
<span  style=""> 293                                                                                                          </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style=""> 294     protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {         </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 295         parseErrorRecords.inc();                                                                         </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""><abbr title=" 296         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){"> 296         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE))🔵</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 297             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 298             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 299         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 300             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302     }                                                                                                    </span>
<span  style=""> 303                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 304     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 305     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 306         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308 }                                                                                                        </span>









</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  21 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  22 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  23 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  24 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  25 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  26 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  27 import com.google.common.collect.Maps;                                                                   </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  28 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  29 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  30 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  31 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  32 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  33 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  34 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  35 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  36 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  37 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  38 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  39 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  40 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  41 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  42 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  43 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  44 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  45 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="">  46 import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                      </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  47 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  48 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  49 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  50 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  51 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  52 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  53                                                                                                          </span>
<span  style="">  54                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  56  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  57  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  58  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  59  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  60  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61  */                                                                                                      </span>
<span class="5004288966946545706" onmouseenter="enter('5004288966946545706');" onmouseout="out('5004288966946545706');" style=""><abbr title="  62 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean, Row&gt;, Tuple2&lt;Boolean, Row&gt;&gt; implements ISideReqRow {">  62 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean, Row&gt;, Tuple2&lt;Boolean, Row🔵</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  63     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span  style="">  64                                                                                                          </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  65     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span  style="">  66                                                                                                          </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  67     private RuntimeContext runtimeContext;                                                               </span>
<span  style="">  68                                                                                                          </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  69     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span  style="">  70                                                                                                          </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  71     private int timeOutNum = 0;                                                                          </span>
<span  style="">  72                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  73     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  74                                                                                                          </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  75     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  76                                                                                                          </span>
<span class="8633132124041356827" onmouseenter="enter('8633132124041356827');" onmouseout="out('8633132124041356827');" style="">  77     public BaseAsyncReqRow(BaseSideInfo sideInfo) {                                                      </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  78         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  82     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  83         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  84         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85     }                                                                                                    </span>
<span  style="">  86                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  87     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  88     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  89         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  90         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  91         initMetric();                                                                                    </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  92         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93     }                                                                                                    </span>
<span  style="">  94                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  95     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  96         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  97         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  97         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  98             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99         }                                                                                                </span>
<span  style=""> 100                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 101         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 102         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 103             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 104             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 105         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 106             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 106             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107         }                                                                                                </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 108         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109     }                                                                                                    </span>
<span  style=""> 110                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 111     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 112         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 112         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span  style=""> 114                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 115     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 116         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 116         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style=""> 117                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 118         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 118         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 119         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 120             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 122         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123     }                                                                                                    </span>
<span  style=""> 124                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 125     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 126         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 129     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 130         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 133     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 134         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135     }                                                                                                    </span>
<span  style=""> 136                                                                                                          </span>
<span class="-98716559701656738" onmouseenter="enter('-98716559701656738');" onmouseout="out('-98716559701656738');" style=""><abbr title=" 137     protected void dealMissKey(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) {"> 137     protected void dealMissKey(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFutur🔵</abbr></span>
<span class="3012505652182075436" onmouseenter="enter('3012505652182075436');" onmouseout="out('3012505652182075436');" style=""> 138         if (sideInfo.getJoinType() == JoinType.LEFT) {                                                   </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 139             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 140             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 141                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 142                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 143             } catch (java.lang.Exception e) {                                                            </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 144                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 146         } else {                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 147             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149     }                                                                                                    </span>
<span  style=""> 150                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 151     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 152         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 153             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155     }                                                                                                    </span>
<span  style=""> 156                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 157     @Override                                                                                            </span>
<span class="-4832727189529261219" onmouseenter="enter('-4832727189529261219');" onmouseout="out('-4832727189529261219');" style=""><abbr title=" 158     public void timeout(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception {"> 158     public void timeout(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) thro🔵</abbr></span>
<span class="-4512921245805166737" onmouseenter="enter('-4512921245805166737');" onmouseout="out('-4512921245805166737');" style=""> 159         if ((timeOutNum % TIMEOUT_LOG_FLUSH_NUM) == 0) {                                                 </span>
<span class="969036689275660584" onmouseenter="enter('969036689275660584');" onmouseout="out('969036689275660584');" style=""><abbr title=" 160             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), timeOutNum);"> 160             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), time🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span class="-2219815117127949521" onmouseenter="enter('-2219815117127949521');" onmouseout="out('-2219815117127949521');" style=""> 162         timeOutNum++;                                                                                    </span>
<span class="3012505652182075436" onmouseenter="enter('3012505652182075436');" onmouseout="out('3012505652182075436');" style=""> 163         if (sideInfo.getJoinType() == JoinType.LEFT) {                                                   </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 164             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 165             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166         }                                                                                                </span>
<span class="1912651862938115971" onmouseenter="enter('1912651862938115971');" onmouseout="out('1912651862938115971');" style=""> 167         if (timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)) {               </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 168             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 168             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limi🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 169             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 171         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172     }                                                                                                    </span>
<span  style=""> 173                                                                                                          </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 174     protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                               </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 175         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 176         cancelTimerWhenComplete(resultFuture, timeFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177     }                                                                                                    </span>
<span  style=""> 178                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 179     @Override                                                                                            </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style=""> 180     public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style=""> 181         CRow input = new CRow(Row.copy(row.row()), row.change());                                        </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 182         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 183         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 184         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 185             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 186             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 188         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 189             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 190             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 192         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span  style=""> 194                                                                                                          </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 195     private Map&lt;String, Object&gt; parseInputParam(CRow input){                                             </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 196         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 197         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 198             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 199             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 200             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 201                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 203             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 204             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 206         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 209     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 210         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""><abbr title=" 213     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){"> 213     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFu🔵</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 214         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 215             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 216             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 217                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 218                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 219                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 220                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 221                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style=""> 222                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 223                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 224                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 225                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 227                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 228                     try {                                                                                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 229                         List&lt;CRow&gt; rowList = Lists.newArrayList();                                       </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 230                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 231                             Row row = fillData(input.row(), one);                                        </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 232                             rowList.add(new CRow(row, input.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 234                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 235                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 236                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 238                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 239                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 239                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 241                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244     }                                                                                                    </span>
<span  style=""> 245                                                                                                          </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 246     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 246     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRo🔵</abbr></span>
<span  style=""> 247                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 248     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 249                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 250     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 251         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252     }                                                                                                    </span>
<span  style=""> 253                                                                                                          </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 254     protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){             </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 255         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 255         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 256         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 257                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 258                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 259                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 260                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 261                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 263                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264     }                                                                                                    </span>
<span  style=""> 265                                                                                                          </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""><abbr title=" 266     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 266     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFutur🔵</abbr></span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style=""><abbr title=" 267         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 267         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedB🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 268         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 269             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 270             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 271                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style=""> 272             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274     }                                                                                                    </span>
<span  style=""> 275                                                                                                          </span>
<span class="-2481702804326735510" onmouseenter="enter('-2481702804326735510');" onmouseout="out('-2481702804326735510');" style=""><abbr title=" 276     protected void dealFillDataError(CRow input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture, Throwable e) {"> 276     protected void dealFillDataError(CRow input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture, Throwab🔵</abbr></span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 277         parseErrorRecords.inc();                                                                         </span>
<span class="6939484962528932570" onmouseenter="enter('6939484962528932570');" onmouseout="out('6939484962528932570');" style=""><abbr title=" 278         if (parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)) {"> 278         if (parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)🔵</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 279             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 280             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 281         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 282             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284     }                                                                                                    </span>
<span  style=""> 285                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 286     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 287     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 288         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290 }                                                                                                        </span>



























</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>

<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  23  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  24  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  25  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  27  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>


<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  28  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>

<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  30  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  31  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  32  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  33  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>




<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  36  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  37  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  38  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  39                                                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import java.sql.Timestamp;                                                                                        </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +import java.time.LocalDateTime;                                                                                   </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  42  import java.util.Collections;                                                                                     </span>






<span  style="">  43                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  44  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  45   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  46   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  47   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  48   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  49   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50   */                                                                                                               </span>
<span  style="">  51                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  53 +public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  53 +public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implemen🔵</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  54      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  55      private static final long serialVersionUID = 2098635244857937717L;                                            </span>
<span  style="">  56                                                                                                                    </span>

<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  57      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  58      private int timeOutNum = 0;                                                                                   </span>
<span  style="">  59                                                                                                                    </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  60      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  61      protected transient Counter parseErrorRecords;                                                                </span>
<span  style="">  62                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  63      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  64          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65      }                                                                                                             </span>
<span  style="">  66                                                                                                                    </span>





<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  67      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  68      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  69          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  70          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  71          initMetric();                                                                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  72      }                                                                                                             </span>
<span  style="">  73                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  74      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  75          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  76          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  76          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheT🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  77              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78          }                                                                                                         </span>
<span  style="">  79                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  80          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  81          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  82              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style="">  83              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="">  84          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style="">  85              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86          }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +                                                                                                                  </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style="">  88          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style="">  91      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title="  92          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);">  92          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RE🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +                                                                                                                  </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +    protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                                     </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  97 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());">  97 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().g🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +                                                                                                                  </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  99 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long.">  99 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timesta🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +        if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +            obj = Timestamp.valueOf(((LocalDateTime) obj));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +        }                                                                                                         </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +        return obj;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104      }                                                                                                             </span>
<span  style=""> 105                                                                                                                    </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 106      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 107          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108      }                                                                                                             </span>
<span  style=""> 109                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 110      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 111          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112      }                                                                                                             </span>
<span  style=""> 113                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 114      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 115          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116      }                                                                                                             </span>
<span  style=""> 117                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -    protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +    protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){        </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 120          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 121              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 122              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -                Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -                resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +                Row row = fillData(input.f1, null);                                                               </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 127              } catch (Exception e) {                                                                               </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 128                  dealFillDataError(resultFuture, e, input);                                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 130          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 131              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133      }                                                                                                             </span>
<span  style=""> 134                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 135      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 136          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 137              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139      }                                                                                                             </span>
<span  style=""> 140                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -    public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 143 +    public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 143 +    public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exceptio🔵</abbr></span>
<span  style=""> 144                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 145          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 146              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147          }                                                                                                         </span>
<span  style=""> 148                                                                                                                    </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 149          timeOutNum ++;                                                                                            </span>
<span class="3720393119063151586" onmouseenter="enter('3720393119063151586');" onmouseout="out('3720393119063151586');" style=""> 150          if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncTimeoutNumLimit()){                                   </span>





<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 151              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
















































































































<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 152          } else {                                                                                                  </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 153              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155      }                                                                                                             </span>
<span  style=""> 156                                                                                                                    </span>
<span  style=""> 157                                                                                                                    </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -    protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {           </span>
<span class="8365930102045704377" onmouseenter="enter('8365930102045704377');" onmouseout="out('8365930102045704377');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 159 +    protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object sourceData) {"> 159 +    protected void dealFillDataError(ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Exception e, Object sourceDat🔵</abbr></span>
<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style=""> 160          LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                           </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style=""> 161          LOG.debug(&quot;async buid row error..{}&quot;, e);                                                                 </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 162          parseErrorRecords.inc();                                                                                  </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style=""> 163          resultFuture.complete(Collections.emptyList());                                                           </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164      }                                                                                                             </span>
<span  style=""> 165                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 166      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 167      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 168          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import com.google.common.collect.Maps;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  31  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import org.apache.flink.api.common.functions.RuntimeContext;                                                      </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  34  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  35  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  36  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  37  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                          </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  39 +import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                               </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                           </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  42  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>

<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  43  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  44  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  45  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  46                                                                                                                    </span>


<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  47  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import java.util.Map;                                                                                             </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import java.util.concurrent.LinkedBlockingQueue;                                                                  </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import java.util.concurrent.ScheduledFuture;                                                                      </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +import java.util.concurrent.ThreadPoolExecutor;                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  54                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  56   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  57   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  58   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  59   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  60   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61   */                                                                                                               </span>
<span  style="">  62                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  63  public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>

<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  64      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  65      private static final long serialVersionUID = 2098635244857937717L;                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -                                                                                                                  </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +    private RuntimeContext runtimeContext;                                                                        </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  68      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  69      private int timeOutNum = 0;                                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -                                                                                                                  </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  71      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  72      protected transient Counter parseErrorRecords;                                                                </span>
<span  style="">  73                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  74      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  75          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +    @Override                                                                                                     </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +    public void setRuntimeContext(RuntimeContext runtimeContext) {                                                </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +        super.setRuntimeContext(runtimeContext);                                                                  </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +        this.runtimeContext = runtimeContext;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +    }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  84      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  85          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  86          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  87          initMetric();                                                                                             </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +        LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89      }                                                                                                             </span>
<span  style="">  90                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  91      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  92          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  93          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  93          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheT🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  94              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95          }                                                                                                         </span>
<span  style="">  96                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  97          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  98          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style="">  99              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 100              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 101          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""> 102              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103          }                                                                                                         </span>

<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 104          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105      }                                                                                                             </span>
<span  style=""> 106                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 107      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 108          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 108          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RE🔵</abbr></span>











<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109      }                                                                                                             </span>
<span  style=""> 110                                                                                                                    </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 111      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 112          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113      }                                                                                                             </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 115      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 116          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117      }                                                                                                             </span>
<span  style=""> 118                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 119      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 120          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 123      protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>

<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 124          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 125              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 126              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 127                  Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 128                  resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>


<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 129              } catch (Exception e) {                                                                               </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -                dealFillDataError(resultFuture, e, input);                                                        </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                dealFillDataError(input, resultFuture, e);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 133          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 134              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136      }                                                                                                             </span>
<span  style=""> 137                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 138      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 139          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 140              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142      }                                                                                                             </span>
<span  style=""> 143                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 145      public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>

<span  style=""> 146                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 147          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 148              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149          }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -                                                                                                                  </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 151          timeOutNum ++;                                                                                            </span>
<span class="3720393119063151586" onmouseenter="enter('3720393119063151586');" onmouseout="out('3720393119063151586');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -        if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncTimeoutNumLimit()){                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +        if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +            resultFuture.complete(null);                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +        }                                                                                                         </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +        if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                          </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 158              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +        }                                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +        resultFuture.complete(null);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +                                                                                                                  </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +    protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                        </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +        ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                                       </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +        cancelTimerWhenComplete(resultFuture, timeFuture);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +    @Override                                                                                                     </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +    public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                         </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +        CRow input = new CRow(Row.copy(row.row()), row.change());                                                 </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +        preInvoke(input, resultFuture);                                                                           </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +        Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                                 </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +        if(MapUtils.isEmpty(inputParams)){                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +            dealMissKey(input, resultFuture);                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +        }                                                                                                         </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +        if(isUseCache(inputParams)){                                                                              </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +            invokeWithCache(inputParams, input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +        }                                                                                                         </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +        handleAsyncInvoke(inputParams, input, resultFuture);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +                                                                                                                  </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +    private Map&lt;String, Object&gt; parseInputParam(CRow input){                                                      </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +        Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                                      </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 187 +        for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +            Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +            Object equalObj = input.row().getField(conValIndex);                                                  </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +            if(equalObj == null){                                                                                 </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +                return inputParams;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +            }                                                                                                     </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +            String columnName = sideInfo.getEqualFieldList().get(i);                                              </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +            inputParams.put(columnName, equalObj);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +        }                                                                                                         </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 196 +        return inputParams;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +                                                                                                                  </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +    protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                                </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 200 +        return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 201 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 202 +                                                                                                                  </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 203 +    private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){   </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 204 +        if (openCache()) {                                                                                        </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 205 +            CacheObj val = getFromCache(buildCacheKey(inputParams));                                              </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 206 +            if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 207 +                if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 208 +                    dealMissKey(input, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 209 +                    return;                                                                                       </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +                }else if(ECacheContentType.SingleLine == val.getType()){                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 211 +                    try {                                                                                         </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +                        Row row = fillData(input.row(), val.getContent());                                        </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +                    } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +                        dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +                    }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +                } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +                    try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +                        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +                        for (Object one : (List) val.getContent()) {                                              </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +                            Row row = fillData(input.row(), one);                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +                            rowList.add(new CRow(row, input.change()));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +                        }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +                        resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 225 +                    } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 226 +                        dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +                } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 229 +                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 229 +                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 232 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 233 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 234 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 235 +                                                                                                                  </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 236 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 236 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; result🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 237 +                                                                                                                  </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 238 +    public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 239 +                                                                                                                  </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +    private ProcessingTimeService getProcessingTimeService(){                                                     </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 241 +        return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 242 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 243 +                                                                                                                  </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 244 +    protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                      </span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 245 +        long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 245 +        long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurr🔵</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 246 +        return getProcessingTimeService().registerTimer(                                                          </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 247 +                timeoutTimestamp,                                                                                 </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 248 +                new ProcessingTimeCallback() {                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 249 +                    @Override                                                                                     </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 250 +                    public void onProcessingTime(long timestamp) throws Exception {                               </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 251 +                        timeout(input, resultFuture);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +                    }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 253 +                });                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 254 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 255 +                                                                                                                  </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 256 +    protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){      </span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 257 +        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 257 +        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQu🔵</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 258 +        if(resultFuture instanceof StreamRecordQueueEntry){                                                       </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 259 +            StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;               </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 260 +            streamRecordBufferEntry.onComplete((Object value) -&gt; {                                                </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 261 +                timerFuture.cancel(true);                                                                         </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 262 +            },executors);                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 263 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 264 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 265 +                                                                                                                  </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +    protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {                  </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 267 +        parseErrorRecords.inc();                                                                                  </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 268 +        if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){        </span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 269 +            LOG.info(&quot;dealFillDataError&quot;, e);                                                                     </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 270 +            resultFuture.completeExceptionally(e);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 271          } else {                                                                                                  </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -            resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -                                                                                                                  </span>
<span class="-4727262966288731605" onmouseenter="enter('-4727262966288731605');" onmouseout="out('-4727262966288731605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -    protected void dealFillDataError(ResultFuture&lt;CRow&gt; resultFuture, Exception e, Object sourceData) {           </span>

<span class="6915596553789612319" onmouseenter="enter('6915596553789612319');" onmouseout="out('6915596553789612319');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -        LOG.debug(&quot;source data {} join side table error &quot;, sourceData);                                           </span>
<span class="-4205707616140093344" onmouseenter="enter('-4205707616140093344');" onmouseout="out('-4205707616140093344');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -        LOG.debug(&quot;async buid row error..{}&quot;, e);                                                                 </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -        parseErrorRecords.inc();                                                                                  </span>
<span class="511323173950770012" onmouseenter="enter('511323173950770012');" onmouseout="out('511323173950770012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -        resultFuture.complete(Collections.emptyList());                                                           </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 282 +            dealMissKey(input, resultFuture);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 283 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284      }                                                                                                             </span>
<span  style=""> 285                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 286      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 287      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 288          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            