<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>325</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    325
                    <a href="324.html">prev</a>
                    <a href="326.html">next</a>
                    <a href="325_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    CyanogenMod/android_packages_apps_Trebuchet_b3a8f80e2ea8de4fb305d7a4141980bc98d629a8_src/com/android/launcher3/DefaultLayoutParser.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;b3a8f80e2ea8de4fb305d7a4141980bc98d629a8:src/com/android/launcher3/DefaultLayoutParser.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;b3a8f80e2ea8de4fb305d7a4141980bc98d629a8^1:src/com/android/launcher3/DefaultLayoutParser.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;b3a8f80e2ea8de4fb305d7a4141980bc98d629a8^2:src/com/android/launcher3/DefaultLayoutParser.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;71701f8145f0eb1017b2d3590fc87babad1d1bd3:src/com/android/launcher3/DefaultLayoutParser.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">   1 package com.android.launcher3;                                                                           </span>
<span  style="">   2                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">   3 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-9183914406029598577" onmouseenter="enter('-9183914406029598577');" onmouseout="out('-9183914406029598577');" style="">   6 import android.content.pm.ActivityInfo;                                                                  </span>
<span class="-841431222158024655" onmouseenter="enter('-841431222158024655');" onmouseout="out('-841431222158024655');" style="">   7 import android.content.pm.ApplicationInfo;                                                               </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   8 import android.content.pm.PackageManager;                                                                </span>
<span class="8582326229770324815" onmouseenter="enter('8582326229770324815');" onmouseout="out('8582326229770324815');" style="">   9 import android.content.pm.ResolveInfo;                                                                   </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  10 import android.content.res.Resources;                                                                    </span>
<span class="7386012112211289620" onmouseenter="enter('7386012112211289620');" onmouseout="out('7386012112211289620');" style="">  11 import android.content.res.XmlResourceParser;                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  12 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  13 import android.util.Log;                                                                                 </span>
<span  style="">  14                                                                                                          </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  15 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span  style="">  16                                                                                                          </span>
<span class="-5145222340437954675" onmouseenter="enter('-5145222340437954675');" onmouseout="out('-5145222340437954675');" style="">  17 import org.xmlpull.v1.XmlPullParser;                                                                     </span>
<span class="-3477173242969633951" onmouseenter="enter('-3477173242969633951');" onmouseout="out('-3477173242969633951');" style="">  18 import org.xmlpull.v1.XmlPullParserException;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  20 import java.io.IOException;                                                                              </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  21 import java.net.URISyntaxException;                                                                      </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  22 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span  style="">  24                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  25 /**                                                                                                      </span>
<span class="8625030305996545010" onmouseenter="enter('8625030305996545010');" onmouseout="out('8625030305996545010');" style="">  26  * Implements the layout parser with rules for internal layouts and partner layouts.                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  27  */                                                                                                      </span>
<span class="-4383609652675664527" onmouseenter="enter('-4383609652675664527');" onmouseout="out('-4383609652675664527');" style="">  28 public class DefaultLayoutParser extends AutoInstallsLayout {                                            </span>
<span class="6838912681597350908" onmouseenter="enter('6838912681597350908');" onmouseout="out('6838912681597350908');" style="">  29     private static final String TAG = &quot;DefaultLayoutParser&quot;;                                             </span>
<span  style="">  30                                                                                                          </span>
<span class="5205878637063247744" onmouseenter="enter('5205878637063247744');" onmouseout="out('5205878637063247744');" style="">  31     protected static final String TAG_RESOLVE = &quot;resolve&quot;;                                               </span>
<span class="-6648556986475948603" onmouseenter="enter('-6648556986475948603');" onmouseout="out('-6648556986475948603');" style="">  32     private static final String TAG_FAVORITES = &quot;favorites&quot;;                                             </span>
<span class="8610360292624390744" onmouseenter="enter('8610360292624390744');" onmouseout="out('8610360292624390744');" style="">  33     protected static final String TAG_FAVORITE = &quot;favorite&quot;;                                             </span>
<span class="8817783213080628620" onmouseenter="enter('8817783213080628620');" onmouseout="out('8817783213080628620');" style="">  34     private static final String TAG_APPWIDGET = &quot;appwidget&quot;;                                             </span>
<span class="1544013162193549447" onmouseenter="enter('1544013162193549447');" onmouseout="out('1544013162193549447');" style="">  35     private static final String TAG_SHORTCUT = &quot;shortcut&quot;;                                               </span>
<span class="-5715927654015021253" onmouseenter="enter('-5715927654015021253');" onmouseout="out('-5715927654015021253');" style="">  36     private static final String TAG_FOLDER = &quot;folder&quot;;                                                   </span>
<span class="-6175494568545371270" onmouseenter="enter('-6175494568545371270');" onmouseout="out('-6175494568545371270');" style="">  37     private static final String TAG_PARTNER_FOLDER = &quot;partner-folder&quot;;                                   </span>
<span  style="">  38                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  39 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-6586268974859869590" onmouseenter="enter('-6586268974859869590');" onmouseout="out('-6586268974859869590');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40     protected static final String ATTR_URI = &quot;uri&quot;;                                                      </span>
<span class="-5893198944478773555" onmouseenter="enter('-5893198944478773555');" onmouseout="out('-5893198944478773555');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41     private static final String ATTR_WORKSPACE = &quot;workspace&quot;;                                            </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  42 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-5562355841128428217" onmouseenter="enter('-5562355841128428217');" onmouseout="out('-5562355841128428217');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43     private static final String TAG_INCLUDE = &quot;include&quot;;                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="-5345085314000449361" onmouseenter="enter('-5345085314000449361');" onmouseout="out('-5345085314000449361');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45     private static final String ATTR_URI = &quot;uri&quot;;                                                        </span>
<span class="-5893198944478773555" onmouseenter="enter('-5893198944478773555');" onmouseout="out('-5893198944478773555');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46     private static final String ATTR_WORKSPACE = &quot;workspace&quot;;                                            </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  47 =======                                                                                                  </span>
<span class="-5345085314000449361" onmouseenter="enter('-5345085314000449361');" onmouseout="out('-5345085314000449361');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  48     private static final String ATTR_URI = &quot;uri&quot;;                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  49 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="2414249740748360985" onmouseenter="enter('2414249740748360985');" onmouseout="out('2414249740748360985');" style="">  50     private static final String ATTR_CONTAINER = &quot;container&quot;;                                            </span>
<span class="-389066511444324935" onmouseenter="enter('-389066511444324935');" onmouseout="out('-389066511444324935');" style="">  51     private static final String ATTR_SCREEN = &quot;screen&quot;;                                                  </span>
<span class="1567909548797839052" onmouseenter="enter('1567909548797839052');" onmouseout="out('1567909548797839052');" style="">  52     private static final String ATTR_FOLDER_ITEMS = &quot;folderItems&quot;;                                       </span>
<span  style="">  53                                                                                                          </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  54     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                             </span>
<span class="2852391764281860202" onmouseenter="enter('2852391764281860202');" onmouseout="out('2852391764281860202');" style="">  55             LayoutParserCallback callback, Resources sourceRes, int layoutId) {                          </span>
<span class="7279694431066637071" onmouseenter="enter('7279694431066637071');" onmouseout="out('7279694431066637071');" style="">  56         super(context, appWidgetHost, callback, sourceRes, layoutId, TAG_FAVORITES);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57     }                                                                                                    </span>
<span  style="">  58                                                                                                          </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  59     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                             </span>
<span class="243733098520730772" onmouseenter="enter('243733098520730772');" onmouseout="out('243733098520730772');" style="">  60             LayoutParserCallback callback, Resources sourceRes, int layoutId, String rootTag,            </span>
<span class="-1443250586800717367" onmouseenter="enter('-1443250586800717367');" onmouseout="out('-1443250586800717367');" style="">  61             int hotseatAllAppsRank) {                                                                    </span>
<span class="7443239544573875424" onmouseenter="enter('7443239544573875424');" onmouseout="out('7443239544573875424');" style="">  62         super(context, appWidgetHost, callback, sourceRes, layoutId, rootTag, hotseatAllAppsRank);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  63     }                                                                                                    </span>
<span  style="">  64                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  65     @Override                                                                                            </span>
<span class="-8135337961010470432" onmouseenter="enter('-8135337961010470432');" onmouseout="out('-8135337961010470432');" style="">  66     protected HashMap&lt;String, TagParser&gt; getFolderElementsMap() {                                        </span>
<span class="423350535395751664" onmouseenter="enter('423350535395751664');" onmouseout="out('423350535395751664');" style="">  67         return getFolderElementsMap(mSourceRes);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  68     }                                                                                                    </span>
<span  style="">  69                                                                                                          </span>
<span class="2700844173783892803" onmouseenter="enter('2700844173783892803');" onmouseout="out('2700844173783892803');" style="">  70     private HashMap&lt;String, TagParser&gt; getFolderElementsMap(Resources res) {                             </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  71         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  72         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-8627156416288422237" onmouseenter="enter('-8627156416288422237');" onmouseout="out('-8627156416288422237');" style="">  73         parsers.put(TAG_SHORTCUT, new UriShortcutParser(res));                                           </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  74         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77     @Override                                                                                            </span>
<span class="7427983078574486125" onmouseenter="enter('7427983078574486125');" onmouseout="out('7427983078574486125');" style="">  78     protected HashMap&lt;String, TagParser&gt; getLayoutElementsMap() {                                        </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  79         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  80         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-2800106172813247359" onmouseenter="enter('-2800106172813247359');" onmouseout="out('-2800106172813247359');" style="">  81         parsers.put(TAG_APPWIDGET, new AppWidgetParser());                                               </span>
<span class="2292493876717618109" onmouseenter="enter('2292493876717618109');" onmouseout="out('2292493876717618109');" style="">  82         parsers.put(TAG_SHORTCUT, new UriShortcutParser(mSourceRes));                                    </span>
<span class="5801084860772407385" onmouseenter="enter('5801084860772407385');" onmouseout="out('5801084860772407385');" style="">  83         parsers.put(TAG_RESOLVE, new ResolveParser());                                                   </span>
<span class="-6794856990865836500" onmouseenter="enter('-6794856990865836500');" onmouseout="out('-6794856990865836500');" style="">  84         parsers.put(TAG_FOLDER, new MyFolderParser());                                                   </span>
<span class="7891389292838004786" onmouseenter="enter('7891389292838004786');" onmouseout="out('7891389292838004786');" style="">  85         parsers.put(TAG_PARTNER_FOLDER, new PartnerFolderParser());                                      </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  86         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87     }                                                                                                    </span>
<span  style="">  88                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  89     @Override                                                                                            </span>
<span class="8392363038715364208" onmouseenter="enter('8392363038715364208');" onmouseout="out('8392363038715364208');" style="">  90     protected void parseContainerAndScreen(XmlResourceParser parser, long[] out) {                       </span>
<span class="-2089348695795856159" onmouseenter="enter('-2089348695795856159');" onmouseout="out('-2089348695795856159');" style="">  91         out[0] = LauncherSettings.Favorites.CONTAINER_DESKTOP;                                           </span>
<span class="-8953477941003932421" onmouseenter="enter('-8953477941003932421');" onmouseout="out('-8953477941003932421');" style="">  92         String strContainer = getAttributeValue(parser, ATTR_CONTAINER);                                 </span>
<span class="4899636274002469854" onmouseenter="enter('4899636274002469854');" onmouseout="out('4899636274002469854');" style="">  93         if (strContainer != null) {                                                                      </span>
<span class="5058638331917318804" onmouseenter="enter('5058638331917318804');" onmouseout="out('5058638331917318804');" style="">  94             out[0] = Long.valueOf(strContainer);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="-7003063245651866001" onmouseenter="enter('-7003063245651866001');" onmouseout="out('-7003063245651866001');" style="">  96         out[1] = Long.parseLong(getAttributeValue(parser, ATTR_SCREEN));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97     }                                                                                                    </span>
<span  style="">  98                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  99     /**                                                                                                  </span>
<span class="176933310960972051" onmouseenter="enter('176933310960972051');" onmouseout="out('176933310960972051');" style=""> 100      * AppShortcutParser which also supports adding URI based intents                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 101      */                                                                                                  </span>
<span class="-1162580724960192627" onmouseenter="enter('-1162580724960192627');" onmouseout="out('-1162580724960192627');" style=""> 102     private class AppShortcutWithUriParser extends AppShortcutParser {                                   </span>
<span  style=""> 103                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 104         @Override                                                                                        </span>
<span class="11443433107327190" onmouseenter="enter('11443433107327190');" onmouseout="out('11443433107327190');" style=""> 105         protected long invalidPackageOrClass(XmlResourceParser parser) {                                 </span>
<span class="-1954941607715586859" onmouseenter="enter('-1954941607715586859');" onmouseout="out('-1954941607715586859');" style=""> 106             final String uri = getAttributeValue(parser, ATTR_URI);                                      </span>
<span class="-2611673916122599069" onmouseenter="enter('-2611673916122599069');" onmouseout="out('-2611673916122599069');" style=""> 107             if (TextUtils.isEmpty(uri)) {                                                                </span>
<span class="-8012351384438033294" onmouseenter="enter('-8012351384438033294');" onmouseout="out('-8012351384438033294');" style=""> 108                 Log.e(TAG, &quot;Skipping invalid &lt;favorite&gt; with no component or uri&quot;);                      </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 109                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110             }                                                                                            </span>
<span  style=""> 111                                                                                                          </span>
<span class="7650863286169434864" onmouseenter="enter('7650863286169434864');" onmouseout="out('7650863286169434864');" style=""> 112             final Intent metaIntent;                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 113             try {                                                                                        </span>
<span class="3494981731706536607" onmouseenter="enter('3494981731706536607');" onmouseout="out('3494981731706536607');" style=""> 114                 metaIntent = Intent.parseUri(uri, 0);                                                    </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 115             } catch (URISyntaxException e) {                                                             </span>
<span class="-948485523889053577" onmouseenter="enter('-948485523889053577');" onmouseout="out('-948485523889053577');" style=""> 116                 Log.e(TAG, &quot;Unable to add meta-favorite: &quot; + uri, e);                                    </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 117                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118             }                                                                                            </span>
<span  style=""> 119                                                                                                          </span>
<span class="8557033759361467860" onmouseenter="enter('8557033759361467860');" onmouseout="out('8557033759361467860');" style=""> 120             ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent,                           </span>
<span class="2456166036476176214" onmouseenter="enter('2456166036476176214');" onmouseout="out('2456166036476176214');" style=""> 121                     PackageManager.MATCH_DEFAULT_ONLY);                                                  </span>
<span class="-1300490748614024222" onmouseenter="enter('-1300490748614024222');" onmouseout="out('-1300490748614024222');" style=""> 122             final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(                     </span>
<span class="8656178102542661668" onmouseenter="enter('8656178102542661668');" onmouseout="out('8656178102542661668');" style=""> 123                     metaIntent, PackageManager.MATCH_DEFAULT_ONLY);                                      </span>
<span  style=""> 124                                                                                                          </span>
<span class="3807468246607352644" onmouseenter="enter('3807468246607352644');" onmouseout="out('3807468246607352644');" style=""> 125             // Verify that the result is an app and not just the resolver dialog asking which            </span>
<span class="3786398014846262159" onmouseenter="enter('3786398014846262159');" onmouseout="out('3786398014846262159');" style=""> 126             // app to use.                                                                               </span>
<span class="-2527999738736768738" onmouseenter="enter('-2527999738736768738');" onmouseout="out('-2527999738736768738');" style=""> 127             if (wouldLaunchResolverActivity(resolved, appList)) {                                        </span>
<span class="-1508864482817632041" onmouseenter="enter('-1508864482817632041');" onmouseout="out('-1508864482817632041');" style=""> 128                 // If only one of the results is a system app then choose that as the default.           </span>
<span class="7096358968319388823" onmouseenter="enter('7096358968319388823');" onmouseout="out('7096358968319388823');" style=""> 129                 final ResolveInfo systemApp = getSingleSystemActivity(appList);                          </span>
<span class="3112641083889325831" onmouseenter="enter('3112641083889325831');" onmouseout="out('3112641083889325831');" style=""> 130                 if (systemApp == null) {                                                                 </span>
<span class="8733485116897338114" onmouseenter="enter('8733485116897338114');" onmouseout="out('8733485116897338114');" style=""> 131                     // There is no logical choice for this meta-favorite, so rather than making          </span>
<span class="-5798817995675177798" onmouseenter="enter('-5798817995675177798');" onmouseout="out('-5798817995675177798');" style=""> 132                     // a bad choice just add nothing.                                                    </span>
<span class="8234306782594839467" onmouseenter="enter('8234306782594839467');" onmouseout="out('8234306782594839467');" style=""> 133                     Log.w(TAG, &quot;No preference or single system activity found for &quot;                      </span>
<span class="-4585840856389419283" onmouseenter="enter('-4585840856389419283');" onmouseout="out('-4585840856389419283');" style=""> 134                             + metaIntent.toString());                                                    </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 135                     return -1;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136                 }                                                                                        </span>
<span class="-2210262899281174552" onmouseenter="enter('-2210262899281174552');" onmouseout="out('-2210262899281174552');" style=""> 137                 resolved = systemApp;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138             }                                                                                            </span>
<span class="3942116430564013468" onmouseenter="enter('3942116430564013468');" onmouseout="out('3942116430564013468');" style=""> 139             final ActivityInfo info = resolved.activityInfo;                                             </span>
<span class="-360088289411741304" onmouseenter="enter('-360088289411741304');" onmouseout="out('-360088289411741304');" style=""> 140             final Intent intent = mPackageManager.getLaunchIntentForPackage(info.packageName);           </span>
<span class="-8400111569787613467" onmouseenter="enter('-8400111569787613467');" onmouseout="out('-8400111569787613467');" style=""> 141             if (intent == null) {                                                                        </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 142                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143             }                                                                                            </span>
<span class="2514039366923723926" onmouseenter="enter('2514039366923723926');" onmouseout="out('2514039366923723926');" style=""> 144             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |                                              </span>
<span class="754211306232040187" onmouseenter="enter('754211306232040187');" onmouseout="out('754211306232040187');" style=""> 145                     Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);                                          </span>
<span  style=""> 146                                                                                                          </span>
<span class="-4701923995052302611" onmouseenter="enter('-4701923995052302611');" onmouseout="out('-4701923995052302611');" style=""> 147             return addShortcut(info.loadLabel(mPackageManager).toString(), intent,                       </span>
<span class="-3250487283659008470" onmouseenter="enter('-3250487283659008470');" onmouseout="out('-3250487283659008470');" style=""> 148                     Favorites.ITEM_TYPE_APPLICATION);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149         }                                                                                                </span>
<span  style=""> 150                                                                                                          </span>
<span class="3433873162423347490" onmouseenter="enter('3433873162423347490');" onmouseout="out('3433873162423347490');" style=""> 151         private ResolveInfo getSingleSystemActivity(List&lt;ResolveInfo&gt; appList) {                         </span>
<span class="4100859717391359582" onmouseenter="enter('4100859717391359582');" onmouseout="out('4100859717391359582');" style=""> 152             ResolveInfo systemResolve = null;                                                            </span>
<span class="-6501614514316220785" onmouseenter="enter('-6501614514316220785');" onmouseout="out('-6501614514316220785');" style=""> 153             final int N = appList.size();                                                                </span>
<span class="-7972660160186921434" onmouseenter="enter('-7972660160186921434');" onmouseout="out('-7972660160186921434');" style=""> 154             for (int i = 0; i &lt; N; ++i) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 155                 try {                                                                                    </span>
<span class="6969736750563256446" onmouseenter="enter('6969736750563256446');" onmouseout="out('6969736750563256446');" style=""> 156                     ApplicationInfo info = mPackageManager.getApplicationInfo(                           </span>
<span class="1402648097889367388" onmouseenter="enter('1402648097889367388');" onmouseout="out('1402648097889367388');" style=""> 157                             appList.get(i).activityInfo.packageName, 0);                                 </span>
<span class="-476381142815111019" onmouseenter="enter('-476381142815111019');" onmouseout="out('-476381142815111019');" style=""> 158                     if ((info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0) {                               </span>
<span class="-6460956471084206715" onmouseenter="enter('-6460956471084206715');" onmouseout="out('-6460956471084206715');" style=""> 159                         if (systemResolve != null) {                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 160                             return null;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 161                         } else {                                                                         </span>
<span class="-1920150334130463709" onmouseenter="enter('-1920150334130463709');" onmouseout="out('-1920150334130463709');" style=""> 162                             systemResolve = appList.get(i);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                     }                                                                                    </span>
<span class="8932842947262589349" onmouseenter="enter('8932842947262589349');" onmouseout="out('8932842947262589349');" style=""> 165                 } catch (PackageManager.NameNotFoundException e) {                                       </span>
<span class="-265560973846634126" onmouseenter="enter('-265560973846634126');" onmouseout="out('-265560973846634126');" style=""> 166                     Log.w(TAG, &quot;Unable to get info about resolve results&quot;, e);                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 167                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169             }                                                                                            </span>
<span class="-7251347768060538731" onmouseenter="enter('-7251347768060538731');" onmouseout="out('-7251347768060538731');" style=""> 170             return systemResolve;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span  style=""> 172                                                                                                          </span>
<span class="-4222771116108434581" onmouseenter="enter('-4222771116108434581');" onmouseout="out('-4222771116108434581');" style=""> 173         private boolean wouldLaunchResolverActivity(ResolveInfo resolved,                                </span>
<span class="8855822793352880756" onmouseenter="enter('8855822793352880756');" onmouseout="out('8855822793352880756');" style=""> 174                 List&lt;ResolveInfo&gt; appList) {                                                             </span>
<span class="-6399418581489152967" onmouseenter="enter('-6399418581489152967');" onmouseout="out('-6399418581489152967');" style=""> 175             // If the list contains the above resolved activity, then it can&#x27;t be                        </span>
<span class="4029821552264897243" onmouseenter="enter('4029821552264897243');" onmouseout="out('4029821552264897243');" style=""> 176             // ResolverActivity itself.                                                                  </span>
<span class="4411552974527624379" onmouseenter="enter('4411552974527624379');" onmouseout="out('4411552974527624379');" style=""> 177             for (int i = 0; i &lt; appList.size(); ++i) {                                                   </span>
<span class="-6814281994408040723" onmouseenter="enter('-6814281994408040723');" onmouseout="out('-6814281994408040723');" style=""> 178                 ResolveInfo tmp = appList.get(i);                                                        </span>
<span class="-3160638667287468420" onmouseenter="enter('-3160638667287468420');" onmouseout="out('-3160638667287468420');" style=""> 179                 if (tmp.activityInfo.name.equals(resolved.activityInfo.name)                             </span>
<span class="6821338150188138172" onmouseenter="enter('6821338150188138172');" onmouseout="out('6821338150188138172');" style=""> 180                         &amp;&amp; tmp.activityInfo.packageName.equals(resolved.activityInfo.packageName)) {     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 181                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 184             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186     }                                                                                                    </span>
<span  style=""> 187                                                                                                          </span>
<span  style=""> 188                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 189     /**                                                                                                  </span>
<span class="1574293742350901037" onmouseenter="enter('1574293742350901037');" onmouseout="out('1574293742350901037');" style=""> 190      * Shortcut parser which allows any uri and not just web urls.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 191      */                                                                                                  </span>
<span class="-1541533161301288894" onmouseenter="enter('-1541533161301288894');" onmouseout="out('-1541533161301288894');" style=""> 192     private class UriShortcutParser extends ShortcutParser {                                             </span>
<span  style=""> 193                                                                                                          </span>
<span class="-44015680663593473" onmouseenter="enter('-44015680663593473');" onmouseout="out('-44015680663593473');" style=""> 194         public UriShortcutParser(Resources iconRes) {                                                    </span>
<span class="-2485453732023871858" onmouseenter="enter('-2485453732023871858');" onmouseout="out('-2485453732023871858');" style=""> 195             super(iconRes);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196         }                                                                                                </span>
<span  style=""> 197                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 198         @Override                                                                                        </span>
<span class="-2889018356529531059" onmouseenter="enter('-2889018356529531059');" onmouseout="out('-2889018356529531059');" style=""> 199         protected Intent parseIntent(XmlResourceParser parser) {                                         </span>
<span class="7870717952219178672" onmouseenter="enter('7870717952219178672');" onmouseout="out('7870717952219178672');" style=""> 200             String uri = null;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 201             try {                                                                                        </span>
<span class="-7650716598670279522" onmouseenter="enter('-7650716598670279522');" onmouseout="out('-7650716598670279522');" style=""> 202                 uri = getAttributeValue(parser, ATTR_URI);                                               </span>
<span class="9146954199733398323" onmouseenter="enter('9146954199733398323');" onmouseout="out('9146954199733398323');" style=""> 203                 return Intent.parseUri(uri, 0);                                                          </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 204             } catch (URISyntaxException e) {                                                             </span>
<span class="-551028723023595678" onmouseenter="enter('-551028723023595678');" onmouseout="out('-551028723023595678');" style=""> 205                 Log.w(TAG, &quot;Shortcut has malformed uri: &quot; + uri);                                        </span>
<span class="6664617886922048676" onmouseenter="enter('6664617886922048676');" onmouseout="out('6664617886922048676');" style=""> 206                 return null; // Oh well                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 211     /**                                                                                                  </span>
<span class="-6891708564780781113" onmouseenter="enter('-6891708564780781113');" onmouseout="out('-6891708564780781113');" style=""> 212      * Contains a list of &lt;favorite&gt; nodes, and accepts the first successfully parsed node.              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 213      */                                                                                                  </span>
<span class="-6360947107494558327" onmouseenter="enter('-6360947107494558327');" onmouseout="out('-6360947107494558327');" style=""> 214     protected class ResolveParser implements TagParser {                                                 </span>
<span  style=""> 215                                                                                                          </span>
<span class="-3602839532613707268" onmouseenter="enter('-3602839532613707268');" onmouseout="out('-3602839532613707268');" style=""> 216         private final AppShortcutWithUriParser mChildParser = new AppShortcutWithUriParser();            </span>
<span  style=""> 217                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 218         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 219         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 220                 IOException {                                                                            </span>
<span class="-7289409140421595237" onmouseenter="enter('-7289409140421595237');" onmouseout="out('-7289409140421595237');" style=""> 221             final int groupDepth = parser.getDepth();                                                    </span>
<span class="3163913122247807134" onmouseenter="enter('3163913122247807134');" onmouseout="out('3163913122247807134');" style=""> 222             int type;                                                                                    </span>
<span class="-3096071360726764577" onmouseenter="enter('-3096071360726764577');" onmouseout="out('-3096071360726764577');" style=""> 223             long addedId = -1;                                                                           </span>
<span class="-2406917717669951461" onmouseenter="enter('-2406917717669951461');" onmouseout="out('-2406917717669951461');" style=""> 224             while ((type = parser.next()) != XmlPullParser.END_TAG ||                                    </span>
<span class="8687802670126733847" onmouseenter="enter('8687802670126733847');" onmouseout="out('8687802670126733847');" style=""> 225                     parser.getDepth() &gt; groupDepth) {                                                    </span>
<span class="-3010059378649710289" onmouseenter="enter('-3010059378649710289');" onmouseout="out('-3010059378649710289');" style=""> 226                 if (type != XmlPullParser.START_TAG || addedId &gt; -1) {                                   </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 227                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228                 }                                                                                        </span>
<span class="-4826163157610997597" onmouseenter="enter('-4826163157610997597');" onmouseout="out('-4826163157610997597');" style=""> 229                 final String fallback_item_name = parser.getName();                                      </span>
<span class="3394509129787922860" onmouseenter="enter('3394509129787922860');" onmouseout="out('3394509129787922860');" style=""> 230                 if (TAG_FAVORITE.equals(fallback_item_name)) {                                           </span>
<span class="-5252464721487850402" onmouseenter="enter('-5252464721487850402');" onmouseout="out('-5252464721487850402');" style=""> 231                     addedId = mChildParser.parseAndAdd(parser);                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 232                 } else {                                                                                 </span>
<span class="-6448281100759930849" onmouseenter="enter('-6448281100759930849');" onmouseout="out('-6448281100759930849');" style=""> 233                     Log.e(TAG, &quot;Fallback groups can contain only favorites, found &quot;                      </span>
<span class="1123550495059434881" onmouseenter="enter('1123550495059434881');" onmouseout="out('1123550495059434881');" style=""> 234                             + fallback_item_name);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236             }                                                                                            </span>
<span class="2168288094559194745" onmouseenter="enter('2168288094559194745');" onmouseout="out('2168288094559194745');" style=""> 237             return addedId;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239     }                                                                                                    </span>
<span  style=""> 240                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 241     /**                                                                                                  </span>
<span class="1579901163323213209" onmouseenter="enter('1579901163323213209');" onmouseout="out('1579901163323213209');" style=""> 242      * A parser which adds a folder whose contents come from partner apk.                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 243      */                                                                                                  </span>
<span class="-2406002401110994608" onmouseenter="enter('-2406002401110994608');" onmouseout="out('-2406002401110994608');" style=""> 244     private class PartnerFolderParser implements TagParser {                                             </span>
<span  style=""> 245                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 246         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 247         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 248                 IOException {                                                                            </span>
<span class="9058192063405184929" onmouseenter="enter('9058192063405184929');" onmouseout="out('9058192063405184929');" style=""> 249             // Folder contents come from an external XML resource                                        </span>
<span class="-6415916158480032673" onmouseenter="enter('-6415916158480032673');" onmouseout="out('-6415916158480032673');" style=""> 250             final Partner partner = Partner.get(mPackageManager);                                        </span>
<span class="-9215364277253785969" onmouseenter="enter('-9215364277253785969');" onmouseout="out('-9215364277253785969');" style=""> 251             if (partner != null) {                                                                       </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 252                 final Resources partnerRes = partner.getResources();                                     </span>
<span class="-8656173913287474605" onmouseenter="enter('-8656173913287474605');" onmouseout="out('-8656173913287474605');" style=""> 253                 final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER,                           </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 254                         &quot;xml&quot;, partner.getPackageName());                                                </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 255                 if (resId != 0) {                                                                        </span>
<span class="5087581180241899012" onmouseenter="enter('5087581180241899012');" onmouseout="out('5087581180241899012');" style=""> 256                     final XmlResourceParser partnerParser = partnerRes.getXml(resId);                    </span>
<span class="7615154974472081807" onmouseenter="enter('7615154974472081807');" onmouseout="out('7615154974472081807');" style=""> 257                     beginDocument(partnerParser, TAG_FOLDER);                                            </span>
<span  style=""> 258                                                                                                          </span>
<span class="8060532263905830482" onmouseenter="enter('8060532263905830482');" onmouseout="out('8060532263905830482');" style=""> 259                     FolderParser folderParser = new FolderParser(getFolderElementsMap(partnerRes));      </span>
<span class="-8238770055449336686" onmouseenter="enter('-8238770055449336686');" onmouseout="out('-8238770055449336686');" style=""> 260                     return folderParser.parseAndAdd(partnerParser);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262             }                                                                                            </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 263             return -1;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 267     /**                                                                                                  </span>
<span class="8278041230656125878" onmouseenter="enter('8278041230656125878');" onmouseout="out('8278041230656125878');" style=""> 268      * An extension of FolderParser which allows adding items from a different xml.                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 269      */                                                                                                  </span>
<span class="-8854772189599396750" onmouseenter="enter('-8854772189599396750');" onmouseout="out('-8854772189599396750');" style=""> 270     private class MyFolderParser extends FolderParser {                                                  </span>
<span  style=""> 271                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 272         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 273         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 274                 IOException {                                                                            </span>
<span class="3231178325674503525" onmouseenter="enter('3231178325674503525');" onmouseout="out('3231178325674503525');" style=""> 275             final int resId = getAttributeResourceValue(parser, ATTR_FOLDER_ITEMS, 0);                   </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 276             if (resId != 0) {                                                                            </span>
<span class="-582766932060535096" onmouseenter="enter('-582766932060535096');" onmouseout="out('-582766932060535096');" style=""> 277                 parser = mSourceRes.getXml(resId);                                                       </span>
<span class="5069593388582006904" onmouseenter="enter('5069593388582006904');" onmouseout="out('5069593388582006904');" style=""> 278                 beginDocument(parser, TAG_FOLDER);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279             }                                                                                            </span>
<span class="-5602508129346726029" onmouseenter="enter('-5602508129346726029');" onmouseout="out('-5602508129346726029');" style=""> 280             return super.parseAndAdd(parser);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283 }                                                                                                        </span></pre></td>
                            <td><pre><span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">   1 package com.android.launcher3;                                                                           </span>
<span  style="">   2                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">   3 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-9183914406029598577" onmouseenter="enter('-9183914406029598577');" onmouseout="out('-9183914406029598577');" style="">   6 import android.content.pm.ActivityInfo;                                                                  </span>
<span class="-841431222158024655" onmouseenter="enter('-841431222158024655');" onmouseout="out('-841431222158024655');" style="">   7 import android.content.pm.ApplicationInfo;                                                               </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   8 import android.content.pm.PackageManager;                                                                </span>
<span class="8582326229770324815" onmouseenter="enter('8582326229770324815');" onmouseout="out('8582326229770324815');" style="">   9 import android.content.pm.ResolveInfo;                                                                   </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  10 import android.content.res.Resources;                                                                    </span>
<span class="7386012112211289620" onmouseenter="enter('7386012112211289620');" onmouseout="out('7386012112211289620');" style="">  11 import android.content.res.XmlResourceParser;                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  12 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  13 import android.util.Log;                                                                                 </span>
<span  style="">  14                                                                                                          </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  15 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span  style="">  16                                                                                                          </span>
<span class="-5145222340437954675" onmouseenter="enter('-5145222340437954675');" onmouseout="out('-5145222340437954675');" style="">  17 import org.xmlpull.v1.XmlPullParser;                                                                     </span>
<span class="-3477173242969633951" onmouseenter="enter('-3477173242969633951');" onmouseout="out('-3477173242969633951');" style="">  18 import org.xmlpull.v1.XmlPullParserException;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  20 import java.io.IOException;                                                                              </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  21 import java.net.URISyntaxException;                                                                      </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  22 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span  style="">  24                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  25 /**                                                                                                      </span>
<span class="8625030305996545010" onmouseenter="enter('8625030305996545010');" onmouseout="out('8625030305996545010');" style="">  26  * Implements the layout parser with rules for internal layouts and partner layouts.                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  27  */                                                                                                      </span>
<span class="-4383609652675664527" onmouseenter="enter('-4383609652675664527');" onmouseout="out('-4383609652675664527');" style="">  28 public class DefaultLayoutParser extends AutoInstallsLayout {                                            </span>
<span class="6838912681597350908" onmouseenter="enter('6838912681597350908');" onmouseout="out('6838912681597350908');" style="">  29     private static final String TAG = &quot;DefaultLayoutParser&quot;;                                             </span>
<span  style="">  30                                                                                                          </span>
<span class="5205878637063247744" onmouseenter="enter('5205878637063247744');" onmouseout="out('5205878637063247744');" style="">  31     protected static final String TAG_RESOLVE = &quot;resolve&quot;;                                               </span>
<span class="-6648556986475948603" onmouseenter="enter('-6648556986475948603');" onmouseout="out('-6648556986475948603');" style="">  32     private static final String TAG_FAVORITES = &quot;favorites&quot;;                                             </span>
<span class="8610360292624390744" onmouseenter="enter('8610360292624390744');" onmouseout="out('8610360292624390744');" style="">  33     protected static final String TAG_FAVORITE = &quot;favorite&quot;;                                             </span>
<span class="8817783213080628620" onmouseenter="enter('8817783213080628620');" onmouseout="out('8817783213080628620');" style="">  34     private static final String TAG_APPWIDGET = &quot;appwidget&quot;;                                             </span>
<span class="1544013162193549447" onmouseenter="enter('1544013162193549447');" onmouseout="out('1544013162193549447');" style="">  35     private static final String TAG_SHORTCUT = &quot;shortcut&quot;;                                               </span>
<span class="-5715927654015021253" onmouseenter="enter('-5715927654015021253');" onmouseout="out('-5715927654015021253');" style="">  36     private static final String TAG_FOLDER = &quot;folder&quot;;                                                   </span>
<span class="-6175494568545371270" onmouseenter="enter('-6175494568545371270');" onmouseout="out('-6175494568545371270');" style="">  37     private static final String TAG_PARTNER_FOLDER = &quot;partner-folder&quot;;                                   </span>
<span  style="">  38                                                                                                          </span>
<span class="-6586268974859869590" onmouseenter="enter('-6586268974859869590');" onmouseout="out('-6586268974859869590');" style="">  39     protected static final String ATTR_URI = &quot;uri&quot;;                                                      </span>
<span class="2414249740748360985" onmouseenter="enter('2414249740748360985');" onmouseout="out('2414249740748360985');" style="">  40     private static final String ATTR_CONTAINER = &quot;container&quot;;                                            </span>
<span class="-389066511444324935" onmouseenter="enter('-389066511444324935');" onmouseout="out('-389066511444324935');" style="">  41     private static final String ATTR_SCREEN = &quot;screen&quot;;                                                  </span>
<span class="1567909548797839052" onmouseenter="enter('1567909548797839052');" onmouseout="out('1567909548797839052');" style="">  42     private static final String ATTR_FOLDER_ITEMS = &quot;folderItems&quot;;                                       </span>
<span  style="">  43                                                                                                          </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  44     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                             </span>
<span class="2852391764281860202" onmouseenter="enter('2852391764281860202');" onmouseout="out('2852391764281860202');" style="">  45             LayoutParserCallback callback, Resources sourceRes, int layoutId) {                          </span>
<span class="7279694431066637071" onmouseenter="enter('7279694431066637071');" onmouseout="out('7279694431066637071');" style="">  46         super(context, appWidgetHost, callback, sourceRes, layoutId, TAG_FAVORITES);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  47     }                                                                                                    </span>
<span  style="">  48                                                                                                          </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  49     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                             </span>
<span class="243733098520730772" onmouseenter="enter('243733098520730772');" onmouseout="out('243733098520730772');" style="">  50             LayoutParserCallback callback, Resources sourceRes, int layoutId, String rootTag,            </span>
<span class="-1443250586800717367" onmouseenter="enter('-1443250586800717367');" onmouseout="out('-1443250586800717367');" style="">  51             int hotseatAllAppsRank) {                                                                    </span>
<span class="7443239544573875424" onmouseenter="enter('7443239544573875424');" onmouseout="out('7443239544573875424');" style="">  52         super(context, appWidgetHost, callback, sourceRes, layoutId, rootTag, hotseatAllAppsRank);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53     }                                                                                                    </span>
<span  style="">  54                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  55     @Override                                                                                            </span>
<span class="-8135337961010470432" onmouseenter="enter('-8135337961010470432');" onmouseout="out('-8135337961010470432');" style="">  56     protected HashMap&lt;String, TagParser&gt; getFolderElementsMap() {                                        </span>
<span class="423350535395751664" onmouseenter="enter('423350535395751664');" onmouseout="out('423350535395751664');" style="">  57         return getFolderElementsMap(mSourceRes);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58     }                                                                                                    </span>
<span  style="">  59                                                                                                          </span>
<span class="2700844173783892803" onmouseenter="enter('2700844173783892803');" onmouseout="out('2700844173783892803');" style="">  60     private HashMap&lt;String, TagParser&gt; getFolderElementsMap(Resources res) {                             </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  61         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  62         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-8627156416288422237" onmouseenter="enter('-8627156416288422237');" onmouseout="out('-8627156416288422237');" style="">  63         parsers.put(TAG_SHORTCUT, new UriShortcutParser(res));                                           </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  64         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65     }                                                                                                    </span>
<span  style="">  66                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  67     @Override                                                                                            </span>
<span class="7427983078574486125" onmouseenter="enter('7427983078574486125');" onmouseout="out('7427983078574486125');" style="">  68     protected HashMap&lt;String, TagParser&gt; getLayoutElementsMap() {                                        </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  69         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  70         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-2800106172813247359" onmouseenter="enter('-2800106172813247359');" onmouseout="out('-2800106172813247359');" style="">  71         parsers.put(TAG_APPWIDGET, new AppWidgetParser());                                               </span>
<span class="2292493876717618109" onmouseenter="enter('2292493876717618109');" onmouseout="out('2292493876717618109');" style="">  72         parsers.put(TAG_SHORTCUT, new UriShortcutParser(mSourceRes));                                    </span>
<span class="5801084860772407385" onmouseenter="enter('5801084860772407385');" onmouseout="out('5801084860772407385');" style="">  73         parsers.put(TAG_RESOLVE, new ResolveParser());                                                   </span>
<span class="-6794856990865836500" onmouseenter="enter('-6794856990865836500');" onmouseout="out('-6794856990865836500');" style="">  74         parsers.put(TAG_FOLDER, new MyFolderParser());                                                   </span>
<span class="7891389292838004786" onmouseenter="enter('7891389292838004786');" onmouseout="out('7891389292838004786');" style="">  75         parsers.put(TAG_PARTNER_FOLDER, new PartnerFolderParser());                                      </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  76         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span  style="">  78                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  79     @Override                                                                                            </span>
<span class="8392363038715364208" onmouseenter="enter('8392363038715364208');" onmouseout="out('8392363038715364208');" style="">  80     protected void parseContainerAndScreen(XmlResourceParser parser, long[] out) {                       </span>
<span class="-2089348695795856159" onmouseenter="enter('-2089348695795856159');" onmouseout="out('-2089348695795856159');" style="">  81         out[0] = LauncherSettings.Favorites.CONTAINER_DESKTOP;                                           </span>
<span class="-8953477941003932421" onmouseenter="enter('-8953477941003932421');" onmouseout="out('-8953477941003932421');" style="">  82         String strContainer = getAttributeValue(parser, ATTR_CONTAINER);                                 </span>
<span class="4899636274002469854" onmouseenter="enter('4899636274002469854');" onmouseout="out('4899636274002469854');" style="">  83         if (strContainer != null) {                                                                      </span>
<span class="5058638331917318804" onmouseenter="enter('5058638331917318804');" onmouseout="out('5058638331917318804');" style="">  84             out[0] = Long.valueOf(strContainer);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85         }                                                                                                </span>
<span class="-7003063245651866001" onmouseenter="enter('-7003063245651866001');" onmouseout="out('-7003063245651866001');" style="">  86         out[1] = Long.parseLong(getAttributeValue(parser, ATTR_SCREEN));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87     }                                                                                                    </span>
<span  style="">  88                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  89     /**                                                                                                  </span>
<span class="176933310960972051" onmouseenter="enter('176933310960972051');" onmouseout="out('176933310960972051');" style="">  90      * AppShortcutParser which also supports adding URI based intents                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91      */                                                                                                  </span>
<span class="-1162580724960192627" onmouseenter="enter('-1162580724960192627');" onmouseout="out('-1162580724960192627');" style="">  92     private class AppShortcutWithUriParser extends AppShortcutParser {                                   </span>
<span  style="">  93                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  94         @Override                                                                                        </span>
<span class="11443433107327190" onmouseenter="enter('11443433107327190');" onmouseout="out('11443433107327190');" style="">  95         protected long invalidPackageOrClass(XmlResourceParser parser) {                                 </span>
<span class="-1954941607715586859" onmouseenter="enter('-1954941607715586859');" onmouseout="out('-1954941607715586859');" style="">  96             final String uri = getAttributeValue(parser, ATTR_URI);                                      </span>
<span class="-2611673916122599069" onmouseenter="enter('-2611673916122599069');" onmouseout="out('-2611673916122599069');" style="">  97             if (TextUtils.isEmpty(uri)) {                                                                </span>
<span class="-8012351384438033294" onmouseenter="enter('-8012351384438033294');" onmouseout="out('-8012351384438033294');" style="">  98                 Log.e(TAG, &quot;Skipping invalid &lt;favorite&gt; with no component or uri&quot;);                      </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style="">  99                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100             }                                                                                            </span>
<span  style=""> 101                                                                                                          </span>
<span class="7650863286169434864" onmouseenter="enter('7650863286169434864');" onmouseout="out('7650863286169434864');" style=""> 102             final Intent metaIntent;                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 103             try {                                                                                        </span>
<span class="3494981731706536607" onmouseenter="enter('3494981731706536607');" onmouseout="out('3494981731706536607');" style=""> 104                 metaIntent = Intent.parseUri(uri, 0);                                                    </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 105             } catch (URISyntaxException e) {                                                             </span>
<span class="-948485523889053577" onmouseenter="enter('-948485523889053577');" onmouseout="out('-948485523889053577');" style=""> 106                 Log.e(TAG, &quot;Unable to add meta-favorite: &quot; + uri, e);                                    </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 107                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108             }                                                                                            </span>
<span  style=""> 109                                                                                                          </span>
<span class="8557033759361467860" onmouseenter="enter('8557033759361467860');" onmouseout="out('8557033759361467860');" style=""> 110             ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent,                           </span>
<span class="2456166036476176214" onmouseenter="enter('2456166036476176214');" onmouseout="out('2456166036476176214');" style=""> 111                     PackageManager.MATCH_DEFAULT_ONLY);                                                  </span>
<span class="-1300490748614024222" onmouseenter="enter('-1300490748614024222');" onmouseout="out('-1300490748614024222');" style=""> 112             final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(                     </span>
<span class="8656178102542661668" onmouseenter="enter('8656178102542661668');" onmouseout="out('8656178102542661668');" style=""> 113                     metaIntent, PackageManager.MATCH_DEFAULT_ONLY);                                      </span>
<span  style=""> 114                                                                                                          </span>
<span class="3807468246607352644" onmouseenter="enter('3807468246607352644');" onmouseout="out('3807468246607352644');" style=""> 115             // Verify that the result is an app and not just the resolver dialog asking which            </span>
<span class="3786398014846262159" onmouseenter="enter('3786398014846262159');" onmouseout="out('3786398014846262159');" style=""> 116             // app to use.                                                                               </span>
<span class="-2527999738736768738" onmouseenter="enter('-2527999738736768738');" onmouseout="out('-2527999738736768738');" style=""> 117             if (wouldLaunchResolverActivity(resolved, appList)) {                                        </span>
<span class="-1508864482817632041" onmouseenter="enter('-1508864482817632041');" onmouseout="out('-1508864482817632041');" style=""> 118                 // If only one of the results is a system app then choose that as the default.           </span>
<span class="7096358968319388823" onmouseenter="enter('7096358968319388823');" onmouseout="out('7096358968319388823');" style=""> 119                 final ResolveInfo systemApp = getSingleSystemActivity(appList);                          </span>
<span class="3112641083889325831" onmouseenter="enter('3112641083889325831');" onmouseout="out('3112641083889325831');" style=""> 120                 if (systemApp == null) {                                                                 </span>
<span class="8733485116897338114" onmouseenter="enter('8733485116897338114');" onmouseout="out('8733485116897338114');" style=""> 121                     // There is no logical choice for this meta-favorite, so rather than making          </span>
<span class="-5798817995675177798" onmouseenter="enter('-5798817995675177798');" onmouseout="out('-5798817995675177798');" style=""> 122                     // a bad choice just add nothing.                                                    </span>
<span class="8234306782594839467" onmouseenter="enter('8234306782594839467');" onmouseout="out('8234306782594839467');" style=""> 123                     Log.w(TAG, &quot;No preference or single system activity found for &quot;                      </span>
<span class="-4585840856389419283" onmouseenter="enter('-4585840856389419283');" onmouseout="out('-4585840856389419283');" style=""> 124                             + metaIntent.toString());                                                    </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 125                     return -1;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126                 }                                                                                        </span>
<span class="-2210262899281174552" onmouseenter="enter('-2210262899281174552');" onmouseout="out('-2210262899281174552');" style=""> 127                 resolved = systemApp;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128             }                                                                                            </span>
<span class="3942116430564013468" onmouseenter="enter('3942116430564013468');" onmouseout="out('3942116430564013468');" style=""> 129             final ActivityInfo info = resolved.activityInfo;                                             </span>
<span class="-360088289411741304" onmouseenter="enter('-360088289411741304');" onmouseout="out('-360088289411741304');" style=""> 130             final Intent intent = mPackageManager.getLaunchIntentForPackage(info.packageName);           </span>
<span class="-8400111569787613467" onmouseenter="enter('-8400111569787613467');" onmouseout="out('-8400111569787613467');" style=""> 131             if (intent == null) {                                                                        </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 132                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133             }                                                                                            </span>
<span class="2514039366923723926" onmouseenter="enter('2514039366923723926');" onmouseout="out('2514039366923723926');" style=""> 134             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |                                              </span>
<span class="754211306232040187" onmouseenter="enter('754211306232040187');" onmouseout="out('754211306232040187');" style=""> 135                     Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);                                          </span>
<span  style=""> 136                                                                                                          </span>
<span class="-4701923995052302611" onmouseenter="enter('-4701923995052302611');" onmouseout="out('-4701923995052302611');" style=""> 137             return addShortcut(info.loadLabel(mPackageManager).toString(), intent,                       </span>
<span class="-3250487283659008470" onmouseenter="enter('-3250487283659008470');" onmouseout="out('-3250487283659008470');" style=""> 138                     Favorites.ITEM_TYPE_APPLICATION);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139         }                                                                                                </span>
<span  style=""> 140                                                                                                          </span>
<span class="3433873162423347490" onmouseenter="enter('3433873162423347490');" onmouseout="out('3433873162423347490');" style=""> 141         private ResolveInfo getSingleSystemActivity(List&lt;ResolveInfo&gt; appList) {                         </span>
<span class="4100859717391359582" onmouseenter="enter('4100859717391359582');" onmouseout="out('4100859717391359582');" style=""> 142             ResolveInfo systemResolve = null;                                                            </span>
<span class="-6501614514316220785" onmouseenter="enter('-6501614514316220785');" onmouseout="out('-6501614514316220785');" style=""> 143             final int N = appList.size();                                                                </span>
<span class="-7972660160186921434" onmouseenter="enter('-7972660160186921434');" onmouseout="out('-7972660160186921434');" style=""> 144             for (int i = 0; i &lt; N; ++i) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 145                 try {                                                                                    </span>
<span class="6969736750563256446" onmouseenter="enter('6969736750563256446');" onmouseout="out('6969736750563256446');" style=""> 146                     ApplicationInfo info = mPackageManager.getApplicationInfo(                           </span>
<span class="1402648097889367388" onmouseenter="enter('1402648097889367388');" onmouseout="out('1402648097889367388');" style=""> 147                             appList.get(i).activityInfo.packageName, 0);                                 </span>
<span class="-476381142815111019" onmouseenter="enter('-476381142815111019');" onmouseout="out('-476381142815111019');" style=""> 148                     if ((info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0) {                               </span>
<span class="-6460956471084206715" onmouseenter="enter('-6460956471084206715');" onmouseout="out('-6460956471084206715');" style=""> 149                         if (systemResolve != null) {                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 150                             return null;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 151                         } else {                                                                         </span>
<span class="-1920150334130463709" onmouseenter="enter('-1920150334130463709');" onmouseout="out('-1920150334130463709');" style=""> 152                             systemResolve = appList.get(i);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                     }                                                                                    </span>
<span class="8932842947262589349" onmouseenter="enter('8932842947262589349');" onmouseout="out('8932842947262589349');" style=""> 155                 } catch (PackageManager.NameNotFoundException e) {                                       </span>
<span class="-265560973846634126" onmouseenter="enter('-265560973846634126');" onmouseout="out('-265560973846634126');" style=""> 156                     Log.w(TAG, &quot;Unable to get info about resolve results&quot;, e);                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 157                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159             }                                                                                            </span>
<span class="-7251347768060538731" onmouseenter="enter('-7251347768060538731');" onmouseout="out('-7251347768060538731');" style=""> 160             return systemResolve;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span  style=""> 162                                                                                                          </span>
<span class="-4222771116108434581" onmouseenter="enter('-4222771116108434581');" onmouseout="out('-4222771116108434581');" style=""> 163         private boolean wouldLaunchResolverActivity(ResolveInfo resolved,                                </span>
<span class="8855822793352880756" onmouseenter="enter('8855822793352880756');" onmouseout="out('8855822793352880756');" style=""> 164                 List&lt;ResolveInfo&gt; appList) {                                                             </span>
<span class="-6399418581489152967" onmouseenter="enter('-6399418581489152967');" onmouseout="out('-6399418581489152967');" style=""> 165             // If the list contains the above resolved activity, then it can&#x27;t be                        </span>
<span class="4029821552264897243" onmouseenter="enter('4029821552264897243');" onmouseout="out('4029821552264897243');" style=""> 166             // ResolverActivity itself.                                                                  </span>
<span class="4411552974527624379" onmouseenter="enter('4411552974527624379');" onmouseout="out('4411552974527624379');" style=""> 167             for (int i = 0; i &lt; appList.size(); ++i) {                                                   </span>
<span class="-6814281994408040723" onmouseenter="enter('-6814281994408040723');" onmouseout="out('-6814281994408040723');" style=""> 168                 ResolveInfo tmp = appList.get(i);                                                        </span>
<span class="-3160638667287468420" onmouseenter="enter('-3160638667287468420');" onmouseout="out('-3160638667287468420');" style=""> 169                 if (tmp.activityInfo.name.equals(resolved.activityInfo.name)                             </span>
<span class="6821338150188138172" onmouseenter="enter('6821338150188138172');" onmouseout="out('6821338150188138172');" style=""> 170                         &amp;&amp; tmp.activityInfo.packageName.equals(resolved.activityInfo.packageName)) {     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 171                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 174             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span  style=""> 177                                                                                                          </span>
<span  style=""> 178                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 179     /**                                                                                                  </span>
<span class="1574293742350901037" onmouseenter="enter('1574293742350901037');" onmouseout="out('1574293742350901037');" style=""> 180      * Shortcut parser which allows any uri and not just web urls.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 181      */                                                                                                  </span>
<span class="-1541533161301288894" onmouseenter="enter('-1541533161301288894');" onmouseout="out('-1541533161301288894');" style=""> 182     private class UriShortcutParser extends ShortcutParser {                                             </span>
<span  style=""> 183                                                                                                          </span>
<span class="-44015680663593473" onmouseenter="enter('-44015680663593473');" onmouseout="out('-44015680663593473');" style=""> 184         public UriShortcutParser(Resources iconRes) {                                                    </span>
<span class="-2485453732023871858" onmouseenter="enter('-2485453732023871858');" onmouseout="out('-2485453732023871858');" style=""> 185             super(iconRes);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span  style=""> 187                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 188         @Override                                                                                        </span>
<span class="-2889018356529531059" onmouseenter="enter('-2889018356529531059');" onmouseout="out('-2889018356529531059');" style=""> 189         protected Intent parseIntent(XmlResourceParser parser) {                                         </span>
<span class="7870717952219178672" onmouseenter="enter('7870717952219178672');" onmouseout="out('7870717952219178672');" style=""> 190             String uri = null;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 191             try {                                                                                        </span>
<span class="-7650716598670279522" onmouseenter="enter('-7650716598670279522');" onmouseout="out('-7650716598670279522');" style=""> 192                 uri = getAttributeValue(parser, ATTR_URI);                                               </span>
<span class="9146954199733398323" onmouseenter="enter('9146954199733398323');" onmouseout="out('9146954199733398323');" style=""> 193                 return Intent.parseUri(uri, 0);                                                          </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 194             } catch (URISyntaxException e) {                                                             </span>
<span class="-551028723023595678" onmouseenter="enter('-551028723023595678');" onmouseout="out('-551028723023595678');" style=""> 195                 Log.w(TAG, &quot;Shortcut has malformed uri: &quot; + uri);                                        </span>
<span class="6664617886922048676" onmouseenter="enter('6664617886922048676');" onmouseout="out('6664617886922048676');" style=""> 196                 return null; // Oh well                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 201     /**                                                                                                  </span>
<span class="-6891708564780781113" onmouseenter="enter('-6891708564780781113');" onmouseout="out('-6891708564780781113');" style=""> 202      * Contains a list of &lt;favorite&gt; nodes, and accepts the first successfully parsed node.              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 203      */                                                                                                  </span>
<span class="-6360947107494558327" onmouseenter="enter('-6360947107494558327');" onmouseout="out('-6360947107494558327');" style=""> 204     protected class ResolveParser implements TagParser {                                                 </span>
<span  style=""> 205                                                                                                          </span>
<span class="-3602839532613707268" onmouseenter="enter('-3602839532613707268');" onmouseout="out('-3602839532613707268');" style=""> 206         private final AppShortcutWithUriParser mChildParser = new AppShortcutWithUriParser();            </span>
<span  style=""> 207                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 208         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 209         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 210                 IOException {                                                                            </span>
<span class="-7289409140421595237" onmouseenter="enter('-7289409140421595237');" onmouseout="out('-7289409140421595237');" style=""> 211             final int groupDepth = parser.getDepth();                                                    </span>
<span class="3163913122247807134" onmouseenter="enter('3163913122247807134');" onmouseout="out('3163913122247807134');" style=""> 212             int type;                                                                                    </span>
<span class="-3096071360726764577" onmouseenter="enter('-3096071360726764577');" onmouseout="out('-3096071360726764577');" style=""> 213             long addedId = -1;                                                                           </span>
<span class="-2406917717669951461" onmouseenter="enter('-2406917717669951461');" onmouseout="out('-2406917717669951461');" style=""> 214             while ((type = parser.next()) != XmlPullParser.END_TAG ||                                    </span>
<span class="8687802670126733847" onmouseenter="enter('8687802670126733847');" onmouseout="out('8687802670126733847');" style=""> 215                     parser.getDepth() &gt; groupDepth) {                                                    </span>
<span class="-3010059378649710289" onmouseenter="enter('-3010059378649710289');" onmouseout="out('-3010059378649710289');" style=""> 216                 if (type != XmlPullParser.START_TAG || addedId &gt; -1) {                                   </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 217                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218                 }                                                                                        </span>
<span class="-4826163157610997597" onmouseenter="enter('-4826163157610997597');" onmouseout="out('-4826163157610997597');" style=""> 219                 final String fallback_item_name = parser.getName();                                      </span>
<span class="3394509129787922860" onmouseenter="enter('3394509129787922860');" onmouseout="out('3394509129787922860');" style=""> 220                 if (TAG_FAVORITE.equals(fallback_item_name)) {                                           </span>
<span class="-5252464721487850402" onmouseenter="enter('-5252464721487850402');" onmouseout="out('-5252464721487850402');" style=""> 221                     addedId = mChildParser.parseAndAdd(parser);                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 222                 } else {                                                                                 </span>
<span class="-6448281100759930849" onmouseenter="enter('-6448281100759930849');" onmouseout="out('-6448281100759930849');" style=""> 223                     Log.e(TAG, &quot;Fallback groups can contain only favorites, found &quot;                      </span>
<span class="1123550495059434881" onmouseenter="enter('1123550495059434881');" onmouseout="out('1123550495059434881');" style=""> 224                             + fallback_item_name);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226             }                                                                                            </span>
<span class="2168288094559194745" onmouseenter="enter('2168288094559194745');" onmouseout="out('2168288094559194745');" style=""> 227             return addedId;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229     }                                                                                                    </span>
<span  style=""> 230                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 231     /**                                                                                                  </span>
<span class="1579901163323213209" onmouseenter="enter('1579901163323213209');" onmouseout="out('1579901163323213209');" style=""> 232      * A parser which adds a folder whose contents come from partner apk.                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 233      */                                                                                                  </span>
<span class="-2406002401110994608" onmouseenter="enter('-2406002401110994608');" onmouseout="out('-2406002401110994608');" style=""> 234     private class PartnerFolderParser implements TagParser {                                             </span>
<span  style=""> 235                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 237         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 238                 IOException {                                                                            </span>
<span class="9058192063405184929" onmouseenter="enter('9058192063405184929');" onmouseout="out('9058192063405184929');" style=""> 239             // Folder contents come from an external XML resource                                        </span>
<span class="-6415916158480032673" onmouseenter="enter('-6415916158480032673');" onmouseout="out('-6415916158480032673');" style=""> 240             final Partner partner = Partner.get(mPackageManager);                                        </span>
<span class="-9215364277253785969" onmouseenter="enter('-9215364277253785969');" onmouseout="out('-9215364277253785969');" style=""> 241             if (partner != null) {                                                                       </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 242                 final Resources partnerRes = partner.getResources();                                     </span>
<span class="-8656173913287474605" onmouseenter="enter('-8656173913287474605');" onmouseout="out('-8656173913287474605');" style=""> 243                 final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER,                           </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 244                         &quot;xml&quot;, partner.getPackageName());                                                </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 245                 if (resId != 0) {                                                                        </span>
<span class="5087581180241899012" onmouseenter="enter('5087581180241899012');" onmouseout="out('5087581180241899012');" style=""> 246                     final XmlResourceParser partnerParser = partnerRes.getXml(resId);                    </span>
<span class="7615154974472081807" onmouseenter="enter('7615154974472081807');" onmouseout="out('7615154974472081807');" style=""> 247                     beginDocument(partnerParser, TAG_FOLDER);                                            </span>
<span  style=""> 248                                                                                                          </span>
<span class="8060532263905830482" onmouseenter="enter('8060532263905830482');" onmouseout="out('8060532263905830482');" style=""> 249                     FolderParser folderParser = new FolderParser(getFolderElementsMap(partnerRes));      </span>
<span class="-8238770055449336686" onmouseenter="enter('-8238770055449336686');" onmouseout="out('-8238770055449336686');" style=""> 250                     return folderParser.parseAndAdd(partnerParser);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 253             return -1;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255     }                                                                                                    </span>
<span  style=""> 256                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 257     /**                                                                                                  </span>
<span class="8278041230656125878" onmouseenter="enter('8278041230656125878');" onmouseout="out('8278041230656125878');" style=""> 258      * An extension of FolderParser which allows adding items from a different xml.                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259      */                                                                                                  </span>
<span class="-8854772189599396750" onmouseenter="enter('-8854772189599396750');" onmouseout="out('-8854772189599396750');" style=""> 260     private class MyFolderParser extends FolderParser {                                                  </span>
<span  style=""> 261                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 262         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 263         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 264                 IOException {                                                                            </span>
<span class="3231178325674503525" onmouseenter="enter('3231178325674503525');" onmouseout="out('3231178325674503525');" style=""> 265             final int resId = getAttributeResourceValue(parser, ATTR_FOLDER_ITEMS, 0);                   </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 266             if (resId != 0) {                                                                            </span>
<span class="-582766932060535096" onmouseenter="enter('-582766932060535096');" onmouseout="out('-582766932060535096');" style=""> 267                 parser = mSourceRes.getXml(resId);                                                       </span>
<span class="5069593388582006904" onmouseenter="enter('5069593388582006904');" onmouseout="out('5069593388582006904');" style=""> 268                 beginDocument(parser, TAG_FOLDER);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269             }                                                                                            </span>
<span class="-5602508129346726029" onmouseenter="enter('-5602508129346726029');" onmouseout="out('-5602508129346726029');" style=""> 270             return super.parseAndAdd(parser);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273 }                                                                                                        </span>








</pre></td>
                            <td><pre><span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">   1 package com.android.launcher3;                                                                           </span>
<span  style="">   2                                                                                                          </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">   3 import android.appwidget.AppWidgetHost;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5 import android.content.Intent;                                                                           </span>
<span class="-9183914406029598577" onmouseenter="enter('-9183914406029598577');" onmouseout="out('-9183914406029598577');" style="">   6 import android.content.pm.ActivityInfo;                                                                  </span>
<span class="-841431222158024655" onmouseenter="enter('-841431222158024655');" onmouseout="out('-841431222158024655');" style="">   7 import android.content.pm.ApplicationInfo;                                                               </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   8 import android.content.pm.PackageManager;                                                                </span>
<span class="8582326229770324815" onmouseenter="enter('8582326229770324815');" onmouseout="out('8582326229770324815');" style="">   9 import android.content.pm.ResolveInfo;                                                                   </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  10 import android.content.res.Resources;                                                                    </span>
<span class="7386012112211289620" onmouseenter="enter('7386012112211289620');" onmouseout="out('7386012112211289620');" style="">  11 import android.content.res.XmlResourceParser;                                                            </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  12 import android.text.TextUtils;                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  13 import android.util.Log;                                                                                 </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  14 import com.android.launcher3.LauncherSettings.Favorites;                                                 </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  15 import java.io.IOException;                                                                              </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  16 import java.net.URISyntaxException;                                                                      </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  17 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  18 import java.util.List;                                                                                   </span>
<span class="-5145222340437954675" onmouseenter="enter('-5145222340437954675');" onmouseout="out('-5145222340437954675');" style="">  19 import org.xmlpull.v1.XmlPullParser;                                                                     </span>
<span class="-3477173242969633951" onmouseenter="enter('-3477173242969633951');" onmouseout="out('-3477173242969633951');" style="">  20 import org.xmlpull.v1.XmlPullParserException;                                                            </span>
<span  style="">  21                                                                                                          </span>
<span  style="">  22                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  23 /**                                                                                                      </span>
<span class="8625030305996545010" onmouseenter="enter('8625030305996545010');" onmouseout="out('8625030305996545010');" style="">  24  * Implements the layout parser with rules for internal layouts and partner layouts.                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  25  */                                                                                                      </span>
<span class="-4383609652675664527" onmouseenter="enter('-4383609652675664527');" onmouseout="out('-4383609652675664527');" style="">  26 public class DefaultLayoutParser extends AutoInstallsLayout {                                            </span>
<span class="6838912681597350908" onmouseenter="enter('6838912681597350908');" onmouseout="out('6838912681597350908');" style="">  27     private static final String TAG = &quot;DefaultLayoutParser&quot;;                                             </span>
<span  style="">  28                                                                                                          </span>
<span class="5205878637063247744" onmouseenter="enter('5205878637063247744');" onmouseout="out('5205878637063247744');" style="">  29     protected static final String TAG_RESOLVE = &quot;resolve&quot;;                                               </span>
<span  style="">  30                                                                                                          </span>
<span class="-6648556986475948603" onmouseenter="enter('-6648556986475948603');" onmouseout="out('-6648556986475948603');" style="">  31     private static final String TAG_FAVORITES = &quot;favorites&quot;;                                             </span>
<span  style="">  32                                                                                                          </span>
<span class="8610360292624390744" onmouseenter="enter('8610360292624390744');" onmouseout="out('8610360292624390744');" style="">  33     protected static final String TAG_FAVORITE = &quot;favorite&quot;;                                             </span>
<span  style="">  34                                                                                                          </span>
<span class="8817783213080628620" onmouseenter="enter('8817783213080628620');" onmouseout="out('8817783213080628620');" style="">  35     private static final String TAG_APPWIDGET = &quot;appwidget&quot;;                                             </span>
<span  style="">  36                                                                                                          </span>
<span class="1544013162193549447" onmouseenter="enter('1544013162193549447');" onmouseout="out('1544013162193549447');" style="">  37     private static final String TAG_SHORTCUT = &quot;shortcut&quot;;                                               </span>
<span  style="">  38                                                                                                          </span>
<span class="-5715927654015021253" onmouseenter="enter('-5715927654015021253');" onmouseout="out('-5715927654015021253');" style="">  39     private static final String TAG_FOLDER = &quot;folder&quot;;                                                   </span>
<span  style="">  40                                                                                                          </span>
<span class="-6175494568545371270" onmouseenter="enter('-6175494568545371270');" onmouseout="out('-6175494568545371270');" style="">  41     private static final String TAG_PARTNER_FOLDER = &quot;partner-folder&quot;;                                   </span>
<span  style="">  42                                                                                                          </span>
<span class="-6586268974859869590" onmouseenter="enter('-6586268974859869590');" onmouseout="out('-6586268974859869590');" style="">  43     protected static final String ATTR_URI = &quot;uri&quot;;                                                      </span>
<span  style="">  44                                                                                                          </span>
<span class="2414249740748360985" onmouseenter="enter('2414249740748360985');" onmouseout="out('2414249740748360985');" style="">  45     private static final String ATTR_CONTAINER = &quot;container&quot;;                                            </span>
<span  style="">  46                                                                                                          </span>
<span class="-389066511444324935" onmouseenter="enter('-389066511444324935');" onmouseout="out('-389066511444324935');" style="">  47     private static final String ATTR_SCREEN = &quot;screen&quot;;                                                  </span>
<span  style="">  48                                                                                                          </span>
<span class="1567909548797839052" onmouseenter="enter('1567909548797839052');" onmouseout="out('1567909548797839052');" style="">  49     private static final String ATTR_FOLDER_ITEMS = &quot;folderItems&quot;;                                       </span>
<span  style="">  50                                                                                                          </span>
<span class="-4668627282585794339" onmouseenter="enter('-4668627282585794339');" onmouseout="out('-4668627282585794339');" style=""><abbr title="  51     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost, LayoutParserCallback callback, Resources sourceRes, int layoutId) {">  51     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost, LayoutParserCallback callbac</abbr></span>
<span class="7279694431066637071" onmouseenter="enter('7279694431066637071');" onmouseout="out('7279694431066637071');" style="">  52         super(context, appWidgetHost, callback, sourceRes, layoutId, TAG_FAVORITES);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53     }                                                                                                    </span>
<span  style="">  54                                                                                                          </span>
<span class="6767798503451827155" onmouseenter="enter('6767798503451827155');" onmouseout="out('6767798503451827155');" style=""><abbr title="  55     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost, LayoutParserCallback callback, Resources sourceRes, int layoutId, String rootTag, int hotseatAllAppsRank) {">  55     public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost, LayoutParserCallback callbac</abbr></span>
<span class="7443239544573875424" onmouseenter="enter('7443239544573875424');" onmouseout="out('7443239544573875424');" style="">  56         super(context, appWidgetHost, callback, sourceRes, layoutId, rootTag, hotseatAllAppsRank);       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57     }                                                                                                    </span>
<span  style="">  58                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  59     @Override                                                                                            </span>
<span class="-8135337961010470432" onmouseenter="enter('-8135337961010470432');" onmouseout="out('-8135337961010470432');" style="">  60     protected HashMap&lt;String, TagParser&gt; getFolderElementsMap() {                                        </span>
<span class="423350535395751664" onmouseenter="enter('423350535395751664');" onmouseout="out('423350535395751664');" style="">  61         return getFolderElementsMap(mSourceRes);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62     }                                                                                                    </span>
<span  style="">  63                                                                                                          </span>
<span class="2700844173783892803" onmouseenter="enter('2700844173783892803');" onmouseout="out('2700844173783892803');" style="">  64     private HashMap&lt;String, TagParser&gt; getFolderElementsMap(Resources res) {                             </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  65         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  66         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-8627156416288422237" onmouseenter="enter('-8627156416288422237');" onmouseout="out('-8627156416288422237');" style="">  67         parsers.put(TAG_SHORTCUT, new UriShortcutParser(res));                                           </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  68         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69     }                                                                                                    </span>
<span  style="">  70                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  71     @Override                                                                                            </span>
<span class="7427983078574486125" onmouseenter="enter('7427983078574486125');" onmouseout="out('7427983078574486125');" style="">  72     protected HashMap&lt;String, TagParser&gt; getLayoutElementsMap() {                                        </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  73         HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                           </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  74         parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                       </span>
<span class="-2800106172813247359" onmouseenter="enter('-2800106172813247359');" onmouseout="out('-2800106172813247359');" style="">  75         parsers.put(TAG_APPWIDGET, new AppWidgetParser());                                               </span>
<span class="2292493876717618109" onmouseenter="enter('2292493876717618109');" onmouseout="out('2292493876717618109');" style="">  76         parsers.put(TAG_SHORTCUT, new UriShortcutParser(mSourceRes));                                    </span>
<span class="5801084860772407385" onmouseenter="enter('5801084860772407385');" onmouseout="out('5801084860772407385');" style="">  77         parsers.put(TAG_RESOLVE, new ResolveParser());                                                   </span>
<span class="-6794856990865836500" onmouseenter="enter('-6794856990865836500');" onmouseout="out('-6794856990865836500');" style="">  78         parsers.put(TAG_FOLDER, new MyFolderParser());                                                   </span>
<span class="7891389292838004786" onmouseenter="enter('7891389292838004786');" onmouseout="out('7891389292838004786');" style="">  79         parsers.put(TAG_PARTNER_FOLDER, new PartnerFolderParser());                                      </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  80         return parsers;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="8392363038715364208" onmouseenter="enter('8392363038715364208');" onmouseout="out('8392363038715364208');" style="">  84     protected void parseContainerAndScreen(XmlResourceParser parser, long[] out) {                       </span>
<span class="-2089348695795856159" onmouseenter="enter('-2089348695795856159');" onmouseout="out('-2089348695795856159');" style="">  85         out[0] = LauncherSettings.Favorites.CONTAINER_DESKTOP;                                           </span>
<span class="-8953477941003932421" onmouseenter="enter('-8953477941003932421');" onmouseout="out('-8953477941003932421');" style="">  86         String strContainer = getAttributeValue(parser, ATTR_CONTAINER);                                 </span>
<span class="4899636274002469854" onmouseenter="enter('4899636274002469854');" onmouseout="out('4899636274002469854');" style="">  87         if (strContainer != null) {                                                                      </span>
<span class="5058638331917318804" onmouseenter="enter('5058638331917318804');" onmouseout="out('5058638331917318804');" style="">  88             out[0] = Long.valueOf(strContainer);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="-7003063245651866001" onmouseenter="enter('-7003063245651866001');" onmouseout="out('-7003063245651866001');" style="">  90         out[1] = Long.parseLong(getAttributeValue(parser, ATTR_SCREEN));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span  style="">  92                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93     /**                                                                                                  </span>
<span class="176933310960972051" onmouseenter="enter('176933310960972051');" onmouseout="out('176933310960972051');" style="">  94      * AppShortcutParser which also supports adding URI based intents                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  95      */                                                                                                  </span>
<span class="-1162580724960192627" onmouseenter="enter('-1162580724960192627');" onmouseout="out('-1162580724960192627');" style="">  96     private class AppShortcutWithUriParser extends AppShortcutParser {                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  97         @Override                                                                                        </span>
<span class="11443433107327190" onmouseenter="enter('11443433107327190');" onmouseout="out('11443433107327190');" style="">  98         protected long invalidPackageOrClass(XmlResourceParser parser) {                                 </span>
<span class="-1954941607715586859" onmouseenter="enter('-1954941607715586859');" onmouseout="out('-1954941607715586859');" style="">  99             final String uri = getAttributeValue(parser, ATTR_URI);                                      </span>
<span class="-2611673916122599069" onmouseenter="enter('-2611673916122599069');" onmouseout="out('-2611673916122599069');" style=""> 100             if (TextUtils.isEmpty(uri)) {                                                                </span>
<span class="-8012351384438033294" onmouseenter="enter('-8012351384438033294');" onmouseout="out('-8012351384438033294');" style=""> 101                 Log.e(TAG, &quot;Skipping invalid &lt;favorite&gt; with no component or uri&quot;);                      </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 102                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103             }                                                                                            </span>
<span class="7650863286169434864" onmouseenter="enter('7650863286169434864');" onmouseout="out('7650863286169434864');" style=""> 104             final Intent metaIntent;                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 105             try {                                                                                        </span>
<span class="3494981731706536607" onmouseenter="enter('3494981731706536607');" onmouseout="out('3494981731706536607');" style=""> 106                 metaIntent = Intent.parseUri(uri, 0);                                                    </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 107             } catch (URISyntaxException e) {                                                             </span>
<span class="-948485523889053577" onmouseenter="enter('-948485523889053577');" onmouseout="out('-948485523889053577');" style=""> 108                 Log.e(TAG, &quot;Unable to add meta-favorite: &quot; + uri, e);                                    </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 109                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110             }                                                                                            </span>
<span class="6023001759510760083" onmouseenter="enter('6023001759510760083');" onmouseout="out('6023001759510760083');" style=""><abbr title=" 111             ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent, PackageManager.MATCH_DEFAULT_ONLY);"> 111             ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent, PackageManager.MATCH_DEFAU</abbr></span>
<span class="-8737753070841171093" onmouseenter="enter('-8737753070841171093');" onmouseout="out('-8737753070841171093');" style=""><abbr title=" 112             final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(metaIntent, PackageManager.MATCH_DEFAULT_ONLY);"> 112             final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(metaIntent, PackageMa</abbr></span>
<span class="3807468246607352644" onmouseenter="enter('3807468246607352644');" onmouseout="out('3807468246607352644');" style=""> 113             // Verify that the result is an app and not just the resolver dialog asking which            </span>
<span class="3786398014846262159" onmouseenter="enter('3786398014846262159');" onmouseout="out('3786398014846262159');" style=""> 114             // app to use.                                                                               </span>
<span class="-2527999738736768738" onmouseenter="enter('-2527999738736768738');" onmouseout="out('-2527999738736768738');" style=""> 115             if (wouldLaunchResolverActivity(resolved, appList)) {                                        </span>
<span class="-1508864482817632041" onmouseenter="enter('-1508864482817632041');" onmouseout="out('-1508864482817632041');" style=""> 116                 // If only one of the results is a system app then choose that as the default.           </span>
<span class="7096358968319388823" onmouseenter="enter('7096358968319388823');" onmouseout="out('7096358968319388823');" style=""> 117                 final ResolveInfo systemApp = getSingleSystemActivity(appList);                          </span>
<span class="3112641083889325831" onmouseenter="enter('3112641083889325831');" onmouseout="out('3112641083889325831');" style=""> 118                 if (systemApp == null) {                                                                 </span>
<span class="8733485116897338114" onmouseenter="enter('8733485116897338114');" onmouseout="out('8733485116897338114');" style=""> 119                     // There is no logical choice for this meta-favorite, so rather than making          </span>
<span class="-5798817995675177798" onmouseenter="enter('-5798817995675177798');" onmouseout="out('-5798817995675177798');" style=""> 120                     // a bad choice just add nothing.                                                    </span>
<span class="8858396131731778802" onmouseenter="enter('8858396131731778802');" onmouseout="out('8858396131731778802');" style=""><abbr title=" 121                     Log.w(TAG, &quot;No preference or single system activity found for &quot; + metaIntent.toString());"> 121                     Log.w(TAG, &quot;No preference or single system activity found for &quot; + metaIntent.toString</abbr></span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 122                     return -1;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123                 }                                                                                        </span>
<span class="-2210262899281174552" onmouseenter="enter('-2210262899281174552');" onmouseout="out('-2210262899281174552');" style=""> 124                 resolved = systemApp;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125             }                                                                                            </span>
<span class="3942116430564013468" onmouseenter="enter('3942116430564013468');" onmouseout="out('3942116430564013468');" style=""> 126             final ActivityInfo info = resolved.activityInfo;                                             </span>
<span class="-360088289411741304" onmouseenter="enter('-360088289411741304');" onmouseout="out('-360088289411741304');" style=""> 127             final Intent intent = mPackageManager.getLaunchIntentForPackage(info.packageName);           </span>
<span class="-8400111569787613467" onmouseenter="enter('-8400111569787613467');" onmouseout="out('-8400111569787613467');" style=""> 128             if (intent == null) {                                                                        </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 129                 return -1;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130             }                                                                                            </span>
<span class="5079515441009778386" onmouseenter="enter('5079515441009778386');" onmouseout="out('5079515441009778386');" style=""> 131             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);  </span>
<span class="-1334070443414162793" onmouseenter="enter('-1334070443414162793');" onmouseout="out('-1334070443414162793');" style=""><abbr title=" 132             return addShortcut(info.loadLabel(mPackageManager).toString(), intent, Favorites.ITEM_TYPE_APPLICATION);"> 132             return addShortcut(info.loadLabel(mPackageManager).toString(), intent, Favorites.ITEM_TYPE_AP</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133         }                                                                                                </span>
<span  style=""> 134                                                                                                          </span>
<span class="3433873162423347490" onmouseenter="enter('3433873162423347490');" onmouseout="out('3433873162423347490');" style=""> 135         private ResolveInfo getSingleSystemActivity(List&lt;ResolveInfo&gt; appList) {                         </span>
<span class="4100859717391359582" onmouseenter="enter('4100859717391359582');" onmouseout="out('4100859717391359582');" style=""> 136             ResolveInfo systemResolve = null;                                                            </span>
<span class="-6501614514316220785" onmouseenter="enter('-6501614514316220785');" onmouseout="out('-6501614514316220785');" style=""> 137             final int N = appList.size();                                                                </span>
<span class="-7972660160186921434" onmouseenter="enter('-7972660160186921434');" onmouseout="out('-7972660160186921434');" style=""> 138             for (int i = 0; i &lt; N; ++i) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 139                 try {                                                                                    </span>
<span class="-5269464471896728684" onmouseenter="enter('-5269464471896728684');" onmouseout="out('-5269464471896728684');" style=""><abbr title=" 140                     ApplicationInfo info = mPackageManager.getApplicationInfo(appList.get(i).activityInfo.packageName, 0);"> 140                     ApplicationInfo info = mPackageManager.getApplicationInfo(appList.get(i).activityInfo</abbr></span>
<span class="-476381142815111019" onmouseenter="enter('-476381142815111019');" onmouseout="out('-476381142815111019');" style=""> 141                     if ((info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0) {                               </span>
<span class="-6460956471084206715" onmouseenter="enter('-6460956471084206715');" onmouseout="out('-6460956471084206715');" style=""> 142                         if (systemResolve != null) {                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 143                             return null;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 144                         } else {                                                                         </span>
<span class="-1920150334130463709" onmouseenter="enter('-1920150334130463709');" onmouseout="out('-1920150334130463709');" style=""> 145                             systemResolve = appList.get(i);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147                     }                                                                                    </span>
<span class="1662440237380033096" onmouseenter="enter('1662440237380033096');" onmouseout="out('1662440237380033096');" style=""> 148                 } catch (PackageManager e) {                                                             </span>
<span class="-265560973846634126" onmouseenter="enter('-265560973846634126');" onmouseout="out('-265560973846634126');" style=""> 149                     Log.w(TAG, &quot;Unable to get info about resolve results&quot;, e);                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 150                     return null;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152             }                                                                                            </span>
<span class="-7251347768060538731" onmouseenter="enter('-7251347768060538731');" onmouseout="out('-7251347768060538731');" style=""> 153             return systemResolve;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154         }                                                                                                </span>
<span  style=""> 155                                                                                                          </span>
<span class="-2131836858789161513" onmouseenter="enter('-2131836858789161513');" onmouseout="out('-2131836858789161513');" style=""> 156         private boolean wouldLaunchResolverActivity(ResolveInfo resolved, List&lt;ResolveInfo&gt; appList) {   </span>
<span class="-6399418581489152967" onmouseenter="enter('-6399418581489152967');" onmouseout="out('-6399418581489152967');" style=""> 157             // If the list contains the above resolved activity, then it can&#x27;t be                        </span>
<span class="4029821552264897243" onmouseenter="enter('4029821552264897243');" onmouseout="out('4029821552264897243');" style=""> 158             // ResolverActivity itself.                                                                  </span>
<span class="4411552974527624379" onmouseenter="enter('4411552974527624379');" onmouseout="out('4411552974527624379');" style=""> 159             for (int i = 0; i &lt; appList.size(); ++i) {                                                   </span>
<span class="-6814281994408040723" onmouseenter="enter('-6814281994408040723');" onmouseout="out('-6814281994408040723');" style=""> 160                 ResolveInfo tmp = appList.get(i);                                                        </span>
<span class="-5832999380615182113" onmouseenter="enter('-5832999380615182113');" onmouseout="out('-5832999380615182113');" style=""><abbr title=" 161                 if (tmp.activityInfo.name.equals(resolved.activityInfo.name) &amp;&amp; tmp.activityInfo.packageName.equals(resolved.activityInfo.packageName)) {"> 161                 if (tmp.activityInfo.name.equals(resolved.activityInfo.name) &amp;&amp; tmp.activityInfo.packageN</abbr></span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 162                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 165             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span  style=""> 168                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 169     /**                                                                                                  </span>
<span class="1574293742350901037" onmouseenter="enter('1574293742350901037');" onmouseout="out('1574293742350901037');" style=""> 170      * Shortcut parser which allows any uri and not just web urls.                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 171      */                                                                                                  </span>
<span class="-1541533161301288894" onmouseenter="enter('-1541533161301288894');" onmouseout="out('-1541533161301288894');" style=""> 172     private class UriShortcutParser extends ShortcutParser {                                             </span>
<span class="-44015680663593473" onmouseenter="enter('-44015680663593473');" onmouseout="out('-44015680663593473');" style=""> 173         public UriShortcutParser(Resources iconRes) {                                                    </span>
<span class="-2485453732023871858" onmouseenter="enter('-2485453732023871858');" onmouseout="out('-2485453732023871858');" style=""> 174             super(iconRes);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175         }                                                                                                </span>
<span  style=""> 176                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 177         @Override                                                                                        </span>
<span class="-2889018356529531059" onmouseenter="enter('-2889018356529531059');" onmouseout="out('-2889018356529531059');" style=""> 178         protected Intent parseIntent(XmlResourceParser parser) {                                         </span>
<span class="7870717952219178672" onmouseenter="enter('7870717952219178672');" onmouseout="out('7870717952219178672');" style=""> 179             String uri = null;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 180             try {                                                                                        </span>
<span class="-7650716598670279522" onmouseenter="enter('-7650716598670279522');" onmouseout="out('-7650716598670279522');" style=""> 181                 uri = getAttributeValue(parser, ATTR_URI);                                               </span>
<span class="9146954199733398323" onmouseenter="enter('9146954199733398323');" onmouseout="out('9146954199733398323');" style=""> 182                 return Intent.parseUri(uri, 0);                                                          </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 183             } catch (URISyntaxException e) {                                                             </span>
<span class="-551028723023595678" onmouseenter="enter('-551028723023595678');" onmouseout="out('-551028723023595678');" style=""> 184                 Log.w(TAG, &quot;Shortcut has malformed uri: &quot; + uri);                                        </span>
<span class="390376373303750500" onmouseenter="enter('390376373303750500');" onmouseout="out('390376373303750500');" style=""> 185                 return null;// Oh well                                                                   </span>
<span  style=""> 186                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 191     /**                                                                                                  </span>
<span class="-6891708564780781113" onmouseenter="enter('-6891708564780781113');" onmouseout="out('-6891708564780781113');" style=""> 192      * Contains a list of &lt;favorite&gt; nodes, and accepts the first successfully parsed node.              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 193      */                                                                                                  </span>
<span class="-6360947107494558327" onmouseenter="enter('-6360947107494558327');" onmouseout="out('-6360947107494558327');" style=""> 194     protected class ResolveParser implements TagParser {                                                 </span>
<span class="-3602839532613707268" onmouseenter="enter('-3602839532613707268');" onmouseout="out('-3602839532613707268');" style=""> 195         private final AppShortcutWithUriParser mChildParser = new AppShortcutWithUriParser();            </span>
<span  style=""> 196                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 197         @Override                                                                                        </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 198         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                 </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 199                 IOException {                                                                            </span>
<span class="-7289409140421595237" onmouseenter="enter('-7289409140421595237');" onmouseout="out('-7289409140421595237');" style=""> 200             final int groupDepth = parser.getDepth();                                                    </span>
<span class="3163913122247807134" onmouseenter="enter('3163913122247807134');" onmouseout="out('3163913122247807134');" style=""> 201             int type;                                                                                    </span>
<span class="-3096071360726764577" onmouseenter="enter('-3096071360726764577');" onmouseout="out('-3096071360726764577');" style=""> 202             long addedId = -1;                                                                           </span>
<span class="-2406917717669951461" onmouseenter="enter('-2406917717669951461');" onmouseout="out('-2406917717669951461');" style=""> 203             while ((type = parser.next()) != XmlPullParser.END_TAG ||                                    </span>
<span class="8687802670126733847" onmouseenter="enter('8687802670126733847');" onmouseout="out('8687802670126733847');" style=""> 204                     parser.getDepth() &gt; groupDepth) {                                                    </span>
<span class="-3010059378649710289" onmouseenter="enter('-3010059378649710289');" onmouseout="out('-3010059378649710289');" style=""> 205                 if (type != XmlPullParser.START_TAG || addedId &gt; -1) {                                   </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 206                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207                 }                                                                                        </span>
<span class="-4826163157610997597" onmouseenter="enter('-4826163157610997597');" onmouseout="out('-4826163157610997597');" style=""> 208                 final String fallback_item_name = parser.getName();                                      </span>
<span class="3394509129787922860" onmouseenter="enter('3394509129787922860');" onmouseout="out('3394509129787922860');" style=""> 209                 if (TAG_FAVORITE.equals(fallback_item_name)) {                                           </span>
<span class="-5252464721487850402" onmouseenter="enter('-5252464721487850402');" onmouseout="out('-5252464721487850402');" style=""> 210                     addedId = mChildParser.parseAndAdd(parser);                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 211                 } else {                                                                                 </span>
<span class="-6448281100759930849" onmouseenter="enter('-6448281100759930849');" onmouseout="out('-6448281100759930849');" style=""> 212                     Log.e(TAG, &quot;Fallback groups can contain only favorites, found &quot;                      </span>
<span class="1123550495059434881" onmouseenter="enter('1123550495059434881');" onmouseout="out('1123550495059434881');" style=""> 213                             + fallback_item_name);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215             }                                                                                            </span>
<span class="2168288094559194745" onmouseenter="enter('2168288094559194745');" onmouseout="out('2168288094559194745');" style=""> 216             return addedId;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 220     /**                                                                                                  </span>
<span class="1579901163323213209" onmouseenter="enter('1579901163323213209');" onmouseout="out('1579901163323213209');" style=""> 221      * A parser which adds a folder whose contents come from partner apk.                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 222      */                                                                                                  </span>
<span class="-2406002401110994608" onmouseenter="enter('-2406002401110994608');" onmouseout="out('-2406002401110994608');" style=""> 223     private class PartnerFolderParser implements TagParser {                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224         @Override                                                                                        </span>
<span class="-4068651625164272628" onmouseenter="enter('-4068651625164272628');" onmouseout="out('-4068651625164272628');" style=""> 225         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException, IOException {   </span>
<span class="9058192063405184929" onmouseenter="enter('9058192063405184929');" onmouseout="out('9058192063405184929');" style=""> 226             // Folder contents come from an external XML resource                                        </span>
<span class="-6415916158480032673" onmouseenter="enter('-6415916158480032673');" onmouseout="out('-6415916158480032673');" style=""> 227             final Partner partner = Partner.get(mPackageManager);                                        </span>
<span class="-9215364277253785969" onmouseenter="enter('-9215364277253785969');" onmouseout="out('-9215364277253785969');" style=""> 228             if (partner != null) {                                                                       </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 229                 final Resources partnerRes = partner.getResources();                                     </span>
<span class="-6308649734506890044" onmouseenter="enter('-6308649734506890044');" onmouseout="out('-6308649734506890044');" style=""><abbr title=" 230                 final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER, &quot;xml&quot;, partner.getPackageName());"> 230                 final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER, &quot;xml&quot;, partner.getPackageN</abbr></span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 231                 if (resId != 0) {                                                                        </span>
<span class="5087581180241899012" onmouseenter="enter('5087581180241899012');" onmouseout="out('5087581180241899012');" style=""> 232                     final XmlResourceParser partnerParser = partnerRes.getXml(resId);                    </span>
<span class="7615154974472081807" onmouseenter="enter('7615154974472081807');" onmouseout="out('7615154974472081807');" style=""> 233                     beginDocument(partnerParser, TAG_FOLDER);                                            </span>
<span class="8060532263905830482" onmouseenter="enter('8060532263905830482');" onmouseout="out('8060532263905830482');" style=""> 234                     FolderParser folderParser = new FolderParser(getFolderElementsMap(partnerRes));      </span>
<span class="-8238770055449336686" onmouseenter="enter('-8238770055449336686');" onmouseout="out('-8238770055449336686');" style=""> 235                     return folderParser.parseAndAdd(partnerParser);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237             }                                                                                            </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 238             return -1;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240     }                                                                                                    </span>
<span  style=""> 241                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 242     /**                                                                                                  </span>
<span class="8278041230656125878" onmouseenter="enter('8278041230656125878');" onmouseout="out('8278041230656125878');" style=""> 243      * An extension of FolderParser which allows adding items from a different xml.                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 244      */                                                                                                  </span>
<span class="-8854772189599396750" onmouseenter="enter('-8854772189599396750');" onmouseout="out('-8854772189599396750');" style=""> 245     private class MyFolderParser extends FolderParser {                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 246         @Override                                                                                        </span>
<span class="-4068651625164272628" onmouseenter="enter('-4068651625164272628');" onmouseout="out('-4068651625164272628');" style=""> 247         public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException, IOException {   </span>
<span class="3231178325674503525" onmouseenter="enter('3231178325674503525');" onmouseout="out('3231178325674503525');" style=""> 248             final int resId = getAttributeResourceValue(parser, ATTR_FOLDER_ITEMS, 0);                   </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 249             if (resId != 0) {                                                                            </span>
<span class="-582766932060535096" onmouseenter="enter('-582766932060535096');" onmouseout="out('-582766932060535096');" style=""> 250                 parser = mSourceRes.getXml(resId);                                                       </span>
<span class="5069593388582006904" onmouseenter="enter('5069593388582006904');" onmouseout="out('5069593388582006904');" style=""> 251                 beginDocument(parser, TAG_FOLDER);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span class="-5602508129346726029" onmouseenter="enter('-5602508129346726029');" onmouseout="out('-5602508129346726029');" style=""> 253             return super.parseAndAdd(parser);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256 }                                                                                                        </span>

























</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">   1  package com.android.launcher3;                                                                                    </span>
<span  style="">   2                                                                                                                    </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">   3  import android.appwidget.AppWidgetHost;                                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5  import android.content.Intent;                                                                                    </span>
<span class="-9183914406029598577" onmouseenter="enter('-9183914406029598577');" onmouseout="out('-9183914406029598577');" style="">   6  import android.content.pm.ActivityInfo;                                                                           </span>
<span class="-841431222158024655" onmouseenter="enter('-841431222158024655');" onmouseout="out('-841431222158024655');" style="">   7  import android.content.pm.ApplicationInfo;                                                                        </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   8  import android.content.pm.PackageManager;                                                                         </span>
<span class="8582326229770324815" onmouseenter="enter('8582326229770324815');" onmouseout="out('8582326229770324815');" style="">   9  import android.content.pm.ResolveInfo;                                                                            </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  10  import android.content.res.Resources;                                                                             </span>
<span class="7386012112211289620" onmouseenter="enter('7386012112211289620');" onmouseout="out('7386012112211289620');" style="">  11  import android.content.res.XmlResourceParser;                                                                     </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  12  import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  13  import android.util.Log;                                                                                          </span>
<span  style="">  14                                                                                                                    </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  15  import com.android.launcher3.LauncherSettings.Favorites;                                                          </span>
<span  style="">  16                                                                                                                    </span>
<span class="-5145222340437954675" onmouseenter="enter('-5145222340437954675');" onmouseout="out('-5145222340437954675');" style="">  17  import org.xmlpull.v1.XmlPullParser;                                                                              </span>
<span class="-3477173242969633951" onmouseenter="enter('-3477173242969633951');" onmouseout="out('-3477173242969633951');" style="">  18  import org.xmlpull.v1.XmlPullParserException;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  20  import java.io.IOException;                                                                                       </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  21  import java.net.URISyntaxException;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  22  import java.util.ArrayList;                                                                                       </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  23  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  24  import java.util.List;                                                                                            </span>
<span  style="">  25                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  26  /**                                                                                                               </span>
<span class="8625030305996545010" onmouseenter="enter('8625030305996545010');" onmouseout="out('8625030305996545010');" style="">  27   * Implements the layout parser with rules for internal layouts and partner layouts.                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  28   */                                                                                                               </span>
<span class="-4383609652675664527" onmouseenter="enter('-4383609652675664527');" onmouseout="out('-4383609652675664527');" style="">  29  public class DefaultLayoutParser extends AutoInstallsLayout {                                                     </span>
<span class="6838912681597350908" onmouseenter="enter('6838912681597350908');" onmouseout="out('6838912681597350908');" style="">  30      private static final String TAG = &quot;DefaultLayoutParser&quot;;                                                      </span>
<span  style="">  31                                                                                                                    </span>
<span class="-9177351901961504515" onmouseenter="enter('-9177351901961504515');" onmouseout="out('-9177351901961504515');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -    private static final String TAG_RESOLVE = &quot;resolve&quot;;                                                          </span>
<span class="5205878637063247744" onmouseenter="enter('5205878637063247744');" onmouseout="out('5205878637063247744');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +    protected static final String TAG_RESOLVE = &quot;resolve&quot;;                                                        </span>
<span class="-6648556986475948603" onmouseenter="enter('-6648556986475948603');" onmouseout="out('-6648556986475948603');" style="">  34      private static final String TAG_FAVORITES = &quot;favorites&quot;;                                                      </span>
<span class="2417919475469446038" onmouseenter="enter('2417919475469446038');" onmouseout="out('2417919475469446038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -    private static final String TAG_FAVORITE = &quot;favorite&quot;;                                                        </span>
<span class="8610360292624390744" onmouseenter="enter('8610360292624390744');" onmouseout="out('8610360292624390744');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +    protected static final String TAG_FAVORITE = &quot;favorite&quot;;                                                      </span>
<span class="8817783213080628620" onmouseenter="enter('8817783213080628620');" onmouseout="out('8817783213080628620');" style="">  37      private static final String TAG_APPWIDGET = &quot;appwidget&quot;;                                                      </span>
<span class="1544013162193549447" onmouseenter="enter('1544013162193549447');" onmouseout="out('1544013162193549447');" style="">  38      private static final String TAG_SHORTCUT = &quot;shortcut&quot;;                                                        </span>
<span class="-5715927654015021253" onmouseenter="enter('-5715927654015021253');" onmouseout="out('-5715927654015021253');" style="">  39      private static final String TAG_FOLDER = &quot;folder&quot;;                                                            </span>
<span class="-6175494568545371270" onmouseenter="enter('-6175494568545371270');" onmouseout="out('-6175494568545371270');" style="">  40      private static final String TAG_PARTNER_FOLDER = &quot;partner-folder&quot;;                                            </span>
<span class="-5562355841128428217" onmouseenter="enter('-5562355841128428217');" onmouseout="out('-5562355841128428217');" style="">  41      private static final String TAG_INCLUDE = &quot;include&quot;;                                                          </span>
<span  style="">  42                                                                                                                    </span>
<span class="-5345085314000449361" onmouseenter="enter('-5345085314000449361');" onmouseout="out('-5345085314000449361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -    private static final String ATTR_URI = &quot;uri&quot;;                                                                 </span>
<span class="-6586268974859869590" onmouseenter="enter('-6586268974859869590');" onmouseout="out('-6586268974859869590');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +    protected static final String ATTR_URI = &quot;uri&quot;;                                                               </span>
<span class="-5893198944478773555" onmouseenter="enter('-5893198944478773555');" onmouseout="out('-5893198944478773555');" style="">  45      private static final String ATTR_WORKSPACE = &quot;workspace&quot;;                                                     </span>
<span class="2414249740748360985" onmouseenter="enter('2414249740748360985');" onmouseout="out('2414249740748360985');" style="">  46      private static final String ATTR_CONTAINER = &quot;container&quot;;                                                     </span>
<span class="-389066511444324935" onmouseenter="enter('-389066511444324935');" onmouseout="out('-389066511444324935');" style="">  47      private static final String ATTR_SCREEN = &quot;screen&quot;;                                                           </span>
<span class="1567909548797839052" onmouseenter="enter('1567909548797839052');" onmouseout="out('1567909548797839052');" style="">  48      private static final String ATTR_FOLDER_ITEMS = &quot;folderItems&quot;;                                                </span>
<span  style="">  49                                                                                                                    </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  50      public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                                      </span>
<span class="2852391764281860202" onmouseenter="enter('2852391764281860202');" onmouseout="out('2852391764281860202');" style="">  51              LayoutParserCallback callback, Resources sourceRes, int layoutId) {                                   </span>
<span class="7279694431066637071" onmouseenter="enter('7279694431066637071');" onmouseout="out('7279694431066637071');" style="">  52          super(context, appWidgetHost, callback, sourceRes, layoutId, TAG_FAVORITES);                              </span>
<span class="-872114900452253526" onmouseenter="enter('-872114900452253526');" onmouseout="out('-872114900452253526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -        Log.e(TAG, &quot;Default layout parser initialized&quot;);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +                                                                                                                  </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +    public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                                      </span>
<span class="243733098520730772" onmouseenter="enter('243733098520730772');" onmouseout="out('243733098520730772');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +            LayoutParserCallback callback, Resources sourceRes, int layoutId, String rootTag,                     </span>
<span class="-1443250586800717367" onmouseenter="enter('-1443250586800717367');" onmouseout="out('-1443250586800717367');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +            int hotseatAllAppsRank) {                                                                             </span>
<span class="7443239544573875424" onmouseenter="enter('7443239544573875424');" onmouseout="out('7443239544573875424');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +        super(context, appWidgetHost, callback, sourceRes, layoutId, rootTag, hotseatAllAppsRank);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60      }                                                                                                             </span>
<span  style="">  61                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  62      @Override                                                                                                     </span>
<span class="-8135337961010470432" onmouseenter="enter('-8135337961010470432');" onmouseout="out('-8135337961010470432');" style="">  63      protected HashMap&lt;String, TagParser&gt; getFolderElementsMap() {                                                 </span>
<span class="423350535395751664" onmouseenter="enter('423350535395751664');" onmouseout="out('423350535395751664');" style="">  64          return getFolderElementsMap(mSourceRes);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65      }                                                                                                             </span>
<span  style="">  66                                                                                                                    </span>
<span class="2700844173783892803" onmouseenter="enter('2700844173783892803');" onmouseout="out('2700844173783892803');" style="">  67      private HashMap&lt;String, TagParser&gt; getFolderElementsMap(Resources res) {                                      </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  68          HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                                    </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  69          parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                                </span>
<span class="-8627156416288422237" onmouseenter="enter('-8627156416288422237');" onmouseout="out('-8627156416288422237');" style="">  70          parsers.put(TAG_SHORTCUT, new UriShortcutParser(res));                                                    </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  71          return parsers;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  72      }                                                                                                             </span>
<span  style="">  73                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  74      @Override                                                                                                     </span>
<span class="7427983078574486125" onmouseenter="enter('7427983078574486125');" onmouseout="out('7427983078574486125');" style="">  75      protected HashMap&lt;String, TagParser&gt; getLayoutElementsMap() {                                                 </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  76          HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                                    </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  77          parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                                </span>
<span class="-2800106172813247359" onmouseenter="enter('-2800106172813247359');" onmouseout="out('-2800106172813247359');" style="">  78          parsers.put(TAG_APPWIDGET, new AppWidgetParser());                                                        </span>
<span class="2292493876717618109" onmouseenter="enter('2292493876717618109');" onmouseout="out('2292493876717618109');" style="">  79          parsers.put(TAG_SHORTCUT, new UriShortcutParser(mSourceRes));                                             </span>
<span class="5801084860772407385" onmouseenter="enter('5801084860772407385');" onmouseout="out('5801084860772407385');" style="">  80          parsers.put(TAG_RESOLVE, new ResolveParser());                                                            </span>
<span class="-6794856990865836500" onmouseenter="enter('-6794856990865836500');" onmouseout="out('-6794856990865836500');" style="">  81          parsers.put(TAG_FOLDER, new MyFolderParser());                                                            </span>
<span class="7891389292838004786" onmouseenter="enter('7891389292838004786');" onmouseout="out('7891389292838004786');" style="">  82          parsers.put(TAG_PARTNER_FOLDER, new PartnerFolderParser());                                               </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  83          return parsers;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84      }                                                                                                             </span>
<span  style="">  85                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  86      @Override                                                                                                     </span>
<span class="8392363038715364208" onmouseenter="enter('8392363038715364208');" onmouseout="out('8392363038715364208');" style="">  87      protected void parseContainerAndScreen(XmlResourceParser parser, long[] out) {                                </span>
<span class="-2089348695795856159" onmouseenter="enter('-2089348695795856159');" onmouseout="out('-2089348695795856159');" style="">  88          out[0] = LauncherSettings.Favorites.CONTAINER_DESKTOP;                                                    </span>
<span class="-8953477941003932421" onmouseenter="enter('-8953477941003932421');" onmouseout="out('-8953477941003932421');" style="">  89          String strContainer = getAttributeValue(parser, ATTR_CONTAINER);                                          </span>
<span class="4899636274002469854" onmouseenter="enter('4899636274002469854');" onmouseout="out('4899636274002469854');" style="">  90          if (strContainer != null) {                                                                               </span>
<span class="5058638331917318804" onmouseenter="enter('5058638331917318804');" onmouseout="out('5058638331917318804');" style="">  91              out[0] = Long.valueOf(strContainer);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92          }                                                                                                         </span>
<span class="-7003063245651866001" onmouseenter="enter('-7003063245651866001');" onmouseout="out('-7003063245651866001');" style="">  93          out[1] = Long.parseLong(getAttributeValue(parser, ATTR_SCREEN));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94      }                                                                                                             </span>
<span  style="">  95                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  96      @Override                                                                                                     </span>
<span class="5790746152821979500" onmouseenter="enter('5790746152821979500');" onmouseout="out('5790746152821979500');" style="">  97      protected int parseAndAddNode(                                                                                </span>
<span class="-2373089251837970851" onmouseenter="enter('-2373089251837970851');" onmouseout="out('-2373089251837970851');" style="">  98              XmlResourceParser parser,                                                                             </span>
<span class="-872085258501142185" onmouseenter="enter('-872085258501142185');" onmouseout="out('-872085258501142185');" style="">  99              HashMap&lt;String, TagParser&gt; tagParserMap,                                                              </span>
<span class="-8579938981619154329" onmouseenter="enter('-8579938981619154329');" onmouseout="out('-8579938981619154329');" style=""> 100              ArrayList&lt;Long&gt; screenIds)                                                                            </span>
<span class="-2080139816352784756" onmouseenter="enter('-2080139816352784756');" onmouseout="out('-2080139816352784756');" style=""> 101                      throws XmlPullParserException, IOException {                                                  </span>
<span class="1229850105348499279" onmouseenter="enter('1229850105348499279');" onmouseout="out('1229850105348499279');" style=""> 102          if (TAG_INCLUDE.equals(parser.getName())) {                                                               </span>
<span class="7620964305819267835" onmouseenter="enter('7620964305819267835');" onmouseout="out('7620964305819267835');" style=""> 103              final int resId = getAttributeResourceValue(parser, ATTR_WORKSPACE, 0);                               </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 104              if (resId != 0) {                                                                                     </span>
<span class="-8087579639415016515" onmouseenter="enter('-8087579639415016515');" onmouseout="out('-8087579639415016515');" style=""> 105                  // recursively load some more favorites, why not?                                                 </span>
<span class="-6570658120834925918" onmouseenter="enter('-6570658120834925918');" onmouseout="out('-6570658120834925918');" style=""> 106                  return parseLayout(resId, screenIds);                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 107              } else {                                                                                              </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 108                  return 0;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 110          } else {                                                                                                  </span>
<span class="-6025340927376373949" onmouseenter="enter('-6025340927376373949');" onmouseout="out('-6025340927376373949');" style=""> 111              return super.parseAndAddNode(parser, tagParserMap, screenIds);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113      }                                                                                                             </span>
<span  style=""> 114                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 115      /**                                                                                                           </span>
<span class="176933310960972051" onmouseenter="enter('176933310960972051');" onmouseout="out('176933310960972051');" style=""> 116       * AppShortcutParser which also supports adding URI based intents                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 117       */                                                                                                           </span>
<span class="-1162580724960192627" onmouseenter="enter('-1162580724960192627');" onmouseout="out('-1162580724960192627');" style=""> 118      private class AppShortcutWithUriParser extends AppShortcutParser {                                            </span>
<span  style=""> 119                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 120          @Override                                                                                                 </span>
<span class="11443433107327190" onmouseenter="enter('11443433107327190');" onmouseout="out('11443433107327190');" style=""> 121          protected long invalidPackageOrClass(XmlResourceParser parser) {                                          </span>
<span class="-1954941607715586859" onmouseenter="enter('-1954941607715586859');" onmouseout="out('-1954941607715586859');" style=""> 122              final String uri = getAttributeValue(parser, ATTR_URI);                                               </span>
<span class="-2611673916122599069" onmouseenter="enter('-2611673916122599069');" onmouseout="out('-2611673916122599069');" style=""> 123              if (TextUtils.isEmpty(uri)) {                                                                         </span>
<span class="-8012351384438033294" onmouseenter="enter('-8012351384438033294');" onmouseout="out('-8012351384438033294');" style=""> 124                  Log.e(TAG, &quot;Skipping invalid &lt;favorite&gt; with no component or uri&quot;);                               </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 125                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126              }                                                                                                     </span>
<span  style=""> 127                                                                                                                    </span>
<span class="7650863286169434864" onmouseenter="enter('7650863286169434864');" onmouseout="out('7650863286169434864');" style=""> 128              final Intent metaIntent;                                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 129              try {                                                                                                 </span>
<span class="3494981731706536607" onmouseenter="enter('3494981731706536607');" onmouseout="out('3494981731706536607');" style=""> 130                  metaIntent = Intent.parseUri(uri, 0);                                                             </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 131              } catch (URISyntaxException e) {                                                                      </span>
<span class="-948485523889053577" onmouseenter="enter('-948485523889053577');" onmouseout="out('-948485523889053577');" style=""> 132                  Log.e(TAG, &quot;Unable to add meta-favorite: &quot; + uri, e);                                             </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 133                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134              }                                                                                                     </span>
<span  style=""> 135                                                                                                                    </span>
<span class="8557033759361467860" onmouseenter="enter('8557033759361467860');" onmouseout="out('8557033759361467860');" style=""> 136              ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent,                                    </span>
<span class="2456166036476176214" onmouseenter="enter('2456166036476176214');" onmouseout="out('2456166036476176214');" style=""> 137                      PackageManager.MATCH_DEFAULT_ONLY);                                                           </span>
<span class="-1300490748614024222" onmouseenter="enter('-1300490748614024222');" onmouseout="out('-1300490748614024222');" style=""> 138              final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(                              </span>
<span class="8656178102542661668" onmouseenter="enter('8656178102542661668');" onmouseout="out('8656178102542661668');" style=""> 139                      metaIntent, PackageManager.MATCH_DEFAULT_ONLY);                                               </span>
<span  style=""> 140                                                                                                                    </span>
<span class="3807468246607352644" onmouseenter="enter('3807468246607352644');" onmouseout="out('3807468246607352644');" style=""> 141              // Verify that the result is an app and not just the resolver dialog asking which                     </span>
<span class="3786398014846262159" onmouseenter="enter('3786398014846262159');" onmouseout="out('3786398014846262159');" style=""> 142              // app to use.                                                                                        </span>
<span class="-2527999738736768738" onmouseenter="enter('-2527999738736768738');" onmouseout="out('-2527999738736768738');" style=""> 143              if (wouldLaunchResolverActivity(resolved, appList)) {                                                 </span>
<span class="-1508864482817632041" onmouseenter="enter('-1508864482817632041');" onmouseout="out('-1508864482817632041');" style=""> 144                  // If only one of the results is a system app then choose that as the default.                    </span>
<span class="7096358968319388823" onmouseenter="enter('7096358968319388823');" onmouseout="out('7096358968319388823');" style=""> 145                  final ResolveInfo systemApp = getSingleSystemActivity(appList);                                   </span>
<span class="3112641083889325831" onmouseenter="enter('3112641083889325831');" onmouseout="out('3112641083889325831');" style=""> 146                  if (systemApp == null) {                                                                          </span>
<span class="8733485116897338114" onmouseenter="enter('8733485116897338114');" onmouseout="out('8733485116897338114');" style=""> 147                      // There is no logical choice for this meta-favorite, so rather than making                   </span>
<span class="-5798817995675177798" onmouseenter="enter('-5798817995675177798');" onmouseout="out('-5798817995675177798');" style=""> 148                      // a bad choice just add nothing.                                                             </span>
<span class="8234306782594839467" onmouseenter="enter('8234306782594839467');" onmouseout="out('8234306782594839467');" style=""> 149                      Log.w(TAG, &quot;No preference or single system activity found for &quot;                               </span>
<span class="-4585840856389419283" onmouseenter="enter('-4585840856389419283');" onmouseout="out('-4585840856389419283');" style=""> 150                              + metaIntent.toString());                                                             </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 151                      return -1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152                  }                                                                                                 </span>
<span class="-2210262899281174552" onmouseenter="enter('-2210262899281174552');" onmouseout="out('-2210262899281174552');" style=""> 153                  resolved = systemApp;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154              }                                                                                                     </span>
<span class="3942116430564013468" onmouseenter="enter('3942116430564013468');" onmouseout="out('3942116430564013468');" style=""> 155              final ActivityInfo info = resolved.activityInfo;                                                      </span>
<span class="-360088289411741304" onmouseenter="enter('-360088289411741304');" onmouseout="out('-360088289411741304');" style=""> 156              final Intent intent = mPackageManager.getLaunchIntentForPackage(info.packageName);                    </span>
<span class="-8400111569787613467" onmouseenter="enter('-8400111569787613467');" onmouseout="out('-8400111569787613467');" style=""> 157              if (intent == null) {                                                                                 </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 158                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159              }                                                                                                     </span>
<span class="2514039366923723926" onmouseenter="enter('2514039366923723926');" onmouseout="out('2514039366923723926');" style=""> 160              intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |                                                       </span>
<span class="754211306232040187" onmouseenter="enter('754211306232040187');" onmouseout="out('754211306232040187');" style=""> 161                      Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);                                                   </span>
<span  style=""> 162                                                                                                                    </span>
<span class="-4701923995052302611" onmouseenter="enter('-4701923995052302611');" onmouseout="out('-4701923995052302611');" style=""> 163              return addShortcut(info.loadLabel(mPackageManager).toString(), intent,                                </span>
<span class="-3250487283659008470" onmouseenter="enter('-3250487283659008470');" onmouseout="out('-3250487283659008470');" style=""> 164                      Favorites.ITEM_TYPE_APPLICATION);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165          }                                                                                                         </span>
<span  style=""> 166                                                                                                                    </span>
<span class="3433873162423347490" onmouseenter="enter('3433873162423347490');" onmouseout="out('3433873162423347490');" style=""> 167          private ResolveInfo getSingleSystemActivity(List&lt;ResolveInfo&gt; appList) {                                  </span>
<span class="4100859717391359582" onmouseenter="enter('4100859717391359582');" onmouseout="out('4100859717391359582');" style=""> 168              ResolveInfo systemResolve = null;                                                                     </span>
<span class="-6501614514316220785" onmouseenter="enter('-6501614514316220785');" onmouseout="out('-6501614514316220785');" style=""> 169              final int N = appList.size();                                                                         </span>
<span class="-7972660160186921434" onmouseenter="enter('-7972660160186921434');" onmouseout="out('-7972660160186921434');" style=""> 170              for (int i = 0; i &lt; N; ++i) {                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 171                  try {                                                                                             </span>
<span class="6969736750563256446" onmouseenter="enter('6969736750563256446');" onmouseout="out('6969736750563256446');" style=""> 172                      ApplicationInfo info = mPackageManager.getApplicationInfo(                                    </span>
<span class="1402648097889367388" onmouseenter="enter('1402648097889367388');" onmouseout="out('1402648097889367388');" style=""> 173                              appList.get(i).activityInfo.packageName, 0);                                          </span>
<span class="-476381142815111019" onmouseenter="enter('-476381142815111019');" onmouseout="out('-476381142815111019');" style=""> 174                      if ((info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0) {                                        </span>
<span class="-6460956471084206715" onmouseenter="enter('-6460956471084206715');" onmouseout="out('-6460956471084206715');" style=""> 175                          if (systemResolve != null) {                                                              </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 176                              return null;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 177                          } else {                                                                                  </span>
<span class="-1920150334130463709" onmouseenter="enter('-1920150334130463709');" onmouseout="out('-1920150334130463709');" style=""> 178                              systemResolve = appList.get(i);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180                      }                                                                                             </span>
<span class="8932842947262589349" onmouseenter="enter('8932842947262589349');" onmouseout="out('8932842947262589349');" style=""> 181                  } catch (PackageManager.NameNotFoundException e) {                                                </span>
<span class="-265560973846634126" onmouseenter="enter('-265560973846634126');" onmouseout="out('-265560973846634126');" style=""> 182                      Log.w(TAG, &quot;Unable to get info about resolve results&quot;, e);                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 183                      return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185              }                                                                                                     </span>
<span class="-7251347768060538731" onmouseenter="enter('-7251347768060538731');" onmouseout="out('-7251347768060538731');" style=""> 186              return systemResolve;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187          }                                                                                                         </span>
<span  style=""> 188                                                                                                                    </span>
<span class="-4222771116108434581" onmouseenter="enter('-4222771116108434581');" onmouseout="out('-4222771116108434581');" style=""> 189          private boolean wouldLaunchResolverActivity(ResolveInfo resolved,                                         </span>
<span class="8855822793352880756" onmouseenter="enter('8855822793352880756');" onmouseout="out('8855822793352880756');" style=""> 190                  List&lt;ResolveInfo&gt; appList) {                                                                      </span>
<span class="-6399418581489152967" onmouseenter="enter('-6399418581489152967');" onmouseout="out('-6399418581489152967');" style=""> 191              // If the list contains the above resolved activity, then it can&#x27;t be                                 </span>
<span class="4029821552264897243" onmouseenter="enter('4029821552264897243');" onmouseout="out('4029821552264897243');" style=""> 192              // ResolverActivity itself.                                                                           </span>
<span class="4411552974527624379" onmouseenter="enter('4411552974527624379');" onmouseout="out('4411552974527624379');" style=""> 193              for (int i = 0; i &lt; appList.size(); ++i) {                                                            </span>
<span class="-6814281994408040723" onmouseenter="enter('-6814281994408040723');" onmouseout="out('-6814281994408040723');" style=""> 194                  ResolveInfo tmp = appList.get(i);                                                                 </span>
<span class="-3160638667287468420" onmouseenter="enter('-3160638667287468420');" onmouseout="out('-3160638667287468420');" style=""> 195                  if (tmp.activityInfo.name.equals(resolved.activityInfo.name)                                      </span>
<span class="6821338150188138172" onmouseenter="enter('6821338150188138172');" onmouseout="out('6821338150188138172');" style=""> 196                          &amp;&amp; tmp.activityInfo.packageName.equals(resolved.activityInfo.packageName)) {              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 197                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 200              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202      }                                                                                                             </span>
<span  style=""> 203                                                                                                                    </span>
<span  style=""> 204                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 205      /**                                                                                                           </span>
<span class="1574293742350901037" onmouseenter="enter('1574293742350901037');" onmouseout="out('1574293742350901037');" style=""> 206       * Shortcut parser which allows any uri and not just web urls.                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 207       */                                                                                                           </span>
<span class="-1541533161301288894" onmouseenter="enter('-1541533161301288894');" onmouseout="out('-1541533161301288894');" style=""> 208      private class UriShortcutParser extends ShortcutParser {                                                      </span>
<span  style=""> 209                                                                                                                    </span>
<span class="-44015680663593473" onmouseenter="enter('-44015680663593473');" onmouseout="out('-44015680663593473');" style=""> 210          public UriShortcutParser(Resources iconRes) {                                                             </span>
<span class="-2485453732023871858" onmouseenter="enter('-2485453732023871858');" onmouseout="out('-2485453732023871858');" style=""> 211              super(iconRes);                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212          }                                                                                                         </span>
<span  style=""> 213                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 214          @Override                                                                                                 </span>
<span class="-2889018356529531059" onmouseenter="enter('-2889018356529531059');" onmouseout="out('-2889018356529531059');" style=""> 215          protected Intent parseIntent(XmlResourceParser parser) {                                                  </span>
<span class="7870717952219178672" onmouseenter="enter('7870717952219178672');" onmouseout="out('7870717952219178672');" style=""> 216              String uri = null;                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 217              try {                                                                                                 </span>
<span class="-7650716598670279522" onmouseenter="enter('-7650716598670279522');" onmouseout="out('-7650716598670279522');" style=""> 218                  uri = getAttributeValue(parser, ATTR_URI);                                                        </span>
<span class="9146954199733398323" onmouseenter="enter('9146954199733398323');" onmouseout="out('9146954199733398323');" style=""> 219                  return Intent.parseUri(uri, 0);                                                                   </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 220              } catch (URISyntaxException e) {                                                                      </span>
<span class="-551028723023595678" onmouseenter="enter('-551028723023595678');" onmouseout="out('-551028723023595678');" style=""> 221                  Log.w(TAG, &quot;Shortcut has malformed uri: &quot; + uri);                                                 </span>
<span class="6664617886922048676" onmouseenter="enter('6664617886922048676');" onmouseout="out('6664617886922048676');" style=""> 222                  return null; // Oh well                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225      }                                                                                                             </span>
<span  style=""> 226                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 227      /**                                                                                                           </span>
<span class="-6891708564780781113" onmouseenter="enter('-6891708564780781113');" onmouseout="out('-6891708564780781113');" style=""> 228       * Contains a list of &lt;favorite&gt; nodes, and accepts the first successfully parsed node.                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 229       */                                                                                                           </span>
<span class="1250232012414458582" onmouseenter="enter('1250232012414458582');" onmouseout="out('1250232012414458582');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -    private class ResolveParser implements TagParser {                                                            </span>
<span class="-6360947107494558327" onmouseenter="enter('-6360947107494558327');" onmouseout="out('-6360947107494558327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 231 +    protected class ResolveParser implements TagParser {                                                          </span>
<span  style=""> 232                                                                                                                    </span>
<span class="-3602839532613707268" onmouseenter="enter('-3602839532613707268');" onmouseout="out('-3602839532613707268');" style=""> 233          private final AppShortcutWithUriParser mChildParser = new AppShortcutWithUriParser();                     </span>
<span  style=""> 234                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 235          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 236          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 237                  IOException {                                                                                     </span>
<span class="-7289409140421595237" onmouseenter="enter('-7289409140421595237');" onmouseout="out('-7289409140421595237');" style=""> 238              final int groupDepth = parser.getDepth();                                                             </span>
<span class="3163913122247807134" onmouseenter="enter('3163913122247807134');" onmouseout="out('3163913122247807134');" style=""> 239              int type;                                                                                             </span>
<span class="-3096071360726764577" onmouseenter="enter('-3096071360726764577');" onmouseout="out('-3096071360726764577');" style=""> 240              long addedId = -1;                                                                                    </span>
<span class="-2406917717669951461" onmouseenter="enter('-2406917717669951461');" onmouseout="out('-2406917717669951461');" style=""> 241              while ((type = parser.next()) != XmlPullParser.END_TAG ||                                             </span>
<span class="8687802670126733847" onmouseenter="enter('8687802670126733847');" onmouseout="out('8687802670126733847');" style=""> 242                      parser.getDepth() &gt; groupDepth) {                                                             </span>
<span class="-3010059378649710289" onmouseenter="enter('-3010059378649710289');" onmouseout="out('-3010059378649710289');" style=""> 243                  if (type != XmlPullParser.START_TAG || addedId &gt; -1) {                                            </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 244                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245                  }                                                                                                 </span>
<span class="-4826163157610997597" onmouseenter="enter('-4826163157610997597');" onmouseout="out('-4826163157610997597');" style=""> 246                  final String fallback_item_name = parser.getName();                                               </span>
<span class="3394509129787922860" onmouseenter="enter('3394509129787922860');" onmouseout="out('3394509129787922860');" style=""> 247                  if (TAG_FAVORITE.equals(fallback_item_name)) {                                                    </span>
<span class="-5252464721487850402" onmouseenter="enter('-5252464721487850402');" onmouseout="out('-5252464721487850402');" style=""> 248                      addedId = mChildParser.parseAndAdd(parser);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 249                  } else {                                                                                          </span>
<span class="-6448281100759930849" onmouseenter="enter('-6448281100759930849');" onmouseout="out('-6448281100759930849');" style=""> 250                      Log.e(TAG, &quot;Fallback groups can contain only favorites, found &quot;                               </span>
<span class="1123550495059434881" onmouseenter="enter('1123550495059434881');" onmouseout="out('1123550495059434881');" style=""> 251                              + fallback_item_name);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253              }                                                                                                     </span>
<span class="2168288094559194745" onmouseenter="enter('2168288094559194745');" onmouseout="out('2168288094559194745');" style=""> 254              return addedId;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256      }                                                                                                             </span>
<span  style=""> 257                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 258      /**                                                                                                           </span>
<span class="1579901163323213209" onmouseenter="enter('1579901163323213209');" onmouseout="out('1579901163323213209');" style=""> 259       * A parser which adds a folder whose contents come from partner apk.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 260       */                                                                                                           </span>
<span class="-2406002401110994608" onmouseenter="enter('-2406002401110994608');" onmouseout="out('-2406002401110994608');" style=""> 261      private class PartnerFolderParser implements TagParser {                                                      </span>
<span  style=""> 262                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 263          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 264          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 265                  IOException {                                                                                     </span>
<span class="9058192063405184929" onmouseenter="enter('9058192063405184929');" onmouseout="out('9058192063405184929');" style=""> 266              // Folder contents come from an external XML resource                                                 </span>
<span class="-6415916158480032673" onmouseenter="enter('-6415916158480032673');" onmouseout="out('-6415916158480032673');" style=""> 267              final Partner partner = Partner.get(mPackageManager);                                                 </span>
<span class="-9215364277253785969" onmouseenter="enter('-9215364277253785969');" onmouseout="out('-9215364277253785969');" style=""> 268              if (partner != null) {                                                                                </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 269                  final Resources partnerRes = partner.getResources();                                              </span>
<span class="-8656173913287474605" onmouseenter="enter('-8656173913287474605');" onmouseout="out('-8656173913287474605');" style=""> 270                  final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER,                                    </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 271                          &quot;xml&quot;, partner.getPackageName());                                                         </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 272                  if (resId != 0) {                                                                                 </span>
<span class="5087581180241899012" onmouseenter="enter('5087581180241899012');" onmouseout="out('5087581180241899012');" style=""> 273                      final XmlResourceParser partnerParser = partnerRes.getXml(resId);                             </span>
<span class="7615154974472081807" onmouseenter="enter('7615154974472081807');" onmouseout="out('7615154974472081807');" style=""> 274                      beginDocument(partnerParser, TAG_FOLDER);                                                     </span>
<span  style=""> 275                                                                                                                    </span>
<span class="8060532263905830482" onmouseenter="enter('8060532263905830482');" onmouseout="out('8060532263905830482');" style=""> 276                      FolderParser folderParser = new FolderParser(getFolderElementsMap(partnerRes));               </span>
<span class="-8238770055449336686" onmouseenter="enter('-8238770055449336686');" onmouseout="out('-8238770055449336686');" style=""> 277                      return folderParser.parseAndAdd(partnerParser);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279              }                                                                                                     </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 280              return -1;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282      }                                                                                                             </span>
<span  style=""> 283                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 284      /**                                                                                                           </span>
<span class="8278041230656125878" onmouseenter="enter('8278041230656125878');" onmouseout="out('8278041230656125878');" style=""> 285       * An extension of FolderParser which allows adding items from a different xml.                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 286       */                                                                                                           </span>
<span class="-8854772189599396750" onmouseenter="enter('-8854772189599396750');" onmouseout="out('-8854772189599396750');" style=""> 287      private class MyFolderParser extends FolderParser {                                                           </span>
<span  style=""> 288                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 289          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 290          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 291                  IOException {                                                                                     </span>
<span class="3231178325674503525" onmouseenter="enter('3231178325674503525');" onmouseout="out('3231178325674503525');" style=""> 292              final int resId = getAttributeResourceValue(parser, ATTR_FOLDER_ITEMS, 0);                            </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 293              if (resId != 0) {                                                                                     </span>
<span class="-582766932060535096" onmouseenter="enter('-582766932060535096');" onmouseout="out('-582766932060535096');" style=""> 294                  parser = mSourceRes.getXml(resId);                                                                </span>
<span class="5069593388582006904" onmouseenter="enter('5069593388582006904');" onmouseout="out('5069593388582006904');" style=""> 295                  beginDocument(parser, TAG_FOLDER);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296              }                                                                                                     </span>
<span class="-5602508129346726029" onmouseenter="enter('-5602508129346726029');" onmouseout="out('-5602508129346726029');" style=""> 297              return super.parseAndAdd(parser);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="5824586583419512860" onmouseenter="enter('5824586583419512860');" onmouseout="out('5824586583419512860');" style="">   1  package com.android.launcher3;                                                                                    </span>
<span  style="">   2                                                                                                                    </span>
<span class="504928717176532115" onmouseenter="enter('504928717176532115');" onmouseout="out('504928717176532115');" style="">   3  import android.appwidget.AppWidgetHost;                                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   5  import android.content.Intent;                                                                                    </span>
<span class="-9183914406029598577" onmouseenter="enter('-9183914406029598577');" onmouseout="out('-9183914406029598577');" style="">   6  import android.content.pm.ActivityInfo;                                                                           </span>
<span class="-841431222158024655" onmouseenter="enter('-841431222158024655');" onmouseout="out('-841431222158024655');" style="">   7  import android.content.pm.ApplicationInfo;                                                                        </span>
<span class="-1290624633738557221" onmouseenter="enter('-1290624633738557221');" onmouseout="out('-1290624633738557221');" style="">   8  import android.content.pm.PackageManager;                                                                         </span>
<span class="8582326229770324815" onmouseenter="enter('8582326229770324815');" onmouseout="out('8582326229770324815');" style="">   9  import android.content.pm.ResolveInfo;                                                                            </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  10  import android.content.res.Resources;                                                                             </span>
<span class="7386012112211289620" onmouseenter="enter('7386012112211289620');" onmouseout="out('7386012112211289620');" style="">  11  import android.content.res.XmlResourceParser;                                                                     </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  12  import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  13  import android.util.Log;                                                                                          </span>
<span  style="">  14                                                                                                                    </span>
<span class="6281159490246877388" onmouseenter="enter('6281159490246877388');" onmouseout="out('6281159490246877388');" style="">  15  import com.android.launcher3.LauncherSettings.Favorites;                                                          </span>
<span  style="">  16                                                                                                                    </span>
<span class="-5145222340437954675" onmouseenter="enter('-5145222340437954675');" onmouseout="out('-5145222340437954675');" style="">  17  import org.xmlpull.v1.XmlPullParser;                                                                              </span>
<span class="-3477173242969633951" onmouseenter="enter('-3477173242969633951');" onmouseout="out('-3477173242969633951');" style="">  18  import org.xmlpull.v1.XmlPullParserException;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  20  import java.io.IOException;                                                                                       </span>
<span class="7911689652558139170" onmouseenter="enter('7911689652558139170');" onmouseout="out('7911689652558139170');" style="">  21  import java.net.URISyntaxException;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import java.util.ArrayList;                                                                                       </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  23  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  24  import java.util.List;                                                                                            </span>
<span  style="">  25                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  26  /**                                                                                                               </span>
<span class="8625030305996545010" onmouseenter="enter('8625030305996545010');" onmouseout="out('8625030305996545010');" style="">  27   * Implements the layout parser with rules for internal layouts and partner layouts.                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  28   */                                                                                                               </span>
<span class="-4383609652675664527" onmouseenter="enter('-4383609652675664527');" onmouseout="out('-4383609652675664527');" style="">  29  public class DefaultLayoutParser extends AutoInstallsLayout {                                                     </span>
<span class="6838912681597350908" onmouseenter="enter('6838912681597350908');" onmouseout="out('6838912681597350908');" style="">  30      private static final String TAG = &quot;DefaultLayoutParser&quot;;                                                      </span>
<span  style="">  31                                                                                                                    </span>
<span class="-9177351901961504515" onmouseenter="enter('-9177351901961504515');" onmouseout="out('-9177351901961504515');" style="">  32      private static final String TAG_RESOLVE = &quot;resolve&quot;;                                                          </span>

<span class="-6648556986475948603" onmouseenter="enter('-6648556986475948603');" onmouseout="out('-6648556986475948603');" style="">  33      private static final String TAG_FAVORITES = &quot;favorites&quot;;                                                      </span>
<span class="2417919475469446038" onmouseenter="enter('2417919475469446038');" onmouseout="out('2417919475469446038');" style="">  34      private static final String TAG_FAVORITE = &quot;favorite&quot;;                                                        </span>

<span class="8817783213080628620" onmouseenter="enter('8817783213080628620');" onmouseout="out('8817783213080628620');" style="">  35      private static final String TAG_APPWIDGET = &quot;appwidget&quot;;                                                      </span>
<span class="1544013162193549447" onmouseenter="enter('1544013162193549447');" onmouseout="out('1544013162193549447');" style="">  36      private static final String TAG_SHORTCUT = &quot;shortcut&quot;;                                                        </span>
<span class="-5715927654015021253" onmouseenter="enter('-5715927654015021253');" onmouseout="out('-5715927654015021253');" style="">  37      private static final String TAG_FOLDER = &quot;folder&quot;;                                                            </span>
<span class="-6175494568545371270" onmouseenter="enter('-6175494568545371270');" onmouseout="out('-6175494568545371270');" style="">  38      private static final String TAG_PARTNER_FOLDER = &quot;partner-folder&quot;;                                            </span>
<span class="-5562355841128428217" onmouseenter="enter('-5562355841128428217');" onmouseout="out('-5562355841128428217');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -    private static final String TAG_INCLUDE = &quot;include&quot;;                                                          </span>
<span  style="">  40                                                                                                                    </span>
<span class="-5345085314000449361" onmouseenter="enter('-5345085314000449361');" onmouseout="out('-5345085314000449361');" style="">  41      private static final String ATTR_URI = &quot;uri&quot;;                                                                 </span>

<span class="-5893198944478773555" onmouseenter="enter('-5893198944478773555');" onmouseout="out('-5893198944478773555');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -    private static final String ATTR_WORKSPACE = &quot;workspace&quot;;                                                     </span>
<span class="2414249740748360985" onmouseenter="enter('2414249740748360985');" onmouseout="out('2414249740748360985');" style="">  43      private static final String ATTR_CONTAINER = &quot;container&quot;;                                                     </span>
<span class="-389066511444324935" onmouseenter="enter('-389066511444324935');" onmouseout="out('-389066511444324935');" style="">  44      private static final String ATTR_SCREEN = &quot;screen&quot;;                                                           </span>
<span class="1567909548797839052" onmouseenter="enter('1567909548797839052');" onmouseout="out('1567909548797839052');" style="">  45      private static final String ATTR_FOLDER_ITEMS = &quot;folderItems&quot;;                                                </span>
<span  style="">  46                                                                                                                    </span>
<span class="-8354363952691978188" onmouseenter="enter('-8354363952691978188');" onmouseout="out('-8354363952691978188');" style="">  47      public DefaultLayoutParser(Context context, AppWidgetHost appWidgetHost,                                      </span>
<span class="2852391764281860202" onmouseenter="enter('2852391764281860202');" onmouseout="out('2852391764281860202');" style="">  48              LayoutParserCallback callback, Resources sourceRes, int layoutId) {                                   </span>
<span class="7279694431066637071" onmouseenter="enter('7279694431066637071');" onmouseout="out('7279694431066637071');" style="">  49          super(context, appWidgetHost, callback, sourceRes, layoutId, TAG_FAVORITES);                              </span>
<span class="-872114900452253526" onmouseenter="enter('-872114900452253526');" onmouseout="out('-872114900452253526');" style="">  50          Log.e(TAG, &quot;Default layout parser initialized&quot;);                                                          </span>






<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  51      }                                                                                                             </span>
<span  style="">  52                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  53      @Override                                                                                                     </span>
<span class="-8135337961010470432" onmouseenter="enter('-8135337961010470432');" onmouseout="out('-8135337961010470432');" style="">  54      protected HashMap&lt;String, TagParser&gt; getFolderElementsMap() {                                                 </span>
<span class="423350535395751664" onmouseenter="enter('423350535395751664');" onmouseout="out('423350535395751664');" style="">  55          return getFolderElementsMap(mSourceRes);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  56      }                                                                                                             </span>
<span  style="">  57                                                                                                                    </span>
<span class="2700844173783892803" onmouseenter="enter('2700844173783892803');" onmouseout="out('2700844173783892803');" style="">  58      private HashMap&lt;String, TagParser&gt; getFolderElementsMap(Resources res) {                                      </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  59          HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                                    </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  60          parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                                </span>
<span class="-8627156416288422237" onmouseenter="enter('-8627156416288422237');" onmouseout="out('-8627156416288422237');" style="">  61          parsers.put(TAG_SHORTCUT, new UriShortcutParser(res));                                                    </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  62          return parsers;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  63      }                                                                                                             </span>
<span  style="">  64                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  65      @Override                                                                                                     </span>
<span class="7427983078574486125" onmouseenter="enter('7427983078574486125');" onmouseout="out('7427983078574486125');" style="">  66      protected HashMap&lt;String, TagParser&gt; getLayoutElementsMap() {                                                 </span>
<span class="8000015883772418693" onmouseenter="enter('8000015883772418693');" onmouseout="out('8000015883772418693');" style="">  67          HashMap&lt;String, TagParser&gt; parsers = new HashMap&lt;String, TagParser&gt;();                                    </span>
<span class="887988054378845435" onmouseenter="enter('887988054378845435');" onmouseout="out('887988054378845435');" style="">  68          parsers.put(TAG_FAVORITE, new AppShortcutWithUriParser());                                                </span>
<span class="-2800106172813247359" onmouseenter="enter('-2800106172813247359');" onmouseout="out('-2800106172813247359');" style="">  69          parsers.put(TAG_APPWIDGET, new AppWidgetParser());                                                        </span>
<span class="2292493876717618109" onmouseenter="enter('2292493876717618109');" onmouseout="out('2292493876717618109');" style="">  70          parsers.put(TAG_SHORTCUT, new UriShortcutParser(mSourceRes));                                             </span>
<span class="5801084860772407385" onmouseenter="enter('5801084860772407385');" onmouseout="out('5801084860772407385');" style="">  71          parsers.put(TAG_RESOLVE, new ResolveParser());                                                            </span>
<span class="-6794856990865836500" onmouseenter="enter('-6794856990865836500');" onmouseout="out('-6794856990865836500');" style="">  72          parsers.put(TAG_FOLDER, new MyFolderParser());                                                            </span>
<span class="7891389292838004786" onmouseenter="enter('7891389292838004786');" onmouseout="out('7891389292838004786');" style="">  73          parsers.put(TAG_PARTNER_FOLDER, new PartnerFolderParser());                                               </span>
<span class="3590330577627869184" onmouseenter="enter('3590330577627869184');" onmouseout="out('3590330577627869184');" style="">  74          return parsers;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75      }                                                                                                             </span>
<span  style="">  76                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77      @Override                                                                                                     </span>
<span class="8392363038715364208" onmouseenter="enter('8392363038715364208');" onmouseout="out('8392363038715364208');" style="">  78      protected void parseContainerAndScreen(XmlResourceParser parser, long[] out) {                                </span>
<span class="-2089348695795856159" onmouseenter="enter('-2089348695795856159');" onmouseout="out('-2089348695795856159');" style="">  79          out[0] = LauncherSettings.Favorites.CONTAINER_DESKTOP;                                                    </span>
<span class="-8953477941003932421" onmouseenter="enter('-8953477941003932421');" onmouseout="out('-8953477941003932421');" style="">  80          String strContainer = getAttributeValue(parser, ATTR_CONTAINER);                                          </span>
<span class="4899636274002469854" onmouseenter="enter('4899636274002469854');" onmouseout="out('4899636274002469854');" style="">  81          if (strContainer != null) {                                                                               </span>
<span class="5058638331917318804" onmouseenter="enter('5058638331917318804');" onmouseout="out('5058638331917318804');" style="">  82              out[0] = Long.valueOf(strContainer);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83          }                                                                                                         </span>
<span class="-7003063245651866001" onmouseenter="enter('-7003063245651866001');" onmouseout="out('-7003063245651866001');" style="">  84          out[1] = Long.parseLong(getAttributeValue(parser, ATTR_SCREEN));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -    @Override                                                                                                     </span>
<span class="5790746152821979500" onmouseenter="enter('5790746152821979500');" onmouseout="out('5790746152821979500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -    protected int parseAndAddNode(                                                                                </span>
<span class="-2373089251837970851" onmouseenter="enter('-2373089251837970851');" onmouseout="out('-2373089251837970851');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -            XmlResourceParser parser,                                                                             </span>
<span class="-872085258501142185" onmouseenter="enter('-872085258501142185');" onmouseout="out('-872085258501142185');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -            HashMap&lt;String, TagParser&gt; tagParserMap,                                                              </span>
<span class="-8579938981619154329" onmouseenter="enter('-8579938981619154329');" onmouseout="out('-8579938981619154329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -            ArrayList&lt;Long&gt; screenIds)                                                                            </span>
<span class="-2080139816352784756" onmouseenter="enter('-2080139816352784756');" onmouseout="out('-2080139816352784756');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -                    throws XmlPullParserException, IOException {                                                  </span>
<span class="1229850105348499279" onmouseenter="enter('1229850105348499279');" onmouseout="out('1229850105348499279');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -        if (TAG_INCLUDE.equals(parser.getName())) {                                                               </span>
<span class="7620964305819267835" onmouseenter="enter('7620964305819267835');" onmouseout="out('7620964305819267835');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -            final int resId = getAttributeResourceValue(parser, ATTR_WORKSPACE, 0);                               </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -            if (resId != 0) {                                                                                     </span>
<span class="-8087579639415016515" onmouseenter="enter('-8087579639415016515');" onmouseout="out('-8087579639415016515');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -                // recursively load some more favorites, why not?                                                 </span>
<span class="-6570658120834925918" onmouseenter="enter('-6570658120834925918');" onmouseout="out('-6570658120834925918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -                return parseLayout(resId, screenIds);                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -            } else {                                                                                              </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -                return 0;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -            }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -        } else {                                                                                                  </span>
<span class="-6025340927376373949" onmouseenter="enter('-6025340927376373949');" onmouseout="out('-6025340927376373949');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -            return super.parseAndAddNode(parser, tagParserMap, screenIds);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104      }                                                                                                             </span>
<span  style=""> 105                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 106      /**                                                                                                           </span>
<span class="176933310960972051" onmouseenter="enter('176933310960972051');" onmouseout="out('176933310960972051');" style=""> 107       * AppShortcutParser which also supports adding URI based intents                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 108       */                                                                                                           </span>
<span class="-1162580724960192627" onmouseenter="enter('-1162580724960192627');" onmouseout="out('-1162580724960192627');" style=""> 109      private class AppShortcutWithUriParser extends AppShortcutParser {                                            </span>
<span  style=""> 110                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 111          @Override                                                                                                 </span>
<span class="11443433107327190" onmouseenter="enter('11443433107327190');" onmouseout="out('11443433107327190');" style=""> 112          protected long invalidPackageOrClass(XmlResourceParser parser) {                                          </span>
<span class="-1954941607715586859" onmouseenter="enter('-1954941607715586859');" onmouseout="out('-1954941607715586859');" style=""> 113              final String uri = getAttributeValue(parser, ATTR_URI);                                               </span>
<span class="-2611673916122599069" onmouseenter="enter('-2611673916122599069');" onmouseout="out('-2611673916122599069');" style=""> 114              if (TextUtils.isEmpty(uri)) {                                                                         </span>
<span class="-8012351384438033294" onmouseenter="enter('-8012351384438033294');" onmouseout="out('-8012351384438033294');" style=""> 115                  Log.e(TAG, &quot;Skipping invalid &lt;favorite&gt; with no component or uri&quot;);                               </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 116                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117              }                                                                                                     </span>
<span  style=""> 118                                                                                                                    </span>
<span class="7650863286169434864" onmouseenter="enter('7650863286169434864');" onmouseout="out('7650863286169434864');" style=""> 119              final Intent metaIntent;                                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 120              try {                                                                                                 </span>
<span class="3494981731706536607" onmouseenter="enter('3494981731706536607');" onmouseout="out('3494981731706536607');" style=""> 121                  metaIntent = Intent.parseUri(uri, 0);                                                             </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 122              } catch (URISyntaxException e) {                                                                      </span>
<span class="-948485523889053577" onmouseenter="enter('-948485523889053577');" onmouseout="out('-948485523889053577');" style=""> 123                  Log.e(TAG, &quot;Unable to add meta-favorite: &quot; + uri, e);                                             </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 124                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125              }                                                                                                     </span>
<span  style=""> 126                                                                                                                    </span>
<span class="8557033759361467860" onmouseenter="enter('8557033759361467860');" onmouseout="out('8557033759361467860');" style=""> 127              ResolveInfo resolved = mPackageManager.resolveActivity(metaIntent,                                    </span>
<span class="2456166036476176214" onmouseenter="enter('2456166036476176214');" onmouseout="out('2456166036476176214');" style=""> 128                      PackageManager.MATCH_DEFAULT_ONLY);                                                           </span>
<span class="-1300490748614024222" onmouseenter="enter('-1300490748614024222');" onmouseout="out('-1300490748614024222');" style=""> 129              final List&lt;ResolveInfo&gt; appList = mPackageManager.queryIntentActivities(                              </span>
<span class="8656178102542661668" onmouseenter="enter('8656178102542661668');" onmouseout="out('8656178102542661668');" style=""> 130                      metaIntent, PackageManager.MATCH_DEFAULT_ONLY);                                               </span>
<span  style=""> 131                                                                                                                    </span>
<span class="3807468246607352644" onmouseenter="enter('3807468246607352644');" onmouseout="out('3807468246607352644');" style=""> 132              // Verify that the result is an app and not just the resolver dialog asking which                     </span>
<span class="3786398014846262159" onmouseenter="enter('3786398014846262159');" onmouseout="out('3786398014846262159');" style=""> 133              // app to use.                                                                                        </span>
<span class="-2527999738736768738" onmouseenter="enter('-2527999738736768738');" onmouseout="out('-2527999738736768738');" style=""> 134              if (wouldLaunchResolverActivity(resolved, appList)) {                                                 </span>
<span class="-1508864482817632041" onmouseenter="enter('-1508864482817632041');" onmouseout="out('-1508864482817632041');" style=""> 135                  // If only one of the results is a system app then choose that as the default.                    </span>
<span class="7096358968319388823" onmouseenter="enter('7096358968319388823');" onmouseout="out('7096358968319388823');" style=""> 136                  final ResolveInfo systemApp = getSingleSystemActivity(appList);                                   </span>
<span class="3112641083889325831" onmouseenter="enter('3112641083889325831');" onmouseout="out('3112641083889325831');" style=""> 137                  if (systemApp == null) {                                                                          </span>
<span class="8733485116897338114" onmouseenter="enter('8733485116897338114');" onmouseout="out('8733485116897338114');" style=""> 138                      // There is no logical choice for this meta-favorite, so rather than making                   </span>
<span class="-5798817995675177798" onmouseenter="enter('-5798817995675177798');" onmouseout="out('-5798817995675177798');" style=""> 139                      // a bad choice just add nothing.                                                             </span>
<span class="8234306782594839467" onmouseenter="enter('8234306782594839467');" onmouseout="out('8234306782594839467');" style=""> 140                      Log.w(TAG, &quot;No preference or single system activity found for &quot;                               </span>
<span class="-4585840856389419283" onmouseenter="enter('-4585840856389419283');" onmouseout="out('-4585840856389419283');" style=""> 141                              + metaIntent.toString());                                                             </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 142                      return -1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143                  }                                                                                                 </span>
<span class="-2210262899281174552" onmouseenter="enter('-2210262899281174552');" onmouseout="out('-2210262899281174552');" style=""> 144                  resolved = systemApp;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145              }                                                                                                     </span>
<span class="3942116430564013468" onmouseenter="enter('3942116430564013468');" onmouseout="out('3942116430564013468');" style=""> 146              final ActivityInfo info = resolved.activityInfo;                                                      </span>
<span class="-360088289411741304" onmouseenter="enter('-360088289411741304');" onmouseout="out('-360088289411741304');" style=""> 147              final Intent intent = mPackageManager.getLaunchIntentForPackage(info.packageName);                    </span>
<span class="-8400111569787613467" onmouseenter="enter('-8400111569787613467');" onmouseout="out('-8400111569787613467');" style=""> 148              if (intent == null) {                                                                                 </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 149                  return -1;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150              }                                                                                                     </span>
<span class="2514039366923723926" onmouseenter="enter('2514039366923723926');" onmouseout="out('2514039366923723926');" style=""> 151              intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |                                                       </span>
<span class="754211306232040187" onmouseenter="enter('754211306232040187');" onmouseout="out('754211306232040187');" style=""> 152                      Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);                                                   </span>
<span  style=""> 153                                                                                                                    </span>
<span class="-4701923995052302611" onmouseenter="enter('-4701923995052302611');" onmouseout="out('-4701923995052302611');" style=""> 154              return addShortcut(info.loadLabel(mPackageManager).toString(), intent,                                </span>
<span class="-3250487283659008470" onmouseenter="enter('-3250487283659008470');" onmouseout="out('-3250487283659008470');" style=""> 155                      Favorites.ITEM_TYPE_APPLICATION);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156          }                                                                                                         </span>
<span  style=""> 157                                                                                                                    </span>
<span class="3433873162423347490" onmouseenter="enter('3433873162423347490');" onmouseout="out('3433873162423347490');" style=""> 158          private ResolveInfo getSingleSystemActivity(List&lt;ResolveInfo&gt; appList) {                                  </span>
<span class="4100859717391359582" onmouseenter="enter('4100859717391359582');" onmouseout="out('4100859717391359582');" style=""> 159              ResolveInfo systemResolve = null;                                                                     </span>
<span class="-6501614514316220785" onmouseenter="enter('-6501614514316220785');" onmouseout="out('-6501614514316220785');" style=""> 160              final int N = appList.size();                                                                         </span>
<span class="-7972660160186921434" onmouseenter="enter('-7972660160186921434');" onmouseout="out('-7972660160186921434');" style=""> 161              for (int i = 0; i &lt; N; ++i) {                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 162                  try {                                                                                             </span>
<span class="6969736750563256446" onmouseenter="enter('6969736750563256446');" onmouseout="out('6969736750563256446');" style=""> 163                      ApplicationInfo info = mPackageManager.getApplicationInfo(                                    </span>
<span class="1402648097889367388" onmouseenter="enter('1402648097889367388');" onmouseout="out('1402648097889367388');" style=""> 164                              appList.get(i).activityInfo.packageName, 0);                                          </span>
<span class="-476381142815111019" onmouseenter="enter('-476381142815111019');" onmouseout="out('-476381142815111019');" style=""> 165                      if ((info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0) {                                        </span>
<span class="-6460956471084206715" onmouseenter="enter('-6460956471084206715');" onmouseout="out('-6460956471084206715');" style=""> 166                          if (systemResolve != null) {                                                              </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 167                              return null;                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 168                          } else {                                                                                  </span>
<span class="-1920150334130463709" onmouseenter="enter('-1920150334130463709');" onmouseout="out('-1920150334130463709');" style=""> 169                              systemResolve = appList.get(i);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171                      }                                                                                             </span>
<span class="8932842947262589349" onmouseenter="enter('8932842947262589349');" onmouseout="out('8932842947262589349');" style=""> 172                  } catch (PackageManager.NameNotFoundException e) {                                                </span>
<span class="-265560973846634126" onmouseenter="enter('-265560973846634126');" onmouseout="out('-265560973846634126');" style=""> 173                      Log.w(TAG, &quot;Unable to get info about resolve results&quot;, e);                                    </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 174                      return null;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176              }                                                                                                     </span>
<span class="-7251347768060538731" onmouseenter="enter('-7251347768060538731');" onmouseout="out('-7251347768060538731');" style=""> 177              return systemResolve;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178          }                                                                                                         </span>
<span  style=""> 179                                                                                                                    </span>
<span class="-4222771116108434581" onmouseenter="enter('-4222771116108434581');" onmouseout="out('-4222771116108434581');" style=""> 180          private boolean wouldLaunchResolverActivity(ResolveInfo resolved,                                         </span>
<span class="8855822793352880756" onmouseenter="enter('8855822793352880756');" onmouseout="out('8855822793352880756');" style=""> 181                  List&lt;ResolveInfo&gt; appList) {                                                                      </span>
<span class="-6399418581489152967" onmouseenter="enter('-6399418581489152967');" onmouseout="out('-6399418581489152967');" style=""> 182              // If the list contains the above resolved activity, then it can&#x27;t be                                 </span>
<span class="4029821552264897243" onmouseenter="enter('4029821552264897243');" onmouseout="out('4029821552264897243');" style=""> 183              // ResolverActivity itself.                                                                           </span>
<span class="4411552974527624379" onmouseenter="enter('4411552974527624379');" onmouseout="out('4411552974527624379');" style=""> 184              for (int i = 0; i &lt; appList.size(); ++i) {                                                            </span>
<span class="-6814281994408040723" onmouseenter="enter('-6814281994408040723');" onmouseout="out('-6814281994408040723');" style=""> 185                  ResolveInfo tmp = appList.get(i);                                                                 </span>
<span class="-3160638667287468420" onmouseenter="enter('-3160638667287468420');" onmouseout="out('-3160638667287468420');" style=""> 186                  if (tmp.activityInfo.name.equals(resolved.activityInfo.name)                                      </span>
<span class="6821338150188138172" onmouseenter="enter('6821338150188138172');" onmouseout="out('6821338150188138172');" style=""> 187                          &amp;&amp; tmp.activityInfo.packageName.equals(resolved.activityInfo.packageName)) {              </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 188                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 191              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span  style=""> 195                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 196      /**                                                                                                           </span>
<span class="1574293742350901037" onmouseenter="enter('1574293742350901037');" onmouseout="out('1574293742350901037');" style=""> 197       * Shortcut parser which allows any uri and not just web urls.                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 198       */                                                                                                           </span>
<span class="-1541533161301288894" onmouseenter="enter('-1541533161301288894');" onmouseout="out('-1541533161301288894');" style=""> 199      private class UriShortcutParser extends ShortcutParser {                                                      </span>
<span  style=""> 200                                                                                                                    </span>
<span class="-44015680663593473" onmouseenter="enter('-44015680663593473');" onmouseout="out('-44015680663593473');" style=""> 201          public UriShortcutParser(Resources iconRes) {                                                             </span>
<span class="-2485453732023871858" onmouseenter="enter('-2485453732023871858');" onmouseout="out('-2485453732023871858');" style=""> 202              super(iconRes);                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203          }                                                                                                         </span>
<span  style=""> 204                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 205          @Override                                                                                                 </span>
<span class="-2889018356529531059" onmouseenter="enter('-2889018356529531059');" onmouseout="out('-2889018356529531059');" style=""> 206          protected Intent parseIntent(XmlResourceParser parser) {                                                  </span>
<span class="7870717952219178672" onmouseenter="enter('7870717952219178672');" onmouseout="out('7870717952219178672');" style=""> 207              String uri = null;                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 208              try {                                                                                                 </span>
<span class="-7650716598670279522" onmouseenter="enter('-7650716598670279522');" onmouseout="out('-7650716598670279522');" style=""> 209                  uri = getAttributeValue(parser, ATTR_URI);                                                        </span>
<span class="9146954199733398323" onmouseenter="enter('9146954199733398323');" onmouseout="out('9146954199733398323');" style=""> 210                  return Intent.parseUri(uri, 0);                                                                   </span>
<span class="900563632545065451" onmouseenter="enter('900563632545065451');" onmouseout="out('900563632545065451');" style=""> 211              } catch (URISyntaxException e) {                                                                      </span>
<span class="-551028723023595678" onmouseenter="enter('-551028723023595678');" onmouseout="out('-551028723023595678');" style=""> 212                  Log.w(TAG, &quot;Shortcut has malformed uri: &quot; + uri);                                                 </span>
<span class="6664617886922048676" onmouseenter="enter('6664617886922048676');" onmouseout="out('6664617886922048676');" style=""> 213                  return null; // Oh well                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216      }                                                                                                             </span>
<span  style=""> 217                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 218      /**                                                                                                           </span>
<span class="-6891708564780781113" onmouseenter="enter('-6891708564780781113');" onmouseout="out('-6891708564780781113');" style=""> 219       * Contains a list of &lt;favorite&gt; nodes, and accepts the first successfully parsed node.                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 220       */                                                                                                           </span>
<span class="1250232012414458582" onmouseenter="enter('1250232012414458582');" onmouseout="out('1250232012414458582');" style=""> 221      private class ResolveParser implements TagParser {                                                            </span>

<span  style=""> 222                                                                                                                    </span>
<span class="-3602839532613707268" onmouseenter="enter('-3602839532613707268');" onmouseout="out('-3602839532613707268');" style=""> 223          private final AppShortcutWithUriParser mChildParser = new AppShortcutWithUriParser();                     </span>
<span  style=""> 224                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 225          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 226          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 227                  IOException {                                                                                     </span>
<span class="-7289409140421595237" onmouseenter="enter('-7289409140421595237');" onmouseout="out('-7289409140421595237');" style=""> 228              final int groupDepth = parser.getDepth();                                                             </span>
<span class="3163913122247807134" onmouseenter="enter('3163913122247807134');" onmouseout="out('3163913122247807134');" style=""> 229              int type;                                                                                             </span>
<span class="-3096071360726764577" onmouseenter="enter('-3096071360726764577');" onmouseout="out('-3096071360726764577');" style=""> 230              long addedId = -1;                                                                                    </span>
<span class="-2406917717669951461" onmouseenter="enter('-2406917717669951461');" onmouseout="out('-2406917717669951461');" style=""> 231              while ((type = parser.next()) != XmlPullParser.END_TAG ||                                             </span>
<span class="8687802670126733847" onmouseenter="enter('8687802670126733847');" onmouseout="out('8687802670126733847');" style=""> 232                      parser.getDepth() &gt; groupDepth) {                                                             </span>
<span class="-3010059378649710289" onmouseenter="enter('-3010059378649710289');" onmouseout="out('-3010059378649710289');" style=""> 233                  if (type != XmlPullParser.START_TAG || addedId &gt; -1) {                                            </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 234                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235                  }                                                                                                 </span>
<span class="-4826163157610997597" onmouseenter="enter('-4826163157610997597');" onmouseout="out('-4826163157610997597');" style=""> 236                  final String fallback_item_name = parser.getName();                                               </span>
<span class="3394509129787922860" onmouseenter="enter('3394509129787922860');" onmouseout="out('3394509129787922860');" style=""> 237                  if (TAG_FAVORITE.equals(fallback_item_name)) {                                                    </span>
<span class="-5252464721487850402" onmouseenter="enter('-5252464721487850402');" onmouseout="out('-5252464721487850402');" style=""> 238                      addedId = mChildParser.parseAndAdd(parser);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 239                  } else {                                                                                          </span>
<span class="-6448281100759930849" onmouseenter="enter('-6448281100759930849');" onmouseout="out('-6448281100759930849');" style=""> 240                      Log.e(TAG, &quot;Fallback groups can contain only favorites, found &quot;                               </span>
<span class="1123550495059434881" onmouseenter="enter('1123550495059434881');" onmouseout="out('1123550495059434881');" style=""> 241                              + fallback_item_name);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243              }                                                                                                     </span>
<span class="2168288094559194745" onmouseenter="enter('2168288094559194745');" onmouseout="out('2168288094559194745');" style=""> 244              return addedId;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 248      /**                                                                                                           </span>
<span class="1579901163323213209" onmouseenter="enter('1579901163323213209');" onmouseout="out('1579901163323213209');" style=""> 249       * A parser which adds a folder whose contents come from partner apk.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 250       */                                                                                                           </span>
<span class="-2406002401110994608" onmouseenter="enter('-2406002401110994608');" onmouseout="out('-2406002401110994608');" style=""> 251      private class PartnerFolderParser implements TagParser {                                                      </span>
<span  style=""> 252                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 253          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 254          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 255                  IOException {                                                                                     </span>
<span class="9058192063405184929" onmouseenter="enter('9058192063405184929');" onmouseout="out('9058192063405184929');" style=""> 256              // Folder contents come from an external XML resource                                                 </span>
<span class="-6415916158480032673" onmouseenter="enter('-6415916158480032673');" onmouseout="out('-6415916158480032673');" style=""> 257              final Partner partner = Partner.get(mPackageManager);                                                 </span>
<span class="-9215364277253785969" onmouseenter="enter('-9215364277253785969');" onmouseout="out('-9215364277253785969');" style=""> 258              if (partner != null) {                                                                                </span>
<span class="882794219866203698" onmouseenter="enter('882794219866203698');" onmouseout="out('882794219866203698');" style=""> 259                  final Resources partnerRes = partner.getResources();                                              </span>
<span class="-8656173913287474605" onmouseenter="enter('-8656173913287474605');" onmouseout="out('-8656173913287474605');" style=""> 260                  final int resId = partnerRes.getIdentifier(Partner.RES_FOLDER,                                    </span>
<span class="-8179104168031182438" onmouseenter="enter('-8179104168031182438');" onmouseout="out('-8179104168031182438');" style=""> 261                          &quot;xml&quot;, partner.getPackageName());                                                         </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 262                  if (resId != 0) {                                                                                 </span>
<span class="5087581180241899012" onmouseenter="enter('5087581180241899012');" onmouseout="out('5087581180241899012');" style=""> 263                      final XmlResourceParser partnerParser = partnerRes.getXml(resId);                             </span>
<span class="7615154974472081807" onmouseenter="enter('7615154974472081807');" onmouseout="out('7615154974472081807');" style=""> 264                      beginDocument(partnerParser, TAG_FOLDER);                                                     </span>
<span  style=""> 265                                                                                                                    </span>
<span class="8060532263905830482" onmouseenter="enter('8060532263905830482');" onmouseout="out('8060532263905830482');" style=""> 266                      FolderParser folderParser = new FolderParser(getFolderElementsMap(partnerRes));               </span>
<span class="-8238770055449336686" onmouseenter="enter('-8238770055449336686');" onmouseout="out('-8238770055449336686');" style=""> 267                      return folderParser.parseAndAdd(partnerParser);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269              }                                                                                                     </span>
<span class="7311380543145824752" onmouseenter="enter('7311380543145824752');" onmouseout="out('7311380543145824752');" style=""> 270              return -1;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 274      /**                                                                                                           </span>
<span class="8278041230656125878" onmouseenter="enter('8278041230656125878');" onmouseout="out('8278041230656125878');" style=""> 275       * An extension of FolderParser which allows adding items from a different xml.                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 276       */                                                                                                           </span>
<span class="-8854772189599396750" onmouseenter="enter('-8854772189599396750');" onmouseout="out('-8854772189599396750');" style=""> 277      private class MyFolderParser extends FolderParser {                                                           </span>
<span  style=""> 278                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 279          @Override                                                                                                 </span>
<span class="8430982540700990569" onmouseenter="enter('8430982540700990569');" onmouseout="out('8430982540700990569');" style=""> 280          public long parseAndAdd(XmlResourceParser parser) throws XmlPullParserException,                          </span>
<span class="525869784200411052" onmouseenter="enter('525869784200411052');" onmouseout="out('525869784200411052');" style=""> 281                  IOException {                                                                                     </span>
<span class="3231178325674503525" onmouseenter="enter('3231178325674503525');" onmouseout="out('3231178325674503525');" style=""> 282              final int resId = getAttributeResourceValue(parser, ATTR_FOLDER_ITEMS, 0);                            </span>
<span class="-5151212692288250908" onmouseenter="enter('-5151212692288250908');" onmouseout="out('-5151212692288250908');" style=""> 283              if (resId != 0) {                                                                                     </span>
<span class="-582766932060535096" onmouseenter="enter('-582766932060535096');" onmouseout="out('-582766932060535096');" style=""> 284                  parser = mSourceRes.getXml(resId);                                                                </span>
<span class="5069593388582006904" onmouseenter="enter('5069593388582006904');" onmouseout="out('5069593388582006904');" style=""> 285                  beginDocument(parser, TAG_FOLDER);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286              }                                                                                                     </span>
<span class="-5602508129346726029" onmouseenter="enter('-5602508129346726029');" onmouseout="out('-5602508129346726029');" style=""> 287              return super.parseAndAdd(parser);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            