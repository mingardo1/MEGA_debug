<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>74</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    74
                    <a href="73.html">prev</a>
                    <a href="75.html">next</a>
                    <a href="74_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    AriaLyy/Aria_99d857f3383c60ae4ae008f74e7d2b32afe9c26a_Aria/src/main/java/com/arialyy/aria/core/scheduler/DownloadSchedulers.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;99d857f3383c60ae4ae008f74e7d2b32afe9c26a:Aria/src/main/java/com/arialyy/aria/core/scheduler/DownloadSchedulers.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;99d857f3383c60ae4ae008f74e7d2b32afe9c26a^1:Aria/src/main/java/com/arialyy/aria/core/scheduler/DownloadSchedulers.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;99d857f3383c60ae4ae008f74e7d2b32afe9c26a^2:Aria/src/main/java/com/arialyy/aria/core/scheduler/DownloadSchedulers.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\AriaLyy\Aria show &quot;41154d47fb8664ddca206122d28b50a6a3b8e9a6:Aria/src/main/java/com/arialyy/aria/core/scheduler/DownloadSchedulers.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [bj], [b], [b], [b], [j], [s]], subset: [[b], [bs], [bj], [bj], [b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="-3312156477302878812" onmouseenter="enter('-3312156477302878812');" onmouseout="out('-3312156477302878812');" style="">  17 package com.arialyy.aria.core.scheduler;                                                                 </span>
<span  style="">  18                                                                                                          </span>
<span class="371096003059305121" onmouseenter="enter('371096003059305121');" onmouseout="out('371096003059305121');" style="">  19 import android.os.CountDownTimer;                                                                        </span>
<span class="2113358441178436248" onmouseenter="enter('2113358441178436248');" onmouseout="out('2113358441178436248');" style="">  20 import android.os.Message;                                                                               </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  21 import android.util.Log;                                                                                 </span>
<span class="1325372506799583582" onmouseenter="enter('1325372506799583582');" onmouseout="out('1325372506799583582');" style="">  22 import com.arialyy.aria.core.queue.DownloadTaskQueue;                                                    </span>
<span class="1932658903610588883" onmouseenter="enter('1932658903610588883');" onmouseout="out('1932658903610588883');" style="">  23 import com.arialyy.aria.core.download.DownloadEntity;                                                    </span>
<span class="-2556631877775212617" onmouseenter="enter('-2556631877775212617');" onmouseout="out('-2556631877775212617');" style="">  24 import com.arialyy.aria.core.download.DownloadTask;                                                      </span>
<span class="-288495809736068445" onmouseenter="enter('-288495809736068445');" onmouseout="out('-288495809736068445');" style="">  25 import com.arialyy.aria.util.Configuration;                                                              </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  26 import java.util.Iterator;                                                                               </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  27 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  28 import java.util.Set;                                                                                    </span>
<span class="8600016768069240092" onmouseenter="enter('8600016768069240092');" onmouseout="out('8600016768069240092');" style="">  29 import java.util.concurrent.ConcurrentHashMap;                                                           </span>
<span  style="">  30                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  31 /**                                                                                                      </span>
<span class="-3542925026229653469" onmouseenter="enter('-3542925026229653469');" onmouseout="out('-3542925026229653469');" style="">  32  * Created by lyy on 2016/8/16.                                                                          </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="">  33  * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  34  */                                                                                                      </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  35 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="4304627110649516611" onmouseenter="enter('4304627110649516611');" onmouseout="out('4304627110649516611');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  36 public class DownloadSchedulers implements IDownloadSchedulers {                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37   /**                                                                                                    </span>
<span class="-6909290071230674405" onmouseenter="enter('-6909290071230674405');" onmouseout="out('-6909290071230674405');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  38    * 任务预加载                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  39    */                                                                                                    </span>
<span class="621905077341889805" onmouseenter="enter('621905077341889805');" onmouseout="out('621905077341889805');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40   public static final     int                PRE      = 0;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41   /**                                                                                                    </span>
<span class="-8586305757395820434" onmouseenter="enter('-8586305757395820434');" onmouseout="out('-8586305757395820434');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42    * 任务开始                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  43    */                                                                                                    </span>
<span class="5854176642066686753" onmouseenter="enter('5854176642066686753');" onmouseout="out('5854176642066686753');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  44   public static final     int                START    = 1;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  45   /**                                                                                                    </span>
<span class="-5690582150325294743" onmouseenter="enter('-5690582150325294743');" onmouseout="out('-5690582150325294743');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  46    * 任务停止                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  47    */                                                                                                    </span>
<span class="7072236631644491578" onmouseenter="enter('7072236631644491578');" onmouseout="out('7072236631644491578');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  48   public static final     int                STOP     = 2;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  49   /**                                                                                                    </span>
<span class="7725539954827761966" onmouseenter="enter('7725539954827761966');" onmouseout="out('7725539954827761966');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50    * 任务失败                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51    */                                                                                                    </span>
<span class="7445939163633569925" onmouseenter="enter('7445939163633569925');" onmouseout="out('7445939163633569925');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52   public static final     int                FAIL     = 3;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  53   /**                                                                                                    </span>
<span class="2064875861948696274" onmouseenter="enter('2064875861948696274');" onmouseout="out('2064875861948696274');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  54    * 任务取消                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  55    */                                                                                                    </span>
<span class="-7738869181134989471" onmouseenter="enter('-7738869181134989471');" onmouseout="out('-7738869181134989471');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56   public static final     int                CANCEL   = 4;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57   /**                                                                                                    </span>
<span class="-5025359896728506958" onmouseenter="enter('-5025359896728506958');" onmouseout="out('-5025359896728506958');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58    * 任务完成                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  59    */                                                                                                    </span>
<span class="-7939522823297918743" onmouseenter="enter('-7939522823297918743');" onmouseout="out('-7939522823297918743');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60   public static final     int                COMPLETE = 5;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61   /**                                                                                                    </span>
<span class="7866565969200819017" onmouseenter="enter('7866565969200819017');" onmouseout="out('7866565969200819017');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  62    * 下载中                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  63    */                                                                                                    </span>
<span class="5237573137659845133" onmouseenter="enter('5237573137659845133');" onmouseout="out('5237573137659845133');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  64   public static final     int                RUNNING  = 6;                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65   /**                                                                                                    </span>
<span class="-4583384747655535323" onmouseenter="enter('-4583384747655535323');" onmouseout="out('-4583384747655535323');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66    * 恢复下载                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67    */                                                                                                    </span>
<span class="5841509014307126013" onmouseenter="enter('5841509014307126013');" onmouseout="out('5841509014307126013');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  68   public static final     int                RESUME   = 7;                                               </span>
<span class="5658848929593010938" onmouseenter="enter('5658848929593010938');" onmouseout="out('5658848929593010938');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  69   private static final    String             TAG      = &quot;DownloadSchedulers&quot;;                            </span>
<span class="-530418496755553317" onmouseenter="enter('-530418496755553317');" onmouseout="out('-530418496755553317');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  70   private static final    Object             LOCK     = new Object();                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  71 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72  * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73  */                                                                                                      </span>
<span class="4304627110649516611" onmouseenter="enter('4304627110649516611');" onmouseout="out('4304627110649516611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74 public class DownloadSchedulers implements IDownloadSchedulers {                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75   /**                                                                                                    </span>
<span class="-6909290071230674405" onmouseenter="enter('-6909290071230674405');" onmouseout="out('-6909290071230674405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76    * 任务预加载                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77    */                                                                                                    </span>
<span class="-3798224625689547634" onmouseenter="enter('-3798224625689547634');" onmouseout="out('-3798224625689547634');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78   public static final int PRE = 0;                                                                       </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79   /**                                                                                                    </span>
<span class="-8586305757395820434" onmouseenter="enter('-8586305757395820434');" onmouseout="out('-8586305757395820434');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80    * 任务开始                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81    */                                                                                                    </span>
<span class="1856669191456841516" onmouseenter="enter('1856669191456841516');" onmouseout="out('1856669191456841516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82   public static final int START = 1;                                                                     </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83   /**                                                                                                    </span>
<span class="-5690582150325294743" onmouseenter="enter('-5690582150325294743');" onmouseout="out('-5690582150325294743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84    * 任务停止                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85    */                                                                                                    </span>
<span class="-1234849400005407647" onmouseenter="enter('-1234849400005407647');" onmouseout="out('-1234849400005407647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86   public static final int STOP = 2;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87   /**                                                                                                    </span>
<span class="7725539954827761966" onmouseenter="enter('7725539954827761966');" onmouseout="out('7725539954827761966');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88    * 任务失败                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89    */                                                                                                    </span>
<span class="-1844166370265963480" onmouseenter="enter('-1844166370265963480');" onmouseout="out('-1844166370265963480');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90   public static final int FAIL = 3;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91   /**                                                                                                    </span>
<span class="2064875861948696274" onmouseenter="enter('2064875861948696274');" onmouseout="out('2064875861948696274');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92    * 任务取消                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93    */                                                                                                    </span>
<span class="2577052996693665294" onmouseenter="enter('2577052996693665294');" onmouseout="out('2577052996693665294');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94   public static final int CANCEL = 4;                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95   /**                                                                                                    </span>
<span class="-5025359896728506958" onmouseenter="enter('-5025359896728506958');" onmouseout="out('-5025359896728506958');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96    * 任务完成                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97    */                                                                                                    </span>
<span class="-4459433206105700619" onmouseenter="enter('-4459433206105700619');" onmouseout="out('-4459433206105700619');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98   public static final int COMPLETE = 5;                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99   /**                                                                                                    </span>
<span class="7866565969200819017" onmouseenter="enter('7866565969200819017');" onmouseout="out('7866565969200819017');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100    * 下载中                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101    */                                                                                                    </span>
<span class="-4113841519595777363" onmouseenter="enter('-4113841519595777363');" onmouseout="out('-4113841519595777363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102   public static final int RUNNING = 6;                                                                   </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103   /**                                                                                                    </span>
<span class="-4583384747655535323" onmouseenter="enter('-4583384747655535323');" onmouseout="out('-4583384747655535323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104    * 恢复下载                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105    */                                                                                                    </span>
<span class="6596687279686396548" onmouseenter="enter('6596687279686396548');" onmouseout="out('6596687279686396548');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106   public static final int RESUME = 7;                                                                    </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107   private static final String TAG = &quot;DownloadSchedulers&quot;;                                                </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108   private static final Object LOCK = new Object();                                                       </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 109 =======                                                                                                  </span>
<span class="8416775543270687698" onmouseenter="enter('8416775543270687698');" onmouseout="out('8416775543270687698');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110 public class DownloadSchedulers implements ISchedulers&lt;DownloadTask&gt; {                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111                                                                                                          </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112   private static final String TAG = &quot;DownloadSchedulers&quot;;                                                </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113   private static final Object LOCK = new Object();                                                       </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 114 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style=""> 115   private static volatile DownloadSchedulers INSTANCE = null;                                            </span>
<span  style=""> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117   /**                                                                                                    </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style=""> 118    * 下载器任务监听                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 119    */                                                                                                    </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 120 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="8456381727773251435" onmouseenter="enter('8456381727773251435');" onmouseout="out('8456381727773251435');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 121   Map&lt;String, OnSchedulerListener&gt; mSchedulerListeners = new ConcurrentHashMap&lt;&gt;();                      </span>
<span class="4917723528378434790" onmouseenter="enter('4917723528378434790');" onmouseout="out('4917723528378434790');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 122   DownloadManager                  mManager            = DownloadManager.getInstance();                  </span>
<span class="8598976265326351040" onmouseenter="enter('8598976265326351040');" onmouseout="out('8598976265326351040');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 123   ITaskQueue mQueue;                                                                                     </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 124 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125    */                                                                                                    </span>
<span class="1856669191456841516" onmouseenter="enter('1856669191456841516');" onmouseout="out('1856669191456841516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126   public static final int START = 1;                                                                     </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127   /**                                                                                                    </span>
<span class="-5690582150325294743" onmouseenter="enter('-5690582150325294743');" onmouseout="out('-5690582150325294743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128    * 任务停止                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129    */                                                                                                    </span>
<span class="-1234849400005407647" onmouseenter="enter('-1234849400005407647');" onmouseout="out('-1234849400005407647');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130   public static final int STOP = 2;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131   /**                                                                                                    </span>
<span class="7725539954827761966" onmouseenter="enter('7725539954827761966');" onmouseout="out('7725539954827761966');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132    * 任务失败                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133    */                                                                                                    </span>
<span class="-1844166370265963480" onmouseenter="enter('-1844166370265963480');" onmouseout="out('-1844166370265963480');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134   public static final int FAIL = 3;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135   /**                                                                                                    </span>
<span class="2064875861948696274" onmouseenter="enter('2064875861948696274');" onmouseout="out('2064875861948696274');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136    * 任务取消                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137    */                                                                                                    </span>
<span class="2577052996693665294" onmouseenter="enter('2577052996693665294');" onmouseout="out('2577052996693665294');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138   public static final int CANCEL = 4;                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139   /**                                                                                                    </span>
<span class="-5025359896728506958" onmouseenter="enter('-5025359896728506958');" onmouseout="out('-5025359896728506958');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140    * 任务完成                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141    */                                                                                                    </span>
<span class="-4459433206105700619" onmouseenter="enter('-4459433206105700619');" onmouseout="out('-4459433206105700619');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142   public static final int COMPLETE = 5;                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143   /**                                                                                                    </span>
<span class="7866565969200819017" onmouseenter="enter('7866565969200819017');" onmouseout="out('7866565969200819017');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144    * 下载中                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145    */                                                                                                    </span>
<span class="-4113841519595777363" onmouseenter="enter('-4113841519595777363');" onmouseout="out('-4113841519595777363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146   public static final int RUNNING = 6;                                                                   </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147   /**                                                                                                    </span>
<span class="-4583384747655535323" onmouseenter="enter('-4583384747655535323');" onmouseout="out('-4583384747655535323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148    * 恢复下载                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149    */                                                                                                    </span>
<span class="6596687279686396548" onmouseenter="enter('6596687279686396548');" onmouseout="out('6596687279686396548');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150   public static final int RESUME = 7;                                                                    </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151   private static final String TAG = &quot;DownloadSchedulers&quot;;                                                </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152   private static final Object LOCK = new Object();                                                       </span>
<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153   private static volatile DownloadSchedulers INSTANCE = null;                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155   /**                                                                                                    </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156    * 下载器任务监听                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157    */                                                                                                    </span>
<span class="8456381727773251435" onmouseenter="enter('8456381727773251435');" onmouseout="out('8456381727773251435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158   Map&lt;String, OnSchedulerListener&gt; mSchedulerListeners = new ConcurrentHashMap&lt;&gt;();                      </span>
<span class="-8842931816589902990" onmouseenter="enter('-8842931816589902990');" onmouseout="out('-8842931816589902990');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159   DownloadManager mManager = DownloadManager.getInstance();                                              </span>
<span class="8598976265326351040" onmouseenter="enter('8598976265326351040');" onmouseout="out('8598976265326351040');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160   ITaskQueue mQueue;                                                                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 161 =======                                                                                                  </span>
<span class="-3925422581406470796" onmouseenter="enter('-3925422581406470796');" onmouseout="out('-3925422581406470796');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162   private Map&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; mSchedulerListeners =                    </span>
<span class="7545653642443207171" onmouseenter="enter('7545653642443207171');" onmouseout="out('7545653642443207171');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163       new ConcurrentHashMap&lt;&gt;();                                                                         </span>
<span class="-1055071256125403720" onmouseenter="enter('-1055071256125403720');" onmouseout="out('-1055071256125403720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164   private DownloadTaskQueue mQueue;                                                                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 165 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 166                                                                                                          </span>
<span class="-4615998420186637334" onmouseenter="enter('-4615998420186637334');" onmouseout="out('-4615998420186637334');" style=""> 167   private DownloadSchedulers() {                                                                         </span>
<span class="4181603964882924928" onmouseenter="enter('4181603964882924928');" onmouseout="out('4181603964882924928');" style=""> 168     mQueue = DownloadTaskQueue.getInstance();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169   }                                                                                                      </span>
<span  style=""> 170                                                                                                          </span>
<span class="-519894234808704272" onmouseenter="enter('-519894234808704272');" onmouseout="out('-519894234808704272');" style=""> 171   public static DownloadSchedulers getInstance() {                                                       </span>
<span class="-8097436755426287019" onmouseenter="enter('-8097436755426287019');" onmouseout="out('-8097436755426287019');" style=""> 172     if (INSTANCE == null) {                                                                              </span>
<span class="-889825015365812481" onmouseenter="enter('-889825015365812481');" onmouseout="out('-889825015365812481');" style=""> 173       synchronized (LOCK) {                                                                              </span>
<span class="-4113076547335811880" onmouseenter="enter('-4113076547335811880');" onmouseout="out('-4113076547335811880');" style=""> 174         INSTANCE = new DownloadSchedulers();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span class="-2388388574337551660" onmouseenter="enter('-2388388574337551660');" onmouseout="out('-2388388574337551660');" style=""> 177     return INSTANCE;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178   }                                                                                                      </span>
<span  style=""> 179                                                                                                          </span>
<span class="-8403899556941196401" onmouseenter="enter('-8403899556941196401');" onmouseout="out('-8403899556941196401');" style=""> 180   @Override public void addSchedulerListener(String targetName,                                          </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style=""> 181       ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                              </span>
<span class="2225147130150881467" onmouseenter="enter('2225147130150881467');" onmouseout="out('2225147130150881467');" style=""> 182     mSchedulerListeners.put(targetName,                                                                  </span>
<span class="8951749162305430893" onmouseenter="enter('8951749162305430893');" onmouseout="out('8951749162305430893');" style=""> 183         (IDownloadSchedulerListener&lt;DownloadTask&gt;) schedulerListener);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184   }                                                                                                      </span>
<span  style=""> 185                                                                                                          </span>
<span class="6065443109591267703" onmouseenter="enter('6065443109591267703');" onmouseout="out('6065443109591267703');" style=""> 186   @Override public void removeSchedulerListener(String targetName,                                       </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style=""> 187       ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                              </span>
<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style=""><abbr title=" 188     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element"> 188     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurr🔵</abbr></span>
<span class="3572873968857737976" onmouseenter="enter('3572873968857737976');" onmouseout="out('3572873968857737976');" style=""> 189     for (Iterator&lt;Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt;&gt; iter =                    </span>
<span class="-8199036773943606321" onmouseenter="enter('-8199036773943606321');" onmouseout="out('-8199036773943606321');" style=""> 190         mSchedulerListeners.entrySet().iterator(); iter.hasNext(); ) {                                   </span>
<span class="-3105102033904377070" onmouseenter="enter('-3105102033904377070');" onmouseout="out('-3105102033904377070');" style=""> 191       Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; entry = iter.next();                   </span>
<span class="-1599663307714431138" onmouseenter="enter('-1599663307714431138');" onmouseout="out('-1599663307714431138');" style=""> 192       if (entry.getKey().equals(targetName)) iter.remove();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194   }                                                                                                      </span>
<span  style=""> 195                                                                                                          </span>
<span class="-5093355790655318910" onmouseenter="enter('-5093355790655318910');" onmouseout="out('-5093355790655318910');" style=""> 196   @Override public boolean handleMessage(Message msg) {                                                  </span>
<span class="-8251277725976015781" onmouseenter="enter('-8251277725976015781');" onmouseout="out('-8251277725976015781');" style=""> 197     DownloadTask task = (DownloadTask) msg.obj;                                                          </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 198     if (task == null) {                                                                                  </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style=""> 199       Log.e(TAG, &quot;请传入下载任务&quot;);                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 200       return true;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style=""> 202     callback(msg.what, task);                                                                            </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style=""> 203     DownloadEntity entity = task.getDownloadEntity();                                                    </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style=""> 204     switch (msg.what) {                                                                                  </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 205       case STOP:                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 206       case CANCEL:                                                                                       </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 207         mQueue.removeTask(entity);                                                                       </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style=""> 208         if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                              </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style=""> 209           startNextTask();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210         }                                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 211         break;                                                                                           </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 212       case COMPLETE:                                                                                     </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 213         mQueue.removeTask(entity);                                                                       </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style=""> 214         startNextTask();                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 215         break;                                                                                           </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 216       case FAIL:                                                                                         </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 217 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 218 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219   }                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221   @Override                                                                                              </span>
<span class="-3983392630216527778" onmouseenter="enter('-3983392630216527778');" onmouseout="out('-3983392630216527778');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222   public void removeSchedulerListener(String targetName, OnSchedulerListener schedulerListener) {        </span>
<span class="6836852313823545406" onmouseenter="enter('6836852313823545406');" onmouseout="out('6836852313823545406');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223     //OnSchedulerListener listener = mSchedulerListeners.get(target.getClass().getName());               </span>
<span class="-4758361548811584798" onmouseenter="enter('-4758361548811584798');" onmouseout="out('-4758361548811584798');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224     //mSchedulerListeners.remove(listener);                                                              </span>
<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 225     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element"> 225     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurr🔵</abbr></span>
<span class="743911132097881635" onmouseenter="enter('743911132097881635');" onmouseout="out('743911132097881635');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226     for (Iterator&lt;Map.Entry&lt;String, OnSchedulerListener&gt;&gt; iter =                                         </span>
<span class="-8199036773943606321" onmouseenter="enter('-8199036773943606321');" onmouseout="out('-8199036773943606321');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227         mSchedulerListeners.entrySet().iterator(); iter.hasNext(); ) {                                   </span>
<span class="-7435768381575910650" onmouseenter="enter('-7435768381575910650');" onmouseout="out('-7435768381575910650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228       Map.Entry&lt;String, OnSchedulerListener&gt; entry = iter.next();                                        </span>
<span class="-1599663307714431138" onmouseenter="enter('-1599663307714431138');" onmouseout="out('-1599663307714431138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229       if (entry.getKey().equals(targetName)) iter.remove();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231   }                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232                                                                                                          </span>
<span class="-5093355790655318910" onmouseenter="enter('-5093355790655318910');" onmouseout="out('-5093355790655318910');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233   @Override public boolean handleMessage(Message msg) {                                                  </span>
<span class="-6718823554380121078" onmouseenter="enter('-6718823554380121078');" onmouseout="out('-6718823554380121078');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234     Task task = (Task) msg.obj;                                                                          </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235     if (task == null) {                                                                                  </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236       Log.e(TAG, &quot;请传入下载任务&quot;);                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237       return true;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238     }                                                                                                    </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239     callback(msg.what, task);                                                                            </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240     DownloadEntity entity = task.getDownloadEntity();                                                    </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241     switch (msg.what) {                                                                                  </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242       case STOP:                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243       case CANCEL:                                                                                       </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244         mQueue.removeTask(entity);                                                                       </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245         if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                              </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246           startNextTask(entity);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247         }                                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248         break;                                                                                           </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249       case COMPLETE:                                                                                     </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250         mQueue.removeTask(entity);                                                                       </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251         startNextTask(entity);                                                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252         break;                                                                                           </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253       case FAIL:                                                                                         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 254 =======                                                                                                  </span>
<span class="6557620446996273889" onmouseenter="enter('6557620446996273889');" onmouseout="out('6557620446996273889');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255         //mQueue.removeTask(entity);                                                                     </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 256 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="2925124162455559864" onmouseenter="enter('2925124162455559864');" onmouseout="out('2925124162455559864');" style=""> 257         handleFailTask(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 258         break;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 260     return true;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261   }                                                                                                      </span>
<span  style=""> 262                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 263   /**                                                                                                    </span>
<span class="5701145962088405995" onmouseenter="enter('5701145962088405995');" onmouseout="out('5701145962088405995');" style=""> 264    * 回调                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 265    *                                                                                                     </span>
<span class="6794715047748436388" onmouseenter="enter('6794715047748436388');" onmouseout="out('6794715047748436388');" style=""> 266    * @param state 状态                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 267    */                                                                                                    </span>
<span class="-6525939261817098917" onmouseenter="enter('-6525939261817098917');" onmouseout="out('-6525939261817098917');" style=""> 268   private void callback(int state, DownloadTask task) {                                                  </span>
<span class="6264342014304299429" onmouseenter="enter('6264342014304299429');" onmouseout="out('6264342014304299429');" style=""> 269     if (mSchedulerListeners.size() &gt; 0) {                                                                </span>
<span class="-8197804712143627403" onmouseenter="enter('-8197804712143627403');" onmouseout="out('-8197804712143627403');" style=""> 270       //if (!TextUtils.isEmpty(task.getTargetName())) {                                                  </span>
<span class="7236226619005487457" onmouseenter="enter('7236226619005487457');" onmouseout="out('7236226619005487457');" style=""> 271       //  callback(state, task, mSchedulerListeners.get(task.getTargetName()));                          </span>
<span class="-4740675746293055676" onmouseenter="enter('-4740675746293055676');" onmouseout="out('-4740675746293055676');" style=""> 272       //}                                                                                                </span>
<span class="-5867093652927473424" onmouseenter="enter('-5867093652927473424');" onmouseout="out('-5867093652927473424');" style=""> 273       Set&lt;String&gt; keys = mSchedulerListeners.keySet();                                                   </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 274       for (String key : keys) {                                                                          </span>
<span class="7522587192355288650" onmouseenter="enter('7522587192355288650');" onmouseout="out('7522587192355288650');" style=""> 275         callback(state, task, mSchedulerListeners.get(key));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278   }                                                                                                      </span>
<span  style=""> 279                                                                                                          </span>
<span class="2906960517244803696" onmouseenter="enter('2906960517244803696');" onmouseout="out('2906960517244803696');" style=""> 280   private void callback(int state, DownloadTask task,                                                    </span>
<span class="254905766686400838" onmouseenter="enter('254905766686400838');" onmouseout="out('254905766686400838');" style=""> 281       IDownloadSchedulerListener&lt;DownloadTask&gt; listener) {                                               </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 282     if (listener != null) {                                                                              </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 283       if (task == null) {                                                                                </span>
<span class="-558067560321655497" onmouseenter="enter('-558067560321655497');" onmouseout="out('-558067560321655497');" style=""> 284         Log.e(TAG, &quot;TASK 为null，回调失败&quot;);                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 285         return;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286       }                                                                                                  </span>
<span class="-7165330810205169714" onmouseenter="enter('-7165330810205169714');" onmouseout="out('-7165330810205169714');" style=""> 287       switch (state) {                                                                                   </span>
<span class="3901942634001995069" onmouseenter="enter('3901942634001995069');" onmouseout="out('3901942634001995069');" style=""> 288         case RUNNING:                                                                                    </span>
<span class="8481034844882813554" onmouseenter="enter('8481034844882813554');" onmouseout="out('8481034844882813554');" style=""> 289           listener.onTaskRunning(task);                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 290           break;                                                                                         </span>
<span class="-2079449841199557933" onmouseenter="enter('-2079449841199557933');" onmouseout="out('-2079449841199557933');" style=""> 291         case START:                                                                                      </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style=""> 292           listener.onTaskStart(task);                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 293           break;                                                                                         </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 294         case STOP:                                                                                       </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style=""> 295           listener.onTaskStop(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 296           break;                                                                                         </span>
<span class="-109811889113334874" onmouseenter="enter('-109811889113334874');" onmouseout="out('-109811889113334874');" style=""> 297         case RESUME:                                                                                     </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style=""> 298           listener.onTaskResume(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 299           break;                                                                                         </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style=""> 300         case PRE:                                                                                        </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style=""> 301           listener.onTaskPre(task);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 302           break;                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 303         case CANCEL:                                                                                     </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style=""> 304           listener.onTaskCancel(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 305           break;                                                                                         </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 306         case COMPLETE:                                                                                   </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style=""> 307           listener.onTaskComplete(task);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 308           break;                                                                                         </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 309         case FAIL:                                                                                       </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style=""> 310           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 311           break;                                                                                         </span>
<span class="-302375476510561723" onmouseenter="enter('-302375476510561723');" onmouseout="out('-302375476510561723');" style=""> 312         case SUPPORT_BREAK_POINT:                                                                        </span>
<span class="-4028020960632858822" onmouseenter="enter('-4028020960632858822');" onmouseout="out('-4028020960632858822');" style=""> 313           listener.onNoSupportBreakPoint(task);                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 314           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317   }                                                                                                      </span>
<span  style=""> 318                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 319   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style=""> 320    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 321    *                                                                                                     </span>
<span class="2776247698490779697" onmouseenter="enter('2776247698490779697');" onmouseout="out('2776247698490779697');" style=""> 322    * @param task 下载任务                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 323    */                                                                                                    </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 324 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5250270752909639380" onmouseenter="enter('5250270752909639380');" onmouseout="out('5250270752909639380');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 325   @Override public void handleFailTask(final Task task) {                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 326 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327           break;                                                                                         </span>
<span class="-2079449841199557933" onmouseenter="enter('-2079449841199557933');" onmouseout="out('-2079449841199557933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328         case START:                                                                                      </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329           listener.onTaskStart(task);                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330           break;                                                                                         </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331         case STOP:                                                                                       </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332           listener.onTaskStop(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333           break;                                                                                         </span>
<span class="-109811889113334874" onmouseenter="enter('-109811889113334874');" onmouseout="out('-109811889113334874');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334         case RESUME:                                                                                     </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335           listener.onTaskResume(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336           break;                                                                                         </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337         case PRE:                                                                                        </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338           listener.onTaskPre(task);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339           break;                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340         case CANCEL:                                                                                     </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341           listener.onTaskCancel(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342           break;                                                                                         </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343         case COMPLETE:                                                                                   </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344           listener.onTaskComplete(task);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345           break;                                                                                         </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346         case FAIL:                                                                                       </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351   }                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355    *                                                                                                     </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356    * @param entity 失败实体                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357    */                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 358 =======                                                                                                  </span>
<span class="-2725380241269917146" onmouseenter="enter('-2725380241269917146');" onmouseout="out('-2725380241269917146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359   private void handleFailTask(final DownloadTask task) {                                                 </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 360 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style=""> 361     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style=""> 362     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style=""> 363       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style=""> 364                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365       }                                                                                                  </span>
<span  style=""> 366                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style=""> 367       @Override public void onFinish() {                                                                 </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style=""> 368         DownloadEntity entity = task.getDownloadEntity();                                                </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 369 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 370         if (entity.getFailNum() &lt;= config.getReTryNum()) {                                               </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 371           Task task = mQueue.getTask(entity);                                                            </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 372 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373           break;                                                                                         </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374         case PRE:                                                                                        </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 375           listener.onTaskPre(task);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 376           break;                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 377         case CANCEL:                                                                                     </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 378           listener.onTaskCancel(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 379           break;                                                                                         </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 380         case COMPLETE:                                                                                   </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 381           listener.onTaskComplete(task);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 382           break;                                                                                         </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 383         case FAIL:                                                                                       </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 384           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 385           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 386       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 387     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 388   }                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 389                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 390   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 391    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 392    *                                                                                                     </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 393    * @param entity 失败实体                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 394    */                                                                                                    </span>
<span class="-1695955174776440054" onmouseenter="enter('-1695955174776440054');" onmouseout="out('-1695955174776440054');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 395   @Override public void handleFailTask(final DownloadEntity entity) {                                    </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 396     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 397     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 398       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 399                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 400       }                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 401                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 402       @Override public void onFinish() {                                                                 </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 403         if (entity.getFailNum() &lt;= config.getReTryNum()) {                                               </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 404           Task task = mQueue.getTask(entity);                                                            </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 405 =======                                                                                                  </span>
<span class="1857717324066272338" onmouseenter="enter('1857717324066272338');" onmouseout="out('1857717324066272338');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406         if (entity.getFailNum() &lt; config.getReTryNum()) {                                                </span>
<span class="2015918851482799865" onmouseenter="enter('2015918851482799865');" onmouseout="out('2015918851482799865');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407           DownloadTask task = mQueue.getTask(entity);                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 408 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style=""> 409           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 410           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style=""> 411             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style=""> 412           } catch (InterruptedException e) {                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 413             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 415         } else {                                                                                         </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 416           mQueue.removeTask(entity);                                                                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 417 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 418           startNextTask(entity);                                                                         </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 419 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 420         case FAIL:                                                                                       </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 421           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425   }                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 427   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 428    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429    *                                                                                                     </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430    * @param entity 失败实体                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431    */                                                                                                    </span>
<span class="-1695955174776440054" onmouseenter="enter('-1695955174776440054');" onmouseout="out('-1695955174776440054');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432   @Override public void handleFailTask(final DownloadEntity entity) {                                    </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437       }                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439       @Override public void onFinish() {                                                                 </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440         if (entity.getFailNum() &lt;= config.getReTryNum()) {                                               </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441           Task task = mQueue.getTask(entity);                                                            </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445           } catch (InterruptedException e) {                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448         } else {                                                                                         </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449           startNextTask(entity);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450         }                                                                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 451 =======                                                                                                  </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452           startNextTask();                                                                               </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 453 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455       }                                                                                                  </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 456     };                                                                                                   </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style=""> 457     timer.start();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458   }                                                                                                      </span>
<span  style=""> 459                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 460   /**                                                                                                    </span>
<span class="1254639702238739792" onmouseenter="enter('1254639702238739792');" onmouseout="out('1254639702238739792');" style=""> 461    * 启动下一个任务，条件：任务停止，取消下载，任务完成                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 462    */                                                                                                    </span>
<span class="-669202063827981309" onmouseenter="enter('-669202063827981309');" onmouseout="out('-669202063827981309');" style=""> 463   private void startNextTask() {                                                                         </span>
<span class="-1613093400901244409" onmouseenter="enter('-1613093400901244409');" onmouseout="out('-1613093400901244409');" style=""> 464     DownloadTask newTask = mQueue.getNextTask();                                                         </span>
<span class="7215532936246787403" onmouseenter="enter('7215532936246787403');" onmouseout="out('7215532936246787403');" style=""> 465     if (newTask == null) {                                                                               </span>
<span class="-4835257036825404123" onmouseenter="enter('-4835257036825404123');" onmouseout="out('-4835257036825404123');" style=""> 466       Log.w(TAG, &quot;没有下一任务&quot;);                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 467       return;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span class="2202099522712246363" onmouseenter="enter('2202099522712246363');" onmouseout="out('2202099522712246363');" style=""> 469     if (newTask.getDownloadEntity().getState() == DownloadEntity.STATE_WAIT) {                           </span>
<span class="6679029410179135267" onmouseenter="enter('6679029410179135267');" onmouseout="out('6679029410179135267');" style=""> 470       mQueue.startTask(newTask);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 471     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="-3312156477302878812" onmouseenter="enter('-3312156477302878812');" onmouseout="out('-3312156477302878812');" style="">  17 package com.arialyy.aria.core.scheduler;                                                                 </span>
<span  style="">  18                                                                                                          </span>
<span class="371096003059305121" onmouseenter="enter('371096003059305121');" onmouseout="out('371096003059305121');" style="">  19 import android.os.CountDownTimer;                                                                        </span>
<span class="2113358441178436248" onmouseenter="enter('2113358441178436248');" onmouseout="out('2113358441178436248');" style="">  20 import android.os.Message;                                                                               </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  21 import android.util.Log;                                                                                 </span>
<span class="1325372506799583582" onmouseenter="enter('1325372506799583582');" onmouseout="out('1325372506799583582');" style="">  22 import com.arialyy.aria.core.queue.DownloadTaskQueue;                                                    </span>
<span class="1932658903610588883" onmouseenter="enter('1932658903610588883');" onmouseout="out('1932658903610588883');" style="">  23 import com.arialyy.aria.core.download.DownloadEntity;                                                    </span>
<span class="-2556631877775212617" onmouseenter="enter('-2556631877775212617');" onmouseout="out('-2556631877775212617');" style="">  24 import com.arialyy.aria.core.download.DownloadTask;                                                      </span>
<span class="-288495809736068445" onmouseenter="enter('-288495809736068445');" onmouseout="out('-288495809736068445');" style="">  25 import com.arialyy.aria.util.Configuration;                                                              </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  26 import java.util.Iterator;                                                                               </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  27 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  28 import java.util.Set;                                                                                    </span>
<span class="8600016768069240092" onmouseenter="enter('8600016768069240092');" onmouseout="out('8600016768069240092');" style="">  29 import java.util.concurrent.ConcurrentHashMap;                                                           </span>
<span  style="">  30                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  31 /**                                                                                                      </span>
<span class="-3542925026229653469" onmouseenter="enter('-3542925026229653469');" onmouseout="out('-3542925026229653469');" style="">  32  * Created by lyy on 2016/8/16.                                                                          </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="">  33  * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  34  */                                                                                                      </span>
<span class="8416775543270687698" onmouseenter="enter('8416775543270687698');" onmouseout="out('8416775543270687698');" style="">  35 public class DownloadSchedulers implements ISchedulers&lt;DownloadTask&gt; {                                   </span>
<span  style="">  36                                                                                                          </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="">  37   private static final String TAG = &quot;DownloadSchedulers&quot;;                                                </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="">  38   private static final Object LOCK = new Object();                                                       </span>
<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style="">  39   private static volatile DownloadSchedulers INSTANCE = null;                                            </span>
<span  style="">  40                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  41   /**                                                                                                    </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style="">  42    * 下载器任务监听                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43    */                                                                                                    </span>
<span class="-3925422581406470796" onmouseenter="enter('-3925422581406470796');" onmouseout="out('-3925422581406470796');" style="">  44   private Map&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; mSchedulerListeners =                    </span>
<span class="7545653642443207171" onmouseenter="enter('7545653642443207171');" onmouseout="out('7545653642443207171');" style="">  45       new ConcurrentHashMap&lt;&gt;();                                                                         </span>
<span class="-1055071256125403720" onmouseenter="enter('-1055071256125403720');" onmouseout="out('-1055071256125403720');" style="">  46   private DownloadTaskQueue mQueue;                                                                      </span>
<span  style="">  47                                                                                                          </span>
<span class="-4615998420186637334" onmouseenter="enter('-4615998420186637334');" onmouseout="out('-4615998420186637334');" style="">  48   private DownloadSchedulers() {                                                                         </span>
<span class="4181603964882924928" onmouseenter="enter('4181603964882924928');" onmouseout="out('4181603964882924928');" style="">  49     mQueue = DownloadTaskQueue.getInstance();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50   }                                                                                                      </span>
<span  style="">  51                                                                                                          </span>
<span class="-519894234808704272" onmouseenter="enter('-519894234808704272');" onmouseout="out('-519894234808704272');" style="">  52   public static DownloadSchedulers getInstance() {                                                       </span>
<span class="-8097436755426287019" onmouseenter="enter('-8097436755426287019');" onmouseout="out('-8097436755426287019');" style="">  53     if (INSTANCE == null) {                                                                              </span>
<span class="-889825015365812481" onmouseenter="enter('-889825015365812481');" onmouseout="out('-889825015365812481');" style="">  54       synchronized (LOCK) {                                                                              </span>
<span class="-4113076547335811880" onmouseenter="enter('-4113076547335811880');" onmouseout="out('-4113076547335811880');" style="">  55         INSTANCE = new DownloadSchedulers();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  56       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57     }                                                                                                    </span>
<span class="-2388388574337551660" onmouseenter="enter('-2388388574337551660');" onmouseout="out('-2388388574337551660');" style="">  58     return INSTANCE;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  59   }                                                                                                      </span>
<span  style="">  60                                                                                                          </span>
<span class="-8403899556941196401" onmouseenter="enter('-8403899556941196401');" onmouseout="out('-8403899556941196401');" style="">  61   @Override public void addSchedulerListener(String targetName,                                          </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style="">  62       ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                              </span>
<span class="2225147130150881467" onmouseenter="enter('2225147130150881467');" onmouseout="out('2225147130150881467');" style="">  63     mSchedulerListeners.put(targetName,                                                                  </span>
<span class="8951749162305430893" onmouseenter="enter('8951749162305430893');" onmouseout="out('8951749162305430893');" style="">  64         (IDownloadSchedulerListener&lt;DownloadTask&gt;) schedulerListener);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65   }                                                                                                      </span>
<span  style="">  66                                                                                                          </span>
<span class="6065443109591267703" onmouseenter="enter('6065443109591267703');" onmouseout="out('6065443109591267703');" style="">  67   @Override public void removeSchedulerListener(String targetName,                                       </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style="">  68       ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                              </span>
<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style=""><abbr title="  69     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element">  69     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurr🔵</abbr></span>
<span class="3572873968857737976" onmouseenter="enter('3572873968857737976');" onmouseout="out('3572873968857737976');" style="">  70     for (Iterator&lt;Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt;&gt; iter =                    </span>
<span class="-8199036773943606321" onmouseenter="enter('-8199036773943606321');" onmouseout="out('-8199036773943606321');" style="">  71         mSchedulerListeners.entrySet().iterator(); iter.hasNext(); ) {                                   </span>
<span class="-3105102033904377070" onmouseenter="enter('-3105102033904377070');" onmouseout="out('-3105102033904377070');" style="">  72       Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; entry = iter.next();                   </span>
<span class="-1599663307714431138" onmouseenter="enter('-1599663307714431138');" onmouseout="out('-1599663307714431138');" style="">  73       if (entry.getKey().equals(targetName)) iter.remove();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75   }                                                                                                      </span>
<span  style="">  76                                                                                                          </span>
<span class="-5093355790655318910" onmouseenter="enter('-5093355790655318910');" onmouseout="out('-5093355790655318910');" style="">  77   @Override public boolean handleMessage(Message msg) {                                                  </span>
<span class="-8251277725976015781" onmouseenter="enter('-8251277725976015781');" onmouseout="out('-8251277725976015781');" style="">  78     DownloadTask task = (DownloadTask) msg.obj;                                                          </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style="">  79     if (task == null) {                                                                                  </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style="">  80       Log.e(TAG, &quot;请传入下载任务&quot;);                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  81       return true;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style="">  83     callback(msg.what, task);                                                                            </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="">  84     DownloadEntity entity = task.getDownloadEntity();                                                    </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style="">  85     switch (msg.what) {                                                                                  </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style="">  86       case STOP:                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style="">  87       case CANCEL:                                                                                       </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="">  88         mQueue.removeTask(entity);                                                                       </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style="">  89         if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                              </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="">  90           startNextTask();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91         }                                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  92         break;                                                                                           </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style="">  93       case COMPLETE:                                                                                     </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="">  94         mQueue.removeTask(entity);                                                                       </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="">  95         startNextTask();                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  96         break;                                                                                           </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style="">  97       case FAIL:                                                                                         </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  98 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  99 ||||||| BASE                                                                                             </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100         mQueue.removeTask(entity);                                                                       </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 101 =======                                                                                                  </span>
<span class="6557620446996273889" onmouseenter="enter('6557620446996273889');" onmouseout="out('6557620446996273889');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102         //mQueue.removeTask(entity);                                                                     </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 103 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="2925124162455559864" onmouseenter="enter('2925124162455559864');" onmouseout="out('2925124162455559864');" style=""> 104         handleFailTask(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 105         break;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 107     return true;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108   }                                                                                                      </span>
<span  style=""> 109                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 110   /**                                                                                                    </span>
<span class="5701145962088405995" onmouseenter="enter('5701145962088405995');" onmouseout="out('5701145962088405995');" style=""> 111    * 回调                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 112    *                                                                                                     </span>
<span class="6794715047748436388" onmouseenter="enter('6794715047748436388');" onmouseout="out('6794715047748436388');" style=""> 113    * @param state 状态                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 114    */                                                                                                    </span>
<span class="-6525939261817098917" onmouseenter="enter('-6525939261817098917');" onmouseout="out('-6525939261817098917');" style=""> 115   private void callback(int state, DownloadTask task) {                                                  </span>
<span class="6264342014304299429" onmouseenter="enter('6264342014304299429');" onmouseout="out('6264342014304299429');" style=""> 116     if (mSchedulerListeners.size() &gt; 0) {                                                                </span>
<span class="-8197804712143627403" onmouseenter="enter('-8197804712143627403');" onmouseout="out('-8197804712143627403');" style=""> 117       //if (!TextUtils.isEmpty(task.getTargetName())) {                                                  </span>
<span class="7236226619005487457" onmouseenter="enter('7236226619005487457');" onmouseout="out('7236226619005487457');" style=""> 118       //  callback(state, task, mSchedulerListeners.get(task.getTargetName()));                          </span>
<span class="-4740675746293055676" onmouseenter="enter('-4740675746293055676');" onmouseout="out('-4740675746293055676');" style=""> 119       //}                                                                                                </span>
<span class="-5867093652927473424" onmouseenter="enter('-5867093652927473424');" onmouseout="out('-5867093652927473424');" style=""> 120       Set&lt;String&gt; keys = mSchedulerListeners.keySet();                                                   </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 121       for (String key : keys) {                                                                          </span>
<span class="7522587192355288650" onmouseenter="enter('7522587192355288650');" onmouseout="out('7522587192355288650');" style=""> 122         callback(state, task, mSchedulerListeners.get(key));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125   }                                                                                                      </span>
<span  style=""> 126                                                                                                          </span>
<span class="2906960517244803696" onmouseenter="enter('2906960517244803696');" onmouseout="out('2906960517244803696');" style=""> 127   private void callback(int state, DownloadTask task,                                                    </span>
<span class="254905766686400838" onmouseenter="enter('254905766686400838');" onmouseout="out('254905766686400838');" style=""> 128       IDownloadSchedulerListener&lt;DownloadTask&gt; listener) {                                               </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 129     if (listener != null) {                                                                              </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 130       if (task == null) {                                                                                </span>
<span class="-558067560321655497" onmouseenter="enter('-558067560321655497');" onmouseout="out('-558067560321655497');" style=""> 131         Log.e(TAG, &quot;TASK 为null，回调失败&quot;);                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 132         return;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133       }                                                                                                  </span>
<span class="-7165330810205169714" onmouseenter="enter('-7165330810205169714');" onmouseout="out('-7165330810205169714');" style=""> 134       switch (state) {                                                                                   </span>
<span class="3901942634001995069" onmouseenter="enter('3901942634001995069');" onmouseout="out('3901942634001995069');" style=""> 135         case RUNNING:                                                                                    </span>
<span class="8481034844882813554" onmouseenter="enter('8481034844882813554');" onmouseout="out('8481034844882813554');" style=""> 136           listener.onTaskRunning(task);                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 137           break;                                                                                         </span>
<span class="-2079449841199557933" onmouseenter="enter('-2079449841199557933');" onmouseout="out('-2079449841199557933');" style=""> 138         case START:                                                                                      </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style=""> 139           listener.onTaskStart(task);                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 140           break;                                                                                         </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 141         case STOP:                                                                                       </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style=""> 142           listener.onTaskStop(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 143           break;                                                                                         </span>
<span class="-109811889113334874" onmouseenter="enter('-109811889113334874');" onmouseout="out('-109811889113334874');" style=""> 144         case RESUME:                                                                                     </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style=""> 145           listener.onTaskResume(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 146           break;                                                                                         </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style=""> 147         case PRE:                                                                                        </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style=""> 148           listener.onTaskPre(task);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 149           break;                                                                                         </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 150         case CANCEL:                                                                                     </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style=""> 151           listener.onTaskCancel(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 152           break;                                                                                         </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 153         case COMPLETE:                                                                                   </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style=""> 154           listener.onTaskComplete(task);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 155           break;                                                                                         </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 156         case FAIL:                                                                                       </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style=""> 157           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 158           break;                                                                                         </span>
<span class="-302375476510561723" onmouseenter="enter('-302375476510561723');" onmouseout="out('-302375476510561723');" style=""> 159         case SUPPORT_BREAK_POINT:                                                                        </span>
<span class="-4028020960632858822" onmouseenter="enter('-4028020960632858822');" onmouseout="out('-4028020960632858822');" style=""> 160           listener.onNoSupportBreakPoint(task);                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 161           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164   }                                                                                                      </span>
<span  style=""> 165                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 166   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style=""> 167    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 168    *                                                                                                     </span>
<span class="2776247698490779697" onmouseenter="enter('2776247698490779697');" onmouseout="out('2776247698490779697');" style=""> 169    * @param task 下载任务                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 170    */                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 171 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5250270752909639380" onmouseenter="enter('5250270752909639380');" onmouseout="out('5250270752909639380');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 172   @Override public void handleFailTask(final Task task) {                                                </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 173     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 174     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 175       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 176                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 177       }                                                                                                  </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 178                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 179       @Override public void onFinish() {                                                                 </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180         DownloadEntity entity = task.getDownloadEntity();                                                </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181         if (entity.getFailNum() &lt;= config.getReTryNum()) {                                               </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182           Task task = mQueue.getTask(entity);                                                            </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 183           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 184           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 185             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 186           } catch (InterruptedException e) {                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 187             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 188           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 189         } else {                                                                                         </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 190           mQueue.removeTask(entity);                                                                     </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 191           startNextTask(entity);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 192         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 193       }                                                                                                  </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 194     };                                                                                                   </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 195     timer.start();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 196   }                                                                                                      </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 197 ||||||| BASE                                                                                             </span>
<span class="-1695955174776440054" onmouseenter="enter('-1695955174776440054');" onmouseout="out('-1695955174776440054');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198   @Override public void handleFailTask(final DownloadEntity entity) {                                    </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203       }                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205       @Override public void onFinish() {                                                                 </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206         if (entity.getFailNum() &lt;= config.getReTryNum()) {                                               </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207           Task task = mQueue.getTask(entity);                                                            </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211           } catch (InterruptedException e) {                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214         } else {                                                                                         </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215           startNextTask(entity);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217       }                                                                                                  </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218     };                                                                                                   </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219     timer.start();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220   }                                                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 221 =======                                                                                                  </span>
<span class="-2725380241269917146" onmouseenter="enter('-2725380241269917146');" onmouseout="out('-2725380241269917146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222   private void handleFailTask(final DownloadTask task) {                                                 </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227       }                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228                                                                                                          </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229       @Override public void onFinish() {                                                                 </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230         DownloadEntity entity = task.getDownloadEntity();                                                </span>
<span class="1857717324066272338" onmouseenter="enter('1857717324066272338');" onmouseout="out('1857717324066272338');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231         if (entity.getFailNum() &lt; config.getReTryNum()) {                                                </span>
<span class="2015918851482799865" onmouseenter="enter('2015918851482799865');" onmouseout="out('2015918851482799865');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232           DownloadTask task = mQueue.getTask(entity);                                                    </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236           } catch (InterruptedException e) {                                                             </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239         } else {                                                                                         </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240           mQueue.removeTask(entity);                                                                     </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241           startNextTask();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243       }                                                                                                  </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244     };                                                                                                   </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245     timer.start();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246   }                                                                                                      </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 247 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 248                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 249   /**                                                                                                    </span>
<span class="1254639702238739792" onmouseenter="enter('1254639702238739792');" onmouseout="out('1254639702238739792');" style=""> 250    * 启动下一个任务，条件：任务停止，取消下载，任务完成                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 251    */                                                                                                    </span>
<span class="-669202063827981309" onmouseenter="enter('-669202063827981309');" onmouseout="out('-669202063827981309');" style=""> 252   private void startNextTask() {                                                                         </span>
<span class="-1613093400901244409" onmouseenter="enter('-1613093400901244409');" onmouseout="out('-1613093400901244409');" style=""> 253     DownloadTask newTask = mQueue.getNextTask();                                                         </span>
<span class="7215532936246787403" onmouseenter="enter('7215532936246787403');" onmouseout="out('7215532936246787403');" style=""> 254     if (newTask == null) {                                                                               </span>
<span class="-4835257036825404123" onmouseenter="enter('-4835257036825404123');" onmouseout="out('-4835257036825404123');" style=""> 255       Log.w(TAG, &quot;没有下一任务&quot;);                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 256       return;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257     }                                                                                                    </span>
<span class="2202099522712246363" onmouseenter="enter('2202099522712246363');" onmouseout="out('2202099522712246363');" style=""> 258     if (newTask.getDownloadEntity().getState() == DownloadEntity.STATE_WAIT) {                           </span>
<span class="6679029410179135267" onmouseenter="enter('6679029410179135267');" onmouseout="out('6679029410179135267');" style=""> 259       mQueue.startTask(newTask);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262 }                                                                                                        </span>

















































































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2  * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="-3312156477302878812" onmouseenter="enter('-3312156477302878812');" onmouseout="out('-3312156477302878812');" style="">  16 package com.arialyy.aria.core.scheduler;                                                                 </span>
<span  style="">  17                                                                                                          </span>
<span class="371096003059305121" onmouseenter="enter('371096003059305121');" onmouseout="out('371096003059305121');" style="">  18 import android.os.CountDownTimer;                                                                        </span>
<span class="2113358441178436248" onmouseenter="enter('2113358441178436248');" onmouseout="out('2113358441178436248');" style="">  19 import android.os.Message;                                                                               </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  20 import android.util.Log;                                                                                 </span>
<span class="1932658903610588883" onmouseenter="enter('1932658903610588883');" onmouseout="out('1932658903610588883');" style="">  21 import com.arialyy.aria.core.download.DownloadEntity;                                                    </span>
<span class="-2556631877775212617" onmouseenter="enter('-2556631877775212617');" onmouseout="out('-2556631877775212617');" style="">  22 import com.arialyy.aria.core.download.DownloadTask;                                                      </span>
<span class="1325372506799583582" onmouseenter="enter('1325372506799583582');" onmouseout="out('1325372506799583582');" style="">  23 import com.arialyy.aria.core.queue.DownloadTaskQueue;                                                    </span>
<span class="-288495809736068445" onmouseenter="enter('-288495809736068445');" onmouseout="out('-288495809736068445');" style="">  24 import com.arialyy.aria.util.Configuration;                                                              </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  25 import java.util.Iterator;                                                                               </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  26 import java.util.Map;                                                                                    </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  27 import java.util.Set;                                                                                    </span>
<span class="8600016768069240092" onmouseenter="enter('8600016768069240092');" onmouseout="out('8600016768069240092');" style="">  28 import java.util.concurrent.ConcurrentHashMap;                                                           </span>
<span  style="">  29                                                                                                          </span>
<span  style="">  30                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  31 /**                                                                                                      </span>
<span class="-3542925026229653469" onmouseenter="enter('-3542925026229653469');" onmouseout="out('-3542925026229653469');" style="">  32  * Created by lyy on 2016/8/16.                                                                          </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="">  33  * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  34  */                                                                                                      </span>
<span class="8416775543270687698" onmouseenter="enter('8416775543270687698');" onmouseout="out('8416775543270687698');" style="">  35 public class DownloadSchedulers implements ISchedulers&lt;DownloadTask&gt; {                                   </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="">  36   private static final String TAG = &quot;DownloadSchedulers&quot;;                                                </span>
<span  style="">  37                                                                                                          </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="">  38   private static final Object LOCK = new Object();                                                       </span>
<span  style="">  39                                                                                                          </span>
<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style="">  40   private static volatile DownloadSchedulers INSTANCE = null;                                            </span>
<span  style="">  41                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  42   /**                                                                                                    </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style="">  43    * 下载器任务监听                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  44    */                                                                                                    </span>
<span class="-5972714379238885828" onmouseenter="enter('-5972714379238885828');" onmouseout="out('-5972714379238885828');" style=""><abbr title="  45   private Map&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; mSchedulerListeners = new ConcurrentHashMap&lt;&gt;();">  45   private Map&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; mSchedulerListeners = new ConcurrentHashM🔵</abbr></span>
<span  style="">  46                                                                                                          </span>
<span class="-1055071256125403720" onmouseenter="enter('-1055071256125403720');" onmouseout="out('-1055071256125403720');" style="">  47   private DownloadTaskQueue mQueue;                                                                      </span>
<span  style="">  48                                                                                                          </span>
<span class="-4615998420186637334" onmouseenter="enter('-4615998420186637334');" onmouseout="out('-4615998420186637334');" style="">  49   private DownloadSchedulers() {                                                                         </span>
<span class="4181603964882924928" onmouseenter="enter('4181603964882924928');" onmouseout="out('4181603964882924928');" style="">  50     mQueue = DownloadTaskQueue.getInstance();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  51   }                                                                                                      </span>
<span  style="">  52                                                                                                          </span>
<span class="-519894234808704272" onmouseenter="enter('-519894234808704272');" onmouseout="out('-519894234808704272');" style="">  53   public static DownloadSchedulers getInstance() {                                                       </span>
<span class="-8097436755426287019" onmouseenter="enter('-8097436755426287019');" onmouseout="out('-8097436755426287019');" style="">  54     if (INSTANCE == null) {                                                                              </span>
<span class="4449625572507483553" onmouseenter="enter('4449625572507483553');" onmouseout="out('4449625572507483553');" style="">  55       synchronized(LOCK) {                                                                               </span>
<span class="-4113076547335811880" onmouseenter="enter('-4113076547335811880');" onmouseout="out('-4113076547335811880');" style="">  56         INSTANCE = new DownloadSchedulers();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58     }                                                                                                    </span>
<span class="-2388388574337551660" onmouseenter="enter('-2388388574337551660');" onmouseout="out('-2388388574337551660');" style="">  59     return INSTANCE;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60   }                                                                                                      </span>
<span  style="">  61                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  62   @Override                                                                                              </span>
<span class="-1740988420508638339" onmouseenter="enter('-1740988420508638339');" onmouseout="out('-1740988420508638339');" style=""><abbr title="  63   public void addSchedulerListener(String targetName, ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {">  63   public void addSchedulerListener(String targetName, ISchedulerListener&lt;DownloadTask&gt; schedulerListener)🔵</abbr></span>
<span class="-8502419708216102403" onmouseenter="enter('-8502419708216102403');" onmouseout="out('-8502419708216102403');" style=""><abbr title="  64     mSchedulerListeners.put(targetName, ((IDownloadSchedulerListener&lt;DownloadTask&gt;) (schedulerListener)));">  64     mSchedulerListeners.put(targetName, ((IDownloadSchedulerListener&lt;DownloadTask&gt;) (schedulerListener)))🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65   }                                                                                                      </span>
<span  style="">  66                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  67   @Override                                                                                              </span>
<span class="-8430817412710220912" onmouseenter="enter('-8430817412710220912');" onmouseout="out('-8430817412710220912');" style=""><abbr title="  68   public void removeSchedulerListener(String targetName, ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {">  68   public void removeSchedulerListener(String targetName, ISchedulerListener&lt;DownloadTask&gt; schedulerListen🔵</abbr></span>
<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style=""><abbr title="  69     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element">  69     //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurr🔵</abbr></span>
<span class="-4633990397667678218" onmouseenter="enter('-4633990397667678218');" onmouseout="out('-4633990397667678218');" style=""><abbr title="  70     for (Iterator&lt;Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt;&gt; iter = mSchedulerListeners.entrySet().iterator(); iter.hasNext();) {">  70     for (Iterator&lt;Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt;&gt; iter = mSchedulerListeners🔵</abbr></span>
<span class="-3105102033904377070" onmouseenter="enter('-3105102033904377070');" onmouseout="out('-3105102033904377070');" style="">  71       Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; entry = iter.next();                   </span>
<span class="-6409672050658742973" onmouseenter="enter('-6409672050658742973');" onmouseout="out('-6409672050658742973');" style="">  72       if (entry.getKey().equals(targetName)) {                                                           </span>
<span class="6531218048836267679" onmouseenter="enter('6531218048836267679');" onmouseout="out('6531218048836267679');" style="">  73         iter.remove();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76   }                                                                                                      </span>
<span  style="">  77                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78   @Override                                                                                              </span>
<span class="5129811123076044151" onmouseenter="enter('5129811123076044151');" onmouseout="out('5129811123076044151');" style="">  79   public boolean handleMessage(Message msg) {                                                            </span>
<span class="1559751491132455129" onmouseenter="enter('1559751491132455129');" onmouseout="out('1559751491132455129');" style="">  80     DownloadTask task = ((DownloadTask) (msg.obj));                                                      </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style="">  81     if (task == null) {                                                                                  </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style="">  82       Log.e(TAG, &quot;请传入下载任务&quot;);                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  83       return true;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style="">  85     callback(msg.what, task);                                                                            </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="">  86     DownloadEntity entity = task.getDownloadEntity();                                                    </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style="">  87     switch (msg.what) {                                                                                  </span>
<span class="4883280140866029272" onmouseenter="enter('4883280140866029272');" onmouseout="out('4883280140866029272');" style="">  88       case STOP :                                                                                        </span>
<span class="3164712505627047613" onmouseenter="enter('3164712505627047613');" onmouseout="out('3164712505627047613');" style="">  89       case CANCEL :                                                                                      </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="">  90         mQueue.removeTask(entity);                                                                       </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style="">  91         if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                              </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="">  92           startNextTask();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93         }                                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  94         break;                                                                                           </span>
<span class="-8219071303812915480" onmouseenter="enter('-8219071303812915480');" onmouseout="out('-8219071303812915480');" style="">  95       case COMPLETE :                                                                                    </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="">  96         mQueue.removeTask(entity);                                                                       </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="">  97         startNextTask();                                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="">  98         break;                                                                                           </span>
<span class="6502177810806328848" onmouseenter="enter('6502177810806328848');" onmouseout="out('6502177810806328848');" style="">  99       case FAIL :                                                                                        </span>
<span class="6557620446996273889" onmouseenter="enter('6557620446996273889');" onmouseout="out('6557620446996273889');" style=""> 100         //mQueue.removeTask(entity);                                                                     </span>
<span class="2925124162455559864" onmouseenter="enter('2925124162455559864');" onmouseout="out('2925124162455559864');" style=""> 101         handleFailTask(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102         break;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103     }                                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 104     return true;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105   }                                                                                                      </span>
<span  style=""> 106                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 107   /**                                                                                                    </span>
<span class="5701145962088405995" onmouseenter="enter('5701145962088405995');" onmouseout="out('5701145962088405995');" style=""> 108    * 回调                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 109    *                                                                                                     </span>
<span class="6794715047748436388" onmouseenter="enter('6794715047748436388');" onmouseout="out('6794715047748436388');" style=""> 110    * @param state 状态                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 111    */                                                                                                    </span>
<span class="-6525939261817098917" onmouseenter="enter('-6525939261817098917');" onmouseout="out('-6525939261817098917');" style=""> 112   private void callback(int state, DownloadTask task) {                                                  </span>
<span class="6264342014304299429" onmouseenter="enter('6264342014304299429');" onmouseout="out('6264342014304299429');" style=""> 113     if (mSchedulerListeners.size() &gt; 0) {                                                                </span>
<span class="-8197804712143627403" onmouseenter="enter('-8197804712143627403');" onmouseout="out('-8197804712143627403');" style=""> 114       //if (!TextUtils.isEmpty(task.getTargetName())) {                                                  </span>
<span class="7236226619005487457" onmouseenter="enter('7236226619005487457');" onmouseout="out('7236226619005487457');" style=""> 115       //  callback(state, task, mSchedulerListeners.get(task.getTargetName()));                          </span>
<span class="-4740675746293055676" onmouseenter="enter('-4740675746293055676');" onmouseout="out('-4740675746293055676');" style=""> 116       //}                                                                                                </span>
<span class="-5867093652927473424" onmouseenter="enter('-5867093652927473424');" onmouseout="out('-5867093652927473424');" style=""> 117       Set&lt;String&gt; keys = mSchedulerListeners.keySet();                                                   </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 118       for (String key : keys) {                                                                          </span>
<span class="7522587192355288650" onmouseenter="enter('7522587192355288650');" onmouseout="out('7522587192355288650');" style=""> 119         callback(state, task, mSchedulerListeners.get(key));                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122   }                                                                                                      </span>
<span  style=""> 123                                                                                                          </span>
<span class="2004717122041795199" onmouseenter="enter('2004717122041795199');" onmouseout="out('2004717122041795199');" style=""><abbr title=" 124   private void callback(int state, DownloadTask task, IDownloadSchedulerListener&lt;DownloadTask&gt; listener) {"> 124   private void callback(int state, DownloadTask task, IDownloadSchedulerListener&lt;DownloadTask&gt; listener) 🔵</abbr></span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 125     if (listener != null) {                                                                              </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 126       if (task == null) {                                                                                </span>
<span class="-558067560321655497" onmouseenter="enter('-558067560321655497');" onmouseout="out('-558067560321655497');" style=""> 127         Log.e(TAG, &quot;TASK 为null，回调失败&quot;);                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 128         return;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129       }                                                                                                  </span>
<span class="-7165330810205169714" onmouseenter="enter('-7165330810205169714');" onmouseout="out('-7165330810205169714');" style=""> 130       switch (state) {                                                                                   </span>
<span class="-2091756742855520175" onmouseenter="enter('-2091756742855520175');" onmouseout="out('-2091756742855520175');" style=""> 131         case RUNNING :                                                                                   </span>
<span class="8481034844882813554" onmouseenter="enter('8481034844882813554');" onmouseout="out('8481034844882813554');" style=""> 132           listener.onTaskRunning(task);                                                                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 133           break;                                                                                         </span>
<span class="-479947537220066798" onmouseenter="enter('-479947537220066798');" onmouseout="out('-479947537220066798');" style=""> 134         case START :                                                                                     </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style=""> 135           listener.onTaskStart(task);                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 136           break;                                                                                         </span>
<span class="4883280140866029272" onmouseenter="enter('4883280140866029272');" onmouseout="out('4883280140866029272');" style=""> 137         case STOP :                                                                                      </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style=""> 138           listener.onTaskStop(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 139           break;                                                                                         </span>
<span class="-5589794595704674535" onmouseenter="enter('-5589794595704674535');" onmouseout="out('-5589794595704674535');" style=""> 140         case RESUME :                                                                                    </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style=""> 141           listener.onTaskResume(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 142           break;                                                                                         </span>
<span class="109796662406278317" onmouseenter="enter('109796662406278317');" onmouseout="out('109796662406278317');" style=""> 143         case PRE :                                                                                       </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style=""> 144           listener.onTaskPre(task);                                                                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 145           break;                                                                                         </span>
<span class="3164712505627047613" onmouseenter="enter('3164712505627047613');" onmouseout="out('3164712505627047613');" style=""> 146         case CANCEL :                                                                                    </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style=""> 147           listener.onTaskCancel(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 148           break;                                                                                         </span>
<span class="-8219071303812915480" onmouseenter="enter('-8219071303812915480');" onmouseout="out('-8219071303812915480');" style=""> 149         case COMPLETE :                                                                                  </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style=""> 150           listener.onTaskComplete(task);                                                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 151           break;                                                                                         </span>
<span class="6502177810806328848" onmouseenter="enter('6502177810806328848');" onmouseout="out('6502177810806328848');" style=""> 152         case FAIL :                                                                                      </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style=""> 153           listener.onTaskFail(task);                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 154           break;                                                                                         </span>
<span class="8649654209417358265" onmouseenter="enter('8649654209417358265');" onmouseout="out('8649654209417358265');" style=""> 155         case SUPPORT_BREAK_POINT :                                                                       </span>
<span class="-4028020960632858822" onmouseenter="enter('-4028020960632858822');" onmouseout="out('-4028020960632858822');" style=""> 156           listener.onNoSupportBreakPoint(task);                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 157           break;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158       }                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160   }                                                                                                      </span>
<span  style=""> 161                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 162   /**                                                                                                    </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style=""> 163    * 处理下载任务下载失败的情形                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 164    *                                                                                                     </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style=""> 165    * @param entity 失败实体                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 166    */                                                                                                    </span>
<span class="-680174866686900344" onmouseenter="enter('-680174866686900344');" onmouseout="out('-680174866686900344');" style=""> 167   private void handleFailTask(final                                                                      </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 168 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="3599803112540821364" onmouseenter="enter('3599803112540821364');" onmouseout="out('3599803112540821364');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 169 Task                                                                                                     </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 170 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 171 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 171 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 172 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173                                                                                                          </span>
<span class="-1252468937136410338" onmouseenter="enter('-1252468937136410338');" onmouseout="out('-1252468937136410338');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174 DownloadTask                                                                                             </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 175 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="3627243256907335068" onmouseenter="enter('3627243256907335068');" onmouseout="out('3627243256907335068');" style=""> 176    task) {                                                                                               </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style=""> 177     final Configuration config = Configuration.getInstance();                                            </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style=""> 178     CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                         </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style=""> 179       @Override public void onTick(long millisUntilFinished) {                                           </span>
<span  style=""> 180                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181       }                                                                                                  </span>
<span  style=""> 182                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 183       @Override                                                                                          </span>
<span class="3349219920976476569" onmouseenter="enter('3349219920976476569');" onmouseout="out('3349219920976476569');" style=""> 184       public void onFinish() {                                                                           </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style=""> 185         DownloadEntity entity = task.getDownloadEntity();                                                </span>
<span class="1857717324066272338" onmouseenter="enter('1857717324066272338');" onmouseout="out('1857717324066272338');" style=""> 186         if (entity.getFailNum() &lt; config.getReTryNum()) {                                                </span>
<span class="2015918851482799865" onmouseenter="enter('2015918851482799865');" onmouseout="out('2015918851482799865');" style=""> 187           DownloadTask task = mQueue.getTask(entity);                                                    </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style=""> 188           mQueue.reTryStart(task);                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 189           try {                                                                                          </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style=""> 190             Thread.sleep(config.getReTryInterval());                                                     </span>
<span class="4824049649208119838" onmouseenter="enter('4824049649208119838');" onmouseout="out('4824049649208119838');" style=""> 191           } catch (java.lang.InterruptedException e) {                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 192             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193           }                                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 194         } else {                                                                                         </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 195           mQueue.removeTask(entity);                                                                     </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style=""> 196           startNextTask();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198       }                                                                                                  </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 199     };                                                                                                   </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style=""> 200     timer.start();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201   }                                                                                                      </span>
<span  style=""> 202                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 203   /**                                                                                                    </span>
<span class="1254639702238739792" onmouseenter="enter('1254639702238739792');" onmouseout="out('1254639702238739792');" style=""> 204    * 启动下一个任务，条件：任务停止，取消下载，任务完成                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 205    */                                                                                                    </span>
<span class="-669202063827981309" onmouseenter="enter('-669202063827981309');" onmouseout="out('-669202063827981309');" style=""> 206   private void startNextTask() {                                                                         </span>
<span class="-1613093400901244409" onmouseenter="enter('-1613093400901244409');" onmouseout="out('-1613093400901244409');" style=""> 207     DownloadTask newTask = mQueue.getNextTask();                                                         </span>
<span class="7215532936246787403" onmouseenter="enter('7215532936246787403');" onmouseout="out('7215532936246787403');" style=""> 208     if (newTask == null) {                                                                               </span>
<span class="-4835257036825404123" onmouseenter="enter('-4835257036825404123');" onmouseout="out('-4835257036825404123');" style=""> 209       Log.w(TAG, &quot;没有下一任务&quot;);                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 210       return;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span class="2202099522712246363" onmouseenter="enter('2202099522712246363');" onmouseout="out('2202099522712246363');" style=""> 212     if (newTask.getDownloadEntity().getState() == DownloadEntity.STATE_WAIT) {                           </span>
<span class="6679029410179135267" onmouseenter="enter('6679029410179135267');" onmouseout="out('6679029410179135267');" style=""> 213       mQueue.startTask(newTask);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215   }                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216 }                                                                                                        </span>































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2   * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="-3312156477302878812" onmouseenter="enter('-3312156477302878812');" onmouseout="out('-3312156477302878812');" style="">  17  package com.arialyy.aria.core.scheduler;                                                                          </span>
<span  style="">  18                                                                                                                    </span>
<span class="371096003059305121" onmouseenter="enter('371096003059305121');" onmouseout="out('371096003059305121');" style="">  19  import android.os.CountDownTimer;                                                                                 </span>
<span class="2113358441178436248" onmouseenter="enter('2113358441178436248');" onmouseout="out('2113358441178436248');" style="">  20  import android.os.Message;                                                                                        </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">  21  import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  22  import android.util.Log;                                                                                          </span>
<span class="6769003314708799014" onmouseenter="enter('6769003314708799014');" onmouseout="out('6769003314708799014');" style="">  23  import com.arialyy.aria.core.DownloadManager;                                                                     </span>
<span class="-3890068194778671861" onmouseenter="enter('-3890068194778671861');" onmouseout="out('-3890068194778671861');" style="">  24  import com.arialyy.aria.core.queue.ITaskQueue;                                                                    </span>
<span class="-8446909004143589790" onmouseenter="enter('-8446909004143589790');" onmouseout="out('-8446909004143589790');" style="">  25  import com.arialyy.aria.core.DownloadEntity;                                                                      </span>
<span class="-7095809439490141988" onmouseenter="enter('-7095809439490141988');" onmouseout="out('-7095809439490141988');" style="">  26  import com.arialyy.aria.core.task.Task;                                                                           </span>



<span class="-288495809736068445" onmouseenter="enter('-288495809736068445');" onmouseout="out('-288495809736068445');" style="">  27  import com.arialyy.aria.util.Configuration;                                                                       </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  28  import java.util.Iterator;                                                                                        </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  29  import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  30  import java.util.Set;                                                                                             </span>
<span class="8600016768069240092" onmouseenter="enter('8600016768069240092');" onmouseout="out('8600016768069240092');" style="">  31  import java.util.concurrent.ConcurrentHashMap;                                                                    </span>
<span  style="">  32                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  33  /**                                                                                                               </span>
<span class="-3542925026229653469" onmouseenter="enter('-3542925026229653469');" onmouseout="out('-3542925026229653469');" style="">  34   * Created by lyy on 2016/8/16.                                                                                   </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="">  35   * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  36   */                                                                                                               </span>
<span class="4304627110649516611" onmouseenter="enter('4304627110649516611');" onmouseout="out('4304627110649516611');" style="">  37  public class DownloadSchedulers implements IDownloadSchedulers {                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38    /**                                                                                                             </span>
<span class="-6909290071230674405" onmouseenter="enter('-6909290071230674405');" onmouseout="out('-6909290071230674405');" style="">  39     * 任务预加载                                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  40     */                                                                                                             </span>
<span class="-3798224625689547634" onmouseenter="enter('-3798224625689547634');" onmouseout="out('-3798224625689547634');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -  public static final int PRE = 0;                                                                                </span>
<span class="621905077341889805" onmouseenter="enter('621905077341889805');" onmouseout="out('621905077341889805');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +  public static final     int                PRE      = 0;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  43    /**                                                                                                             </span>
<span class="-8586305757395820434" onmouseenter="enter('-8586305757395820434');" onmouseout="out('-8586305757395820434');" style="">  44     * 任务开始                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45     */                                                                                                             </span>
<span class="1856669191456841516" onmouseenter="enter('1856669191456841516');" onmouseout="out('1856669191456841516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -  public static final int START = 1;                                                                              </span>
<span class="5854176642066686753" onmouseenter="enter('5854176642066686753');" onmouseout="out('5854176642066686753');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +  public static final     int                START    = 1;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  48    /**                                                                                                             </span>
<span class="-5690582150325294743" onmouseenter="enter('-5690582150325294743');" onmouseout="out('-5690582150325294743');" style="">  49     * 任务停止                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50     */                                                                                                             </span>
<span class="-1234849400005407647" onmouseenter="enter('-1234849400005407647');" onmouseout="out('-1234849400005407647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -  public static final int STOP = 2;                                                                               </span>
<span class="7072236631644491578" onmouseenter="enter('7072236631644491578');" onmouseout="out('7072236631644491578');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +  public static final     int                STOP     = 2;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  53    /**                                                                                                             </span>
<span class="7725539954827761966" onmouseenter="enter('7725539954827761966');" onmouseout="out('7725539954827761966');" style="">  54     * 任务失败                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  55     */                                                                                                             </span>
<span class="-1844166370265963480" onmouseenter="enter('-1844166370265963480');" onmouseout="out('-1844166370265963480');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -  public static final int FAIL = 3;                                                                               </span>
<span class="7445939163633569925" onmouseenter="enter('7445939163633569925');" onmouseout="out('7445939163633569925');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +  public static final     int                FAIL     = 3;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  58    /**                                                                                                             </span>
<span class="2064875861948696274" onmouseenter="enter('2064875861948696274');" onmouseout="out('2064875861948696274');" style="">  59     * 任务取消                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  60     */                                                                                                             </span>
<span class="2577052996693665294" onmouseenter="enter('2577052996693665294');" onmouseout="out('2577052996693665294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -  public static final int CANCEL = 4;                                                                             </span>
<span class="-7738869181134989471" onmouseenter="enter('-7738869181134989471');" onmouseout="out('-7738869181134989471');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +  public static final     int                CANCEL   = 4;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63    /**                                                                                                             </span>
<span class="-5025359896728506958" onmouseenter="enter('-5025359896728506958');" onmouseout="out('-5025359896728506958');" style="">  64     * 任务完成                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  65     */                                                                                                             </span>
<span class="-4459433206105700619" onmouseenter="enter('-4459433206105700619');" onmouseout="out('-4459433206105700619');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -  public static final int COMPLETE = 5;                                                                           </span>
<span class="-7939522823297918743" onmouseenter="enter('-7939522823297918743');" onmouseout="out('-7939522823297918743');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +  public static final     int                COMPLETE = 5;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68    /**                                                                                                             </span>
<span class="7866565969200819017" onmouseenter="enter('7866565969200819017');" onmouseout="out('7866565969200819017');" style="">  69     * 下载中                                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  70     */                                                                                                             </span>
<span class="-4113841519595777363" onmouseenter="enter('-4113841519595777363');" onmouseout="out('-4113841519595777363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -  public static final int RUNNING = 6;                                                                            </span>
<span class="5237573137659845133" onmouseenter="enter('5237573137659845133');" onmouseout="out('5237573137659845133');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +  public static final     int                RUNNING  = 6;                                                        </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73    /**                                                                                                             </span>
<span class="-4583384747655535323" onmouseenter="enter('-4583384747655535323');" onmouseout="out('-4583384747655535323');" style="">  74     * 恢复下载                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  75     */                                                                                                             </span>
<span class="6596687279686396548" onmouseenter="enter('6596687279686396548');" onmouseout="out('6596687279686396548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -  public static final int RESUME = 7;                                                                             </span>


<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -  private static final String TAG = &quot;DownloadSchedulers&quot;;                                                         </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -  private static final Object LOCK = new Object();                                                                </span>
<span class="5841509014307126013" onmouseenter="enter('5841509014307126013');" onmouseout="out('5841509014307126013');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +  public static final     int                RESUME   = 7;                                                        </span>
<span class="5658848929593010938" onmouseenter="enter('5658848929593010938');" onmouseout="out('5658848929593010938');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +  private static final    String             TAG      = &quot;DownloadSchedulers&quot;;                                     </span>
<span class="-530418496755553317" onmouseenter="enter('-530418496755553317');" onmouseout="out('-530418496755553317');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +  private static final    Object             LOCK     = new Object();                                             </span>
<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style="">  82    private static volatile DownloadSchedulers INSTANCE = null;                                                     </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84    /**                                                                                                             </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style="">  85     * 下载器任务监听                                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86     */                                                                                                             </span>
<span class="8456381727773251435" onmouseenter="enter('8456381727773251435');" onmouseout="out('8456381727773251435');" style="">  87    Map&lt;String, OnSchedulerListener&gt; mSchedulerListeners = new ConcurrentHashMap&lt;&gt;();                               </span>
<span class="-8842931816589902990" onmouseenter="enter('-8842931816589902990');" onmouseout="out('-8842931816589902990');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -  DownloadManager mManager = DownloadManager.getInstance();                                                       </span>
<span class="4917723528378434790" onmouseenter="enter('4917723528378434790');" onmouseout="out('4917723528378434790');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +  DownloadManager                  mManager            = DownloadManager.getInstance();                           </span>
<span class="8598976265326351040" onmouseenter="enter('8598976265326351040');" onmouseout="out('8598976265326351040');" style="">  90    ITaskQueue mQueue;                                                                                              </span>



<span  style="">  91                                                                                                                    </span>
<span class="-4615998420186637334" onmouseenter="enter('-4615998420186637334');" onmouseout="out('-4615998420186637334');" style="">  92    private DownloadSchedulers() {                                                                                  </span>
<span class="-2136875981592484278" onmouseenter="enter('-2136875981592484278');" onmouseout="out('-2136875981592484278');" style="">  93      mQueue = mManager.getTaskQueue();                                                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94    }                                                                                                               </span>
<span  style="">  95                                                                                                                    </span>
<span class="-519894234808704272" onmouseenter="enter('-519894234808704272');" onmouseout="out('-519894234808704272');" style="">  96    public static DownloadSchedulers getInstance() {                                                                </span>
<span class="-8097436755426287019" onmouseenter="enter('-8097436755426287019');" onmouseout="out('-8097436755426287019');" style="">  97      if (INSTANCE == null) {                                                                                       </span>
<span class="-889825015365812481" onmouseenter="enter('-889825015365812481');" onmouseout="out('-889825015365812481');" style="">  98        synchronized (LOCK) {                                                                                       </span>
<span class="-477661885051927020" onmouseenter="enter('-477661885051927020');" onmouseout="out('-477661885051927020');" style="">  99          //INSTANCE = new DownloadSchedulers(queue);                                                               </span>
<span class="-4113076547335811880" onmouseenter="enter('-4113076547335811880');" onmouseout="out('-4113076547335811880');" style=""> 100          INSTANCE = new DownloadSchedulers();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102      }                                                                                                             </span>
<span class="-2388388574337551660" onmouseenter="enter('-2388388574337551660');" onmouseout="out('-2388388574337551660');" style=""> 103      return INSTANCE;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104    }                                                                                                               </span>
<span  style=""> 105                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 106    @Override                                                                                                       </span>
<span class="1472957630765294322" onmouseenter="enter('1472957630765294322');" onmouseout="out('1472957630765294322');" style=""> 107    public void addSchedulerListener(String targetName, OnSchedulerListener schedulerListener) {                    </span>
<span class="-7687922112020440468" onmouseenter="enter('-7687922112020440468');" onmouseout="out('-7687922112020440468');" style=""> 108      mSchedulerListeners.put(targetName, schedulerListener);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109    }                                                                                                               </span>
<span  style=""> 110                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 111    @Override                                                                                                       </span>
<span class="-3983392630216527778" onmouseenter="enter('-3983392630216527778');" onmouseout="out('-3983392630216527778');" style=""> 112    public void removeSchedulerListener(String targetName, OnSchedulerListener schedulerListener) {                 </span>
<span class="6836852313823545406" onmouseenter="enter('6836852313823545406');" onmouseout="out('6836852313823545406');" style=""> 113      //OnSchedulerListener listener = mSchedulerListeners.get(target.getClass().getName());                        </span>
<span class="-4758361548811584798" onmouseenter="enter('-4758361548811584798');" onmouseout="out('-4758361548811584798');" style=""> 114      //mSchedulerListeners.remove(listener);                                                                       </span>








<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style=""><abbr title=" 115      //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element"> 115      //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashma🔵</abbr></span>
<span class="743911132097881635" onmouseenter="enter('743911132097881635');" onmouseout="out('743911132097881635');" style=""> 116      for (Iterator&lt;Map.Entry&lt;String, OnSchedulerListener&gt;&gt; iter =                                                  </span>

<span class="-8199036773943606321" onmouseenter="enter('-8199036773943606321');" onmouseout="out('-8199036773943606321');" style=""> 117          mSchedulerListeners.entrySet().iterator(); iter.hasNext(); ) {                                            </span>
<span class="-7435768381575910650" onmouseenter="enter('-7435768381575910650');" onmouseout="out('-7435768381575910650');" style=""> 118        Map.Entry&lt;String, OnSchedulerListener&gt; entry = iter.next();                                                 </span>

<span class="-1599663307714431138" onmouseenter="enter('-1599663307714431138');" onmouseout="out('-1599663307714431138');" style=""> 119        if (entry.getKey().equals(targetName)) iter.remove();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121    }                                                                                                               </span>
<span  style=""> 122                                                                                                                    </span>
<span class="-5093355790655318910" onmouseenter="enter('-5093355790655318910');" onmouseout="out('-5093355790655318910');" style=""> 123    @Override public boolean handleMessage(Message msg) {                                                           </span>
<span class="-6718823554380121078" onmouseenter="enter('-6718823554380121078');" onmouseout="out('-6718823554380121078');" style=""> 124      Task task = (Task) msg.obj;                                                                                   </span>

<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 125      if (task == null) {                                                                                           </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style=""> 126        Log.e(TAG, &quot;请传入下载任务&quot;);                                                                                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 127        return true;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style=""> 129      callback(msg.what, task);                                                                                     </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style=""> 130      DownloadEntity entity = task.getDownloadEntity();                                                             </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style=""> 131      switch (msg.what) {                                                                                           </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 132        case STOP:                                                                                                  </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 133        case CANCEL:                                                                                                </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 134          mQueue.removeTask(entity);                                                                                </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style=""> 135          if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                                       </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style=""> 136            startNextTask(entity);                                                                                  </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137          }                                                                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 138          break;                                                                                                    </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 139        case COMPLETE:                                                                                              </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 140          mQueue.removeTask(entity);                                                                                </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style=""> 141          startNextTask(entity);                                                                                    </span>

<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 142          break;                                                                                                    </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 143        case FAIL:                                                                                                  </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -        mQueue.removeTask(entity);                                                                                </span>
<span class="-2551087727399721242" onmouseenter="enter('-2551087727399721242');" onmouseout="out('-2551087727399721242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        handleFailTask(entity);                                                                                   </span>
<span class="2925124162455559864" onmouseenter="enter('2925124162455559864');" onmouseout="out('2925124162455559864');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +        handleFailTask(task);                                                                                     </span>

<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 147          break;                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148      }                                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 149      return true;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150    }                                                                                                               </span>
<span  style=""> 151                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 152    /**                                                                                                             </span>
<span class="5701145962088405995" onmouseenter="enter('5701145962088405995');" onmouseout="out('5701145962088405995');" style=""> 153     * 回调                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 154     *                                                                                                              </span>
<span class="6794715047748436388" onmouseenter="enter('6794715047748436388');" onmouseout="out('6794715047748436388');" style=""> 155     * @param state 状态                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 156     */                                                                                                             </span>
<span class="8526566288242532728" onmouseenter="enter('8526566288242532728');" onmouseout="out('8526566288242532728');" style=""> 157    private void callback(int state, Task task) {                                                                   </span>

<span class="6264342014304299429" onmouseenter="enter('6264342014304299429');" onmouseout="out('6264342014304299429');" style=""> 158      if (mSchedulerListeners.size() &gt; 0) {                                                                         </span>
<span class="-8197804712143627403" onmouseenter="enter('-8197804712143627403');" onmouseout="out('-8197804712143627403');" style=""> 159        //if (!TextUtils.isEmpty(task.getTargetName())) {                                                           </span>
<span class="7236226619005487457" onmouseenter="enter('7236226619005487457');" onmouseout="out('7236226619005487457');" style=""> 160        //  callback(state, task, mSchedulerListeners.get(task.getTargetName()));                                   </span>
<span class="-4740675746293055676" onmouseenter="enter('-4740675746293055676');" onmouseout="out('-4740675746293055676');" style=""> 161        //}                                                                                                         </span>
<span class="-5867093652927473424" onmouseenter="enter('-5867093652927473424');" onmouseout="out('-5867093652927473424');" style=""> 162        Set&lt;String&gt; keys = mSchedulerListeners.keySet();                                                            </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 163        for (String key : keys) {                                                                                   </span>
<span class="7522587192355288650" onmouseenter="enter('7522587192355288650');" onmouseout="out('7522587192355288650');" style=""> 164          callback(state, task, mSchedulerListeners.get(key));                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167    }                                                                                                               </span>
<span  style=""> 168                                                                                                                    </span>
<span class="-2575591080159390515" onmouseenter="enter('-2575591080159390515');" onmouseout="out('-2575591080159390515');" style=""> 169    private void callback(int state, Task task, OnSchedulerListener listener) {                                     </span>


<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 170      if (listener != null) {                                                                                       </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 171        if (task == null) {                                                                                         </span>
<span class="-558067560321655497" onmouseenter="enter('-558067560321655497');" onmouseout="out('-558067560321655497');" style=""> 172          Log.e(TAG, &quot;TASK 为null，回调失败&quot;);                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 173          return;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174        }                                                                                                           </span>
<span class="-7165330810205169714" onmouseenter="enter('-7165330810205169714');" onmouseout="out('-7165330810205169714');" style=""> 175        switch (state) {                                                                                            </span>
<span class="3901942634001995069" onmouseenter="enter('3901942634001995069');" onmouseout="out('3901942634001995069');" style=""> 176          case RUNNING:                                                                                             </span>
<span class="8481034844882813554" onmouseenter="enter('8481034844882813554');" onmouseout="out('8481034844882813554');" style=""> 177            listener.onTaskRunning(task);                                                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 178            break;                                                                                                  </span>
<span class="-2079449841199557933" onmouseenter="enter('-2079449841199557933');" onmouseout="out('-2079449841199557933');" style=""> 179          case START:                                                                                               </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style=""> 180            listener.onTaskStart(task);                                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 181            break;                                                                                                  </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 182          case STOP:                                                                                                </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style=""> 183            listener.onTaskStop(task);                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 184            break;                                                                                                  </span>
<span class="-109811889113334874" onmouseenter="enter('-109811889113334874');" onmouseout="out('-109811889113334874');" style=""> 185          case RESUME:                                                                                              </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style=""> 186            listener.onTaskResume(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 187            break;                                                                                                  </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style=""> 188          case PRE:                                                                                                 </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style=""> 189            listener.onTaskPre(task);                                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 190            break;                                                                                                  </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 191          case CANCEL:                                                                                              </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style=""> 192            listener.onTaskCancel(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 193            break;                                                                                                  </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 194          case COMPLETE:                                                                                            </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style=""> 195            listener.onTaskComplete(task);                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 196            break;                                                                                                  </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 197          case FAIL:                                                                                                </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style=""> 198            listener.onTaskFail(task);                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 199            break;                                                                                                  </span>



<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202    }                                                                                                               </span>
<span  style=""> 203                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 204    /**                                                                                                             </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style=""> 205     * 处理下载任务下载失败的情形                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 206     *                                                                                                              </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -   * @param entity 失败实体                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -   */                                                                                                             </span>
<span class="-1695955174776440054" onmouseenter="enter('-1695955174776440054');" onmouseout="out('-1695955174776440054');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -  @Override public void handleFailTask(final DownloadEntity entity) {                                             </span>
<span class="2776247698490779697" onmouseenter="enter('2776247698490779697');" onmouseout="out('2776247698490779697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +   * @param task 下载任务                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 211 +   */                                                                                                             </span>
<span class="5250270752909639380" onmouseenter="enter('5250270752909639380');" onmouseout="out('5250270752909639380');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +  @Override public void handleFailTask(final Task task) {                                                         </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style=""> 213      final Configuration config = Configuration.getInstance();                                                     </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style=""> 214      CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                                  </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style=""> 215        @Override public void onTick(long millisUntilFinished) {                                                    </span>
<span  style=""> 216                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217        }                                                                                                           </span>
<span  style=""> 218                                                                                                                    </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style=""> 219        @Override public void onFinish() {                                                                          </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +        DownloadEntity entity = task.getDownloadEntity();                                                         </span>
<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style=""> 221          if (entity.getFailNum() &lt;= config.getReTryNum()) {                                                        </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style=""> 222            Task task = mQueue.getTask(entity);                                                                     </span>



<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style=""> 223            mQueue.reTryStart(task);                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 224            try {                                                                                                   </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style=""> 225              Thread.sleep(config.getReTryInterval());                                                              </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style=""> 226            } catch (InterruptedException e) {                                                                      </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 227              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228            }                                                                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 229          } else {                                                                                                  </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +          mQueue.removeTask(entity);                                                                              </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style=""> 231            startNextTask(entity);                                                                                  </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233        }                                                                                                           </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 234      };                                                                                                            </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style=""> 235      timer.start();                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236    }                                                                                                               </span>
<span  style=""> 237                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 238    /**                                                                                                             </span>
<span class="1254639702238739792" onmouseenter="enter('1254639702238739792');" onmouseout="out('1254639702238739792');" style=""> 239     * 启动下一个任务，条件：任务停止，取消下载，任务完成                                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 240     *                                                                                                              </span>
<span class="-705409987305539511" onmouseenter="enter('-705409987305539511');" onmouseout="out('-705409987305539511');" style=""> 241     * @param entity 通过Handler传递的下载实体                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 242     */                                                                                                             </span>
<span class="-8853169797109920301" onmouseenter="enter('-8853169797109920301');" onmouseout="out('-8853169797109920301');" style=""> 243    @Override public void startNextTask(DownloadEntity entity) {                                                    </span>
<span class="3370827879289135868" onmouseenter="enter('3370827879289135868');" onmouseout="out('3370827879289135868');" style=""> 244      Task newTask = mQueue.getNextTask();                                                                          </span>



<span class="7215532936246787403" onmouseenter="enter('7215532936246787403');" onmouseout="out('7215532936246787403');" style=""> 245      if (newTask == null) {                                                                                        </span>
<span class="-4835257036825404123" onmouseenter="enter('-4835257036825404123');" onmouseout="out('-4835257036825404123');" style=""> 246        Log.w(TAG, &quot;没有下一任务&quot;);                                                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 247        return;                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248      }                                                                                                             </span>
<span class="2202099522712246363" onmouseenter="enter('2202099522712246363');" onmouseout="out('2202099522712246363');" style=""> 249      if (newTask.getDownloadEntity().getState() == DownloadEntity.STATE_WAIT) {                                    </span>
<span class="6679029410179135267" onmouseenter="enter('6679029410179135267');" onmouseout="out('6679029410179135267');" style=""> 250        mQueue.startTask(newTask);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252    }                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="-4176855950178531235" onmouseenter="enter('-4176855950178531235');" onmouseout="out('-4176855950178531235');" style="">   2   * Copyright (C) 2016 AriaLyy(https://github.com/AriaLyy/Aria)                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="-3312156477302878812" onmouseenter="enter('-3312156477302878812');" onmouseout="out('-3312156477302878812');" style="">  17  package com.arialyy.aria.core.scheduler;                                                                          </span>
<span  style="">  18                                                                                                                    </span>
<span class="371096003059305121" onmouseenter="enter('371096003059305121');" onmouseout="out('371096003059305121');" style="">  19  import android.os.CountDownTimer;                                                                                 </span>
<span class="2113358441178436248" onmouseenter="enter('2113358441178436248');" onmouseout="out('2113358441178436248');" style="">  20  import android.os.Message;                                                                                        </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import android.text.TextUtils;                                                                                    </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  22  import android.util.Log;                                                                                          </span>
<span class="6769003314708799014" onmouseenter="enter('6769003314708799014');" onmouseout="out('6769003314708799014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.arialyy.aria.core.DownloadManager;                                                                     </span>
<span class="-3890068194778671861" onmouseenter="enter('-3890068194778671861');" onmouseout="out('-3890068194778671861');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.arialyy.aria.core.queue.ITaskQueue;                                                                    </span>
<span class="-8446909004143589790" onmouseenter="enter('-8446909004143589790');" onmouseout="out('-8446909004143589790');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.arialyy.aria.core.DownloadEntity;                                                                      </span>
<span class="-7095809439490141988" onmouseenter="enter('-7095809439490141988');" onmouseout="out('-7095809439490141988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.arialyy.aria.core.task.Task;                                                                           </span>
<span class="1325372506799583582" onmouseenter="enter('1325372506799583582');" onmouseout="out('1325372506799583582');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import com.arialyy.aria.core.queue.DownloadTaskQueue;                                                             </span>
<span class="1932658903610588883" onmouseenter="enter('1932658903610588883');" onmouseout="out('1932658903610588883');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +import com.arialyy.aria.core.download.DownloadEntity;                                                             </span>
<span class="-2556631877775212617" onmouseenter="enter('-2556631877775212617');" onmouseout="out('-2556631877775212617');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import com.arialyy.aria.core.download.DownloadTask;                                                               </span>
<span class="-288495809736068445" onmouseenter="enter('-288495809736068445');" onmouseout="out('-288495809736068445');" style="">  30  import com.arialyy.aria.util.Configuration;                                                                       </span>
<span class="7112180775387943933" onmouseenter="enter('7112180775387943933');" onmouseout="out('7112180775387943933');" style="">  31  import java.util.Iterator;                                                                                        </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  32  import java.util.Map;                                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  33  import java.util.Set;                                                                                             </span>
<span class="8600016768069240092" onmouseenter="enter('8600016768069240092');" onmouseout="out('8600016768069240092');" style="">  34  import java.util.concurrent.ConcurrentHashMap;                                                                    </span>
<span  style="">  35                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  36  /**                                                                                                               </span>
<span class="-3542925026229653469" onmouseenter="enter('-3542925026229653469');" onmouseout="out('-3542925026229653469');" style="">  37   * Created by lyy on 2016/8/16.                                                                                   </span>
<span class="-4501191225557733704" onmouseenter="enter('-4501191225557733704');" onmouseout="out('-4501191225557733704');" style="">  38   * 任务下载器，提供抽象的方法供具体的实现类操作                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  39   */                                                                                                               </span>
<span class="4304627110649516611" onmouseenter="enter('4304627110649516611');" onmouseout="out('4304627110649516611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -public class DownloadSchedulers implements IDownloadSchedulers {                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -  /**                                                                                                             </span>
<span class="-6909290071230674405" onmouseenter="enter('-6909290071230674405');" onmouseout="out('-6909290071230674405');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -   * 任务预加载                                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -   */                                                                                                             </span>
<span class="-3798224625689547634" onmouseenter="enter('-3798224625689547634');" onmouseout="out('-3798224625689547634');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -  public static final int PRE = 0;                                                                                </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -  /**                                                                                                             </span>
<span class="-8586305757395820434" onmouseenter="enter('-8586305757395820434');" onmouseout="out('-8586305757395820434');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -   * 任务开始                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -   */                                                                                                             </span>
<span class="1856669191456841516" onmouseenter="enter('1856669191456841516');" onmouseout="out('1856669191456841516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -  public static final int START = 1;                                                                              </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -  /**                                                                                                             </span>
<span class="-5690582150325294743" onmouseenter="enter('-5690582150325294743');" onmouseout="out('-5690582150325294743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -   * 任务停止                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -   */                                                                                                             </span>
<span class="-1234849400005407647" onmouseenter="enter('-1234849400005407647');" onmouseout="out('-1234849400005407647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -  public static final int STOP = 2;                                                                               </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -  /**                                                                                                             </span>
<span class="7725539954827761966" onmouseenter="enter('7725539954827761966');" onmouseout="out('7725539954827761966');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -   * 任务失败                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -   */                                                                                                             </span>
<span class="-1844166370265963480" onmouseenter="enter('-1844166370265963480');" onmouseout="out('-1844166370265963480');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -  public static final int FAIL = 3;                                                                               </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -  /**                                                                                                             </span>
<span class="2064875861948696274" onmouseenter="enter('2064875861948696274');" onmouseout="out('2064875861948696274');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -   * 任务取消                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -   */                                                                                                             </span>
<span class="2577052996693665294" onmouseenter="enter('2577052996693665294');" onmouseout="out('2577052996693665294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -  public static final int CANCEL = 4;                                                                             </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -  /**                                                                                                             </span>
<span class="-5025359896728506958" onmouseenter="enter('-5025359896728506958');" onmouseout="out('-5025359896728506958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -   * 任务完成                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -   */                                                                                                             </span>
<span class="-4459433206105700619" onmouseenter="enter('-4459433206105700619');" onmouseout="out('-4459433206105700619');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -  public static final int COMPLETE = 5;                                                                           </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -  /**                                                                                                             </span>
<span class="7866565969200819017" onmouseenter="enter('7866565969200819017');" onmouseout="out('7866565969200819017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -   * 下载中                                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -   */                                                                                                             </span>
<span class="-4113841519595777363" onmouseenter="enter('-4113841519595777363');" onmouseout="out('-4113841519595777363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -  public static final int RUNNING = 6;                                                                            </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -  /**                                                                                                             </span>
<span class="-4583384747655535323" onmouseenter="enter('-4583384747655535323');" onmouseout="out('-4583384747655535323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -   * 恢复下载                                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -   */                                                                                                             </span>
<span class="6596687279686396548" onmouseenter="enter('6596687279686396548');" onmouseout="out('6596687279686396548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -  public static final int RESUME = 7;                                                                             </span>
<span class="8416775543270687698" onmouseenter="enter('8416775543270687698');" onmouseout="out('8416775543270687698');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +public class DownloadSchedulers implements ISchedulers&lt;DownloadTask&gt; {                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +                                                                                                                  </span>
<span class="8858404648145832108" onmouseenter="enter('8858404648145832108');" onmouseout="out('8858404648145832108');" style="">  75    private static final String TAG = &quot;DownloadSchedulers&quot;;                                                         </span>
<span class="4753550627703968447" onmouseenter="enter('4753550627703968447');" onmouseout="out('4753550627703968447');" style="">  76    private static final Object LOCK = new Object();                                                                </span>



<span class="8632277551934513770" onmouseenter="enter('8632277551934513770');" onmouseout="out('8632277551934513770');" style="">  77    private static volatile DownloadSchedulers INSTANCE = null;                                                     </span>
<span  style="">  78                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  79    /**                                                                                                             </span>
<span class="-3227747780449322969" onmouseenter="enter('-3227747780449322969');" onmouseout="out('-3227747780449322969');" style="">  80     * 下载器任务监听                                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  81     */                                                                                                             </span>
<span class="8456381727773251435" onmouseenter="enter('8456381727773251435');" onmouseout="out('8456381727773251435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -  Map&lt;String, OnSchedulerListener&gt; mSchedulerListeners = new ConcurrentHashMap&lt;&gt;();                               </span>
<span class="-8842931816589902990" onmouseenter="enter('-8842931816589902990');" onmouseout="out('-8842931816589902990');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -  DownloadManager mManager = DownloadManager.getInstance();                                                       </span>

<span class="8598976265326351040" onmouseenter="enter('8598976265326351040');" onmouseout="out('8598976265326351040');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -  ITaskQueue mQueue;                                                                                              </span>
<span class="-3925422581406470796" onmouseenter="enter('-3925422581406470796');" onmouseout="out('-3925422581406470796');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +  private Map&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; mSchedulerListeners =                             </span>
<span class="7545653642443207171" onmouseenter="enter('7545653642443207171');" onmouseout="out('7545653642443207171');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +      new ConcurrentHashMap&lt;&gt;();                                                                                  </span>
<span class="-1055071256125403720" onmouseenter="enter('-1055071256125403720');" onmouseout="out('-1055071256125403720');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +  private DownloadTaskQueue mQueue;                                                                               </span>
<span  style="">  88                                                                                                                    </span>
<span class="-4615998420186637334" onmouseenter="enter('-4615998420186637334');" onmouseout="out('-4615998420186637334');" style="">  89    private DownloadSchedulers() {                                                                                  </span>
<span class="-2136875981592484278" onmouseenter="enter('-2136875981592484278');" onmouseout="out('-2136875981592484278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -    mQueue = mManager.getTaskQueue();                                                                             </span>
<span class="4181603964882924928" onmouseenter="enter('4181603964882924928');" onmouseout="out('4181603964882924928');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +    mQueue = DownloadTaskQueue.getInstance();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92    }                                                                                                               </span>
<span  style="">  93                                                                                                                    </span>
<span class="-519894234808704272" onmouseenter="enter('-519894234808704272');" onmouseout="out('-519894234808704272');" style="">  94    public static DownloadSchedulers getInstance() {                                                                </span>
<span class="-8097436755426287019" onmouseenter="enter('-8097436755426287019');" onmouseout="out('-8097436755426287019');" style="">  95      if (INSTANCE == null) {                                                                                       </span>
<span class="-889825015365812481" onmouseenter="enter('-889825015365812481');" onmouseout="out('-889825015365812481');" style="">  96        synchronized (LOCK) {                                                                                       </span>
<span class="-477661885051927020" onmouseenter="enter('-477661885051927020');" onmouseout="out('-477661885051927020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -        //INSTANCE = new DownloadSchedulers(queue);                                                               </span>
<span class="-4113076547335811880" onmouseenter="enter('-4113076547335811880');" onmouseout="out('-4113076547335811880');" style="">  98          INSTANCE = new DownloadSchedulers();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100      }                                                                                                             </span>
<span class="-2388388574337551660" onmouseenter="enter('-2388388574337551660');" onmouseout="out('-2388388574337551660');" style=""> 101      return INSTANCE;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102    }                                                                                                               </span>
<span  style=""> 103                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -  @Override                                                                                                       </span>
<span class="1472957630765294322" onmouseenter="enter('1472957630765294322');" onmouseout="out('1472957630765294322');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -  public void addSchedulerListener(String targetName, OnSchedulerListener schedulerListener) {                    </span>
<span class="-7687922112020440468" onmouseenter="enter('-7687922112020440468');" onmouseout="out('-7687922112020440468');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -    mSchedulerListeners.put(targetName, schedulerListener);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -  }                                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -  @Override                                                                                                       </span>
<span class="-3983392630216527778" onmouseenter="enter('-3983392630216527778');" onmouseout="out('-3983392630216527778');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -  public void removeSchedulerListener(String targetName, OnSchedulerListener schedulerListener) {                 </span>
<span class="6836852313823545406" onmouseenter="enter('6836852313823545406');" onmouseout="out('6836852313823545406');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -    //OnSchedulerListener listener = mSchedulerListeners.get(target.getClass().getName());                        </span>
<span class="-4758361548811584798" onmouseenter="enter('-4758361548811584798');" onmouseout="out('-4758361548811584798');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -    //mSchedulerListeners.remove(listener);                                                                       </span>
<span class="-8403899556941196401" onmouseenter="enter('-8403899556941196401');" onmouseout="out('-8403899556941196401');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +  @Override public void addSchedulerListener(String targetName,                                                   </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +      ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                                       </span>
<span class="2225147130150881467" onmouseenter="enter('2225147130150881467');" onmouseout="out('2225147130150881467');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +    mSchedulerListeners.put(targetName,                                                                           </span>
<span class="8951749162305430893" onmouseenter="enter('8951749162305430893');" onmouseout="out('8951749162305430893');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +        (IDownloadSchedulerListener&lt;DownloadTask&gt;) schedulerListener);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +  }                                                                                                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                                                                                                                  </span>
<span class="6065443109591267703" onmouseenter="enter('6065443109591267703');" onmouseout="out('6065443109591267703');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +  @Override public void removeSchedulerListener(String targetName,                                                </span>
<span class="4924620118357501313" onmouseenter="enter('4924620118357501313');" onmouseout="out('4924620118357501313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +      ISchedulerListener&lt;DownloadTask&gt; schedulerListener) {                                                       </span>
<span class="8934732759407393738" onmouseenter="enter('8934732759407393738');" onmouseout="out('8934732759407393738');" style=""><abbr title=" 121      //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashmap-element"> 121      //该内存溢出解决方案：http://stackoverflow.com/questions/14585829/how-safe-is-to-delete-already-removed-concurrenthashma🔵</abbr></span>
<span class="743911132097881635" onmouseenter="enter('743911132097881635');" onmouseout="out('743911132097881635');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -    for (Iterator&lt;Map.Entry&lt;String, OnSchedulerListener&gt;&gt; iter =                                                  </span>
<span class="3572873968857737976" onmouseenter="enter('3572873968857737976');" onmouseout="out('3572873968857737976');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +    for (Iterator&lt;Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt;&gt; iter =                             </span>
<span class="-8199036773943606321" onmouseenter="enter('-8199036773943606321');" onmouseout="out('-8199036773943606321');" style=""> 124          mSchedulerListeners.entrySet().iterator(); iter.hasNext(); ) {                                            </span>
<span class="-7435768381575910650" onmouseenter="enter('-7435768381575910650');" onmouseout="out('-7435768381575910650');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -      Map.Entry&lt;String, OnSchedulerListener&gt; entry = iter.next();                                                 </span>
<span class="-3105102033904377070" onmouseenter="enter('-3105102033904377070');" onmouseout="out('-3105102033904377070');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +      Map.Entry&lt;String, IDownloadSchedulerListener&lt;DownloadTask&gt;&gt; entry = iter.next();                            </span>
<span class="-1599663307714431138" onmouseenter="enter('-1599663307714431138');" onmouseout="out('-1599663307714431138');" style=""> 127        if (entry.getKey().equals(targetName)) iter.remove();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129    }                                                                                                               </span>
<span  style=""> 130                                                                                                                    </span>
<span class="-5093355790655318910" onmouseenter="enter('-5093355790655318910');" onmouseout="out('-5093355790655318910');" style=""> 131    @Override public boolean handleMessage(Message msg) {                                                           </span>
<span class="-6718823554380121078" onmouseenter="enter('-6718823554380121078');" onmouseout="out('-6718823554380121078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -    Task task = (Task) msg.obj;                                                                                   </span>
<span class="-8251277725976015781" onmouseenter="enter('-8251277725976015781');" onmouseout="out('-8251277725976015781');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +    DownloadTask task = (DownloadTask) msg.obj;                                                                   </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 134      if (task == null) {                                                                                           </span>
<span class="1337244836570146892" onmouseenter="enter('1337244836570146892');" onmouseout="out('1337244836570146892');" style=""> 135        Log.e(TAG, &quot;请传入下载任务&quot;);                                                                                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 136        return true;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137      }                                                                                                             </span>
<span class="-2674937623106813475" onmouseenter="enter('-2674937623106813475');" onmouseout="out('-2674937623106813475');" style=""> 138      callback(msg.what, task);                                                                                     </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style=""> 139      DownloadEntity entity = task.getDownloadEntity();                                                             </span>
<span class="-3954437576728056065" onmouseenter="enter('-3954437576728056065');" onmouseout="out('-3954437576728056065');" style=""> 140      switch (msg.what) {                                                                                           </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 141        case STOP:                                                                                                  </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 142        case CANCEL:                                                                                                </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 143          mQueue.removeTask(entity);                                                                                </span>
<span class="389965472298844820" onmouseenter="enter('389965472298844820');" onmouseout="out('389965472298844820');" style=""> 144          if (mQueue.size() &lt; Configuration.getInstance().getDownloadNum()) {                                       </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -          startNextTask(entity);                                                                                  </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +          startNextTask();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147          }                                                                                                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 148          break;                                                                                                    </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 149        case COMPLETE:                                                                                              </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style=""> 150          mQueue.removeTask(entity);                                                                                </span>
<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -        startNextTask(entity);                                                                                    </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +        startNextTask();                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 153          break;                                                                                                    </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 154        case FAIL:                                                                                                  </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -        mQueue.removeTask(entity);                                                                                </span>
<span class="-2551087727399721242" onmouseenter="enter('-2551087727399721242');" onmouseout="out('-2551087727399721242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -        handleFailTask(entity);                                                                                   </span>
<span class="6557620446996273889" onmouseenter="enter('6557620446996273889');" onmouseout="out('6557620446996273889');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +        //mQueue.removeTask(entity);                                                                              </span>
<span class="2925124162455559864" onmouseenter="enter('2925124162455559864');" onmouseout="out('2925124162455559864');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +        handleFailTask(task);                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 159          break;                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160      }                                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 161      return true;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162    }                                                                                                               </span>
<span  style=""> 163                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 164    /**                                                                                                             </span>
<span class="5701145962088405995" onmouseenter="enter('5701145962088405995');" onmouseout="out('5701145962088405995');" style=""> 165     * 回调                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 166     *                                                                                                              </span>
<span class="6794715047748436388" onmouseenter="enter('6794715047748436388');" onmouseout="out('6794715047748436388');" style=""> 167     * @param state 状态                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 168     */                                                                                                             </span>
<span class="8526566288242532728" onmouseenter="enter('8526566288242532728');" onmouseout="out('8526566288242532728');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -  private void callback(int state, Task task) {                                                                   </span>
<span class="-6525939261817098917" onmouseenter="enter('-6525939261817098917');" onmouseout="out('-6525939261817098917');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +  private void callback(int state, DownloadTask task) {                                                           </span>
<span class="6264342014304299429" onmouseenter="enter('6264342014304299429');" onmouseout="out('6264342014304299429');" style=""> 171      if (mSchedulerListeners.size() &gt; 0) {                                                                         </span>
<span class="-8197804712143627403" onmouseenter="enter('-8197804712143627403');" onmouseout="out('-8197804712143627403');" style=""> 172        //if (!TextUtils.isEmpty(task.getTargetName())) {                                                           </span>
<span class="7236226619005487457" onmouseenter="enter('7236226619005487457');" onmouseout="out('7236226619005487457');" style=""> 173        //  callback(state, task, mSchedulerListeners.get(task.getTargetName()));                                   </span>
<span class="-4740675746293055676" onmouseenter="enter('-4740675746293055676');" onmouseout="out('-4740675746293055676');" style=""> 174        //}                                                                                                         </span>
<span class="-5867093652927473424" onmouseenter="enter('-5867093652927473424');" onmouseout="out('-5867093652927473424');" style=""> 175        Set&lt;String&gt; keys = mSchedulerListeners.keySet();                                                            </span>
<span class="-5841525186174834007" onmouseenter="enter('-5841525186174834007');" onmouseout="out('-5841525186174834007');" style=""> 176        for (String key : keys) {                                                                                   </span>
<span class="7522587192355288650" onmouseenter="enter('7522587192355288650');" onmouseout="out('7522587192355288650');" style=""> 177          callback(state, task, mSchedulerListeners.get(key));                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180    }                                                                                                               </span>
<span  style=""> 181                                                                                                                    </span>
<span class="-2575591080159390515" onmouseenter="enter('-2575591080159390515');" onmouseout="out('-2575591080159390515');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -  private void callback(int state, Task task, OnSchedulerListener listener) {                                     </span>
<span class="2906960517244803696" onmouseenter="enter('2906960517244803696');" onmouseout="out('2906960517244803696');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +  private void callback(int state, DownloadTask task,                                                             </span>
<span class="254905766686400838" onmouseenter="enter('254905766686400838');" onmouseout="out('254905766686400838');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +      IDownloadSchedulerListener&lt;DownloadTask&gt; listener) {                                                        </span>
<span class="-3279858558674677278" onmouseenter="enter('-3279858558674677278');" onmouseout="out('-3279858558674677278');" style=""> 185      if (listener != null) {                                                                                       </span>
<span class="8675873169750913162" onmouseenter="enter('8675873169750913162');" onmouseout="out('8675873169750913162');" style=""> 186        if (task == null) {                                                                                         </span>
<span class="-558067560321655497" onmouseenter="enter('-558067560321655497');" onmouseout="out('-558067560321655497');" style=""> 187          Log.e(TAG, &quot;TASK 为null，回调失败&quot;);                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 188          return;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189        }                                                                                                           </span>
<span class="-7165330810205169714" onmouseenter="enter('-7165330810205169714');" onmouseout="out('-7165330810205169714');" style=""> 190        switch (state) {                                                                                            </span>
<span class="3901942634001995069" onmouseenter="enter('3901942634001995069');" onmouseout="out('3901942634001995069');" style=""> 191          case RUNNING:                                                                                             </span>
<span class="8481034844882813554" onmouseenter="enter('8481034844882813554');" onmouseout="out('8481034844882813554');" style=""> 192            listener.onTaskRunning(task);                                                                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 193            break;                                                                                                  </span>
<span class="-2079449841199557933" onmouseenter="enter('-2079449841199557933');" onmouseout="out('-2079449841199557933');" style=""> 194          case START:                                                                                               </span>
<span class="2270932307575363839" onmouseenter="enter('2270932307575363839');" onmouseout="out('2270932307575363839');" style=""> 195            listener.onTaskStart(task);                                                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 196            break;                                                                                                  </span>
<span class="1250822125610289782" onmouseenter="enter('1250822125610289782');" onmouseout="out('1250822125610289782');" style=""> 197          case STOP:                                                                                                </span>
<span class="-7675119586605710841" onmouseenter="enter('-7675119586605710841');" onmouseout="out('-7675119586605710841');" style=""> 198            listener.onTaskStop(task);                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 199            break;                                                                                                  </span>
<span class="-109811889113334874" onmouseenter="enter('-109811889113334874');" onmouseout="out('-109811889113334874');" style=""> 200          case RESUME:                                                                                              </span>
<span class="3404083999393213554" onmouseenter="enter('3404083999393213554');" onmouseout="out('3404083999393213554');" style=""> 201            listener.onTaskResume(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 202            break;                                                                                                  </span>
<span class="888658837532984245" onmouseenter="enter('888658837532984245');" onmouseout="out('888658837532984245');" style=""> 203          case PRE:                                                                                                 </span>
<span class="2874058916746411581" onmouseenter="enter('2874058916746411581');" onmouseout="out('2874058916746411581');" style=""> 204            listener.onTaskPre(task);                                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 205            break;                                                                                                  </span>
<span class="2194916571338084494" onmouseenter="enter('2194916571338084494');" onmouseout="out('2194916571338084494');" style=""> 206          case CANCEL:                                                                                              </span>
<span class="-5477876021425860242" onmouseenter="enter('-5477876021425860242');" onmouseout="out('-5477876021425860242');" style=""> 207            listener.onTaskCancel(task);                                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 208            break;                                                                                                  </span>
<span class="-4977730218558906777" onmouseenter="enter('-4977730218558906777');" onmouseout="out('-4977730218558906777');" style=""> 209          case COMPLETE:                                                                                            </span>
<span class="-3643036732845291310" onmouseenter="enter('-3643036732845291310');" onmouseout="out('-3643036732845291310');" style=""> 210            listener.onTaskComplete(task);                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 211            break;                                                                                                  </span>
<span class="-2341093392251195793" onmouseenter="enter('-2341093392251195793');" onmouseout="out('-2341093392251195793');" style=""> 212          case FAIL:                                                                                                </span>
<span class="3354150519554067008" onmouseenter="enter('3354150519554067008');" onmouseout="out('3354150519554067008');" style=""> 213            listener.onTaskFail(task);                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 214            break;                                                                                                  </span>
<span class="-302375476510561723" onmouseenter="enter('-302375476510561723');" onmouseout="out('-302375476510561723');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +        case SUPPORT_BREAK_POINT:                                                                                 </span>
<span class="-4028020960632858822" onmouseenter="enter('-4028020960632858822');" onmouseout="out('-4028020960632858822');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +          listener.onNoSupportBreakPoint(task);                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +          break;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218        }                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220    }                                                                                                               </span>
<span  style=""> 221                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 222    /**                                                                                                             </span>
<span class="-7265321231120655573" onmouseenter="enter('-7265321231120655573');" onmouseout="out('-7265321231120655573');" style=""> 223     * 处理下载任务下载失败的情形                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 224     *                                                                                                              </span>
<span class="-5930662257353662785" onmouseenter="enter('-5930662257353662785');" onmouseout="out('-5930662257353662785');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -   * @param entity 失败实体                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -   */                                                                                                             </span>
<span class="-1695955174776440054" onmouseenter="enter('-1695955174776440054');" onmouseout="out('-1695955174776440054');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -  @Override public void handleFailTask(final DownloadEntity entity) {                                             </span>
<span class="2776247698490779697" onmouseenter="enter('2776247698490779697');" onmouseout="out('2776247698490779697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +   * @param task 下载任务                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +   */                                                                                                             </span>
<span class="-2725380241269917146" onmouseenter="enter('-2725380241269917146');" onmouseout="out('-2725380241269917146');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 230 +  private void handleFailTask(final DownloadTask task) {                                                          </span>
<span class="-8914656350463178114" onmouseenter="enter('-8914656350463178114');" onmouseout="out('-8914656350463178114');" style=""> 231      final Configuration config = Configuration.getInstance();                                                     </span>
<span class="4424202659407138583" onmouseenter="enter('4424202659407138583');" onmouseout="out('4424202659407138583');" style=""> 232      CountDownTimer timer = new CountDownTimer(config.getReTryInterval(), 1000) {                                  </span>
<span class="4899272397539330933" onmouseenter="enter('4899272397539330933');" onmouseout="out('4899272397539330933');" style=""> 233        @Override public void onTick(long millisUntilFinished) {                                                    </span>
<span  style=""> 234                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235        }                                                                                                           </span>
<span  style=""> 236                                                                                                                    </span>
<span class="-6610255125188469559" onmouseenter="enter('-6610255125188469559');" onmouseout="out('-6610255125188469559');" style=""> 237        @Override public void onFinish() {                                                                          </span>

<span class="3721858042134865926" onmouseenter="enter('3721858042134865926');" onmouseout="out('3721858042134865926');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -        if (entity.getFailNum() &lt;= config.getReTryNum()) {                                                        </span>
<span class="-5407270705746543970" onmouseenter="enter('-5407270705746543970');" onmouseout="out('-5407270705746543970');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -          Task task = mQueue.getTask(entity);                                                                     </span>
<span class="-3637491494780370658" onmouseenter="enter('-3637491494780370658');" onmouseout="out('-3637491494780370658');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 240 +        DownloadEntity entity = task.getDownloadEntity();                                                         </span>
<span class="1857717324066272338" onmouseenter="enter('1857717324066272338');" onmouseout="out('1857717324066272338');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 241 +        if (entity.getFailNum() &lt; config.getReTryNum()) {                                                         </span>
<span class="2015918851482799865" onmouseenter="enter('2015918851482799865');" onmouseout="out('2015918851482799865');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 242 +          DownloadTask task = mQueue.getTask(entity);                                                             </span>
<span class="-3278223808053826929" onmouseenter="enter('-3278223808053826929');" onmouseout="out('-3278223808053826929');" style=""> 243            mQueue.reTryStart(task);                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 244            try {                                                                                                   </span>
<span class="-383299689214601919" onmouseenter="enter('-383299689214601919');" onmouseout="out('-383299689214601919');" style=""> 245              Thread.sleep(config.getReTryInterval());                                                              </span>
<span class="-7528533024404460182" onmouseenter="enter('-7528533024404460182');" onmouseout="out('-7528533024404460182');" style=""> 246            } catch (InterruptedException e) {                                                                      </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 247              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248            }                                                                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 249          } else {                                                                                                  </span>

<span class="3387794157521498707" onmouseenter="enter('3387794157521498707');" onmouseout="out('3387794157521498707');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -          startNextTask(entity);                                                                                  </span>
<span class="-1860418784393927789" onmouseenter="enter('-1860418784393927789');" onmouseout="out('-1860418784393927789');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 251 +          mQueue.removeTask(entity);                                                                              </span>
<span class="254089924056702434" onmouseenter="enter('254089924056702434');" onmouseout="out('254089924056702434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +          startNextTask();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254        }                                                                                                           </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 255      };                                                                                                            </span>
<span class="-5778805378540939726" onmouseenter="enter('-5778805378540939726');" onmouseout="out('-5778805378540939726');" style=""> 256      timer.start();                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257    }                                                                                                               </span>
<span  style=""> 258                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 259    /**                                                                                                             </span>
<span class="1254639702238739792" onmouseenter="enter('1254639702238739792');" onmouseout="out('1254639702238739792');" style=""> 260     * 启动下一个任务，条件：任务停止，取消下载，任务完成                                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -   *                                                                                                              </span>
<span class="-705409987305539511" onmouseenter="enter('-705409987305539511');" onmouseout="out('-705409987305539511');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -   * @param entity 通过Handler传递的下载实体                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -   */                                                                                                             </span>
<span class="-8853169797109920301" onmouseenter="enter('-8853169797109920301');" onmouseout="out('-8853169797109920301');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -  @Override public void startNextTask(DownloadEntity entity) {                                                    </span>
<span class="3370827879289135868" onmouseenter="enter('3370827879289135868');" onmouseout="out('3370827879289135868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -    Task newTask = mQueue.getNextTask();                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +   */                                                                                                             </span>
<span class="-669202063827981309" onmouseenter="enter('-669202063827981309');" onmouseout="out('-669202063827981309');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 267 +  private void startNextTask() {                                                                                  </span>
<span class="-1613093400901244409" onmouseenter="enter('-1613093400901244409');" onmouseout="out('-1613093400901244409');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 268 +    DownloadTask newTask = mQueue.getNextTask();                                                                  </span>
<span class="7215532936246787403" onmouseenter="enter('7215532936246787403');" onmouseout="out('7215532936246787403');" style=""> 269      if (newTask == null) {                                                                                        </span>
<span class="-4835257036825404123" onmouseenter="enter('-4835257036825404123');" onmouseout="out('-4835257036825404123');" style=""> 270        Log.w(TAG, &quot;没有下一任务&quot;);                                                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 271        return;                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span class="2202099522712246363" onmouseenter="enter('2202099522712246363');" onmouseout="out('2202099522712246363');" style=""> 273      if (newTask.getDownloadEntity().getState() == DownloadEntity.STATE_WAIT) {                                    </span>
<span class="6679029410179135267" onmouseenter="enter('6679029410179135267');" onmouseout="out('6679029410179135267');" style=""> 274        mQueue.startTask(newTask);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276    }                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            