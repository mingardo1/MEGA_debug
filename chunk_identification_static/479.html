<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>479</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    479
                    <a href="478.html">prev</a>
                    <a href="480.html">next</a>
                    <a href="479_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b33108525150e417d003328be87242cc626fe203_kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/AbstractKafkaProducerFactory.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b33108525150e417d003328be87242cc626fe203:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/AbstractKafkaProducerFactory.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b33108525150e417d003328be87242cc626fe203^1:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/AbstractKafkaProducerFactory.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b33108525150e417d003328be87242cc626fe203^2:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/AbstractKafkaProducerFactory.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b59ef71c4aa3401fd523d61328334a6bac817e1c:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/AbstractKafkaProducerFactory.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [bj], [bj], [s]], subset: [[b], [bsj], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-622542009573380574" onmouseenter="enter('-622542009573380574');" onmouseout="out('-622542009573380574');" style="">  18 package com.dtstack.flink.sql.sink.kafka;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="8146569798737420437" onmouseenter="enter('8146569798737420437');" onmouseout="out('8146569798737420437');" style="">  21 import com.dtstack.flink.sql.format.SerializationMetricWrapper;                                          </span>
<span class="5593244862353374468" onmouseenter="enter('5593244862353374468');" onmouseout="out('5593244862353374468');" style="">  22 import com.dtstack.flink.sql.sink.kafka.serialization.AvroCRowSerializationSchema;                       </span>
<span class="2914559868996856560" onmouseenter="enter('2914559868996856560');" onmouseout="out('2914559868996856560');" style="">  23 import com.dtstack.flink.sql.sink.kafka.serialization.CsvCRowSerializationSchema;                        </span>
<span class="3974848073621898985" onmouseenter="enter('3974848073621898985');" onmouseout="out('3974848073621898985');" style="">  24 import com.dtstack.flink.sql.sink.kafka.serialization.JsonCRowSerializationSchema;                       </span>
<span class="-725474603042399732" onmouseenter="enter('-725474603042399732');" onmouseout="out('-725474603042399732');" style="">  25 import com.dtstack.flink.sql.sink.kafka.table.KafkaSinkTableInfo;                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  27 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  28 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  29 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  30 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-752754047719068206" onmouseenter="enter('-752754047719068206');" onmouseout="out('-752754047719068206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.apache.flink.formats.avro.AvroRowSerializationSchema;                                         </span>
<span class="-9035464761660049480" onmouseenter="enter('-9035464761660049480');" onmouseout="out('-9035464761660049480');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.apache.flink.formats.csv.CsvRowSerializationSchema;                                           </span>
<span class="-6185608683170964700" onmouseenter="enter('-6185608683170964700');" onmouseout="out('-6185608683170964700');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import org.apache.flink.formats.json.JsonRowSerializationSchema;                                         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  34 =======                                                                                                  </span>
<span class="-752754047719068206" onmouseenter="enter('-752754047719068206');" onmouseout="out('-752754047719068206');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import org.apache.flink.formats.avro.AvroRowSerializationSchema;                                         </span>
<span class="-9035464761660049480" onmouseenter="enter('-9035464761660049480');" onmouseout="out('-9035464761660049480');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36 import org.apache.flink.formats.csv.CsvRowSerializationSchema;                                           </span>
<span class="-3705670459604611692" onmouseenter="enter('-3705670459604611692');" onmouseout="out('-3705670459604611692');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import org.apache.flink.formats.json.DTJsonRowSerializationSchema;                                       </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  38 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="6003661863865659743" onmouseenter="enter('6003661863865659743');" onmouseout="out('6003661863865659743');" style="">  39 import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;                                   </span>
<span class="4427972705296160450" onmouseenter="enter('4427972705296160450');" onmouseout="out('4427972705296160450');" style="">  40 import org.apache.flink.streaming.connectors.kafka.partitioner.FlinkKafkaPartitioner;                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  41 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span  style="">  42                                                                                                          </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="">  43 import java.util.Optional;                                                                               </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  44 import java.util.Properties;                                                                             </span>
<span  style="">  45                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46 /**                                                                                                      </span>
<span class="-6980196326705088706" onmouseenter="enter('-6980196326705088706');" onmouseout="out('-6980196326705088706');" style="">  47  * 抽象的kafka producer 的工厂类                                                                                </span>
<span class="6881855006388508945" onmouseenter="enter('6881855006388508945');" onmouseout="out('6881855006388508945');" style="">  48  * 包括序统一的序列化工具的构造                                                                                        </span>
<span class="-8729821338350872800" onmouseenter="enter('-8729821338350872800');" onmouseout="out('-8729821338350872800');" style="">  49  * company: www.dtstack.com                                                                              </span>
<span class="855988645286188992" onmouseenter="enter('855988645286188992');" onmouseout="out('855988645286188992');" style="">  50  * @author: toutian                                                                                      </span>
<span class="1456019527766592923" onmouseenter="enter('1456019527766592923');" onmouseout="out('1456019527766592923');" style="">  51  * create: 2019/12/26                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  52  */                                                                                                      </span>
<span class="-162974631075819799" onmouseenter="enter('-162974631075819799');" onmouseout="out('-162974631075819799');" style="">  53 public abstract class AbstractKafkaProducerFactory {                                                     </span>
<span  style="">  54                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55     /**                                                                                                  </span>
<span class="2345236795123227489" onmouseenter="enter('2345236795123227489');" onmouseout="out('2345236795123227489');" style="">  56      *  获取具体的KafkaProducer                                                                               </span>
<span class="-6126255428228135083" onmouseenter="enter('-6126255428228135083');" onmouseout="out('-6126255428228135083');" style="">  57      * eg create KafkaProducer010                                                                        </span>
<span class="-3257897229150079368" onmouseenter="enter('-3257897229150079368');" onmouseout="out('-3257897229150079368');" style="">  58      * @param kafkaSinkTableInfo                                                                         </span>
<span class="876169318065797844" onmouseenter="enter('876169318065797844');" onmouseout="out('876169318065797844');" style="">  59      * @param typeInformation                                                                            </span>
<span class="-1925050675286197216" onmouseenter="enter('-1925050675286197216');" onmouseout="out('-1925050675286197216');" style="">  60      * @param properties                                                                                 </span>
<span class="876584971693255658" onmouseenter="enter('876584971693255658');" onmouseout="out('876584971693255658');" style="">  61      * @param partitioner                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  62      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63      */                                                                                                  </span>
<span class="807869621589388322" onmouseenter="enter('807869621589388322');" onmouseout="out('807869621589388322');" style=""><abbr title="  64     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;CRow&gt;&gt; partitioner, String[] partitionKeys);">  64     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, Typ🔵</abbr></span>
<span  style="">  65                                                                                                          </span>
<span class="-1953337309800932884" onmouseenter="enter('-1953337309800932884');" onmouseout="out('-1953337309800932884');" style=""><abbr title="  66     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  66     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTab🔵</abbr></span>
<span class="1201523324391776151" onmouseenter="enter('1201523324391776151');" onmouseout="out('1201523324391776151');" style=""><abbr title="  67         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typeInformation);">  67         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typ🔵</abbr></span>
<span class="1843141058381695988" onmouseenter="enter('1843141058381695988');" onmouseout="out('1843141058381695988');" style="">  68         return new SerializationMetricWrapper(serializationSchema);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69     }                                                                                                    </span>
<span  style="">  70                                                                                                          </span>
<span class="6128510894007066537" onmouseenter="enter('6128510894007066537');" onmouseout="out('6128510894007066537');" style=""><abbr title="  71     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  71     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, Ty🔵</abbr></span>
<span class="4284248082131020395" onmouseenter="enter('4284248082131020395');" onmouseout="out('4284248082131020395');" style="">  72         SerializationSchema&lt;CRow&gt; serializationSchema = null;                                            </span>
<span class="8854632501833264179" onmouseenter="enter('8854632501833264179');" onmouseout="out('8854632501833264179');" style="">  73         if (FormatType.JSON.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {             </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="">  74             if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  75 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3690051723102913615" onmouseenter="enter('3690051723102913615');" onmouseout="out('3690051723102913615');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  76                 serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());">  76                 serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(🔵</abbr></span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  77 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-4496042135541537579" onmouseenter="enter('-4496042135541537579');" onmouseout="out('-4496042135541537579');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  78                 serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());">  78                 serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString()🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  79 =======                                                                                                  </span>
<span class="8122118826301879856" onmouseenter="enter('8122118826301879856');" onmouseout="out('8122118826301879856');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  80                 serializationSchema = new DTJsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());">  80                 serializationSchema = new DTJsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString🔵</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  81 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-3326181373266435486" onmouseenter="enter('-3326181373266435486');" onmouseout="out('-3326181373266435486');" style="">  82             } else if (typeInformation != null &amp;&amp; typeInformation.getArity() != 0) {                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  83 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="9110015556450762269" onmouseenter="enter('9110015556450762269');" onmouseout="out('9110015556450762269');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  84                 serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo.getUpdateMode());">  84                 serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo🔵</abbr></span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  85 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6239021955164631311" onmouseenter="enter('6239021955164631311');" onmouseout="out('6239021955164631311');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                 serializationSchema = new JsonRowSerializationSchema(typeInformation);                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  87 =======                                                                                                  </span>
<span class="-6992141123297405765" onmouseenter="enter('-6992141123297405765');" onmouseout="out('-6992141123297405765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88                 serializationSchema = new DTJsonRowSerializationSchema(typeInformation);                 </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  89 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90             } else {                                                                                     </span>
<span class="891778567235443456" onmouseenter="enter('891778567235443456');" onmouseout="out('891778567235443456');" style=""><abbr title="  91                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaString（JSON Schema）or TypeInformation&lt;Row&gt;&quot;);">  91                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92             }                                                                                            </span>
<span class="6569416534162311937" onmouseenter="enter('6569416534162311937');" onmouseout="out('6569416534162311937');" style="">  93         } else if (FormatType.CSV.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {       </span>
<span class="8692204720536640412" onmouseenter="enter('8692204720536640412');" onmouseout="out('8692204720536640412');" style="">  94             if (StringUtils.isBlank(kafkaSinkTableInfo.getFieldDelimiter())) {                           </span>
<span class="-3865345020373799877" onmouseenter="enter('-3865345020373799877');" onmouseout="out('-3865345020373799877');" style=""><abbr title="  95                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelimiter&quot;);">  95                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set f🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96             }                                                                                            </span>
<span class="-5658277403926557174" onmouseenter="enter('-5658277403926557174');" onmouseout="out('-5658277403926557174');" style=""><abbr title="  97             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Builder(typeInformation);">  97             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Bu🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="">  98             serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]); </span>
<span class="2582891746897336117" onmouseenter="enter('2582891746897336117');" onmouseout="out('2582891746897336117');" style="">  99             serSchemaBuilder.setUpdateMode(kafkaSinkTableInfo.getUpdateMode());                          </span>
<span  style=""> 100                                                                                                          </span>
<span class="-4159422725498262321" onmouseenter="enter('-4159422725498262321');" onmouseout="out('-4159422725498262321');" style=""> 101             serializationSchema = serSchemaBuilder.build();                                              </span>
<span class="3491381513973426945" onmouseenter="enter('3491381513973426945');" onmouseout="out('3491381513973426945');" style=""> 102         } else if (FormatType.AVRO.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {      </span>
<span class="-3294523277528553946" onmouseenter="enter('-3294523277528553946');" onmouseout="out('-3294523277528553946');" style=""> 103             if (StringUtils.isBlank(kafkaSinkTableInfo.getSchemaString())) {                             </span>
<span class="-898673182966267500" onmouseenter="enter('-898673182966267500');" onmouseout="out('-898673182966267500');" style=""><abbr title=" 104                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaString&quot;);"> 104                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105             }                                                                                            </span>
<span class="-2917929829430641261" onmouseenter="enter('-2917929829430641261');" onmouseout="out('-2917929829430641261');" style=""><abbr title=" 106             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());"> 106             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), k🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107         }                                                                                                </span>
<span  style=""> 108                                                                                                          </span>
<span class="-3641104599870236883" onmouseenter="enter('-3641104599870236883');" onmouseout="out('-3641104599870236883');" style=""> 109         if (null == serializationSchema) {                                                               </span>
<span class="-7022743072536649035" onmouseenter="enter('-7022743072536649035');" onmouseout="out('-7022743072536649035');" style=""><abbr title=" 110             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType());"> 110             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType())🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111         }                                                                                                </span>
<span  style=""> 112                                                                                                          </span>
<span class="-6789472026410253826" onmouseenter="enter('-6789472026410253826');" onmouseout="out('-6789472026410253826');" style=""> 113         return serializationSchema;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114     }                                                                                                    </span>
<span  style=""> 115                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-622542009573380574" onmouseenter="enter('-622542009573380574');" onmouseout="out('-622542009573380574');" style="">  18 package com.dtstack.flink.sql.sink.kafka;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="8146569798737420437" onmouseenter="enter('8146569798737420437');" onmouseout="out('8146569798737420437');" style="">  21 import com.dtstack.flink.sql.format.SerializationMetricWrapper;                                          </span>
<span class="5593244862353374468" onmouseenter="enter('5593244862353374468');" onmouseout="out('5593244862353374468');" style="">  22 import com.dtstack.flink.sql.sink.kafka.serialization.AvroCRowSerializationSchema;                       </span>
<span class="2914559868996856560" onmouseenter="enter('2914559868996856560');" onmouseout="out('2914559868996856560');" style="">  23 import com.dtstack.flink.sql.sink.kafka.serialization.CsvCRowSerializationSchema;                        </span>
<span class="3974848073621898985" onmouseenter="enter('3974848073621898985');" onmouseout="out('3974848073621898985');" style="">  24 import com.dtstack.flink.sql.sink.kafka.serialization.JsonCRowSerializationSchema;                       </span>
<span class="-725474603042399732" onmouseenter="enter('-725474603042399732');" onmouseout="out('-725474603042399732');" style="">  25 import com.dtstack.flink.sql.sink.kafka.table.KafkaSinkTableInfo;                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  27 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  28 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="-3705670459604611692" onmouseenter="enter('-3705670459604611692');" onmouseout="out('-3705670459604611692');" style="">  29 import org.apache.flink.formats.json.DTJsonRowSerializationSchema;                                       </span>
<span class="6003661863865659743" onmouseenter="enter('6003661863865659743');" onmouseout="out('6003661863865659743');" style="">  30 import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;                                   </span>
<span class="4427972705296160450" onmouseenter="enter('4427972705296160450');" onmouseout="out('4427972705296160450');" style="">  31 import org.apache.flink.streaming.connectors.kafka.partitioner.FlinkKafkaPartitioner;                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  32 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span  style="">  33                                                                                                          </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="">  34 import java.util.Optional;                                                                               </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  35 import java.util.Properties;                                                                             </span>
<span  style="">  36                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  37 /**                                                                                                      </span>
<span class="-6980196326705088706" onmouseenter="enter('-6980196326705088706');" onmouseout="out('-6980196326705088706');" style="">  38  * 抽象的kafka producer 的工厂类                                                                                </span>
<span class="6881855006388508945" onmouseenter="enter('6881855006388508945');" onmouseout="out('6881855006388508945');" style="">  39  * 包括序统一的序列化工具的构造                                                                                        </span>
<span class="-8729821338350872800" onmouseenter="enter('-8729821338350872800');" onmouseout="out('-8729821338350872800');" style="">  40  * company: www.dtstack.com                                                                              </span>
<span class="855988645286188992" onmouseenter="enter('855988645286188992');" onmouseout="out('855988645286188992');" style="">  41  * @author: toutian                                                                                      </span>
<span class="1456019527766592923" onmouseenter="enter('1456019527766592923');" onmouseout="out('1456019527766592923');" style="">  42  * create: 2019/12/26                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43  */                                                                                                      </span>
<span class="-162974631075819799" onmouseenter="enter('-162974631075819799');" onmouseout="out('-162974631075819799');" style="">  44 public abstract class AbstractKafkaProducerFactory {                                                     </span>
<span  style="">  45                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46     /**                                                                                                  </span>
<span class="2345236795123227489" onmouseenter="enter('2345236795123227489');" onmouseout="out('2345236795123227489');" style="">  47      *  获取具体的KafkaProducer                                                                               </span>
<span class="-6126255428228135083" onmouseenter="enter('-6126255428228135083');" onmouseout="out('-6126255428228135083');" style="">  48      * eg create KafkaProducer010                                                                        </span>
<span class="-3257897229150079368" onmouseenter="enter('-3257897229150079368');" onmouseout="out('-3257897229150079368');" style="">  49      * @param kafkaSinkTableInfo                                                                         </span>
<span class="876169318065797844" onmouseenter="enter('876169318065797844');" onmouseout="out('876169318065797844');" style="">  50      * @param typeInformation                                                                            </span>
<span class="-1925050675286197216" onmouseenter="enter('-1925050675286197216');" onmouseout="out('-1925050675286197216');" style="">  51      * @param properties                                                                                 </span>
<span class="876584971693255658" onmouseenter="enter('876584971693255658');" onmouseout="out('876584971693255658');" style="">  52      * @param partitioner                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  53      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54      */                                                                                                  </span>
<span class="807869621589388322" onmouseenter="enter('807869621589388322');" onmouseout="out('807869621589388322');" style=""><abbr title="  55     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;CRow&gt;&gt; partitioner, String[] partitionKeys);">  55     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, Typ🔵</abbr></span>
<span  style="">  56                                                                                                          </span>
<span class="-1953337309800932884" onmouseenter="enter('-1953337309800932884');" onmouseout="out('-1953337309800932884');" style=""><abbr title="  57     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  57     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTab🔵</abbr></span>
<span class="1201523324391776151" onmouseenter="enter('1201523324391776151');" onmouseout="out('1201523324391776151');" style=""><abbr title="  58         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typeInformation);">  58         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typ🔵</abbr></span>
<span class="1843141058381695988" onmouseenter="enter('1843141058381695988');" onmouseout="out('1843141058381695988');" style="">  59         return new SerializationMetricWrapper(serializationSchema);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  60     }                                                                                                    </span>
<span  style="">  61                                                                                                          </span>
<span class="6128510894007066537" onmouseenter="enter('6128510894007066537');" onmouseout="out('6128510894007066537');" style=""><abbr title="  62     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  62     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, Ty🔵</abbr></span>
<span class="4284248082131020395" onmouseenter="enter('4284248082131020395');" onmouseout="out('4284248082131020395');" style="">  63         SerializationSchema&lt;CRow&gt; serializationSchema = null;                                            </span>
<span class="8854632501833264179" onmouseenter="enter('8854632501833264179');" onmouseout="out('8854632501833264179');" style="">  64         if (FormatType.JSON.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {             </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="">  65             if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  66 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="3690051723102913615" onmouseenter="enter('3690051723102913615');" onmouseout="out('3690051723102913615');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  67                 serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());">  67                 serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(🔵</abbr></span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  68 ||||||| BASE                                                                                             </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69             if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                          </span>
<span class="-4496042135541537579" onmouseenter="enter('-4496042135541537579');" onmouseout="out('-4496042135541537579');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  70                 serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());">  70                 serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString()🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  71 =======                                                                                                  </span>
<span class="8122118826301879856" onmouseenter="enter('8122118826301879856');" onmouseout="out('8122118826301879856');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  72                 serializationSchema = new DTJsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());">  72                 serializationSchema = new DTJsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString🔵</abbr></span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  73 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-3326181373266435486" onmouseenter="enter('-3326181373266435486');" onmouseout="out('-3326181373266435486');" style="">  74             } else if (typeInformation != null &amp;&amp; typeInformation.getArity() != 0) {                     </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  75 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="9110015556450762269" onmouseenter="enter('9110015556450762269');" onmouseout="out('9110015556450762269');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  76                 serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo.getUpdateMode());">  76                 serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo🔵</abbr></span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  77 ||||||| BASE                                                                                             </span>
<span class="-3326181373266435486" onmouseenter="enter('-3326181373266435486');" onmouseout="out('-3326181373266435486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78             } else if (typeInformation != null &amp;&amp; typeInformation.getArity() != 0) {                     </span>
<span class="6239021955164631311" onmouseenter="enter('6239021955164631311');" onmouseout="out('6239021955164631311');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                 serializationSchema = new JsonRowSerializationSchema(typeInformation);                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  80 =======                                                                                                  </span>
<span class="-6992141123297405765" onmouseenter="enter('-6992141123297405765');" onmouseout="out('-6992141123297405765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81                 serializationSchema = new DTJsonRowSerializationSchema(typeInformation);                 </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  82 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  83             } else {                                                                                     </span>
<span class="891778567235443456" onmouseenter="enter('891778567235443456');" onmouseout="out('891778567235443456');" style=""><abbr title="  84                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaString（JSON Schema）or TypeInformation&lt;Row&gt;&quot;);">  84                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85             }                                                                                            </span>
<span class="6569416534162311937" onmouseenter="enter('6569416534162311937');" onmouseout="out('6569416534162311937');" style="">  86         } else if (FormatType.CSV.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {       </span>
<span class="8692204720536640412" onmouseenter="enter('8692204720536640412');" onmouseout="out('8692204720536640412');" style="">  87             if (StringUtils.isBlank(kafkaSinkTableInfo.getFieldDelimiter())) {                           </span>
<span class="-3865345020373799877" onmouseenter="enter('-3865345020373799877');" onmouseout="out('-3865345020373799877');" style=""><abbr title="  88                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelimiter&quot;);">  88                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set f🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89             }                                                                                            </span>
<span class="-5658277403926557174" onmouseenter="enter('-5658277403926557174');" onmouseout="out('-5658277403926557174');" style=""><abbr title="  90             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Builder(typeInformation);">  90             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Bu🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="">  91             serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]); </span>
<span class="2582891746897336117" onmouseenter="enter('2582891746897336117');" onmouseout="out('2582891746897336117');" style="">  92             serSchemaBuilder.setUpdateMode(kafkaSinkTableInfo.getUpdateMode());                          </span>
<span  style="">  93                                                                                                          </span>
<span class="-4159422725498262321" onmouseenter="enter('-4159422725498262321');" onmouseout="out('-4159422725498262321');" style="">  94             serializationSchema = serSchemaBuilder.build();                                              </span>
<span class="3491381513973426945" onmouseenter="enter('3491381513973426945');" onmouseout="out('3491381513973426945');" style="">  95         } else if (FormatType.AVRO.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {      </span>
<span class="-3294523277528553946" onmouseenter="enter('-3294523277528553946');" onmouseout="out('-3294523277528553946');" style="">  96             if (StringUtils.isBlank(kafkaSinkTableInfo.getSchemaString())) {                             </span>
<span class="-898673182966267500" onmouseenter="enter('-898673182966267500');" onmouseout="out('-898673182966267500');" style=""><abbr title="  97                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaString&quot;);">  97                 throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98             }                                                                                            </span>
<span class="-2917929829430641261" onmouseenter="enter('-2917929829430641261');" onmouseout="out('-2917929829430641261');" style=""><abbr title="  99             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());">  99             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), k🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100         }                                                                                                </span>
<span  style=""> 101                                                                                                          </span>
<span class="-3641104599870236883" onmouseenter="enter('-3641104599870236883');" onmouseout="out('-3641104599870236883');" style=""> 102         if (null == serializationSchema) {                                                               </span>
<span class="-7022743072536649035" onmouseenter="enter('-7022743072536649035');" onmouseout="out('-7022743072536649035');" style=""><abbr title=" 103             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType());"> 103             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType())🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104         }                                                                                                </span>
<span  style=""> 105                                                                                                          </span>
<span class="-6789472026410253826" onmouseenter="enter('-6789472026410253826');" onmouseout="out('-6789472026410253826');" style=""> 106         return serializationSchema;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107     }                                                                                                    </span>
<span  style=""> 108                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109 }                                                                                                        </span>





</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-622542009573380574" onmouseenter="enter('-622542009573380574');" onmouseout="out('-622542009573380574');" style="">  18 package com.dtstack.flink.sql.sink.kafka;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20 import com.dtstack.flink.sql.format.FormatType;                                                          </span>
<span class="8146569798737420437" onmouseenter="enter('8146569798737420437');" onmouseout="out('8146569798737420437');" style="">  21 import com.dtstack.flink.sql.format.SerializationMetricWrapper;                                          </span>
<span class="5593244862353374468" onmouseenter="enter('5593244862353374468');" onmouseout="out('5593244862353374468');" style="">  22 import com.dtstack.flink.sql.sink.kafka.serialization.AvroCRowSerializationSchema;                       </span>
<span class="2914559868996856560" onmouseenter="enter('2914559868996856560');" onmouseout="out('2914559868996856560');" style="">  23 import com.dtstack.flink.sql.sink.kafka.serialization.CsvCRowSerializationSchema;                        </span>
<span class="3974848073621898985" onmouseenter="enter('3974848073621898985');" onmouseout="out('3974848073621898985');" style="">  24 import com.dtstack.flink.sql.sink.kafka.serialization.JsonCRowSerializationSchema;                       </span>
<span class="-725474603042399732" onmouseenter="enter('-725474603042399732');" onmouseout="out('-725474603042399732');" style="">  25 import com.dtstack.flink.sql.sink.kafka.table.KafkaSinkTableInfo;                                        </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="">  26 import java.util.Optional;                                                                               </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  27 import java.util.Properties;                                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  28 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  29 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  30 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="-3705670459604611692" onmouseenter="enter('-3705670459604611692');" onmouseout="out('-3705670459604611692');" style="">  31 import org.apache.flink.formats.json.DTJsonRowSerializationSchema;                                       </span>
<span class="6003661863865659743" onmouseenter="enter('6003661863865659743');" onmouseout="out('6003661863865659743');" style="">  32 import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;                                   </span>
<span class="4427972705296160450" onmouseenter="enter('4427972705296160450');" onmouseout="out('4427972705296160450');" style="">  33 import org.apache.flink.streaming.connectors.kafka.partitioner.FlinkKafkaPartitioner;                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  34 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span  style="">  35                                                                                                          </span>
<span  style="">  36                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  37 /**                                                                                                      </span>
<span class="-6980196326705088706" onmouseenter="enter('-6980196326705088706');" onmouseout="out('-6980196326705088706');" style="">  38  * 抽象的kafka producer 的工厂类                                                                                </span>
<span class="6881855006388508945" onmouseenter="enter('6881855006388508945');" onmouseout="out('6881855006388508945');" style="">  39  * 包括序统一的序列化工具的构造                                                                                        </span>
<span class="-8729821338350872800" onmouseenter="enter('-8729821338350872800');" onmouseout="out('-8729821338350872800');" style="">  40  * company: www.dtstack.com                                                                              </span>
<span class="855988645286188992" onmouseenter="enter('855988645286188992');" onmouseout="out('855988645286188992');" style="">  41  * @author: toutian                                                                                      </span>
<span class="1456019527766592923" onmouseenter="enter('1456019527766592923');" onmouseout="out('1456019527766592923');" style="">  42  * create: 2019/12/26                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43  */                                                                                                      </span>
<span class="-162974631075819799" onmouseenter="enter('-162974631075819799');" onmouseout="out('-162974631075819799');" style="">  44 public abstract class AbstractKafkaProducerFactory {                                                     </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45     /**                                                                                                  </span>
<span class="2345236795123227489" onmouseenter="enter('2345236795123227489');" onmouseout="out('2345236795123227489');" style="">  46      *  获取具体的KafkaProducer                                                                               </span>
<span class="-6126255428228135083" onmouseenter="enter('-6126255428228135083');" onmouseout="out('-6126255428228135083');" style="">  47      * eg create KafkaProducer010                                                                        </span>
<span class="-3257897229150079368" onmouseenter="enter('-3257897229150079368');" onmouseout="out('-3257897229150079368');" style="">  48      * @param kafkaSinkTableInfo                                                                         </span>
<span class="876169318065797844" onmouseenter="enter('876169318065797844');" onmouseout="out('876169318065797844');" style="">  49      * @param typeInformation                                                                            </span>
<span class="-1925050675286197216" onmouseenter="enter('-1925050675286197216');" onmouseout="out('-1925050675286197216');" style="">  50      * @param properties                                                                                 </span>
<span class="876584971693255658" onmouseenter="enter('876584971693255658');" onmouseout="out('876584971693255658');" style="">  51      * @param partitioner                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  52      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53      */                                                                                                  </span>
<span class="807869621589388322" onmouseenter="enter('807869621589388322');" onmouseout="out('807869621589388322');" style=""><abbr title="  54     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;CRow&gt;&gt; partitioner, String[] partitionKeys);">  54     public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, Typ🔵</abbr></span>
<span  style="">  55                                                                                                          </span>
<span class="-1953337309800932884" onmouseenter="enter('-1953337309800932884');" onmouseout="out('-1953337309800932884');" style=""><abbr title="  56     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  56     protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTab🔵</abbr></span>
<span class="1201523324391776151" onmouseenter="enter('1201523324391776151');" onmouseout="out('1201523324391776151');" style=""><abbr title="  57         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typeInformation);">  57         SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typ🔵</abbr></span>
<span class="1843141058381695988" onmouseenter="enter('1843141058381695988');" onmouseout="out('1843141058381695988');" style="">  58         return new SerializationMetricWrapper(serializationSchema);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  59     }                                                                                                    </span>
<span  style="">  60                                                                                                          </span>
<span class="6128510894007066537" onmouseenter="enter('6128510894007066537');" onmouseout="out('6128510894007066537');" style=""><abbr title="  61     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  61     private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, Ty🔵</abbr></span>
<span class="4284248082131020395" onmouseenter="enter('4284248082131020395');" onmouseout="out('4284248082131020395');" style="">  62         SerializationSchema&lt;CRow&gt; serializationSchema = null;                                            </span>
<span class="8854632501833264179" onmouseenter="enter('8854632501833264179');" onmouseout="out('8854632501833264179');" style="">  63         if (FormatType.JSON.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {             </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="">  64             if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                          </span>
<span class="-2168875349211845286" onmouseenter="enter('-2168875349211845286');" onmouseout="out('-2168875349211845286');" style="">  65                 serializationSchema = new                                                                </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">  66 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-1543465604580575457" onmouseenter="enter('-1543465604580575457');" onmouseout="out('-1543465604580575457');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67 JsonCRowSerializationSchema                                                                              </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  68 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  69 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">  69 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  70 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  71                                                                                                          </span>
<span class="7828063386625690908" onmouseenter="enter('7828063386625690908');" onmouseout="out('7828063386625690908');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72 DTJsonRowSerializationSchema                                                                             </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style="">  73 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-913252674350097077" onmouseenter="enter('-913252674350097077');" onmouseout="out('-913252674350097077');" style="">  74                 (kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());              </span>
<span class="-2011204623118850591" onmouseenter="enter('-2011204623118850591');" onmouseout="out('-2011204623118850591');" style="">  75             } else if ((typeInformation != null) &amp;&amp; (typeInformation.getArity() != 0)) {                 </span>
<span class="-2168875349211845286" onmouseenter="enter('-2168875349211845286');" onmouseout="out('-2168875349211845286');" style="">  76                 serializationSchema = new                                                                </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">  77 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-1543465604580575457" onmouseenter="enter('-1543465604580575457');" onmouseout="out('-1543465604580575457');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  78 JsonCRowSerializationSchema                                                                              </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  79 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  80 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">  80 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  81 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  82                                                                                                          </span>
<span class="7828063386625690908" onmouseenter="enter('7828063386625690908');" onmouseout="out('7828063386625690908');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83 DTJsonRowSerializationSchema                                                                             </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style="">  84 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-2834316464353386106" onmouseenter="enter('-2834316464353386106');" onmouseout="out('-2834316464353386106');" style="">  85                 (typeInformation, kafkaSinkTableInfo.getUpdateMode());                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  86             } else {                                                                                     </span>
<span class="-4190302800377175904" onmouseenter="enter('-4190302800377175904');" onmouseout="out('-4190302800377175904');" style=""><abbr title="  87                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.JSON.name()) + &quot; must set schemaString（JSON Schema）or TypeInformation&lt;Row&gt;&quot;);">  87                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.JSON.name()) + &quot; must se🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88             }                                                                                            </span>
<span class="6569416534162311937" onmouseenter="enter('6569416534162311937');" onmouseout="out('6569416534162311937');" style="">  89         } else if (FormatType.CSV.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {       </span>
<span class="8692204720536640412" onmouseenter="enter('8692204720536640412');" onmouseout="out('8692204720536640412');" style="">  90             if (StringUtils.isBlank(kafkaSinkTableInfo.getFieldDelimiter())) {                           </span>
<span class="4548852897567977179" onmouseenter="enter('4548852897567977179');" onmouseout="out('4548852897567977179');" style=""><abbr title="  91                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.CSV.name()) + &quot; must set fieldDelimiter&quot;);">  91                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.CSV.name()) + &quot; must set🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92             }                                                                                            </span>
<span class="-5658277403926557174" onmouseenter="enter('-5658277403926557174');" onmouseout="out('-5658277403926557174');" style=""><abbr title="  93             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Builder(typeInformation);">  93             final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Bu🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="">  94             serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]); </span>
<span class="2582891746897336117" onmouseenter="enter('2582891746897336117');" onmouseout="out('2582891746897336117');" style="">  95             serSchemaBuilder.setUpdateMode(kafkaSinkTableInfo.getUpdateMode());                          </span>
<span class="-4159422725498262321" onmouseenter="enter('-4159422725498262321');" onmouseout="out('-4159422725498262321');" style="">  96             serializationSchema = serSchemaBuilder.build();                                              </span>
<span class="3491381513973426945" onmouseenter="enter('3491381513973426945');" onmouseout="out('3491381513973426945');" style="">  97         } else if (FormatType.AVRO.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {      </span>
<span class="-3294523277528553946" onmouseenter="enter('-3294523277528553946');" onmouseout="out('-3294523277528553946');" style="">  98             if (StringUtils.isBlank(kafkaSinkTableInfo.getSchemaString())) {                             </span>
<span class="-8270458608708569581" onmouseenter="enter('-8270458608708569581');" onmouseout="out('-8270458608708569581');" style=""><abbr title="  99                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.AVRO.name()) + &quot; must set schemaString&quot;);">  99                 throw new IllegalArgumentException((&quot;sinkDataType:&quot; + FormatType.AVRO.name()) + &quot; must se🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100             }                                                                                            </span>
<span class="-2917929829430641261" onmouseenter="enter('-2917929829430641261');" onmouseout="out('-2917929829430641261');" style=""><abbr title=" 101             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());"> 101             serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), k🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span class="-3641104599870236883" onmouseenter="enter('-3641104599870236883');" onmouseout="out('-3641104599870236883');" style=""> 103         if (null == serializationSchema) {                                                               </span>
<span class="-7022743072536649035" onmouseenter="enter('-7022743072536649035');" onmouseout="out('-7022743072536649035');" style=""><abbr title=" 104             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType());"> 104             throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType())🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span class="-6789472026410253826" onmouseenter="enter('-6789472026410253826');" onmouseout="out('-6789472026410253826');" style=""> 106         return serializationSchema;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108 }                                                                                                        </span>






</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-622542009573380574" onmouseenter="enter('-622542009573380574');" onmouseout="out('-622542009573380574');" style="">  18  package com.dtstack.flink.sql.sink.kafka;                                                                         </span>
<span  style="">  19                                                                                                                    </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20  import com.dtstack.flink.sql.format.FormatType;                                                                   </span>
<span class="8146569798737420437" onmouseenter="enter('8146569798737420437');" onmouseout="out('8146569798737420437');" style="">  21  import com.dtstack.flink.sql.format.SerializationMetricWrapper;                                                   </span>
<span class="5593244862353374468" onmouseenter="enter('5593244862353374468');" onmouseout="out('5593244862353374468');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import com.dtstack.flink.sql.sink.kafka.serialization.AvroCRowSerializationSchema;                                </span>
<span class="2914559868996856560" onmouseenter="enter('2914559868996856560');" onmouseout="out('2914559868996856560');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.sink.kafka.serialization.CsvCRowSerializationSchema;                                 </span>
<span class="3974848073621898985" onmouseenter="enter('3974848073621898985');" onmouseout="out('3974848073621898985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.sink.kafka.serialization.JsonCRowSerializationSchema;                                </span>
<span class="-725474603042399732" onmouseenter="enter('-725474603042399732');" onmouseout="out('-725474603042399732');" style="">  25  import com.dtstack.flink.sql.sink.kafka.table.KafkaSinkTableInfo;                                                 </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  27  import org.apache.flink.api.common.serialization.SerializationSchema;                                             </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  28  import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="-752754047719068206" onmouseenter="enter('-752754047719068206');" onmouseout="out('-752754047719068206');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import org.apache.flink.formats.avro.AvroRowSerializationSchema;                                                  </span>
<span class="-9035464761660049480" onmouseenter="enter('-9035464761660049480');" onmouseout="out('-9035464761660049480');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import org.apache.flink.formats.csv.CsvRowSerializationSchema;                                                    </span>
<span class="-6185608683170964700" onmouseenter="enter('-6185608683170964700');" onmouseout="out('-6185608683170964700');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.flink.formats.json.JsonRowSerializationSchema;                                                  </span>

<span class="6003661863865659743" onmouseenter="enter('6003661863865659743');" onmouseout="out('6003661863865659743');" style="">  32  import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;                                            </span>
<span class="4427972705296160450" onmouseenter="enter('4427972705296160450');" onmouseout="out('4427972705296160450');" style="">  33  import org.apache.flink.streaming.connectors.kafka.partitioner.FlinkKafkaPartitioner;                             </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.flink.types.Row;                                                                                </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span  style="">  36                                                                                                                    </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="">  37  import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  38  import java.util.Properties;                                                                                      </span>
<span  style="">  39                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40  /**                                                                                                               </span>
<span class="-6980196326705088706" onmouseenter="enter('-6980196326705088706');" onmouseout="out('-6980196326705088706');" style="">  41   * 抽象的kafka producer 的工厂类                                                                                         </span>
<span class="6881855006388508945" onmouseenter="enter('6881855006388508945');" onmouseout="out('6881855006388508945');" style="">  42   * 包括序统一的序列化工具的构造                                                                                                 </span>
<span class="-8729821338350872800" onmouseenter="enter('-8729821338350872800');" onmouseout="out('-8729821338350872800');" style="">  43   * company: www.dtstack.com                                                                                       </span>
<span class="855988645286188992" onmouseenter="enter('855988645286188992');" onmouseout="out('855988645286188992');" style="">  44   * @author: toutian                                                                                               </span>
<span class="1456019527766592923" onmouseenter="enter('1456019527766592923');" onmouseout="out('1456019527766592923');" style="">  45   * create: 2019/12/26                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  46   */                                                                                                               </span>
<span class="-162974631075819799" onmouseenter="enter('-162974631075819799');" onmouseout="out('-162974631075819799');" style="">  47  public abstract class AbstractKafkaProducerFactory {                                                              </span>
<span  style="">  48                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  49      /**                                                                                                           </span>
<span class="2345236795123227489" onmouseenter="enter('2345236795123227489');" onmouseout="out('2345236795123227489');" style="">  50       *  获取具体的KafkaProducer                                                                                        </span>
<span class="-6126255428228135083" onmouseenter="enter('-6126255428228135083');" onmouseout="out('-6126255428228135083');" style="">  51       * eg create KafkaProducer010                                                                                 </span>
<span class="-3257897229150079368" onmouseenter="enter('-3257897229150079368');" onmouseout="out('-3257897229150079368');" style="">  52       * @param kafkaSinkTableInfo                                                                                  </span>
<span class="876169318065797844" onmouseenter="enter('876169318065797844');" onmouseout="out('876169318065797844');" style="">  53       * @param typeInformation                                                                                     </span>
<span class="-1925050675286197216" onmouseenter="enter('-1925050675286197216');" onmouseout="out('-1925050675286197216');" style="">  54       * @param properties                                                                                          </span>
<span class="876584971693255658" onmouseenter="enter('876584971693255658');" onmouseout="out('876584971693255658');" style="">  55       * @param partitioner                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  56       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57       */                                                                                                           </span>
<span class="-2910516490914990590" onmouseenter="enter('-2910516490914990590');" onmouseout="out('-2910516490914990590');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  58 -    public abstract RichSinkFunction&lt;Row&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;Row&gt;&gt; partitioner, String[] partitionKeys);">  58 -    public abstract RichSinkFunction&lt;Row&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformati🔵</abbr></span>
<span class="807869621589388322" onmouseenter="enter('807869621589388322');" onmouseout="out('807869621589388322');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  59 +    public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;CRow&gt;&gt; partitioner, String[] partitionKeys);">  59 +    public abstract RichSinkFunction&lt;CRow&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformat🔵</abbr></span>
<span  style="">  60                                                                                                                    </span>
<span class="-915520834051263786" onmouseenter="enter('-915520834051263786');" onmouseout="out('-915520834051263786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  61 -    protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation) {">  61 -    protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, T🔵</abbr></span>
<span class="-3962424770318795500" onmouseenter="enter('-3962424770318795500');" onmouseout="out('-3962424770318795500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -        return new SerializationMetricWrapper(createSerializationSchema(kafkaSinkTableInfo, typeInformation));    </span>
<span class="-1953337309800932884" onmouseenter="enter('-1953337309800932884');" onmouseout="out('-1953337309800932884');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  63 +    protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  63 +    protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, T🔵</abbr></span>
<span class="1201523324391776151" onmouseenter="enter('1201523324391776151');" onmouseout="out('1201523324391776151');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  64 +        SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typeInformation);">  64 +        SerializationSchema&lt;CRow&gt; serializationSchema = createSerializationSchema(kafkaSinkTableInfo, typeInformat🔵</abbr></span>
<span class="1843141058381695988" onmouseenter="enter('1843141058381695988');" onmouseout="out('1843141058381695988');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +        return new SerializationMetricWrapper(serializationSchema);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66      }                                                                                                             </span>
<span  style="">  67                                                                                                                    </span>
<span class="-8679949466912216369" onmouseenter="enter('-8679949466912216369');" onmouseout="out('-8679949466912216369');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  68 -    private SerializationSchema&lt;Row&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation) {">  68 -    private SerializationSchema&lt;Row&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformat🔵</abbr></span>
<span class="5791890817871912507" onmouseenter="enter('5791890817871912507');" onmouseout="out('5791890817871912507');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -        SerializationSchema&lt;Row&gt; serializationSchema = null;                                                      </span>
<span class="6128510894007066537" onmouseenter="enter('6128510894007066537');" onmouseout="out('6128510894007066537');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  70 +    private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;CRow&gt; typeInformation) {">  70 +    private SerializationSchema&lt;CRow&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInforma🔵</abbr></span>
<span class="4284248082131020395" onmouseenter="enter('4284248082131020395');" onmouseout="out('4284248082131020395');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +        SerializationSchema&lt;CRow&gt; serializationSchema = null;                                                     </span>
<span class="8854632501833264179" onmouseenter="enter('8854632501833264179');" onmouseout="out('8854632501833264179');" style="">  72          if (FormatType.JSON.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -                                                                                                                  </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="">  74              if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                                   </span>
<span class="-4496042135541537579" onmouseenter="enter('-4496042135541537579');" onmouseout="out('-4496042135541537579');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -                serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());       </span>
<span class="3690051723102913615" onmouseenter="enter('3690051723102913615');" onmouseout="out('3690051723102913615');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  76 +                serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());">  76 +                serializationSchema = new JsonCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaS🔵</abbr></span>
<span class="-3326181373266435486" onmouseenter="enter('-3326181373266435486');" onmouseout="out('-3326181373266435486');" style="">  77              } else if (typeInformation != null &amp;&amp; typeInformation.getArity() != 0) {                              </span>
<span class="6239021955164631311" onmouseenter="enter('6239021955164631311');" onmouseout="out('6239021955164631311');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -                serializationSchema = new JsonRowSerializationSchema(typeInformation);                            </span>
<span class="9110015556450762269" onmouseenter="enter('9110015556450762269');" onmouseout="out('9110015556450762269');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  79 +                serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo.getUpdateMode());">  79 +                serializationSchema = new JsonCRowSerializationSchema(typeInformation, kafkaSinkTableInfo.getUpdat🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  80              } else {                                                                                              </span>
<span class="891778567235443456" onmouseenter="enter('891778567235443456');" onmouseout="out('891778567235443456');" style=""><abbr title="  81                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaString（JSON Schema）or TypeInformation&lt;Row&gt;&quot;);">  81                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaStr🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82              }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -                                                                                                                  </span>
<span class="6569416534162311937" onmouseenter="enter('6569416534162311937');" onmouseout="out('6569416534162311937');" style="">  84          } else if (FormatType.CSV.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -                                                                                                                  </span>
<span class="8692204720536640412" onmouseenter="enter('8692204720536640412');" onmouseout="out('8692204720536640412');" style="">  86              if (StringUtils.isBlank(kafkaSinkTableInfo.getFieldDelimiter())) {                                    </span>
<span class="-3865345020373799877" onmouseenter="enter('-3865345020373799877');" onmouseout="out('-3865345020373799877');" style=""><abbr title="  87                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelimiter&quot;);">  87                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelim🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88              }                                                                                                     </span>
<span class="-5658277403926557174" onmouseenter="enter('-5658277403926557174');" onmouseout="out('-5658277403926557174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  89 +            final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Builder(typeInformation);">  89 +            final CsvCRowSerializationSchema.Builder serSchemaBuilder = new CsvCRowSerializationSchema.Builder(typ🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +            serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]);          </span>
<span class="2582891746897336117" onmouseenter="enter('2582891746897336117');" onmouseout="out('2582891746897336117');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +            serSchemaBuilder.setUpdateMode(kafkaSinkTableInfo.getUpdateMode());                                   </span>
<span  style="">  92                                                                                                                    </span>
<span class="-7527811228398458110" onmouseenter="enter('-7527811228398458110');" onmouseout="out('-7527811228398458110');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  93 -            final CsvRowSerializationSchema.Builder serSchemaBuilder = new CsvRowSerializationSchema.Builder(typeInformation);">  93 -            final CsvRowSerializationSchema.Builder serSchemaBuilder = new CsvRowSerializationSchema.Builder(typeI🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -            serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]);          </span>
<span class="-4159422725498262321" onmouseenter="enter('-4159422725498262321');" onmouseout="out('-4159422725498262321');" style="">  95              serializationSchema = serSchemaBuilder.build();                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -                                                                                                                  </span>
<span class="3491381513973426945" onmouseenter="enter('3491381513973426945');" onmouseout="out('3491381513973426945');" style="">  97          } else if (FormatType.AVRO.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -                                                                                                                  </span>
<span class="-3294523277528553946" onmouseenter="enter('-3294523277528553946');" onmouseout="out('-3294523277528553946');" style="">  99              if (StringUtils.isBlank(kafkaSinkTableInfo.getSchemaString())) {                                      </span>
<span class="-898673182966267500" onmouseenter="enter('-898673182966267500');" onmouseout="out('-898673182966267500');" style=""><abbr title=" 100                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaString&quot;);"> 100                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaStr🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101              }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -                                                                                                                  </span>
<span class="4918298184313284729" onmouseenter="enter('4918298184313284729');" onmouseout="out('4918298184313284729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -            serializationSchema = new AvroRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                                                                                                                  </span>
<span class="-2917929829430641261" onmouseenter="enter('-2917929829430641261');" onmouseout="out('-2917929829430641261');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 105 +            serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkTableInfo.getUpdateMode());"> 105 +            serializationSchema = new AvroCRowSerializationSchema(kafkaSinkTableInfo.getSchemaString(), kafkaSinkT🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106          }                                                                                                         </span>
<span  style=""> 107                                                                                                                    </span>
<span class="-3641104599870236883" onmouseenter="enter('-3641104599870236883');" onmouseout="out('-3641104599870236883');" style=""> 108          if (null == serializationSchema) {                                                                        </span>
<span class="-7022743072536649035" onmouseenter="enter('-7022743072536649035');" onmouseout="out('-7022743072536649035');" style=""> 109              throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType());        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110          }                                                                                                         </span>
<span  style=""> 111                                                                                                                    </span>
<span class="-6789472026410253826" onmouseenter="enter('-6789472026410253826');" onmouseout="out('-6789472026410253826');" style=""> 112          return serializationSchema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113      }                                                                                                             </span>
<span  style=""> 114                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-622542009573380574" onmouseenter="enter('-622542009573380574');" onmouseout="out('-622542009573380574');" style="">  18  package com.dtstack.flink.sql.sink.kafka;                                                                         </span>
<span  style="">  19                                                                                                                    </span>
<span class="630284505347722104" onmouseenter="enter('630284505347722104');" onmouseout="out('630284505347722104');" style="">  20  import com.dtstack.flink.sql.format.FormatType;                                                                   </span>
<span class="8146569798737420437" onmouseenter="enter('8146569798737420437');" onmouseout="out('8146569798737420437');" style="">  21  import com.dtstack.flink.sql.format.SerializationMetricWrapper;                                                   </span>



<span class="-725474603042399732" onmouseenter="enter('-725474603042399732');" onmouseout="out('-725474603042399732');" style="">  22  import com.dtstack.flink.sql.sink.kafka.table.KafkaSinkTableInfo;                                                 </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  23  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  24  import org.apache.flink.api.common.serialization.SerializationSchema;                                             </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  25  import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="-752754047719068206" onmouseenter="enter('-752754047719068206');" onmouseout="out('-752754047719068206');" style="">  26  import org.apache.flink.formats.avro.AvroRowSerializationSchema;                                                  </span>
<span class="-9035464761660049480" onmouseenter="enter('-9035464761660049480');" onmouseout="out('-9035464761660049480');" style="">  27  import org.apache.flink.formats.csv.CsvRowSerializationSchema;                                                    </span>
<span class="-6185608683170964700" onmouseenter="enter('-6185608683170964700');" onmouseout="out('-6185608683170964700');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import org.apache.flink.formats.json.JsonRowSerializationSchema;                                                  </span>
<span class="-3705670459604611692" onmouseenter="enter('-3705670459604611692');" onmouseout="out('-3705670459604611692');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import org.apache.flink.formats.json.DTJsonRowSerializationSchema;                                                </span>
<span class="6003661863865659743" onmouseenter="enter('6003661863865659743');" onmouseout="out('6003661863865659743');" style="">  30  import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;                                            </span>
<span class="4427972705296160450" onmouseenter="enter('4427972705296160450');" onmouseout="out('4427972705296160450');" style="">  31  import org.apache.flink.streaming.connectors.kafka.partitioner.FlinkKafkaPartitioner;                             </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  32  import org.apache.flink.types.Row;                                                                                </span>

<span  style="">  33                                                                                                                    </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="">  34  import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  35  import java.util.Properties;                                                                                      </span>
<span  style="">  36                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  37  /**                                                                                                               </span>
<span class="-6980196326705088706" onmouseenter="enter('-6980196326705088706');" onmouseout="out('-6980196326705088706');" style="">  38   * 抽象的kafka producer 的工厂类                                                                                         </span>
<span class="6881855006388508945" onmouseenter="enter('6881855006388508945');" onmouseout="out('6881855006388508945');" style="">  39   * 包括序统一的序列化工具的构造                                                                                                 </span>
<span class="-8729821338350872800" onmouseenter="enter('-8729821338350872800');" onmouseout="out('-8729821338350872800');" style="">  40   * company: www.dtstack.com                                                                                       </span>
<span class="855988645286188992" onmouseenter="enter('855988645286188992');" onmouseout="out('855988645286188992');" style="">  41   * @author: toutian                                                                                               </span>
<span class="1456019527766592923" onmouseenter="enter('1456019527766592923');" onmouseout="out('1456019527766592923');" style="">  42   * create: 2019/12/26                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  43   */                                                                                                               </span>
<span class="-162974631075819799" onmouseenter="enter('-162974631075819799');" onmouseout="out('-162974631075819799');" style="">  44  public abstract class AbstractKafkaProducerFactory {                                                              </span>
<span  style="">  45                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46      /**                                                                                                           </span>
<span class="2345236795123227489" onmouseenter="enter('2345236795123227489');" onmouseout="out('2345236795123227489');" style="">  47       *  获取具体的KafkaProducer                                                                                        </span>
<span class="-6126255428228135083" onmouseenter="enter('-6126255428228135083');" onmouseout="out('-6126255428228135083');" style="">  48       * eg create KafkaProducer010                                                                                 </span>
<span class="-3257897229150079368" onmouseenter="enter('-3257897229150079368');" onmouseout="out('-3257897229150079368');" style="">  49       * @param kafkaSinkTableInfo                                                                                  </span>
<span class="876169318065797844" onmouseenter="enter('876169318065797844');" onmouseout="out('876169318065797844');" style="">  50       * @param typeInformation                                                                                     </span>
<span class="-1925050675286197216" onmouseenter="enter('-1925050675286197216');" onmouseout="out('-1925050675286197216');" style="">  51       * @param properties                                                                                          </span>
<span class="876584971693255658" onmouseenter="enter('876584971693255658');" onmouseout="out('876584971693255658');" style="">  52       * @param partitioner                                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="">  53       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54       */                                                                                                           </span>
<span class="-2910516490914990590" onmouseenter="enter('-2910516490914990590');" onmouseout="out('-2910516490914990590');" style=""><abbr title="  55      public abstract RichSinkFunction&lt;Row&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation, Properties properties, Optional&lt;FlinkKafkaPartitioner&lt;Row&gt;&gt; partitioner, String[] partitionKeys);">  55      public abstract RichSinkFunction&lt;Row&gt; createKafkaProducer(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformati🔵</abbr></span>

<span  style="">  56                                                                                                                    </span>
<span class="-915520834051263786" onmouseenter="enter('-915520834051263786');" onmouseout="out('-915520834051263786');" style=""><abbr title="  57      protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation) {">  57      protected SerializationMetricWrapper createSerializationMetricWrapper(KafkaSinkTableInfo kafkaSinkTableInfo, T🔵</abbr></span>
<span class="-3962424770318795500" onmouseenter="enter('-3962424770318795500');" onmouseout="out('-3962424770318795500');" style="">  58          return new SerializationMetricWrapper(createSerializationSchema(kafkaSinkTableInfo, typeInformation));    </span>



<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  59      }                                                                                                             </span>
<span  style="">  60                                                                                                                    </span>
<span class="-8679949466912216369" onmouseenter="enter('-8679949466912216369');" onmouseout="out('-8679949466912216369');" style=""><abbr title="  61      private SerializationSchema&lt;Row&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformation&lt;Row&gt; typeInformation) {">  61      private SerializationSchema&lt;Row&gt; createSerializationSchema(KafkaSinkTableInfo kafkaSinkTableInfo, TypeInformat🔵</abbr></span>
<span class="5791890817871912507" onmouseenter="enter('5791890817871912507');" onmouseout="out('5791890817871912507');" style="">  62          SerializationSchema&lt;Row&gt; serializationSchema = null;                                                      </span>


<span class="8854632501833264179" onmouseenter="enter('8854632501833264179');" onmouseout="out('8854632501833264179');" style="">  63          if (FormatType.JSON.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {                      </span>
<span  style="">  64                                                                                                                    </span>
<span class="1089157552712313198" onmouseenter="enter('1089157552712313198');" onmouseout="out('1089157552712313198');" style="">  65              if (StringUtils.isNotBlank(kafkaSinkTableInfo.getSchemaString())) {                                   </span>
<span class="-4496042135541537579" onmouseenter="enter('-4496042135541537579');" onmouseout="out('-4496042135541537579');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -                serializationSchema = new JsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());       </span>
<span class="8122118826301879856" onmouseenter="enter('8122118826301879856');" onmouseout="out('8122118826301879856');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                serializationSchema = new DTJsonRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());     </span>
<span class="-3326181373266435486" onmouseenter="enter('-3326181373266435486');" onmouseout="out('-3326181373266435486');" style="">  68              } else if (typeInformation != null &amp;&amp; typeInformation.getArity() != 0) {                              </span>
<span class="6239021955164631311" onmouseenter="enter('6239021955164631311');" onmouseout="out('6239021955164631311');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -                serializationSchema = new JsonRowSerializationSchema(typeInformation);                            </span>
<span class="-6992141123297405765" onmouseenter="enter('-6992141123297405765');" onmouseout="out('-6992141123297405765');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +                serializationSchema = new DTJsonRowSerializationSchema(typeInformation);                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  71              } else {                                                                                              </span>
<span class="891778567235443456" onmouseenter="enter('891778567235443456');" onmouseout="out('891778567235443456');" style=""><abbr title="  72                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaString（JSON Schema）or TypeInformation&lt;Row&gt;&quot;);">  72                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.JSON.name() + &quot; must set schemaStr🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73              }                                                                                                     </span>
<span  style="">  74                                                                                                                    </span>
<span class="6569416534162311937" onmouseenter="enter('6569416534162311937');" onmouseout="out('6569416534162311937');" style="">  75          } else if (FormatType.CSV.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {                </span>
<span  style="">  76                                                                                                                    </span>
<span class="8692204720536640412" onmouseenter="enter('8692204720536640412');" onmouseout="out('8692204720536640412');" style="">  77              if (StringUtils.isBlank(kafkaSinkTableInfo.getFieldDelimiter())) {                                    </span>
<span class="-3865345020373799877" onmouseenter="enter('-3865345020373799877');" onmouseout="out('-3865345020373799877');" style=""><abbr title="  78                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelimiter&quot;);">  78                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.CSV.name() + &quot; must set fieldDelim🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79              }                                                                                                     </span>



<span  style="">  80                                                                                                                    </span>
<span class="-7527811228398458110" onmouseenter="enter('-7527811228398458110');" onmouseout="out('-7527811228398458110');" style=""><abbr title="  81              final CsvRowSerializationSchema.Builder serSchemaBuilder = new CsvRowSerializationSchema.Builder(typeInformation);">  81              final CsvRowSerializationSchema.Builder serSchemaBuilder = new CsvRowSerializationSchema.Builder(typeI🔵</abbr></span>
<span class="588007648697703763" onmouseenter="enter('588007648697703763');" onmouseout="out('588007648697703763');" style="">  82              serSchemaBuilder.setFieldDelimiter(kafkaSinkTableInfo.getFieldDelimiter().toCharArray()[0]);          </span>
<span class="-4159422725498262321" onmouseenter="enter('-4159422725498262321');" onmouseout="out('-4159422725498262321');" style="">  83              serializationSchema = serSchemaBuilder.build();                                                       </span>
<span  style="">  84                                                                                                                    </span>
<span class="3491381513973426945" onmouseenter="enter('3491381513973426945');" onmouseout="out('3491381513973426945');" style="">  85          } else if (FormatType.AVRO.name().equalsIgnoreCase(kafkaSinkTableInfo.getSinkDataType())) {               </span>
<span  style="">  86                                                                                                                    </span>
<span class="-3294523277528553946" onmouseenter="enter('-3294523277528553946');" onmouseout="out('-3294523277528553946');" style="">  87              if (StringUtils.isBlank(kafkaSinkTableInfo.getSchemaString())) {                                      </span>
<span class="-898673182966267500" onmouseenter="enter('-898673182966267500');" onmouseout="out('-898673182966267500');" style=""><abbr title="  88                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaString&quot;);">  88                  throw new IllegalArgumentException(&quot;sinkDataType:&quot; + FormatType.AVRO.name() + &quot; must set schemaStr🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89              }                                                                                                     </span>
<span  style="">  90                                                                                                                    </span>
<span class="4918298184313284729" onmouseenter="enter('4918298184313284729');" onmouseout="out('4918298184313284729');" style="">  91              serializationSchema = new AvroRowSerializationSchema(kafkaSinkTableInfo.getSchemaString());           </span>
<span  style="">  92                                                                                                                    </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93          }                                                                                                         </span>
<span  style="">  94                                                                                                                    </span>
<span class="-3641104599870236883" onmouseenter="enter('-3641104599870236883');" onmouseout="out('-3641104599870236883');" style="">  95          if (null == serializationSchema) {                                                                        </span>
<span class="-7022743072536649035" onmouseenter="enter('-7022743072536649035');" onmouseout="out('-7022743072536649035');" style="">  96              throw new UnsupportedOperationException(&quot;FormatType:&quot; + kafkaSinkTableInfo.getSinkDataType());        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97          }                                                                                                         </span>
<span  style="">  98                                                                                                                    </span>
<span class="-6789472026410253826" onmouseenter="enter('-6789472026410253826');" onmouseout="out('-6789472026410253826');" style="">  99          return serializationSchema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100      }                                                                                                             </span>
<span  style=""> 101                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            