<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>384</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    384
                    <a href="383.html">prev</a>
                    <a href="385.html">next</a>
                    <a href="384_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_c82b9ccdf1393af88048eae80a098a6a0901d157_core/src/main/java/com/dtstack/flink/sql/util/TableUtils.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157:core/src/main/java/com/dtstack/flink/sql/util/TableUtils.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157^1:core/src/main/java/com/dtstack/flink/sql/util/TableUtils.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;c82b9ccdf1393af88048eae80a098a6a0901d157^2:core/src/main/java/com/dtstack/flink/sql/util/TableUtils.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;8cb6d5aea72f25034c7f3626ec6ef98783b1bee5:core/src/main/java/com/dtstack/flink/sql/util/TableUtils.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  20 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  21                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  23 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  24 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">  25 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  26 import com.google.common.base.Preconditions;                                                             </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  27 import com.google.common.base.Strings;                                                                   </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  28 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  29 import com.google.common.collect.HashBiMap;                                                              </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  30 import com.google.common.collect.Lists;                                                                  </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  31 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  32 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  33 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  34 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  35 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  36 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  37 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  38 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  39 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  40 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  41 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  42 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  43 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  44 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  45 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  46 import org.apache.flink.table.api.Table;                                                                 </span>
<span  style="">  47                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  48 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  49 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  50 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  51 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  52 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  53 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  54                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  55 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span class="511836661302622038" onmouseenter="enter('511836661302622038');" onmouseout="out('511836661302622038');" style="">  56 import static org.apache.calcite.sql.SqlKind.CASE;                                                       </span>
<span class="178844392791952204" onmouseenter="enter('178844392791952204');" onmouseout="out('178844392791952204');" style="">  57 import static org.apache.calcite.sql.SqlKind.OTHER;                                                      </span>
<span  style="">  58                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59 /**                                                                                                      </span>
<span class="2491900718050250190" onmouseenter="enter('2491900718050250190');" onmouseout="out('2491900718050250190');" style="">  60  * 表的解析相关                                                                                                </span>
<span class="-831295595380638887" onmouseenter="enter('-831295595380638887');" onmouseout="out('-831295595380638887');" style="">  61  * Date: 2020/2/17                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  62  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  63  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64  */                                                                                                      </span>
<span  style="">  65                                                                                                          </span>
<span class="-5515152307095787287" onmouseenter="enter('-5515152307095787287');" onmouseout="out('-5515152307095787287');" style="">  66 public class TableUtils {                                                                                </span>
<span  style="">  67                                                                                                          </span>
<span class="6670707421612748000" onmouseenter="enter('6670707421612748000');" onmouseout="out('6670707421612748000');" style="">  68     public static final char SPLIT = &#x27;_&#x27;;                                                                </span>
<span class="-3060398288124517436" onmouseenter="enter('-3060398288124517436');" onmouseout="out('-3060398288124517436');" style="">  69     public static final Pattern stringPattern = Pattern.compile(&quot;\&quot;.*?\&quot;|\&#x27;.*?\&#x27;&quot;);                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70     /**                                                                                                  </span>
<span class="-3835139450942807208" onmouseenter="enter('-3835139450942807208');" onmouseout="out('-3835139450942807208');" style="">  71      * 获取select 的字段                                                                                      </span>
<span class="-592626010544206006" onmouseenter="enter('-592626010544206006');" onmouseout="out('-592626010544206006');" style="">  72      * @param sqlSelect                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73      */                                                                                                  </span>
<span class="-662197916250462065" onmouseenter="enter('-662197916250462065');" onmouseout="out('-662197916250462065');" style=""><abbr title="  74     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCache){">  74     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCac🔵</abbr></span>
<span class="8036786023408828043" onmouseenter="enter('8036786023408828043');" onmouseout="out('8036786023408828043');" style="">  75         SqlNodeList sqlNodeList = sqlSelect.getSelectList();                                             </span>
<span class="-3054172495871960241" onmouseenter="enter('-3054172495871960241');" onmouseout="out('-3054172495871960241');" style="">  76         List&lt;FieldInfo&gt; fieldInfoList = Lists.newArrayList();                                            </span>
<span class="-839692389379732251" onmouseenter="enter('-839692389379732251');" onmouseout="out('-839692389379732251');" style="">  77         String fromNode = sqlSelect.getFrom().toString();                                                </span>
<span  style="">  78                                                                                                          </span>
<span class="2162301537633635938" onmouseenter="enter('2162301537633635938');" onmouseout="out('2162301537633635938');" style="">  79         for (SqlNode fieldNode : sqlNodeList.getList()) {                                                </span>
<span class="1465841598931987040" onmouseenter="enter('1465841598931987040');" onmouseout="out('1465841598931987040');" style="">  80             extractSelectFieldToFieldInfo(fieldNode,fromNode,fieldInfoList,localTableCache);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81         }                                                                                                </span>
<span  style="">  82                                                                                                          </span>
<span class="1335352475287465914" onmouseenter="enter('1335352475287465914');" onmouseout="out('1335352475287465914');" style="">  83         return fieldInfoList;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  86     /**                                                                                                  </span>
<span class="-6805611089677825770" onmouseenter="enter('-6805611089677825770');" onmouseout="out('-6805611089677825770');" style="">  87      *  解析select Node 提取FieldInfo                                                                        </span>
<span class="697554033229417632" onmouseenter="enter('697554033229417632');" onmouseout="out('697554033229417632');" style="">  88      * @param fieldNode                                                                                  </span>
<span class="-1719315088034482430" onmouseenter="enter('-1719315088034482430');" onmouseout="out('-1719315088034482430');" style="">  89      * @param fromNode                                                                                   </span>
<span class="8898190159008473723" onmouseenter="enter('8898190159008473723');" onmouseout="out('8898190159008473723');" style="">  90      * @param fieldInfoList                                                                              </span>
<span class="-2613125561450459797" onmouseenter="enter('-2613125561450459797');" onmouseout="out('-2613125561450459797');" style="">  91      * @param localTableCache                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92      */                                                                                                  </span>
<span class="911398554884375981" onmouseenter="enter('911398554884375981');" onmouseout="out('911398554884375981');" style=""><abbr title="  93     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfoList, Map&lt;String, Table&gt; localTableCache) {">  93     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; 🔵</abbr></span>
<span class="8336572539967602309" onmouseenter="enter('8336572539967602309');" onmouseout="out('8336572539967602309');" style="">  94         if (fieldNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="2728418029840045752" onmouseenter="enter('2728418029840045752');" onmouseout="out('2728418029840045752');" style="">  95             SqlIdentifier identifier = (SqlIdentifier) fieldNode;                                        </span>
<span class="-5519378359901478287" onmouseenter="enter('-5519378359901478287');" onmouseout="out('-5519378359901478287');" style="">  96             if (!identifier.isStar()) {                                                                  </span>
<span class="7382398262726877456" onmouseenter="enter('7382398262726877456');" onmouseout="out('7382398262726877456');" style=""><abbr title="  97                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple();">  97                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).g🔵</abbr></span>
<span class="-4078369372891740310" onmouseenter="enter('-4078369372891740310');" onmouseout="out('-4078369372891740310');" style=""><abbr title="  98                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identifier.getComponent(1).getSimple();">  98                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() 🔵</abbr></span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style="">  99                 FieldInfo fieldInfo = new FieldInfo();                                                   </span>
<span class="-3246065580716586601" onmouseenter="enter('-3246065580716586601');" onmouseout="out('-3246065580716586601');" style=""> 100                 fieldInfo.setTable(tableName);                                                           </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 101                 fieldInfo.setFieldName(fieldName);                                                       </span>
<span  style=""> 102                                                                                                          </span>
<span class="4376905192285837026" onmouseenter="enter('4376905192285837026');" onmouseout="out('4376905192285837026');" style=""> 103                 if (!fieldInfoList.contains(fieldInfo)) {                                                </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 104                     fieldInfoList.add(fieldInfo);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 106             } else {                                                                                     </span>
<span class="2893145864113934715" onmouseenter="enter('2893145864113934715');" onmouseout="out('2893145864113934715');" style=""> 107                 //处理                                                                                     </span>
<span class="-3160769060475159310" onmouseenter="enter('-3160769060475159310');" onmouseout="out('-3160769060475159310');" style=""> 108                 int identifierSize = identifier.names.size();                                            </span>
<span class="5352978315561223025" onmouseenter="enter('5352978315561223025');" onmouseout="out('5352978315561223025');" style=""> 109                 switch (identifierSize) {                                                                </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 110                     case 1:                                                                              </span>
<span class="543169233263070967" onmouseenter="enter('543169233263070967');" onmouseout="out('543169233263070967');" style=""> 111                         throw new RuntimeException(&quot;not support to parse * without scope of table&quot;);     </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 112                     default:                                                                             </span>
<span class="7234102748034848382" onmouseenter="enter('7234102748034848382');" onmouseout="out('7234102748034848382');" style=""> 113                         SqlIdentifier tableIdentify = identifier.skipLast(1);                            </span>
<span class="-7038658933458861113" onmouseenter="enter('-7038658933458861113');" onmouseout="out('-7038658933458861113');" style=""> 114                         Table registerTable = localTableCache.get(tableIdentify.getSimple());            </span>
<span class="-5997676555615328170" onmouseenter="enter('-5997676555615328170');" onmouseout="out('-5997676555615328170');" style=""> 115                         if (registerTable == null) {                                                     </span>
<span class="6481995910302552391" onmouseenter="enter('6481995910302552391');" onmouseout="out('6481995910302552391');" style=""><abbr title=" 116                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimple());"> 116                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimpl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117                         }                                                                                </span>
<span  style=""> 118                                                                                                          </span>
<span class="-4547568303745452703" onmouseenter="enter('-4547568303745452703');" onmouseout="out('-4547568303745452703');" style=""> 119                         String[] fieldNames = registerTable.getSchema().getFieldNames();                 </span>
<span class="-7408478396859326180" onmouseenter="enter('-7408478396859326180');" onmouseout="out('-7408478396859326180');" style=""> 120                         for (String fieldName : fieldNames) {                                            </span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 121                             FieldInfo fieldInfo = new FieldInfo();                                       </span>
<span class="-5561911469151499170" onmouseenter="enter('-5561911469151499170');" onmouseout="out('-5561911469151499170');" style=""> 122                             fieldInfo.setTable(tableIdentify.getSimple());                               </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 123                             fieldInfo.setFieldName(fieldName);                                           </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 124                             fieldInfoList.add(fieldInfo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127             }                                                                                            </span>
<span class="355751622478352774" onmouseenter="enter('355751622478352774');" onmouseout="out('355751622478352774');" style=""> 128         } else if (AGGREGATE.contains(fieldNode.getKind())                                               </span>
<span class="-4728546343803188943" onmouseenter="enter('-4728546343803188943');" onmouseout="out('-4728546343803188943');" style=""> 129                 || AVG_AGG_FUNCTIONS.contains(fieldNode.getKind())                                       </span>
<span class="8973512118577358544" onmouseenter="enter('8973512118577358544');" onmouseout="out('8973512118577358544');" style=""> 130                 || COMPARISON.contains(fieldNode.getKind())                                              </span>
<span class="525772482672043181" onmouseenter="enter('525772482672043181');" onmouseout="out('525772482672043181');" style=""> 131                 || fieldNode.getKind() == OTHER_FUNCTION                                                 </span>
<span class="4987264283847416523" onmouseenter="enter('4987264283847416523');" onmouseout="out('4987264283847416523');" style=""> 132                 || fieldNode.getKind() == DIVIDE                                                         </span>
<span class="-2097459444898035710" onmouseenter="enter('-2097459444898035710');" onmouseout="out('-2097459444898035710');" style=""> 133                 || fieldNode.getKind() == CAST                                                           </span>
<span class="621194935667432352" onmouseenter="enter('621194935667432352');" onmouseout="out('621194935667432352');" style=""> 134                 || fieldNode.getKind() == TRIM                                                           </span>
<span class="5379925649229703360" onmouseenter="enter('5379925649229703360');" onmouseout="out('5379925649229703360');" style=""> 135                 || fieldNode.getKind() == TIMES                                                          </span>
<span class="-4394268980765693723" onmouseenter="enter('-4394268980765693723');" onmouseout="out('-4394268980765693723');" style=""> 136                 || fieldNode.getKind() == PLUS                                                           </span>
<span class="-122938326578311005" onmouseenter="enter('-122938326578311005');" onmouseout="out('-122938326578311005');" style=""> 137                 || fieldNode.getKind() == NOT_IN                                                         </span>
<span class="5635148239693374504" onmouseenter="enter('5635148239693374504');" onmouseout="out('5635148239693374504');" style=""> 138                 || fieldNode.getKind() == OR                                                             </span>
<span class="-3217339780873839086" onmouseenter="enter('-3217339780873839086');" onmouseout="out('-3217339780873839086');" style=""> 139                 || fieldNode.getKind() == AND                                                            </span>
<span class="2162998824653848637" onmouseenter="enter('2162998824653848637');" onmouseout="out('2162998824653848637');" style=""> 140                 || fieldNode.getKind() == MINUS                                                          </span>
<span class="-506664053077300680" onmouseenter="enter('-506664053077300680');" onmouseout="out('-506664053077300680');" style=""> 141                 || fieldNode.getKind() == TUMBLE                                                         </span>
<span class="-1822630894260242331" onmouseenter="enter('-1822630894260242331');" onmouseout="out('-1822630894260242331');" style=""> 142                 || fieldNode.getKind() == TUMBLE_START                                                   </span>
<span class="-8086489575650543701" onmouseenter="enter('-8086489575650543701');" onmouseout="out('-8086489575650543701');" style=""> 143                 || fieldNode.getKind() == TUMBLE_END                                                     </span>
<span class="-2609834003874905006" onmouseenter="enter('-2609834003874905006');" onmouseout="out('-2609834003874905006');" style=""> 144                 || fieldNode.getKind() == SESSION                                                        </span>
<span class="6623716356682835746" onmouseenter="enter('6623716356682835746');" onmouseout="out('6623716356682835746');" style=""> 145                 || fieldNode.getKind() == SESSION_START                                                  </span>
<span class="-4356389762844455169" onmouseenter="enter('-4356389762844455169');" onmouseout="out('-4356389762844455169');" style=""> 146                 || fieldNode.getKind() == SESSION_END                                                    </span>
<span class="3788231826671768229" onmouseenter="enter('3788231826671768229');" onmouseout="out('3788231826671768229');" style=""> 147                 || fieldNode.getKind() == HOP                                                            </span>
<span class="6798204869770216275" onmouseenter="enter('6798204869770216275');" onmouseout="out('6798204869770216275');" style=""> 148                 || fieldNode.getKind() == HOP_START                                                      </span>
<span class="250318287045370196" onmouseenter="enter('250318287045370196');" onmouseout="out('250318287045370196');" style=""> 149                 || fieldNode.getKind() == HOP_END                                                        </span>
<span class="9109972257207472540" onmouseenter="enter('9109972257207472540');" onmouseout="out('9109972257207472540');" style=""> 150                 || fieldNode.getKind() == BETWEEN                                                        </span>
<span class="6983217744831152908" onmouseenter="enter('6983217744831152908');" onmouseout="out('6983217744831152908');" style=""> 151                 || fieldNode.getKind() == IS_NULL                                                        </span>
<span class="-1122161678078794235" onmouseenter="enter('-1122161678078794235');" onmouseout="out('-1122161678078794235');" style=""> 152                 || fieldNode.getKind() == IS_NOT_NULL                                                    </span>
<span class="-3733427582644132679" onmouseenter="enter('-3733427582644132679');" onmouseout="out('-3733427582644132679');" style=""> 153                 || fieldNode.getKind() == CONTAINS                                                       </span>
<span class="-9056199605453305302" onmouseenter="enter('-9056199605453305302');" onmouseout="out('-9056199605453305302');" style=""> 154                 || fieldNode.getKind() == TIMESTAMP_ADD                                                  </span>
<span class="-134492662313070004" onmouseenter="enter('-134492662313070004');" onmouseout="out('-134492662313070004');" style=""> 155                 || fieldNode.getKind() == TIMESTAMP_DIFF                                                 </span>
<span class="6146091325000099373" onmouseenter="enter('6146091325000099373');" onmouseout="out('6146091325000099373');" style=""> 156                 || fieldNode.getKind() == LIKE                                                           </span>
<span class="4953146235532857216" onmouseenter="enter('4953146235532857216');" onmouseout="out('4953146235532857216');" style=""> 157                 || fieldNode.getKind() == COALESCE                                                       </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 158                 ) {                                                                                      </span>
<span class="-354400113971550997" onmouseenter="enter('-354400113971550997');" onmouseout="out('-354400113971550997');" style=""> 159             SqlBasicCall sqlBasicCall = (SqlBasicCall) fieldNode;                                        </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 160             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 161                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 162                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 163                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                 }                                                                                        </span>
<span  style=""> 165                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 166                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 167                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168                 }                                                                                        </span>
<span class="-5978367516025835425" onmouseenter="enter('-5978367516025835425');" onmouseout="out('-5978367516025835425');" style=""> 169                 extractSelectFieldToFieldInfo(sqlNode, fromNode, fieldInfoList, localTableCache);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170             }                                                                                            </span>
<span class="-3590348607861839793" onmouseenter="enter('-3590348607861839793');" onmouseout="out('-3590348607861839793');" style=""> 171         } else if (fieldNode.getKind() == AS) {                                                          </span>
<span class="3703210587199661065" onmouseenter="enter('3703210587199661065');" onmouseout="out('3703210587199661065');" style=""> 172             SqlNode leftNode = ((SqlBasicCall) fieldNode).getOperands()[0];                              </span>
<span class="-2607912045389455868" onmouseenter="enter('-2607912045389455868');" onmouseout="out('-2607912045389455868');" style=""> 173             extractSelectFieldToFieldInfo(leftNode, fromNode,fieldInfoList, localTableCache);            </span>
<span class="-3651943351416933315" onmouseenter="enter('-3651943351416933315');" onmouseout="out('-3651943351416933315');" style=""> 174         } else if (fieldNode.getKind() == CASE) {                                                        </span>
<span class="7184861900726949901" onmouseenter="enter('7184861900726949901');" onmouseout="out('7184861900726949901');" style=""> 175             SqlCase sqlCase = (SqlCase) fieldNode;                                                       </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 176             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 177             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 178             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 179                                                                                                          </span>
<span class="5804242455667685406" onmouseenter="enter('5804242455667685406');" onmouseout="out('5804242455667685406');" style=""> 180             for (int i = 0; i &lt; whenOperands.size(); i++) {                                              </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 181                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 182                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183             }                                                                                            </span>
<span  style=""> 184                                                                                                          </span>
<span class="-7770933914215809062" onmouseenter="enter('-7770933914215809062');" onmouseout="out('-7770933914215809062');" style=""> 185             for (int i = 0; i &lt; thenOperands.size(); i++) {                                              </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 186                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 187                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span  style=""> 188                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189             }                                                                                            </span>
<span  style=""> 190                                                                                                          </span>
<span class="7029049357943474126" onmouseenter="enter('7029049357943474126');" onmouseout="out('7029049357943474126');" style=""> 191             extractSelectFieldToFieldInfo(elseNode, fromNode, fieldInfoList, localTableCache);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span  style=""> 194                                                                                                          </span>
<span class="-8999074733125454701" onmouseenter="enter('-8999074733125454701');" onmouseout="out('-8999074733125454701');" style=""><abbr title=" 195     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAlias) {"> 195     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAli🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 196         SqlOperator operator = new SqlAsOperator();                                                      </span>
<span  style=""> 197                                                                                                          </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 198         SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                              </span>
<span class="4539692765329264390" onmouseenter="enter('4539692765329264390');" onmouseout="out('4539692765329264390');" style=""> 199         String newTableName = joinInfo.getNewTableName();                                                </span>
<span  style=""> 200                                                                                                          </span>
<span class="6968008278960771315" onmouseenter="enter('6968008278960771315');" onmouseout="out('6968008278960771315');" style=""><abbr title=" 201         String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : joinInfo.getNewTableAlias();"> 201         String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : joinInfo.getNewTableAlias(🔵</abbr></span>
<span  style=""> 202                                                                                                          </span>
<span class="-6474384717461795701" onmouseenter="enter('-6474384717461795701');" onmouseout="out('-6474384717461795701');" style=""> 203         if (null == sqlNode0) {                                                                          </span>
<span class="-6562061848026015753" onmouseenter="enter('-6562061848026015753');" onmouseout="out('-6562061848026015753');" style=""> 204             sqlNode0 = new SqlIdentifier(newTableName, null, sqlParserPos);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span  style=""> 206                                                                                                          </span>
<span class="-2821647309854503598" onmouseenter="enter('-2821647309854503598');" onmouseout="out('-2821647309854503598');" style=""> 207         SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(newTableAlias, null, sqlParserPos);         </span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 208         SqlNode[] sqlNodes = new SqlNode[2];                                                             </span>
<span class="-7781715169306512157" onmouseenter="enter('-7781715169306512157');" onmouseout="out('-7781715169306512157');" style=""> 209         sqlNodes[0] = sqlNode0;                                                                          </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 210         sqlNodes[1] = sqlIdentifierAlias;                                                                </span>
<span class="-1928364106966605511" onmouseenter="enter('-1928364106966605511');" onmouseout="out('-1928364106966605511');" style=""> 211         return new SqlBasicCall(operator, sqlNodes, sqlParserPos);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212     }                                                                                                    </span>
<span  style=""> 213                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 214     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 215      *                                                                                                   </span>
<span class="-6040909485639107572" onmouseenter="enter('-6040909485639107572');" onmouseout="out('-6040909485639107572');" style=""> 216      * @param joinInfo                                                                                   </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 217      * @param sqlNode                                                                                    </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 218      * @param queueInfo                                                                                  </span>
<span class="-8382295939765334869" onmouseenter="enter('-8382295939765334869');" onmouseout="out('-8382295939765334869');" style=""> 219      * @return   两个边关联后的新表表名                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 220      */                                                                                                  </span>
<span class="-9105373632393246263" onmouseenter="enter('-9105373632393246263');" onmouseout="out('-9105373632393246263');" style=""><abbr title=" 221     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInfo) {"> 221     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt;🔵</abbr></span>
<span class="-3012154526429275078" onmouseenter="enter('-3012154526429275078');" onmouseout="out('-3012154526429275078');" style=""> 222         //SideJoinInfo rename                                                                            </span>
<span class="4973038183558270709" onmouseenter="enter('4973038183558270709');" onmouseout="out('4973038183558270709');" style=""> 223         if (joinInfo.checkIsSide()) {                                                                    </span>
<span class="8408112480551688226" onmouseenter="enter('8408112480551688226');" onmouseout="out('8408112480551688226');" style=""> 224             joinInfo.setSelectFields(sqlNode.getSelectList());                                           </span>
<span class="4794732995049884760" onmouseenter="enter('4794732995049884760');" onmouseout="out('4794732995049884760');" style=""> 225             joinInfo.setSelectNode(sqlNode);                                                             </span>
<span class="1448684309320227021" onmouseenter="enter('1448684309320227021');" onmouseout="out('1448684309320227021');" style=""> 226             if (joinInfo.isRightIsSideTable()) {                                                         </span>
<span class="-476802833010893550" onmouseenter="enter('-476802833010893550');" onmouseout="out('-476802833010893550');" style=""> 227                 //Analyzing left is not a simple table                                                   </span>
<span class="6867568634948481821" onmouseenter="enter('6867568634948481821');" onmouseout="out('6867568634948481821');" style=""> 228                 if (joinInfo.getLeftNode().getKind() == SELECT) {                                        </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 229                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230                 }                                                                                        </span>
<span  style=""> 231                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 232                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 233             } else {                                                                                     </span>
<span class="5635813491573439188" onmouseenter="enter('5635813491573439188');" onmouseout="out('5635813491573439188');" style=""> 234                 //Determining right is not a simple table                                                </span>
<span class="2468473214053427731" onmouseenter="enter('2468473214053427731');" onmouseout="out('2468473214053427731');" style=""> 235                 if (joinInfo.getRightNode().getKind() == SELECT) {                                       </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 236                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237                 }                                                                                        </span>
<span  style=""> 238                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 239                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240             }                                                                                            </span>
<span class="-7933690095328677787" onmouseenter="enter('-7933690095328677787');" onmouseout="out('-7933690095328677787');" style=""> 241             replaceFromNodeForJoin(joinInfo, sqlNode);                                                   </span>
<span class="-3213976632367322289" onmouseenter="enter('-3213976632367322289');" onmouseout="out('-3213976632367322289');" style=""> 242             return joinInfo.getNewTableName();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 244         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245     }                                                                                                    </span>
<span  style=""> 246                                                                                                          </span>
<span class="8074977299710029932" onmouseenter="enter('8074977299710029932');" onmouseout="out('8074977299710029932');" style=""> 247     public static void replaceFromNodeForJoin(JoinInfo joinInfo, SqlSelect sqlNode) {                    </span>
<span class="-9060489602533315077" onmouseenter="enter('-9060489602533315077');" onmouseout="out('-9060489602533315077');" style=""> 248         //Update from node                                                                               </span>
<span class="2204164800083526508" onmouseenter="enter('2204164800083526508');" onmouseout="out('2204164800083526508');" style=""> 249         SqlBasicCall sqlBasicCall = buildAsNodeByJoinInfo(joinInfo, null, null);                         </span>
<span class="-8082788431941340980" onmouseenter="enter('-8082788431941340980');" onmouseout="out('-8082788431941340980');" style=""> 250         String newAliasName = sqlBasicCall.operand(1).toString();                                        </span>
<span  style=""> 251                                                                                                          </span>
<span class="-4706120631660601296" onmouseenter="enter('-4706120631660601296');" onmouseout="out('-4706120631660601296');" style=""> 252         //替换select 中的属性为新的表名称和字段                                                                         </span>
<span class="8210217038029633734" onmouseenter="enter('8210217038029633734');" onmouseout="out('8210217038029633734');" style=""> 253         HashBasedTable&lt;String, String, String&gt; fieldMapping = joinInfo.getTableFieldRef();               </span>
<span class="-6200687028928637107" onmouseenter="enter('-6200687028928637107');" onmouseout="out('-6200687028928637107');" style=""> 254         Map&lt;String, String&gt; leftFieldMapping = fieldMapping.row(joinInfo.getLeftTableAlias());           </span>
<span class="6534080411824570705" onmouseenter="enter('6534080411824570705');" onmouseout="out('6534080411824570705');" style=""> 255         Map&lt;String, String&gt; rightFieldMapping = fieldMapping.row(joinInfo.getRightTableAlias());         </span>
<span  style=""> 256                                                                                                          </span>
<span class="-7880903214764896195" onmouseenter="enter('-7880903214764896195');" onmouseout="out('-7880903214764896195');" style=""> 257        /* for(SqlNode oneSelectNode : sqlNode.getSelectList()){                                          </span>
<span class="-4957689359258588920" onmouseenter="enter('-4957689359258588920');" onmouseout="out('-4957689359258588920');" style=""><abbr title=" 258             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapping);"> 258             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,left🔵</abbr></span>
<span class="6269709593519335658" onmouseenter="enter('6269709593519335658');" onmouseout="out('6269709593519335658');" style=""><abbr title=" 259             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldMapping);"> 259             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , ri🔵</abbr></span>
<span class="-2684617365274670769" onmouseenter="enter('-2684617365274670769');" onmouseout="out('-2684617365274670769');" style=""> 260         }*/                                                                                              </span>
<span  style=""> 261                                                                                                          </span>
<span class="2103765898996250551" onmouseenter="enter('2103765898996250551');" onmouseout="out('2103765898996250551');" style=""> 262         //where中的条件属性为新的表名称和字段                                                                           </span>
<span class="1856147124472045117" onmouseenter="enter('1856147124472045117');" onmouseout="out('1856147124472045117');" style=""><abbr title=" 263         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldMapping);"> 263         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldM🔵</abbr></span>
<span class="5021450334630795014" onmouseenter="enter('5021450334630795014');" onmouseout="out('5021450334630795014');" style=""><abbr title=" 264         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping);"> 264         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFiel🔵</abbr></span>
<span class="2813845980666839305" onmouseenter="enter('2813845980666839305');" onmouseout="out('2813845980666839305');" style=""> 265         sqlNode.setFrom(sqlBasicCall);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span  style=""> 267                                                                                                          </span>
<span  style=""> 268                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269     /**                                                                                                  </span>
<span class="-9165896841480454412" onmouseenter="enter('-9165896841480454412');" onmouseout="out('-9165896841480454412');" style=""> 270      * 获取节点关联的查询表                                                                                        </span>
<span class="4587700153042038306" onmouseenter="enter('4587700153042038306');" onmouseout="out('4587700153042038306');" style=""> 271      * @param fromTable                                                                                  </span>
<span class="-4525819317820325084" onmouseenter="enter('-4525819317820325084');" onmouseout="out('-4525819317820325084');" style=""> 272      * @param tableNameSet                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 273      */                                                                                                  </span>
<span class="-6773005969473787299" onmouseenter="enter('-6773005969473787299');" onmouseout="out('-6773005969473787299');" style=""> 274     public static void getFromTableInfo(SqlNode fromTable, Set&lt;String&gt; tableNameSet){                    </span>
<span class="-6901511047628253115" onmouseenter="enter('-6901511047628253115');" onmouseout="out('-6901511047628253115');" style=""> 275         SqlKind sqlKind = fromTable.getKind();                                                           </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 276         switch (sqlKind){                                                                                </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 277             case AS:                                                                                     </span>
<span class="6170293684489173764" onmouseenter="enter('6170293684489173764');" onmouseout="out('6170293684489173764');" style=""> 278                 SqlNode alias = ((SqlBasicCall) fromTable).getOperands()[1];                             </span>
<span class="-4660347064811459637" onmouseenter="enter('-4660347064811459637');" onmouseout="out('-4660347064811459637');" style=""> 279                 tableNameSet.add(alias.toString());                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 280                 return;                                                                                  </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 281             case JOIN:                                                                                   </span>
<span class="7200443719768955748" onmouseenter="enter('7200443719768955748');" onmouseout="out('7200443719768955748');" style=""> 282                 getFromTableInfo(((SqlJoin)fromTable).getLeft(), tableNameSet);                          </span>
<span class="-579883461259105749" onmouseenter="enter('-579883461259105749');" onmouseout="out('-579883461259105749');" style=""> 283                 getFromTableInfo(((SqlJoin)fromTable).getRight(), tableNameSet);                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 284                 return;                                                                                  </span>
<span class="-2304009782660987725" onmouseenter="enter('-2304009782660987725');" onmouseout="out('-2304009782660987725');" style=""> 285             case IDENTIFIER:                                                                             </span>
<span class="6063930725080162048" onmouseenter="enter('6063930725080162048');" onmouseout="out('6063930725080162048');" style=""> 286                 tableNameSet.add(((SqlIdentifier)fromTable).getSimple());                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 287                 return;                                                                                  </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 288             case SELECT:                                                                                 </span>
<span class="4670049027501902925" onmouseenter="enter('4670049027501902925');" onmouseout="out('4670049027501902925');" style=""> 289                 getFromTableInfo(((SqlSelect) fromTable).getFrom(), tableNameSet);                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 290                 return;                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 291             default:                                                                                     </span>
<span class="9006089180628885729" onmouseenter="enter('9006089180628885729');" onmouseout="out('9006089180628885729');" style=""> 292                 throw new RuntimeException(&quot;not support sqlKind:&quot; + sqlKind);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 296     /**                                                                                                  </span>
<span class="8536034367776161836" onmouseenter="enter('8536034367776161836');" onmouseout="out('8536034367776161836');" style=""> 297      * 替换select 中的字段信息                                                                                   </span>
<span class="8563350786440524200" onmouseenter="enter('8563350786440524200');" onmouseout="out('8563350786440524200');" style=""> 298      * 如果mappingTable 非空则从该参数获取字段的映射                                                                     </span>
<span class="-6581838769493343810" onmouseenter="enter('-6581838769493343810');" onmouseout="out('-6581838769493343810');" style=""> 299      * 如果mappingTable 为空则根据是否存在新生成字段                                                                     </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 300      * @param selectNode                                                                                 </span>
<span class="-2283388782413973238" onmouseenter="enter('-2283388782413973238');" onmouseout="out('-2283388782413973238');" style=""> 301      * @param oldTbName                                                                                  </span>
<span class="7634289987105314089" onmouseenter="enter('7634289987105314089');" onmouseout="out('7634289987105314089');" style=""> 302      * @param newTbName                                                                                  </span>
<span class="8769527040545279755" onmouseenter="enter('8769527040545279755');" onmouseout="out('8769527040545279755');" style=""> 303      * @param fieldReplaceRef                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 304      */                                                                                                  </span>
<span class="5027529910148445847" onmouseenter="enter('5027529910148445847');" onmouseout="out('5027529910148445847');" style=""> 305     public static void replaceSelectFieldTable(SqlNode selectNode,                                       </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 306                                                String oldTbName,                                         </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 307                                                String newTbName,                                         </span>
<span class="7882147930720524356" onmouseenter="enter('7882147930720524356');" onmouseout="out('7882147930720524356');" style=""> 308                                                HashBiMap&lt;String, String&gt; fieldReplaceRef) {              </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 309         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 310             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-4674775763706954352" onmouseenter="enter('-4674775763706954352');" onmouseout="out('-4674775763706954352');" style=""> 311             replaceSelectFieldTable(leftNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 313         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 314             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 315                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 316             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-1755167016071657820" onmouseenter="enter('-1755167016071657820');" onmouseout="out('-1755167016071657820');" style=""> 317                 return ;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318             }                                                                                            </span>
<span  style=""> 319                                                                                                          </span>
<span class="1355631215618064105" onmouseenter="enter('1355631215618064105');" onmouseout="out('1355631215618064105');" style=""> 320             String fieldTableName = sqlIdentifier.names.get(0);                                          </span>
<span class="-2979536462712829146" onmouseenter="enter('-2979536462712829146');" onmouseout="out('-2979536462712829146');" style=""> 321             if(oldTbName.equalsIgnoreCase(fieldTableName)){                                              </span>
<span class="-4556037184452828083" onmouseenter="enter('-4556037184452828083');" onmouseout="out('-4556037184452828083');" style=""> 322                 replaceOneSelectField(sqlIdentifier, newTbName, oldTbName, fieldReplaceRef);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span  style=""> 324                                                                                                          </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 325         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 326             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 327         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 328                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 329                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 330                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 331                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 332                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 333                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 334                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 335                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 336                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 337                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 338                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 339                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 340                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 341                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 342                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 343                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 344                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 345                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 346                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 347                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 348                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 349                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 350                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 351                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 352                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 353                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 354                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 355                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 356                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 357                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 358         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 359             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 360             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 361                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 362                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 363                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364                 }                                                                                        </span>
<span  style=""> 365                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 366                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 367                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368                 }                                                                                        </span>
<span  style=""> 369                                                                                                          </span>
<span class="-5676526903547679293" onmouseenter="enter('-5676526903547679293');" onmouseout="out('-5676526903547679293');" style=""> 370                 replaceSelectFieldTable(sqlNode, oldTbName, newTbName, fieldReplaceRef);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371             }                                                                                            </span>
<span  style=""> 372                                                                                                          </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 373         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 374             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 375             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 376             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 377             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 378                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 379             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 380                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 381                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382             }                                                                                            </span>
<span  style=""> 383                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 384             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 385                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 386                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span  style=""> 387                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388             }                                                                                            </span>
<span  style=""> 389                                                                                                          </span>
<span class="-7763620435664145090" onmouseenter="enter('-7763620435664145090');" onmouseout="out('-7763620435664145090');" style=""> 390             replaceSelectFieldTable(elseNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 391         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 392             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 393             return;                                                                                      </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 394         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 395             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 395             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397     }                                                                                                    </span>
<span  style=""> 398                                                                                                          </span>
<span class="-8462314785940972235" onmouseenter="enter('-8462314785940972235');" onmouseout="out('-8462314785940972235');" style=""> 399     private static void replaceOneSelectField(SqlIdentifier sqlIdentifier,                               </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 400                                               String newTbName,                                          </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 401                                               String oldTbName,                                          </span>
<span class="-123666790994587736" onmouseenter="enter('-123666790994587736');" onmouseout="out('-123666790994587736');" style=""> 402                                               HashBiMap&lt;String, String&gt; fieldReplaceRef){                </span>
<span class="5409837540655806029" onmouseenter="enter('5409837540655806029');" onmouseout="out('5409837540655806029');" style=""> 403         SqlIdentifier newField = sqlIdentifier.setName(0, newTbName);                                    </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 404         String fieldName = sqlIdentifier.names.get(1);                                                   </span>
<span class="383429695235202001" onmouseenter="enter('383429695235202001');" onmouseout="out('383429695235202001');" style=""> 405         String fieldKey = oldTbName + &quot;_&quot; + fieldName;                                                   </span>
<span  style=""> 406                                                                                                          </span>
<span class="-6721872198205274351" onmouseenter="enter('-6721872198205274351');" onmouseout="out('-6721872198205274351');" style=""> 407         if(!fieldReplaceRef.containsKey(fieldKey)){                                                      </span>
<span class="-8417061839432085011" onmouseenter="enter('-8417061839432085011');" onmouseout="out('-8417061839432085011');" style=""> 408             if(fieldReplaceRef.inverse().get(fieldName) != null){                                        </span>
<span class="3563776056422158867" onmouseenter="enter('3563776056422158867');" onmouseout="out('3563776056422158867');" style=""> 409                 //换一个名字                                                                                  </span>
<span class="6269694230999482502" onmouseenter="enter('6269694230999482502');" onmouseout="out('6269694230999482502');" style=""> 410                 String mappingFieldName = ParseUtils.dealDuplicateFieldName(fieldReplaceRef, fieldName); </span>
<span class="730243385989967976" onmouseenter="enter('730243385989967976');" onmouseout="out('730243385989967976');" style=""> 411                 newField = newField.setName(1, mappingFieldName);                                        </span>
<span class="-8843946047709268866" onmouseenter="enter('-8843946047709268866');" onmouseout="out('-8843946047709268866');" style=""> 412                 fieldReplaceRef.put(fieldKey, mappingFieldName);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413             } else {                                                                                     </span>
<span class="8037669429324652271" onmouseenter="enter('8037669429324652271');" onmouseout="out('8037669429324652271');" style=""> 414                 fieldReplaceRef.put(fieldKey, fieldName);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415             }                                                                                            </span>
<span class="-6497049907687009769" onmouseenter="enter('-6497049907687009769');" onmouseout="out('-6497049907687009769');" style=""> 416         }else {                                                                                          </span>
<span class="-8559329898165326450" onmouseenter="enter('-8559329898165326450');" onmouseout="out('-8559329898165326450');" style=""> 417             newField = newField.setName(1, fieldReplaceRef.get(fieldKey));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418         }                                                                                                </span>
<span  style=""> 419                                                                                                          </span>
<span class="-3197795073308056747" onmouseenter="enter('-3197795073308056747');" onmouseout="out('-3197795073308056747');" style=""> 420         sqlIdentifier.assignNamesFrom(newField);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 423     /**                                                                                                  </span>
<span class="5461903081523405406" onmouseenter="enter('5461903081523405406');" onmouseout="out('5461903081523405406');" style=""> 424      * 替换另外join 表的指定表名为新关联处理的表名称                                                                         </span>
<span class="-4160812560585701802" onmouseenter="enter('-4160812560585701802');" onmouseout="out('-4160812560585701802');" style=""> 425      * @param condition                                                                                  </span>
<span class="-653368829907055509" onmouseenter="enter('-653368829907055509');" onmouseout="out('-653368829907055509');" style=""> 426      * @param oldTabFieldRefNew                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 427      */                                                                                                  </span>
<span class="3319102281402941993" onmouseenter="enter('3319102281402941993');" onmouseout="out('3319102281402941993');" style=""><abbr title=" 428     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRefNew){"> 428     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRef🔵</abbr></span>
<span class="5716706160133851170" onmouseenter="enter('5716706160133851170');" onmouseout="out('5716706160133851170');" style=""> 429         if (null == condition || condition.getKind() == LITERAL) {                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 430             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span class="5418896256960850645" onmouseenter="enter('5418896256960850645');" onmouseout="out('5418896256960850645');" style=""> 432         SqlKind joinKind = condition.getKind();                                                          </span>
<span class="-872109993356374898" onmouseenter="enter('-872109993356374898');" onmouseout="out('-872109993356374898');" style=""> 433         if( AGGREGATE.contains(joinKind)                                                                 </span>
<span class="6718918766222840749" onmouseenter="enter('6718918766222840749');" onmouseout="out('6718918766222840749');" style=""> 434                 || AVG_AGG_FUNCTIONS.contains(joinKind)                                                  </span>
<span class="-5795763144400386668" onmouseenter="enter('-5795763144400386668');" onmouseout="out('-5795763144400386668');" style=""> 435                 || COMPARISON.contains(joinKind)                                                         </span>
<span class="-8649262116164241163" onmouseenter="enter('-8649262116164241163');" onmouseout="out('-8649262116164241163');" style=""> 436                 || joinKind == OTHER_FUNCTION                                                            </span>
<span class="-5055598318919357044" onmouseenter="enter('-5055598318919357044');" onmouseout="out('-5055598318919357044');" style=""> 437                 || joinKind == DIVIDE                                                                    </span>
<span class="-5590854516630695190" onmouseenter="enter('-5590854516630695190');" onmouseout="out('-5590854516630695190');" style=""> 438                 || joinKind == CAST                                                                      </span>
<span class="-4942353295577364183" onmouseenter="enter('-4942353295577364183');" onmouseout="out('-4942353295577364183');" style=""> 439                 || joinKind == TRIM                                                                      </span>
<span class="3915078205687144262" onmouseenter="enter('3915078205687144262');" onmouseout="out('3915078205687144262');" style=""> 440                 || joinKind == TIMES                                                                     </span>
<span class="-1723358202983235773" onmouseenter="enter('-1723358202983235773');" onmouseout="out('-1723358202983235773');" style=""> 441                 || joinKind == PLUS                                                                      </span>
<span class="-5069307841224953084" onmouseenter="enter('-5069307841224953084');" onmouseout="out('-5069307841224953084');" style=""> 442                 || joinKind == NOT_IN                                                                    </span>
<span class="-2425336955836765254" onmouseenter="enter('-2425336955836765254');" onmouseout="out('-2425336955836765254');" style=""> 443                 || joinKind == OR                                                                        </span>
<span class="4152669671898758851" onmouseenter="enter('4152669671898758851');" onmouseout="out('4152669671898758851');" style=""> 444                 || joinKind == AND                                                                       </span>
<span class="8469231591142723332" onmouseenter="enter('8469231591142723332');" onmouseout="out('8469231591142723332');" style=""> 445                 || joinKind == MINUS                                                                     </span>
<span class="-8975416296405207931" onmouseenter="enter('-8975416296405207931');" onmouseout="out('-8975416296405207931');" style=""> 446                 || joinKind == TUMBLE                                                                    </span>
<span class="-2000447344068332492" onmouseenter="enter('-2000447344068332492');" onmouseout="out('-2000447344068332492');" style=""> 447                 || joinKind == TUMBLE_START                                                              </span>
<span class="-2660655228869248711" onmouseenter="enter('-2660655228869248711');" onmouseout="out('-2660655228869248711');" style=""> 448                 || joinKind == TUMBLE_END                                                                </span>
<span class="611140839719638142" onmouseenter="enter('611140839719638142');" onmouseout="out('611140839719638142');" style=""> 449                 || joinKind == SESSION                                                                   </span>
<span class="-4719587108970880084" onmouseenter="enter('-4719587108970880084');" onmouseout="out('-4719587108970880084');" style=""> 450                 || joinKind == SESSION_START                                                             </span>
<span class="-8416806901357633870" onmouseenter="enter('-8416806901357633870');" onmouseout="out('-8416806901357633870');" style=""> 451                 || joinKind == SESSION_END                                                               </span>
<span class="1350987570876390511" onmouseenter="enter('1350987570876390511');" onmouseout="out('1350987570876390511');" style=""> 452                 || joinKind == HOP                                                                       </span>
<span class="-1881854797876652455" onmouseenter="enter('-1881854797876652455');" onmouseout="out('-1881854797876652455');" style=""> 453                 || joinKind == HOP_START                                                                 </span>
<span class="8861207018381483306" onmouseenter="enter('8861207018381483306');" onmouseout="out('8861207018381483306');" style=""> 454                 || joinKind == HOP_END                                                                   </span>
<span class="-8001520670756666177" onmouseenter="enter('-8001520670756666177');" onmouseout="out('-8001520670756666177');" style=""> 455                 || joinKind == BETWEEN                                                                   </span>
<span class="-8652641138853954718" onmouseenter="enter('-8652641138853954718');" onmouseout="out('-8652641138853954718');" style=""> 456                 || joinKind == IS_NULL                                                                   </span>
<span class="-3447385425080227914" onmouseenter="enter('-3447385425080227914');" onmouseout="out('-3447385425080227914');" style=""> 457                 || joinKind == IS_NOT_NULL                                                               </span>
<span class="-7170411514740971639" onmouseenter="enter('-7170411514740971639');" onmouseout="out('-7170411514740971639');" style=""> 458                 || joinKind == CONTAINS                                                                  </span>
<span class="2023943706482563039" onmouseenter="enter('2023943706482563039');" onmouseout="out('2023943706482563039');" style=""> 459                 || joinKind == TIMESTAMP_ADD                                                             </span>
<span class="-2326108897925880210" onmouseenter="enter('-2326108897925880210');" onmouseout="out('-2326108897925880210');" style=""> 460                 || joinKind == TIMESTAMP_DIFF                                                            </span>
<span class="-853383041741207972" onmouseenter="enter('-853383041741207972');" onmouseout="out('-853383041741207972');" style=""> 461                 || joinKind == LIKE                                                                      </span>
<span class="6751598071686393893" onmouseenter="enter('6751598071686393893');" onmouseout="out('6751598071686393893');" style=""> 462                 || joinKind == COALESCE                                                                  </span>
<span class="-6635050181630823497" onmouseenter="enter('-6635050181630823497');" onmouseout="out('-6635050181630823497');" style=""> 463                 || joinKind == EQUALS ){                                                                 </span>
<span  style=""> 464                                                                                                          </span>
<span class="-2541170249719279546" onmouseenter="enter('-2541170249719279546');" onmouseout="out('-2541170249719279546');" style=""> 465             SqlBasicCall sqlBasicCall = (SqlBasicCall) condition;                                        </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 466             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 467                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 468                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 469                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470                 }                                                                                        </span>
<span  style=""> 471                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 472                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 473                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                 }                                                                                        </span>
<span  style=""> 475                                                                                                          </span>
<span class="9093647197598049539" onmouseenter="enter('9093647197598049539');" onmouseout="out('9093647197598049539');" style=""> 476                 replaceJoinFieldRefTableName(sqlNode, oldTabFieldRefNew);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477             }                                                                                            </span>
<span  style=""> 478                                                                                                          </span>
<span class="-3321512503468929771" onmouseenter="enter('-3321512503468929771');" onmouseout="out('-3321512503468929771');" style=""> 479         } else if (condition.getKind() == IDENTIFIER) {                                                  </span>
<span class="3421902236901684905" onmouseenter="enter('3421902236901684905');" onmouseout="out('3421902236901684905');" style=""><abbr title=" 480             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format table.field&quot;);"> 480             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must b🔵</abbr></span>
<span class="5832438568991919450" onmouseenter="enter('5832438568991919450');" onmouseout="out('5832438568991919450');" style=""> 481             String fieldRefTable = ((SqlIdentifier)condition).names.get(0);                              </span>
<span  style=""> 482                                                                                                          </span>
<span class="8100744064870187141" onmouseenter="enter('8100744064870187141');" onmouseout="out('8100744064870187141');" style=""><abbr title=" 483             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString());"> 483             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString()🔵</abbr></span>
<span  style=""> 484                                                                                                          </span>
<span class="8753124522689816475" onmouseenter="enter('8753124522689816475');" onmouseout="out('8753124522689816475');" style=""> 485             if(StringUtils.isNotBlank(targetFieldName)){                                                 </span>
<span class="549628471692842965" onmouseenter="enter('549628471692842965');" onmouseout="out('549628471692842965');" style=""> 486                 String[] fieldSplits = StringUtils.split(targetFieldName, &quot;.&quot;);                          </span>
<span class="-4590973079341848831" onmouseenter="enter('-4590973079341848831');" onmouseout="out('-4590973079341848831');" style=""> 487                 SqlIdentifier newField = ((SqlIdentifier)condition).setName(0, fieldSplits[0]);          </span>
<span class="-2128195046647686450" onmouseenter="enter('-2128195046647686450');" onmouseout="out('-2128195046647686450');" style=""> 488                 newField = newField.setName(1, fieldSplits[1]);                                          </span>
<span class="3184949241141894727" onmouseenter="enter('3184949241141894727');" onmouseout="out('3184949241141894727');" style=""> 489                 ((SqlIdentifier)condition).assignNamesFrom(newField);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="2909357842222016806" onmouseenter="enter('2909357842222016806');" onmouseout="out('2909357842222016806');" style=""> 494     public static String getTargetRefTable(Map&lt;String, String&gt; refTableMap, String tableName){           </span>
<span class="8928515954503116985" onmouseenter="enter('8928515954503116985');" onmouseout="out('8928515954503116985');" style=""> 495         String targetTableName = null;                                                                   </span>
<span class="-7988911072327938473" onmouseenter="enter('-7988911072327938473');" onmouseout="out('-7988911072327938473');" style=""> 496         String preTableName;                                                                             </span>
<span  style=""> 497                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 498         do {                                                                                             </span>
<span class="-8410406414279039842" onmouseenter="enter('-8410406414279039842');" onmouseout="out('-8410406414279039842');" style=""> 499             preTableName = targetTableName == null ? tableName : targetTableName;                        </span>
<span class="-6937575046812844068" onmouseenter="enter('-6937575046812844068');" onmouseout="out('-6937575046812844068');" style=""> 500             targetTableName = refTableMap.get(preTableName);                                             </span>
<span class="2145360151323546808" onmouseenter="enter('2145360151323546808');" onmouseout="out('2145360151323546808');" style=""> 501         } while (targetTableName != null);                                                               </span>
<span  style=""> 502                                                                                                          </span>
<span class="-2669935656864379097" onmouseenter="enter('-2669935656864379097');" onmouseout="out('-2669935656864379097');" style=""> 503         return preTableName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504     }                                                                                                    </span>
<span  style=""> 505                                                                                                          </span>
<span class="4252776571232827033" onmouseenter="enter('4252776571232827033');" onmouseout="out('4252776571232827033');" style=""> 506     public static String getTargetRefField(Map&lt;String, String&gt; refFieldMap, String currFieldName){       </span>
<span class="7313268804655149758" onmouseenter="enter('7313268804655149758');" onmouseout="out('7313268804655149758');" style=""> 507         String targetFieldName = null;                                                                   </span>
<span class="-8203442755027339079" onmouseenter="enter('-8203442755027339079');" onmouseout="out('-8203442755027339079');" style=""> 508         String preFieldName;                                                                             </span>
<span  style=""> 509                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 510         do {                                                                                             </span>
<span class="5385129689109669577" onmouseenter="enter('5385129689109669577');" onmouseout="out('5385129689109669577');" style=""> 511             preFieldName = targetFieldName == null ? currFieldName : targetFieldName;                    </span>
<span class="-3091793637238102945" onmouseenter="enter('-3091793637238102945');" onmouseout="out('-3091793637238102945');" style=""> 512             targetFieldName = refFieldMap.get(preFieldName);                                             </span>
<span class="-8916552568071022335" onmouseenter="enter('-8916552568071022335');" onmouseout="out('-8916552568071022335');" style=""> 513         } while (targetFieldName != null);                                                               </span>
<span  style=""> 514                                                                                                          </span>
<span class="5199537743604417658" onmouseenter="enter('5199537743604417658');" onmouseout="out('5199537743604417658');" style=""> 515         return preFieldName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516     }                                                                                                    </span>
<span  style=""> 517                                                                                                          </span>
<span class="-8300425435366196840" onmouseenter="enter('-8300425435366196840');" onmouseout="out('-8300425435366196840');" style=""><abbr title=" 518     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef){"> 518     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, Has🔵</abbr></span>
<span  style=""> 519                                                                                                          </span>
<span class="-7344361739038630250" onmouseenter="enter('-7344361739038630250');" onmouseout="out('-7344361739038630250');" style=""> 520         if(parentWhere == null){                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 521             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522         }                                                                                                </span>
<span  style=""> 523                                                                                                          </span>
<span class="7198030462908925381" onmouseenter="enter('7198030462908925381');" onmouseout="out('7198030462908925381');" style=""> 524         SqlKind kind = parentWhere.getKind();                                                            </span>
<span class="-1872623569752802183" onmouseenter="enter('-1872623569752802183');" onmouseout="out('-1872623569752802183');" style=""> 525         if(kind == AND){                                                                                 </span>
<span class="2829943023301943879" onmouseenter="enter('2829943023301943879');" onmouseout="out('2829943023301943879');" style=""><abbr title=" 526             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplaceRef);"> 526             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fi🔵</abbr></span>
<span class="-4556945615844132104" onmouseenter="enter('-4556945615844132104');" onmouseout="out('-4556945615844132104');" style=""><abbr title=" 527             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplaceRef);"> 527             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fi🔵</abbr></span>
<span  style=""> 528                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 529         } else {                                                                                         </span>
<span class="8766459294285823468" onmouseenter="enter('8766459294285823468');" onmouseout="out('8766459294285823468');" style=""> 530             replaceConditionNode(parentWhere, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532     }                                                                                                    </span>
<span  style=""> 533                                                                                                          </span>
<span class="7802005378818510825" onmouseenter="enter('7802005378818510825');" onmouseout="out('7802005378818510825');" style=""><abbr title=" 534     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef) {"> 534     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, Hash🔵</abbr></span>
<span class="8405601494998756480" onmouseenter="enter('8405601494998756480');" onmouseout="out('8405601494998756480');" style=""> 535         if(selectNode.getKind() == IDENTIFIER){                                                          </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 536             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 537                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 538             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 539                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540             }                                                                                            </span>
<span  style=""> 541                                                                                                          </span>
<span class="318397782816978051" onmouseenter="enter('318397782816978051');" onmouseout="out('318397782816978051');" style=""> 542             String tableName = sqlIdentifier.names.asList().get(0);                                      </span>
<span class="5268132787378326987" onmouseenter="enter('5268132787378326987');" onmouseout="out('5268132787378326987');" style=""> 543             String tableField = sqlIdentifier.names.asList().get(1);                                     </span>
<span class="-2565165445763658517" onmouseenter="enter('-2565165445763658517');" onmouseout="out('-2565165445763658517');" style=""> 544             String fieldKey = tableName + &quot;_&quot; + tableField;                                              </span>
<span  style=""> 545                                                                                                          </span>
<span class="-3841275234863465094" onmouseenter="enter('-3841275234863465094');" onmouseout="out('-3841275234863465094');" style=""> 546             if(tableName.equalsIgnoreCase(oldTbName)){                                                   </span>
<span  style=""> 547                                                                                                          </span>
<span class="-7486276484118623043" onmouseenter="enter('-7486276484118623043');" onmouseout="out('-7486276484118623043');" style=""><abbr title=" 548                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fieldKey);"> 548                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRe🔵</abbr></span>
<span class="-85150012511262136" onmouseenter="enter('-85150012511262136');" onmouseout="out('-85150012511262136');" style=""> 549                 SqlIdentifier newField = ((SqlIdentifier)selectNode).setName(0, newTbName);              </span>
<span class="-3325104965504513825" onmouseenter="enter('-3325104965504513825');" onmouseout="out('-3325104965504513825');" style=""> 550                 newField = newField.setName(1, newFieldName);                                            </span>
<span class="-7494318194999571350" onmouseenter="enter('-7494318194999571350');" onmouseout="out('-7494318194999571350');" style=""> 551                 ((SqlIdentifier)selectNode).assignNamesFrom(newField);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 553             return;                                                                                      </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 554         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 555             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 556         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 557                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 558                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 559                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 560                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 561                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 562                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 563                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 564                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 565                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 566                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 567                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 568                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 569                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 570                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 571                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 572                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 573                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 574                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 575                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 576                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 577                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 578                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 579                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 580                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 581                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 582                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 583                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 584                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 585                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 586                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 587         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 588             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 589             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 590                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 591                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 592                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593                 }                                                                                        </span>
<span  style=""> 594                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 595                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 596                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597                 }                                                                                        </span>
<span  style=""> 598                                                                                                          </span>
<span class="-2258996485445817623" onmouseenter="enter('-2258996485445817623');" onmouseout="out('-2258996485445817623');" style=""> 599                 replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600             }                                                                                            </span>
<span  style=""> 601                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 602             return;                                                                                      </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 603         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 604             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 605             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 606         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 607             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 608                                                                                                          </span>
<span class="-2315512384759132147" onmouseenter="enter('-2315512384759132147');" onmouseout="out('-2315512384759132147');" style=""><abbr title=" 609             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 609             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-1345654988953747553" onmouseenter="enter('-1345654988953747553');" onmouseout="out('-1345654988953747553');" style=""><abbr title=" 610             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 610             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-7836146409865535589" onmouseenter="enter('-7836146409865535589');" onmouseout="out('-7836146409865535589');" style=""> 611             replaceConditionNode(sqlCase.getElseOperand(), oldTbName, newTbName, fieldReplaceRef);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 612         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 613             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 613             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615     }                                                                                                    </span>
<span  style=""> 616                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 617     /**                                                                                                  </span>
<span class="1570055177673011707" onmouseenter="enter('1570055177673011707');" onmouseout="out('1570055177673011707');" style=""> 618      * 获取条件中关联的表信息                                                                                       </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 619      * @param selectNode                                                                                 </span>
<span class="-4813798938110383556" onmouseenter="enter('-4813798938110383556');" onmouseout="out('-4813798938110383556');" style=""> 620      * @param fieldInfos                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 621      */                                                                                                  </span>
<span class="7137057397975985823" onmouseenter="enter('7137057397975985823');" onmouseout="out('7137057397975985823');" style=""> 622     public static void getConditionRefTable(SqlNode selectNode, Set&lt;String&gt; fieldInfos) {                </span>
<span class="-3454817955506608063" onmouseenter="enter('-3454817955506608063');" onmouseout="out('-3454817955506608063');" style=""> 623         if (selectNode.getKind() == IDENTIFIER) {                                                        </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 624             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 625                                                                                                          </span>
<span class="380773342968557196" onmouseenter="enter('380773342968557196');" onmouseout="out('380773342968557196');" style=""> 626             fieldInfos.add(sqlIdentifier.toString());                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 627             return;                                                                                      </span>
<span class="6757358046968148413" onmouseenter="enter('6757358046968148413');" onmouseout="out('6757358046968148413');" style=""> 628         } else if (selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN) {//字面含义     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 629             return;                                                                                      </span>
<span class="-4023999264561783968" onmouseenter="enter('-4023999264561783968');" onmouseout="out('-4023999264561783968');" style=""> 630         } else if (AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 631                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 632                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 633                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 634                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 635                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 636                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 637                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 638                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 639                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 640                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 641                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 642                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 643                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 644                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 645                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 646                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 647                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 648                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 649                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 650                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 651                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 652                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 653                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 654                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 655                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 656                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 657                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 658                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 659                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 660                                                                                                          </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 661                 ) {                                                                                      </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 662             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 663             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 664                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 665                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 666                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667                 }                                                                                        </span>
<span  style=""> 668                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 669                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 670                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671                 }                                                                                        </span>
<span  style=""> 672                                                                                                          </span>
<span class="56198544928191592" onmouseenter="enter('56198544928191592');" onmouseout="out('56198544928191592');" style=""> 673                 getConditionRefTable(sqlNode, fieldInfos);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674             }                                                                                            </span>
<span  style=""> 675                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 676             return;                                                                                      </span>
<span class="-2308646561142794789" onmouseenter="enter('-2308646561142794789');" onmouseout="out('-2308646561142794789');" style=""> 677         } else if (selectNode.getKind() == OTHER) {                                                      </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 678             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 679             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 680         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 681             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 682                                                                                                          </span>
<span class="-3537580079884591293" onmouseenter="enter('-3537580079884591293');" onmouseout="out('-3537580079884591293');" style=""><abbr title=" 683             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 683             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="2144257116225237462" onmouseenter="enter('2144257116225237462');" onmouseout="out('2144257116225237462');" style=""><abbr title=" 684             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 684             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="-5604248574568658683" onmouseenter="enter('-5604248574568658683');" onmouseout="out('-5604248574568658683');" style=""> 685             getConditionRefTable(sqlCase.getElseOperand(), fieldInfos);                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 686         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 687             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 687             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689     }                                                                                                    </span>
<span  style=""> 690                                                                                                          </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style=""> 691     public static String buildTableField(String tableName, String fieldName){                            </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style=""> 692         return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693     }                                                                                                    </span>
<span  style=""> 694                                                                                                          </span>
<span  style=""> 695                                                                                                          </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style=""> 696     public static String buildTableNameWithScope(String tableName, String scope){                        </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style=""> 697         if(StringUtils.isEmpty(scope)){                                                                  </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 698             return tableName;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 699         }                                                                                                </span>
<span  style=""> 700                                                                                                          </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style=""> 701         return tableName + &quot;_&quot; + scope;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702     }                                                                                                    </span>
<span  style=""> 703                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 704 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 705     /**                                                                                                  </span>
<span class="6497150561674133661" onmouseenter="enter('6497150561674133661');" onmouseout="out('6497150561674133661');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 706      * add constant join fields, using in such as hbase、redis etc kv database                            </span>
<span class="-8477144116998604047" onmouseenter="enter('-8477144116998604047');" onmouseout="out('-8477144116998604047');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 707      * @param keyMap                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 708      */                                                                                                  </span>
<span class="7525620767750394099" onmouseenter="enter('7525620767750394099');" onmouseout="out('7525620767750394099');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 709     public static void addConstant(Map&lt;String, Object&gt; keyMap, AbstractSideTableInfo sideTableInfo) {    </span>
<span class="3178460372749787756" onmouseenter="enter('3178460372749787756');" onmouseout="out('3178460372749787756');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 710         List&lt;PredicateInfo&gt; predicateInfos = sideTableInfo.getPredicateInfoes();                         </span>
<span class="-6183321864643515167" onmouseenter="enter('-6183321864643515167');" onmouseout="out('-6183321864643515167');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 711         final String name = sideTableInfo.getName();                                                     </span>
<span class="7309058727137890263" onmouseenter="enter('7309058727137890263');" onmouseout="out('7309058727137890263');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 712         for (PredicateInfo info : predicateInfos) {                                                      </span>
<span class="2363297685674950976" onmouseenter="enter('2363297685674950976');" onmouseout="out('2363297685674950976');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 713             if (info.getOwnerTable().equals(name)                                                        </span>
<span class="-1265448967873634704" onmouseenter="enter('-1265448967873634704');" onmouseout="out('-1265448967873634704');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 714                 &amp;&amp; info.getOperatorName().equals(&quot;=&quot;)) {                                                 </span>
<span class="-3488992775588585467" onmouseenter="enter('-3488992775588585467');" onmouseout="out('-3488992775588585467');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 715                 String condition = info.getCondition();                                                  </span>
<span class="-3376001444363563672" onmouseenter="enter('-3376001444363563672');" onmouseout="out('-3376001444363563672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 716                 Matcher matcher = stringPattern.matcher(condition);                                      </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 717                 if (matcher.matches()) {                                                                 </span>
<span class="2819616911838313283" onmouseenter="enter('2819616911838313283');" onmouseout="out('2819616911838313283');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 718                     condition = condition.substring(1, condition.length() - 1);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 719                 }                                                                                        </span>
<span class="-2333073189429870453" onmouseenter="enter('-2333073189429870453');" onmouseout="out('-2333073189429870453');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 720                 keyMap.put(info.getFieldName(), condition);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 721             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 722         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 723     }                                                                                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 724 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 725     public static String buildTableField(String tableName, String fieldName){                            </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 726         return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 727     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 728                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 729                                                                                                          </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 730     public static String buildTableNameWithScope(String tableName, String scope){                        </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 731         if(StringUtils.isEmpty(scope)){                                                                  </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 732             return tableName;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 733         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 734                                                                                                          </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 735         return tableName + &quot;_&quot; + scope;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 736     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 737                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 738 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 739 =======                                                                                                  </span>
<span class="290962191185636260" onmouseenter="enter('290962191185636260');" onmouseout="out('290962191185636260');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 740     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String rightTableName, String scope, Set&lt;String&gt; existTableNames){"> 740     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String righ🔵</abbr></span>
<span class="2401839376205144968" onmouseenter="enter('2401839376205144968');" onmouseout="out('2401839376205144968');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741         //兼容左边表是as 的情况                                                                                   </span>
<span class="2644250892879979113" onmouseenter="enter('2644250892879979113');" onmouseout="out('2644250892879979113');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742         String leftStr = Strings.isNullOrEmpty(leftTableName) ? leftTableAlias : leftTableName;          </span>
<span class="4940999328154746374" onmouseenter="enter('4940999328154746374');" onmouseout="out('4940999328154746374');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743         String newName = leftStr + &quot;_&quot; + rightTableName;                                                 </span>
<span class="-8657233487191077119" onmouseenter="enter('-8657233487191077119');" onmouseout="out('-8657233487191077119');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744         if (CollectionUtils.isEmpty(existTableNames)) {                                                  </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 745             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                                                                                                          </span>
<span class="-234751792023525655" onmouseenter="enter('-234751792023525655');" onmouseout="out('-234751792023525655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748         if (!existTableNames.contains(newName)) {                                                        </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                                                                                                          </span>
<span class="6366820324978801292" onmouseenter="enter('6366820324978801292');" onmouseout="out('6366820324978801292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752         return TableUtils.buildTableNameWithScope(newName, scope) + &quot;_&quot; + System.currentTimeMillis();    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 754                                                                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 755 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 756 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  20 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  21                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  22 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  23 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  24 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">  25 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  26 import com.google.common.base.Preconditions;                                                             </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  27 import com.google.common.base.Strings;                                                                   </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  28 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  29 import com.google.common.collect.HashBiMap;                                                              </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  30 import com.google.common.collect.Lists;                                                                  </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  31 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  32 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  33 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  34 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  35 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  36 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  37 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  38 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  39 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  40 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  41 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  42 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  43 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  44 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  45 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  46 import org.apache.flink.table.api.Table;                                                                 </span>
<span  style="">  47                                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  48 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  49 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  50 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  51 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  52 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  53 import java.util.regex.Pattern;                                                                          </span>
<span  style="">  54                                                                                                          </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  55 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span class="511836661302622038" onmouseenter="enter('511836661302622038');" onmouseout="out('511836661302622038');" style="">  56 import static org.apache.calcite.sql.SqlKind.CASE;                                                       </span>
<span class="178844392791952204" onmouseenter="enter('178844392791952204');" onmouseout="out('178844392791952204');" style="">  57 import static org.apache.calcite.sql.SqlKind.OTHER;                                                      </span>
<span  style="">  58                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59 /**                                                                                                      </span>
<span class="2491900718050250190" onmouseenter="enter('2491900718050250190');" onmouseout="out('2491900718050250190');" style="">  60  * 表的解析相关                                                                                                </span>
<span class="-831295595380638887" onmouseenter="enter('-831295595380638887');" onmouseout="out('-831295595380638887');" style="">  61  * Date: 2020/2/17                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  62  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  63  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64  */                                                                                                      </span>
<span  style="">  65                                                                                                          </span>
<span class="-5515152307095787287" onmouseenter="enter('-5515152307095787287');" onmouseout="out('-5515152307095787287');" style="">  66 public class TableUtils {                                                                                </span>
<span  style="">  67                                                                                                          </span>
<span class="6670707421612748000" onmouseenter="enter('6670707421612748000');" onmouseout="out('6670707421612748000');" style="">  68     public static final char SPLIT = &#x27;_&#x27;;                                                                </span>
<span class="-3060398288124517436" onmouseenter="enter('-3060398288124517436');" onmouseout="out('-3060398288124517436');" style="">  69     public static final Pattern stringPattern = Pattern.compile(&quot;\&quot;.*?\&quot;|\&#x27;.*?\&#x27;&quot;);                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70     /**                                                                                                  </span>
<span class="-3835139450942807208" onmouseenter="enter('-3835139450942807208');" onmouseout="out('-3835139450942807208');" style="">  71      * 获取select 的字段                                                                                      </span>
<span class="-592626010544206006" onmouseenter="enter('-592626010544206006');" onmouseout="out('-592626010544206006');" style="">  72      * @param sqlSelect                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73      */                                                                                                  </span>
<span class="-662197916250462065" onmouseenter="enter('-662197916250462065');" onmouseout="out('-662197916250462065');" style=""><abbr title="  74     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCache){">  74     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCac🔵</abbr></span>
<span class="8036786023408828043" onmouseenter="enter('8036786023408828043');" onmouseout="out('8036786023408828043');" style="">  75         SqlNodeList sqlNodeList = sqlSelect.getSelectList();                                             </span>
<span class="-3054172495871960241" onmouseenter="enter('-3054172495871960241');" onmouseout="out('-3054172495871960241');" style="">  76         List&lt;FieldInfo&gt; fieldInfoList = Lists.newArrayList();                                            </span>
<span class="-839692389379732251" onmouseenter="enter('-839692389379732251');" onmouseout="out('-839692389379732251');" style="">  77         String fromNode = sqlSelect.getFrom().toString();                                                </span>
<span  style="">  78                                                                                                          </span>
<span class="2162301537633635938" onmouseenter="enter('2162301537633635938');" onmouseout="out('2162301537633635938');" style="">  79         for (SqlNode fieldNode : sqlNodeList.getList()) {                                                </span>
<span class="1465841598931987040" onmouseenter="enter('1465841598931987040');" onmouseout="out('1465841598931987040');" style="">  80             extractSelectFieldToFieldInfo(fieldNode,fromNode,fieldInfoList,localTableCache);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81         }                                                                                                </span>
<span  style="">  82                                                                                                          </span>
<span class="1335352475287465914" onmouseenter="enter('1335352475287465914');" onmouseout="out('1335352475287465914');" style="">  83         return fieldInfoList;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  86     /**                                                                                                  </span>
<span class="-6805611089677825770" onmouseenter="enter('-6805611089677825770');" onmouseout="out('-6805611089677825770');" style="">  87      *  解析select Node 提取FieldInfo                                                                        </span>
<span class="697554033229417632" onmouseenter="enter('697554033229417632');" onmouseout="out('697554033229417632');" style="">  88      * @param fieldNode                                                                                  </span>
<span class="-1719315088034482430" onmouseenter="enter('-1719315088034482430');" onmouseout="out('-1719315088034482430');" style="">  89      * @param fromNode                                                                                   </span>
<span class="8898190159008473723" onmouseenter="enter('8898190159008473723');" onmouseout="out('8898190159008473723');" style="">  90      * @param fieldInfoList                                                                              </span>
<span class="-2613125561450459797" onmouseenter="enter('-2613125561450459797');" onmouseout="out('-2613125561450459797');" style="">  91      * @param localTableCache                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92      */                                                                                                  </span>
<span class="911398554884375981" onmouseenter="enter('911398554884375981');" onmouseout="out('911398554884375981');" style=""><abbr title="  93     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfoList, Map&lt;String, Table&gt; localTableCache) {">  93     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; 🔵</abbr></span>
<span class="8336572539967602309" onmouseenter="enter('8336572539967602309');" onmouseout="out('8336572539967602309');" style="">  94         if (fieldNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="2728418029840045752" onmouseenter="enter('2728418029840045752');" onmouseout="out('2728418029840045752');" style="">  95             SqlIdentifier identifier = (SqlIdentifier) fieldNode;                                        </span>
<span class="-5519378359901478287" onmouseenter="enter('-5519378359901478287');" onmouseout="out('-5519378359901478287');" style="">  96             if (!identifier.isStar()) {                                                                  </span>
<span class="7382398262726877456" onmouseenter="enter('7382398262726877456');" onmouseout="out('7382398262726877456');" style=""><abbr title="  97                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple();">  97                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).g🔵</abbr></span>
<span class="-4078369372891740310" onmouseenter="enter('-4078369372891740310');" onmouseout="out('-4078369372891740310');" style=""><abbr title="  98                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identifier.getComponent(1).getSimple();">  98                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() 🔵</abbr></span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style="">  99                 FieldInfo fieldInfo = new FieldInfo();                                                   </span>
<span class="-3246065580716586601" onmouseenter="enter('-3246065580716586601');" onmouseout="out('-3246065580716586601');" style=""> 100                 fieldInfo.setTable(tableName);                                                           </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 101                 fieldInfo.setFieldName(fieldName);                                                       </span>
<span  style=""> 102                                                                                                          </span>
<span class="4376905192285837026" onmouseenter="enter('4376905192285837026');" onmouseout="out('4376905192285837026');" style=""> 103                 if (!fieldInfoList.contains(fieldInfo)) {                                                </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 104                     fieldInfoList.add(fieldInfo);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 106             } else {                                                                                     </span>
<span class="2893145864113934715" onmouseenter="enter('2893145864113934715');" onmouseout="out('2893145864113934715');" style=""> 107                 //处理                                                                                     </span>
<span class="-3160769060475159310" onmouseenter="enter('-3160769060475159310');" onmouseout="out('-3160769060475159310');" style=""> 108                 int identifierSize = identifier.names.size();                                            </span>
<span class="5352978315561223025" onmouseenter="enter('5352978315561223025');" onmouseout="out('5352978315561223025');" style=""> 109                 switch (identifierSize) {                                                                </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 110                     case 1:                                                                              </span>
<span class="543169233263070967" onmouseenter="enter('543169233263070967');" onmouseout="out('543169233263070967');" style=""> 111                         throw new RuntimeException(&quot;not support to parse * without scope of table&quot;);     </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 112                     default:                                                                             </span>
<span class="7234102748034848382" onmouseenter="enter('7234102748034848382');" onmouseout="out('7234102748034848382');" style=""> 113                         SqlIdentifier tableIdentify = identifier.skipLast(1);                            </span>
<span class="-7038658933458861113" onmouseenter="enter('-7038658933458861113');" onmouseout="out('-7038658933458861113');" style=""> 114                         Table registerTable = localTableCache.get(tableIdentify.getSimple());            </span>
<span class="-5997676555615328170" onmouseenter="enter('-5997676555615328170');" onmouseout="out('-5997676555615328170');" style=""> 115                         if (registerTable == null) {                                                     </span>
<span class="6481995910302552391" onmouseenter="enter('6481995910302552391');" onmouseout="out('6481995910302552391');" style=""><abbr title=" 116                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimple());"> 116                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimpl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117                         }                                                                                </span>
<span  style=""> 118                                                                                                          </span>
<span class="-4547568303745452703" onmouseenter="enter('-4547568303745452703');" onmouseout="out('-4547568303745452703');" style=""> 119                         String[] fieldNames = registerTable.getSchema().getFieldNames();                 </span>
<span class="-7408478396859326180" onmouseenter="enter('-7408478396859326180');" onmouseout="out('-7408478396859326180');" style=""> 120                         for (String fieldName : fieldNames) {                                            </span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 121                             FieldInfo fieldInfo = new FieldInfo();                                       </span>
<span class="-5561911469151499170" onmouseenter="enter('-5561911469151499170');" onmouseout="out('-5561911469151499170');" style=""> 122                             fieldInfo.setTable(tableIdentify.getSimple());                               </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 123                             fieldInfo.setFieldName(fieldName);                                           </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 124                             fieldInfoList.add(fieldInfo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127             }                                                                                            </span>
<span class="355751622478352774" onmouseenter="enter('355751622478352774');" onmouseout="out('355751622478352774');" style=""> 128         } else if (AGGREGATE.contains(fieldNode.getKind())                                               </span>
<span class="-4728546343803188943" onmouseenter="enter('-4728546343803188943');" onmouseout="out('-4728546343803188943');" style=""> 129                 || AVG_AGG_FUNCTIONS.contains(fieldNode.getKind())                                       </span>
<span class="8973512118577358544" onmouseenter="enter('8973512118577358544');" onmouseout="out('8973512118577358544');" style=""> 130                 || COMPARISON.contains(fieldNode.getKind())                                              </span>
<span class="525772482672043181" onmouseenter="enter('525772482672043181');" onmouseout="out('525772482672043181');" style=""> 131                 || fieldNode.getKind() == OTHER_FUNCTION                                                 </span>
<span class="4987264283847416523" onmouseenter="enter('4987264283847416523');" onmouseout="out('4987264283847416523');" style=""> 132                 || fieldNode.getKind() == DIVIDE                                                         </span>
<span class="-2097459444898035710" onmouseenter="enter('-2097459444898035710');" onmouseout="out('-2097459444898035710');" style=""> 133                 || fieldNode.getKind() == CAST                                                           </span>
<span class="621194935667432352" onmouseenter="enter('621194935667432352');" onmouseout="out('621194935667432352');" style=""> 134                 || fieldNode.getKind() == TRIM                                                           </span>
<span class="5379925649229703360" onmouseenter="enter('5379925649229703360');" onmouseout="out('5379925649229703360');" style=""> 135                 || fieldNode.getKind() == TIMES                                                          </span>
<span class="-4394268980765693723" onmouseenter="enter('-4394268980765693723');" onmouseout="out('-4394268980765693723');" style=""> 136                 || fieldNode.getKind() == PLUS                                                           </span>
<span class="-122938326578311005" onmouseenter="enter('-122938326578311005');" onmouseout="out('-122938326578311005');" style=""> 137                 || fieldNode.getKind() == NOT_IN                                                         </span>
<span class="5635148239693374504" onmouseenter="enter('5635148239693374504');" onmouseout="out('5635148239693374504');" style=""> 138                 || fieldNode.getKind() == OR                                                             </span>
<span class="-3217339780873839086" onmouseenter="enter('-3217339780873839086');" onmouseout="out('-3217339780873839086');" style=""> 139                 || fieldNode.getKind() == AND                                                            </span>
<span class="2162998824653848637" onmouseenter="enter('2162998824653848637');" onmouseout="out('2162998824653848637');" style=""> 140                 || fieldNode.getKind() == MINUS                                                          </span>
<span class="-506664053077300680" onmouseenter="enter('-506664053077300680');" onmouseout="out('-506664053077300680');" style=""> 141                 || fieldNode.getKind() == TUMBLE                                                         </span>
<span class="-1822630894260242331" onmouseenter="enter('-1822630894260242331');" onmouseout="out('-1822630894260242331');" style=""> 142                 || fieldNode.getKind() == TUMBLE_START                                                   </span>
<span class="-8086489575650543701" onmouseenter="enter('-8086489575650543701');" onmouseout="out('-8086489575650543701');" style=""> 143                 || fieldNode.getKind() == TUMBLE_END                                                     </span>
<span class="-2609834003874905006" onmouseenter="enter('-2609834003874905006');" onmouseout="out('-2609834003874905006');" style=""> 144                 || fieldNode.getKind() == SESSION                                                        </span>
<span class="6623716356682835746" onmouseenter="enter('6623716356682835746');" onmouseout="out('6623716356682835746');" style=""> 145                 || fieldNode.getKind() == SESSION_START                                                  </span>
<span class="-4356389762844455169" onmouseenter="enter('-4356389762844455169');" onmouseout="out('-4356389762844455169');" style=""> 146                 || fieldNode.getKind() == SESSION_END                                                    </span>
<span class="3788231826671768229" onmouseenter="enter('3788231826671768229');" onmouseout="out('3788231826671768229');" style=""> 147                 || fieldNode.getKind() == HOP                                                            </span>
<span class="6798204869770216275" onmouseenter="enter('6798204869770216275');" onmouseout="out('6798204869770216275');" style=""> 148                 || fieldNode.getKind() == HOP_START                                                      </span>
<span class="250318287045370196" onmouseenter="enter('250318287045370196');" onmouseout="out('250318287045370196');" style=""> 149                 || fieldNode.getKind() == HOP_END                                                        </span>
<span class="9109972257207472540" onmouseenter="enter('9109972257207472540');" onmouseout="out('9109972257207472540');" style=""> 150                 || fieldNode.getKind() == BETWEEN                                                        </span>
<span class="6983217744831152908" onmouseenter="enter('6983217744831152908');" onmouseout="out('6983217744831152908');" style=""> 151                 || fieldNode.getKind() == IS_NULL                                                        </span>
<span class="-1122161678078794235" onmouseenter="enter('-1122161678078794235');" onmouseout="out('-1122161678078794235');" style=""> 152                 || fieldNode.getKind() == IS_NOT_NULL                                                    </span>
<span class="-3733427582644132679" onmouseenter="enter('-3733427582644132679');" onmouseout="out('-3733427582644132679');" style=""> 153                 || fieldNode.getKind() == CONTAINS                                                       </span>
<span class="-9056199605453305302" onmouseenter="enter('-9056199605453305302');" onmouseout="out('-9056199605453305302');" style=""> 154                 || fieldNode.getKind() == TIMESTAMP_ADD                                                  </span>
<span class="-134492662313070004" onmouseenter="enter('-134492662313070004');" onmouseout="out('-134492662313070004');" style=""> 155                 || fieldNode.getKind() == TIMESTAMP_DIFF                                                 </span>
<span class="6146091325000099373" onmouseenter="enter('6146091325000099373');" onmouseout="out('6146091325000099373');" style=""> 156                 || fieldNode.getKind() == LIKE                                                           </span>
<span class="4953146235532857216" onmouseenter="enter('4953146235532857216');" onmouseout="out('4953146235532857216');" style=""> 157                 || fieldNode.getKind() == COALESCE                                                       </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 158                 ) {                                                                                      </span>
<span class="-354400113971550997" onmouseenter="enter('-354400113971550997');" onmouseout="out('-354400113971550997');" style=""> 159             SqlBasicCall sqlBasicCall = (SqlBasicCall) fieldNode;                                        </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 160             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 161                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 162                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 163                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                 }                                                                                        </span>
<span  style=""> 165                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 166                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 167                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168                 }                                                                                        </span>
<span class="-5978367516025835425" onmouseenter="enter('-5978367516025835425');" onmouseout="out('-5978367516025835425');" style=""> 169                 extractSelectFieldToFieldInfo(sqlNode, fromNode, fieldInfoList, localTableCache);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170             }                                                                                            </span>
<span class="-3590348607861839793" onmouseenter="enter('-3590348607861839793');" onmouseout="out('-3590348607861839793');" style=""> 171         } else if (fieldNode.getKind() == AS) {                                                          </span>
<span class="3703210587199661065" onmouseenter="enter('3703210587199661065');" onmouseout="out('3703210587199661065');" style=""> 172             SqlNode leftNode = ((SqlBasicCall) fieldNode).getOperands()[0];                              </span>
<span class="-2607912045389455868" onmouseenter="enter('-2607912045389455868');" onmouseout="out('-2607912045389455868');" style=""> 173             extractSelectFieldToFieldInfo(leftNode, fromNode,fieldInfoList, localTableCache);            </span>
<span class="-3651943351416933315" onmouseenter="enter('-3651943351416933315');" onmouseout="out('-3651943351416933315');" style=""> 174         } else if (fieldNode.getKind() == CASE) {                                                        </span>
<span class="7184861900726949901" onmouseenter="enter('7184861900726949901');" onmouseout="out('7184861900726949901');" style=""> 175             SqlCase sqlCase = (SqlCase) fieldNode;                                                       </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 176             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 177             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 178             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 179                                                                                                          </span>
<span class="5804242455667685406" onmouseenter="enter('5804242455667685406');" onmouseout="out('5804242455667685406');" style=""> 180             for (int i = 0; i &lt; whenOperands.size(); i++) {                                              </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 181                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 182                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183             }                                                                                            </span>
<span  style=""> 184                                                                                                          </span>
<span class="-7770933914215809062" onmouseenter="enter('-7770933914215809062');" onmouseout="out('-7770933914215809062');" style=""> 185             for (int i = 0; i &lt; thenOperands.size(); i++) {                                              </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 186                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 187                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span  style=""> 188                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189             }                                                                                            </span>
<span  style=""> 190                                                                                                          </span>
<span class="7029049357943474126" onmouseenter="enter('7029049357943474126');" onmouseout="out('7029049357943474126');" style=""> 191             extractSelectFieldToFieldInfo(elseNode, fromNode, fieldInfoList, localTableCache);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span  style=""> 194                                                                                                          </span>
<span class="-8999074733125454701" onmouseenter="enter('-8999074733125454701');" onmouseout="out('-8999074733125454701');" style=""><abbr title=" 195     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAlias) {"> 195     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAli🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 196         SqlOperator operator = new SqlAsOperator();                                                      </span>
<span  style=""> 197                                                                                                          </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 198         SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                              </span>
<span class="4539692765329264390" onmouseenter="enter('4539692765329264390');" onmouseout="out('4539692765329264390');" style=""> 199         String newTableName = joinInfo.getNewTableName();                                                </span>
<span  style=""> 200                                                                                                          </span>
<span class="6968008278960771315" onmouseenter="enter('6968008278960771315');" onmouseout="out('6968008278960771315');" style=""><abbr title=" 201         String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : joinInfo.getNewTableAlias();"> 201         String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : joinInfo.getNewTableAlias(🔵</abbr></span>
<span  style=""> 202                                                                                                          </span>
<span class="-6474384717461795701" onmouseenter="enter('-6474384717461795701');" onmouseout="out('-6474384717461795701');" style=""> 203         if (null == sqlNode0) {                                                                          </span>
<span class="-6562061848026015753" onmouseenter="enter('-6562061848026015753');" onmouseout="out('-6562061848026015753');" style=""> 204             sqlNode0 = new SqlIdentifier(newTableName, null, sqlParserPos);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span  style=""> 206                                                                                                          </span>
<span class="-2821647309854503598" onmouseenter="enter('-2821647309854503598');" onmouseout="out('-2821647309854503598');" style=""> 207         SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(newTableAlias, null, sqlParserPos);         </span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 208         SqlNode[] sqlNodes = new SqlNode[2];                                                             </span>
<span class="-7781715169306512157" onmouseenter="enter('-7781715169306512157');" onmouseout="out('-7781715169306512157');" style=""> 209         sqlNodes[0] = sqlNode0;                                                                          </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 210         sqlNodes[1] = sqlIdentifierAlias;                                                                </span>
<span class="-1928364106966605511" onmouseenter="enter('-1928364106966605511');" onmouseout="out('-1928364106966605511');" style=""> 211         return new SqlBasicCall(operator, sqlNodes, sqlParserPos);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212     }                                                                                                    </span>
<span  style=""> 213                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 214     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 215      *                                                                                                   </span>
<span class="-6040909485639107572" onmouseenter="enter('-6040909485639107572');" onmouseout="out('-6040909485639107572');" style=""> 216      * @param joinInfo                                                                                   </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 217      * @param sqlNode                                                                                    </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 218      * @param queueInfo                                                                                  </span>
<span class="-8382295939765334869" onmouseenter="enter('-8382295939765334869');" onmouseout="out('-8382295939765334869');" style=""> 219      * @return   两个边关联后的新表表名                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 220      */                                                                                                  </span>
<span class="-9105373632393246263" onmouseenter="enter('-9105373632393246263');" onmouseout="out('-9105373632393246263');" style=""><abbr title=" 221     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInfo) {"> 221     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt;🔵</abbr></span>
<span class="-3012154526429275078" onmouseenter="enter('-3012154526429275078');" onmouseout="out('-3012154526429275078');" style=""> 222         //SideJoinInfo rename                                                                            </span>
<span class="4973038183558270709" onmouseenter="enter('4973038183558270709');" onmouseout="out('4973038183558270709');" style=""> 223         if (joinInfo.checkIsSide()) {                                                                    </span>
<span class="8408112480551688226" onmouseenter="enter('8408112480551688226');" onmouseout="out('8408112480551688226');" style=""> 224             joinInfo.setSelectFields(sqlNode.getSelectList());                                           </span>
<span class="4794732995049884760" onmouseenter="enter('4794732995049884760');" onmouseout="out('4794732995049884760');" style=""> 225             joinInfo.setSelectNode(sqlNode);                                                             </span>
<span class="1448684309320227021" onmouseenter="enter('1448684309320227021');" onmouseout="out('1448684309320227021');" style=""> 226             if (joinInfo.isRightIsSideTable()) {                                                         </span>
<span class="-476802833010893550" onmouseenter="enter('-476802833010893550');" onmouseout="out('-476802833010893550');" style=""> 227                 //Analyzing left is not a simple table                                                   </span>
<span class="6867568634948481821" onmouseenter="enter('6867568634948481821');" onmouseout="out('6867568634948481821');" style=""> 228                 if (joinInfo.getLeftNode().getKind() == SELECT) {                                        </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 229                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230                 }                                                                                        </span>
<span  style=""> 231                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 232                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 233             } else {                                                                                     </span>
<span class="5635813491573439188" onmouseenter="enter('5635813491573439188');" onmouseout="out('5635813491573439188');" style=""> 234                 //Determining right is not a simple table                                                </span>
<span class="2468473214053427731" onmouseenter="enter('2468473214053427731');" onmouseout="out('2468473214053427731');" style=""> 235                 if (joinInfo.getRightNode().getKind() == SELECT) {                                       </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 236                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237                 }                                                                                        </span>
<span  style=""> 238                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 239                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240             }                                                                                            </span>
<span class="-7933690095328677787" onmouseenter="enter('-7933690095328677787');" onmouseout="out('-7933690095328677787');" style=""> 241             replaceFromNodeForJoin(joinInfo, sqlNode);                                                   </span>
<span class="-3213976632367322289" onmouseenter="enter('-3213976632367322289');" onmouseout="out('-3213976632367322289');" style=""> 242             return joinInfo.getNewTableName();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 244         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245     }                                                                                                    </span>
<span  style=""> 246                                                                                                          </span>
<span class="8074977299710029932" onmouseenter="enter('8074977299710029932');" onmouseout="out('8074977299710029932');" style=""> 247     public static void replaceFromNodeForJoin(JoinInfo joinInfo, SqlSelect sqlNode) {                    </span>
<span class="-9060489602533315077" onmouseenter="enter('-9060489602533315077');" onmouseout="out('-9060489602533315077');" style=""> 248         //Update from node                                                                               </span>
<span class="2204164800083526508" onmouseenter="enter('2204164800083526508');" onmouseout="out('2204164800083526508');" style=""> 249         SqlBasicCall sqlBasicCall = buildAsNodeByJoinInfo(joinInfo, null, null);                         </span>
<span class="-8082788431941340980" onmouseenter="enter('-8082788431941340980');" onmouseout="out('-8082788431941340980');" style=""> 250         String newAliasName = sqlBasicCall.operand(1).toString();                                        </span>
<span  style=""> 251                                                                                                          </span>
<span class="-4706120631660601296" onmouseenter="enter('-4706120631660601296');" onmouseout="out('-4706120631660601296');" style=""> 252         //替换select 中的属性为新的表名称和字段                                                                         </span>
<span class="8210217038029633734" onmouseenter="enter('8210217038029633734');" onmouseout="out('8210217038029633734');" style=""> 253         HashBasedTable&lt;String, String, String&gt; fieldMapping = joinInfo.getTableFieldRef();               </span>
<span class="-6200687028928637107" onmouseenter="enter('-6200687028928637107');" onmouseout="out('-6200687028928637107');" style=""> 254         Map&lt;String, String&gt; leftFieldMapping = fieldMapping.row(joinInfo.getLeftTableAlias());           </span>
<span class="6534080411824570705" onmouseenter="enter('6534080411824570705');" onmouseout="out('6534080411824570705');" style=""> 255         Map&lt;String, String&gt; rightFieldMapping = fieldMapping.row(joinInfo.getRightTableAlias());         </span>
<span  style=""> 256                                                                                                          </span>
<span class="-7880903214764896195" onmouseenter="enter('-7880903214764896195');" onmouseout="out('-7880903214764896195');" style=""> 257        /* for(SqlNode oneSelectNode : sqlNode.getSelectList()){                                          </span>
<span class="-4957689359258588920" onmouseenter="enter('-4957689359258588920');" onmouseout="out('-4957689359258588920');" style=""><abbr title=" 258             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapping);"> 258             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,left🔵</abbr></span>
<span class="6269709593519335658" onmouseenter="enter('6269709593519335658');" onmouseout="out('6269709593519335658');" style=""><abbr title=" 259             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldMapping);"> 259             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , ri🔵</abbr></span>
<span class="-2684617365274670769" onmouseenter="enter('-2684617365274670769');" onmouseout="out('-2684617365274670769');" style=""> 260         }*/                                                                                              </span>
<span  style=""> 261                                                                                                          </span>
<span class="2103765898996250551" onmouseenter="enter('2103765898996250551');" onmouseout="out('2103765898996250551');" style=""> 262         //where中的条件属性为新的表名称和字段                                                                           </span>
<span class="1856147124472045117" onmouseenter="enter('1856147124472045117');" onmouseout="out('1856147124472045117');" style=""><abbr title=" 263         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldMapping);"> 263         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldM🔵</abbr></span>
<span class="5021450334630795014" onmouseenter="enter('5021450334630795014');" onmouseout="out('5021450334630795014');" style=""><abbr title=" 264         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping);"> 264         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFiel🔵</abbr></span>
<span class="2813845980666839305" onmouseenter="enter('2813845980666839305');" onmouseout="out('2813845980666839305');" style=""> 265         sqlNode.setFrom(sqlBasicCall);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span  style=""> 267                                                                                                          </span>
<span  style=""> 268                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269     /**                                                                                                  </span>
<span class="-9165896841480454412" onmouseenter="enter('-9165896841480454412');" onmouseout="out('-9165896841480454412');" style=""> 270      * 获取节点关联的查询表                                                                                        </span>
<span class="4587700153042038306" onmouseenter="enter('4587700153042038306');" onmouseout="out('4587700153042038306');" style=""> 271      * @param fromTable                                                                                  </span>
<span class="-4525819317820325084" onmouseenter="enter('-4525819317820325084');" onmouseout="out('-4525819317820325084');" style=""> 272      * @param tableNameSet                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 273      */                                                                                                  </span>
<span class="-6773005969473787299" onmouseenter="enter('-6773005969473787299');" onmouseout="out('-6773005969473787299');" style=""> 274     public static void getFromTableInfo(SqlNode fromTable, Set&lt;String&gt; tableNameSet){                    </span>
<span class="-6901511047628253115" onmouseenter="enter('-6901511047628253115');" onmouseout="out('-6901511047628253115');" style=""> 275         SqlKind sqlKind = fromTable.getKind();                                                           </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 276         switch (sqlKind){                                                                                </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 277             case AS:                                                                                     </span>
<span class="6170293684489173764" onmouseenter="enter('6170293684489173764');" onmouseout="out('6170293684489173764');" style=""> 278                 SqlNode alias = ((SqlBasicCall) fromTable).getOperands()[1];                             </span>
<span class="-4660347064811459637" onmouseenter="enter('-4660347064811459637');" onmouseout="out('-4660347064811459637');" style=""> 279                 tableNameSet.add(alias.toString());                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 280                 return;                                                                                  </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 281             case JOIN:                                                                                   </span>
<span class="7200443719768955748" onmouseenter="enter('7200443719768955748');" onmouseout="out('7200443719768955748');" style=""> 282                 getFromTableInfo(((SqlJoin)fromTable).getLeft(), tableNameSet);                          </span>
<span class="-579883461259105749" onmouseenter="enter('-579883461259105749');" onmouseout="out('-579883461259105749');" style=""> 283                 getFromTableInfo(((SqlJoin)fromTable).getRight(), tableNameSet);                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 284                 return;                                                                                  </span>
<span class="-2304009782660987725" onmouseenter="enter('-2304009782660987725');" onmouseout="out('-2304009782660987725');" style=""> 285             case IDENTIFIER:                                                                             </span>
<span class="6063930725080162048" onmouseenter="enter('6063930725080162048');" onmouseout="out('6063930725080162048');" style=""> 286                 tableNameSet.add(((SqlIdentifier)fromTable).getSimple());                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 287                 return;                                                                                  </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 288             case SELECT:                                                                                 </span>
<span class="4670049027501902925" onmouseenter="enter('4670049027501902925');" onmouseout="out('4670049027501902925');" style=""> 289                 getFromTableInfo(((SqlSelect) fromTable).getFrom(), tableNameSet);                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 290                 return;                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 291             default:                                                                                     </span>
<span class="9006089180628885729" onmouseenter="enter('9006089180628885729');" onmouseout="out('9006089180628885729');" style=""> 292                 throw new RuntimeException(&quot;not support sqlKind:&quot; + sqlKind);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 296     /**                                                                                                  </span>
<span class="8536034367776161836" onmouseenter="enter('8536034367776161836');" onmouseout="out('8536034367776161836');" style=""> 297      * 替换select 中的字段信息                                                                                   </span>
<span class="8563350786440524200" onmouseenter="enter('8563350786440524200');" onmouseout="out('8563350786440524200');" style=""> 298      * 如果mappingTable 非空则从该参数获取字段的映射                                                                     </span>
<span class="-6581838769493343810" onmouseenter="enter('-6581838769493343810');" onmouseout="out('-6581838769493343810');" style=""> 299      * 如果mappingTable 为空则根据是否存在新生成字段                                                                     </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 300      * @param selectNode                                                                                 </span>
<span class="-2283388782413973238" onmouseenter="enter('-2283388782413973238');" onmouseout="out('-2283388782413973238');" style=""> 301      * @param oldTbName                                                                                  </span>
<span class="7634289987105314089" onmouseenter="enter('7634289987105314089');" onmouseout="out('7634289987105314089');" style=""> 302      * @param newTbName                                                                                  </span>
<span class="8769527040545279755" onmouseenter="enter('8769527040545279755');" onmouseout="out('8769527040545279755');" style=""> 303      * @param fieldReplaceRef                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 304      */                                                                                                  </span>
<span class="5027529910148445847" onmouseenter="enter('5027529910148445847');" onmouseout="out('5027529910148445847');" style=""> 305     public static void replaceSelectFieldTable(SqlNode selectNode,                                       </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 306                                                String oldTbName,                                         </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 307                                                String newTbName,                                         </span>
<span class="7882147930720524356" onmouseenter="enter('7882147930720524356');" onmouseout="out('7882147930720524356');" style=""> 308                                                HashBiMap&lt;String, String&gt; fieldReplaceRef) {              </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 309         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 310             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-4674775763706954352" onmouseenter="enter('-4674775763706954352');" onmouseout="out('-4674775763706954352');" style=""> 311             replaceSelectFieldTable(leftNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 313         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 314             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 315                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 316             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-1755167016071657820" onmouseenter="enter('-1755167016071657820');" onmouseout="out('-1755167016071657820');" style=""> 317                 return ;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318             }                                                                                            </span>
<span  style=""> 319                                                                                                          </span>
<span class="1355631215618064105" onmouseenter="enter('1355631215618064105');" onmouseout="out('1355631215618064105');" style=""> 320             String fieldTableName = sqlIdentifier.names.get(0);                                          </span>
<span class="-2979536462712829146" onmouseenter="enter('-2979536462712829146');" onmouseout="out('-2979536462712829146');" style=""> 321             if(oldTbName.equalsIgnoreCase(fieldTableName)){                                              </span>
<span class="-4556037184452828083" onmouseenter="enter('-4556037184452828083');" onmouseout="out('-4556037184452828083');" style=""> 322                 replaceOneSelectField(sqlIdentifier, newTbName, oldTbName, fieldReplaceRef);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span  style=""> 324                                                                                                          </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 325         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 326             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 327         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 328                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 329                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 330                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 331                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 332                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 333                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 334                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 335                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 336                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 337                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 338                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 339                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 340                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 341                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 342                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 343                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 344                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 345                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 346                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 347                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 348                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 349                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 350                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 351                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 352                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 353                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 354                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 355                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 356                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 357                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 358         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 359             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 360             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 361                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 362                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 363                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364                 }                                                                                        </span>
<span  style=""> 365                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 366                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 367                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368                 }                                                                                        </span>
<span  style=""> 369                                                                                                          </span>
<span class="-5676526903547679293" onmouseenter="enter('-5676526903547679293');" onmouseout="out('-5676526903547679293');" style=""> 370                 replaceSelectFieldTable(sqlNode, oldTbName, newTbName, fieldReplaceRef);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371             }                                                                                            </span>
<span  style=""> 372                                                                                                          </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 373         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 374             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 375             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 376             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 377             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 378                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 379             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 380                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 381                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382             }                                                                                            </span>
<span  style=""> 383                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 384             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 385                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 386                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span  style=""> 387                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388             }                                                                                            </span>
<span  style=""> 389                                                                                                          </span>
<span class="-7763620435664145090" onmouseenter="enter('-7763620435664145090');" onmouseout="out('-7763620435664145090');" style=""> 390             replaceSelectFieldTable(elseNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 391         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 392             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 393             return;                                                                                      </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 394         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 395             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 395             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397     }                                                                                                    </span>
<span  style=""> 398                                                                                                          </span>
<span class="-8462314785940972235" onmouseenter="enter('-8462314785940972235');" onmouseout="out('-8462314785940972235');" style=""> 399     private static void replaceOneSelectField(SqlIdentifier sqlIdentifier,                               </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 400                                               String newTbName,                                          </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 401                                               String oldTbName,                                          </span>
<span class="-123666790994587736" onmouseenter="enter('-123666790994587736');" onmouseout="out('-123666790994587736');" style=""> 402                                               HashBiMap&lt;String, String&gt; fieldReplaceRef){                </span>
<span class="5409837540655806029" onmouseenter="enter('5409837540655806029');" onmouseout="out('5409837540655806029');" style=""> 403         SqlIdentifier newField = sqlIdentifier.setName(0, newTbName);                                    </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 404         String fieldName = sqlIdentifier.names.get(1);                                                   </span>
<span class="383429695235202001" onmouseenter="enter('383429695235202001');" onmouseout="out('383429695235202001');" style=""> 405         String fieldKey = oldTbName + &quot;_&quot; + fieldName;                                                   </span>
<span  style=""> 406                                                                                                          </span>
<span class="-6721872198205274351" onmouseenter="enter('-6721872198205274351');" onmouseout="out('-6721872198205274351');" style=""> 407         if(!fieldReplaceRef.containsKey(fieldKey)){                                                      </span>
<span class="-8417061839432085011" onmouseenter="enter('-8417061839432085011');" onmouseout="out('-8417061839432085011');" style=""> 408             if(fieldReplaceRef.inverse().get(fieldName) != null){                                        </span>
<span class="3563776056422158867" onmouseenter="enter('3563776056422158867');" onmouseout="out('3563776056422158867');" style=""> 409                 //换一个名字                                                                                  </span>
<span class="6269694230999482502" onmouseenter="enter('6269694230999482502');" onmouseout="out('6269694230999482502');" style=""> 410                 String mappingFieldName = ParseUtils.dealDuplicateFieldName(fieldReplaceRef, fieldName); </span>
<span class="730243385989967976" onmouseenter="enter('730243385989967976');" onmouseout="out('730243385989967976');" style=""> 411                 newField = newField.setName(1, mappingFieldName);                                        </span>
<span class="-8843946047709268866" onmouseenter="enter('-8843946047709268866');" onmouseout="out('-8843946047709268866');" style=""> 412                 fieldReplaceRef.put(fieldKey, mappingFieldName);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413             } else {                                                                                     </span>
<span class="8037669429324652271" onmouseenter="enter('8037669429324652271');" onmouseout="out('8037669429324652271');" style=""> 414                 fieldReplaceRef.put(fieldKey, fieldName);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415             }                                                                                            </span>
<span class="-6497049907687009769" onmouseenter="enter('-6497049907687009769');" onmouseout="out('-6497049907687009769');" style=""> 416         }else {                                                                                          </span>
<span class="-8559329898165326450" onmouseenter="enter('-8559329898165326450');" onmouseout="out('-8559329898165326450');" style=""> 417             newField = newField.setName(1, fieldReplaceRef.get(fieldKey));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418         }                                                                                                </span>
<span  style=""> 419                                                                                                          </span>
<span class="-3197795073308056747" onmouseenter="enter('-3197795073308056747');" onmouseout="out('-3197795073308056747');" style=""> 420         sqlIdentifier.assignNamesFrom(newField);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 423     /**                                                                                                  </span>
<span class="5461903081523405406" onmouseenter="enter('5461903081523405406');" onmouseout="out('5461903081523405406');" style=""> 424      * 替换另外join 表的指定表名为新关联处理的表名称                                                                         </span>
<span class="-4160812560585701802" onmouseenter="enter('-4160812560585701802');" onmouseout="out('-4160812560585701802');" style=""> 425      * @param condition                                                                                  </span>
<span class="-653368829907055509" onmouseenter="enter('-653368829907055509');" onmouseout="out('-653368829907055509');" style=""> 426      * @param oldTabFieldRefNew                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 427      */                                                                                                  </span>
<span class="3319102281402941993" onmouseenter="enter('3319102281402941993');" onmouseout="out('3319102281402941993');" style=""><abbr title=" 428     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRefNew){"> 428     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRef🔵</abbr></span>
<span class="5716706160133851170" onmouseenter="enter('5716706160133851170');" onmouseout="out('5716706160133851170');" style=""> 429         if (null == condition || condition.getKind() == LITERAL) {                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 430             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span class="5418896256960850645" onmouseenter="enter('5418896256960850645');" onmouseout="out('5418896256960850645');" style=""> 432         SqlKind joinKind = condition.getKind();                                                          </span>
<span class="-872109993356374898" onmouseenter="enter('-872109993356374898');" onmouseout="out('-872109993356374898');" style=""> 433         if( AGGREGATE.contains(joinKind)                                                                 </span>
<span class="6718918766222840749" onmouseenter="enter('6718918766222840749');" onmouseout="out('6718918766222840749');" style=""> 434                 || AVG_AGG_FUNCTIONS.contains(joinKind)                                                  </span>
<span class="-5795763144400386668" onmouseenter="enter('-5795763144400386668');" onmouseout="out('-5795763144400386668');" style=""> 435                 || COMPARISON.contains(joinKind)                                                         </span>
<span class="-8649262116164241163" onmouseenter="enter('-8649262116164241163');" onmouseout="out('-8649262116164241163');" style=""> 436                 || joinKind == OTHER_FUNCTION                                                            </span>
<span class="-5055598318919357044" onmouseenter="enter('-5055598318919357044');" onmouseout="out('-5055598318919357044');" style=""> 437                 || joinKind == DIVIDE                                                                    </span>
<span class="-5590854516630695190" onmouseenter="enter('-5590854516630695190');" onmouseout="out('-5590854516630695190');" style=""> 438                 || joinKind == CAST                                                                      </span>
<span class="-4942353295577364183" onmouseenter="enter('-4942353295577364183');" onmouseout="out('-4942353295577364183');" style=""> 439                 || joinKind == TRIM                                                                      </span>
<span class="3915078205687144262" onmouseenter="enter('3915078205687144262');" onmouseout="out('3915078205687144262');" style=""> 440                 || joinKind == TIMES                                                                     </span>
<span class="-1723358202983235773" onmouseenter="enter('-1723358202983235773');" onmouseout="out('-1723358202983235773');" style=""> 441                 || joinKind == PLUS                                                                      </span>
<span class="-5069307841224953084" onmouseenter="enter('-5069307841224953084');" onmouseout="out('-5069307841224953084');" style=""> 442                 || joinKind == NOT_IN                                                                    </span>
<span class="-2425336955836765254" onmouseenter="enter('-2425336955836765254');" onmouseout="out('-2425336955836765254');" style=""> 443                 || joinKind == OR                                                                        </span>
<span class="4152669671898758851" onmouseenter="enter('4152669671898758851');" onmouseout="out('4152669671898758851');" style=""> 444                 || joinKind == AND                                                                       </span>
<span class="8469231591142723332" onmouseenter="enter('8469231591142723332');" onmouseout="out('8469231591142723332');" style=""> 445                 || joinKind == MINUS                                                                     </span>
<span class="-8975416296405207931" onmouseenter="enter('-8975416296405207931');" onmouseout="out('-8975416296405207931');" style=""> 446                 || joinKind == TUMBLE                                                                    </span>
<span class="-2000447344068332492" onmouseenter="enter('-2000447344068332492');" onmouseout="out('-2000447344068332492');" style=""> 447                 || joinKind == TUMBLE_START                                                              </span>
<span class="-2660655228869248711" onmouseenter="enter('-2660655228869248711');" onmouseout="out('-2660655228869248711');" style=""> 448                 || joinKind == TUMBLE_END                                                                </span>
<span class="611140839719638142" onmouseenter="enter('611140839719638142');" onmouseout="out('611140839719638142');" style=""> 449                 || joinKind == SESSION                                                                   </span>
<span class="-4719587108970880084" onmouseenter="enter('-4719587108970880084');" onmouseout="out('-4719587108970880084');" style=""> 450                 || joinKind == SESSION_START                                                             </span>
<span class="-8416806901357633870" onmouseenter="enter('-8416806901357633870');" onmouseout="out('-8416806901357633870');" style=""> 451                 || joinKind == SESSION_END                                                               </span>
<span class="1350987570876390511" onmouseenter="enter('1350987570876390511');" onmouseout="out('1350987570876390511');" style=""> 452                 || joinKind == HOP                                                                       </span>
<span class="-1881854797876652455" onmouseenter="enter('-1881854797876652455');" onmouseout="out('-1881854797876652455');" style=""> 453                 || joinKind == HOP_START                                                                 </span>
<span class="8861207018381483306" onmouseenter="enter('8861207018381483306');" onmouseout="out('8861207018381483306');" style=""> 454                 || joinKind == HOP_END                                                                   </span>
<span class="-8001520670756666177" onmouseenter="enter('-8001520670756666177');" onmouseout="out('-8001520670756666177');" style=""> 455                 || joinKind == BETWEEN                                                                   </span>
<span class="-8652641138853954718" onmouseenter="enter('-8652641138853954718');" onmouseout="out('-8652641138853954718');" style=""> 456                 || joinKind == IS_NULL                                                                   </span>
<span class="-3447385425080227914" onmouseenter="enter('-3447385425080227914');" onmouseout="out('-3447385425080227914');" style=""> 457                 || joinKind == IS_NOT_NULL                                                               </span>
<span class="-7170411514740971639" onmouseenter="enter('-7170411514740971639');" onmouseout="out('-7170411514740971639');" style=""> 458                 || joinKind == CONTAINS                                                                  </span>
<span class="2023943706482563039" onmouseenter="enter('2023943706482563039');" onmouseout="out('2023943706482563039');" style=""> 459                 || joinKind == TIMESTAMP_ADD                                                             </span>
<span class="-2326108897925880210" onmouseenter="enter('-2326108897925880210');" onmouseout="out('-2326108897925880210');" style=""> 460                 || joinKind == TIMESTAMP_DIFF                                                            </span>
<span class="-853383041741207972" onmouseenter="enter('-853383041741207972');" onmouseout="out('-853383041741207972');" style=""> 461                 || joinKind == LIKE                                                                      </span>
<span class="6751598071686393893" onmouseenter="enter('6751598071686393893');" onmouseout="out('6751598071686393893');" style=""> 462                 || joinKind == COALESCE                                                                  </span>
<span class="-6635050181630823497" onmouseenter="enter('-6635050181630823497');" onmouseout="out('-6635050181630823497');" style=""> 463                 || joinKind == EQUALS ){                                                                 </span>
<span  style=""> 464                                                                                                          </span>
<span class="-2541170249719279546" onmouseenter="enter('-2541170249719279546');" onmouseout="out('-2541170249719279546');" style=""> 465             SqlBasicCall sqlBasicCall = (SqlBasicCall) condition;                                        </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 466             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 467                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 468                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 469                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470                 }                                                                                        </span>
<span  style=""> 471                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 472                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 473                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                 }                                                                                        </span>
<span  style=""> 475                                                                                                          </span>
<span class="9093647197598049539" onmouseenter="enter('9093647197598049539');" onmouseout="out('9093647197598049539');" style=""> 476                 replaceJoinFieldRefTableName(sqlNode, oldTabFieldRefNew);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477             }                                                                                            </span>
<span  style=""> 478                                                                                                          </span>
<span class="-3321512503468929771" onmouseenter="enter('-3321512503468929771');" onmouseout="out('-3321512503468929771');" style=""> 479         } else if (condition.getKind() == IDENTIFIER) {                                                  </span>
<span class="3421902236901684905" onmouseenter="enter('3421902236901684905');" onmouseout="out('3421902236901684905');" style=""><abbr title=" 480             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format table.field&quot;);"> 480             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must b🔵</abbr></span>
<span class="5832438568991919450" onmouseenter="enter('5832438568991919450');" onmouseout="out('5832438568991919450');" style=""> 481             String fieldRefTable = ((SqlIdentifier)condition).names.get(0);                              </span>
<span  style=""> 482                                                                                                          </span>
<span class="8100744064870187141" onmouseenter="enter('8100744064870187141');" onmouseout="out('8100744064870187141');" style=""><abbr title=" 483             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString());"> 483             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString()🔵</abbr></span>
<span  style=""> 484                                                                                                          </span>
<span class="8753124522689816475" onmouseenter="enter('8753124522689816475');" onmouseout="out('8753124522689816475');" style=""> 485             if(StringUtils.isNotBlank(targetFieldName)){                                                 </span>
<span class="549628471692842965" onmouseenter="enter('549628471692842965');" onmouseout="out('549628471692842965');" style=""> 486                 String[] fieldSplits = StringUtils.split(targetFieldName, &quot;.&quot;);                          </span>
<span class="-4590973079341848831" onmouseenter="enter('-4590973079341848831');" onmouseout="out('-4590973079341848831');" style=""> 487                 SqlIdentifier newField = ((SqlIdentifier)condition).setName(0, fieldSplits[0]);          </span>
<span class="-2128195046647686450" onmouseenter="enter('-2128195046647686450');" onmouseout="out('-2128195046647686450');" style=""> 488                 newField = newField.setName(1, fieldSplits[1]);                                          </span>
<span class="3184949241141894727" onmouseenter="enter('3184949241141894727');" onmouseout="out('3184949241141894727');" style=""> 489                 ((SqlIdentifier)condition).assignNamesFrom(newField);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="2909357842222016806" onmouseenter="enter('2909357842222016806');" onmouseout="out('2909357842222016806');" style=""> 494     public static String getTargetRefTable(Map&lt;String, String&gt; refTableMap, String tableName){           </span>
<span class="8928515954503116985" onmouseenter="enter('8928515954503116985');" onmouseout="out('8928515954503116985');" style=""> 495         String targetTableName = null;                                                                   </span>
<span class="-7988911072327938473" onmouseenter="enter('-7988911072327938473');" onmouseout="out('-7988911072327938473');" style=""> 496         String preTableName;                                                                             </span>
<span  style=""> 497                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 498         do {                                                                                             </span>
<span class="-8410406414279039842" onmouseenter="enter('-8410406414279039842');" onmouseout="out('-8410406414279039842');" style=""> 499             preTableName = targetTableName == null ? tableName : targetTableName;                        </span>
<span class="-6937575046812844068" onmouseenter="enter('-6937575046812844068');" onmouseout="out('-6937575046812844068');" style=""> 500             targetTableName = refTableMap.get(preTableName);                                             </span>
<span class="2145360151323546808" onmouseenter="enter('2145360151323546808');" onmouseout="out('2145360151323546808');" style=""> 501         } while (targetTableName != null);                                                               </span>
<span  style=""> 502                                                                                                          </span>
<span class="-2669935656864379097" onmouseenter="enter('-2669935656864379097');" onmouseout="out('-2669935656864379097');" style=""> 503         return preTableName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504     }                                                                                                    </span>
<span  style=""> 505                                                                                                          </span>
<span class="4252776571232827033" onmouseenter="enter('4252776571232827033');" onmouseout="out('4252776571232827033');" style=""> 506     public static String getTargetRefField(Map&lt;String, String&gt; refFieldMap, String currFieldName){       </span>
<span class="7313268804655149758" onmouseenter="enter('7313268804655149758');" onmouseout="out('7313268804655149758');" style=""> 507         String targetFieldName = null;                                                                   </span>
<span class="-8203442755027339079" onmouseenter="enter('-8203442755027339079');" onmouseout="out('-8203442755027339079');" style=""> 508         String preFieldName;                                                                             </span>
<span  style=""> 509                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 510         do {                                                                                             </span>
<span class="5385129689109669577" onmouseenter="enter('5385129689109669577');" onmouseout="out('5385129689109669577');" style=""> 511             preFieldName = targetFieldName == null ? currFieldName : targetFieldName;                    </span>
<span class="-3091793637238102945" onmouseenter="enter('-3091793637238102945');" onmouseout="out('-3091793637238102945');" style=""> 512             targetFieldName = refFieldMap.get(preFieldName);                                             </span>
<span class="-8916552568071022335" onmouseenter="enter('-8916552568071022335');" onmouseout="out('-8916552568071022335');" style=""> 513         } while (targetFieldName != null);                                                               </span>
<span  style=""> 514                                                                                                          </span>
<span class="5199537743604417658" onmouseenter="enter('5199537743604417658');" onmouseout="out('5199537743604417658');" style=""> 515         return preFieldName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516     }                                                                                                    </span>
<span  style=""> 517                                                                                                          </span>
<span class="-8300425435366196840" onmouseenter="enter('-8300425435366196840');" onmouseout="out('-8300425435366196840');" style=""><abbr title=" 518     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef){"> 518     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, Has🔵</abbr></span>
<span  style=""> 519                                                                                                          </span>
<span class="-7344361739038630250" onmouseenter="enter('-7344361739038630250');" onmouseout="out('-7344361739038630250');" style=""> 520         if(parentWhere == null){                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 521             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522         }                                                                                                </span>
<span  style=""> 523                                                                                                          </span>
<span class="7198030462908925381" onmouseenter="enter('7198030462908925381');" onmouseout="out('7198030462908925381');" style=""> 524         SqlKind kind = parentWhere.getKind();                                                            </span>
<span class="-1872623569752802183" onmouseenter="enter('-1872623569752802183');" onmouseout="out('-1872623569752802183');" style=""> 525         if(kind == AND){                                                                                 </span>
<span class="2829943023301943879" onmouseenter="enter('2829943023301943879');" onmouseout="out('2829943023301943879');" style=""><abbr title=" 526             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplaceRef);"> 526             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fi🔵</abbr></span>
<span class="-4556945615844132104" onmouseenter="enter('-4556945615844132104');" onmouseout="out('-4556945615844132104');" style=""><abbr title=" 527             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplaceRef);"> 527             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fi🔵</abbr></span>
<span  style=""> 528                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 529         } else {                                                                                         </span>
<span class="8766459294285823468" onmouseenter="enter('8766459294285823468');" onmouseout="out('8766459294285823468');" style=""> 530             replaceConditionNode(parentWhere, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532     }                                                                                                    </span>
<span  style=""> 533                                                                                                          </span>
<span class="7802005378818510825" onmouseenter="enter('7802005378818510825');" onmouseout="out('7802005378818510825');" style=""><abbr title=" 534     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef) {"> 534     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, Hash🔵</abbr></span>
<span class="8405601494998756480" onmouseenter="enter('8405601494998756480');" onmouseout="out('8405601494998756480');" style=""> 535         if(selectNode.getKind() == IDENTIFIER){                                                          </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 536             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 537                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 538             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 539                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540             }                                                                                            </span>
<span  style=""> 541                                                                                                          </span>
<span class="318397782816978051" onmouseenter="enter('318397782816978051');" onmouseout="out('318397782816978051');" style=""> 542             String tableName = sqlIdentifier.names.asList().get(0);                                      </span>
<span class="5268132787378326987" onmouseenter="enter('5268132787378326987');" onmouseout="out('5268132787378326987');" style=""> 543             String tableField = sqlIdentifier.names.asList().get(1);                                     </span>
<span class="-2565165445763658517" onmouseenter="enter('-2565165445763658517');" onmouseout="out('-2565165445763658517');" style=""> 544             String fieldKey = tableName + &quot;_&quot; + tableField;                                              </span>
<span  style=""> 545                                                                                                          </span>
<span class="-3841275234863465094" onmouseenter="enter('-3841275234863465094');" onmouseout="out('-3841275234863465094');" style=""> 546             if(tableName.equalsIgnoreCase(oldTbName)){                                                   </span>
<span  style=""> 547                                                                                                          </span>
<span class="-7486276484118623043" onmouseenter="enter('-7486276484118623043');" onmouseout="out('-7486276484118623043');" style=""><abbr title=" 548                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fieldKey);"> 548                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRe🔵</abbr></span>
<span class="-85150012511262136" onmouseenter="enter('-85150012511262136');" onmouseout="out('-85150012511262136');" style=""> 549                 SqlIdentifier newField = ((SqlIdentifier)selectNode).setName(0, newTbName);              </span>
<span class="-3325104965504513825" onmouseenter="enter('-3325104965504513825');" onmouseout="out('-3325104965504513825');" style=""> 550                 newField = newField.setName(1, newFieldName);                                            </span>
<span class="-7494318194999571350" onmouseenter="enter('-7494318194999571350');" onmouseout="out('-7494318194999571350');" style=""> 551                 ((SqlIdentifier)selectNode).assignNamesFrom(newField);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 553             return;                                                                                      </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 554         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 555             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 556         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 557                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 558                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 559                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 560                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 561                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 562                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 563                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 564                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 565                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 566                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 567                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 568                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 569                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 570                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 571                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 572                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 573                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 574                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 575                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 576                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 577                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 578                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 579                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 580                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 581                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 582                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 583                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 584                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 585                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 586                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 587         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 588             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 589             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 590                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 591                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 592                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593                 }                                                                                        </span>
<span  style=""> 594                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 595                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 596                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597                 }                                                                                        </span>
<span  style=""> 598                                                                                                          </span>
<span class="-2258996485445817623" onmouseenter="enter('-2258996485445817623');" onmouseout="out('-2258996485445817623');" style=""> 599                 replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600             }                                                                                            </span>
<span  style=""> 601                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 602             return;                                                                                      </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 603         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 604             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 605             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 606         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 607             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 608                                                                                                          </span>
<span class="-2315512384759132147" onmouseenter="enter('-2315512384759132147');" onmouseout="out('-2315512384759132147');" style=""><abbr title=" 609             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 609             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-1345654988953747553" onmouseenter="enter('-1345654988953747553');" onmouseout="out('-1345654988953747553');" style=""><abbr title=" 610             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 610             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-7836146409865535589" onmouseenter="enter('-7836146409865535589');" onmouseout="out('-7836146409865535589');" style=""> 611             replaceConditionNode(sqlCase.getElseOperand(), oldTbName, newTbName, fieldReplaceRef);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 612         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 613             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 613             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615     }                                                                                                    </span>
<span  style=""> 616                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 617     /**                                                                                                  </span>
<span class="1570055177673011707" onmouseenter="enter('1570055177673011707');" onmouseout="out('1570055177673011707');" style=""> 618      * 获取条件中关联的表信息                                                                                       </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 619      * @param selectNode                                                                                 </span>
<span class="-4813798938110383556" onmouseenter="enter('-4813798938110383556');" onmouseout="out('-4813798938110383556');" style=""> 620      * @param fieldInfos                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 621      */                                                                                                  </span>
<span class="7137057397975985823" onmouseenter="enter('7137057397975985823');" onmouseout="out('7137057397975985823');" style=""> 622     public static void getConditionRefTable(SqlNode selectNode, Set&lt;String&gt; fieldInfos) {                </span>
<span class="-3454817955506608063" onmouseenter="enter('-3454817955506608063');" onmouseout="out('-3454817955506608063');" style=""> 623         if (selectNode.getKind() == IDENTIFIER) {                                                        </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 624             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 625                                                                                                          </span>
<span class="380773342968557196" onmouseenter="enter('380773342968557196');" onmouseout="out('380773342968557196');" style=""> 626             fieldInfos.add(sqlIdentifier.toString());                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 627             return;                                                                                      </span>
<span class="6757358046968148413" onmouseenter="enter('6757358046968148413');" onmouseout="out('6757358046968148413');" style=""> 628         } else if (selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN) {//字面含义     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 629             return;                                                                                      </span>
<span class="-4023999264561783968" onmouseenter="enter('-4023999264561783968');" onmouseout="out('-4023999264561783968');" style=""> 630         } else if (AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 631                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 632                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 633                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 634                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 635                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 636                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 637                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 638                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 639                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 640                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 641                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 642                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 643                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 644                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 645                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 646                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 647                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 648                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 649                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 650                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 651                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 652                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 653                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 654                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 655                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 656                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 657                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 658                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 659                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 660                                                                                                          </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 661                 ) {                                                                                      </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 662             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 663             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 664                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 665                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 666                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667                 }                                                                                        </span>
<span  style=""> 668                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 669                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 670                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671                 }                                                                                        </span>
<span  style=""> 672                                                                                                          </span>
<span class="56198544928191592" onmouseenter="enter('56198544928191592');" onmouseout="out('56198544928191592');" style=""> 673                 getConditionRefTable(sqlNode, fieldInfos);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674             }                                                                                            </span>
<span  style=""> 675                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 676             return;                                                                                      </span>
<span class="-2308646561142794789" onmouseenter="enter('-2308646561142794789');" onmouseout="out('-2308646561142794789');" style=""> 677         } else if (selectNode.getKind() == OTHER) {                                                      </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 678             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 679             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 680         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 681             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 682                                                                                                          </span>
<span class="-3537580079884591293" onmouseenter="enter('-3537580079884591293');" onmouseout="out('-3537580079884591293');" style=""><abbr title=" 683             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 683             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="2144257116225237462" onmouseenter="enter('2144257116225237462');" onmouseout="out('2144257116225237462');" style=""><abbr title=" 684             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 684             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="-5604248574568658683" onmouseenter="enter('-5604248574568658683');" onmouseout="out('-5604248574568658683');" style=""> 685             getConditionRefTable(sqlCase.getElseOperand(), fieldInfos);                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 686         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 687             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 687             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689     }                                                                                                    </span>
<span  style=""> 690                                                                                                          </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style=""> 691     public static String buildTableField(String tableName, String fieldName){                            </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style=""> 692         return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693     }                                                                                                    </span>
<span  style=""> 694                                                                                                          </span>
<span  style=""> 695                                                                                                          </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style=""> 696     public static String buildTableNameWithScope(String tableName, String scope){                        </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style=""> 697         if(StringUtils.isEmpty(scope)){                                                                  </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 698             return tableName;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 699         }                                                                                                </span>
<span  style=""> 700                                                                                                          </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style=""> 701         return tableName + &quot;_&quot; + scope;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702     }                                                                                                    </span>
<span  style=""> 703                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 704     /**                                                                                                  </span>
<span class="6497150561674133661" onmouseenter="enter('6497150561674133661');" onmouseout="out('6497150561674133661');" style=""> 705      * add constant join fields, using in such as hbase、redis etc kv database                            </span>
<span class="-8477144116998604047" onmouseenter="enter('-8477144116998604047');" onmouseout="out('-8477144116998604047');" style=""> 706      * @param keyMap                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 707      */                                                                                                  </span>
<span class="7525620767750394099" onmouseenter="enter('7525620767750394099');" onmouseout="out('7525620767750394099');" style=""> 708     public static void addConstant(Map&lt;String, Object&gt; keyMap, AbstractSideTableInfo sideTableInfo) {    </span>
<span class="3178460372749787756" onmouseenter="enter('3178460372749787756');" onmouseout="out('3178460372749787756');" style=""> 709         List&lt;PredicateInfo&gt; predicateInfos = sideTableInfo.getPredicateInfoes();                         </span>
<span class="-6183321864643515167" onmouseenter="enter('-6183321864643515167');" onmouseout="out('-6183321864643515167');" style=""> 710         final String name = sideTableInfo.getName();                                                     </span>
<span class="7309058727137890263" onmouseenter="enter('7309058727137890263');" onmouseout="out('7309058727137890263');" style=""> 711         for (PredicateInfo info : predicateInfos) {                                                      </span>
<span class="2363297685674950976" onmouseenter="enter('2363297685674950976');" onmouseout="out('2363297685674950976');" style=""> 712             if (info.getOwnerTable().equals(name)                                                        </span>
<span class="-1265448967873634704" onmouseenter="enter('-1265448967873634704');" onmouseout="out('-1265448967873634704');" style=""> 713                 &amp;&amp; info.getOperatorName().equals(&quot;=&quot;)) {                                                 </span>
<span class="-3488992775588585467" onmouseenter="enter('-3488992775588585467');" onmouseout="out('-3488992775588585467');" style=""> 714                 String condition = info.getCondition();                                                  </span>
<span class="-3376001444363563672" onmouseenter="enter('-3376001444363563672');" onmouseout="out('-3376001444363563672');" style=""> 715                 Matcher matcher = stringPattern.matcher(condition);                                      </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 716                 if (matcher.matches()) {                                                                 </span>
<span class="2819616911838313283" onmouseenter="enter('2819616911838313283');" onmouseout="out('2819616911838313283');" style=""> 717                     condition = condition.substring(1, condition.length() - 1);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 718                 }                                                                                        </span>
<span class="-2333073189429870453" onmouseenter="enter('-2333073189429870453');" onmouseout="out('-2333073189429870453');" style=""> 719                 keyMap.put(info.getFieldName(), condition);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 720             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722     }                                                                                                    </span>
<span  style=""> 723                                                                                                          </span>
<span class="290962191185636260" onmouseenter="enter('290962191185636260');" onmouseout="out('290962191185636260');" style=""><abbr title=" 724     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String rightTableName, String scope, Set&lt;String&gt; existTableNames){"> 724     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String righ🔵</abbr></span>
<span class="2401839376205144968" onmouseenter="enter('2401839376205144968');" onmouseout="out('2401839376205144968');" style=""> 725         //兼容左边表是as 的情况                                                                                   </span>
<span class="2644250892879979113" onmouseenter="enter('2644250892879979113');" onmouseout="out('2644250892879979113');" style=""> 726         String leftStr = Strings.isNullOrEmpty(leftTableName) ? leftTableAlias : leftTableName;          </span>
<span class="4940999328154746374" onmouseenter="enter('4940999328154746374');" onmouseout="out('4940999328154746374');" style=""> 727         String newName = leftStr + &quot;_&quot; + rightTableName;                                                 </span>
<span class="-8657233487191077119" onmouseenter="enter('-8657233487191077119');" onmouseout="out('-8657233487191077119');" style=""> 728         if (CollectionUtils.isEmpty(existTableNames)) {                                                  </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style=""> 729             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 730         }                                                                                                </span>
<span  style=""> 731                                                                                                          </span>
<span class="-234751792023525655" onmouseenter="enter('-234751792023525655');" onmouseout="out('-234751792023525655');" style=""> 732         if (!existTableNames.contains(newName)) {                                                        </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style=""> 733             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 734         }                                                                                                </span>
<span  style=""> 735                                                                                                          </span>
<span class="6366820324978801292" onmouseenter="enter('6366820324978801292');" onmouseout="out('6366820324978801292');" style=""> 736         return TableUtils.buildTableNameWithScope(newName, scope) + &quot;_&quot; + System.currentTimeMillis();    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 737     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 738 }                                                                                                        </span>
















</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  18 package com.dtstack.flink.sql.util;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  20 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  21 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  22 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">  23 import com.dtstack.flink.sql.side.PredicateInfo;                                                         </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  24 import com.google.common.base.Preconditions;                                                             </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  25 import com.google.common.base.Strings;                                                                   </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  26 import com.google.common.collect.HashBasedTable;                                                         </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  27 import com.google.common.collect.HashBiMap;                                                              </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  28 import com.google.common.collect.Lists;                                                                  </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  29 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  30 import java.util.Map;                                                                                    </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  31 import java.util.Queue;                                                                                  </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  32 import java.util.Set;                                                                                    </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="">  33 import java.util.regex.Matcher;                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  34 import java.util.regex.Pattern;                                                                          </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  35 import org.apache.calcite.sql.SqlAsOperator;                                                             </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  36 import org.apache.calcite.sql.SqlBasicCall;                                                              </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  37 import org.apache.calcite.sql.SqlDataTypeSpec;                                                           </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  38 import org.apache.calcite.sql.SqlIdentifier;                                                             </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  39 import org.apache.calcite.sql.SqlJoin;                                                                   </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  40 import org.apache.calcite.sql.SqlKind;                                                                   </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  41 import org.apache.calcite.sql.SqlLiteral;                                                                </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  42 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  43 import org.apache.calcite.sql.SqlNodeList;                                                               </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  44 import org.apache.calcite.sql.SqlOperator;                                                               </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  45 import org.apache.calcite.sql.SqlSelect;                                                                 </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  46 import org.apache.calcite.sql.fun.SqlCase;                                                               </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  47 import org.apache.calcite.sql.parser.SqlParserPos;                                                       </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="">  48 import org.apache.commons.collections.CollectionUtils;                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  49 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  50 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  51 import static org.apache.calcite.sql.SqlKind.*;                                                          </span>
<span class="511836661302622038" onmouseenter="enter('511836661302622038');" onmouseout="out('511836661302622038');" style="">  52 import static org.apache.calcite.sql.SqlKind.CASE;                                                       </span>
<span class="178844392791952204" onmouseenter="enter('178844392791952204');" onmouseout="out('178844392791952204');" style="">  53 import static org.apache.calcite.sql.SqlKind.OTHER;                                                      </span>
<span  style="">  54                                                                                                          </span>
<span  style="">  55                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56 /**                                                                                                      </span>
<span class="2491900718050250190" onmouseenter="enter('2491900718050250190');" onmouseout="out('2491900718050250190');" style="">  57  * 表的解析相关                                                                                                </span>
<span class="-831295595380638887" onmouseenter="enter('-831295595380638887');" onmouseout="out('-831295595380638887');" style="">  58  * Date: 2020/2/17                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  59  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  60  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61  */                                                                                                      </span>
<span class="-5515152307095787287" onmouseenter="enter('-5515152307095787287');" onmouseout="out('-5515152307095787287');" style="">  62 public class TableUtils {                                                                                </span>
<span class="6670707421612748000" onmouseenter="enter('6670707421612748000');" onmouseout="out('6670707421612748000');" style="">  63     public static final char SPLIT = &#x27;_&#x27;;                                                                </span>
<span  style="">  64                                                                                                          </span>
<span class="-3060398288124517436" onmouseenter="enter('-3060398288124517436');" onmouseout="out('-3060398288124517436');" style="">  65     public static final Pattern stringPattern = Pattern.compile(&quot;\&quot;.*?\&quot;|\&#x27;.*?\&#x27;&quot;);                      </span>
<span  style="">  66                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  67     /**                                                                                                  </span>
<span class="-3835139450942807208" onmouseenter="enter('-3835139450942807208');" onmouseout="out('-3835139450942807208');" style="">  68      * 获取select 的字段                                                                                      </span>
<span class="-592626010544206006" onmouseenter="enter('-592626010544206006');" onmouseout="out('-592626010544206006');" style="">  69      * @param sqlSelect                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  70      */                                                                                                  </span>
<span class="-662197916250462065" onmouseenter="enter('-662197916250462065');" onmouseout="out('-662197916250462065');" style=""><abbr title="  71     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCache){">  71     public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCac🔵</abbr></span>
<span class="8036786023408828043" onmouseenter="enter('8036786023408828043');" onmouseout="out('8036786023408828043');" style="">  72         SqlNodeList sqlNodeList = sqlSelect.getSelectList();                                             </span>
<span class="-3054172495871960241" onmouseenter="enter('-3054172495871960241');" onmouseout="out('-3054172495871960241');" style="">  73         List&lt;FieldInfo&gt; fieldInfoList = Lists.newArrayList();                                            </span>
<span class="-839692389379732251" onmouseenter="enter('-839692389379732251');" onmouseout="out('-839692389379732251');" style="">  74         String fromNode = sqlSelect.getFrom().toString();                                                </span>
<span  style="">  75                                                                                                          </span>
<span class="2162301537633635938" onmouseenter="enter('2162301537633635938');" onmouseout="out('2162301537633635938');" style="">  76         for (SqlNode fieldNode : sqlNodeList.getList()) {                                                </span>
<span class="1465841598931987040" onmouseenter="enter('1465841598931987040');" onmouseout="out('1465841598931987040');" style="">  77             extractSelectFieldToFieldInfo(fieldNode,fromNode,fieldInfoList,localTableCache);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78         }                                                                                                </span>
<span  style="">  79                                                                                                          </span>
<span class="1335352475287465914" onmouseenter="enter('1335352475287465914');" onmouseout="out('1335352475287465914');" style="">  80         return fieldInfoList;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83     /**                                                                                                  </span>
<span class="-6805611089677825770" onmouseenter="enter('-6805611089677825770');" onmouseout="out('-6805611089677825770');" style="">  84      *  解析select Node 提取FieldInfo                                                                        </span>
<span class="697554033229417632" onmouseenter="enter('697554033229417632');" onmouseout="out('697554033229417632');" style="">  85      * @param fieldNode                                                                                  </span>
<span class="-1719315088034482430" onmouseenter="enter('-1719315088034482430');" onmouseout="out('-1719315088034482430');" style="">  86      * @param fromNode                                                                                   </span>
<span class="8898190159008473723" onmouseenter="enter('8898190159008473723');" onmouseout="out('8898190159008473723');" style="">  87      * @param fieldInfoList                                                                              </span>
<span class="-2613125561450459797" onmouseenter="enter('-2613125561450459797');" onmouseout="out('-2613125561450459797');" style="">  88      * @param localTableCache                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  89      */                                                                                                  </span>
<span class="911398554884375981" onmouseenter="enter('911398554884375981');" onmouseout="out('911398554884375981');" style=""><abbr title="  90     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfoList, Map&lt;String, Table&gt; localTableCache) {">  90     public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; 🔵</abbr></span>
<span class="8336572539967602309" onmouseenter="enter('8336572539967602309');" onmouseout="out('8336572539967602309');" style="">  91         if (fieldNode.getKind() == IDENTIFIER) {                                                         </span>
<span class="2728418029840045752" onmouseenter="enter('2728418029840045752');" onmouseout="out('2728418029840045752');" style="">  92             SqlIdentifier identifier = (SqlIdentifier) fieldNode;                                        </span>
<span class="-5519378359901478287" onmouseenter="enter('-5519378359901478287');" onmouseout="out('-5519378359901478287');" style="">  93             if (!identifier.isStar()) {                                                                  </span>
<span class="7382398262726877456" onmouseenter="enter('7382398262726877456');" onmouseout="out('7382398262726877456');" style=""><abbr title="  94                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple();">  94                 String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).g🔵</abbr></span>
<span class="-4078369372891740310" onmouseenter="enter('-4078369372891740310');" onmouseout="out('-4078369372891740310');" style=""><abbr title="  95                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identifier.getComponent(1).getSimple();">  95                 String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() 🔵</abbr></span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style="">  96                 FieldInfo fieldInfo = new FieldInfo();                                                   </span>
<span class="-3246065580716586601" onmouseenter="enter('-3246065580716586601');" onmouseout="out('-3246065580716586601');" style="">  97                 fieldInfo.setTable(tableName);                                                           </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style="">  98                 fieldInfo.setFieldName(fieldName);                                                       </span>
<span  style="">  99                                                                                                          </span>
<span class="4376905192285837026" onmouseenter="enter('4376905192285837026');" onmouseout="out('4376905192285837026');" style=""> 100                 if (!fieldInfoList.contains(fieldInfo)) {                                                </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 101                     fieldInfoList.add(fieldInfo);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 103             } else {                                                                                     </span>
<span class="2893145864113934715" onmouseenter="enter('2893145864113934715');" onmouseout="out('2893145864113934715');" style=""> 104                 //处理                                                                                     </span>
<span class="-3160769060475159310" onmouseenter="enter('-3160769060475159310');" onmouseout="out('-3160769060475159310');" style=""> 105                 int identifierSize = identifier.names.size();                                            </span>
<span class="5352978315561223025" onmouseenter="enter('5352978315561223025');" onmouseout="out('5352978315561223025');" style=""> 106                 switch (identifierSize) {                                                                </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 107                     case 1:                                                                              </span>
<span class="543169233263070967" onmouseenter="enter('543169233263070967');" onmouseout="out('543169233263070967');" style=""> 108                         throw new RuntimeException(&quot;not support to parse * without scope of table&quot;);     </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 109                     default:                                                                             </span>
<span class="7234102748034848382" onmouseenter="enter('7234102748034848382');" onmouseout="out('7234102748034848382');" style=""> 110                         SqlIdentifier tableIdentify = identifier.skipLast(1);                            </span>
<span class="-7038658933458861113" onmouseenter="enter('-7038658933458861113');" onmouseout="out('-7038658933458861113');" style=""> 111                         Table registerTable = localTableCache.get(tableIdentify.getSimple());            </span>
<span class="-5997676555615328170" onmouseenter="enter('-5997676555615328170');" onmouseout="out('-5997676555615328170');" style=""> 112                         if (registerTable == null) {                                                     </span>
<span class="6481995910302552391" onmouseenter="enter('6481995910302552391');" onmouseout="out('6481995910302552391');" style=""><abbr title=" 113                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimple());"> 113                             throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimpl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114                         }                                                                                </span>
<span  style=""> 115                                                                                                          </span>
<span class="-4547568303745452703" onmouseenter="enter('-4547568303745452703');" onmouseout="out('-4547568303745452703');" style=""> 116                         String[] fieldNames = registerTable.getSchema().getFieldNames();                 </span>
<span class="-7408478396859326180" onmouseenter="enter('-7408478396859326180');" onmouseout="out('-7408478396859326180');" style=""> 117                         for (String fieldName : fieldNames) {                                            </span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 118                             FieldInfo fieldInfo = new FieldInfo();                                       </span>
<span class="-5561911469151499170" onmouseenter="enter('-5561911469151499170');" onmouseout="out('-5561911469151499170');" style=""> 119                             fieldInfo.setTable(tableIdentify.getSimple());                               </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 120                             fieldInfo.setFieldName(fieldName);                                           </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 121                             fieldInfoList.add(fieldInfo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124             }                                                                                            </span>
<span class="355751622478352774" onmouseenter="enter('355751622478352774');" onmouseout="out('355751622478352774');" style=""> 125         } else if (AGGREGATE.contains(fieldNode.getKind())                                               </span>
<span class="-4728546343803188943" onmouseenter="enter('-4728546343803188943');" onmouseout="out('-4728546343803188943');" style=""> 126                 || AVG_AGG_FUNCTIONS.contains(fieldNode.getKind())                                       </span>
<span class="8973512118577358544" onmouseenter="enter('8973512118577358544');" onmouseout="out('8973512118577358544');" style=""> 127                 || COMPARISON.contains(fieldNode.getKind())                                              </span>
<span class="525772482672043181" onmouseenter="enter('525772482672043181');" onmouseout="out('525772482672043181');" style=""> 128                 || fieldNode.getKind() == OTHER_FUNCTION                                                 </span>
<span class="4987264283847416523" onmouseenter="enter('4987264283847416523');" onmouseout="out('4987264283847416523');" style=""> 129                 || fieldNode.getKind() == DIVIDE                                                         </span>
<span class="-2097459444898035710" onmouseenter="enter('-2097459444898035710');" onmouseout="out('-2097459444898035710');" style=""> 130                 || fieldNode.getKind() == CAST                                                           </span>
<span class="621194935667432352" onmouseenter="enter('621194935667432352');" onmouseout="out('621194935667432352');" style=""> 131                 || fieldNode.getKind() == TRIM                                                           </span>
<span class="5379925649229703360" onmouseenter="enter('5379925649229703360');" onmouseout="out('5379925649229703360');" style=""> 132                 || fieldNode.getKind() == TIMES                                                          </span>
<span class="-4394268980765693723" onmouseenter="enter('-4394268980765693723');" onmouseout="out('-4394268980765693723');" style=""> 133                 || fieldNode.getKind() == PLUS                                                           </span>
<span class="-122938326578311005" onmouseenter="enter('-122938326578311005');" onmouseout="out('-122938326578311005');" style=""> 134                 || fieldNode.getKind() == NOT_IN                                                         </span>
<span class="5635148239693374504" onmouseenter="enter('5635148239693374504');" onmouseout="out('5635148239693374504');" style=""> 135                 || fieldNode.getKind() == OR                                                             </span>
<span class="-3217339780873839086" onmouseenter="enter('-3217339780873839086');" onmouseout="out('-3217339780873839086');" style=""> 136                 || fieldNode.getKind() == AND                                                            </span>
<span class="2162998824653848637" onmouseenter="enter('2162998824653848637');" onmouseout="out('2162998824653848637');" style=""> 137                 || fieldNode.getKind() == MINUS                                                          </span>
<span class="-506664053077300680" onmouseenter="enter('-506664053077300680');" onmouseout="out('-506664053077300680');" style=""> 138                 || fieldNode.getKind() == TUMBLE                                                         </span>
<span class="-1822630894260242331" onmouseenter="enter('-1822630894260242331');" onmouseout="out('-1822630894260242331');" style=""> 139                 || fieldNode.getKind() == TUMBLE_START                                                   </span>
<span class="-8086489575650543701" onmouseenter="enter('-8086489575650543701');" onmouseout="out('-8086489575650543701');" style=""> 140                 || fieldNode.getKind() == TUMBLE_END                                                     </span>
<span class="-2609834003874905006" onmouseenter="enter('-2609834003874905006');" onmouseout="out('-2609834003874905006');" style=""> 141                 || fieldNode.getKind() == SESSION                                                        </span>
<span class="6623716356682835746" onmouseenter="enter('6623716356682835746');" onmouseout="out('6623716356682835746');" style=""> 142                 || fieldNode.getKind() == SESSION_START                                                  </span>
<span class="-4356389762844455169" onmouseenter="enter('-4356389762844455169');" onmouseout="out('-4356389762844455169');" style=""> 143                 || fieldNode.getKind() == SESSION_END                                                    </span>
<span class="3788231826671768229" onmouseenter="enter('3788231826671768229');" onmouseout="out('3788231826671768229');" style=""> 144                 || fieldNode.getKind() == HOP                                                            </span>
<span class="6798204869770216275" onmouseenter="enter('6798204869770216275');" onmouseout="out('6798204869770216275');" style=""> 145                 || fieldNode.getKind() == HOP_START                                                      </span>
<span class="250318287045370196" onmouseenter="enter('250318287045370196');" onmouseout="out('250318287045370196');" style=""> 146                 || fieldNode.getKind() == HOP_END                                                        </span>
<span class="9109972257207472540" onmouseenter="enter('9109972257207472540');" onmouseout="out('9109972257207472540');" style=""> 147                 || fieldNode.getKind() == BETWEEN                                                        </span>
<span class="6983217744831152908" onmouseenter="enter('6983217744831152908');" onmouseout="out('6983217744831152908');" style=""> 148                 || fieldNode.getKind() == IS_NULL                                                        </span>
<span class="-1122161678078794235" onmouseenter="enter('-1122161678078794235');" onmouseout="out('-1122161678078794235');" style=""> 149                 || fieldNode.getKind() == IS_NOT_NULL                                                    </span>
<span class="-3733427582644132679" onmouseenter="enter('-3733427582644132679');" onmouseout="out('-3733427582644132679');" style=""> 150                 || fieldNode.getKind() == CONTAINS                                                       </span>
<span class="-9056199605453305302" onmouseenter="enter('-9056199605453305302');" onmouseout="out('-9056199605453305302');" style=""> 151                 || fieldNode.getKind() == TIMESTAMP_ADD                                                  </span>
<span class="-134492662313070004" onmouseenter="enter('-134492662313070004');" onmouseout="out('-134492662313070004');" style=""> 152                 || fieldNode.getKind() == TIMESTAMP_DIFF                                                 </span>
<span class="6146091325000099373" onmouseenter="enter('6146091325000099373');" onmouseout="out('6146091325000099373');" style=""> 153                 || fieldNode.getKind() == LIKE                                                           </span>
<span class="4953146235532857216" onmouseenter="enter('4953146235532857216');" onmouseout="out('4953146235532857216');" style=""> 154                 || fieldNode.getKind() == COALESCE                                                       </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 155                 ) {                                                                                      </span>
<span class="-354400113971550997" onmouseenter="enter('-354400113971550997');" onmouseout="out('-354400113971550997');" style=""> 156             SqlBasicCall sqlBasicCall = (SqlBasicCall) fieldNode;                                        </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 157             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 158                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 159                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 160                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161                 }                                                                                        </span>
<span  style=""> 162                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 163                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 164                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165                 }                                                                                        </span>
<span class="-5978367516025835425" onmouseenter="enter('-5978367516025835425');" onmouseout="out('-5978367516025835425');" style=""> 166                 extractSelectFieldToFieldInfo(sqlNode, fromNode, fieldInfoList, localTableCache);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167             }                                                                                            </span>
<span class="-3590348607861839793" onmouseenter="enter('-3590348607861839793');" onmouseout="out('-3590348607861839793');" style=""> 168         } else if (fieldNode.getKind() == AS) {                                                          </span>
<span class="3703210587199661065" onmouseenter="enter('3703210587199661065');" onmouseout="out('3703210587199661065');" style=""> 169             SqlNode leftNode = ((SqlBasicCall) fieldNode).getOperands()[0];                              </span>
<span class="-2607912045389455868" onmouseenter="enter('-2607912045389455868');" onmouseout="out('-2607912045389455868');" style=""> 170             extractSelectFieldToFieldInfo(leftNode, fromNode,fieldInfoList, localTableCache);            </span>
<span class="-3651943351416933315" onmouseenter="enter('-3651943351416933315');" onmouseout="out('-3651943351416933315');" style=""> 171         } else if (fieldNode.getKind() == CASE) {                                                        </span>
<span class="7184861900726949901" onmouseenter="enter('7184861900726949901');" onmouseout="out('7184861900726949901');" style=""> 172             SqlCase sqlCase = (SqlCase) fieldNode;                                                       </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 173             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 174             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 175             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 176                                                                                                          </span>
<span class="5804242455667685406" onmouseenter="enter('5804242455667685406');" onmouseout="out('5804242455667685406');" style=""> 177             for (int i = 0; i &lt; whenOperands.size(); i++) {                                              </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 178                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 179                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180             }                                                                                            </span>
<span  style=""> 181                                                                                                          </span>
<span class="-7770933914215809062" onmouseenter="enter('-7770933914215809062');" onmouseout="out('-7770933914215809062');" style=""> 182             for (int i = 0; i &lt; thenOperands.size(); i++) {                                              </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 183                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 184                 extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);     </span>
<span  style=""> 185                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186             }                                                                                            </span>
<span  style=""> 187                                                                                                          </span>
<span class="7029049357943474126" onmouseenter="enter('7029049357943474126');" onmouseout="out('7029049357943474126');" style=""> 188             extractSelectFieldToFieldInfo(elseNode, fromNode, fieldInfoList, localTableCache);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190     }                                                                                                    </span>
<span  style=""> 191                                                                                                          </span>
<span class="-8999074733125454701" onmouseenter="enter('-8999074733125454701');" onmouseout="out('-8999074733125454701');" style=""><abbr title=" 192     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAlias) {"> 192     public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAli🔵</abbr></span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 193         SqlOperator operator = new SqlAsOperator();                                                      </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 194         SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                              </span>
<span class="4539692765329264390" onmouseenter="enter('4539692765329264390');" onmouseout="out('4539692765329264390');" style=""> 195         String newTableName = joinInfo.getNewTableName();                                                </span>
<span class="8764323733658531284" onmouseenter="enter('8764323733658531284');" onmouseout="out('8764323733658531284');" style=""><abbr title=" 196         String newTableAlias = (!StringUtils.isEmpty(tableAlias)) ? tableAlias : joinInfo.getNewTableAlias();"> 196         String newTableAlias = (!StringUtils.isEmpty(tableAlias)) ? tableAlias : joinInfo.getNewTableAlia🔵</abbr></span>
<span class="-6474384717461795701" onmouseenter="enter('-6474384717461795701');" onmouseout="out('-6474384717461795701');" style=""> 197         if (null == sqlNode0) {                                                                          </span>
<span class="-6562061848026015753" onmouseenter="enter('-6562061848026015753');" onmouseout="out('-6562061848026015753');" style=""> 198             sqlNode0 = new SqlIdentifier(newTableName, null, sqlParserPos);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199         }                                                                                                </span>
<span class="-2821647309854503598" onmouseenter="enter('-2821647309854503598');" onmouseout="out('-2821647309854503598');" style=""> 200         SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(newTableAlias, null, sqlParserPos);         </span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 201         SqlNode[] sqlNodes = new SqlNode[2];                                                             </span>
<span class="-7781715169306512157" onmouseenter="enter('-7781715169306512157');" onmouseout="out('-7781715169306512157');" style=""> 202         sqlNodes[0] = sqlNode0;                                                                          </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 203         sqlNodes[1] = sqlIdentifierAlias;                                                                </span>
<span class="-1928364106966605511" onmouseenter="enter('-1928364106966605511');" onmouseout="out('-1928364106966605511');" style=""> 204         return new SqlBasicCall(operator, sqlNodes, sqlParserPos);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205     }                                                                                                    </span>
<span  style=""> 206                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 207     /**                                                                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 208      *                                                                                                   </span>
<span class="-6040909485639107572" onmouseenter="enter('-6040909485639107572');" onmouseout="out('-6040909485639107572');" style=""> 209      * @param joinInfo                                                                                   </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 210      * @param sqlNode                                                                                    </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 211      * @param queueInfo                                                                                  </span>
<span class="-8382295939765334869" onmouseenter="enter('-8382295939765334869');" onmouseout="out('-8382295939765334869');" style=""> 212      * @return   两个边关联后的新表表名                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 213      */                                                                                                  </span>
<span class="-9105373632393246263" onmouseenter="enter('-9105373632393246263');" onmouseout="out('-9105373632393246263');" style=""><abbr title=" 214     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInfo) {"> 214     public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt;🔵</abbr></span>
<span class="-3012154526429275078" onmouseenter="enter('-3012154526429275078');" onmouseout="out('-3012154526429275078');" style=""> 215         //SideJoinInfo rename                                                                            </span>
<span class="4973038183558270709" onmouseenter="enter('4973038183558270709');" onmouseout="out('4973038183558270709');" style=""> 216         if (joinInfo.checkIsSide()) {                                                                    </span>
<span class="8408112480551688226" onmouseenter="enter('8408112480551688226');" onmouseout="out('8408112480551688226');" style=""> 217             joinInfo.setSelectFields(sqlNode.getSelectList());                                           </span>
<span class="4794732995049884760" onmouseenter="enter('4794732995049884760');" onmouseout="out('4794732995049884760');" style=""> 218             joinInfo.setSelectNode(sqlNode);                                                             </span>
<span class="1448684309320227021" onmouseenter="enter('1448684309320227021');" onmouseout="out('1448684309320227021');" style=""> 219             if (joinInfo.isRightIsSideTable()) {                                                         </span>
<span class="-476802833010893550" onmouseenter="enter('-476802833010893550');" onmouseout="out('-476802833010893550');" style=""> 220                 //Analyzing left is not a simple table                                                   </span>
<span class="6867568634948481821" onmouseenter="enter('6867568634948481821');" onmouseout="out('6867568634948481821');" style=""> 221                 if (joinInfo.getLeftNode().getKind() == SELECT) {                                        </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 222                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223                 }                                                                                        </span>
<span  style=""> 224                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 225                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 226             } else {                                                                                     </span>
<span class="5635813491573439188" onmouseenter="enter('5635813491573439188');" onmouseout="out('5635813491573439188');" style=""> 227                 //Determining right is not a simple table                                                </span>
<span class="2468473214053427731" onmouseenter="enter('2468473214053427731');" onmouseout="out('2468473214053427731');" style=""> 228                 if (joinInfo.getRightNode().getKind() == SELECT) {                                       </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 229                     queueInfo.offer(joinInfo.getLeftNode());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230                 }                                                                                        </span>
<span  style=""> 231                                                                                                          </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 232                 queueInfo.offer(joinInfo);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233             }                                                                                            </span>
<span class="-7933690095328677787" onmouseenter="enter('-7933690095328677787');" onmouseout="out('-7933690095328677787');" style=""> 234             replaceFromNodeForJoin(joinInfo, sqlNode);                                                   </span>
<span class="-3213976632367322289" onmouseenter="enter('-3213976632367322289');" onmouseout="out('-3213976632367322289');" style=""> 235             return joinInfo.getNewTableName();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236         }                                                                                                </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 237         return &quot;&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238     }                                                                                                    </span>
<span  style=""> 239                                                                                                          </span>
<span class="8074977299710029932" onmouseenter="enter('8074977299710029932');" onmouseout="out('8074977299710029932');" style=""> 240     public static void replaceFromNodeForJoin(JoinInfo joinInfo, SqlSelect sqlNode) {                    </span>
<span class="-9060489602533315077" onmouseenter="enter('-9060489602533315077');" onmouseout="out('-9060489602533315077');" style=""> 241         //Update from node                                                                               </span>
<span class="2204164800083526508" onmouseenter="enter('2204164800083526508');" onmouseout="out('2204164800083526508');" style=""> 242         SqlBasicCall sqlBasicCall = buildAsNodeByJoinInfo(joinInfo, null, null);                         </span>
<span class="-8082788431941340980" onmouseenter="enter('-8082788431941340980');" onmouseout="out('-8082788431941340980');" style=""> 243         String newAliasName = sqlBasicCall.operand(1).toString();                                        </span>
<span  style=""> 244                                                                                                          </span>
<span class="-4706120631660601296" onmouseenter="enter('-4706120631660601296');" onmouseout="out('-4706120631660601296');" style=""> 245         //替换select 中的属性为新的表名称和字段                                                                         </span>
<span class="8210217038029633734" onmouseenter="enter('8210217038029633734');" onmouseout="out('8210217038029633734');" style=""> 246         HashBasedTable&lt;String, String, String&gt; fieldMapping = joinInfo.getTableFieldRef();               </span>
<span class="-6200687028928637107" onmouseenter="enter('-6200687028928637107');" onmouseout="out('-6200687028928637107');" style=""> 247         Map&lt;String, String&gt; leftFieldMapping = fieldMapping.row(joinInfo.getLeftTableAlias());           </span>
<span class="6534080411824570705" onmouseenter="enter('6534080411824570705');" onmouseout="out('6534080411824570705');" style=""> 248         Map&lt;String, String&gt; rightFieldMapping = fieldMapping.row(joinInfo.getRightTableAlias());         </span>
<span  style=""> 249                                                                                                          </span>
<span class="-7880903214764896195" onmouseenter="enter('-7880903214764896195');" onmouseout="out('-7880903214764896195');" style=""> 250        /* for(SqlNode oneSelectNode : sqlNode.getSelectList()){                                          </span>
<span class="-4957689359258588920" onmouseenter="enter('-4957689359258588920');" onmouseout="out('-4957689359258588920');" style=""><abbr title=" 251             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapping);"> 251             replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,left🔵</abbr></span>
<span class="6269709593519335658" onmouseenter="enter('6269709593519335658');" onmouseout="out('6269709593519335658');" style=""><abbr title=" 252             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldMapping);"> 252             replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , ri🔵</abbr></span>
<span class="-2684617365274670769" onmouseenter="enter('-2684617365274670769');" onmouseout="out('-2684617365274670769');" style=""> 253         }*/                                                                                              </span>
<span  style=""> 254                                                                                                          </span>
<span class="2103765898996250551" onmouseenter="enter('2103765898996250551');" onmouseout="out('2103765898996250551');" style=""> 255         //where中的条件属性为新的表名称和字段                                                                           </span>
<span class="1856147124472045117" onmouseenter="enter('1856147124472045117');" onmouseout="out('1856147124472045117');" style=""><abbr title=" 256         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldMapping);"> 256         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldM🔵</abbr></span>
<span class="5021450334630795014" onmouseenter="enter('5021450334630795014');" onmouseout="out('5021450334630795014');" style=""><abbr title=" 257         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping);"> 257         FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFiel🔵</abbr></span>
<span class="2813845980666839305" onmouseenter="enter('2813845980666839305');" onmouseout="out('2813845980666839305');" style=""> 258         sqlNode.setFrom(sqlBasicCall);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span  style=""> 260                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 261     /**                                                                                                  </span>
<span class="-9165896841480454412" onmouseenter="enter('-9165896841480454412');" onmouseout="out('-9165896841480454412');" style=""> 262      * 获取节点关联的查询表                                                                                        </span>
<span class="4587700153042038306" onmouseenter="enter('4587700153042038306');" onmouseout="out('4587700153042038306');" style=""> 263      * @param fromTable                                                                                  </span>
<span class="-4525819317820325084" onmouseenter="enter('-4525819317820325084');" onmouseout="out('-4525819317820325084');" style=""> 264      * @param tableNameSet                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 265      */                                                                                                  </span>
<span class="-6773005969473787299" onmouseenter="enter('-6773005969473787299');" onmouseout="out('-6773005969473787299');" style=""> 266     public static void getFromTableInfo(SqlNode fromTable, Set&lt;String&gt; tableNameSet){                    </span>
<span class="-6901511047628253115" onmouseenter="enter('-6901511047628253115');" onmouseout="out('-6901511047628253115');" style=""> 267         SqlKind sqlKind = fromTable.getKind();                                                           </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 268         switch (sqlKind){                                                                                </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 269             case AS:                                                                                     </span>
<span class="6170293684489173764" onmouseenter="enter('6170293684489173764');" onmouseout="out('6170293684489173764');" style=""> 270                 SqlNode alias = ((SqlBasicCall) fromTable).getOperands()[1];                             </span>
<span class="-4660347064811459637" onmouseenter="enter('-4660347064811459637');" onmouseout="out('-4660347064811459637');" style=""> 271                 tableNameSet.add(alias.toString());                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 272                 return;                                                                                  </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 273             case JOIN:                                                                                   </span>
<span class="7200443719768955748" onmouseenter="enter('7200443719768955748');" onmouseout="out('7200443719768955748');" style=""> 274                 getFromTableInfo(((SqlJoin)fromTable).getLeft(), tableNameSet);                          </span>
<span class="-579883461259105749" onmouseenter="enter('-579883461259105749');" onmouseout="out('-579883461259105749');" style=""> 275                 getFromTableInfo(((SqlJoin)fromTable).getRight(), tableNameSet);                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 276                 return;                                                                                  </span>
<span class="-2304009782660987725" onmouseenter="enter('-2304009782660987725');" onmouseout="out('-2304009782660987725');" style=""> 277             case IDENTIFIER:                                                                             </span>
<span class="6063930725080162048" onmouseenter="enter('6063930725080162048');" onmouseout="out('6063930725080162048');" style=""> 278                 tableNameSet.add(((SqlIdentifier)fromTable).getSimple());                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 279                 return;                                                                                  </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 280             case SELECT:                                                                                 </span>
<span class="4670049027501902925" onmouseenter="enter('4670049027501902925');" onmouseout="out('4670049027501902925');" style=""> 281                 getFromTableInfo(((SqlSelect) fromTable).getFrom(), tableNameSet);                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 282                 return;                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 283             default:                                                                                     </span>
<span class="9006089180628885729" onmouseenter="enter('9006089180628885729');" onmouseout="out('9006089180628885729');" style=""> 284                 throw new RuntimeException(&quot;not support sqlKind:&quot; + sqlKind);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286     }                                                                                                    </span>
<span  style=""> 287                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 288     /**                                                                                                  </span>
<span class="8536034367776161836" onmouseenter="enter('8536034367776161836');" onmouseout="out('8536034367776161836');" style=""> 289      * 替换select 中的字段信息                                                                                   </span>
<span class="8563350786440524200" onmouseenter="enter('8563350786440524200');" onmouseout="out('8563350786440524200');" style=""> 290      * 如果mappingTable 非空则从该参数获取字段的映射                                                                     </span>
<span class="-6581838769493343810" onmouseenter="enter('-6581838769493343810');" onmouseout="out('-6581838769493343810');" style=""> 291      * 如果mappingTable 为空则根据是否存在新生成字段                                                                     </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 292      * @param selectNode                                                                                 </span>
<span class="-2283388782413973238" onmouseenter="enter('-2283388782413973238');" onmouseout="out('-2283388782413973238');" style=""> 293      * @param oldTbName                                                                                  </span>
<span class="7634289987105314089" onmouseenter="enter('7634289987105314089');" onmouseout="out('7634289987105314089');" style=""> 294      * @param newTbName                                                                                  </span>
<span class="8769527040545279755" onmouseenter="enter('8769527040545279755');" onmouseout="out('8769527040545279755');" style=""> 295      * @param fieldReplaceRef                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 296      */                                                                                                  </span>
<span class="5027529910148445847" onmouseenter="enter('5027529910148445847');" onmouseout="out('5027529910148445847');" style=""> 297     public static void replaceSelectFieldTable(SqlNode selectNode,                                       </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 298                                                String oldTbName,                                         </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 299                                                String newTbName,                                         </span>
<span class="7882147930720524356" onmouseenter="enter('7882147930720524356');" onmouseout="out('7882147930720524356');" style=""> 300                                                HashBiMap&lt;String, String&gt; fieldReplaceRef) {              </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 301         if (selectNode.getKind() == AS) {                                                                </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 302             SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                             </span>
<span class="-4674775763706954352" onmouseenter="enter('-4674775763706954352');" onmouseout="out('-4674775763706954352');" style=""> 303             replaceSelectFieldTable(leftNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span  style=""> 304                                                                                                          </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 305         }else if(selectNode.getKind() == IDENTIFIER){                                                    </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 306             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 308             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="-1755167016071657820" onmouseenter="enter('-1755167016071657820');" onmouseout="out('-1755167016071657820');" style=""> 309                 return ;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310             }                                                                                            </span>
<span  style=""> 311                                                                                                          </span>
<span class="1355631215618064105" onmouseenter="enter('1355631215618064105');" onmouseout="out('1355631215618064105');" style=""> 312             String fieldTableName = sqlIdentifier.names.get(0);                                          </span>
<span class="-2979536462712829146" onmouseenter="enter('-2979536462712829146');" onmouseout="out('-2979536462712829146');" style=""> 313             if(oldTbName.equalsIgnoreCase(fieldTableName)){                                              </span>
<span class="-4556037184452828083" onmouseenter="enter('-4556037184452828083');" onmouseout="out('-4556037184452828083');" style=""> 314                 replaceOneSelectField(sqlIdentifier, newTbName, oldTbName, fieldReplaceRef);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span  style=""> 316                                                                                                          </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 317         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 318             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 319         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 320                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 321                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 322                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 323                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 324                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 325                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 326                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 327                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 328                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 329                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 330                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 331                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 332                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 333                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 334                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 335                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 336                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 337                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 338                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 339                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 340                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 341                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 342                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 343                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 344                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 345                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 346                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 347                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 348                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 349                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 350         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 351             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 352             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 353                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 354                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 355                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356                 }                                                                                        </span>
<span  style=""> 357                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 358                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 359                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 360                 }                                                                                        </span>
<span  style=""> 361                                                                                                          </span>
<span class="-5676526903547679293" onmouseenter="enter('-5676526903547679293');" onmouseout="out('-5676526903547679293');" style=""> 362                 replaceSelectFieldTable(sqlNode, oldTbName, newTbName, fieldReplaceRef);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363             }                                                                                            </span>
<span  style=""> 364                                                                                                          </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 365         }else if(selectNode.getKind() == CASE){                                                          </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 366             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 367             SqlNodeList whenOperands = sqlCase.getWhenOperands();                                        </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 368             SqlNodeList thenOperands = sqlCase.getThenOperands();                                        </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 369             SqlNode elseNode = sqlCase.getElseOperand();                                                 </span>
<span  style=""> 370                                                                                                          </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 371             for(int i=0; i&lt;whenOperands.size(); i++){                                                    </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 372                 SqlNode oneOperand = whenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 373                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374             }                                                                                            </span>
<span  style=""> 375                                                                                                          </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 376             for(int i=0; i&lt;thenOperands.size(); i++){                                                    </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 377                 SqlNode oneOperand = thenOperands.get(i);                                                </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 378                 replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);              </span>
<span  style=""> 379                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380             }                                                                                            </span>
<span  style=""> 381                                                                                                          </span>
<span class="-7763620435664145090" onmouseenter="enter('-7763620435664145090');" onmouseout="out('-7763620435664145090');" style=""> 382             replaceSelectFieldTable(elseNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 383         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 384             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 385             return;                                                                                      </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 386         }else{                                                                                           </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 387             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 387             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389     }                                                                                                    </span>
<span  style=""> 390                                                                                                          </span>
<span class="-8462314785940972235" onmouseenter="enter('-8462314785940972235');" onmouseout="out('-8462314785940972235');" style=""> 391     private static void replaceOneSelectField(SqlIdentifier sqlIdentifier,                               </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 392                                               String newTbName,                                          </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 393                                               String oldTbName,                                          </span>
<span class="-123666790994587736" onmouseenter="enter('-123666790994587736');" onmouseout="out('-123666790994587736');" style=""> 394                                               HashBiMap&lt;String, String&gt; fieldReplaceRef){                </span>
<span class="5409837540655806029" onmouseenter="enter('5409837540655806029');" onmouseout="out('5409837540655806029');" style=""> 395         SqlIdentifier newField = sqlIdentifier.setName(0, newTbName);                                    </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 396         String fieldName = sqlIdentifier.names.get(1);                                                   </span>
<span class="383429695235202001" onmouseenter="enter('383429695235202001');" onmouseout="out('383429695235202001');" style=""> 397         String fieldKey = oldTbName + &quot;_&quot; + fieldName;                                                   </span>
<span  style=""> 398                                                                                                          </span>
<span class="-6721872198205274351" onmouseenter="enter('-6721872198205274351');" onmouseout="out('-6721872198205274351');" style=""> 399         if(!fieldReplaceRef.containsKey(fieldKey)){                                                      </span>
<span class="-8417061839432085011" onmouseenter="enter('-8417061839432085011');" onmouseout="out('-8417061839432085011');" style=""> 400             if(fieldReplaceRef.inverse().get(fieldName) != null){                                        </span>
<span class="3563776056422158867" onmouseenter="enter('3563776056422158867');" onmouseout="out('3563776056422158867');" style=""> 401                 //换一个名字                                                                                  </span>
<span class="6269694230999482502" onmouseenter="enter('6269694230999482502');" onmouseout="out('6269694230999482502');" style=""> 402                 String mappingFieldName = ParseUtils.dealDuplicateFieldName(fieldReplaceRef, fieldName); </span>
<span class="730243385989967976" onmouseenter="enter('730243385989967976');" onmouseout="out('730243385989967976');" style=""> 403                 newField = newField.setName(1, mappingFieldName);                                        </span>
<span class="-8843946047709268866" onmouseenter="enter('-8843946047709268866');" onmouseout="out('-8843946047709268866');" style=""> 404                 fieldReplaceRef.put(fieldKey, mappingFieldName);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 405             } else {                                                                                     </span>
<span class="8037669429324652271" onmouseenter="enter('8037669429324652271');" onmouseout="out('8037669429324652271');" style=""> 406                 fieldReplaceRef.put(fieldKey, fieldName);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407             }                                                                                            </span>
<span class="-6497049907687009769" onmouseenter="enter('-6497049907687009769');" onmouseout="out('-6497049907687009769');" style=""> 408         }else {                                                                                          </span>
<span class="-8559329898165326450" onmouseenter="enter('-8559329898165326450');" onmouseout="out('-8559329898165326450');" style=""> 409             newField = newField.setName(1, fieldReplaceRef.get(fieldKey));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410         }                                                                                                </span>
<span  style=""> 411                                                                                                          </span>
<span class="-3197795073308056747" onmouseenter="enter('-3197795073308056747');" onmouseout="out('-3197795073308056747');" style=""> 412         sqlIdentifier.assignNamesFrom(newField);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413     }                                                                                                    </span>
<span  style=""> 414                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 415     /**                                                                                                  </span>
<span class="5461903081523405406" onmouseenter="enter('5461903081523405406');" onmouseout="out('5461903081523405406');" style=""> 416      * 替换另外join 表的指定表名为新关联处理的表名称                                                                         </span>
<span class="-4160812560585701802" onmouseenter="enter('-4160812560585701802');" onmouseout="out('-4160812560585701802');" style=""> 417      * @param condition                                                                                  </span>
<span class="-653368829907055509" onmouseenter="enter('-653368829907055509');" onmouseout="out('-653368829907055509');" style=""> 418      * @param oldTabFieldRefNew                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 419      */                                                                                                  </span>
<span class="3319102281402941993" onmouseenter="enter('3319102281402941993');" onmouseout="out('3319102281402941993');" style=""><abbr title=" 420     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRefNew){"> 420     public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRef🔵</abbr></span>
<span class="5716706160133851170" onmouseenter="enter('5716706160133851170');" onmouseout="out('5716706160133851170');" style=""> 421         if (null == condition || condition.getKind() == LITERAL) {                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 422             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423         }                                                                                                </span>
<span class="5418896256960850645" onmouseenter="enter('5418896256960850645');" onmouseout="out('5418896256960850645');" style=""> 424         SqlKind joinKind = condition.getKind();                                                          </span>
<span class="-872109993356374898" onmouseenter="enter('-872109993356374898');" onmouseout="out('-872109993356374898');" style=""> 425         if( AGGREGATE.contains(joinKind)                                                                 </span>
<span class="6718918766222840749" onmouseenter="enter('6718918766222840749');" onmouseout="out('6718918766222840749');" style=""> 426                 || AVG_AGG_FUNCTIONS.contains(joinKind)                                                  </span>
<span class="-5795763144400386668" onmouseenter="enter('-5795763144400386668');" onmouseout="out('-5795763144400386668');" style=""> 427                 || COMPARISON.contains(joinKind)                                                         </span>
<span class="-8649262116164241163" onmouseenter="enter('-8649262116164241163');" onmouseout="out('-8649262116164241163');" style=""> 428                 || joinKind == OTHER_FUNCTION                                                            </span>
<span class="-5055598318919357044" onmouseenter="enter('-5055598318919357044');" onmouseout="out('-5055598318919357044');" style=""> 429                 || joinKind == DIVIDE                                                                    </span>
<span class="-5590854516630695190" onmouseenter="enter('-5590854516630695190');" onmouseout="out('-5590854516630695190');" style=""> 430                 || joinKind == CAST                                                                      </span>
<span class="-4942353295577364183" onmouseenter="enter('-4942353295577364183');" onmouseout="out('-4942353295577364183');" style=""> 431                 || joinKind == TRIM                                                                      </span>
<span class="3915078205687144262" onmouseenter="enter('3915078205687144262');" onmouseout="out('3915078205687144262');" style=""> 432                 || joinKind == TIMES                                                                     </span>
<span class="-1723358202983235773" onmouseenter="enter('-1723358202983235773');" onmouseout="out('-1723358202983235773');" style=""> 433                 || joinKind == PLUS                                                                      </span>
<span class="-5069307841224953084" onmouseenter="enter('-5069307841224953084');" onmouseout="out('-5069307841224953084');" style=""> 434                 || joinKind == NOT_IN                                                                    </span>
<span class="-2425336955836765254" onmouseenter="enter('-2425336955836765254');" onmouseout="out('-2425336955836765254');" style=""> 435                 || joinKind == OR                                                                        </span>
<span class="4152669671898758851" onmouseenter="enter('4152669671898758851');" onmouseout="out('4152669671898758851');" style=""> 436                 || joinKind == AND                                                                       </span>
<span class="8469231591142723332" onmouseenter="enter('8469231591142723332');" onmouseout="out('8469231591142723332');" style=""> 437                 || joinKind == MINUS                                                                     </span>
<span class="-8975416296405207931" onmouseenter="enter('-8975416296405207931');" onmouseout="out('-8975416296405207931');" style=""> 438                 || joinKind == TUMBLE                                                                    </span>
<span class="-2000447344068332492" onmouseenter="enter('-2000447344068332492');" onmouseout="out('-2000447344068332492');" style=""> 439                 || joinKind == TUMBLE_START                                                              </span>
<span class="-2660655228869248711" onmouseenter="enter('-2660655228869248711');" onmouseout="out('-2660655228869248711');" style=""> 440                 || joinKind == TUMBLE_END                                                                </span>
<span class="611140839719638142" onmouseenter="enter('611140839719638142');" onmouseout="out('611140839719638142');" style=""> 441                 || joinKind == SESSION                                                                   </span>
<span class="-4719587108970880084" onmouseenter="enter('-4719587108970880084');" onmouseout="out('-4719587108970880084');" style=""> 442                 || joinKind == SESSION_START                                                             </span>
<span class="-8416806901357633870" onmouseenter="enter('-8416806901357633870');" onmouseout="out('-8416806901357633870');" style=""> 443                 || joinKind == SESSION_END                                                               </span>
<span class="1350987570876390511" onmouseenter="enter('1350987570876390511');" onmouseout="out('1350987570876390511');" style=""> 444                 || joinKind == HOP                                                                       </span>
<span class="-1881854797876652455" onmouseenter="enter('-1881854797876652455');" onmouseout="out('-1881854797876652455');" style=""> 445                 || joinKind == HOP_START                                                                 </span>
<span class="8861207018381483306" onmouseenter="enter('8861207018381483306');" onmouseout="out('8861207018381483306');" style=""> 446                 || joinKind == HOP_END                                                                   </span>
<span class="-8001520670756666177" onmouseenter="enter('-8001520670756666177');" onmouseout="out('-8001520670756666177');" style=""> 447                 || joinKind == BETWEEN                                                                   </span>
<span class="-8652641138853954718" onmouseenter="enter('-8652641138853954718');" onmouseout="out('-8652641138853954718');" style=""> 448                 || joinKind == IS_NULL                                                                   </span>
<span class="-3447385425080227914" onmouseenter="enter('-3447385425080227914');" onmouseout="out('-3447385425080227914');" style=""> 449                 || joinKind == IS_NOT_NULL                                                               </span>
<span class="-7170411514740971639" onmouseenter="enter('-7170411514740971639');" onmouseout="out('-7170411514740971639');" style=""> 450                 || joinKind == CONTAINS                                                                  </span>
<span class="2023943706482563039" onmouseenter="enter('2023943706482563039');" onmouseout="out('2023943706482563039');" style=""> 451                 || joinKind == TIMESTAMP_ADD                                                             </span>
<span class="-2326108897925880210" onmouseenter="enter('-2326108897925880210');" onmouseout="out('-2326108897925880210');" style=""> 452                 || joinKind == TIMESTAMP_DIFF                                                            </span>
<span class="-853383041741207972" onmouseenter="enter('-853383041741207972');" onmouseout="out('-853383041741207972');" style=""> 453                 || joinKind == LIKE                                                                      </span>
<span class="6751598071686393893" onmouseenter="enter('6751598071686393893');" onmouseout="out('6751598071686393893');" style=""> 454                 || joinKind == COALESCE                                                                  </span>
<span class="-6635050181630823497" onmouseenter="enter('-6635050181630823497');" onmouseout="out('-6635050181630823497');" style=""> 455                 || joinKind == EQUALS ){                                                                 </span>
<span  style=""> 456                                                                                                          </span>
<span class="-2541170249719279546" onmouseenter="enter('-2541170249719279546');" onmouseout="out('-2541170249719279546');" style=""> 457             SqlBasicCall sqlBasicCall = (SqlBasicCall) condition;                                        </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 458             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 459                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 460                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 461                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462                 }                                                                                        </span>
<span  style=""> 463                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 464                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 465                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466                 }                                                                                        </span>
<span  style=""> 467                                                                                                          </span>
<span class="9093647197598049539" onmouseenter="enter('9093647197598049539');" onmouseout="out('9093647197598049539');" style=""> 468                 replaceJoinFieldRefTableName(sqlNode, oldTabFieldRefNew);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469             }                                                                                            </span>
<span  style=""> 470                                                                                                          </span>
<span class="-3321512503468929771" onmouseenter="enter('-3321512503468929771');" onmouseout="out('-3321512503468929771');" style=""> 471         } else if (condition.getKind() == IDENTIFIER) {                                                  </span>
<span class="3421902236901684905" onmouseenter="enter('3421902236901684905');" onmouseout="out('3421902236901684905');" style=""><abbr title=" 472             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format table.field&quot;);"> 472             Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must b🔵</abbr></span>
<span class="5832438568991919450" onmouseenter="enter('5832438568991919450');" onmouseout="out('5832438568991919450');" style=""> 473             String fieldRefTable = ((SqlIdentifier)condition).names.get(0);                              </span>
<span  style=""> 474                                                                                                          </span>
<span class="8100744064870187141" onmouseenter="enter('8100744064870187141');" onmouseout="out('8100744064870187141');" style=""><abbr title=" 475             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString());"> 475             String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString()🔵</abbr></span>
<span  style=""> 476                                                                                                          </span>
<span class="8753124522689816475" onmouseenter="enter('8753124522689816475');" onmouseout="out('8753124522689816475');" style=""> 477             if(StringUtils.isNotBlank(targetFieldName)){                                                 </span>
<span class="549628471692842965" onmouseenter="enter('549628471692842965');" onmouseout="out('549628471692842965');" style=""> 478                 String[] fieldSplits = StringUtils.split(targetFieldName, &quot;.&quot;);                          </span>
<span class="-4590973079341848831" onmouseenter="enter('-4590973079341848831');" onmouseout="out('-4590973079341848831');" style=""> 479                 SqlIdentifier newField = ((SqlIdentifier)condition).setName(0, fieldSplits[0]);          </span>
<span class="-2128195046647686450" onmouseenter="enter('-2128195046647686450');" onmouseout="out('-2128195046647686450');" style=""> 480                 newField = newField.setName(1, fieldSplits[1]);                                          </span>
<span class="3184949241141894727" onmouseenter="enter('3184949241141894727');" onmouseout="out('3184949241141894727');" style=""> 481                 ((SqlIdentifier)condition).assignNamesFrom(newField);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span class="2909357842222016806" onmouseenter="enter('2909357842222016806');" onmouseout="out('2909357842222016806');" style=""> 486     public static String getTargetRefTable(Map&lt;String, String&gt; refTableMap, String tableName){           </span>
<span class="8928515954503116985" onmouseenter="enter('8928515954503116985');" onmouseout="out('8928515954503116985');" style=""> 487         String targetTableName = null;                                                                   </span>
<span class="-7988911072327938473" onmouseenter="enter('-7988911072327938473');" onmouseout="out('-7988911072327938473');" style=""> 488         String preTableName;                                                                             </span>
<span  style=""> 489                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 490         do {                                                                                             </span>
<span class="-8410406414279039842" onmouseenter="enter('-8410406414279039842');" onmouseout="out('-8410406414279039842');" style=""> 491             preTableName = targetTableName == null ? tableName : targetTableName;                        </span>
<span class="-6937575046812844068" onmouseenter="enter('-6937575046812844068');" onmouseout="out('-6937575046812844068');" style=""> 492             targetTableName = refTableMap.get(preTableName);                                             </span>
<span class="2145360151323546808" onmouseenter="enter('2145360151323546808');" onmouseout="out('2145360151323546808');" style=""> 493         } while (targetTableName != null);                                                               </span>
<span  style=""> 494                                                                                                          </span>
<span class="-2669935656864379097" onmouseenter="enter('-2669935656864379097');" onmouseout="out('-2669935656864379097');" style=""> 495         return preTableName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496     }                                                                                                    </span>
<span  style=""> 497                                                                                                          </span>
<span class="4252776571232827033" onmouseenter="enter('4252776571232827033');" onmouseout="out('4252776571232827033');" style=""> 498     public static String getTargetRefField(Map&lt;String, String&gt; refFieldMap, String currFieldName){       </span>
<span class="7313268804655149758" onmouseenter="enter('7313268804655149758');" onmouseout="out('7313268804655149758');" style=""> 499         String targetFieldName = null;                                                                   </span>
<span class="-8203442755027339079" onmouseenter="enter('-8203442755027339079');" onmouseout="out('-8203442755027339079');" style=""> 500         String preFieldName;                                                                             </span>
<span  style=""> 501                                                                                                          </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 502         do {                                                                                             </span>
<span class="5385129689109669577" onmouseenter="enter('5385129689109669577');" onmouseout="out('5385129689109669577');" style=""> 503             preFieldName = targetFieldName == null ? currFieldName : targetFieldName;                    </span>
<span class="-3091793637238102945" onmouseenter="enter('-3091793637238102945');" onmouseout="out('-3091793637238102945');" style=""> 504             targetFieldName = refFieldMap.get(preFieldName);                                             </span>
<span class="-8916552568071022335" onmouseenter="enter('-8916552568071022335');" onmouseout="out('-8916552568071022335');" style=""> 505         } while (targetFieldName != null);                                                               </span>
<span  style=""> 506                                                                                                          </span>
<span class="5199537743604417658" onmouseenter="enter('5199537743604417658');" onmouseout="out('5199537743604417658');" style=""> 507         return preFieldName;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508     }                                                                                                    </span>
<span  style=""> 509                                                                                                          </span>
<span class="-8300425435366196840" onmouseenter="enter('-8300425435366196840');" onmouseout="out('-8300425435366196840');" style=""><abbr title=" 510     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef){"> 510     public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, Has🔵</abbr></span>
<span  style=""> 511                                                                                                          </span>
<span class="-7344361739038630250" onmouseenter="enter('-7344361739038630250');" onmouseout="out('-7344361739038630250');" style=""> 512         if(parentWhere == null){                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 513             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514         }                                                                                                </span>
<span  style=""> 515                                                                                                          </span>
<span class="7198030462908925381" onmouseenter="enter('7198030462908925381');" onmouseout="out('7198030462908925381');" style=""> 516         SqlKind kind = parentWhere.getKind();                                                            </span>
<span class="-1872623569752802183" onmouseenter="enter('-1872623569752802183');" onmouseout="out('-1872623569752802183');" style=""> 517         if(kind == AND){                                                                                 </span>
<span class="2829943023301943879" onmouseenter="enter('2829943023301943879');" onmouseout="out('2829943023301943879');" style=""><abbr title=" 518             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplaceRef);"> 518             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fi🔵</abbr></span>
<span class="-4556945615844132104" onmouseenter="enter('-4556945615844132104');" onmouseout="out('-4556945615844132104');" style=""><abbr title=" 519             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplaceRef);"> 519             replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fi🔵</abbr></span>
<span  style=""> 520                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 521         } else {                                                                                         </span>
<span class="8766459294285823468" onmouseenter="enter('8766459294285823468');" onmouseout="out('8766459294285823468');" style=""> 522             replaceConditionNode(parentWhere, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524     }                                                                                                    </span>
<span  style=""> 525                                                                                                          </span>
<span class="7802005378818510825" onmouseenter="enter('7802005378818510825');" onmouseout="out('7802005378818510825');" style=""><abbr title=" 526     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef) {"> 526     private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, Hash🔵</abbr></span>
<span class="8405601494998756480" onmouseenter="enter('8405601494998756480');" onmouseout="out('8405601494998756480');" style=""> 527         if(selectNode.getKind() == IDENTIFIER){                                                          </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 528             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 529                                                                                                          </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 530             if(sqlIdentifier.names.size() == 1){                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 531                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532             }                                                                                            </span>
<span  style=""> 533                                                                                                          </span>
<span class="318397782816978051" onmouseenter="enter('318397782816978051');" onmouseout="out('318397782816978051');" style=""> 534             String tableName = sqlIdentifier.names.asList().get(0);                                      </span>
<span class="5268132787378326987" onmouseenter="enter('5268132787378326987');" onmouseout="out('5268132787378326987');" style=""> 535             String tableField = sqlIdentifier.names.asList().get(1);                                     </span>
<span class="-2565165445763658517" onmouseenter="enter('-2565165445763658517');" onmouseout="out('-2565165445763658517');" style=""> 536             String fieldKey = tableName + &quot;_&quot; + tableField;                                              </span>
<span  style=""> 537                                                                                                          </span>
<span class="-3841275234863465094" onmouseenter="enter('-3841275234863465094');" onmouseout="out('-3841275234863465094');" style=""> 538             if(tableName.equalsIgnoreCase(oldTbName)){                                                   </span>
<span  style=""> 539                                                                                                          </span>
<span class="-7486276484118623043" onmouseenter="enter('-7486276484118623043');" onmouseout="out('-7486276484118623043');" style=""><abbr title=" 540                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fieldKey);"> 540                 String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRe🔵</abbr></span>
<span class="-85150012511262136" onmouseenter="enter('-85150012511262136');" onmouseout="out('-85150012511262136');" style=""> 541                 SqlIdentifier newField = ((SqlIdentifier)selectNode).setName(0, newTbName);              </span>
<span class="-3325104965504513825" onmouseenter="enter('-3325104965504513825');" onmouseout="out('-3325104965504513825');" style=""> 542                 newField = newField.setName(1, newFieldName);                                            </span>
<span class="-7494318194999571350" onmouseenter="enter('-7494318194999571350');" onmouseout="out('-7494318194999571350');" style=""> 543                 ((SqlIdentifier)selectNode).assignNamesFrom(newField);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544             }                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 545             return;                                                                                      </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 546         }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 547             return;                                                                                      </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 548         }else if(  AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 549                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 550                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 551                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 552                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 553                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 554                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 555                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 556                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 557                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 558                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 559                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 560                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 561                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 562                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 563                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 564                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 565                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 566                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 567                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 568                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 569                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 570                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 571                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 572                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 573                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 574                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 575                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 576                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 577                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 578                                                                                                          </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 579         ){                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 580             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 581             for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                      </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 582                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 583                 if(sqlNode instanceof SqlLiteral){                                                       </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 584                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585                 }                                                                                        </span>
<span  style=""> 586                                                                                                          </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 587                 if(sqlNode instanceof SqlDataTypeSpec){                                                  </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 588                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589                 }                                                                                        </span>
<span  style=""> 590                                                                                                          </span>
<span class="-2258996485445817623" onmouseenter="enter('-2258996485445817623');" onmouseout="out('-2258996485445817623');" style=""> 591                 replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 592             }                                                                                            </span>
<span  style=""> 593                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 594             return;                                                                                      </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 595         }else if(selectNode.getKind() == OTHER){                                                         </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 596             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 597             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 598         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 599             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 600                                                                                                          </span>
<span class="-2315512384759132147" onmouseenter="enter('-2315512384759132147');" onmouseout="out('-2315512384759132147');" style=""><abbr title=" 601             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 601             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-1345654988953747553" onmouseenter="enter('-1345654988953747553');" onmouseout="out('-1345654988953747553');" style=""><abbr title=" 602             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 602             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbNam🔵</abbr></span>
<span class="-7836146409865535589" onmouseenter="enter('-7836146409865535589');" onmouseout="out('-7836146409865535589');" style=""> 603             replaceConditionNode(sqlCase.getElseOperand(), oldTbName, newTbName, fieldReplaceRef);       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 604         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 605             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 605             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607     }                                                                                                    </span>
<span  style=""> 608                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 609     /**                                                                                                  </span>
<span class="1570055177673011707" onmouseenter="enter('1570055177673011707');" onmouseout="out('1570055177673011707');" style=""> 610      * 获取条件中关联的表信息                                                                                       </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 611      * @param selectNode                                                                                 </span>
<span class="-4813798938110383556" onmouseenter="enter('-4813798938110383556');" onmouseout="out('-4813798938110383556');" style=""> 612      * @param fieldInfos                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 613      */                                                                                                  </span>
<span class="7137057397975985823" onmouseenter="enter('7137057397975985823');" onmouseout="out('7137057397975985823');" style=""> 614     public static void getConditionRefTable(SqlNode selectNode, Set&lt;String&gt; fieldInfos) {                </span>
<span class="-3454817955506608063" onmouseenter="enter('-3454817955506608063');" onmouseout="out('-3454817955506608063');" style=""> 615         if (selectNode.getKind() == IDENTIFIER) {                                                        </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 616             SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                    </span>
<span  style=""> 617                                                                                                          </span>
<span class="380773342968557196" onmouseenter="enter('380773342968557196');" onmouseout="out('380773342968557196');" style=""> 618             fieldInfos.add(sqlIdentifier.toString());                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 619             return;                                                                                      </span>
<span class="6757358046968148413" onmouseenter="enter('6757358046968148413');" onmouseout="out('6757358046968148413');" style=""> 620         } else if (selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN) {//字面含义     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 621             return;                                                                                      </span>
<span class="-4023999264561783968" onmouseenter="enter('-4023999264561783968');" onmouseout="out('-4023999264561783968');" style=""> 622         } else if (AGGREGATE.contains(selectNode.getKind())                                              </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 623                 || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                      </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 624                 || COMPARISON.contains(selectNode.getKind())                                             </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 625                 || selectNode.getKind() == OTHER_FUNCTION                                                </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 626                 || selectNode.getKind() == DIVIDE                                                        </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 627                 || selectNode.getKind() == CAST                                                          </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 628                 || selectNode.getKind() == TRIM                                                          </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 629                 || selectNode.getKind() == TIMES                                                         </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 630                 || selectNode.getKind() == PLUS                                                          </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 631                 || selectNode.getKind() == NOT_IN                                                        </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 632                 || selectNode.getKind() == OR                                                            </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 633                 || selectNode.getKind() == AND                                                           </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 634                 || selectNode.getKind() == MINUS                                                         </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 635                 || selectNode.getKind() == TUMBLE                                                        </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 636                 || selectNode.getKind() == TUMBLE_START                                                  </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 637                 || selectNode.getKind() == TUMBLE_END                                                    </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 638                 || selectNode.getKind() == SESSION                                                       </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 639                 || selectNode.getKind() == SESSION_START                                                 </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 640                 || selectNode.getKind() == SESSION_END                                                   </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 641                 || selectNode.getKind() == HOP                                                           </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 642                 || selectNode.getKind() == HOP_START                                                     </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 643                 || selectNode.getKind() == HOP_END                                                       </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 644                 || selectNode.getKind() == BETWEEN                                                       </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 645                 || selectNode.getKind() == IS_NULL                                                       </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 646                 || selectNode.getKind() == IS_NOT_NULL                                                   </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 647                 || selectNode.getKind() == CONTAINS                                                      </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 648                 || selectNode.getKind() == TIMESTAMP_ADD                                                 </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 649                 || selectNode.getKind() == TIMESTAMP_DIFF                                                </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 650                 || selectNode.getKind() == LIKE                                                          </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 651                 || selectNode.getKind() == COALESCE                                                      </span>
<span  style=""> 652                                                                                                          </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 653                 ) {                                                                                      </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 654             SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                       </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 655             for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 656                 SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                         </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 657                 if (sqlNode instanceof SqlLiteral) {                                                     </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 658                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659                 }                                                                                        </span>
<span  style=""> 660                                                                                                          </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 661                 if (sqlNode instanceof SqlDataTypeSpec) {                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 662                     continue;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663                 }                                                                                        </span>
<span  style=""> 664                                                                                                          </span>
<span class="56198544928191592" onmouseenter="enter('56198544928191592');" onmouseout="out('56198544928191592');" style=""> 665                 getConditionRefTable(sqlNode, fieldInfos);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 666             }                                                                                            </span>
<span  style=""> 667                                                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 668             return;                                                                                      </span>
<span class="-2308646561142794789" onmouseenter="enter('-2308646561142794789');" onmouseout="out('-2308646561142794789');" style=""> 669         } else if (selectNode.getKind() == OTHER) {                                                      </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 670             //不处理                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 671             return;                                                                                      </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 672         } else if (selectNode.getKind() == CASE) {                                                       </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 673             SqlCase sqlCase = (SqlCase) selectNode;                                                      </span>
<span  style=""> 674                                                                                                          </span>
<span class="-3537580079884591293" onmouseenter="enter('-3537580079884591293');" onmouseout="out('-3537580079884591293');" style=""><abbr title=" 675             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 675             sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="2144257116225237462" onmouseenter="enter('2144257116225237462');" onmouseout="out('2144257116225237462');" style=""><abbr title=" 676             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));"> 676             sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInf🔵</abbr></span>
<span class="-5604248574568658683" onmouseenter="enter('-5604248574568658683');" onmouseout="out('-5604248574568658683');" style=""> 677             getConditionRefTable(sqlCase.getElseOperand(), fieldInfos);                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 678         } else {                                                                                         </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 679             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 679             throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 680         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681     }                                                                                                    </span>
<span  style=""> 682                                                                                                          </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style=""> 683     public static String buildTableField(String tableName, String fieldName){                            </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style=""> 684         return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685     }                                                                                                    </span>
<span  style=""> 686                                                                                                          </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style=""> 687     public static String buildTableNameWithScope(String tableName, String scope){                        </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style=""> 688         if(StringUtils.isEmpty(scope)){                                                                  </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 689             return tableName;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690         }                                                                                                </span>
<span  style=""> 691                                                                                                          </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style=""> 692         return tableName + &quot;_&quot; + scope;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693     }                                                                                                    </span>
<span  style=""> 694                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 695     /**                                                                                                  </span>
<span class="6497150561674133661" onmouseenter="enter('6497150561674133661');" onmouseout="out('6497150561674133661');" style=""> 696      * add constant join fields, using in such as hbase、redis etc kv database                            </span>
<span class="-8477144116998604047" onmouseenter="enter('-8477144116998604047');" onmouseout="out('-8477144116998604047');" style=""> 697      * @param keyMap                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 698      */                                                                                                  </span>
<span class="7525620767750394099" onmouseenter="enter('7525620767750394099');" onmouseout="out('7525620767750394099');" style=""> 699     public static void addConstant(Map&lt;String, Object&gt; keyMap, AbstractSideTableInfo sideTableInfo) {    </span>
<span class="3178460372749787756" onmouseenter="enter('3178460372749787756');" onmouseout="out('3178460372749787756');" style=""> 700         List&lt;PredicateInfo&gt; predicateInfos = sideTableInfo.getPredicateInfoes();                         </span>
<span class="-6183321864643515167" onmouseenter="enter('-6183321864643515167');" onmouseout="out('-6183321864643515167');" style=""> 701         final String name = sideTableInfo.getName();                                                     </span>
<span class="7309058727137890263" onmouseenter="enter('7309058727137890263');" onmouseout="out('7309058727137890263');" style=""> 702         for (PredicateInfo info : predicateInfos) {                                                      </span>
<span class="2363297685674950976" onmouseenter="enter('2363297685674950976');" onmouseout="out('2363297685674950976');" style=""> 703             if (info.getOwnerTable().equals(name)                                                        </span>
<span class="-1265448967873634704" onmouseenter="enter('-1265448967873634704');" onmouseout="out('-1265448967873634704');" style=""> 704                 &amp;&amp; info.getOperatorName().equals(&quot;=&quot;)) {                                                 </span>
<span class="-3488992775588585467" onmouseenter="enter('-3488992775588585467');" onmouseout="out('-3488992775588585467');" style=""> 705                 String condition = info.getCondition();                                                  </span>
<span class="-3376001444363563672" onmouseenter="enter('-3376001444363563672');" onmouseout="out('-3376001444363563672');" style=""> 706                 Matcher matcher = stringPattern.matcher(condition);                                      </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style=""> 707                 if (matcher.matches()) {                                                                 </span>
<span class="2819616911838313283" onmouseenter="enter('2819616911838313283');" onmouseout="out('2819616911838313283');" style=""> 708                     condition = condition.substring(1, condition.length() - 1);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 709                 }                                                                                        </span>
<span class="-2333073189429870453" onmouseenter="enter('-2333073189429870453');" onmouseout="out('-2333073189429870453');" style=""> 710                 keyMap.put(info.getFieldName(), condition);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 711             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 712         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 713     }                                                                                                    </span>
<span  style=""> 714                                                                                                          </span>
<span class="2487976933211654058" onmouseenter="enter('2487976933211654058');" onmouseout="out('2487976933211654058');" style=""><abbr title=" 715     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String rightTableName, String scope, Set&lt;String&gt; existTableNames) {"> 715     public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String righ🔵</abbr></span>
<span class="2401839376205144968" onmouseenter="enter('2401839376205144968');" onmouseout="out('2401839376205144968');" style=""> 716         //兼容左边表是as 的情况                                                                                   </span>
<span class="-7491675719679051269" onmouseenter="enter('-7491675719679051269');" onmouseout="out('-7491675719679051269');" style=""> 717         String leftStr = (Strings.isNullOrEmpty(leftTableName)) ? leftTableAlias : leftTableName;        </span>
<span class="5374261003420889336" onmouseenter="enter('5374261003420889336');" onmouseout="out('5374261003420889336');" style=""> 718         String newName = (leftStr + &quot;_&quot;) + rightTableName;                                               </span>
<span class="-8657233487191077119" onmouseenter="enter('-8657233487191077119');" onmouseout="out('-8657233487191077119');" style=""> 719         if (CollectionUtils.isEmpty(existTableNames)) {                                                  </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style=""> 720             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721         }                                                                                                </span>
<span class="-234751792023525655" onmouseenter="enter('-234751792023525655');" onmouseout="out('-234751792023525655');" style=""> 722         if (!existTableNames.contains(newName)) {                                                        </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style=""> 723             return TableUtils.buildTableNameWithScope(newName, scope);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724         }                                                                                                </span>
<span class="-5528773053948205393" onmouseenter="enter('-5528773053948205393');" onmouseout="out('-5528773053948205393');" style=""> 725         return (TableUtils.buildTableNameWithScope(newName, scope) + &quot;_&quot;) + System.currentTimeMillis();  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 726     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 727 }                                                                                                        </span>



























</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  20  package com.dtstack.flink.sql.util;                                                                               </span>
<span  style="">  21                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  23  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  24  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.side.PredicateInfo;                                                                  </span>
<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  26  import com.google.common.base.Preconditions;                                                                      </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  27  import com.google.common.base.Strings;                                                                            </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  28  import com.google.common.collect.HashBasedTable;                                                                  </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  29  import com.google.common.collect.HashBiMap;                                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  30  import com.google.common.collect.Lists;                                                                           </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  31  import com.google.common.collect.Sets;                                                                            </span>
<span class="5491780355398545512" onmouseenter="enter('5491780355398545512');" onmouseout="out('5491780355398545512');" style="">  32  import com.typesafe.config.ConfigException;                                                                       </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  33  import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  34  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  35  import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  36  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  37  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  38  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  39  import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  40  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  41  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  42  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  43  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  44  import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  45  import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>

<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  46  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  47  import org.apache.flink.table.api.Table;                                                                          </span>
<span  style="">  48                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  51  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  52  import java.util.Set;                                                                                             </span>
<span class="2159928926335330273" onmouseenter="enter('2159928926335330273');" onmouseout="out('2159928926335330273');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +import java.util.regex.Matcher;                                                                                   </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import java.util.regex.Pattern;                                                                                   </span>
<span  style="">  55                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  56  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span class="511836661302622038" onmouseenter="enter('511836661302622038');" onmouseout="out('511836661302622038');" style="">  57  import static org.apache.calcite.sql.SqlKind.CASE;                                                                </span>
<span class="178844392791952204" onmouseenter="enter('178844392791952204');" onmouseout="out('178844392791952204');" style="">  58  import static org.apache.calcite.sql.SqlKind.OTHER;                                                               </span>
<span  style="">  59                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  60  /**                                                                                                               </span>
<span class="2491900718050250190" onmouseenter="enter('2491900718050250190');" onmouseout="out('2491900718050250190');" style="">  61   * 表的解析相关                                                                                                         </span>
<span class="-831295595380638887" onmouseenter="enter('-831295595380638887');" onmouseout="out('-831295595380638887');" style="">  62   * Date: 2020/2/17                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  63   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  64   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  65   */                                                                                                               </span>
<span  style="">  66                                                                                                                    </span>
<span class="-5515152307095787287" onmouseenter="enter('-5515152307095787287');" onmouseout="out('-5515152307095787287');" style="">  67  public class TableUtils {                                                                                         </span>
<span  style="">  68                                                                                                                    </span>
<span class="6670707421612748000" onmouseenter="enter('6670707421612748000');" onmouseout="out('6670707421612748000');" style="">  69      public static final char SPLIT = &#x27;_&#x27;;                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -                                                                                                                  </span>
<span class="-3060398288124517436" onmouseenter="enter('-3060398288124517436');" onmouseout="out('-3060398288124517436');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +    public static final Pattern stringPattern = Pattern.compile(&quot;\&quot;.*?\&quot;|\&#x27;.*?\&#x27;&quot;);                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  72      /**                                                                                                           </span>
<span class="-3835139450942807208" onmouseenter="enter('-3835139450942807208');" onmouseout="out('-3835139450942807208');" style="">  73       * 获取select 的字段                                                                                               </span>
<span class="-592626010544206006" onmouseenter="enter('-592626010544206006');" onmouseout="out('-592626010544206006');" style="">  74       * @param sqlSelect                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  75       */                                                                                                           </span>
<span class="-662197916250462065" onmouseenter="enter('-662197916250462065');" onmouseout="out('-662197916250462065');" style="">  76      public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCache){     </span>
<span class="8036786023408828043" onmouseenter="enter('8036786023408828043');" onmouseout="out('8036786023408828043');" style="">  77          SqlNodeList sqlNodeList = sqlSelect.getSelectList();                                                      </span>
<span class="-3054172495871960241" onmouseenter="enter('-3054172495871960241');" onmouseout="out('-3054172495871960241');" style="">  78          List&lt;FieldInfo&gt; fieldInfoList = Lists.newArrayList();                                                     </span>
<span class="-839692389379732251" onmouseenter="enter('-839692389379732251');" onmouseout="out('-839692389379732251');" style="">  79          String fromNode = sqlSelect.getFrom().toString();                                                         </span>
<span  style="">  80                                                                                                                    </span>
<span class="2162301537633635938" onmouseenter="enter('2162301537633635938');" onmouseout="out('2162301537633635938');" style="">  81          for (SqlNode fieldNode : sqlNodeList.getList()) {                                                         </span>
<span class="1465841598931987040" onmouseenter="enter('1465841598931987040');" onmouseout="out('1465841598931987040');" style="">  82              extractSelectFieldToFieldInfo(fieldNode,fromNode,fieldInfoList,localTableCache);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83          }                                                                                                         </span>
<span  style="">  84                                                                                                                    </span>
<span class="1335352475287465914" onmouseenter="enter('1335352475287465914');" onmouseout="out('1335352475287465914');" style="">  85          return fieldInfoList;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86      }                                                                                                             </span>
<span  style="">  87                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  88      /**                                                                                                           </span>
<span class="-6805611089677825770" onmouseenter="enter('-6805611089677825770');" onmouseout="out('-6805611089677825770');" style="">  89       *  解析select Node 提取FieldInfo                                                                                 </span>
<span class="697554033229417632" onmouseenter="enter('697554033229417632');" onmouseout="out('697554033229417632');" style="">  90       * @param fieldNode                                                                                           </span>
<span class="-1719315088034482430" onmouseenter="enter('-1719315088034482430');" onmouseout="out('-1719315088034482430');" style="">  91       * @param fromNode                                                                                            </span>
<span class="8898190159008473723" onmouseenter="enter('8898190159008473723');" onmouseout="out('8898190159008473723');" style="">  92       * @param fieldInfoList                                                                                       </span>
<span class="-2613125561450459797" onmouseenter="enter('-2613125561450459797');" onmouseout="out('-2613125561450459797');" style="">  93       * @param localTableCache                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  94       */                                                                                                           </span>
<span class="911398554884375981" onmouseenter="enter('911398554884375981');" onmouseout="out('911398554884375981');" style=""><abbr title="  95      public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfoList, Map&lt;String, Table&gt; localTableCache) {">  95      public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfo🔵</abbr></span>
<span class="8336572539967602309" onmouseenter="enter('8336572539967602309');" onmouseout="out('8336572539967602309');" style="">  96          if (fieldNode.getKind() == IDENTIFIER) {                                                                  </span>
<span class="2728418029840045752" onmouseenter="enter('2728418029840045752');" onmouseout="out('2728418029840045752');" style="">  97              SqlIdentifier identifier = (SqlIdentifier) fieldNode;                                                 </span>
<span class="-5519378359901478287" onmouseenter="enter('-5519378359901478287');" onmouseout="out('-5519378359901478287');" style="">  98              if (!identifier.isStar()) {                                                                           </span>
<span class="7382398262726877456" onmouseenter="enter('7382398262726877456');" onmouseout="out('7382398262726877456');" style=""><abbr title="  99                  String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple();">  99                  String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple(🔵</abbr></span>
<span class="-4078369372891740310" onmouseenter="enter('-4078369372891740310');" onmouseout="out('-4078369372891740310');" style=""><abbr title=" 100                  String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identifier.getComponent(1).getSimple();"> 100                  String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identif🔵</abbr></span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 101                  FieldInfo fieldInfo = new FieldInfo();                                                            </span>
<span class="-3246065580716586601" onmouseenter="enter('-3246065580716586601');" onmouseout="out('-3246065580716586601');" style=""> 102                  fieldInfo.setTable(tableName);                                                                    </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 103                  fieldInfo.setFieldName(fieldName);                                                                </span>
<span  style=""> 104                                                                                                                    </span>
<span class="4376905192285837026" onmouseenter="enter('4376905192285837026');" onmouseout="out('4376905192285837026');" style=""> 105                  if (!fieldInfoList.contains(fieldInfo)) {                                                         </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 106                      fieldInfoList.add(fieldInfo);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 108              } else {                                                                                              </span>
<span class="2893145864113934715" onmouseenter="enter('2893145864113934715');" onmouseout="out('2893145864113934715');" style=""> 109                  //处理                                                                                              </span>
<span class="-3160769060475159310" onmouseenter="enter('-3160769060475159310');" onmouseout="out('-3160769060475159310');" style=""> 110                  int identifierSize = identifier.names.size();                                                     </span>
<span class="5352978315561223025" onmouseenter="enter('5352978315561223025');" onmouseout="out('5352978315561223025');" style=""> 111                  switch (identifierSize) {                                                                         </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 112                      case 1:                                                                                       </span>
<span class="543169233263070967" onmouseenter="enter('543169233263070967');" onmouseout="out('543169233263070967');" style=""> 113                          throw new RuntimeException(&quot;not support to parse * without scope of table&quot;);              </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 114                      default:                                                                                      </span>
<span class="7234102748034848382" onmouseenter="enter('7234102748034848382');" onmouseout="out('7234102748034848382');" style=""> 115                          SqlIdentifier tableIdentify = identifier.skipLast(1);                                     </span>
<span class="-7038658933458861113" onmouseenter="enter('-7038658933458861113');" onmouseout="out('-7038658933458861113');" style=""> 116                          Table registerTable = localTableCache.get(tableIdentify.getSimple());                     </span>
<span class="-5997676555615328170" onmouseenter="enter('-5997676555615328170');" onmouseout="out('-5997676555615328170');" style=""> 117                          if (registerTable == null) {                                                              </span>
<span class="6481995910302552391" onmouseenter="enter('6481995910302552391');" onmouseout="out('6481995910302552391');" style=""> 118                              throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimple());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119                          }                                                                                         </span>
<span  style=""> 120                                                                                                                    </span>
<span class="-4547568303745452703" onmouseenter="enter('-4547568303745452703');" onmouseout="out('-4547568303745452703');" style=""> 121                          String[] fieldNames = registerTable.getSchema().getFieldNames();                          </span>
<span class="-7408478396859326180" onmouseenter="enter('-7408478396859326180');" onmouseout="out('-7408478396859326180');" style=""> 122                          for (String fieldName : fieldNames) {                                                     </span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 123                              FieldInfo fieldInfo = new FieldInfo();                                                </span>
<span class="-5561911469151499170" onmouseenter="enter('-5561911469151499170');" onmouseout="out('-5561911469151499170');" style=""> 124                              fieldInfo.setTable(tableIdentify.getSimple());                                        </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 125                              fieldInfo.setFieldName(fieldName);                                                    </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 126                              fieldInfoList.add(fieldInfo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129              }                                                                                                     </span>
<span class="355751622478352774" onmouseenter="enter('355751622478352774');" onmouseout="out('355751622478352774');" style=""> 130          } else if (AGGREGATE.contains(fieldNode.getKind())                                                        </span>
<span class="-4728546343803188943" onmouseenter="enter('-4728546343803188943');" onmouseout="out('-4728546343803188943');" style=""> 131                  || AVG_AGG_FUNCTIONS.contains(fieldNode.getKind())                                                </span>
<span class="8973512118577358544" onmouseenter="enter('8973512118577358544');" onmouseout="out('8973512118577358544');" style=""> 132                  || COMPARISON.contains(fieldNode.getKind())                                                       </span>
<span class="525772482672043181" onmouseenter="enter('525772482672043181');" onmouseout="out('525772482672043181');" style=""> 133                  || fieldNode.getKind() == OTHER_FUNCTION                                                          </span>
<span class="4987264283847416523" onmouseenter="enter('4987264283847416523');" onmouseout="out('4987264283847416523');" style=""> 134                  || fieldNode.getKind() == DIVIDE                                                                  </span>
<span class="-2097459444898035710" onmouseenter="enter('-2097459444898035710');" onmouseout="out('-2097459444898035710');" style=""> 135                  || fieldNode.getKind() == CAST                                                                    </span>
<span class="621194935667432352" onmouseenter="enter('621194935667432352');" onmouseout="out('621194935667432352');" style=""> 136                  || fieldNode.getKind() == TRIM                                                                    </span>
<span class="5379925649229703360" onmouseenter="enter('5379925649229703360');" onmouseout="out('5379925649229703360');" style=""> 137                  || fieldNode.getKind() == TIMES                                                                   </span>
<span class="-4394268980765693723" onmouseenter="enter('-4394268980765693723');" onmouseout="out('-4394268980765693723');" style=""> 138                  || fieldNode.getKind() == PLUS                                                                    </span>
<span class="-122938326578311005" onmouseenter="enter('-122938326578311005');" onmouseout="out('-122938326578311005');" style=""> 139                  || fieldNode.getKind() == NOT_IN                                                                  </span>
<span class="5635148239693374504" onmouseenter="enter('5635148239693374504');" onmouseout="out('5635148239693374504');" style=""> 140                  || fieldNode.getKind() == OR                                                                      </span>
<span class="-3217339780873839086" onmouseenter="enter('-3217339780873839086');" onmouseout="out('-3217339780873839086');" style=""> 141                  || fieldNode.getKind() == AND                                                                     </span>
<span class="2162998824653848637" onmouseenter="enter('2162998824653848637');" onmouseout="out('2162998824653848637');" style=""> 142                  || fieldNode.getKind() == MINUS                                                                   </span>
<span class="-506664053077300680" onmouseenter="enter('-506664053077300680');" onmouseout="out('-506664053077300680');" style=""> 143                  || fieldNode.getKind() == TUMBLE                                                                  </span>
<span class="-1822630894260242331" onmouseenter="enter('-1822630894260242331');" onmouseout="out('-1822630894260242331');" style=""> 144                  || fieldNode.getKind() == TUMBLE_START                                                            </span>
<span class="-8086489575650543701" onmouseenter="enter('-8086489575650543701');" onmouseout="out('-8086489575650543701');" style=""> 145                  || fieldNode.getKind() == TUMBLE_END                                                              </span>
<span class="-2609834003874905006" onmouseenter="enter('-2609834003874905006');" onmouseout="out('-2609834003874905006');" style=""> 146                  || fieldNode.getKind() == SESSION                                                                 </span>
<span class="6623716356682835746" onmouseenter="enter('6623716356682835746');" onmouseout="out('6623716356682835746');" style=""> 147                  || fieldNode.getKind() == SESSION_START                                                           </span>
<span class="-4356389762844455169" onmouseenter="enter('-4356389762844455169');" onmouseout="out('-4356389762844455169');" style=""> 148                  || fieldNode.getKind() == SESSION_END                                                             </span>
<span class="3788231826671768229" onmouseenter="enter('3788231826671768229');" onmouseout="out('3788231826671768229');" style=""> 149                  || fieldNode.getKind() == HOP                                                                     </span>
<span class="6798204869770216275" onmouseenter="enter('6798204869770216275');" onmouseout="out('6798204869770216275');" style=""> 150                  || fieldNode.getKind() == HOP_START                                                               </span>
<span class="250318287045370196" onmouseenter="enter('250318287045370196');" onmouseout="out('250318287045370196');" style=""> 151                  || fieldNode.getKind() == HOP_END                                                                 </span>
<span class="9109972257207472540" onmouseenter="enter('9109972257207472540');" onmouseout="out('9109972257207472540');" style=""> 152                  || fieldNode.getKind() == BETWEEN                                                                 </span>
<span class="6983217744831152908" onmouseenter="enter('6983217744831152908');" onmouseout="out('6983217744831152908');" style=""> 153                  || fieldNode.getKind() == IS_NULL                                                                 </span>
<span class="-1122161678078794235" onmouseenter="enter('-1122161678078794235');" onmouseout="out('-1122161678078794235');" style=""> 154                  || fieldNode.getKind() == IS_NOT_NULL                                                             </span>
<span class="-3733427582644132679" onmouseenter="enter('-3733427582644132679');" onmouseout="out('-3733427582644132679');" style=""> 155                  || fieldNode.getKind() == CONTAINS                                                                </span>
<span class="-9056199605453305302" onmouseenter="enter('-9056199605453305302');" onmouseout="out('-9056199605453305302');" style=""> 156                  || fieldNode.getKind() == TIMESTAMP_ADD                                                           </span>
<span class="-134492662313070004" onmouseenter="enter('-134492662313070004');" onmouseout="out('-134492662313070004');" style=""> 157                  || fieldNode.getKind() == TIMESTAMP_DIFF                                                          </span>
<span class="6146091325000099373" onmouseenter="enter('6146091325000099373');" onmouseout="out('6146091325000099373');" style=""> 158                  || fieldNode.getKind() == LIKE                                                                    </span>
<span class="4953146235532857216" onmouseenter="enter('4953146235532857216');" onmouseout="out('4953146235532857216');" style=""> 159                  || fieldNode.getKind() == COALESCE                                                                </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 160                  ) {                                                                                               </span>
<span class="-354400113971550997" onmouseenter="enter('-354400113971550997');" onmouseout="out('-354400113971550997');" style=""> 161              SqlBasicCall sqlBasicCall = (SqlBasicCall) fieldNode;                                                 </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 162              for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                         </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 163                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 164                  if (sqlNode instanceof SqlLiteral) {                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 165                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                  }                                                                                                 </span>
<span  style=""> 167                                                                                                                    </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 168                  if (sqlNode instanceof SqlDataTypeSpec) {                                                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 169                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170                  }                                                                                                 </span>
<span class="-5978367516025835425" onmouseenter="enter('-5978367516025835425');" onmouseout="out('-5978367516025835425');" style=""> 171                  extractSelectFieldToFieldInfo(sqlNode, fromNode, fieldInfoList, localTableCache);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172              }                                                                                                     </span>
<span class="-3590348607861839793" onmouseenter="enter('-3590348607861839793');" onmouseout="out('-3590348607861839793');" style=""> 173          } else if (fieldNode.getKind() == AS) {                                                                   </span>
<span class="3703210587199661065" onmouseenter="enter('3703210587199661065');" onmouseout="out('3703210587199661065');" style=""> 174              SqlNode leftNode = ((SqlBasicCall) fieldNode).getOperands()[0];                                       </span>
<span class="-2607912045389455868" onmouseenter="enter('-2607912045389455868');" onmouseout="out('-2607912045389455868');" style=""> 175              extractSelectFieldToFieldInfo(leftNode, fromNode,fieldInfoList, localTableCache);                     </span>
<span class="-3651943351416933315" onmouseenter="enter('-3651943351416933315');" onmouseout="out('-3651943351416933315');" style=""> 176          } else if (fieldNode.getKind() == CASE) {                                                                 </span>
<span class="7184861900726949901" onmouseenter="enter('7184861900726949901');" onmouseout="out('7184861900726949901');" style=""> 177              SqlCase sqlCase = (SqlCase) fieldNode;                                                                </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 178              SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 179              SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 180              SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style=""> 181                                                                                                                    </span>
<span class="5804242455667685406" onmouseenter="enter('5804242455667685406');" onmouseout="out('5804242455667685406');" style=""> 182              for (int i = 0; i &lt; whenOperands.size(); i++) {                                                       </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 183                  SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 184                  extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185              }                                                                                                     </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-7770933914215809062" onmouseenter="enter('-7770933914215809062');" onmouseout="out('-7770933914215809062');" style=""> 187              for (int i = 0; i &lt; thenOperands.size(); i++) {                                                       </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 188                  SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 189                  extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);              </span>
<span  style=""> 190                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191              }                                                                                                     </span>
<span  style=""> 192                                                                                                                    </span>
<span class="7029049357943474126" onmouseenter="enter('7029049357943474126');" onmouseout="out('7029049357943474126');" style=""> 193              extractSelectFieldToFieldInfo(elseNode, fromNode, fieldInfoList, localTableCache);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="44665875153783342" onmouseenter="enter('44665875153783342');" onmouseout="out('44665875153783342');" style=""> 197      public static String buildInternalTableName(String left, char split, String right) {                          </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 198          StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="666148872664318228" onmouseenter="enter('666148872664318228');" onmouseout="out('666148872664318228');" style=""> 199          return sb.append(left).append(split).append(right).toString();                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200      }                                                                                                             </span>
<span  style=""> 201                                                                                                                    </span>
<span class="-8999074733125454701" onmouseenter="enter('-8999074733125454701');" onmouseout="out('-8999074733125454701');" style=""> 202      public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAlias) {    </span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 203          SqlOperator operator = new SqlAsOperator();                                                               </span>
<span  style=""> 204                                                                                                                    </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 205          SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                                       </span>
<span class="4539692765329264390" onmouseenter="enter('4539692765329264390');" onmouseout="out('4539692765329264390');" style=""> 206          String newTableName = joinInfo.getNewTableName();                                                         </span>
<span class="1665950166508651073" onmouseenter="enter('1665950166508651073');" onmouseout="out('1665950166508651073');" style=""> 207          String lefTbAlias = joinInfo.getLeftTableAlias();                                                         </span>
<span  style=""> 208                                                                                                                    </span>
<span class="2319480499474441641" onmouseenter="enter('2319480499474441641');" onmouseout="out('2319480499474441641');" style=""> 209          if(Strings.isNullOrEmpty(lefTbAlias)){                                                                    </span>
<span class="-8245756693582446922" onmouseenter="enter('-8245756693582446922');" onmouseout="out('-8245756693582446922');" style=""> 210              Set&lt;String&gt; fromTableSet = Sets.newHashSet();                                                         </span>
<span class="-7547782328391666575" onmouseenter="enter('-7547782328391666575');" onmouseout="out('-7547782328391666575');" style=""> 211              TableUtils.getFromTableInfo(joinInfo.getLeftNode(), fromTableSet);                                    </span>
<span class="-5610405007192716156" onmouseenter="enter('-5610405007192716156');" onmouseout="out('-5610405007192716156');" style=""> 212              lefTbAlias = StringUtils.join(fromTableSet, &quot;_&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213          }                                                                                                         </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-2305615543808332923" onmouseenter="enter('-2305615543808332923');" onmouseout="out('-2305615543808332923');" style=""><abbr title=" 215          String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : buildInternalTableName(lefTbAlias, SPLIT, joinInfo.getRightTableAlias());"> 215          String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : buildInternalTableName(lefTbAlias, 🔵</abbr></span>


<span  style=""> 216                                                                                                                    </span>
<span class="-6474384717461795701" onmouseenter="enter('-6474384717461795701');" onmouseout="out('-6474384717461795701');" style=""> 217          if (null == sqlNode0) {                                                                                   </span>
<span class="-6562061848026015753" onmouseenter="enter('-6562061848026015753');" onmouseout="out('-6562061848026015753');" style=""> 218              sqlNode0 = new SqlIdentifier(newTableName, null, sqlParserPos);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219          }                                                                                                         </span>
<span  style=""> 220                                                                                                                    </span>
<span class="-2821647309854503598" onmouseenter="enter('-2821647309854503598');" onmouseout="out('-2821647309854503598');" style=""> 221          SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(newTableAlias, null, sqlParserPos);                  </span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 222          SqlNode[] sqlNodes = new SqlNode[2];                                                                      </span>
<span class="-7781715169306512157" onmouseenter="enter('-7781715169306512157');" onmouseout="out('-7781715169306512157');" style=""> 223          sqlNodes[0] = sqlNode0;                                                                                   </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 224          sqlNodes[1] = sqlIdentifierAlias;                                                                         </span>
<span class="-1928364106966605511" onmouseenter="enter('-1928364106966605511');" onmouseout="out('-1928364106966605511');" style=""> 225          return new SqlBasicCall(operator, sqlNodes, sqlParserPos);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226      }                                                                                                             </span>
<span  style=""> 227                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 228      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 229       *                                                                                                            </span>
<span class="-6040909485639107572" onmouseenter="enter('-6040909485639107572');" onmouseout="out('-6040909485639107572');" style=""> 230       * @param joinInfo                                                                                            </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 231       * @param sqlNode                                                                                             </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 232       * @param queueInfo                                                                                           </span>
<span class="-8382295939765334869" onmouseenter="enter('-8382295939765334869');" onmouseout="out('-8382295939765334869');" style=""> 233       * @return   两个边关联后的新表表名                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 234       */                                                                                                           </span>
<span class="-9105373632393246263" onmouseenter="enter('-9105373632393246263');" onmouseout="out('-9105373632393246263');" style=""><abbr title=" 235      public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInfo) {"> 235      public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInf🔵</abbr></span>
<span class="-3012154526429275078" onmouseenter="enter('-3012154526429275078');" onmouseout="out('-3012154526429275078');" style=""> 236          //SideJoinInfo rename                                                                                     </span>
<span class="4973038183558270709" onmouseenter="enter('4973038183558270709');" onmouseout="out('4973038183558270709');" style=""> 237          if (joinInfo.checkIsSide()) {                                                                             </span>
<span class="8408112480551688226" onmouseenter="enter('8408112480551688226');" onmouseout="out('8408112480551688226');" style=""> 238              joinInfo.setSelectFields(sqlNode.getSelectList());                                                    </span>
<span class="4794732995049884760" onmouseenter="enter('4794732995049884760');" onmouseout="out('4794732995049884760');" style=""> 239              joinInfo.setSelectNode(sqlNode);                                                                      </span>
<span class="1448684309320227021" onmouseenter="enter('1448684309320227021');" onmouseout="out('1448684309320227021');" style=""> 240              if (joinInfo.isRightIsSideTable()) {                                                                  </span>
<span class="-476802833010893550" onmouseenter="enter('-476802833010893550');" onmouseout="out('-476802833010893550');" style=""> 241                  //Analyzing left is not a simple table                                                            </span>
<span class="6867568634948481821" onmouseenter="enter('6867568634948481821');" onmouseout="out('6867568634948481821');" style=""> 242                  if (joinInfo.getLeftNode().getKind() == SELECT) {                                                 </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 243                      queueInfo.offer(joinInfo.getLeftNode());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                  }                                                                                                 </span>
<span  style=""> 245                                                                                                                    </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 246                  queueInfo.offer(joinInfo);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 247              } else {                                                                                              </span>
<span class="5635813491573439188" onmouseenter="enter('5635813491573439188');" onmouseout="out('5635813491573439188');" style=""> 248                  //Determining right is not a simple table                                                         </span>
<span class="2468473214053427731" onmouseenter="enter('2468473214053427731');" onmouseout="out('2468473214053427731');" style=""> 249                  if (joinInfo.getRightNode().getKind() == SELECT) {                                                </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 250                      queueInfo.offer(joinInfo.getLeftNode());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                  }                                                                                                 </span>
<span  style=""> 252                                                                                                                    </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 253                  queueInfo.offer(joinInfo);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254              }                                                                                                     </span>
<span class="-7933690095328677787" onmouseenter="enter('-7933690095328677787');" onmouseout="out('-7933690095328677787');" style=""> 255              replaceFromNodeForJoin(joinInfo, sqlNode);                                                            </span>
<span class="-3213976632367322289" onmouseenter="enter('-3213976632367322289');" onmouseout="out('-3213976632367322289');" style=""> 256              return joinInfo.getNewTableName();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257          }                                                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 258          return &quot;&quot;;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259      }                                                                                                             </span>
<span  style=""> 260                                                                                                                    </span>
<span class="8074977299710029932" onmouseenter="enter('8074977299710029932');" onmouseout="out('8074977299710029932');" style=""> 261      public static void replaceFromNodeForJoin(JoinInfo joinInfo, SqlSelect sqlNode) {                             </span>
<span class="-9060489602533315077" onmouseenter="enter('-9060489602533315077');" onmouseout="out('-9060489602533315077');" style=""> 262          //Update from node                                                                                        </span>
<span class="2204164800083526508" onmouseenter="enter('2204164800083526508');" onmouseout="out('2204164800083526508');" style=""> 263          SqlBasicCall sqlBasicCall = buildAsNodeByJoinInfo(joinInfo, null, null);                                  </span>
<span class="-8082788431941340980" onmouseenter="enter('-8082788431941340980');" onmouseout="out('-8082788431941340980');" style=""> 264          String newAliasName = sqlBasicCall.operand(1).toString();                                                 </span>
<span  style=""> 265                                                                                                                    </span>
<span class="-4706120631660601296" onmouseenter="enter('-4706120631660601296');" onmouseout="out('-4706120631660601296');" style=""> 266          //替换select 中的属性为新的表名称和字段                                                                                  </span>
<span class="8210217038029633734" onmouseenter="enter('8210217038029633734');" onmouseout="out('8210217038029633734');" style=""> 267          HashBasedTable&lt;String, String, String&gt; fieldMapping = joinInfo.getTableFieldRef();                        </span>
<span class="-6200687028928637107" onmouseenter="enter('-6200687028928637107');" onmouseout="out('-6200687028928637107');" style=""> 268          Map&lt;String, String&gt; leftFieldMapping = fieldMapping.row(joinInfo.getLeftTableAlias());                    </span>
<span class="6534080411824570705" onmouseenter="enter('6534080411824570705');" onmouseout="out('6534080411824570705');" style=""> 269          Map&lt;String, String&gt; rightFieldMapping = fieldMapping.row(joinInfo.getRightTableAlias());                  </span>
<span  style=""> 270                                                                                                                    </span>
<span class="-7880903214764896195" onmouseenter="enter('-7880903214764896195');" onmouseout="out('-7880903214764896195');" style=""> 271         /* for(SqlNode oneSelectNode : sqlNode.getSelectList()){                                                   </span>
<span class="-4957689359258588920" onmouseenter="enter('-4957689359258588920');" onmouseout="out('-4957689359258588920');" style=""><abbr title=" 272              replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapping);"> 272              replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapp🔵</abbr></span>
<span class="6269709593519335658" onmouseenter="enter('6269709593519335658');" onmouseout="out('6269709593519335658');" style=""><abbr title=" 273              replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldMapping);"> 273              replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldM🔵</abbr></span>
<span class="-2684617365274670769" onmouseenter="enter('-2684617365274670769');" onmouseout="out('-2684617365274670769');" style=""> 274          }*/                                                                                                       </span>
<span  style=""> 275                                                                                                                    </span>
<span class="2103765898996250551" onmouseenter="enter('2103765898996250551');" onmouseout="out('2103765898996250551');" style=""> 276          //where中的条件属性为新的表名称和字段                                                                                    </span>
<span class="1856147124472045117" onmouseenter="enter('1856147124472045117');" onmouseout="out('1856147124472045117');" style=""> 277          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldMapping); </span>
<span class="5021450334630795014" onmouseenter="enter('5021450334630795014');" onmouseout="out('5021450334630795014');" style=""><abbr title=" 278          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping);"> 278          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping)🔵</abbr></span>
<span class="2813845980666839305" onmouseenter="enter('2813845980666839305');" onmouseout="out('2813845980666839305');" style=""> 279          sqlNode.setFrom(sqlBasicCall);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280      }                                                                                                             </span>
<span  style=""> 281                                                                                                                    </span>
<span  style=""> 282                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 283      /**                                                                                                           </span>
<span class="-9165896841480454412" onmouseenter="enter('-9165896841480454412');" onmouseout="out('-9165896841480454412');" style=""> 284       * 获取节点关联的查询表                                                                                                 </span>
<span class="4587700153042038306" onmouseenter="enter('4587700153042038306');" onmouseout="out('4587700153042038306');" style=""> 285       * @param fromTable                                                                                           </span>
<span class="-4525819317820325084" onmouseenter="enter('-4525819317820325084');" onmouseout="out('-4525819317820325084');" style=""> 286       * @param tableNameSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 287       */                                                                                                           </span>
<span class="-6773005969473787299" onmouseenter="enter('-6773005969473787299');" onmouseout="out('-6773005969473787299');" style=""> 288      public static void getFromTableInfo(SqlNode fromTable, Set&lt;String&gt; tableNameSet){                             </span>
<span class="-6901511047628253115" onmouseenter="enter('-6901511047628253115');" onmouseout="out('-6901511047628253115');" style=""> 289          SqlKind sqlKind = fromTable.getKind();                                                                    </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 290          switch (sqlKind){                                                                                         </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 291              case AS:                                                                                              </span>
<span class="6170293684489173764" onmouseenter="enter('6170293684489173764');" onmouseout="out('6170293684489173764');" style=""> 292                  SqlNode alias = ((SqlBasicCall) fromTable).getOperands()[1];                                      </span>
<span class="-4660347064811459637" onmouseenter="enter('-4660347064811459637');" onmouseout="out('-4660347064811459637');" style=""> 293                  tableNameSet.add(alias.toString());                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 294                  return;                                                                                           </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 295              case JOIN:                                                                                            </span>
<span class="7200443719768955748" onmouseenter="enter('7200443719768955748');" onmouseout="out('7200443719768955748');" style=""> 296                  getFromTableInfo(((SqlJoin)fromTable).getLeft(), tableNameSet);                                   </span>
<span class="-579883461259105749" onmouseenter="enter('-579883461259105749');" onmouseout="out('-579883461259105749');" style=""> 297                  getFromTableInfo(((SqlJoin)fromTable).getRight(), tableNameSet);                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 298                  return;                                                                                           </span>
<span class="-2304009782660987725" onmouseenter="enter('-2304009782660987725');" onmouseout="out('-2304009782660987725');" style=""> 299              case IDENTIFIER:                                                                                      </span>
<span class="6063930725080162048" onmouseenter="enter('6063930725080162048');" onmouseout="out('6063930725080162048');" style=""> 300                  tableNameSet.add(((SqlIdentifier)fromTable).getSimple());                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 301                  return;                                                                                           </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 302              case SELECT:                                                                                          </span>
<span class="4670049027501902925" onmouseenter="enter('4670049027501902925');" onmouseout="out('4670049027501902925');" style=""> 303                  getFromTableInfo(((SqlSelect) fromTable).getFrom(), tableNameSet);                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 304                  return;                                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 305              default:                                                                                              </span>
<span class="9006089180628885729" onmouseenter="enter('9006089180628885729');" onmouseout="out('9006089180628885729');" style=""> 306                  throw new RuntimeException(&quot;not support sqlKind:&quot; + sqlKind);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308      }                                                                                                             </span>
<span  style=""> 309                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 310      /**                                                                                                           </span>
<span class="8536034367776161836" onmouseenter="enter('8536034367776161836');" onmouseout="out('8536034367776161836');" style=""> 311       * 替换select 中的字段信息                                                                                            </span>
<span class="8563350786440524200" onmouseenter="enter('8563350786440524200');" onmouseout="out('8563350786440524200');" style=""> 312       * 如果mappingTable 非空则从该参数获取字段的映射                                                                              </span>
<span class="-6581838769493343810" onmouseenter="enter('-6581838769493343810');" onmouseout="out('-6581838769493343810');" style=""> 313       * 如果mappingTable 为空则根据是否存在新生成字段                                                                              </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 314       * @param selectNode                                                                                          </span>
<span class="-2283388782413973238" onmouseenter="enter('-2283388782413973238');" onmouseout="out('-2283388782413973238');" style=""> 315       * @param oldTbName                                                                                           </span>
<span class="7634289987105314089" onmouseenter="enter('7634289987105314089');" onmouseout="out('7634289987105314089');" style=""> 316       * @param newTbName                                                                                           </span>
<span class="8769527040545279755" onmouseenter="enter('8769527040545279755');" onmouseout="out('8769527040545279755');" style=""> 317       * @param fieldReplaceRef                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 318       */                                                                                                           </span>
<span class="5027529910148445847" onmouseenter="enter('5027529910148445847');" onmouseout="out('5027529910148445847');" style=""> 319      public static void replaceSelectFieldTable(SqlNode selectNode,                                                </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 320                                                 String oldTbName,                                                  </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 321                                                 String newTbName,                                                  </span>
<span class="7882147930720524356" onmouseenter="enter('7882147930720524356');" onmouseout="out('7882147930720524356');" style=""> 322                                                 HashBiMap&lt;String, String&gt; fieldReplaceRef) {                       </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 323          if (selectNode.getKind() == AS) {                                                                         </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 324              SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                                      </span>
<span class="-4674775763706954352" onmouseenter="enter('-4674775763706954352');" onmouseout="out('-4674775763706954352');" style=""> 325              replaceSelectFieldTable(leftNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span  style=""> 326                                                                                                                    </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 327          }else if(selectNode.getKind() == IDENTIFIER){                                                             </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 328              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 329                                                                                                                    </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 330              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="-1755167016071657820" onmouseenter="enter('-1755167016071657820');" onmouseout="out('-1755167016071657820');" style=""> 331                  return ;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332              }                                                                                                     </span>
<span  style=""> 333                                                                                                                    </span>
<span class="1355631215618064105" onmouseenter="enter('1355631215618064105');" onmouseout="out('1355631215618064105');" style=""> 334              String fieldTableName = sqlIdentifier.names.get(0);                                                   </span>
<span class="-2979536462712829146" onmouseenter="enter('-2979536462712829146');" onmouseout="out('-2979536462712829146');" style=""> 335              if(oldTbName.equalsIgnoreCase(fieldTableName)){                                                       </span>
<span class="-4556037184452828083" onmouseenter="enter('-4556037184452828083');" onmouseout="out('-4556037184452828083');" style=""> 336                  replaceOneSelectField(sqlIdentifier, newTbName, oldTbName, fieldReplaceRef);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337              }                                                                                                     </span>
<span  style=""> 338                                                                                                                    </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 339          }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 340              return;                                                                                               </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 341          }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 342                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 343                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 344                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 345                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 346                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 347                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 348                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 349                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 350                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 351                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 352                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 353                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 354                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 355                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 356                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 357                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 358                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 359                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 360                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 361                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 362                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 363                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 364                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 365                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 366                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 367                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 368                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 369                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 370                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 371                                                                                                                    </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 372          ){                                                                                                        </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 373              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 374              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 375                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 376                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 377                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378                  }                                                                                                 </span>
<span  style=""> 379                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 380                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 381                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382                  }                                                                                                 </span>
<span  style=""> 383                                                                                                                    </span>
<span class="-5676526903547679293" onmouseenter="enter('-5676526903547679293');" onmouseout="out('-5676526903547679293');" style=""> 384                  replaceSelectFieldTable(sqlNode, oldTbName, newTbName, fieldReplaceRef);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385              }                                                                                                     </span>
<span  style=""> 386                                                                                                                    </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 387          }else if(selectNode.getKind() == CASE){                                                                   </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 388              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 389              SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 390              SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 391              SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style=""> 392                                                                                                                    </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 393              for(int i=0; i&lt;whenOperands.size(); i++){                                                             </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 394                  SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 395                  replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396              }                                                                                                     </span>
<span  style=""> 397                                                                                                                    </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 398              for(int i=0; i&lt;thenOperands.size(); i++){                                                             </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 399                  SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 400                  replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);                       </span>
<span  style=""> 401                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402              }                                                                                                     </span>
<span  style=""> 403                                                                                                                    </span>
<span class="-7763620435664145090" onmouseenter="enter('-7763620435664145090');" onmouseout="out('-7763620435664145090');" style=""> 404              replaceSelectFieldTable(elseNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 405          }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 406              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 407              return;                                                                                               </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 408          }else{                                                                                                    </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 409              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 409              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411      }                                                                                                             </span>
<span  style=""> 412                                                                                                                    </span>
<span class="-8462314785940972235" onmouseenter="enter('-8462314785940972235');" onmouseout="out('-8462314785940972235');" style=""> 413      private static void replaceOneSelectField(SqlIdentifier sqlIdentifier,                                        </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 414                                                String newTbName,                                                   </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 415                                                String oldTbName,                                                   </span>
<span class="-123666790994587736" onmouseenter="enter('-123666790994587736');" onmouseout="out('-123666790994587736');" style=""> 416                                                HashBiMap&lt;String, String&gt; fieldReplaceRef){                         </span>
<span class="5409837540655806029" onmouseenter="enter('5409837540655806029');" onmouseout="out('5409837540655806029');" style=""> 417          SqlIdentifier newField = sqlIdentifier.setName(0, newTbName);                                             </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 418          String fieldName = sqlIdentifier.names.get(1);                                                            </span>
<span class="383429695235202001" onmouseenter="enter('383429695235202001');" onmouseout="out('383429695235202001');" style=""> 419          String fieldKey = oldTbName + &quot;_&quot; + fieldName;                                                            </span>
<span  style=""> 420                                                                                                                    </span>
<span class="-6721872198205274351" onmouseenter="enter('-6721872198205274351');" onmouseout="out('-6721872198205274351');" style=""> 421          if(!fieldReplaceRef.containsKey(fieldKey)){                                                               </span>
<span class="-8417061839432085011" onmouseenter="enter('-8417061839432085011');" onmouseout="out('-8417061839432085011');" style=""> 422              if(fieldReplaceRef.inverse().get(fieldName) != null){                                                 </span>
<span class="3563776056422158867" onmouseenter="enter('3563776056422158867');" onmouseout="out('3563776056422158867');" style=""> 423                  //换一个名字                                                                                           </span>
<span class="6269694230999482502" onmouseenter="enter('6269694230999482502');" onmouseout="out('6269694230999482502');" style=""> 424                  String mappingFieldName = ParseUtils.dealDuplicateFieldName(fieldReplaceRef, fieldName);          </span>
<span class="730243385989967976" onmouseenter="enter('730243385989967976');" onmouseout="out('730243385989967976');" style=""> 425                  newField = newField.setName(1, mappingFieldName);                                                 </span>
<span class="-8843946047709268866" onmouseenter="enter('-8843946047709268866');" onmouseout="out('-8843946047709268866');" style=""> 426                  fieldReplaceRef.put(fieldKey, mappingFieldName);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 427              } else {                                                                                              </span>
<span class="8037669429324652271" onmouseenter="enter('8037669429324652271');" onmouseout="out('8037669429324652271');" style=""> 428                  fieldReplaceRef.put(fieldKey, fieldName);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429              }                                                                                                     </span>
<span class="-6497049907687009769" onmouseenter="enter('-6497049907687009769');" onmouseout="out('-6497049907687009769');" style=""> 430          }else {                                                                                                   </span>
<span class="-8559329898165326450" onmouseenter="enter('-8559329898165326450');" onmouseout="out('-8559329898165326450');" style=""> 431              newField = newField.setName(1, fieldReplaceRef.get(fieldKey));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432          }                                                                                                         </span>
<span  style=""> 433                                                                                                                    </span>
<span class="-3197795073308056747" onmouseenter="enter('-3197795073308056747');" onmouseout="out('-3197795073308056747');" style=""> 434          sqlIdentifier.assignNamesFrom(newField);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435      }                                                                                                             </span>
<span  style=""> 436                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 437      /**                                                                                                           </span>
<span class="5461903081523405406" onmouseenter="enter('5461903081523405406');" onmouseout="out('5461903081523405406');" style=""> 438       * 替换另外join 表的指定表名为新关联处理的表名称                                                                                  </span>
<span class="-4160812560585701802" onmouseenter="enter('-4160812560585701802');" onmouseout="out('-4160812560585701802');" style=""> 439       * @param condition                                                                                           </span>
<span class="-653368829907055509" onmouseenter="enter('-653368829907055509');" onmouseout="out('-653368829907055509');" style=""> 440       * @param oldTabFieldRefNew                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 441       */                                                                                                           </span>
<span class="3319102281402941993" onmouseenter="enter('3319102281402941993');" onmouseout="out('3319102281402941993');" style=""> 442      public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRefNew){    </span>
<span class="5716706160133851170" onmouseenter="enter('5716706160133851170');" onmouseout="out('5716706160133851170');" style=""> 443          if (null == condition || condition.getKind() == LITERAL) {                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 444              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445          }                                                                                                         </span>
<span class="5418896256960850645" onmouseenter="enter('5418896256960850645');" onmouseout="out('5418896256960850645');" style=""> 446          SqlKind joinKind = condition.getKind();                                                                   </span>
<span class="-872109993356374898" onmouseenter="enter('-872109993356374898');" onmouseout="out('-872109993356374898');" style=""> 447          if( AGGREGATE.contains(joinKind)                                                                          </span>
<span class="6718918766222840749" onmouseenter="enter('6718918766222840749');" onmouseout="out('6718918766222840749');" style=""> 448                  || AVG_AGG_FUNCTIONS.contains(joinKind)                                                           </span>
<span class="-5795763144400386668" onmouseenter="enter('-5795763144400386668');" onmouseout="out('-5795763144400386668');" style=""> 449                  || COMPARISON.contains(joinKind)                                                                  </span>
<span class="-8649262116164241163" onmouseenter="enter('-8649262116164241163');" onmouseout="out('-8649262116164241163');" style=""> 450                  || joinKind == OTHER_FUNCTION                                                                     </span>
<span class="-5055598318919357044" onmouseenter="enter('-5055598318919357044');" onmouseout="out('-5055598318919357044');" style=""> 451                  || joinKind == DIVIDE                                                                             </span>
<span class="-5590854516630695190" onmouseenter="enter('-5590854516630695190');" onmouseout="out('-5590854516630695190');" style=""> 452                  || joinKind == CAST                                                                               </span>
<span class="-4942353295577364183" onmouseenter="enter('-4942353295577364183');" onmouseout="out('-4942353295577364183');" style=""> 453                  || joinKind == TRIM                                                                               </span>
<span class="3915078205687144262" onmouseenter="enter('3915078205687144262');" onmouseout="out('3915078205687144262');" style=""> 454                  || joinKind == TIMES                                                                              </span>
<span class="-1723358202983235773" onmouseenter="enter('-1723358202983235773');" onmouseout="out('-1723358202983235773');" style=""> 455                  || joinKind == PLUS                                                                               </span>
<span class="-5069307841224953084" onmouseenter="enter('-5069307841224953084');" onmouseout="out('-5069307841224953084');" style=""> 456                  || joinKind == NOT_IN                                                                             </span>
<span class="-2425336955836765254" onmouseenter="enter('-2425336955836765254');" onmouseout="out('-2425336955836765254');" style=""> 457                  || joinKind == OR                                                                                 </span>
<span class="4152669671898758851" onmouseenter="enter('4152669671898758851');" onmouseout="out('4152669671898758851');" style=""> 458                  || joinKind == AND                                                                                </span>
<span class="8469231591142723332" onmouseenter="enter('8469231591142723332');" onmouseout="out('8469231591142723332');" style=""> 459                  || joinKind == MINUS                                                                              </span>
<span class="-8975416296405207931" onmouseenter="enter('-8975416296405207931');" onmouseout="out('-8975416296405207931');" style=""> 460                  || joinKind == TUMBLE                                                                             </span>
<span class="-2000447344068332492" onmouseenter="enter('-2000447344068332492');" onmouseout="out('-2000447344068332492');" style=""> 461                  || joinKind == TUMBLE_START                                                                       </span>
<span class="-2660655228869248711" onmouseenter="enter('-2660655228869248711');" onmouseout="out('-2660655228869248711');" style=""> 462                  || joinKind == TUMBLE_END                                                                         </span>
<span class="611140839719638142" onmouseenter="enter('611140839719638142');" onmouseout="out('611140839719638142');" style=""> 463                  || joinKind == SESSION                                                                            </span>
<span class="-4719587108970880084" onmouseenter="enter('-4719587108970880084');" onmouseout="out('-4719587108970880084');" style=""> 464                  || joinKind == SESSION_START                                                                      </span>
<span class="-8416806901357633870" onmouseenter="enter('-8416806901357633870');" onmouseout="out('-8416806901357633870');" style=""> 465                  || joinKind == SESSION_END                                                                        </span>
<span class="1350987570876390511" onmouseenter="enter('1350987570876390511');" onmouseout="out('1350987570876390511');" style=""> 466                  || joinKind == HOP                                                                                </span>
<span class="-1881854797876652455" onmouseenter="enter('-1881854797876652455');" onmouseout="out('-1881854797876652455');" style=""> 467                  || joinKind == HOP_START                                                                          </span>
<span class="8861207018381483306" onmouseenter="enter('8861207018381483306');" onmouseout="out('8861207018381483306');" style=""> 468                  || joinKind == HOP_END                                                                            </span>
<span class="-8001520670756666177" onmouseenter="enter('-8001520670756666177');" onmouseout="out('-8001520670756666177');" style=""> 469                  || joinKind == BETWEEN                                                                            </span>
<span class="-8652641138853954718" onmouseenter="enter('-8652641138853954718');" onmouseout="out('-8652641138853954718');" style=""> 470                  || joinKind == IS_NULL                                                                            </span>
<span class="-3447385425080227914" onmouseenter="enter('-3447385425080227914');" onmouseout="out('-3447385425080227914');" style=""> 471                  || joinKind == IS_NOT_NULL                                                                        </span>
<span class="-7170411514740971639" onmouseenter="enter('-7170411514740971639');" onmouseout="out('-7170411514740971639');" style=""> 472                  || joinKind == CONTAINS                                                                           </span>
<span class="2023943706482563039" onmouseenter="enter('2023943706482563039');" onmouseout="out('2023943706482563039');" style=""> 473                  || joinKind == TIMESTAMP_ADD                                                                      </span>
<span class="-2326108897925880210" onmouseenter="enter('-2326108897925880210');" onmouseout="out('-2326108897925880210');" style=""> 474                  || joinKind == TIMESTAMP_DIFF                                                                     </span>
<span class="-853383041741207972" onmouseenter="enter('-853383041741207972');" onmouseout="out('-853383041741207972');" style=""> 475                  || joinKind == LIKE                                                                               </span>
<span class="6751598071686393893" onmouseenter="enter('6751598071686393893');" onmouseout="out('6751598071686393893');" style=""> 476                  || joinKind == COALESCE                                                                           </span>
<span class="-6635050181630823497" onmouseenter="enter('-6635050181630823497');" onmouseout="out('-6635050181630823497');" style=""> 477                  || joinKind == EQUALS ){                                                                          </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-2541170249719279546" onmouseenter="enter('-2541170249719279546');" onmouseout="out('-2541170249719279546');" style=""> 479              SqlBasicCall sqlBasicCall = (SqlBasicCall) condition;                                                 </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 480              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 481                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 482                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 483                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                  }                                                                                                 </span>
<span  style=""> 485                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 486                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 487                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488                  }                                                                                                 </span>
<span  style=""> 489                                                                                                                    </span>
<span class="9093647197598049539" onmouseenter="enter('9093647197598049539');" onmouseout="out('9093647197598049539');" style=""> 490                  replaceJoinFieldRefTableName(sqlNode, oldTabFieldRefNew);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491              }                                                                                                     </span>
<span  style=""> 492                                                                                                                    </span>
<span class="-3321512503468929771" onmouseenter="enter('-3321512503468929771');" onmouseout="out('-3321512503468929771');" style=""> 493          } else if (condition.getKind() == IDENTIFIER) {                                                           </span>
<span class="3421902236901684905" onmouseenter="enter('3421902236901684905');" onmouseout="out('3421902236901684905');" style=""><abbr title=" 494              Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format table.field&quot;);"> 494              Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format 🔵</abbr></span>
<span class="5832438568991919450" onmouseenter="enter('5832438568991919450');" onmouseout="out('5832438568991919450');" style=""> 495              String fieldRefTable = ((SqlIdentifier)condition).names.get(0);                                       </span>
<span  style=""> 496                                                                                                                    </span>
<span class="8100744064870187141" onmouseenter="enter('8100744064870187141');" onmouseout="out('8100744064870187141');" style=""> 497              String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString());       </span>
<span  style=""> 498                                                                                                                    </span>
<span class="8753124522689816475" onmouseenter="enter('8753124522689816475');" onmouseout="out('8753124522689816475');" style=""> 499              if(StringUtils.isNotBlank(targetFieldName)){                                                          </span>
<span class="549628471692842965" onmouseenter="enter('549628471692842965');" onmouseout="out('549628471692842965');" style=""> 500                  String[] fieldSplits = StringUtils.split(targetFieldName, &quot;.&quot;);                                   </span>
<span class="-4590973079341848831" onmouseenter="enter('-4590973079341848831');" onmouseout="out('-4590973079341848831');" style=""> 501                  SqlIdentifier newField = ((SqlIdentifier)condition).setName(0, fieldSplits[0]);                   </span>
<span class="-2128195046647686450" onmouseenter="enter('-2128195046647686450');" onmouseout="out('-2128195046647686450');" style=""> 502                  newField = newField.setName(1, fieldSplits[1]);                                                   </span>
<span class="3184949241141894727" onmouseenter="enter('3184949241141894727');" onmouseout="out('3184949241141894727');" style=""> 503                  ((SqlIdentifier)condition).assignNamesFrom(newField);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506      }                                                                                                             </span>
<span  style=""> 507                                                                                                                    </span>
<span class="2909357842222016806" onmouseenter="enter('2909357842222016806');" onmouseout="out('2909357842222016806');" style=""> 508      public static String getTargetRefTable(Map&lt;String, String&gt; refTableMap, String tableName){                    </span>
<span class="8928515954503116985" onmouseenter="enter('8928515954503116985');" onmouseout="out('8928515954503116985');" style=""> 509          String targetTableName = null;                                                                            </span>
<span class="-7988911072327938473" onmouseenter="enter('-7988911072327938473');" onmouseout="out('-7988911072327938473');" style=""> 510          String preTableName;                                                                                      </span>
<span  style=""> 511                                                                                                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 512          do {                                                                                                      </span>
<span class="-8410406414279039842" onmouseenter="enter('-8410406414279039842');" onmouseout="out('-8410406414279039842');" style=""> 513              preTableName = targetTableName == null ? tableName : targetTableName;                                 </span>
<span class="-6937575046812844068" onmouseenter="enter('-6937575046812844068');" onmouseout="out('-6937575046812844068');" style=""> 514              targetTableName = refTableMap.get(preTableName);                                                      </span>
<span class="2145360151323546808" onmouseenter="enter('2145360151323546808');" onmouseout="out('2145360151323546808');" style=""> 515          } while (targetTableName != null);                                                                        </span>
<span  style=""> 516                                                                                                                    </span>
<span class="-2669935656864379097" onmouseenter="enter('-2669935656864379097');" onmouseout="out('-2669935656864379097');" style=""> 517          return preTableName;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518      }                                                                                                             </span>
<span  style=""> 519                                                                                                                    </span>
<span class="4252776571232827033" onmouseenter="enter('4252776571232827033');" onmouseout="out('4252776571232827033');" style=""> 520      public static String getTargetRefField(Map&lt;String, String&gt; refFieldMap, String currFieldName){                </span>
<span class="7313268804655149758" onmouseenter="enter('7313268804655149758');" onmouseout="out('7313268804655149758');" style=""> 521          String targetFieldName = null;                                                                            </span>
<span class="-8203442755027339079" onmouseenter="enter('-8203442755027339079');" onmouseout="out('-8203442755027339079');" style=""> 522          String preFieldName;                                                                                      </span>
<span  style=""> 523                                                                                                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 524          do {                                                                                                      </span>
<span class="5385129689109669577" onmouseenter="enter('5385129689109669577');" onmouseout="out('5385129689109669577');" style=""> 525              preFieldName = targetFieldName == null ? currFieldName : targetFieldName;                             </span>
<span class="-3091793637238102945" onmouseenter="enter('-3091793637238102945');" onmouseout="out('-3091793637238102945');" style=""> 526              targetFieldName = refFieldMap.get(preFieldName);                                                      </span>
<span class="-8916552568071022335" onmouseenter="enter('-8916552568071022335');" onmouseout="out('-8916552568071022335');" style=""> 527          } while (targetFieldName != null);                                                                        </span>
<span  style=""> 528                                                                                                                    </span>
<span class="5199537743604417658" onmouseenter="enter('5199537743604417658');" onmouseout="out('5199537743604417658');" style=""> 529          return preFieldName;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530      }                                                                                                             </span>
<span  style=""> 531                                                                                                                    </span>
<span class="-8300425435366196840" onmouseenter="enter('-8300425435366196840');" onmouseout="out('-8300425435366196840');" style=""><abbr title=" 532      public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef){"> 532      public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;St🔵</abbr></span>
<span  style=""> 533                                                                                                                    </span>
<span class="-7344361739038630250" onmouseenter="enter('-7344361739038630250');" onmouseout="out('-7344361739038630250');" style=""> 534          if(parentWhere == null){                                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 535              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 536          }                                                                                                         </span>
<span  style=""> 537                                                                                                                    </span>
<span class="7198030462908925381" onmouseenter="enter('7198030462908925381');" onmouseout="out('7198030462908925381');" style=""> 538          SqlKind kind = parentWhere.getKind();                                                                     </span>
<span class="-1872623569752802183" onmouseenter="enter('-1872623569752802183');" onmouseout="out('-1872623569752802183');" style=""> 539          if(kind == AND){                                                                                          </span>
<span class="2829943023301943879" onmouseenter="enter('2829943023301943879');" onmouseout="out('2829943023301943879');" style=""><abbr title=" 540              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplaceRef);"> 540              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplac🔵</abbr></span>
<span class="-4556945615844132104" onmouseenter="enter('-4556945615844132104');" onmouseout="out('-4556945615844132104');" style=""><abbr title=" 541              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplaceRef);"> 541              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplac🔵</abbr></span>
<span  style=""> 542                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 543          } else {                                                                                                  </span>
<span class="8766459294285823468" onmouseenter="enter('8766459294285823468');" onmouseout="out('8766459294285823468');" style=""> 544              replaceConditionNode(parentWhere, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 545          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546      }                                                                                                             </span>
<span  style=""> 547                                                                                                                    </span>
<span class="7802005378818510825" onmouseenter="enter('7802005378818510825');" onmouseout="out('7802005378818510825');" style=""><abbr title=" 548      private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef) {"> 548      private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;Str🔵</abbr></span>
<span class="8405601494998756480" onmouseenter="enter('8405601494998756480');" onmouseout="out('8405601494998756480');" style=""> 549          if(selectNode.getKind() == IDENTIFIER){                                                                   </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 550              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 552              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 553                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 554              }                                                                                                     </span>
<span  style=""> 555                                                                                                                    </span>
<span class="318397782816978051" onmouseenter="enter('318397782816978051');" onmouseout="out('318397782816978051');" style=""> 556              String tableName = sqlIdentifier.names.asList().get(0);                                               </span>
<span class="5268132787378326987" onmouseenter="enter('5268132787378326987');" onmouseout="out('5268132787378326987');" style=""> 557              String tableField = sqlIdentifier.names.asList().get(1);                                              </span>
<span class="-2565165445763658517" onmouseenter="enter('-2565165445763658517');" onmouseout="out('-2565165445763658517');" style=""> 558              String fieldKey = tableName + &quot;_&quot; + tableField;                                                       </span>
<span  style=""> 559                                                                                                                    </span>
<span class="-3841275234863465094" onmouseenter="enter('-3841275234863465094');" onmouseout="out('-3841275234863465094');" style=""> 560              if(tableName.equalsIgnoreCase(oldTbName)){                                                            </span>
<span  style=""> 561                                                                                                                    </span>
<span class="-7486276484118623043" onmouseenter="enter('-7486276484118623043');" onmouseout="out('-7486276484118623043');" style=""><abbr title=" 562                  String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fieldKey);"> 562                  String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fie🔵</abbr></span>
<span class="-85150012511262136" onmouseenter="enter('-85150012511262136');" onmouseout="out('-85150012511262136');" style=""> 563                  SqlIdentifier newField = ((SqlIdentifier)selectNode).setName(0, newTbName);                       </span>
<span class="-3325104965504513825" onmouseenter="enter('-3325104965504513825');" onmouseout="out('-3325104965504513825');" style=""> 564                  newField = newField.setName(1, newFieldName);                                                     </span>
<span class="-7494318194999571350" onmouseenter="enter('-7494318194999571350');" onmouseout="out('-7494318194999571350');" style=""> 565                  ((SqlIdentifier)selectNode).assignNamesFrom(newField);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566              }                                                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 567              return;                                                                                               </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 568          }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 569              return;                                                                                               </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 570          }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 571                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 572                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 573                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 574                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 575                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 576                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 577                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 578                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 579                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 580                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 581                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 582                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 583                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 584                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 585                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 586                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 587                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 588                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 589                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 590                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 591                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 592                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 593                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 594                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 595                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 596                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 597                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 598                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 599                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 600                                                                                                                    </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 601          ){                                                                                                        </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 602              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 603              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 604                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 605                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 606                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607                  }                                                                                                 </span>
<span  style=""> 608                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 609                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 610                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 611                  }                                                                                                 </span>
<span  style=""> 612                                                                                                                    </span>
<span class="-2258996485445817623" onmouseenter="enter('-2258996485445817623');" onmouseout="out('-2258996485445817623');" style=""> 613                  replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614              }                                                                                                     </span>
<span  style=""> 615                                                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 616              return;                                                                                               </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 617          }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 618              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 619              return;                                                                                               </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 620          } else if (selectNode.getKind() == CASE) {                                                                </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 621              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span  style=""> 622                                                                                                                    </span>
<span class="-2315512384759132147" onmouseenter="enter('-2315512384759132147');" onmouseout="out('-2315512384759132147');" style=""><abbr title=" 623              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 623              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbN🔵</abbr></span>
<span class="-1345654988953747553" onmouseenter="enter('-1345654988953747553');" onmouseout="out('-1345654988953747553');" style=""><abbr title=" 624              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 624              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbN🔵</abbr></span>
<span class="-7836146409865535589" onmouseenter="enter('-7836146409865535589');" onmouseout="out('-7836146409865535589');" style=""> 625              replaceConditionNode(sqlCase.getElseOperand(), oldTbName, newTbName, fieldReplaceRef);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 626          } else {                                                                                                  </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 627              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 627              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 628          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629      }                                                                                                             </span>
<span  style=""> 630                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 631      /**                                                                                                           </span>
<span class="1570055177673011707" onmouseenter="enter('1570055177673011707');" onmouseout="out('1570055177673011707');" style=""> 632       * 获取条件中关联的表信息                                                                                                </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 633       * @param selectNode                                                                                          </span>
<span class="-4813798938110383556" onmouseenter="enter('-4813798938110383556');" onmouseout="out('-4813798938110383556');" style=""> 634       * @param fieldInfos                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 635       */                                                                                                           </span>
<span class="7137057397975985823" onmouseenter="enter('7137057397975985823');" onmouseout="out('7137057397975985823');" style=""> 636      public static void getConditionRefTable(SqlNode selectNode, Set&lt;String&gt; fieldInfos) {                         </span>
<span class="-3454817955506608063" onmouseenter="enter('-3454817955506608063');" onmouseout="out('-3454817955506608063');" style=""> 637          if (selectNode.getKind() == IDENTIFIER) {                                                                 </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 638              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 639                                                                                                                    </span>
<span class="380773342968557196" onmouseenter="enter('380773342968557196');" onmouseout="out('380773342968557196');" style=""> 640              fieldInfos.add(sqlIdentifier.toString());                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 641              return;                                                                                               </span>
<span class="6757358046968148413" onmouseenter="enter('6757358046968148413');" onmouseout="out('6757358046968148413');" style=""> 642          } else if (selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN) {//字面含义              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 643              return;                                                                                               </span>
<span class="-4023999264561783968" onmouseenter="enter('-4023999264561783968');" onmouseout="out('-4023999264561783968');" style=""> 644          } else if (AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 645                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 646                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 647                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 648                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 649                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 650                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 651                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 652                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 653                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 654                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 655                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 656                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 657                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 658                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 659                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 660                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 661                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 662                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 663                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 664                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 665                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 666                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 667                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 668                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 669                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 670                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 671                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 672                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 673                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 674                                                                                                                    </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 675                  ) {                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 676              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 677              for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                         </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 678                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 679                  if (sqlNode instanceof SqlLiteral) {                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 680                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681                  }                                                                                                 </span>
<span  style=""> 682                                                                                                                    </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 683                  if (sqlNode instanceof SqlDataTypeSpec) {                                                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 684                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685                  }                                                                                                 </span>
<span  style=""> 686                                                                                                                    </span>
<span class="56198544928191592" onmouseenter="enter('56198544928191592');" onmouseout="out('56198544928191592');" style=""> 687                  getConditionRefTable(sqlNode, fieldInfos);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688              }                                                                                                     </span>
<span  style=""> 689                                                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 690              return;                                                                                               </span>
<span class="-2308646561142794789" onmouseenter="enter('-2308646561142794789');" onmouseout="out('-2308646561142794789');" style=""> 691          } else if (selectNode.getKind() == OTHER) {                                                               </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 692              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 693              return;                                                                                               </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 694          } else if (selectNode.getKind() == CASE) {                                                                </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 695              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span  style=""> 696                                                                                                                    </span>
<span class="-3537580079884591293" onmouseenter="enter('-3537580079884591293');" onmouseout="out('-3537580079884591293');" style=""> 697              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));    </span>
<span class="2144257116225237462" onmouseenter="enter('2144257116225237462');" onmouseout="out('2144257116225237462');" style=""> 698              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));    </span>
<span class="-5604248574568658683" onmouseenter="enter('-5604248574568658683');" onmouseout="out('-5604248574568658683');" style=""> 699              getConditionRefTable(sqlCase.getElseOperand(), fieldInfos);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 700          } else {                                                                                                  </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 701              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 701              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 703      }                                                                                                             </span>
<span  style=""> 704                                                                                                                    </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style=""> 705      public static String buildTableField(String tableName, String fieldName){                                     </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style=""> 706          return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 707      }                                                                                                             </span>
<span  style=""> 708                                                                                                                    </span>
<span  style=""> 709                                                                                                                    </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style=""> 710      public static String buildTableNameWithScope(String tableName, String scope){                                 </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style=""> 711          if(StringUtils.isEmpty(scope)){                                                                           </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 712              return tableName;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 713          }                                                                                                         </span>
<span  style=""> 714                                                                                                                    </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style=""> 715          return tableName + &quot;_&quot; + scope;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 716      }                                                                                                             </span>
<span  style=""> 717                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 718 +    /**                                                                                                           </span>
<span class="6497150561674133661" onmouseenter="enter('6497150561674133661');" onmouseout="out('6497150561674133661');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 719 +     * add constant join fields, using in such as hbase、redis etc kv database                                     </span>
<span class="-8477144116998604047" onmouseenter="enter('-8477144116998604047');" onmouseout="out('-8477144116998604047');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 720 +     * @param keyMap                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 721 +     */                                                                                                           </span>
<span class="7525620767750394099" onmouseenter="enter('7525620767750394099');" onmouseout="out('7525620767750394099');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 722 +    public static void addConstant(Map&lt;String, Object&gt; keyMap, AbstractSideTableInfo sideTableInfo) {             </span>
<span class="3178460372749787756" onmouseenter="enter('3178460372749787756');" onmouseout="out('3178460372749787756');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 723 +        List&lt;PredicateInfo&gt; predicateInfos = sideTableInfo.getPredicateInfoes();                                  </span>
<span class="-6183321864643515167" onmouseenter="enter('-6183321864643515167');" onmouseout="out('-6183321864643515167');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 724 +        final String name = sideTableInfo.getName();                                                              </span>
<span class="7309058727137890263" onmouseenter="enter('7309058727137890263');" onmouseout="out('7309058727137890263');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 725 +        for (PredicateInfo info : predicateInfos) {                                                               </span>
<span class="2363297685674950976" onmouseenter="enter('2363297685674950976');" onmouseout="out('2363297685674950976');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 726 +            if (info.getOwnerTable().equals(name)                                                                 </span>
<span class="-1265448967873634704" onmouseenter="enter('-1265448967873634704');" onmouseout="out('-1265448967873634704');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 727 +                &amp;&amp; info.getOperatorName().equals(&quot;=&quot;)) {                                                          </span>
<span class="-3488992775588585467" onmouseenter="enter('-3488992775588585467');" onmouseout="out('-3488992775588585467');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 728 +                String condition = info.getCondition();                                                           </span>
<span class="-3376001444363563672" onmouseenter="enter('-3376001444363563672');" onmouseout="out('-3376001444363563672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 729 +                Matcher matcher = stringPattern.matcher(condition);                                               </span>
<span class="2974565333979476345" onmouseenter="enter('2974565333979476345');" onmouseout="out('2974565333979476345');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 730 +                if (matcher.matches()) {                                                                          </span>
<span class="2819616911838313283" onmouseenter="enter('2819616911838313283');" onmouseout="out('2819616911838313283');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 731 +                    condition = condition.substring(1, condition.length() - 1);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 732 +                }                                                                                                 </span>
<span class="-2333073189429870453" onmouseenter="enter('-2333073189429870453');" onmouseout="out('-2333073189429870453');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 733 +                keyMap.put(info.getFieldName(), condition);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 734 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 735 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 736 +    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 737  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-4306334932652850837" onmouseenter="enter('-4306334932652850837');" onmouseout="out('-4306334932652850837');" style="">  20  package com.dtstack.flink.sql.util;                                                                               </span>
<span  style="">  21                                                                                                                    </span>

<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  22  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  23  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>

<span class="2669046595140278855" onmouseenter="enter('2669046595140278855');" onmouseout="out('2669046595140278855');" style="">  24  import com.google.common.base.Preconditions;                                                                      </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  25  import com.google.common.base.Strings;                                                                            </span>
<span class="-5849322492369628764" onmouseenter="enter('-5849322492369628764');" onmouseout="out('-5849322492369628764');" style="">  26  import com.google.common.collect.HashBasedTable;                                                                  </span>
<span class="-3028472584675896616" onmouseenter="enter('-3028472584675896616');" onmouseout="out('-3028472584675896616');" style="">  27  import com.google.common.collect.HashBiMap;                                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  28  import com.google.common.collect.Lists;                                                                           </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import com.google.common.collect.Sets;                                                                            </span>
<span class="5491780355398545512" onmouseenter="enter('5491780355398545512');" onmouseout="out('5491780355398545512');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import com.typesafe.config.ConfigException;                                                                       </span>
<span class="-6347312057640942811" onmouseenter="enter('-6347312057640942811');" onmouseout="out('-6347312057640942811');" style="">  31  import org.apache.calcite.sql.SqlAsOperator;                                                                      </span>
<span class="-2880165776056730027" onmouseenter="enter('-2880165776056730027');" onmouseout="out('-2880165776056730027');" style="">  32  import org.apache.calcite.sql.SqlBasicCall;                                                                       </span>
<span class="166699767162158130" onmouseenter="enter('166699767162158130');" onmouseout="out('166699767162158130');" style="">  33  import org.apache.calcite.sql.SqlDataTypeSpec;                                                                    </span>
<span class="-589720985119795452" onmouseenter="enter('-589720985119795452');" onmouseout="out('-589720985119795452');" style="">  34  import org.apache.calcite.sql.SqlIdentifier;                                                                      </span>
<span class="6040609180412894066" onmouseenter="enter('6040609180412894066');" onmouseout="out('6040609180412894066');" style="">  35  import org.apache.calcite.sql.SqlJoin;                                                                            </span>
<span class="5269832681984582353" onmouseenter="enter('5269832681984582353');" onmouseout="out('5269832681984582353');" style="">  36  import org.apache.calcite.sql.SqlKind;                                                                            </span>
<span class="8852969977988754364" onmouseenter="enter('8852969977988754364');" onmouseout="out('8852969977988754364');" style="">  37  import org.apache.calcite.sql.SqlLiteral;                                                                         </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  38  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="1272597113869071893" onmouseenter="enter('1272597113869071893');" onmouseout="out('1272597113869071893');" style="">  39  import org.apache.calcite.sql.SqlNodeList;                                                                        </span>
<span class="2919518510870551176" onmouseenter="enter('2919518510870551176');" onmouseout="out('2919518510870551176');" style="">  40  import org.apache.calcite.sql.SqlOperator;                                                                        </span>
<span class="1429561171107518415" onmouseenter="enter('1429561171107518415');" onmouseout="out('1429561171107518415');" style="">  41  import org.apache.calcite.sql.SqlSelect;                                                                          </span>
<span class="7522331514027736252" onmouseenter="enter('7522331514027736252');" onmouseout="out('7522331514027736252');" style="">  42  import org.apache.calcite.sql.fun.SqlCase;                                                                        </span>
<span class="-8475519504744506507" onmouseenter="enter('-8475519504744506507');" onmouseout="out('-8475519504744506507');" style="">  43  import org.apache.calcite.sql.parser.SqlParserPos;                                                                </span>
<span class="8596464405353709537" onmouseenter="enter('8596464405353709537');" onmouseout="out('8596464405353709537');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +import org.apache.commons.collections.CollectionUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  45  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  46  import org.apache.flink.table.api.Table;                                                                          </span>
<span  style="">  47                                                                                                                    </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  48  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  49  import java.util.Map;                                                                                             </span>
<span class="-2789246819365843415" onmouseenter="enter('-2789246819365843415');" onmouseout="out('-2789246819365843415');" style="">  50  import java.util.Queue;                                                                                           </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  51  import java.util.Set;                                                                                             </span>


<span  style="">  52                                                                                                                    </span>
<span class="7147213704442467623" onmouseenter="enter('7147213704442467623');" onmouseout="out('7147213704442467623');" style="">  53  import static org.apache.calcite.sql.SqlKind.*;                                                                   </span>
<span class="511836661302622038" onmouseenter="enter('511836661302622038');" onmouseout="out('511836661302622038');" style="">  54  import static org.apache.calcite.sql.SqlKind.CASE;                                                                </span>
<span class="178844392791952204" onmouseenter="enter('178844392791952204');" onmouseout="out('178844392791952204');" style="">  55  import static org.apache.calcite.sql.SqlKind.OTHER;                                                               </span>
<span  style="">  56                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  57  /**                                                                                                               </span>
<span class="2491900718050250190" onmouseenter="enter('2491900718050250190');" onmouseout="out('2491900718050250190');" style="">  58   * 表的解析相关                                                                                                         </span>
<span class="-831295595380638887" onmouseenter="enter('-831295595380638887');" onmouseout="out('-831295595380638887');" style="">  59   * Date: 2020/2/17                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  60   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  61   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  62   */                                                                                                               </span>
<span  style="">  63                                                                                                                    </span>
<span class="-5515152307095787287" onmouseenter="enter('-5515152307095787287');" onmouseout="out('-5515152307095787287');" style="">  64  public class TableUtils {                                                                                         </span>
<span  style="">  65                                                                                                                    </span>
<span class="6670707421612748000" onmouseenter="enter('6670707421612748000');" onmouseout="out('6670707421612748000');" style="">  66      public static final char SPLIT = &#x27;_&#x27;;                                                                         </span>
<span  style="">  67                                                                                                                    </span>

<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68      /**                                                                                                           </span>
<span class="-3835139450942807208" onmouseenter="enter('-3835139450942807208');" onmouseout="out('-3835139450942807208');" style="">  69       * 获取select 的字段                                                                                               </span>
<span class="-592626010544206006" onmouseenter="enter('-592626010544206006');" onmouseout="out('-592626010544206006');" style="">  70       * @param sqlSelect                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  71       */                                                                                                           </span>
<span class="-662197916250462065" onmouseenter="enter('-662197916250462065');" onmouseout="out('-662197916250462065');" style="">  72      public static List&lt;FieldInfo&gt; parserSelectField(SqlSelect sqlSelect, Map&lt;String, Table&gt; localTableCache){     </span>
<span class="8036786023408828043" onmouseenter="enter('8036786023408828043');" onmouseout="out('8036786023408828043');" style="">  73          SqlNodeList sqlNodeList = sqlSelect.getSelectList();                                                      </span>
<span class="-3054172495871960241" onmouseenter="enter('-3054172495871960241');" onmouseout="out('-3054172495871960241');" style="">  74          List&lt;FieldInfo&gt; fieldInfoList = Lists.newArrayList();                                                     </span>
<span class="-839692389379732251" onmouseenter="enter('-839692389379732251');" onmouseout="out('-839692389379732251');" style="">  75          String fromNode = sqlSelect.getFrom().toString();                                                         </span>
<span  style="">  76                                                                                                                    </span>
<span class="2162301537633635938" onmouseenter="enter('2162301537633635938');" onmouseout="out('2162301537633635938');" style="">  77          for (SqlNode fieldNode : sqlNodeList.getList()) {                                                         </span>
<span class="1465841598931987040" onmouseenter="enter('1465841598931987040');" onmouseout="out('1465841598931987040');" style="">  78              extractSelectFieldToFieldInfo(fieldNode,fromNode,fieldInfoList,localTableCache);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79          }                                                                                                         </span>
<span  style="">  80                                                                                                                    </span>
<span class="1335352475287465914" onmouseenter="enter('1335352475287465914');" onmouseout="out('1335352475287465914');" style="">  81          return fieldInfoList;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82      }                                                                                                             </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84      /**                                                                                                           </span>
<span class="-6805611089677825770" onmouseenter="enter('-6805611089677825770');" onmouseout="out('-6805611089677825770');" style="">  85       *  解析select Node 提取FieldInfo                                                                                 </span>
<span class="697554033229417632" onmouseenter="enter('697554033229417632');" onmouseout="out('697554033229417632');" style="">  86       * @param fieldNode                                                                                           </span>
<span class="-1719315088034482430" onmouseenter="enter('-1719315088034482430');" onmouseout="out('-1719315088034482430');" style="">  87       * @param fromNode                                                                                            </span>
<span class="8898190159008473723" onmouseenter="enter('8898190159008473723');" onmouseout="out('8898190159008473723');" style="">  88       * @param fieldInfoList                                                                                       </span>
<span class="-2613125561450459797" onmouseenter="enter('-2613125561450459797');" onmouseout="out('-2613125561450459797');" style="">  89       * @param localTableCache                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90       */                                                                                                           </span>
<span class="911398554884375981" onmouseenter="enter('911398554884375981');" onmouseout="out('911398554884375981');" style=""><abbr title="  91      public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfoList, Map&lt;String, Table&gt; localTableCache) {">  91      public static void extractSelectFieldToFieldInfo(SqlNode fieldNode, String fromNode, List&lt;FieldInfo&gt; fieldInfo🔵</abbr></span>
<span class="8336572539967602309" onmouseenter="enter('8336572539967602309');" onmouseout="out('8336572539967602309');" style="">  92          if (fieldNode.getKind() == IDENTIFIER) {                                                                  </span>
<span class="2728418029840045752" onmouseenter="enter('2728418029840045752');" onmouseout="out('2728418029840045752');" style="">  93              SqlIdentifier identifier = (SqlIdentifier) fieldNode;                                                 </span>
<span class="-5519378359901478287" onmouseenter="enter('-5519378359901478287');" onmouseout="out('-5519378359901478287');" style="">  94              if (!identifier.isStar()) {                                                                           </span>
<span class="7382398262726877456" onmouseenter="enter('7382398262726877456');" onmouseout="out('7382398262726877456');" style=""><abbr title="  95                  String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple();">  95                  String tableName = identifier.names.size() == 1 ? fromNode : identifier.getComponent(0).getSimple(🔵</abbr></span>
<span class="-4078369372891740310" onmouseenter="enter('-4078369372891740310');" onmouseout="out('-4078369372891740310');" style=""><abbr title="  96                  String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identifier.getComponent(1).getSimple();">  96                  String fieldName = identifier.names.size() == 1 ? identifier.getComponent(0).getSimple() : identif🔵</abbr></span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style="">  97                  FieldInfo fieldInfo = new FieldInfo();                                                            </span>
<span class="-3246065580716586601" onmouseenter="enter('-3246065580716586601');" onmouseout="out('-3246065580716586601');" style="">  98                  fieldInfo.setTable(tableName);                                                                    </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style="">  99                  fieldInfo.setFieldName(fieldName);                                                                </span>
<span  style=""> 100                                                                                                                    </span>
<span class="4376905192285837026" onmouseenter="enter('4376905192285837026');" onmouseout="out('4376905192285837026');" style=""> 101                  if (!fieldInfoList.contains(fieldInfo)) {                                                         </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 102                      fieldInfoList.add(fieldInfo);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 104              } else {                                                                                              </span>
<span class="2893145864113934715" onmouseenter="enter('2893145864113934715');" onmouseout="out('2893145864113934715');" style=""> 105                  //处理                                                                                              </span>
<span class="-3160769060475159310" onmouseenter="enter('-3160769060475159310');" onmouseout="out('-3160769060475159310');" style=""> 106                  int identifierSize = identifier.names.size();                                                     </span>
<span class="5352978315561223025" onmouseenter="enter('5352978315561223025');" onmouseout="out('5352978315561223025');" style=""> 107                  switch (identifierSize) {                                                                         </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 108                      case 1:                                                                                       </span>
<span class="543169233263070967" onmouseenter="enter('543169233263070967');" onmouseout="out('543169233263070967');" style=""> 109                          throw new RuntimeException(&quot;not support to parse * without scope of table&quot;);              </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 110                      default:                                                                                      </span>
<span class="7234102748034848382" onmouseenter="enter('7234102748034848382');" onmouseout="out('7234102748034848382');" style=""> 111                          SqlIdentifier tableIdentify = identifier.skipLast(1);                                     </span>
<span class="-7038658933458861113" onmouseenter="enter('-7038658933458861113');" onmouseout="out('-7038658933458861113');" style=""> 112                          Table registerTable = localTableCache.get(tableIdentify.getSimple());                     </span>
<span class="-5997676555615328170" onmouseenter="enter('-5997676555615328170');" onmouseout="out('-5997676555615328170');" style=""> 113                          if (registerTable == null) {                                                              </span>
<span class="6481995910302552391" onmouseenter="enter('6481995910302552391');" onmouseout="out('6481995910302552391');" style=""> 114                              throw new RuntimeException(&quot;can&#x27;t find table alias &quot; + tableIdentify.getSimple());    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115                          }                                                                                         </span>
<span  style=""> 116                                                                                                                    </span>
<span class="-4547568303745452703" onmouseenter="enter('-4547568303745452703');" onmouseout="out('-4547568303745452703');" style=""> 117                          String[] fieldNames = registerTable.getSchema().getFieldNames();                          </span>
<span class="-7408478396859326180" onmouseenter="enter('-7408478396859326180');" onmouseout="out('-7408478396859326180');" style=""> 118                          for (String fieldName : fieldNames) {                                                     </span>
<span class="6241499873998235419" onmouseenter="enter('6241499873998235419');" onmouseout="out('6241499873998235419');" style=""> 119                              FieldInfo fieldInfo = new FieldInfo();                                                </span>
<span class="-5561911469151499170" onmouseenter="enter('-5561911469151499170');" onmouseout="out('-5561911469151499170');" style=""> 120                              fieldInfo.setTable(tableIdentify.getSimple());                                        </span>
<span class="-8148803826585168382" onmouseenter="enter('-8148803826585168382');" onmouseout="out('-8148803826585168382');" style=""> 121                              fieldInfo.setFieldName(fieldName);                                                    </span>
<span class="6693537336825493567" onmouseenter="enter('6693537336825493567');" onmouseout="out('6693537336825493567');" style=""> 122                              fieldInfoList.add(fieldInfo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125              }                                                                                                     </span>
<span class="355751622478352774" onmouseenter="enter('355751622478352774');" onmouseout="out('355751622478352774');" style=""> 126          } else if (AGGREGATE.contains(fieldNode.getKind())                                                        </span>
<span class="-4728546343803188943" onmouseenter="enter('-4728546343803188943');" onmouseout="out('-4728546343803188943');" style=""> 127                  || AVG_AGG_FUNCTIONS.contains(fieldNode.getKind())                                                </span>
<span class="8973512118577358544" onmouseenter="enter('8973512118577358544');" onmouseout="out('8973512118577358544');" style=""> 128                  || COMPARISON.contains(fieldNode.getKind())                                                       </span>
<span class="525772482672043181" onmouseenter="enter('525772482672043181');" onmouseout="out('525772482672043181');" style=""> 129                  || fieldNode.getKind() == OTHER_FUNCTION                                                          </span>
<span class="4987264283847416523" onmouseenter="enter('4987264283847416523');" onmouseout="out('4987264283847416523');" style=""> 130                  || fieldNode.getKind() == DIVIDE                                                                  </span>
<span class="-2097459444898035710" onmouseenter="enter('-2097459444898035710');" onmouseout="out('-2097459444898035710');" style=""> 131                  || fieldNode.getKind() == CAST                                                                    </span>
<span class="621194935667432352" onmouseenter="enter('621194935667432352');" onmouseout="out('621194935667432352');" style=""> 132                  || fieldNode.getKind() == TRIM                                                                    </span>
<span class="5379925649229703360" onmouseenter="enter('5379925649229703360');" onmouseout="out('5379925649229703360');" style=""> 133                  || fieldNode.getKind() == TIMES                                                                   </span>
<span class="-4394268980765693723" onmouseenter="enter('-4394268980765693723');" onmouseout="out('-4394268980765693723');" style=""> 134                  || fieldNode.getKind() == PLUS                                                                    </span>
<span class="-122938326578311005" onmouseenter="enter('-122938326578311005');" onmouseout="out('-122938326578311005');" style=""> 135                  || fieldNode.getKind() == NOT_IN                                                                  </span>
<span class="5635148239693374504" onmouseenter="enter('5635148239693374504');" onmouseout="out('5635148239693374504');" style=""> 136                  || fieldNode.getKind() == OR                                                                      </span>
<span class="-3217339780873839086" onmouseenter="enter('-3217339780873839086');" onmouseout="out('-3217339780873839086');" style=""> 137                  || fieldNode.getKind() == AND                                                                     </span>
<span class="2162998824653848637" onmouseenter="enter('2162998824653848637');" onmouseout="out('2162998824653848637');" style=""> 138                  || fieldNode.getKind() == MINUS                                                                   </span>
<span class="-506664053077300680" onmouseenter="enter('-506664053077300680');" onmouseout="out('-506664053077300680');" style=""> 139                  || fieldNode.getKind() == TUMBLE                                                                  </span>
<span class="-1822630894260242331" onmouseenter="enter('-1822630894260242331');" onmouseout="out('-1822630894260242331');" style=""> 140                  || fieldNode.getKind() == TUMBLE_START                                                            </span>
<span class="-8086489575650543701" onmouseenter="enter('-8086489575650543701');" onmouseout="out('-8086489575650543701');" style=""> 141                  || fieldNode.getKind() == TUMBLE_END                                                              </span>
<span class="-2609834003874905006" onmouseenter="enter('-2609834003874905006');" onmouseout="out('-2609834003874905006');" style=""> 142                  || fieldNode.getKind() == SESSION                                                                 </span>
<span class="6623716356682835746" onmouseenter="enter('6623716356682835746');" onmouseout="out('6623716356682835746');" style=""> 143                  || fieldNode.getKind() == SESSION_START                                                           </span>
<span class="-4356389762844455169" onmouseenter="enter('-4356389762844455169');" onmouseout="out('-4356389762844455169');" style=""> 144                  || fieldNode.getKind() == SESSION_END                                                             </span>
<span class="3788231826671768229" onmouseenter="enter('3788231826671768229');" onmouseout="out('3788231826671768229');" style=""> 145                  || fieldNode.getKind() == HOP                                                                     </span>
<span class="6798204869770216275" onmouseenter="enter('6798204869770216275');" onmouseout="out('6798204869770216275');" style=""> 146                  || fieldNode.getKind() == HOP_START                                                               </span>
<span class="250318287045370196" onmouseenter="enter('250318287045370196');" onmouseout="out('250318287045370196');" style=""> 147                  || fieldNode.getKind() == HOP_END                                                                 </span>
<span class="9109972257207472540" onmouseenter="enter('9109972257207472540');" onmouseout="out('9109972257207472540');" style=""> 148                  || fieldNode.getKind() == BETWEEN                                                                 </span>
<span class="6983217744831152908" onmouseenter="enter('6983217744831152908');" onmouseout="out('6983217744831152908');" style=""> 149                  || fieldNode.getKind() == IS_NULL                                                                 </span>
<span class="-1122161678078794235" onmouseenter="enter('-1122161678078794235');" onmouseout="out('-1122161678078794235');" style=""> 150                  || fieldNode.getKind() == IS_NOT_NULL                                                             </span>
<span class="-3733427582644132679" onmouseenter="enter('-3733427582644132679');" onmouseout="out('-3733427582644132679');" style=""> 151                  || fieldNode.getKind() == CONTAINS                                                                </span>
<span class="-9056199605453305302" onmouseenter="enter('-9056199605453305302');" onmouseout="out('-9056199605453305302');" style=""> 152                  || fieldNode.getKind() == TIMESTAMP_ADD                                                           </span>
<span class="-134492662313070004" onmouseenter="enter('-134492662313070004');" onmouseout="out('-134492662313070004');" style=""> 153                  || fieldNode.getKind() == TIMESTAMP_DIFF                                                          </span>
<span class="6146091325000099373" onmouseenter="enter('6146091325000099373');" onmouseout="out('6146091325000099373');" style=""> 154                  || fieldNode.getKind() == LIKE                                                                    </span>
<span class="4953146235532857216" onmouseenter="enter('4953146235532857216');" onmouseout="out('4953146235532857216');" style=""> 155                  || fieldNode.getKind() == COALESCE                                                                </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 156                  ) {                                                                                               </span>
<span class="-354400113971550997" onmouseenter="enter('-354400113971550997');" onmouseout="out('-354400113971550997');" style=""> 157              SqlBasicCall sqlBasicCall = (SqlBasicCall) fieldNode;                                                 </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 158              for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                         </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 159                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 160                  if (sqlNode instanceof SqlLiteral) {                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 161                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162                  }                                                                                                 </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 164                  if (sqlNode instanceof SqlDataTypeSpec) {                                                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 165                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166                  }                                                                                                 </span>
<span class="-5978367516025835425" onmouseenter="enter('-5978367516025835425');" onmouseout="out('-5978367516025835425');" style=""> 167                  extractSelectFieldToFieldInfo(sqlNode, fromNode, fieldInfoList, localTableCache);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168              }                                                                                                     </span>
<span class="-3590348607861839793" onmouseenter="enter('-3590348607861839793');" onmouseout="out('-3590348607861839793');" style=""> 169          } else if (fieldNode.getKind() == AS) {                                                                   </span>
<span class="3703210587199661065" onmouseenter="enter('3703210587199661065');" onmouseout="out('3703210587199661065');" style=""> 170              SqlNode leftNode = ((SqlBasicCall) fieldNode).getOperands()[0];                                       </span>
<span class="-2607912045389455868" onmouseenter="enter('-2607912045389455868');" onmouseout="out('-2607912045389455868');" style=""> 171              extractSelectFieldToFieldInfo(leftNode, fromNode,fieldInfoList, localTableCache);                     </span>
<span class="-3651943351416933315" onmouseenter="enter('-3651943351416933315');" onmouseout="out('-3651943351416933315');" style=""> 172          } else if (fieldNode.getKind() == CASE) {                                                                 </span>
<span class="7184861900726949901" onmouseenter="enter('7184861900726949901');" onmouseout="out('7184861900726949901');" style=""> 173              SqlCase sqlCase = (SqlCase) fieldNode;                                                                </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 174              SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 175              SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 176              SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style=""> 177                                                                                                                    </span>
<span class="5804242455667685406" onmouseenter="enter('5804242455667685406');" onmouseout="out('5804242455667685406');" style=""> 178              for (int i = 0; i &lt; whenOperands.size(); i++) {                                                       </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 179                  SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 180                  extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181              }                                                                                                     </span>
<span  style=""> 182                                                                                                                    </span>
<span class="-7770933914215809062" onmouseenter="enter('-7770933914215809062');" onmouseout="out('-7770933914215809062');" style=""> 183              for (int i = 0; i &lt; thenOperands.size(); i++) {                                                       </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 184                  SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="3812487458543284418" onmouseenter="enter('3812487458543284418');" onmouseout="out('3812487458543284418');" style=""> 185                  extractSelectFieldToFieldInfo(oneOperand, fromNode, fieldInfoList, localTableCache);              </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187              }                                                                                                     </span>
<span  style=""> 188                                                                                                                    </span>
<span class="7029049357943474126" onmouseenter="enter('7029049357943474126');" onmouseout="out('7029049357943474126');" style=""> 189              extractSelectFieldToFieldInfo(elseNode, fromNode, fieldInfoList, localTableCache);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191      }                                                                                                             </span>
<span  style=""> 192                                                                                                                    </span>
<span class="44665875153783342" onmouseenter="enter('44665875153783342');" onmouseout="out('44665875153783342');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -    public static String buildInternalTableName(String left, char split, String right) {                          </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="666148872664318228" onmouseenter="enter('666148872664318228');" onmouseout="out('666148872664318228');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -        return sb.append(left).append(split).append(right).toString();                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                                                                                                                  </span>
<span class="-8999074733125454701" onmouseenter="enter('-8999074733125454701');" onmouseout="out('-8999074733125454701');" style=""> 198      public static SqlBasicCall buildAsNodeByJoinInfo(JoinInfo joinInfo, SqlNode sqlNode0, String tableAlias) {    </span>
<span class="2981236818393294037" onmouseenter="enter('2981236818393294037');" onmouseout="out('2981236818393294037');" style=""> 199          SqlOperator operator = new SqlAsOperator();                                                               </span>
<span  style=""> 200                                                                                                                    </span>
<span class="-1667801166019875282" onmouseenter="enter('-1667801166019875282');" onmouseout="out('-1667801166019875282');" style=""> 201          SqlParserPos sqlParserPos = new SqlParserPos(0, 0);                                                       </span>
<span class="4539692765329264390" onmouseenter="enter('4539692765329264390');" onmouseout="out('4539692765329264390');" style=""> 202          String newTableName = joinInfo.getNewTableName();                                                         </span>
<span class="1665950166508651073" onmouseenter="enter('1665950166508651073');" onmouseout="out('1665950166508651073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -        String lefTbAlias = joinInfo.getLeftTableAlias();                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                                                                                                                  </span>
<span class="2319480499474441641" onmouseenter="enter('2319480499474441641');" onmouseout="out('2319480499474441641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -        if(Strings.isNullOrEmpty(lefTbAlias)){                                                                    </span>
<span class="-8245756693582446922" onmouseenter="enter('-8245756693582446922');" onmouseout="out('-8245756693582446922');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            Set&lt;String&gt; fromTableSet = Sets.newHashSet();                                                         </span>
<span class="-7547782328391666575" onmouseenter="enter('-7547782328391666575');" onmouseout="out('-7547782328391666575');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            TableUtils.getFromTableInfo(joinInfo.getLeftNode(), fromTableSet);                                    </span>
<span class="-5610405007192716156" onmouseenter="enter('-5610405007192716156');" onmouseout="out('-5610405007192716156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -            lefTbAlias = StringUtils.join(fromTableSet, &quot;_&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -                                                                                                                  </span>
<span class="-2305615543808332923" onmouseenter="enter('-2305615543808332923');" onmouseout="out('-2305615543808332923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 211 -        String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : buildInternalTableName(lefTbAlias, SPLIT, joinInfo.getRightTableAlias());"> 211 -        String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : buildInternalTableName(lefTbAlias, 🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 212 +                                                                                                                  </span>
<span class="6968008278960771315" onmouseenter="enter('6968008278960771315');" onmouseout="out('6968008278960771315');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +        String newTableAlias = !StringUtils.isEmpty(tableAlias) ? tableAlias : joinInfo.getNewTableAlias();       </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-6474384717461795701" onmouseenter="enter('-6474384717461795701');" onmouseout="out('-6474384717461795701');" style=""> 215          if (null == sqlNode0) {                                                                                   </span>
<span class="-6562061848026015753" onmouseenter="enter('-6562061848026015753');" onmouseout="out('-6562061848026015753');" style=""> 216              sqlNode0 = new SqlIdentifier(newTableName, null, sqlParserPos);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217          }                                                                                                         </span>
<span  style=""> 218                                                                                                                    </span>
<span class="-2821647309854503598" onmouseenter="enter('-2821647309854503598');" onmouseout="out('-2821647309854503598');" style=""> 219          SqlIdentifier sqlIdentifierAlias = new SqlIdentifier(newTableAlias, null, sqlParserPos);                  </span>
<span class="-7310412248425019303" onmouseenter="enter('-7310412248425019303');" onmouseout="out('-7310412248425019303');" style=""> 220          SqlNode[] sqlNodes = new SqlNode[2];                                                                      </span>
<span class="-7781715169306512157" onmouseenter="enter('-7781715169306512157');" onmouseout="out('-7781715169306512157');" style=""> 221          sqlNodes[0] = sqlNode0;                                                                                   </span>
<span class="-4093556188235461327" onmouseenter="enter('-4093556188235461327');" onmouseout="out('-4093556188235461327');" style=""> 222          sqlNodes[1] = sqlIdentifierAlias;                                                                         </span>
<span class="-1928364106966605511" onmouseenter="enter('-1928364106966605511');" onmouseout="out('-1928364106966605511');" style=""> 223          return new SqlBasicCall(operator, sqlNodes, sqlParserPos);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224      }                                                                                                             </span>
<span  style=""> 225                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 226      /**                                                                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 227       *                                                                                                            </span>
<span class="-6040909485639107572" onmouseenter="enter('-6040909485639107572');" onmouseout="out('-6040909485639107572');" style=""> 228       * @param joinInfo                                                                                            </span>
<span class="3061148848694484073" onmouseenter="enter('3061148848694484073');" onmouseout="out('3061148848694484073');" style=""> 229       * @param sqlNode                                                                                             </span>
<span class="3894561521416724418" onmouseenter="enter('3894561521416724418');" onmouseout="out('3894561521416724418');" style=""> 230       * @param queueInfo                                                                                           </span>
<span class="-8382295939765334869" onmouseenter="enter('-8382295939765334869');" onmouseout="out('-8382295939765334869');" style=""> 231       * @return   两个边关联后的新表表名                                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 232       */                                                                                                           </span>
<span class="-9105373632393246263" onmouseenter="enter('-9105373632393246263');" onmouseout="out('-9105373632393246263');" style=""><abbr title=" 233      public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInfo) {"> 233      public static String dealSelectResultWithJoinInfo(JoinInfo joinInfo, SqlSelect sqlNode, Queue&lt;Object&gt; queueInf🔵</abbr></span>
<span class="-3012154526429275078" onmouseenter="enter('-3012154526429275078');" onmouseout="out('-3012154526429275078');" style=""> 234          //SideJoinInfo rename                                                                                     </span>
<span class="4973038183558270709" onmouseenter="enter('4973038183558270709');" onmouseout="out('4973038183558270709');" style=""> 235          if (joinInfo.checkIsSide()) {                                                                             </span>
<span class="8408112480551688226" onmouseenter="enter('8408112480551688226');" onmouseout="out('8408112480551688226');" style=""> 236              joinInfo.setSelectFields(sqlNode.getSelectList());                                                    </span>
<span class="4794732995049884760" onmouseenter="enter('4794732995049884760');" onmouseout="out('4794732995049884760');" style=""> 237              joinInfo.setSelectNode(sqlNode);                                                                      </span>
<span class="1448684309320227021" onmouseenter="enter('1448684309320227021');" onmouseout="out('1448684309320227021');" style=""> 238              if (joinInfo.isRightIsSideTable()) {                                                                  </span>
<span class="-476802833010893550" onmouseenter="enter('-476802833010893550');" onmouseout="out('-476802833010893550');" style=""> 239                  //Analyzing left is not a simple table                                                            </span>
<span class="6867568634948481821" onmouseenter="enter('6867568634948481821');" onmouseout="out('6867568634948481821');" style=""> 240                  if (joinInfo.getLeftNode().getKind() == SELECT) {                                                 </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 241                      queueInfo.offer(joinInfo.getLeftNode());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242                  }                                                                                                 </span>
<span  style=""> 243                                                                                                                    </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 244                  queueInfo.offer(joinInfo);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 245              } else {                                                                                              </span>
<span class="5635813491573439188" onmouseenter="enter('5635813491573439188');" onmouseout="out('5635813491573439188');" style=""> 246                  //Determining right is not a simple table                                                         </span>
<span class="2468473214053427731" onmouseenter="enter('2468473214053427731');" onmouseout="out('2468473214053427731');" style=""> 247                  if (joinInfo.getRightNode().getKind() == SELECT) {                                                </span>
<span class="-7653135685693838963" onmouseenter="enter('-7653135685693838963');" onmouseout="out('-7653135685693838963');" style=""> 248                      queueInfo.offer(joinInfo.getLeftNode());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249                  }                                                                                                 </span>
<span  style=""> 250                                                                                                                    </span>
<span class="6641920780390342492" onmouseenter="enter('6641920780390342492');" onmouseout="out('6641920780390342492');" style=""> 251                  queueInfo.offer(joinInfo);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252              }                                                                                                     </span>
<span class="-7933690095328677787" onmouseenter="enter('-7933690095328677787');" onmouseout="out('-7933690095328677787');" style=""> 253              replaceFromNodeForJoin(joinInfo, sqlNode);                                                            </span>
<span class="-3213976632367322289" onmouseenter="enter('-3213976632367322289');" onmouseout="out('-3213976632367322289');" style=""> 254              return joinInfo.getNewTableName();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255          }                                                                                                         </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 256          return &quot;&quot;;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257      }                                                                                                             </span>
<span  style=""> 258                                                                                                                    </span>
<span class="8074977299710029932" onmouseenter="enter('8074977299710029932');" onmouseout="out('8074977299710029932');" style=""> 259      public static void replaceFromNodeForJoin(JoinInfo joinInfo, SqlSelect sqlNode) {                             </span>
<span class="-9060489602533315077" onmouseenter="enter('-9060489602533315077');" onmouseout="out('-9060489602533315077');" style=""> 260          //Update from node                                                                                        </span>
<span class="2204164800083526508" onmouseenter="enter('2204164800083526508');" onmouseout="out('2204164800083526508');" style=""> 261          SqlBasicCall sqlBasicCall = buildAsNodeByJoinInfo(joinInfo, null, null);                                  </span>
<span class="-8082788431941340980" onmouseenter="enter('-8082788431941340980');" onmouseout="out('-8082788431941340980');" style=""> 262          String newAliasName = sqlBasicCall.operand(1).toString();                                                 </span>
<span  style=""> 263                                                                                                                    </span>
<span class="-4706120631660601296" onmouseenter="enter('-4706120631660601296');" onmouseout="out('-4706120631660601296');" style=""> 264          //替换select 中的属性为新的表名称和字段                                                                                  </span>
<span class="8210217038029633734" onmouseenter="enter('8210217038029633734');" onmouseout="out('8210217038029633734');" style=""> 265          HashBasedTable&lt;String, String, String&gt; fieldMapping = joinInfo.getTableFieldRef();                        </span>
<span class="-6200687028928637107" onmouseenter="enter('-6200687028928637107');" onmouseout="out('-6200687028928637107');" style=""> 266          Map&lt;String, String&gt; leftFieldMapping = fieldMapping.row(joinInfo.getLeftTableAlias());                    </span>
<span class="6534080411824570705" onmouseenter="enter('6534080411824570705');" onmouseout="out('6534080411824570705');" style=""> 267          Map&lt;String, String&gt; rightFieldMapping = fieldMapping.row(joinInfo.getRightTableAlias());                  </span>
<span  style=""> 268                                                                                                                    </span>
<span class="-7880903214764896195" onmouseenter="enter('-7880903214764896195');" onmouseout="out('-7880903214764896195');" style=""> 269         /* for(SqlNode oneSelectNode : sqlNode.getSelectList()){                                                   </span>
<span class="-4957689359258588920" onmouseenter="enter('-4957689359258588920');" onmouseout="out('-4957689359258588920');" style=""><abbr title=" 270              replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapping);"> 270              replaceSelectFieldTable(oneSelectNode, joinInfo.getLeftTableAlias(), newAliasName, null ,leftFieldMapp🔵</abbr></span>
<span class="6269709593519335658" onmouseenter="enter('6269709593519335658');" onmouseout="out('6269709593519335658');" style=""><abbr title=" 271              replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldMapping);"> 271              replaceSelectFieldTable(oneSelectNode, joinInfo.getRightTableAlias(), newAliasName, null , rightFieldM🔵</abbr></span>
<span class="-2684617365274670769" onmouseenter="enter('-2684617365274670769');" onmouseout="out('-2684617365274670769');" style=""> 272          }*/                                                                                                       </span>
<span  style=""> 273                                                                                                                    </span>
<span class="2103765898996250551" onmouseenter="enter('2103765898996250551');" onmouseout="out('2103765898996250551');" style=""> 274          //where中的条件属性为新的表名称和字段                                                                                    </span>
<span class="1856147124472045117" onmouseenter="enter('1856147124472045117');" onmouseout="out('1856147124472045117');" style=""> 275          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getLeftTableAlias(), newAliasName, leftFieldMapping); </span>
<span class="5021450334630795014" onmouseenter="enter('5021450334630795014');" onmouseout="out('5021450334630795014');" style=""><abbr title=" 276          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping);"> 276          FieldReplaceUtil.replaceFieldName(sqlNode, joinInfo.getRightTableAlias(), newAliasName, rightFieldMapping)🔵</abbr></span>
<span class="2813845980666839305" onmouseenter="enter('2813845980666839305');" onmouseout="out('2813845980666839305');" style=""> 277          sqlNode.setFrom(sqlBasicCall);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278      }                                                                                                             </span>
<span  style=""> 279                                                                                                                    </span>
<span  style=""> 280                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 281      /**                                                                                                           </span>
<span class="-9165896841480454412" onmouseenter="enter('-9165896841480454412');" onmouseout="out('-9165896841480454412');" style=""> 282       * 获取节点关联的查询表                                                                                                 </span>
<span class="4587700153042038306" onmouseenter="enter('4587700153042038306');" onmouseout="out('4587700153042038306');" style=""> 283       * @param fromTable                                                                                           </span>
<span class="-4525819317820325084" onmouseenter="enter('-4525819317820325084');" onmouseout="out('-4525819317820325084');" style=""> 284       * @param tableNameSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 285       */                                                                                                           </span>
<span class="-6773005969473787299" onmouseenter="enter('-6773005969473787299');" onmouseout="out('-6773005969473787299');" style=""> 286      public static void getFromTableInfo(SqlNode fromTable, Set&lt;String&gt; tableNameSet){                             </span>
<span class="-6901511047628253115" onmouseenter="enter('-6901511047628253115');" onmouseout="out('-6901511047628253115');" style=""> 287          SqlKind sqlKind = fromTable.getKind();                                                                    </span>
<span class="2714387737819984732" onmouseenter="enter('2714387737819984732');" onmouseout="out('2714387737819984732');" style=""> 288          switch (sqlKind){                                                                                         </span>
<span class="2219038699300296021" onmouseenter="enter('2219038699300296021');" onmouseout="out('2219038699300296021');" style=""> 289              case AS:                                                                                              </span>
<span class="6170293684489173764" onmouseenter="enter('6170293684489173764');" onmouseout="out('6170293684489173764');" style=""> 290                  SqlNode alias = ((SqlBasicCall) fromTable).getOperands()[1];                                      </span>
<span class="-4660347064811459637" onmouseenter="enter('-4660347064811459637');" onmouseout="out('-4660347064811459637');" style=""> 291                  tableNameSet.add(alias.toString());                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 292                  return;                                                                                           </span>
<span class="7645440911590124448" onmouseenter="enter('7645440911590124448');" onmouseout="out('7645440911590124448');" style=""> 293              case JOIN:                                                                                            </span>
<span class="7200443719768955748" onmouseenter="enter('7200443719768955748');" onmouseout="out('7200443719768955748');" style=""> 294                  getFromTableInfo(((SqlJoin)fromTable).getLeft(), tableNameSet);                                   </span>
<span class="-579883461259105749" onmouseenter="enter('-579883461259105749');" onmouseout="out('-579883461259105749');" style=""> 295                  getFromTableInfo(((SqlJoin)fromTable).getRight(), tableNameSet);                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 296                  return;                                                                                           </span>
<span class="-2304009782660987725" onmouseenter="enter('-2304009782660987725');" onmouseout="out('-2304009782660987725');" style=""> 297              case IDENTIFIER:                                                                                      </span>
<span class="6063930725080162048" onmouseenter="enter('6063930725080162048');" onmouseout="out('6063930725080162048');" style=""> 298                  tableNameSet.add(((SqlIdentifier)fromTable).getSimple());                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 299                  return;                                                                                           </span>
<span class="3125052951420706002" onmouseenter="enter('3125052951420706002');" onmouseout="out('3125052951420706002');" style=""> 300              case SELECT:                                                                                          </span>
<span class="4670049027501902925" onmouseenter="enter('4670049027501902925');" onmouseout="out('4670049027501902925');" style=""> 301                  getFromTableInfo(((SqlSelect) fromTable).getFrom(), tableNameSet);                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 302                  return;                                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 303              default:                                                                                              </span>
<span class="9006089180628885729" onmouseenter="enter('9006089180628885729');" onmouseout="out('9006089180628885729');" style=""> 304                  throw new RuntimeException(&quot;not support sqlKind:&quot; + sqlKind);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306      }                                                                                                             </span>
<span  style=""> 307                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 308      /**                                                                                                           </span>
<span class="8536034367776161836" onmouseenter="enter('8536034367776161836');" onmouseout="out('8536034367776161836');" style=""> 309       * 替换select 中的字段信息                                                                                            </span>
<span class="8563350786440524200" onmouseenter="enter('8563350786440524200');" onmouseout="out('8563350786440524200');" style=""> 310       * 如果mappingTable 非空则从该参数获取字段的映射                                                                              </span>
<span class="-6581838769493343810" onmouseenter="enter('-6581838769493343810');" onmouseout="out('-6581838769493343810');" style=""> 311       * 如果mappingTable 为空则根据是否存在新生成字段                                                                              </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 312       * @param selectNode                                                                                          </span>
<span class="-2283388782413973238" onmouseenter="enter('-2283388782413973238');" onmouseout="out('-2283388782413973238');" style=""> 313       * @param oldTbName                                                                                           </span>
<span class="7634289987105314089" onmouseenter="enter('7634289987105314089');" onmouseout="out('7634289987105314089');" style=""> 314       * @param newTbName                                                                                           </span>
<span class="8769527040545279755" onmouseenter="enter('8769527040545279755');" onmouseout="out('8769527040545279755');" style=""> 315       * @param fieldReplaceRef                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 316       */                                                                                                           </span>
<span class="5027529910148445847" onmouseenter="enter('5027529910148445847');" onmouseout="out('5027529910148445847');" style=""> 317      public static void replaceSelectFieldTable(SqlNode selectNode,                                                </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 318                                                 String oldTbName,                                                  </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 319                                                 String newTbName,                                                  </span>
<span class="7882147930720524356" onmouseenter="enter('7882147930720524356');" onmouseout="out('7882147930720524356');" style=""> 320                                                 HashBiMap&lt;String, String&gt; fieldReplaceRef) {                       </span>
<span class="8103739576060170768" onmouseenter="enter('8103739576060170768');" onmouseout="out('8103739576060170768');" style=""> 321          if (selectNode.getKind() == AS) {                                                                         </span>
<span class="1510889832473438632" onmouseenter="enter('1510889832473438632');" onmouseout="out('1510889832473438632');" style=""> 322              SqlNode leftNode = ((SqlBasicCall) selectNode).getOperands()[0];                                      </span>
<span class="-4674775763706954352" onmouseenter="enter('-4674775763706954352');" onmouseout="out('-4674775763706954352');" style=""> 323              replaceSelectFieldTable(leftNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span  style=""> 324                                                                                                                    </span>
<span class="-4525236033469860943" onmouseenter="enter('-4525236033469860943');" onmouseout="out('-4525236033469860943');" style=""> 325          }else if(selectNode.getKind() == IDENTIFIER){                                                             </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 326              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 327                                                                                                                    </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 328              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="-1755167016071657820" onmouseenter="enter('-1755167016071657820');" onmouseout="out('-1755167016071657820');" style=""> 329                  return ;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330              }                                                                                                     </span>
<span  style=""> 331                                                                                                                    </span>
<span class="1355631215618064105" onmouseenter="enter('1355631215618064105');" onmouseout="out('1355631215618064105');" style=""> 332              String fieldTableName = sqlIdentifier.names.get(0);                                                   </span>
<span class="-2979536462712829146" onmouseenter="enter('-2979536462712829146');" onmouseout="out('-2979536462712829146');" style=""> 333              if(oldTbName.equalsIgnoreCase(fieldTableName)){                                                       </span>
<span class="-4556037184452828083" onmouseenter="enter('-4556037184452828083');" onmouseout="out('-4556037184452828083');" style=""> 334                  replaceOneSelectField(sqlIdentifier, newTbName, oldTbName, fieldReplaceRef);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335              }                                                                                                     </span>
<span  style=""> 336                                                                                                                    </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 337          }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 338              return;                                                                                               </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 339          }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 340                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 341                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 342                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 343                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 344                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 345                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 346                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 347                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 348                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 349                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 350                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 351                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 352                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 353                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 354                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 355                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 356                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 357                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 358                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 359                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 360                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 361                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 362                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 363                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 364                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 365                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 366                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 367                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 368                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 369                                                                                                                    </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 370          ){                                                                                                        </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 371              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 372              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 373                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 374                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 375                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 376                  }                                                                                                 </span>
<span  style=""> 377                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 378                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 379                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380                  }                                                                                                 </span>
<span  style=""> 381                                                                                                                    </span>
<span class="-5676526903547679293" onmouseenter="enter('-5676526903547679293');" onmouseout="out('-5676526903547679293');" style=""> 382                  replaceSelectFieldTable(sqlNode, oldTbName, newTbName, fieldReplaceRef);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383              }                                                                                                     </span>
<span  style=""> 384                                                                                                                    </span>
<span class="2155507952934750451" onmouseenter="enter('2155507952934750451');" onmouseout="out('2155507952934750451');" style=""> 385          }else if(selectNode.getKind() == CASE){                                                                   </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 386              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span class="-3655271460728510010" onmouseenter="enter('-3655271460728510010');" onmouseout="out('-3655271460728510010');" style=""> 387              SqlNodeList whenOperands = sqlCase.getWhenOperands();                                                 </span>
<span class="8318973293639639494" onmouseenter="enter('8318973293639639494');" onmouseout="out('8318973293639639494');" style=""> 388              SqlNodeList thenOperands = sqlCase.getThenOperands();                                                 </span>
<span class="3014895614462197568" onmouseenter="enter('3014895614462197568');" onmouseout="out('3014895614462197568');" style=""> 389              SqlNode elseNode = sqlCase.getElseOperand();                                                          </span>
<span  style=""> 390                                                                                                                    </span>
<span class="6346785150356032184" onmouseenter="enter('6346785150356032184');" onmouseout="out('6346785150356032184');" style=""> 391              for(int i=0; i&lt;whenOperands.size(); i++){                                                             </span>
<span class="1734344807386881213" onmouseenter="enter('1734344807386881213');" onmouseout="out('1734344807386881213');" style=""> 392                  SqlNode oneOperand = whenOperands.get(i);                                                         </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 393                  replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394              }                                                                                                     </span>
<span  style=""> 395                                                                                                                    </span>
<span class="-8902171898794493922" onmouseenter="enter('-8902171898794493922');" onmouseout="out('-8902171898794493922');" style=""> 396              for(int i=0; i&lt;thenOperands.size(); i++){                                                             </span>
<span class="-3989978989358262134" onmouseenter="enter('-3989978989358262134');" onmouseout="out('-3989978989358262134');" style=""> 397                  SqlNode oneOperand = thenOperands.get(i);                                                         </span>
<span class="-7388458006763864502" onmouseenter="enter('-7388458006763864502');" onmouseout="out('-7388458006763864502');" style=""> 398                  replaceSelectFieldTable(oneOperand, oldTbName, newTbName, fieldReplaceRef);                       </span>
<span  style=""> 399                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400              }                                                                                                     </span>
<span  style=""> 401                                                                                                                    </span>
<span class="-7763620435664145090" onmouseenter="enter('-7763620435664145090');" onmouseout="out('-7763620435664145090');" style=""> 402              replaceSelectFieldTable(elseNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 403          }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 404              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 405              return;                                                                                               </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 406          }else{                                                                                                    </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 407              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 407              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409      }                                                                                                             </span>
<span  style=""> 410                                                                                                                    </span>
<span class="-8462314785940972235" onmouseenter="enter('-8462314785940972235');" onmouseout="out('-8462314785940972235');" style=""> 411      private static void replaceOneSelectField(SqlIdentifier sqlIdentifier,                                        </span>
<span class="4142772772881389417" onmouseenter="enter('4142772772881389417');" onmouseout="out('4142772772881389417');" style=""> 412                                                String newTbName,                                                   </span>
<span class="4628427663668360157" onmouseenter="enter('4628427663668360157');" onmouseout="out('4628427663668360157');" style=""> 413                                                String oldTbName,                                                   </span>
<span class="-123666790994587736" onmouseenter="enter('-123666790994587736');" onmouseout="out('-123666790994587736');" style=""> 414                                                HashBiMap&lt;String, String&gt; fieldReplaceRef){                         </span>
<span class="5409837540655806029" onmouseenter="enter('5409837540655806029');" onmouseout="out('5409837540655806029');" style=""> 415          SqlIdentifier newField = sqlIdentifier.setName(0, newTbName);                                             </span>
<span class="2742839839262283647" onmouseenter="enter('2742839839262283647');" onmouseout="out('2742839839262283647');" style=""> 416          String fieldName = sqlIdentifier.names.get(1);                                                            </span>
<span class="383429695235202001" onmouseenter="enter('383429695235202001');" onmouseout="out('383429695235202001');" style=""> 417          String fieldKey = oldTbName + &quot;_&quot; + fieldName;                                                            </span>
<span  style=""> 418                                                                                                                    </span>
<span class="-6721872198205274351" onmouseenter="enter('-6721872198205274351');" onmouseout="out('-6721872198205274351');" style=""> 419          if(!fieldReplaceRef.containsKey(fieldKey)){                                                               </span>
<span class="-8417061839432085011" onmouseenter="enter('-8417061839432085011');" onmouseout="out('-8417061839432085011');" style=""> 420              if(fieldReplaceRef.inverse().get(fieldName) != null){                                                 </span>
<span class="3563776056422158867" onmouseenter="enter('3563776056422158867');" onmouseout="out('3563776056422158867');" style=""> 421                  //换一个名字                                                                                           </span>
<span class="6269694230999482502" onmouseenter="enter('6269694230999482502');" onmouseout="out('6269694230999482502');" style=""> 422                  String mappingFieldName = ParseUtils.dealDuplicateFieldName(fieldReplaceRef, fieldName);          </span>
<span class="730243385989967976" onmouseenter="enter('730243385989967976');" onmouseout="out('730243385989967976');" style=""> 423                  newField = newField.setName(1, mappingFieldName);                                                 </span>
<span class="-8843946047709268866" onmouseenter="enter('-8843946047709268866');" onmouseout="out('-8843946047709268866');" style=""> 424                  fieldReplaceRef.put(fieldKey, mappingFieldName);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 425              } else {                                                                                              </span>
<span class="8037669429324652271" onmouseenter="enter('8037669429324652271');" onmouseout="out('8037669429324652271');" style=""> 426                  fieldReplaceRef.put(fieldKey, fieldName);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427              }                                                                                                     </span>
<span class="-6497049907687009769" onmouseenter="enter('-6497049907687009769');" onmouseout="out('-6497049907687009769');" style=""> 428          }else {                                                                                                   </span>
<span class="-8559329898165326450" onmouseenter="enter('-8559329898165326450');" onmouseout="out('-8559329898165326450');" style=""> 429              newField = newField.setName(1, fieldReplaceRef.get(fieldKey));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430          }                                                                                                         </span>
<span  style=""> 431                                                                                                                    </span>
<span class="-3197795073308056747" onmouseenter="enter('-3197795073308056747');" onmouseout="out('-3197795073308056747');" style=""> 432          sqlIdentifier.assignNamesFrom(newField);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433      }                                                                                                             </span>
<span  style=""> 434                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 435      /**                                                                                                           </span>
<span class="5461903081523405406" onmouseenter="enter('5461903081523405406');" onmouseout="out('5461903081523405406');" style=""> 436       * 替换另外join 表的指定表名为新关联处理的表名称                                                                                  </span>
<span class="-4160812560585701802" onmouseenter="enter('-4160812560585701802');" onmouseout="out('-4160812560585701802');" style=""> 437       * @param condition                                                                                           </span>
<span class="-653368829907055509" onmouseenter="enter('-653368829907055509');" onmouseout="out('-653368829907055509');" style=""> 438       * @param oldTabFieldRefNew                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 439       */                                                                                                           </span>
<span class="3319102281402941993" onmouseenter="enter('3319102281402941993');" onmouseout="out('3319102281402941993');" style=""> 440      public static void replaceJoinFieldRefTableName(SqlNode condition, Map&lt;String, String&gt; oldTabFieldRefNew){    </span>
<span class="5716706160133851170" onmouseenter="enter('5716706160133851170');" onmouseout="out('5716706160133851170');" style=""> 441          if (null == condition || condition.getKind() == LITERAL) {                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 442              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443          }                                                                                                         </span>
<span class="5418896256960850645" onmouseenter="enter('5418896256960850645');" onmouseout="out('5418896256960850645');" style=""> 444          SqlKind joinKind = condition.getKind();                                                                   </span>
<span class="-872109993356374898" onmouseenter="enter('-872109993356374898');" onmouseout="out('-872109993356374898');" style=""> 445          if( AGGREGATE.contains(joinKind)                                                                          </span>
<span class="6718918766222840749" onmouseenter="enter('6718918766222840749');" onmouseout="out('6718918766222840749');" style=""> 446                  || AVG_AGG_FUNCTIONS.contains(joinKind)                                                           </span>
<span class="-5795763144400386668" onmouseenter="enter('-5795763144400386668');" onmouseout="out('-5795763144400386668');" style=""> 447                  || COMPARISON.contains(joinKind)                                                                  </span>
<span class="-8649262116164241163" onmouseenter="enter('-8649262116164241163');" onmouseout="out('-8649262116164241163');" style=""> 448                  || joinKind == OTHER_FUNCTION                                                                     </span>
<span class="-5055598318919357044" onmouseenter="enter('-5055598318919357044');" onmouseout="out('-5055598318919357044');" style=""> 449                  || joinKind == DIVIDE                                                                             </span>
<span class="-5590854516630695190" onmouseenter="enter('-5590854516630695190');" onmouseout="out('-5590854516630695190');" style=""> 450                  || joinKind == CAST                                                                               </span>
<span class="-4942353295577364183" onmouseenter="enter('-4942353295577364183');" onmouseout="out('-4942353295577364183');" style=""> 451                  || joinKind == TRIM                                                                               </span>
<span class="3915078205687144262" onmouseenter="enter('3915078205687144262');" onmouseout="out('3915078205687144262');" style=""> 452                  || joinKind == TIMES                                                                              </span>
<span class="-1723358202983235773" onmouseenter="enter('-1723358202983235773');" onmouseout="out('-1723358202983235773');" style=""> 453                  || joinKind == PLUS                                                                               </span>
<span class="-5069307841224953084" onmouseenter="enter('-5069307841224953084');" onmouseout="out('-5069307841224953084');" style=""> 454                  || joinKind == NOT_IN                                                                             </span>
<span class="-2425336955836765254" onmouseenter="enter('-2425336955836765254');" onmouseout="out('-2425336955836765254');" style=""> 455                  || joinKind == OR                                                                                 </span>
<span class="4152669671898758851" onmouseenter="enter('4152669671898758851');" onmouseout="out('4152669671898758851');" style=""> 456                  || joinKind == AND                                                                                </span>
<span class="8469231591142723332" onmouseenter="enter('8469231591142723332');" onmouseout="out('8469231591142723332');" style=""> 457                  || joinKind == MINUS                                                                              </span>
<span class="-8975416296405207931" onmouseenter="enter('-8975416296405207931');" onmouseout="out('-8975416296405207931');" style=""> 458                  || joinKind == TUMBLE                                                                             </span>
<span class="-2000447344068332492" onmouseenter="enter('-2000447344068332492');" onmouseout="out('-2000447344068332492');" style=""> 459                  || joinKind == TUMBLE_START                                                                       </span>
<span class="-2660655228869248711" onmouseenter="enter('-2660655228869248711');" onmouseout="out('-2660655228869248711');" style=""> 460                  || joinKind == TUMBLE_END                                                                         </span>
<span class="611140839719638142" onmouseenter="enter('611140839719638142');" onmouseout="out('611140839719638142');" style=""> 461                  || joinKind == SESSION                                                                            </span>
<span class="-4719587108970880084" onmouseenter="enter('-4719587108970880084');" onmouseout="out('-4719587108970880084');" style=""> 462                  || joinKind == SESSION_START                                                                      </span>
<span class="-8416806901357633870" onmouseenter="enter('-8416806901357633870');" onmouseout="out('-8416806901357633870');" style=""> 463                  || joinKind == SESSION_END                                                                        </span>
<span class="1350987570876390511" onmouseenter="enter('1350987570876390511');" onmouseout="out('1350987570876390511');" style=""> 464                  || joinKind == HOP                                                                                </span>
<span class="-1881854797876652455" onmouseenter="enter('-1881854797876652455');" onmouseout="out('-1881854797876652455');" style=""> 465                  || joinKind == HOP_START                                                                          </span>
<span class="8861207018381483306" onmouseenter="enter('8861207018381483306');" onmouseout="out('8861207018381483306');" style=""> 466                  || joinKind == HOP_END                                                                            </span>
<span class="-8001520670756666177" onmouseenter="enter('-8001520670756666177');" onmouseout="out('-8001520670756666177');" style=""> 467                  || joinKind == BETWEEN                                                                            </span>
<span class="-8652641138853954718" onmouseenter="enter('-8652641138853954718');" onmouseout="out('-8652641138853954718');" style=""> 468                  || joinKind == IS_NULL                                                                            </span>
<span class="-3447385425080227914" onmouseenter="enter('-3447385425080227914');" onmouseout="out('-3447385425080227914');" style=""> 469                  || joinKind == IS_NOT_NULL                                                                        </span>
<span class="-7170411514740971639" onmouseenter="enter('-7170411514740971639');" onmouseout="out('-7170411514740971639');" style=""> 470                  || joinKind == CONTAINS                                                                           </span>
<span class="2023943706482563039" onmouseenter="enter('2023943706482563039');" onmouseout="out('2023943706482563039');" style=""> 471                  || joinKind == TIMESTAMP_ADD                                                                      </span>
<span class="-2326108897925880210" onmouseenter="enter('-2326108897925880210');" onmouseout="out('-2326108897925880210');" style=""> 472                  || joinKind == TIMESTAMP_DIFF                                                                     </span>
<span class="-853383041741207972" onmouseenter="enter('-853383041741207972');" onmouseout="out('-853383041741207972');" style=""> 473                  || joinKind == LIKE                                                                               </span>
<span class="6751598071686393893" onmouseenter="enter('6751598071686393893');" onmouseout="out('6751598071686393893');" style=""> 474                  || joinKind == COALESCE                                                                           </span>
<span class="-6635050181630823497" onmouseenter="enter('-6635050181630823497');" onmouseout="out('-6635050181630823497');" style=""> 475                  || joinKind == EQUALS ){                                                                          </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-2541170249719279546" onmouseenter="enter('-2541170249719279546');" onmouseout="out('-2541170249719279546');" style=""> 477              SqlBasicCall sqlBasicCall = (SqlBasicCall) condition;                                                 </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 478              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 479                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 480                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 481                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482                  }                                                                                                 </span>
<span  style=""> 483                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 484                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 485                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486                  }                                                                                                 </span>
<span  style=""> 487                                                                                                                    </span>
<span class="9093647197598049539" onmouseenter="enter('9093647197598049539');" onmouseout="out('9093647197598049539');" style=""> 488                  replaceJoinFieldRefTableName(sqlNode, oldTabFieldRefNew);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489              }                                                                                                     </span>
<span  style=""> 490                                                                                                                    </span>
<span class="-3321512503468929771" onmouseenter="enter('-3321512503468929771');" onmouseout="out('-3321512503468929771');" style=""> 491          } else if (condition.getKind() == IDENTIFIER) {                                                           </span>
<span class="3421902236901684905" onmouseenter="enter('3421902236901684905');" onmouseout="out('3421902236901684905');" style=""><abbr title=" 492              Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format table.field&quot;);"> 492              Preconditions.checkState(((SqlIdentifier)condition).names.size() == 2, &quot;join condition must be format 🔵</abbr></span>
<span class="5832438568991919450" onmouseenter="enter('5832438568991919450');" onmouseout="out('5832438568991919450');" style=""> 493              String fieldRefTable = ((SqlIdentifier)condition).names.get(0);                                       </span>
<span  style=""> 494                                                                                                                    </span>
<span class="8100744064870187141" onmouseenter="enter('8100744064870187141');" onmouseout="out('8100744064870187141');" style=""> 495              String targetFieldName = TableUtils.getTargetRefField(oldTabFieldRefNew, condition.toString());       </span>
<span  style=""> 496                                                                                                                    </span>
<span class="8753124522689816475" onmouseenter="enter('8753124522689816475');" onmouseout="out('8753124522689816475');" style=""> 497              if(StringUtils.isNotBlank(targetFieldName)){                                                          </span>
<span class="549628471692842965" onmouseenter="enter('549628471692842965');" onmouseout="out('549628471692842965');" style=""> 498                  String[] fieldSplits = StringUtils.split(targetFieldName, &quot;.&quot;);                                   </span>
<span class="-4590973079341848831" onmouseenter="enter('-4590973079341848831');" onmouseout="out('-4590973079341848831');" style=""> 499                  SqlIdentifier newField = ((SqlIdentifier)condition).setName(0, fieldSplits[0]);                   </span>
<span class="-2128195046647686450" onmouseenter="enter('-2128195046647686450');" onmouseout="out('-2128195046647686450');" style=""> 500                  newField = newField.setName(1, fieldSplits[1]);                                                   </span>
<span class="3184949241141894727" onmouseenter="enter('3184949241141894727');" onmouseout="out('3184949241141894727');" style=""> 501                  ((SqlIdentifier)condition).assignNamesFrom(newField);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504      }                                                                                                             </span>
<span  style=""> 505                                                                                                                    </span>
<span class="2909357842222016806" onmouseenter="enter('2909357842222016806');" onmouseout="out('2909357842222016806');" style=""> 506      public static String getTargetRefTable(Map&lt;String, String&gt; refTableMap, String tableName){                    </span>
<span class="8928515954503116985" onmouseenter="enter('8928515954503116985');" onmouseout="out('8928515954503116985');" style=""> 507          String targetTableName = null;                                                                            </span>
<span class="-7988911072327938473" onmouseenter="enter('-7988911072327938473');" onmouseout="out('-7988911072327938473');" style=""> 508          String preTableName;                                                                                      </span>
<span  style=""> 509                                                                                                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 510          do {                                                                                                      </span>
<span class="-8410406414279039842" onmouseenter="enter('-8410406414279039842');" onmouseout="out('-8410406414279039842');" style=""> 511              preTableName = targetTableName == null ? tableName : targetTableName;                                 </span>
<span class="-6937575046812844068" onmouseenter="enter('-6937575046812844068');" onmouseout="out('-6937575046812844068');" style=""> 512              targetTableName = refTableMap.get(preTableName);                                                      </span>
<span class="2145360151323546808" onmouseenter="enter('2145360151323546808');" onmouseout="out('2145360151323546808');" style=""> 513          } while (targetTableName != null);                                                                        </span>
<span  style=""> 514                                                                                                                    </span>
<span class="-2669935656864379097" onmouseenter="enter('-2669935656864379097');" onmouseout="out('-2669935656864379097');" style=""> 515          return preTableName;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516      }                                                                                                             </span>
<span  style=""> 517                                                                                                                    </span>
<span class="4252776571232827033" onmouseenter="enter('4252776571232827033');" onmouseout="out('4252776571232827033');" style=""> 518      public static String getTargetRefField(Map&lt;String, String&gt; refFieldMap, String currFieldName){                </span>
<span class="7313268804655149758" onmouseenter="enter('7313268804655149758');" onmouseout="out('7313268804655149758');" style=""> 519          String targetFieldName = null;                                                                            </span>
<span class="-8203442755027339079" onmouseenter="enter('-8203442755027339079');" onmouseout="out('-8203442755027339079');" style=""> 520          String preFieldName;                                                                                      </span>
<span  style=""> 521                                                                                                                    </span>
<span class="3052837437029247759" onmouseenter="enter('3052837437029247759');" onmouseout="out('3052837437029247759');" style=""> 522          do {                                                                                                      </span>
<span class="5385129689109669577" onmouseenter="enter('5385129689109669577');" onmouseout="out('5385129689109669577');" style=""> 523              preFieldName = targetFieldName == null ? currFieldName : targetFieldName;                             </span>
<span class="-3091793637238102945" onmouseenter="enter('-3091793637238102945');" onmouseout="out('-3091793637238102945');" style=""> 524              targetFieldName = refFieldMap.get(preFieldName);                                                      </span>
<span class="-8916552568071022335" onmouseenter="enter('-8916552568071022335');" onmouseout="out('-8916552568071022335');" style=""> 525          } while (targetFieldName != null);                                                                        </span>
<span  style=""> 526                                                                                                                    </span>
<span class="5199537743604417658" onmouseenter="enter('5199537743604417658');" onmouseout="out('5199537743604417658');" style=""> 527          return preFieldName;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528      }                                                                                                             </span>
<span  style=""> 529                                                                                                                    </span>
<span class="-8300425435366196840" onmouseenter="enter('-8300425435366196840');" onmouseout="out('-8300425435366196840');" style=""><abbr title=" 530      public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef){"> 530      public static void replaceWhereCondition(SqlNode parentWhere, String oldTbName, String newTbName, HashBiMap&lt;St🔵</abbr></span>
<span  style=""> 531                                                                                                                    </span>
<span class="-7344361739038630250" onmouseenter="enter('-7344361739038630250');" onmouseout="out('-7344361739038630250');" style=""> 532          if(parentWhere == null){                                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 533              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534          }                                                                                                         </span>
<span  style=""> 535                                                                                                                    </span>
<span class="7198030462908925381" onmouseenter="enter('7198030462908925381');" onmouseout="out('7198030462908925381');" style=""> 536          SqlKind kind = parentWhere.getKind();                                                                     </span>
<span class="-1872623569752802183" onmouseenter="enter('-1872623569752802183');" onmouseout="out('-1872623569752802183');" style=""> 537          if(kind == AND){                                                                                          </span>
<span class="2829943023301943879" onmouseenter="enter('2829943023301943879');" onmouseout="out('2829943023301943879');" style=""><abbr title=" 538              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplaceRef);"> 538              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[0], oldTbName, newTbName, fieldReplac🔵</abbr></span>
<span class="-4556945615844132104" onmouseenter="enter('-4556945615844132104');" onmouseout="out('-4556945615844132104');" style=""><abbr title=" 539              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplaceRef);"> 539              replaceWhereCondition(((SqlBasicCall) parentWhere).getOperands()[1], oldTbName, newTbName, fieldReplac🔵</abbr></span>
<span  style=""> 540                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 541          } else {                                                                                                  </span>
<span class="8766459294285823468" onmouseenter="enter('8766459294285823468');" onmouseout="out('8766459294285823468');" style=""> 542              replaceConditionNode(parentWhere, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544      }                                                                                                             </span>
<span  style=""> 545                                                                                                                    </span>
<span class="7802005378818510825" onmouseenter="enter('7802005378818510825');" onmouseout="out('7802005378818510825');" style=""><abbr title=" 546      private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;String, String&gt; fieldReplaceRef) {"> 546      private static void replaceConditionNode(SqlNode selectNode, String oldTbName, String newTbName, HashBiMap&lt;Str🔵</abbr></span>
<span class="8405601494998756480" onmouseenter="enter('8405601494998756480');" onmouseout="out('8405601494998756480');" style=""> 547          if(selectNode.getKind() == IDENTIFIER){                                                                   </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 548              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 549                                                                                                                    </span>
<span class="2651178788475624428" onmouseenter="enter('2651178788475624428');" onmouseout="out('2651178788475624428');" style=""> 550              if(sqlIdentifier.names.size() == 1){                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 551                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552              }                                                                                                     </span>
<span  style=""> 553                                                                                                                    </span>
<span class="318397782816978051" onmouseenter="enter('318397782816978051');" onmouseout="out('318397782816978051');" style=""> 554              String tableName = sqlIdentifier.names.asList().get(0);                                               </span>
<span class="5268132787378326987" onmouseenter="enter('5268132787378326987');" onmouseout="out('5268132787378326987');" style=""> 555              String tableField = sqlIdentifier.names.asList().get(1);                                              </span>
<span class="-2565165445763658517" onmouseenter="enter('-2565165445763658517');" onmouseout="out('-2565165445763658517');" style=""> 556              String fieldKey = tableName + &quot;_&quot; + tableField;                                                       </span>
<span  style=""> 557                                                                                                                    </span>
<span class="-3841275234863465094" onmouseenter="enter('-3841275234863465094');" onmouseout="out('-3841275234863465094');" style=""> 558              if(tableName.equalsIgnoreCase(oldTbName)){                                                            </span>
<span  style=""> 559                                                                                                                    </span>
<span class="-7486276484118623043" onmouseenter="enter('-7486276484118623043');" onmouseout="out('-7486276484118623043');" style=""><abbr title=" 560                  String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fieldKey);"> 560                  String newFieldName = fieldReplaceRef.get(fieldKey) == null ? tableField : fieldReplaceRef.get(fie🔵</abbr></span>
<span class="-85150012511262136" onmouseenter="enter('-85150012511262136');" onmouseout="out('-85150012511262136');" style=""> 561                  SqlIdentifier newField = ((SqlIdentifier)selectNode).setName(0, newTbName);                       </span>
<span class="-3325104965504513825" onmouseenter="enter('-3325104965504513825');" onmouseout="out('-3325104965504513825');" style=""> 562                  newField = newField.setName(1, newFieldName);                                                     </span>
<span class="-7494318194999571350" onmouseenter="enter('-7494318194999571350');" onmouseout="out('-7494318194999571350');" style=""> 563                  ((SqlIdentifier)selectNode).assignNamesFrom(newField);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 564              }                                                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 565              return;                                                                                               </span>
<span class="7580774735460232339" onmouseenter="enter('7580774735460232339');" onmouseout="out('7580774735460232339');" style=""> 566          }else if(selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN){//字面含义                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 567              return;                                                                                               </span>
<span class="7025405726449532045" onmouseenter="enter('7025405726449532045');" onmouseout="out('7025405726449532045');" style=""> 568          }else if(  AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 569                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 570                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 571                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 572                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 573                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 574                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 575                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 576                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 577                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 578                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 579                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 580                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 581                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 582                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 583                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 584                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 585                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 586                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 587                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 588                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 589                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 590                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 591                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 592                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 593                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 594                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 595                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 596                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 597                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 598                                                                                                                    </span>
<span class="1769062068492699725" onmouseenter="enter('1769062068492699725');" onmouseout="out('1769062068492699725');" style=""> 599          ){                                                                                                        </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 600              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6221234471722277998" onmouseenter="enter('-6221234471722277998');" onmouseout="out('-6221234471722277998');" style=""> 601              for(int i=0; i&lt;sqlBasicCall.getOperands().length; i++){                                               </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 602                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="92437031510630357" onmouseenter="enter('92437031510630357');" onmouseout="out('92437031510630357');" style=""> 603                  if(sqlNode instanceof SqlLiteral){                                                                </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 604                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 605                  }                                                                                                 </span>
<span  style=""> 606                                                                                                                    </span>
<span class="-7655129146813432779" onmouseenter="enter('-7655129146813432779');" onmouseout="out('-7655129146813432779');" style=""> 607                  if(sqlNode instanceof SqlDataTypeSpec){                                                           </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 608                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 609                  }                                                                                                 </span>
<span  style=""> 610                                                                                                                    </span>
<span class="-2258996485445817623" onmouseenter="enter('-2258996485445817623');" onmouseout="out('-2258996485445817623');" style=""> 611                  replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 612              }                                                                                                     </span>
<span  style=""> 613                                                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 614              return;                                                                                               </span>
<span class="-6373545674230253671" onmouseenter="enter('-6373545674230253671');" onmouseout="out('-6373545674230253671');" style=""> 615          }else if(selectNode.getKind() == OTHER){                                                                  </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 616              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 617              return;                                                                                               </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 618          } else if (selectNode.getKind() == CASE) {                                                                </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 619              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span  style=""> 620                                                                                                                    </span>
<span class="-2315512384759132147" onmouseenter="enter('-2315512384759132147');" onmouseout="out('-2315512384759132147');" style=""><abbr title=" 621              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 621              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbN🔵</abbr></span>
<span class="-1345654988953747553" onmouseenter="enter('-1345654988953747553');" onmouseout="out('-1345654988953747553');" style=""><abbr title=" 622              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbName, fieldReplaceRef));"> 622              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; replaceConditionNode(sqlNode, oldTbName, newTbN🔵</abbr></span>
<span class="-7836146409865535589" onmouseenter="enter('-7836146409865535589');" onmouseout="out('-7836146409865535589');" style=""> 623              replaceConditionNode(sqlCase.getElseOperand(), oldTbName, newTbName, fieldReplaceRef);                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 624          } else {                                                                                                  </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 625              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 625              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 626          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 627      }                                                                                                             </span>
<span  style=""> 628                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 629      /**                                                                                                           </span>
<span class="1570055177673011707" onmouseenter="enter('1570055177673011707');" onmouseout="out('1570055177673011707');" style=""> 630       * 获取条件中关联的表信息                                                                                                </span>
<span class="-4454220617475556005" onmouseenter="enter('-4454220617475556005');" onmouseout="out('-4454220617475556005');" style=""> 631       * @param selectNode                                                                                          </span>
<span class="-4813798938110383556" onmouseenter="enter('-4813798938110383556');" onmouseout="out('-4813798938110383556');" style=""> 632       * @param fieldInfos                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 633       */                                                                                                           </span>
<span class="7137057397975985823" onmouseenter="enter('7137057397975985823');" onmouseout="out('7137057397975985823');" style=""> 634      public static void getConditionRefTable(SqlNode selectNode, Set&lt;String&gt; fieldInfos) {                         </span>
<span class="-3454817955506608063" onmouseenter="enter('-3454817955506608063');" onmouseout="out('-3454817955506608063');" style=""> 635          if (selectNode.getKind() == IDENTIFIER) {                                                                 </span>
<span class="-3732912994311321816" onmouseenter="enter('-3732912994311321816');" onmouseout="out('-3732912994311321816');" style=""> 636              SqlIdentifier sqlIdentifier = (SqlIdentifier) selectNode;                                             </span>
<span  style=""> 637                                                                                                                    </span>
<span class="380773342968557196" onmouseenter="enter('380773342968557196');" onmouseout="out('380773342968557196');" style=""> 638              fieldInfos.add(sqlIdentifier.toString());                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 639              return;                                                                                               </span>
<span class="6757358046968148413" onmouseenter="enter('6757358046968148413');" onmouseout="out('6757358046968148413');" style=""> 640          } else if (selectNode.getKind() == LITERAL || selectNode.getKind() == LITERAL_CHAIN) {//字面含义              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 641              return;                                                                                               </span>
<span class="-4023999264561783968" onmouseenter="enter('-4023999264561783968');" onmouseout="out('-4023999264561783968');" style=""> 642          } else if (AGGREGATE.contains(selectNode.getKind())                                                       </span>
<span class="-6933542481251357306" onmouseenter="enter('-6933542481251357306');" onmouseout="out('-6933542481251357306');" style=""> 643                  || AVG_AGG_FUNCTIONS.contains(selectNode.getKind())                                               </span>
<span class="-2120439329066417772" onmouseenter="enter('-2120439329066417772');" onmouseout="out('-2120439329066417772');" style=""> 644                  || COMPARISON.contains(selectNode.getKind())                                                      </span>
<span class="6729191807379931332" onmouseenter="enter('6729191807379931332');" onmouseout="out('6729191807379931332');" style=""> 645                  || selectNode.getKind() == OTHER_FUNCTION                                                         </span>
<span class="-790540336783787818" onmouseenter="enter('-790540336783787818');" onmouseout="out('-790540336783787818');" style=""> 646                  || selectNode.getKind() == DIVIDE                                                                 </span>
<span class="8042439450870069301" onmouseenter="enter('8042439450870069301');" onmouseout="out('8042439450870069301');" style=""> 647                  || selectNode.getKind() == CAST                                                                   </span>
<span class="8131430949670321542" onmouseenter="enter('8131430949670321542');" onmouseout="out('8131430949670321542');" style=""> 648                  || selectNode.getKind() == TRIM                                                                   </span>
<span class="7539044465271514325" onmouseenter="enter('7539044465271514325');" onmouseout="out('7539044465271514325');" style=""> 649                  || selectNode.getKind() == TIMES                                                                  </span>
<span class="5017875227939513377" onmouseenter="enter('5017875227939513377');" onmouseout="out('5017875227939513377');" style=""> 650                  || selectNode.getKind() == PLUS                                                                   </span>
<span class="-8896687143784188803" onmouseenter="enter('-8896687143784188803');" onmouseout="out('-8896687143784188803');" style=""> 651                  || selectNode.getKind() == NOT_IN                                                                 </span>
<span class="-1863732027976694038" onmouseenter="enter('-1863732027976694038');" onmouseout="out('-1863732027976694038');" style=""> 652                  || selectNode.getKind() == OR                                                                     </span>
<span class="6505261652610820896" onmouseenter="enter('6505261652610820896');" onmouseout="out('6505261652610820896');" style=""> 653                  || selectNode.getKind() == AND                                                                    </span>
<span class="8098904506676885196" onmouseenter="enter('8098904506676885196');" onmouseout="out('8098904506676885196');" style=""> 654                  || selectNode.getKind() == MINUS                                                                  </span>
<span class="-157153081163608557" onmouseenter="enter('-157153081163608557');" onmouseout="out('-157153081163608557');" style=""> 655                  || selectNode.getKind() == TUMBLE                                                                 </span>
<span class="-2839638964097736537" onmouseenter="enter('-2839638964097736537');" onmouseout="out('-2839638964097736537');" style=""> 656                  || selectNode.getKind() == TUMBLE_START                                                           </span>
<span class="6482577849437391011" onmouseenter="enter('6482577849437391011');" onmouseout="out('6482577849437391011');" style=""> 657                  || selectNode.getKind() == TUMBLE_END                                                             </span>
<span class="6880276476651207951" onmouseenter="enter('6880276476651207951');" onmouseout="out('6880276476651207951');" style=""> 658                  || selectNode.getKind() == SESSION                                                                </span>
<span class="-5893490809135961202" onmouseenter="enter('-5893490809135961202');" onmouseout="out('-5893490809135961202');" style=""> 659                  || selectNode.getKind() == SESSION_START                                                          </span>
<span class="-1646114820326763405" onmouseenter="enter('-1646114820326763405');" onmouseout="out('-1646114820326763405');" style=""> 660                  || selectNode.getKind() == SESSION_END                                                            </span>
<span class="268793040563115559" onmouseenter="enter('268793040563115559');" onmouseout="out('268793040563115559');" style=""> 661                  || selectNode.getKind() == HOP                                                                    </span>
<span class="5104117061177388693" onmouseenter="enter('5104117061177388693');" onmouseout="out('5104117061177388693');" style=""> 662                  || selectNode.getKind() == HOP_START                                                              </span>
<span class="8235260830665848207" onmouseenter="enter('8235260830665848207');" onmouseout="out('8235260830665848207');" style=""> 663                  || selectNode.getKind() == HOP_END                                                                </span>
<span class="-3943236427179035086" onmouseenter="enter('-3943236427179035086');" onmouseout="out('-3943236427179035086');" style=""> 664                  || selectNode.getKind() == BETWEEN                                                                </span>
<span class="-4981553052649867721" onmouseenter="enter('-4981553052649867721');" onmouseout="out('-4981553052649867721');" style=""> 665                  || selectNode.getKind() == IS_NULL                                                                </span>
<span class="2062318608323297657" onmouseenter="enter('2062318608323297657');" onmouseout="out('2062318608323297657');" style=""> 666                  || selectNode.getKind() == IS_NOT_NULL                                                            </span>
<span class="-5717204280699012051" onmouseenter="enter('-5717204280699012051');" onmouseout="out('-5717204280699012051');" style=""> 667                  || selectNode.getKind() == CONTAINS                                                               </span>
<span class="-4225388998654687854" onmouseenter="enter('-4225388998654687854');" onmouseout="out('-4225388998654687854');" style=""> 668                  || selectNode.getKind() == TIMESTAMP_ADD                                                          </span>
<span class="-1992782825152874013" onmouseenter="enter('-1992782825152874013');" onmouseout="out('-1992782825152874013');" style=""> 669                  || selectNode.getKind() == TIMESTAMP_DIFF                                                         </span>
<span class="-1380076266281630813" onmouseenter="enter('-1380076266281630813');" onmouseout="out('-1380076266281630813');" style=""> 670                  || selectNode.getKind() == LIKE                                                                   </span>
<span class="-8902830991280997210" onmouseenter="enter('-8902830991280997210');" onmouseout="out('-8902830991280997210');" style=""> 671                  || selectNode.getKind() == COALESCE                                                               </span>
<span  style=""> 672                                                                                                                    </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 673                  ) {                                                                                               </span>
<span class="7946305415555164516" onmouseenter="enter('7946305415555164516');" onmouseout="out('7946305415555164516');" style=""> 674              SqlBasicCall sqlBasicCall = (SqlBasicCall) selectNode;                                                </span>
<span class="-6461841638065859246" onmouseenter="enter('-6461841638065859246');" onmouseout="out('-6461841638065859246');" style=""> 675              for (int i = 0; i &lt; sqlBasicCall.getOperands().length; i++) {                                         </span>
<span class="-6831609595517394087" onmouseenter="enter('-6831609595517394087');" onmouseout="out('-6831609595517394087');" style=""> 676                  SqlNode sqlNode = sqlBasicCall.getOperands()[i];                                                  </span>
<span class="-4657964142739574978" onmouseenter="enter('-4657964142739574978');" onmouseout="out('-4657964142739574978');" style=""> 677                  if (sqlNode instanceof SqlLiteral) {                                                              </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 678                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 679                  }                                                                                                 </span>
<span  style=""> 680                                                                                                                    </span>
<span class="-4675155589595463501" onmouseenter="enter('-4675155589595463501');" onmouseout="out('-4675155589595463501');" style=""> 681                  if (sqlNode instanceof SqlDataTypeSpec) {                                                         </span>
<span class="-6362435147834875541" onmouseenter="enter('-6362435147834875541');" onmouseout="out('-6362435147834875541');" style=""> 682                      continue;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 683                  }                                                                                                 </span>
<span  style=""> 684                                                                                                                    </span>
<span class="56198544928191592" onmouseenter="enter('56198544928191592');" onmouseout="out('56198544928191592');" style=""> 685                  getConditionRefTable(sqlNode, fieldInfos);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686              }                                                                                                     </span>
<span  style=""> 687                                                                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 688              return;                                                                                               </span>
<span class="-2308646561142794789" onmouseenter="enter('-2308646561142794789');" onmouseout="out('-2308646561142794789');" style=""> 689          } else if (selectNode.getKind() == OTHER) {                                                               </span>
<span class="-5542086300788940380" onmouseenter="enter('-5542086300788940380');" onmouseout="out('-5542086300788940380');" style=""> 690              //不处理                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 691              return;                                                                                               </span>
<span class="6753725982943564752" onmouseenter="enter('6753725982943564752');" onmouseout="out('6753725982943564752');" style=""> 692          } else if (selectNode.getKind() == CASE) {                                                                </span>
<span class="-1390336112814264886" onmouseenter="enter('-1390336112814264886');" onmouseout="out('-1390336112814264886');" style=""> 693              SqlCase sqlCase = (SqlCase) selectNode;                                                               </span>
<span  style=""> 694                                                                                                                    </span>
<span class="-3537580079884591293" onmouseenter="enter('-3537580079884591293');" onmouseout="out('-3537580079884591293');" style=""> 695              sqlCase.getWhenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));    </span>
<span class="2144257116225237462" onmouseenter="enter('2144257116225237462');" onmouseout="out('2144257116225237462');" style=""> 696              sqlCase.getThenOperands().getList().forEach(sqlNode -&gt; getConditionRefTable(sqlNode, fieldInfos));    </span>
<span class="-5604248574568658683" onmouseenter="enter('-5604248574568658683');" onmouseout="out('-5604248574568658683');" style=""> 697              getConditionRefTable(sqlCase.getElseOperand(), fieldInfos);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 698          } else {                                                                                                  </span>
<span class="1153766920564476840" onmouseenter="enter('1153766920564476840');" onmouseout="out('1153766920564476840');" style=""><abbr title=" 699              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNode.getKind()));"> 699              throw new RuntimeException(String.format(&quot;not support node kind of %s to replace name now.&quot;, selectNod🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 700          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 701      }                                                                                                             </span>
<span  style=""> 702                                                                                                                    </span>
<span class="7209362215393805086" onmouseenter="enter('7209362215393805086');" onmouseout="out('7209362215393805086');" style=""> 703      public static String buildTableField(String tableName, String fieldName){                                     </span>
<span class="628676990396543483" onmouseenter="enter('628676990396543483');" onmouseout="out('628676990396543483');" style=""> 704          return String.format(&quot;%s.%s&quot;, tableName, fieldName);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 705      }                                                                                                             </span>
<span  style=""> 706                                                                                                                    </span>
<span  style=""> 707                                                                                                                    </span>
<span class="669857325066588067" onmouseenter="enter('669857325066588067');" onmouseout="out('669857325066588067');" style=""> 708      public static String buildTableNameWithScope(String tableName, String scope){                                 </span>
<span class="-3861937570797236044" onmouseenter="enter('-3861937570797236044');" onmouseout="out('-3861937570797236044');" style=""> 709          if(StringUtils.isEmpty(scope)){                                                                           </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 710              return tableName;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 711          }                                                                                                         </span>
<span  style=""> 712                                                                                                                    </span>
<span class="-4742733753210118542" onmouseenter="enter('-4742733753210118542');" onmouseout="out('-4742733753210118542');" style=""> 713          return tableName + &quot;_&quot; + scope;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 714      }                                                                                                             </span>
<span  style=""> 715                                                                                                                    </span>
<span class="290962191185636260" onmouseenter="enter('290962191185636260');" onmouseout="out('290962191185636260');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 716 +    public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String rightTableName, String scope, Set&lt;String&gt; existTableNames){"> 716 +    public static String buildTableNameWithScope(String leftTableName, String leftTableAlias, String rightTableNam🔵</abbr></span>
<span class="2401839376205144968" onmouseenter="enter('2401839376205144968');" onmouseout="out('2401839376205144968');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 717 +        //兼容左边表是as 的情况                                                                                            </span>
<span class="2644250892879979113" onmouseenter="enter('2644250892879979113');" onmouseout="out('2644250892879979113');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 718 +        String leftStr = Strings.isNullOrEmpty(leftTableName) ? leftTableAlias : leftTableName;                   </span>
<span class="4940999328154746374" onmouseenter="enter('4940999328154746374');" onmouseout="out('4940999328154746374');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 719 +        String newName = leftStr + &quot;_&quot; + rightTableName;                                                          </span>
<span class="-8657233487191077119" onmouseenter="enter('-8657233487191077119');" onmouseout="out('-8657233487191077119');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 720 +        if (CollectionUtils.isEmpty(existTableNames)) {                                                           </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 721 +            return TableUtils.buildTableNameWithScope(newName, scope);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 722 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 723 +                                                                                                                  </span>
<span class="-234751792023525655" onmouseenter="enter('-234751792023525655');" onmouseout="out('-234751792023525655');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 724 +        if (!existTableNames.contains(newName)) {                                                                 </span>
<span class="-6123391172774631708" onmouseenter="enter('-6123391172774631708');" onmouseout="out('-6123391172774631708');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 725 +            return TableUtils.buildTableNameWithScope(newName, scope);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 726 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 727 +                                                                                                                  </span>
<span class="6366820324978801292" onmouseenter="enter('6366820324978801292');" onmouseout="out('6366820324978801292');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 728 +        return TableUtils.buildTableNameWithScope(newName, scope) + &quot;_&quot; + System.currentTimeMillis();             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 729 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 730 +                                                                                                                  </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 731  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            