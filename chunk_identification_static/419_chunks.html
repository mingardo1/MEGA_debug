<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>419 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\t\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page, \n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page,\n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page,\n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\t\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t * \n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\t\t\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page, \n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page,\n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;package cn.crap.controller.front;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import cn.crap.adapter.ArticleAdapter;\n&#x27;
                           &#x27;import cn.crap.beans.Config;\n&#x27;
                           &#x27;import cn.crap.dto.*;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleStatus;\n&#x27;
                           &#x27;import cn.crap.enumer.ArticleType;\n&#x27;
                           &#x27;import cn.crap.enumer.MyError;\n&#x27;
                           &#x27;import cn.crap.enumer.ProjectStatus;\n&#x27;
                           &#x27;import cn.crap.framework.JsonResult;\n&#x27;
                           &#x27;import cn.crap.framework.ThreadContext;\n&#x27;
                           &#x27;import cn.crap.framework.base.BaseController;\n&#x27;
                           &#x27;import cn.crap.model.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.ISearchService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomArticleService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomHotSearchService;\n&#x27;
                           &#x27;import cn.crap.service.custom.CustomMenuService;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;cn.crap.service.custom.CustomProjectService;\n&#x27;
                           &#x27;import cn.crap.service.mybatis.*;\n&#x27;
                           &#x27;import cn.crap.service.tool.LuceneSearchService;\n&#x27;
                           &#x27;import cn.crap.utils.*;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.beans.factory.annotation.Autowired;\n&#x27;
                           &#x27;import org.springframework.stereotype.Controller;\n&#x27;
                           &#x27;import org.springframework.ui.ModelMap;\n&#x27;
                           &#x27;import org.springframework.util.CollectionUtils;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestMapping;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.RequestParam;\n&#x27;
                           &#x27;import &#x27;
                           &#x27;org.springframework.web.bind.annotation.ResponseBody;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;import javax.mail.MessagingException;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletRequest;\n&#x27;
                           &#x27;import javax.servlet.http.HttpServletResponse;\n&#x27;
                           &#x27;import java.io.UnsupportedEncodingException;\n&#x27;
                           &#x27;import java.util.Date;\n&#x27;
                           &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;@Controller(&quot;fontMainController&quot;)\n&#x27;
                           &#x27;public class MainController extends &#x27;
                           &#x27;BaseController{\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate ISearchService luceneService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate CustomMenuService customMenuService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate HotSearchService hotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomHotSearchService &#x27;
                           &#x27;customHotSearchService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private UserService userService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ArticleService articleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private ProjectService projectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private InterfaceService interfaceService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomProjectService &#x27;
                           &#x27;customProjectService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;    private CustomArticleService &#x27;
                           &#x27;customArticleService;\n&#x27;
                           &#x27;\t@Autowired\n&#x27;
                           &#x27;\tprivate Config config;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\tprivate static final String TOTAL_USER = &#x27;
                           &#x27;&quot;totalUser&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_PROJECT = &#x27;
                           &#x27;&quot;totalProject&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_INTERFACE = &#x27;
                           &#x27;&quot;totalInterface&quot;;\n&#x27;
                           &#x27;    private static final String TOTAL_ARTICLE = &#x27;
                           &#x27;&quot;totalArticle&quot;;\n&#x27;
                           &#x27;    private static final String PROJECT_LIST = &#x27;
                           &#x27;&quot;projectList&quot;;\n&#x27;
                           &#x27;    private static final String ARTICLE_LIST = &#x27;
                           &#x27;&quot;articleList&quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;    /**\n&#x27;
                           &#x27;\t * &#x27;
                           &#x27;默认页面，重定向web.do，不直接进入web.do是因为进入默认地址，浏览器中的href不会改变， &#x27;
                           &#x27;会导致用户第一点击闪屏\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/home.do&quot;)\n&#x27;
                           &#x27;\tpublic void home(HttpServletResponse response) &#x27;
                           &#x27;throws Exception {\n&#x27;
                           &#x27;\t\tSettingDto indexUrl = &#x27;
                           &#x27;settingCache.get(S_INDEX_PAGE);\n&#x27;
                           &#x27;\t\tif (indexUrl != null &amp;&amp; &#x27;
                           &#x27;!MyString.isEmpty(indexUrl.getValue())){\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(indexUrl.getValue());\n&#x27;
                           &#x27;\t\t}else{\n&#x27;
                           &#x27;\t\t\tresponse.sendRedirect(&quot;index.do&quot;);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端主页面\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping({&quot;/index.do&quot;,&quot;/web.do&quot;})\n&#x27;
                           &#x27;\tpublic String index() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/indexNew.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(value = &quot;dashboard.htm&quot;)\n&#x27;
                           &#x27;\tpublic String dashboard(ModelMap modelMap) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tLoginInfoDto loginInfoDto = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\t\tmodelMap.addAttribute(&quot;login&quot;, loginInfoDto != &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;title&quot;, &#x27;
                           &#x27;settingCache.get(S_TITLE).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;keywords&quot;, &#x27;
                           &#x27;settingCache.get(S_KEYWORDS).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;description&quot;, &#x27;
                           &#x27;settingCache.get(S_DESCRIPTION).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;icon&quot;, &#x27;
                           &#x27;settingCache.get(S_ICON).getValue());\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;logo&quot;, &#x27;
                           &#x27;settingCache.get(S_LOGO).getValue());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        String totalUser = &#x27;
                           &#x27;stringCache.get(TOTAL_USER);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalUser)){\n&#x27;
                           &#x27;            totalUser = &#x27;
                           &#x27;userService.countByExample(new UserCriteria()) + &#x27;
                           &#x27;&quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_USER, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalProject = &#x27;
                           &#x27;stringCache.get(TOTAL_PROJECT);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalProject)){\n&#x27;
                           &#x27;            totalProject = &#x27;
                           &#x27;projectService.countByExample(new &#x27;
                           &#x27;ProjectCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_PROJECT, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalInterface = &#x27;
                           &#x27;stringCache.get(TOTAL_INTERFACE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalInterface)){\n&#x27;
                           &#x27;            totalInterface = &#x27;
                           &#x27;interfaceService.countByExample(new &#x27;
                           &#x27;InterfaceCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_INTERFACE, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        String totalArticle = &#x27;
                           &#x27;stringCache.get(TOTAL_ARTICLE);\n&#x27;
                           &#x27;        if (MyString.isEmpty(totalArticle)){\n&#x27;
                           &#x27;            totalArticle = &#x27;
                           &#x27;articleService.countByExample(new &#x27;
                           &#x27;ArticleCriteria()) + &quot;&quot;;\n&#x27;
                           &#x27;            stringCache.add(TOTAL_ARTICLE, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalUser&quot;, &#x27;
                           &#x27;totalUser);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalProject&quot;, &#x27;
                           &#x27;totalProject);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalInterface&quot;, &#x27;
                           &#x27;totalInterface);\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;totalArticle&quot;, &#x27;
                           &#x27;totalArticle);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;Project&gt; projectList =(List&lt;Project&gt;) &#x27;
                           &#x27;objectCache.get(PROJECT_LIST);\n&#x27;
                           &#x27;        Page page = new Page(12, 1);\n&#x27;
                           &#x27;        if (CollectionUtils.isEmpty(projectList)) &#x27;
                           &#x27;{\n&#x27;
                           &#x27;            projectList = &#x27;
                           &#x27;customProjectService.pageProjectByStatusName(ProjectStatus.RECOMMEND.getStatus(), &#x27;
                           &#x27;null, page);\n&#x27;
                           &#x27;            objectCache.add(PROJECT_LIST, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;projectList&quot;, &#x27;
                           &#x27;projectList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        page = new Page(5, 1);\n&#x27;
                           &#x27;        List&lt;ArticleDto&gt; articleList = &#x27;
                           &#x27;(List&lt;ArticleDto&gt;) objectCache.get(ARTICLE_LIST);\n&#x27;
                           &#x27;        if &#x27;
                           &#x27;(CollectionUtils.isEmpty(articleList)){\n&#x27;
                           &#x27;            articleList = &#x27;
                           &#x27;ArticleAdapter.getDto(customArticleService.queryArticle(null, &#x27;
                           &#x27;null, ArticleType.ARTICLE.name(),\n&#x27;
                           &#x27;                    null, &#x27;
                           &#x27;ArticleStatus.RECOMMEND.getStatus(), page), &#x27;
                           &#x27;null);\n&#x27;
                           &#x27;            objectCache.add(ARTICLE_LIST, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;articleList&quot;, &#x27;
                           &#x27;articleList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        // 从缓存中获取菜单\n&#x27;
                           &#x27;        List&lt;MenuWithSubMenuDto&gt; menuList = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;        if(menuList == null){\n&#x27;
                           &#x27;            menuList = &#x27;
                           &#x27;customMenuService.getLeftMenu();\n&#x27;
                           &#x27;            objectCache.add(C_CACHE_LEFT_MENU, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;        modelMap.addAttribute(&quot;menuList&quot;, &#x27;
                           &#x27;menuList);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        return &quot;WEB-INF/views/dashboard.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 公共\n&#x27;
                           &#x27;\t * @param result\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws UnsupportedEncodingException\n&#x27;
                           &#x27;\t * @throws MessagingException\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/result.do&quot;)\n&#x27;
                           &#x27;\tpublic String validateEmail(String result) &#x27;
                           &#x27;throws UnsupportedEncodingException, &#x27;
                           &#x27;MessagingException {\n&#x27;
                           &#x27;\t\tThreadContext.request().setAttribute(&quot;result&quot;, &#x27;
                           &#x27;result);\n&#x27;
                           &#x27;\t\treturn &quot;WEB-INF/views/result.jsp&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 前端项目主页\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t * @return\n&#x27;
                           &#x27;\t * @throws Exception\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/project.do&quot;)\n&#x27;
                           &#x27;\tpublic String project() throws Exception {\n&#x27;
                           &#x27;\t\treturn &#x27;
                           &#x27;&quot;resources/html/frontHtml/projectIndex.html&quot;;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/searchList.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic void searchList(HttpServletResponse &#x27;
                           &#x27;response) throws Exception {\n&#x27;
                           &#x27;\t\t// 只显示前10个\n&#x27;
                           &#x27;\t\tStringBuilder sb = new StringBuilder(&quot;&lt;div &#x27;
                           &#x27;class=\&#x27;tl\&#x27;&gt;&quot;);\n&#x27;
                           &#x27;\t\tList&lt;String&gt; searchWords = &#x27;
                           &#x27;customHotSearchService.queryTop10();\n&#x27;
                           &#x27;\t\tif(searchWords != null){\n&#x27;
                           &#x27;\t\t\tint i = 0;\n&#x27;
                           &#x27;\t\t\tString itemClass = &quot;&quot;;\n&#x27;
                           &#x27;\t\t\tfor(String searchWord: searchWords){\n&#x27;
                           &#x27;\t\t\t\ti = i+1;\n&#x27;
                           &#x27;\t\t\t\tif(i &gt; 10) break;\n&#x27;
                           &#x27;\t\t\t\tif(i == 1) itemClass = &quot; text-danger &quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 2) itemClass = &quot; text-info &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse if(i == 3) itemClass = &quot; text-warning &#x27;
                           &#x27;&quot;;\n&#x27;
                           &#x27;\t\t\t\telse itemClass = &quot; C555 &quot;;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t\t\tString showText = searchWord.substring(0, &#x27;
                           &#x27;searchWord.length()&gt;20?20:searchWord.length());\n&#x27;
                           &#x27;\t\t\t\tif(searchWord.length()&gt;20){\n&#x27;
                           &#x27;\t\t\t\t\tshowText = showText + &quot;...&quot;;\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\tsearchWord = &#x27;
                           &#x27;LuceneSearchService.handleHref(searchWord);\n&#x27;
                           &#x27;\t\t\t\tsb.append( &quot;&lt;a &#x27;
                           &#x27;onclick=\\&quot;iClose(\&#x27;lookUp\&#x27;);\\&quot; class=\&#x27;p3 pl10 &#x27;
                           &#x27;dis &quot;+ itemClass +&quot;\&#x27; &#x27;
                           &#x27;href=\&#x27;#/frontSearch/&quot;+searchWord+&quot;\&#x27;&gt;&quot;+showText+&quot;&lt;/a&gt;&quot;);\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsb.append(&quot;&lt;/div&gt;&quot;);\n&#x27;
                           &#x27;\t\tprintMsg(sb.toString());\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t/**\n&#x27;
                           &#x27;\t * 初始化前端页面\n&#x27;
                           &#x27;\t *\n&#x27;
                           &#x27;\t */\n&#x27;
                           &#x27;\t@SuppressWarnings(&quot;unchecked&quot;)\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/front/init.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult frontInit(HttpServletRequest &#x27;
                           &#x27;request) throws Exception {\n&#x27;
                           &#x27;\t\tMap&lt;String, String&gt; settingMap = new &#x27;
                           &#x27;HashMap&lt;String, String&gt;();\n&#x27;
                           &#x27;\t\tfor (SettingDto setting : &#x27;
                           &#x27;settingCache.getAll()) {\n&#x27;
                           &#x27;\t\t\tif(S_SECRETKEY.equals(setting.getKey())){\n&#x27;
                           &#x27;\t\t\t\tcontinue;\n&#x27;
                           &#x27;\t\t\t}\n&#x27;
                           &#x27;\t\t\tsettingMap.put(setting.getKey(), &#x27;
                           &#x27;setting.getValue());\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.DOMAIN, &#x27;
                           &#x27;config.getDomain());\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_OPEN_REGISTER, &#x27;
                           &#x27;config.isOpenRegister()+&quot;&quot;);\n&#x27;
                           &#x27;\t\tsettingMap.put(IConst.SETTING_GITHUB_ID, &#x27;
                           &#x27;MyString.isEmpty( config.getClientID() )? &#x27;
                           &#x27;&quot;false&quot;:&quot;true&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;settingMap&quot;, settingMap);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 从缓存中获取菜单\n&#x27;
                           &#x27;\t\tList&lt;MenuWithSubMenuDto&gt; menus = &#x27;
                           &#x27;(List&lt;MenuWithSubMenuDto&gt;)objectCache.get(C_CACHE_LEFT_MENU);\n&#x27;
                           &#x27;\t\tif(menus == null){\n&#x27;
                           &#x27;\t\t\tmenus = customMenuService.getLeftMenu();\n&#x27;
                           &#x27;\t\t\tobjectCache.add(C_CACHE_LEFT_MENU, menus);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;menuList&quot;, menus);\n&#x27;
                           &#x27;\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.tryGetUser();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;sessionAdminName&quot;, user == &#x27;
                           &#x27;null? &quot;&quot;: user.getUserName());\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap);\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t@RequestMapping(&quot;/frontSearch.do&quot;)\n&#x27;
                           &#x27;\t@ResponseBody\n&#x27;
                           &#x27;\tpublic JsonResult &#x27;
                           &#x27;frontSearch(@RequestParam(defaultValue=&quot;&quot;) String &#x27;
                           &#x27;keyword, Integer currentPage) throws Exception{\n&#x27;
                           &#x27;\t\tif(config.isLuceneSearchNeedLogin()){\n&#x27;
                           &#x27;\t\t\tLoginInfoDto user = &#x27;
                           &#x27;LoginUserHelper.getUser(MyError.E000043);\n&#x27;
                           &#x27;\t\t}\n&#x27;
                           &#x27;\t\tkeyword = keyword.trim();\n&#x27;
                           &#x27;        if (keyword.length() &gt; 200){\n&#x27;
                           &#x27;            keyword = keyword.substring(0, 200);\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\tPage page= new Page(currentPage);\n&#x27;
                           &#x27;\t\tList&lt;SearchDto&gt; searchResults = &#x27;
                           &#x27;luceneService.search(keyword, page);\n&#x27;
                           &#x27;\t\tMap&lt;String,Object&gt; returnMap = new &#x27;
                           &#x27;HashMap&lt;String,Object&gt;();\n&#x27;
                           &#x27;\t\treturnMap.put(&quot;searchResults&quot;, &#x27;
                           &#x27;searchResults);\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\t// 将搜索的内容记入数据库\n&#x27;
                           &#x27;\t\tif(MyString.isNotEmpty(keyword)){\n&#x27;
                           &#x27;            HotSearch hotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;            if (hotSearch == null){\n&#x27;
                           &#x27;                hotSearch = new HotSearch();\n&#x27;
                           &#x27;                hotSearch.setCreateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setUpdateTime(new &#x27;
                           &#x27;Date());\n&#x27;
                           &#x27;                hotSearch.setTimes(1);\n&#x27;
                           &#x27;                hotSearch.setKeyword(keyword);\n&#x27;
                           &#x27;                try {\n&#x27;
                           &#x27;\t\t\t\t\thotSearchService.insert(hotSearch);\n&#x27;
                           &#x27;\t\t\t\t}catch (Exception e){\n&#x27;
                           &#x27;\t\t\t\t\thotSearch = &#x27;
                           &#x27;customHotSearchService.tryGetByKeyWord(keyword);\n&#x27;
                           &#x27;                \tif (hotSearch == null){\n&#x27;
                           &#x27;                \t\te.printStackTrace();\n&#x27;
                           &#x27;\t\t\t\t\t}\n&#x27;
                           &#x27;\t\t\t\t}\n&#x27;
                           &#x27;            }else{\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearch.setTimes(hotSearch.getTimes() + 1);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;hotSearchService.update(hotSearch);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;\t\treturn new JsonResult(1, returnMap, page,\n&#x27;
                           &#x27;\t\t\t\tTools.getMap(&quot;crumbs&quot;, &#x27;
                           &#x27;Tools.getCrumbs(&quot;搜索关键词:&quot;+keyword,&quot;void&quot;)));\n&#x27;
                           &#x27;\t}\n&#x27;
                           &#x27;}\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        