<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>325 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.net.URL;\n&#x27;
                         &#x27;import java.util.Base64;\n&#x27;
                         &#x27;import java.util.zip.ZipEntry;\n&#x27;
                         &#x27;import java.util.zip.ZipInputStream;\n&#x27;
                         &#x27;import java.util.zip.ZipOutputStream;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;            \n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                         &#x27;            Field field = &#x27;
                         &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                         &#x27;            System.out.println(&quot;Setting &quot; + &#x27;
                         &#x27;field.getName() + &quot; value to True, current value is &#x27;
                         &#x27;&quot; + &#x27;
                         &#x27;Constants.FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS + &#x27;
                         &#x27;&quot;\\n&quot;);\n&#x27;
                         &#x27;            setFinalStatic(field, Boolean.TRUE);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                           &#x27;              Field field = &#x27;
                           &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                           &#x27;              System.out.println(&quot;Setting &quot; + &#x27;
                           &#x27;field.getName() + &quot; value to True&quot;);\n&#x27;
                           &#x27;              setFinalStatic(field, &#x27;
                           &#x27;Boolean.TRUE);\n&#x27;
                           &#x27;            } catch (NoSuchFieldException e) { // &#x27;
                           &#x27;Fall back to older versions. Try to make JNDI non &#x27;
                           &#x27;instantiable\n&#x27;
                           &#x27;                System.err.println(&quot;No field &#x27;
                           &#x27;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS - version &#x27;
                           &#x27;&lt;= 2.9.0&quot;);\n&#x27;
                           &#x27;                System.err.println(&quot;Will attempt &#x27;
                           &#x27;to modify the configuration directly&quot;);\n&#x27;
                           &#x27;            }\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            Class&lt;?&gt; aClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            Method reconfigure = &#x27;
                         &#x27;aClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;            reconfigure.invoke(null);\n&#x27;
                         &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;            try {\n&#x27;
                           &#x27;                Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;                reconfigure.invoke(null);\n&#x27;
                           &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        Class&lt;?&gt; c = null;\n&#x27;
                         &#x27;        try {\n&#x27;
                         &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                         &#x27;            Field field = &#x27;
                         &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                         &#x27;            System.out.println(&quot;Setting &quot; + &#x27;
                         &#x27;field.getName() + &quot; value to True, current value is &#x27;
                         &#x27;&quot; + &#x27;
                         &#x27;Constants.FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS + &#x27;
                         &#x27;&quot;\\n&quot;);\n&#x27;
                         &#x27;            setFinalStatic(field, Boolean.TRUE);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            //reconfiguring log4j\n&#x27;
                         &#x27;            ClassLoader classLoader = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader();\n&#x27;
                         &#x27;            Class&lt;?&gt; aClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            Method reconfigure = &#x27;
                         &#x27;aClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;            reconfigure.invoke(null);\n&#x27;
                         &#x27;        } catch (Throwable e) {\n&#x27;
                         &#x27;            System.err.println(&quot;Exception &quot; + e);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        // modify the log4j jar to fix the vuln\n&#x27;
                         &#x27;        if(c != null)\n&#x27;
                         &#x27;            &#x27;
                         &#x27;fullyVaccinate(c.getProtectionDomain().getCodeSource().getLocation());\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        try {\n&#x27;
                           &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                           &#x27;              Field field = &#x27;
                           &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                           &#x27;              System.out.println(&quot;Setting &quot; + &#x27;
                           &#x27;field.getName() + &quot; value to True&quot;);\n&#x27;
                           &#x27;              setFinalStatic(field, &#x27;
                           &#x27;Boolean.TRUE);\n&#x27;
                           &#x27;            } catch (NoSuchFieldException e) { // &#x27;
                           &#x27;Fall back to older versions. Try to make JNDI non &#x27;
                           &#x27;instantiable\n&#x27;
                           &#x27;                System.err.println(&quot;No field &#x27;
                           &#x27;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS - version &#x27;
                           &#x27;&lt;= 2.9.0&quot;);\n&#x27;
                           &#x27;                System.err.println(&quot;Will attempt &#x27;
                           &#x27;to modify the configuration directly&quot;);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            //reconfiguring log4j\n&#x27;
                           &#x27;            ClassLoader classLoader = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader();\n&#x27;
                           &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;            try {\n&#x27;
                           &#x27;                Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;                reconfigure.invoke(null);\n&#x27;
                           &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;
                           &#x27;            System.err.println(&quot;Exception &quot; + e);\n&#x27;
                           &#x27;            e.printStackTrace();\n&#x27;
                           &#x27;        }\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.net.URL;\n&#x27;
                         &#x27;import java.util.Base64;\n&#x27;
                         &#x27;import java.util.zip.ZipEntry;\n&#x27;
                         &#x27;import java.util.zip.ZipInputStream;\n&#x27;
                         &#x27;import java.util.zip.ZipOutputStream;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.util.HashMap;\n&#x27;
                           &#x27;import java.util.Map;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;            \n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                         &#x27;            Field field = &#x27;
                         &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                         &#x27;            System.out.println(&quot;Setting &quot; + &#x27;
                         &#x27;field.getName() + &quot; value to True, current value is &#x27;
                         &#x27;&quot; + &#x27;
                         &#x27;Constants.FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS + &#x27;
                         &#x27;&quot;\\n&quot;);\n&#x27;
                         &#x27;            setFinalStatic(field, Boolean.TRUE);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                           &#x27;              Field field = &#x27;
                           &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                           &#x27;              System.out.println(&quot;Setting &quot; + &#x27;
                           &#x27;field.getName() + &quot; value to True&quot;);\n&#x27;
                           &#x27;              setFinalStatic(field, &#x27;
                           &#x27;Boolean.TRUE);\n&#x27;
                           &#x27;            } catch (NoSuchFieldException e) { // &#x27;
                           &#x27;Fall back to older versions. Try to make JNDI non &#x27;
                           &#x27;instantiable\n&#x27;
                           &#x27;                System.err.println(&quot;No field &#x27;
                           &#x27;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS - version &#x27;
                           &#x27;&lt;= 2.9.0&quot;);\n&#x27;
                           &#x27;                System.err.println(&quot;Will attempt &#x27;
                           &#x27;to modify the configuration directly&quot;);\n&#x27;
                           &#x27;            }\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        Class&lt;?&gt; c = null;\n&#x27;
                         &#x27;        try {\n&#x27;
                         &#x27;            System.out.println(&quot;Patching&quot;);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            c = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                         &#x27;            Field field = &#x27;
                         &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                         &#x27;            System.out.println(&quot;Setting &quot; + &#x27;
                         &#x27;field.getName() + &quot; value to True, current value is &#x27;
                         &#x27;&quot; + &#x27;
                         &#x27;Constants.FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS + &#x27;
                         &#x27;&quot;\\n&quot;);\n&#x27;
                         &#x27;            setFinalStatic(field, Boolean.TRUE);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            //reconfiguring log4j\n&#x27;
                         &#x27;            ClassLoader classLoader = &#x27;
                         &#x27;Thread.currentThread().getContextClassLoader();\n&#x27;
                         &#x27;            Class&lt;?&gt; aClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            Method reconfigure = &#x27;
                         &#x27;aClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;            reconfigure.invoke(null);\n&#x27;
                         &#x27;        } catch (Throwable e) {\n&#x27;
                         &#x27;            System.err.println(&quot;Exception &quot; + e);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        // modify the log4j jar to fix the vuln\n&#x27;
                         &#x27;        if(c != null)\n&#x27;
                         &#x27;            &#x27;
                         &#x27;fullyVaccinate(c.getProtectionDomain().getCodeSource().getLocation());\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        try {\n&#x27;
                           &#x27;            try { // Try for versions of Log4j &gt;= &#x27;
                           &#x27;2.10\n&#x27;
                           &#x27;              Class&lt;?&gt; c = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader().loadClass(&quot;org.apache.logging.log4j.core.util.Constants&quot;);\n&#x27;
                           &#x27;              Field field = &#x27;
                           &#x27;c.getField(&quot;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS&quot;);\n&#x27;
                           &#x27;              System.out.println(&quot;Setting &quot; + &#x27;
                           &#x27;field.getName() + &quot; value to True&quot;);\n&#x27;
                           &#x27;              setFinalStatic(field, &#x27;
                           &#x27;Boolean.TRUE);\n&#x27;
                           &#x27;            } catch (NoSuchFieldException e) { // &#x27;
                           &#x27;Fall back to older versions. Try to make JNDI non &#x27;
                           &#x27;instantiable\n&#x27;
                           &#x27;                System.err.println(&quot;No field &#x27;
                           &#x27;FORMAT_MESSAGES_PATTERN_DISABLE_LOOKUPS - version &#x27;
                           &#x27;&lt;= 2.9.0&quot;);\n&#x27;
                           &#x27;                System.err.println(&quot;Will attempt &#x27;
                           &#x27;to modify the configuration directly&quot;);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            //reconfiguring log4j\n&#x27;
                           &#x27;            ClassLoader classLoader = &#x27;
                           &#x27;Thread.currentThread().getContextClassLoader();\n&#x27;
                           &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;            try {\n&#x27;
                           &#x27;                Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;                reconfigure.invoke(null);\n&#x27;
                           &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;
                           &#x27;            System.err.println(&quot;Exception &quot; + e);\n&#x27;
                           &#x27;            e.printStackTrace();\n&#x27;
                           &#x27;        }\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;spork&#x27;, &#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            Class&lt;?&gt; aClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            Method reconfigure = &#x27;
                         &#x27;aClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;            reconfigure.invoke(null);\n&#x27;
                         &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;            try {\n&#x27;
                           &#x27;                Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;                reconfigure.invoke(null);\n&#x27;
                           &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            } catch (Exception ex) {\n&#x27;
                           &#x27;                Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;                &#x27;
                           &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;                Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;                Class&lt;?&gt; log4jContextFactoryClass &#x27;
                           &#x27;= &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;                Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;                Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;                ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;                for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                    ctx.reconfigure();\n&#x27;
                           &#x27;                    &#x27;
                           &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                           &#x27;                    Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                    StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                    if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                        System.err.println(&quot;Lookup &#x27;
                           &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                           &#x27;                        Field lookups = null;\n&#x27;
                           &#x27;                        try {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                        } catch &#x27;
                           &#x27;(NoSuchFieldException e) {\n&#x27;
                           &#x27;                            lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;                        }\n&#x27;
                           &#x27;                        &#x27;
                           &#x27;lookups.setAccessible(true);\n&#x27;
                           &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                           &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                           &#x27;lookups.get(resolver);\n&#x27;
                           &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                           &#x27;                    }\n&#x27;
                           &#x27;                }\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        