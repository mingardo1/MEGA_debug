<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>492</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    492
                    <a href="491.html">prev</a>
                    <a href="493.html">next</a>
                    <a href="492_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    FormidableLabs/react-native-app-auth_005327a797029bc62c06a4d761bcf20fa4f864a2_android/src/main/java/com/rnappauth/RNAppAuthModule.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\FormidableLabs\react-native-app-auth show &quot;005327a797029bc62c06a4d761bcf20fa4f864a2:android/src/main/java/com/rnappauth/RNAppAuthModule.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\FormidableLabs\react-native-app-auth show &quot;005327a797029bc62c06a4d761bcf20fa4f864a2^1:android/src/main/java/com/rnappauth/RNAppAuthModule.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\FormidableLabs\react-native-app-auth show &quot;005327a797029bc62c06a4d761bcf20fa4f864a2^2:android/src/main/java/com/rnappauth/RNAppAuthModule.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\FormidableLabs\react-native-app-auth show &quot;24336ae82f203788292926da71f4f8a2b879c606:android/src/main/java/com/rnappauth/RNAppAuthModule.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj], [bj], [b], [j]], subset: [[bj], [bj], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-6280296900167357794" onmouseenter="enter('-6280296900167357794');" onmouseout="out('-6280296900167357794');" style="">   1 package com.rnappauth;                                                                                   </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="2265467446931963889" onmouseenter="enter('2265467446931963889');" onmouseout="out('2265467446931963889');" style="">   4 import android.app.PendingIntent;                                                                        </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">   5 import android.content.ComponentName;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   6 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   7 import android.content.Intent;                                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   8 import android.net.Uri;                                                                                  </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   9 import android.os.Bundle;                                                                                </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10 import androidx.annotation.Nullable;                                                                     </span>
<span class="-4621922491292668474" onmouseenter="enter('-4621922491292668474');" onmouseout="out('-4621922491292668474');" style="">  11 import androidx.browser.customtabs.CustomTabsCallback;                                                   </span>
<span class="5786009149739133921" onmouseenter="enter('5786009149739133921');" onmouseout="out('5786009149739133921');" style="">  12 import androidx.browser.customtabs.CustomTabsClient;                                                     </span>
<span class="6730446154443378273" onmouseenter="enter('6730446154443378273');" onmouseout="out('6730446154443378273');" style="">  13 import androidx.browser.customtabs.CustomTabsServiceConnection;                                          </span>
<span  style="">  14                                                                                                          </span>
<span class="7327608205307094785" onmouseenter="enter('7327608205307094785');" onmouseout="out('7327608205307094785');" style="">  15 import com.facebook.react.bridge.ActivityEventListener;                                                  </span>
<span class="1744055796152404290" onmouseenter="enter('1744055796152404290');" onmouseout="out('1744055796152404290');" style="">  16 import com.facebook.react.bridge.ReactApplicationContext;                                                </span>
<span class="7756046764634890677" onmouseenter="enter('7756046764634890677');" onmouseout="out('7756046764634890677');" style="">  17 import com.facebook.react.bridge.ReactContextBaseJavaModule;                                             </span>
<span class="-7062843866366665780" onmouseenter="enter('-7062843866366665780');" onmouseout="out('-7062843866366665780');" style="">  18 import com.facebook.react.bridge.ReactMethod;                                                            </span>
<span class="-9114944870765420144" onmouseenter="enter('-9114944870765420144');" onmouseout="out('-9114944870765420144');" style="">  19 import com.facebook.react.bridge.Promise;                                                                </span>
<span class="3666939786570277423" onmouseenter="enter('3666939786570277423');" onmouseout="out('3666939786570277423');" style="">  20 import com.facebook.react.bridge.ReadableArray;                                                          </span>
<span class="5552486474970006352" onmouseenter="enter('5552486474970006352');" onmouseout="out('5552486474970006352');" style="">  21 import com.facebook.react.bridge.ReadableMap;                                                            </span>
<span class="-2689054124168074705" onmouseenter="enter('-2689054124168074705');" onmouseout="out('-2689054124168074705');" style="">  22 import com.facebook.react.bridge.WritableMap;                                                            </span>
<span class="7507448895670758430" onmouseenter="enter('7507448895670758430');" onmouseout="out('7507448895670758430');" style="">  23 import com.facebook.react.bridge.ReadableType;                                                           </span>
<span  style="">  24                                                                                                          </span>
<span class="2824452556317040091" onmouseenter="enter('2824452556317040091');" onmouseout="out('2824452556317040091');" style="">  25 import com.rnappauth.utils.MapUtil;                                                                      </span>
<span class="2320112657500195094" onmouseenter="enter('2320112657500195094');" onmouseout="out('2320112657500195094');" style="">  26 import com.rnappauth.utils.UnsafeConnectionBuilder;                                                      </span>
<span class="5385195114029684108" onmouseenter="enter('5385195114029684108');" onmouseout="out('5385195114029684108');" style="">  27 import com.rnappauth.utils.TokenResponseFactory;                                                         </span>
<span class="-7309342380344421476" onmouseenter="enter('-7309342380344421476');" onmouseout="out('-7309342380344421476');" style="">  28 import com.rnappauth.utils.CustomConnectionBuilder;                                                      </span>
<span  style="">  29                                                                                                          </span>
<span class="2084880808431135122" onmouseenter="enter('2084880808431135122');" onmouseout="out('2084880808431135122');" style="">  30 import net.openid.appauth.AppAuthConfiguration;                                                          </span>
<span class="-6153791587225110013" onmouseenter="enter('-6153791587225110013');" onmouseout="out('-6153791587225110013');" style="">  31 import net.openid.appauth.AuthorizationException;                                                        </span>
<span class="220855730882953420" onmouseenter="enter('220855730882953420');" onmouseout="out('220855730882953420');" style="">  32 import net.openid.appauth.AuthorizationRequest;                                                          </span>
<span class="3507212550601358175" onmouseenter="enter('3507212550601358175');" onmouseout="out('3507212550601358175');" style="">  33 import net.openid.appauth.AuthorizationResponse;                                                         </span>
<span class="6486087234581123017" onmouseenter="enter('6486087234581123017');" onmouseout="out('6486087234581123017');" style="">  34 import net.openid.appauth.AuthorizationService;                                                          </span>
<span class="-1918380963859750931" onmouseenter="enter('-1918380963859750931');" onmouseout="out('-1918380963859750931');" style="">  35 import net.openid.appauth.AuthorizationServiceConfiguration;                                             </span>
<span class="-1745886087889911862" onmouseenter="enter('-1745886087889911862');" onmouseout="out('-1745886087889911862');" style="">  36 import net.openid.appauth.ClientAuthentication;                                                          </span>
<span class="5802881313983385714" onmouseenter="enter('5802881313983385714');" onmouseout="out('5802881313983385714');" style="">  37 import net.openid.appauth.ClientSecretBasic;                                                             </span>
<span class="6044047429679939107" onmouseenter="enter('6044047429679939107');" onmouseout="out('6044047429679939107');" style="">  38 import net.openid.appauth.ClientSecretPost;                                                              </span>
<span class="-7057741429751790751" onmouseenter="enter('-7057741429751790751');" onmouseout="out('-7057741429751790751');" style="">  39 import net.openid.appauth.ResponseTypeValues;                                                            </span>
<span class="7041795251639894294" onmouseenter="enter('7041795251639894294');" onmouseout="out('7041795251639894294');" style="">  40 import net.openid.appauth.TokenResponse;                                                                 </span>
<span class="4423191746780431402" onmouseenter="enter('4423191746780431402');" onmouseout="out('4423191746780431402');" style="">  41 import net.openid.appauth.TokenRequest;                                                                  </span>
<span class="-5344047661436712974" onmouseenter="enter('-5344047661436712974');" onmouseout="out('-5344047661436712974');" style="">  42 import net.openid.appauth.connectivity.ConnectionBuilder;                                                </span>
<span class="2682978576506672064" onmouseenter="enter('2682978576506672064');" onmouseout="out('2682978576506672064');" style="">  43 import net.openid.appauth.connectivity.DefaultConnectionBuilder;                                         </span>
<span  style="">  44                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  45 import java.util.Collections;                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  46 import java.util.HashMap;                                                                                </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  47 import java.util.Map;                                                                                    </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  48 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="6937050046386248317" onmouseenter="enter('6937050046386248317');" onmouseout="out('6937050046386248317');" style="">  49 import java.util.concurrent.CountDownLatch;                                                              </span>
<span  style="">  50                                                                                                          </span>
<span class="6575769426762835403" onmouseenter="enter('6575769426762835403');" onmouseout="out('6575769426762835403');" style="">  51 public class RNAppAuthModule extends ReactContextBaseJavaModule implements ActivityEventListener {       </span>
<span  style="">  52                                                                                                          </span>
<span class="8401162781518473365" onmouseenter="enter('8401162781518473365');" onmouseout="out('8401162781518473365');" style="">  53     public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;                           </span>
<span  style="">  54                                                                                                          </span>
<span class="6180419538961108965" onmouseenter="enter('6180419538961108965');" onmouseout="out('6180419538961108965');" style="">  55     private final ReactApplicationContext reactContext;                                                  </span>
<span class="1869321332520936904" onmouseenter="enter('1869321332520936904');" onmouseout="out('1869321332520936904');" style="">  56     private Promise promise;                                                                             </span>
<span class="504355591559206068" onmouseenter="enter('504355591559206068');" onmouseout="out('504355591559206068');" style="">  57     private Boolean dangerouslyAllowInsecureHttpRequests;                                                </span>
<span class="6877933566748299598" onmouseenter="enter('6877933566748299598');" onmouseout="out('6877933566748299598');" style="">  58     private String clientAuthMethod = &quot;basic&quot;;                                                           </span>
<span class="5073960437150900627" onmouseenter="enter('5073960437150900627');" onmouseout="out('5073960437150900627');" style="">  59     private Map&lt;String, String&gt; authorizationRequestHeaders = null;                                      </span>
<span class="493655431939084947" onmouseenter="enter('493655431939084947');" onmouseout="out('493655431939084947');" style="">  60     private Map&lt;String, String&gt; tokenRequestHeaders = null;                                              </span>
<span class="4071237130655105462" onmouseenter="enter('4071237130655105462');" onmouseout="out('4071237130655105462');" style="">  61     private Map&lt;String, String&gt; additionalParametersMap;                                                 </span>
<span class="266383520389269247" onmouseenter="enter('266383520389269247');" onmouseout="out('266383520389269247');" style="">  62     private String clientSecret;                                                                         </span>
<span class="-2587280928065129913" onmouseenter="enter('-2587280928065129913');" onmouseout="out('-2587280928065129913');" style=""><abbr title="  63     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;();">  63     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicRe🔵</abbr></span>
<span class="-7004558742358285463" onmouseenter="enter('-7004558742358285463');" onmouseout="out('-7004558742358285463');" style="">  64     private boolean isPrefetched = false;                                                                </span>
<span  style="">  65                                                                                                          </span>
<span class="-978447563967948693" onmouseenter="enter('-978447563967948693');" onmouseout="out('-978447563967948693');" style="">  66     public RNAppAuthModule(ReactApplicationContext reactContext) {                                       </span>
<span class="-1443603959286428543" onmouseenter="enter('-1443603959286428543');" onmouseout="out('-1443603959286428543');" style="">  67         super(reactContext);                                                                             </span>
<span class="3003228313870805798" onmouseenter="enter('3003228313870805798');" onmouseout="out('3003228313870805798');" style="">  68         this.reactContext = reactContext;                                                                </span>
<span class="6669990586656871028" onmouseenter="enter('6669990586656871028');" onmouseout="out('6669990586656871028');" style="">  69         reactContext.addActivityEventListener(this);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style="">  72     @ReactMethod                                                                                         </span>
<span class="-5002037316527958427" onmouseenter="enter('-5002037316527958427');" onmouseout="out('-5002037316527958427');" style="">  73     public void prefetchConfiguration(                                                                   </span>
<span class="-8094929847941500576" onmouseenter="enter('-8094929847941500576');" onmouseout="out('-8094929847941500576');" style="">  74         final Boolean warmAndPrefetchChrome,                                                             </span>
<span class="-1461695631126767390" onmouseenter="enter('-1461695631126767390');" onmouseout="out('-1461695631126767390');" style="">  75         final String issuer,                                                                             </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style="">  76         final String redirectUrl,                                                                        </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style="">  77         final String clientId,                                                                           </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style="">  78         final ReadableArray scopes,                                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style="">  79         final ReadableMap serviceConfiguration,                                                          </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style="">  80         final Boolean dangerouslyAllowInsecureHttpRequests,                                              </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style="">  81         final ReadableMap headers,                                                                       </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style="">  82         final Promise promise                                                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style="">  83     ) {                                                                                                  </span>
<span class="-7526945842846133690" onmouseenter="enter('-7526945842846133690');" onmouseout="out('-7526945842846133690');" style="">  84         if (warmAndPrefetchChrome) {                                                                     </span>
<span class="8703515971997686923" onmouseenter="enter('8703515971997686923');" onmouseout="out('8703515971997686923');" style="">  85             warmChromeCustomTab(reactContext, issuer);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86         }                                                                                                </span>
<span  style="">  87                                                                                                          </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style="">  88         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title="  89         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);">  89         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="8517032726698162354" onmouseenter="enter('8517032726698162354');" onmouseout="out('8517032726698162354');" style="">  90         final CountDownLatch fetchConfigurationLatch = new CountDownLatch(1);                            </span>
<span  style="">  91                                                                                                          </span>
<span class="-7471939844701867604" onmouseenter="enter('-7471939844701867604');" onmouseout="out('-7471939844701867604');" style="">  92         if(!isPrefetched) {                                                                              </span>
<span class="-8580903789630998000" onmouseenter="enter('-8580903789630998000');" onmouseout="out('-8580903789630998000');" style="">  93             if (serviceConfiguration != null &amp;&amp; mServiceConfiguration.get() == null) {                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  94                 try {                                                                                    </span>
<span class="-5277191699256196698" onmouseenter="enter('-5277191699256196698');" onmouseout="out('-5277191699256196698');" style=""><abbr title="  95                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguration));">  95                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguratio🔵</abbr></span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style="">  96                     isPrefetched = true;                                                                 </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style="">  97                     fetchConfigurationLatch.countDown();                                                 </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="">  98                 } catch (Exception e) {                                                                  </span>
<span class="6809300863683709814" onmouseenter="enter('6809300863683709814');" onmouseout="out('6809300863683709814');" style="">  99                     promise.reject(&quot;configuration_error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100                 }                                                                                        </span>
<span class="7986155546390017313" onmouseenter="enter('7986155546390017313');" onmouseout="out('7986155546390017313');" style=""> 101             } else if (mServiceConfiguration.get() == null) {                                            </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 102                 final Uri issuerUri = Uri.parse(issuer);                                                 </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 103                 AuthorizationServiceConfiguration.fetchFromUrl(                                          </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 104                         buildConfigurationUriFromIssuer(issuerUri),                                      </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 105                         new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {          </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 106                             public void onFetchConfigurationCompleted(                                   </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 107                                     @Nullable AuthorizationServiceConfiguration fetchedConfiguration,    </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 108                                     @Nullable AuthorizationException ex) {                               </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 109                                 if (ex != null) {                                                        </span>
<span class="6863513032854295921" onmouseenter="enter('6863513032854295921');" onmouseout="out('6863513032854295921');" style=""><abbr title=" 110                                     promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configuration&quot;, ex);"> 110                                     promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch 🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 111                                     return;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112                                 }                                                                        </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 113                                 mServiceConfiguration.set(fetchedConfiguration);                         </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style=""> 114                                 isPrefetched = true;                                                     </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 115                                 fetchConfigurationLatch.countDown();                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116                             }                                                                            </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 117                         },                                                                               </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 118                         builder                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 119                 );                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 121         } else {                                                                                         </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 122             fetchConfigurationLatch.countDown();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span  style=""> 124                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 125         try {                                                                                            </span>
<span class="-1907621811022997860" onmouseenter="enter('-1907621811022997860');" onmouseout="out('-1907621811022997860');" style=""> 126             fetchConfigurationLatch.await();                                                             </span>
<span class="1954864242125272611" onmouseenter="enter('1954864242125272611');" onmouseout="out('1954864242125272611');" style=""> 127             promise.resolve(isPrefetched);                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 128         } catch (Exception e) {                                                                          </span>
<span class="1768900707370095440" onmouseenter="enter('1768900707370095440');" onmouseout="out('1768900707370095440');" style=""><abbr title=" 129             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e);"> 129             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 133     @ReactMethod                                                                                         </span>
<span class="7303195633629033586" onmouseenter="enter('7303195633629033586');" onmouseout="out('7303195633629033586');" style=""> 134     public void authorize(                                                                               </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 135             String issuer,                                                                               </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 136             final String redirectUrl,                                                                    </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 137             final String clientId,                                                                       </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 138             final String clientSecret,                                                                   </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 139             final ReadableArray scopes,                                                                  </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 140             final ReadableMap additionalParameters,                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 141             final ReadableMap serviceConfiguration,                                                      </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 142             final Boolean usePKCE,                                                                       </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 143             final String clientAuthMethod,                                                               </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 144             final Boolean dangerouslyAllowInsecureHttpRequests,                                          </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 145             final ReadableMap headers,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 146             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 147     ) {                                                                                                  </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 148         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title=" 149         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);"> 149         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="3019383581923708916" onmouseenter="enter('3019383581923708916');" onmouseout="out('3019383581923708916');" style=""> 150         final AppAuthConfiguration appAuthConfiguration = this.createAppAuthConfiguration(builder);      </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 151         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 151         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span  style=""> 152                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 153         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 154             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155         }                                                                                                </span>
<span  style=""> 156                                                                                                          </span>
<span class="5192680332872896216" onmouseenter="enter('5192680332872896216');" onmouseout="out('5192680332872896216');" style=""> 157         // store args in private fields for later use in onActivityResult handler                        </span>
<span class="-4922073825750036997" onmouseenter="enter('-4922073825750036997');" onmouseout="out('-4922073825750036997');" style=""> 158         this.promise = promise;                                                                          </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 159         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 160         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span class="-8734683050201249921" onmouseenter="enter('-8734683050201249921');" onmouseout="out('-8734683050201249921');" style=""> 161         this.clientSecret = clientSecret;                                                                </span>
<span class="3270519662544404418" onmouseenter="enter('3270519662544404418');" onmouseout="out('3270519662544404418');" style=""> 162         this.clientAuthMethod = clientAuthMethod;                                                        </span>
<span  style=""> 163                                                                                                          </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 164         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 164         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 165         if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 166             try {                                                                                        </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 167                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 167                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != nu🔵</abbr></span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 168                 authorizeWithConfiguration(                                                              </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 169                         serviceConfig,                                                                   </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 170                         appAuthConfiguration,                                                            </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 171                         clientId,                                                                        </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 172                         scopes,                                                                          </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 173                         redirectUrl,                                                                     </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 174                         usePKCE,                                                                         </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 175                         additionalParametersMap                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 176                 );                                                                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 177             } catch (Exception e) {                                                                      </span>
<span class="-3857326443207234519" onmouseenter="enter('-3857326443207234519');" onmouseout="out('-3857326443207234519');" style=""> 178                 promise.reject(&quot;authentication_failed&quot;, e.getMessage());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 181             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 182             AuthorizationServiceConfiguration.fetchFromUrl(                                              </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 183                     buildConfigurationUriFromIssuer(issuerUri),                                          </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 184                     new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {              </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 185                         public void onFetchConfigurationCompleted(                                       </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 186                                 @Nullable AuthorizationServiceConfiguration fetchedConfiguration,        </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 187                                 @Nullable AuthorizationException ex) {                                   </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 188                             if (ex != null) {                                                            </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 189                                 promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));</span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 190                                 return;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                             }                                                                            </span>
<span  style=""> 192                                                                                                          </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 193                             mServiceConfiguration.set(fetchedConfiguration);                             </span>
<span  style=""> 194                                                                                                          </span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 195                             authorizeWithConfiguration(                                                  </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 196                                     fetchedConfiguration,                                                </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 197                                     appAuthConfiguration,                                                </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 198                                     clientId,                                                            </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 199                                     scopes,                                                              </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 200                                     redirectUrl,                                                         </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 201                                     usePKCE,                                                             </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 202                                     additionalParametersMap                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 203                             );                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204                         }                                                                                </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 205                     },                                                                                   </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 206                     builder                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 207             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208         }                                                                                                </span>
<span  style=""> 209                                                                                                          </span>
<span  style=""> 210                                                                                                          </span>
<span  style=""> 211                                                                                                          </span>
<span  style=""> 212                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 215     @ReactMethod                                                                                         </span>
<span class="-5238780499530126703" onmouseenter="enter('-5238780499530126703');" onmouseout="out('-5238780499530126703');" style=""> 216     public void refresh(                                                                                 </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 217             String issuer,                                                                               </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 218             final String redirectUrl,                                                                    </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 219             final String clientId,                                                                       </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 220             final String clientSecret,                                                                   </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 221             final String refreshToken,                                                                   </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 222             final ReadableArray scopes,                                                                  </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 223             final ReadableMap additionalParameters,                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 224             final ReadableMap serviceConfiguration,                                                      </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 225             final String clientAuthMethod,                                                               </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 226             final Boolean dangerouslyAllowInsecureHttpRequests,                                          </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 227             final ReadableMap headers,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 228             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 229     ) {                                                                                                  </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 230         this.parseHeaderMap(headers);                                                                    </span>
<span class="5750510513523473374" onmouseenter="enter('5750510513523473374');" onmouseout="out('5750510513523473374');" style=""><abbr title=" 231         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders);"> 231         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="-7964591588332866161" onmouseenter="enter('-7964591588332866161');" onmouseout="out('-7964591588332866161');" style=""> 232         final AppAuthConfiguration appAuthConfiguration = createAppAuthConfiguration(builder);           </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 233         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 233         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span  style=""> 234                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 235         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 236             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237         }                                                                                                </span>
<span  style=""> 238                                                                                                          </span>
<span class="1495748746185505707" onmouseenter="enter('1495748746185505707');" onmouseout="out('1495748746185505707');" style=""> 239         // store setting in private field for later use in onActivityResult handler                      </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 240         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 241         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span  style=""> 242                                                                                                          </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 243         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 243         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 244         if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 245             try {                                                                                        </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 246                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 246                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != nu🔵</abbr></span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 247                 refreshWithConfiguration(                                                                </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 248                         serviceConfig,                                                                   </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 249                         appAuthConfiguration,                                                            </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 250                         refreshToken,                                                                    </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 251                         clientId,                                                                        </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 252                         scopes,                                                                          </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 253                         redirectUrl,                                                                     </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 254                         additionalParametersMap,                                                         </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 255                         clientAuthMethod,                                                                </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 256                         clientSecret,                                                                    </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 257                         promise                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 258                 );                                                                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 259             } catch (Exception e) {                                                                      </span>
<span class="7513248397060081198" onmouseenter="enter('7513248397060081198');" onmouseout="out('7513248397060081198');" style=""> 260                 promise.reject(&quot;token_refresh_failed&quot;, e.getMessage());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 263             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 264             AuthorizationServiceConfiguration.fetchFromUrl(                                              </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 265                     buildConfigurationUriFromIssuer(issuerUri),                                          </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 266                     new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {              </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 267                         public void onFetchConfigurationCompleted(                                       </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 268                                 @Nullable AuthorizationServiceConfiguration fetchedConfiguration,        </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 269                                 @Nullable AuthorizationException ex) {                                   </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 270                             if (ex != null) {                                                            </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 271                                 promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));</span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 272                                 return;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273                             }                                                                            </span>
<span  style=""> 274                                                                                                          </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 275                             mServiceConfiguration.set(fetchedConfiguration);                             </span>
<span  style=""> 276                                                                                                          </span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 277                             refreshWithConfiguration(                                                    </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 278                                     fetchedConfiguration,                                                </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 279                                     appAuthConfiguration,                                                </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 280                                     refreshToken,                                                        </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 281                                     clientId,                                                            </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 282                                     scopes,                                                              </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 283                                     redirectUrl,                                                         </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 284                                     additionalParametersMap,                                             </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 285                                     clientAuthMethod,                                                    </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 286                                     clientSecret,                                                        </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 287                                     promise                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 288                             );                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289                         }                                                                                </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 290                     },                                                                                   </span>
<span class="2680658541157360392" onmouseenter="enter('2680658541157360392');" onmouseout="out('2680658541157360392');" style=""> 291                     builder);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292         }                                                                                                </span>
<span  style=""> 293                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 296     /*                                                                                                   </span>
<span class="7578951324193379805" onmouseenter="enter('7578951324193379805');" onmouseout="out('7578951324193379805');" style=""> 297      * Called when the OAuth browser activity completes                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 298      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 299     @Override                                                                                            </span>
<span class="2027722410160164989" onmouseenter="enter('2027722410160164989');" onmouseout="out('2027722410160164989');" style=""> 300     public void onActivityResult(Activity activity, int requestCode, int resultCode, Intent data) {      </span>
<span class="-4639597857217913430" onmouseenter="enter('-4639597857217913430');" onmouseout="out('-4639597857217913430');" style=""> 301         if (requestCode == 0) {                                                                          </span>
<span class="-5203356024335682166" onmouseenter="enter('-5203356024335682166');" onmouseout="out('-5203356024335682166');" style=""> 302             if (data == null) {                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 303 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 304                 if (promise != null) {                                                                   </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 305                     promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 306                 }                                                                                        </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 307 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                 promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310             }                                                                                            </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 311 =======                                                                                                  </span>
<span class="2268968836554739893" onmouseenter="enter('2268968836554739893');" onmouseout="out('2268968836554739893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312                 promise.reject(&quot;authentication_error&quot;, &quot;Data intent is null&quot; );                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 313 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 314                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span  style=""> 316                                                                                                          </span>
<span class="1683167759369238332" onmouseenter="enter('1683167759369238332');" onmouseout="out('1683167759369238332');" style=""> 317             final AuthorizationResponse response = AuthorizationResponse.fromIntent(data);               </span>
<span class="-2661429536108932642" onmouseenter="enter('-2661429536108932642');" onmouseout="out('-2661429536108932642');" style=""> 318             AuthorizationException exception = AuthorizationException.fromIntent(data);                  </span>
<span class="812069196179346176" onmouseenter="enter('812069196179346176');" onmouseout="out('812069196179346176');" style=""> 319             if (exception != null) {                                                                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 320 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 321                 if (promise != null) {                                                                   </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 322                     promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 323                 }                                                                                        </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 324 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325                 promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328                                                                                                          </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329             final Promise authorizePromise = this.promise;                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 330 =======                                                                                                  </span>
<span class="8302975562867231827" onmouseenter="enter('8302975562867231827');" onmouseout="out('8302975562867231827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331                 promise.reject(&quot;authentication_error&quot;, getErrorMessage(exception));                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 332 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 333                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334             }                                                                                            </span>
<span  style=""> 335                                                                                                          </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style=""> 336             final Promise authorizePromise = this.promise;                                               </span>
<span class="5853075131485496752" onmouseenter="enter('5853075131485496752');" onmouseout="out('5853075131485496752');" style=""> 337             final AppAuthConfiguration configuration = createAppAuthConfiguration(                       </span>
<span class="-3586276280695435831" onmouseenter="enter('-3586276280695435831');" onmouseout="out('-3586276280695435831');" style=""><abbr title=" 338                     createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders)"> 338                     createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestH🔵</abbr></span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 339             );                                                                                           </span>
<span  style=""> 340                                                                                                          </span>
<span class="-598339291394324639" onmouseenter="enter('-598339291394324639');" onmouseout="out('-598339291394324639');" style=""><abbr title=" 341             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration);"> 341             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration)🔵</abbr></span>
<span  style=""> 342                                                                                                          </span>
<span class="6152215567678252770" onmouseenter="enter('6152215567678252770');" onmouseout="out('6152215567678252770');" style=""><abbr title=" 343             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap);"> 343             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap)🔵</abbr></span>
<span  style=""> 344                                                                                                          </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 345             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 345             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.T🔵</abbr></span>
<span  style=""> 346                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 347                 @Override                                                                                </span>
<span class="-8262795349130604582" onmouseenter="enter('-8262795349130604582');" onmouseout="out('-8262795349130604582');" style=""> 348                 public void onTokenRequestCompleted(                                                     </span>
<span class="5619805881636115456" onmouseenter="enter('5619805881636115456');" onmouseout="out('5619805881636115456');" style=""> 349                         TokenResponse resp, AuthorizationException ex) {                                 </span>
<span class="7476284757153148856" onmouseenter="enter('7476284757153148856');" onmouseout="out('7476284757153148856');" style=""> 350                     if (resp != null) {                                                                  </span>
<span class="7607526798956663360" onmouseenter="enter('7607526798956663360');" onmouseout="out('7607526798956663360');" style=""> 351                         WritableMap map = TokenResponseFactory.tokenResponseToMap(resp, response);       </span>
<span class="-6045783056504489326" onmouseenter="enter('-6045783056504489326');" onmouseout="out('-6045783056504489326');" style=""> 352                         if (authorizePromise != null) {                                                  </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style=""> 353                             authorizePromise.resolve(map);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 355                     } else {                                                                             </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 356 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 357                         if (promise != null) {                                                           </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 358                             promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 359                         }                                                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 360 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361                         promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363                 }                                                                                        </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364             };                                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365                                                                                                          </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366             if (this.clientSecret != null) {                                                             </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 367                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 367                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.cl🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368                 authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 369                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 370 =======                                                                                                  </span>
<span class="-1873248496991044419" onmouseenter="enter('-1873248496991044419');" onmouseout="out('-1873248496991044419');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371                         promise.reject(&quot;token_exchange_failed&quot;, getErrorMessage(ex));                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 372 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374                 }                                                                                        </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 375             };                                                                                           </span>
<span  style=""> 376                                                                                                          </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style=""> 377             if (this.clientSecret != null) {                                                             </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style=""><abbr title=" 378                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 378                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.cl🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 379                 authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);        </span>
<span  style=""> 380                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 381             } else {                                                                                     </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 382                 authService.performTokenRequest(tokenRequest, tokenResponseCallback);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383             }                                                                                            </span>
<span  style=""> 384                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386     }                                                                                                    </span>
<span  style=""> 387                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 388     /*                                                                                                   </span>
<span class="-3037424821439688076" onmouseenter="enter('-3037424821439688076');" onmouseout="out('-3037424821439688076');" style=""> 389      * Authorize user with the provided configuration                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 390      */                                                                                                  </span>
<span class="-1686698148972257501" onmouseenter="enter('-1686698148972257501');" onmouseout="out('-1686698148972257501');" style=""> 391     private void authorizeWithConfiguration(                                                             </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 392             final AuthorizationServiceConfiguration serviceConfiguration,                                </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 393             final AppAuthConfiguration appAuthConfiguration,                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 394             final String clientId,                                                                       </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 395             final ReadableArray scopes,                                                                  </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 396             final String redirectUrl,                                                                    </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 397             final Boolean usePKCE,                                                                       </span>
<span class="4591131233701235058" onmouseenter="enter('4591131233701235058');" onmouseout="out('4591131233701235058');" style=""> 398             final Map&lt;String, String&gt; additionalParametersMap                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 399     ) {                                                                                                  </span>
<span  style=""> 400                                                                                                          </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 401         String scopesString = null;                                                                      </span>
<span  style=""> 402                                                                                                          </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 403         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 404             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405         }                                                                                                </span>
<span  style=""> 406                                                                                                          </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 407         final Context context = this.reactContext;                                                       </span>
<span class="-4913832152651687292" onmouseenter="enter('-4913832152651687292');" onmouseout="out('-4913832152651687292');" style=""> 408         final Activity currentActivity = getCurrentActivity();                                           </span>
<span  style=""> 409                                                                                                          </span>
<span class="1615045173536817183" onmouseenter="enter('1615045173536817183');" onmouseout="out('1615045173536817183');" style=""> 410         AuthorizationRequest.Builder authRequestBuilder =                                                </span>
<span class="8630572254279098967" onmouseenter="enter('8630572254279098967');" onmouseout="out('8630572254279098967');" style=""> 411                 new AuthorizationRequest.Builder(                                                        </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 412                         serviceConfiguration,                                                            </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 413                         clientId,                                                                        </span>
<span class="4849618716626806999" onmouseenter="enter('4849618716626806999');" onmouseout="out('4849618716626806999');" style=""> 414                         ResponseTypeValues.CODE,                                                         </span>
<span class="-1639145692422133689" onmouseenter="enter('-1639145692422133689');" onmouseout="out('-1639145692422133689');" style=""> 415                         Uri.parse(redirectUrl)                                                           </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 416                 );                                                                                       </span>
<span  style=""> 417                                                                                                          </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 418         if (scopesString != null) {                                                                      </span>
<span class="-8218576309450527961" onmouseenter="enter('-8218576309450527961');" onmouseout="out('-8218576309450527961');" style=""> 419             authRequestBuilder.setScope(scopesString);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420         }                                                                                                </span>
<span  style=""> 421                                                                                                          </span>
<span  style=""> 422                                                                                                          </span>
<span class="7149068665077353053" onmouseenter="enter('7149068665077353053');" onmouseout="out('7149068665077353053');" style=""> 423         if (additionalParametersMap != null) {                                                           </span>
<span class="-6137327941719445172" onmouseenter="enter('-6137327941719445172');" onmouseout="out('-6137327941719445172');" style=""> 424             // handle additional parameters separately to avoid exceptions from AppAuth                  </span>
<span class="-4729676460784236302" onmouseenter="enter('-4729676460784236302');" onmouseout="out('-4729676460784236302');" style=""> 425             if (additionalParametersMap.containsKey(&quot;display&quot;)) {                                        </span>
<span class="6740086842281271815" onmouseenter="enter('6740086842281271815');" onmouseout="out('6740086842281271815');" style=""> 426                 authRequestBuilder.setDisplay(additionalParametersMap.get(&quot;display&quot;));                   </span>
<span class="5478676394718524231" onmouseenter="enter('5478676394718524231');" onmouseout="out('5478676394718524231');" style=""> 427                 additionalParametersMap.remove(&quot;display&quot;);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428             }                                                                                            </span>
<span class="-5162308638975991351" onmouseenter="enter('-5162308638975991351');" onmouseout="out('-5162308638975991351');" style=""> 429             if (additionalParametersMap.containsKey(&quot;login_hint&quot;)) {                                     </span>
<span class="7478322337196261432" onmouseenter="enter('7478322337196261432');" onmouseout="out('7478322337196261432');" style=""> 430                 authRequestBuilder.setLoginHint(additionalParametersMap.get(&quot;login_hint&quot;));              </span>
<span class="-3825577662921277200" onmouseenter="enter('-3825577662921277200');" onmouseout="out('-3825577662921277200');" style=""> 431                 additionalParametersMap.remove(&quot;login_hint&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432             }                                                                                            </span>
<span class="-8254180626457365202" onmouseenter="enter('-8254180626457365202');" onmouseout="out('-8254180626457365202');" style=""> 433             if (additionalParametersMap.containsKey(&quot;prompt&quot;)) {                                         </span>
<span class="2585369211918110761" onmouseenter="enter('2585369211918110761');" onmouseout="out('2585369211918110761');" style=""> 434                 authRequestBuilder.setPrompt(additionalParametersMap.get(&quot;prompt&quot;));                     </span>
<span class="290019989822766287" onmouseenter="enter('290019989822766287');" onmouseout="out('290019989822766287');" style=""> 435                 additionalParametersMap.remove(&quot;prompt&quot;);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436             }                                                                                            </span>
<span  style=""> 437                                                                                                          </span>
<span class="-1433627721318603910" onmouseenter="enter('-1433627721318603910');" onmouseout="out('-1433627721318603910');" style=""> 438             authRequestBuilder.setAdditionalParameters(additionalParametersMap);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439         }                                                                                                </span>
<span  style=""> 440                                                                                                          </span>
<span class="6295746505532947076" onmouseenter="enter('6295746505532947076');" onmouseout="out('6295746505532947076');" style=""> 441         if (!usePKCE) {                                                                                  </span>
<span class="211047115781987373" onmouseenter="enter('211047115781987373');" onmouseout="out('211047115781987373');" style=""> 442             authRequestBuilder.setCodeVerifier(null);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443         }                                                                                                </span>
<span  style=""> 444                                                                                                          </span>
<span class="2874496759892237047" onmouseenter="enter('2874496759892237047');" onmouseout="out('2874496759892237047');" style=""> 445         AuthorizationRequest authRequest = authRequestBuilder.build();                                   </span>
<span  style=""> 446                                                                                                          </span>
<span class="4248167488592758879" onmouseenter="enter('4248167488592758879');" onmouseout="out('4248167488592758879');" style=""> 447         if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.LOLLIPOP) {               </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 448             AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);  </span>
<span class="-8712988972948484879" onmouseenter="enter('-8712988972948484879');" onmouseout="out('-8712988972948484879');" style=""> 449             Intent authIntent = authService.getAuthorizationRequestIntent(authRequest);                  </span>
<span  style=""> 450                                                                                                          </span>
<span class="-1768672139093830544" onmouseenter="enter('-1768672139093830544');" onmouseout="out('-1768672139093830544');" style=""> 451             currentActivity.startActivityForResult(authIntent, 0);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 452         } else {                                                                                         </span>
<span class="-5574677103641269793" onmouseenter="enter('-5574677103641269793');" onmouseout="out('-5574677103641269793');" style=""><abbr title=" 453             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfiguration);"> 453             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfigura🔵</abbr></span>
<span class="-921350943484849229" onmouseenter="enter('-921350943484849229');" onmouseout="out('-921350943484849229');" style=""> 454             PendingIntent pendingIntent = currentActivity.createPendingResult(0, new Intent(), 0);       </span>
<span  style=""> 455                                                                                                          </span>
<span class="5462088869311657545" onmouseenter="enter('5462088869311657545');" onmouseout="out('5462088869311657545');" style=""> 456             authService.performAuthorizationRequest(authRequest, pendingIntent);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458     }                                                                                                    </span>
<span  style=""> 459                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 460     /*                                                                                                   </span>
<span class="8814346366745541198" onmouseenter="enter('8814346366745541198');" onmouseout="out('8814346366745541198');" style=""> 461      * Refresh authentication token with the provided configuration                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 462      */                                                                                                  </span>
<span class="-7235916799046070057" onmouseenter="enter('-7235916799046070057');" onmouseout="out('-7235916799046070057');" style=""> 463     private void refreshWithConfiguration(                                                               </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 464             final AuthorizationServiceConfiguration serviceConfiguration,                                </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 465             final AppAuthConfiguration appAuthConfiguration,                                             </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 466             final String refreshToken,                                                                   </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 467             final String clientId,                                                                       </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 468             final ReadableArray scopes,                                                                  </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 469             final String redirectUrl,                                                                    </span>
<span class="3078994421067824649" onmouseenter="enter('3078994421067824649');" onmouseout="out('3078994421067824649');" style=""> 470             final Map&lt;String, String&gt; additionalParametersMap,                                           </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 471             final String clientAuthMethod,                                                               </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 472             final String clientSecret,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 473             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 474     ) {                                                                                                  </span>
<span  style=""> 475                                                                                                          </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 476         String scopesString = null;                                                                      </span>
<span  style=""> 477                                                                                                          </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 478         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 479             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480         }                                                                                                </span>
<span  style=""> 481                                                                                                          </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 482         final Context context = this.reactContext;                                                       </span>
<span  style=""> 483                                                                                                          </span>
<span class="-1882592220700818910" onmouseenter="enter('-1882592220700818910');" onmouseout="out('-1882592220700818910');" style=""> 484         TokenRequest.Builder tokenRequestBuilder =                                                       </span>
<span class="-7570030938974274508" onmouseenter="enter('-7570030938974274508');" onmouseout="out('-7570030938974274508');" style=""> 485                 new TokenRequest.Builder(                                                                </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 486                         serviceConfiguration,                                                            </span>
<span class="-3028793166139754818" onmouseenter="enter('-3028793166139754818');" onmouseout="out('-3028793166139754818');" style=""> 487                         clientId                                                                         </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 488                 )                                                                                        </span>
<span class="5149869235939087614" onmouseenter="enter('5149869235939087614');" onmouseout="out('5149869235939087614');" style=""> 489                         .setRefreshToken(refreshToken)                                                   </span>
<span class="-4168308848344323961" onmouseenter="enter('-4168308848344323961');" onmouseout="out('-4168308848344323961');" style=""> 490                         .setRedirectUri(Uri.parse(redirectUrl));                                         </span>
<span  style=""> 491                                                                                                          </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 492         if (scopesString != null) {                                                                      </span>
<span class="-4940100242303343354" onmouseenter="enter('-4940100242303343354');" onmouseout="out('-4940100242303343354');" style=""> 493             tokenRequestBuilder.setScope(scopesString);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494         }                                                                                                </span>
<span  style=""> 495                                                                                                          </span>
<span class="1982926752875631058" onmouseenter="enter('1982926752875631058');" onmouseout="out('1982926752875631058');" style=""> 496         if (!additionalParametersMap.isEmpty()) {                                                        </span>
<span class="6791703352530289305" onmouseenter="enter('6791703352530289305');" onmouseout="out('6791703352530289305');" style=""> 497             tokenRequestBuilder.setAdditionalParameters(additionalParametersMap);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498         }                                                                                                </span>
<span  style=""> 499                                                                                                          </span>
<span class="6300215370198990899" onmouseenter="enter('6300215370198990899');" onmouseout="out('6300215370198990899');" style=""> 500         TokenRequest tokenRequest = tokenRequestBuilder.build();                                         </span>
<span  style=""> 501                                                                                                          </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 502         AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);      </span>
<span  style=""> 503                                                                                                          </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 504         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 504         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.Token🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 505             @Override                                                                                    </span>
<span class="-9019017716153453132" onmouseenter="enter('-9019017716153453132');" onmouseout="out('-9019017716153453132');" style=""><abbr title=" 506             public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException ex) {"> 506             public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable Authorization🔵</abbr></span>
<span class="4756227728171050519" onmouseenter="enter('4756227728171050519');" onmouseout="out('4756227728171050519');" style=""> 507                 if (response != null) {                                                                  </span>
<span class="-4071880271889138129" onmouseenter="enter('-4071880271889138129');" onmouseout="out('-4071880271889138129');" style=""> 508                     WritableMap map = TokenResponseFactory.tokenResponseToMap(response);                 </span>
<span class="9181054552595447887" onmouseenter="enter('9181054552595447887');" onmouseout="out('9181054552595447887');" style=""> 509                     promise.resolve(map);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 510                 } else {                                                                                 </span>
<span class="-8974399670180994057" onmouseenter="enter('-8974399670180994057');" onmouseout="out('-8974399670180994057');" style=""> 511                     promise.reject(&quot;token_refresh_failed&quot;, getErrorMessage(ex));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 514         };                                                                                               </span>
<span  style=""> 515                                                                                                          </span>
<span  style=""> 516                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 517         if (clientSecret != null) {                                                                      </span>
<span class="-3955443834186652225" onmouseenter="enter('-3955443834186652225');" onmouseout="out('-3955443834186652225');" style=""><abbr title=" 518             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod);"> 518             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 519             authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);            </span>
<span  style=""> 520                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 521         } else {                                                                                         </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 522             authService.performTokenRequest(tokenRequest, tokenResponseCallback);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524     }                                                                                                    </span>
<span  style=""> 525                                                                                                          </span>
<span class="2930218534777413873" onmouseenter="enter('2930218534777413873');" onmouseout="out('2930218534777413873');" style=""> 526     private void parseHeaderMap (ReadableMap headerMap) {                                                </span>
<span class="-6316489241675673035" onmouseenter="enter('-6316489241675673035');" onmouseout="out('-6316489241675673035');" style=""> 527         if (headerMap == null) {                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 528             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529         }                                                                                                </span>
<span class="-8530407112624237580" onmouseenter="enter('-8530407112624237580');" onmouseout="out('-8530407112624237580');" style=""> 530         if (headerMap.hasKey(&quot;authorize&quot;) &amp;&amp; headerMap.getType(&quot;authorize&quot;) == ReadableType.Map) {       </span>
<span class="762039099095363738" onmouseenter="enter('762039099095363738');" onmouseout="out('762039099095363738');" style=""><abbr title=" 531             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;));"> 531             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532         }                                                                                                </span>
<span class="5768179141818569002" onmouseenter="enter('5768179141818569002');" onmouseout="out('5768179141818569002');" style=""> 533         if (headerMap.hasKey(&quot;token&quot;) &amp;&amp; headerMap.getType(&quot;token&quot;) == ReadableType.Map) {               </span>
<span class="-4870803436115877491" onmouseenter="enter('-4870803436115877491');" onmouseout="out('-4870803436115877491');" style=""> 534             this.tokenRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;token&quot;));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535         }                                                                                                </span>
<span  style=""> 536                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537     }                                                                                                    </span>
<span  style=""> 538                                                                                                          </span>
<span class="-2276636657842571599" onmouseenter="enter('-2276636657842571599');" onmouseout="out('-2276636657842571599');" style=""> 539     private ClientAuthentication getClientAuthentication(String clientSecret, String clientAuthMethod) { </span>
<span class="4736948393768361142" onmouseenter="enter('4736948393768361142');" onmouseout="out('4736948393768361142');" style=""> 540         if (clientAuthMethod.equals(&quot;post&quot;)) {                                                           </span>
<span class="4033722210949459980" onmouseenter="enter('4033722210949459980');" onmouseout="out('4033722210949459980');" style=""> 541             return new ClientSecretPost(clientSecret);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 542         }                                                                                                </span>
<span  style=""> 543                                                                                                          </span>
<span class="-1107687855860572488" onmouseenter="enter('-1107687855860572488');" onmouseout="out('-1107687855860572488');" style=""> 544         return new ClientSecretBasic(clientSecret);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 545     }                                                                                                    </span>
<span  style=""> 546                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 547     /*                                                                                                   </span>
<span class="5090378039448834807" onmouseenter="enter('5090378039448834807');" onmouseout="out('5090378039448834807');" style=""> 548      * Return error information if it is available                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 549      */                                                                                                  </span>
<span class="7325111704754615468" onmouseenter="enter('7325111704754615468');" onmouseout="out('7325111704754615468');" style=""> 550     private String getErrorMessage(AuthorizationException ex){                                           </span>
<span class="6233744395473659458" onmouseenter="enter('6233744395473659458');" onmouseout="out('6233744395473659458');" style=""> 551         if(ex.errorDescription == null &amp;&amp; ex.error != null)                                              </span>
<span class="8212520076730053042" onmouseenter="enter('8212520076730053042');" onmouseout="out('8212520076730053042');" style=""> 552             return ex.error;                                                                             </span>
<span class="-944119096152079377" onmouseenter="enter('-944119096152079377');" onmouseout="out('-944119096152079377');" style=""> 553         return ex.errorDescription;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 554     }                                                                                                    </span>
<span  style=""> 555                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 556     /*                                                                                                   </span>
<span class="6638112631744326921" onmouseenter="enter('6638112631744326921');" onmouseout="out('6638112631744326921');" style=""> 557      * Create a space-delimited string from an array                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 558      */                                                                                                  </span>
<span class="2843730177292313139" onmouseenter="enter('2843730177292313139');" onmouseout="out('2843730177292313139');" style=""> 559     private String arrayToString(ReadableArray array) {                                                  </span>
<span class="-8236782342056480869" onmouseenter="enter('-8236782342056480869');" onmouseout="out('-8236782342056480869');" style=""> 560         StringBuilder strBuilder = new StringBuilder();                                                  </span>
<span class="7278311890620727475" onmouseenter="enter('7278311890620727475');" onmouseout="out('7278311890620727475');" style=""> 561         for (int i = 0; i &lt; array.size(); i++) {                                                         </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style=""> 562             if (i != 0) {                                                                                </span>
<span class="-4449242394605741248" onmouseenter="enter('-4449242394605741248');" onmouseout="out('-4449242394605741248');" style=""> 563                 strBuilder.append(&#x27; &#x27;);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 564             }                                                                                            </span>
<span class="-8205116312766504963" onmouseenter="enter('-8205116312766504963');" onmouseout="out('-8205116312766504963');" style=""> 565             strBuilder.append(array.getString(i));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566         }                                                                                                </span>
<span class="-7597052729024482685" onmouseenter="enter('-7597052729024482685');" onmouseout="out('-7597052729024482685');" style=""> 567         return strBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568     }                                                                                                    </span>
<span  style=""> 569                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 570     /*                                                                                                   </span>
<span class="5214794569700518887" onmouseenter="enter('5214794569700518887');" onmouseout="out('5214794569700518887');" style=""> 571      * Create an App Auth configuration using the provided connection builder                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 572      */                                                                                                  </span>
<span class="-5342361748775304563" onmouseenter="enter('-5342361748775304563');" onmouseout="out('-5342361748775304563');" style=""> 573     private AppAuthConfiguration createAppAuthConfiguration(ConnectionBuilder connectionBuilder) {       </span>
<span class="-6961363017801118708" onmouseenter="enter('-6961363017801118708');" onmouseout="out('-6961363017801118708');" style=""> 574         return new AppAuthConfiguration                                                                  </span>
<span class="370567544488026574" onmouseenter="enter('370567544488026574');" onmouseout="out('370567544488026574');" style=""> 575                 .Builder()                                                                               </span>
<span class="6932817517014214209" onmouseenter="enter('6932817517014214209');" onmouseout="out('6932817517014214209');" style=""> 576                 .setConnectionBuilder(connectionBuilder)                                                 </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 577                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578     }                                                                                                    </span>
<span  style=""> 579                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 580     /*                                                                                                   </span>
<span class="2307564597312892215" onmouseenter="enter('2307564597312892215');" onmouseout="out('2307564597312892215');" style=""> 581      *  Create appropriate connection builder based on provided settings                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 582      */                                                                                                  </span>
<span class="-266307560690147004" onmouseenter="enter('-266307560690147004');" onmouseout="out('-266307560690147004');" style=""><abbr title=" 583     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; headers) {"> 583     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, Strin🔵</abbr></span>
<span class="7318015076305824949" onmouseenter="enter('7318015076305824949');" onmouseout="out('7318015076305824949');" style=""> 584         ConnectionBuilder proxiedBuilder;                                                                </span>
<span  style=""> 585                                                                                                          </span>
<span class="-6214248404965356101" onmouseenter="enter('-6214248404965356101');" onmouseout="out('-6214248404965356101');" style=""> 586         if (allowInsecureConnections.equals(true)) {                                                     </span>
<span class="-8652069864919613967" onmouseenter="enter('-8652069864919613967');" onmouseout="out('-8652069864919613967');" style=""> 587             proxiedBuilder =UnsafeConnectionBuilder.INSTANCE;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 588         } else {                                                                                         </span>
<span class="-3823294731313489124" onmouseenter="enter('-3823294731313489124');" onmouseout="out('-3823294731313489124');" style=""> 589             proxiedBuilder = DefaultConnectionBuilder.INSTANCE;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590         }                                                                                                </span>
<span  style=""> 591                                                                                                          </span>
<span class="-321326358809916252" onmouseenter="enter('-321326358809916252');" onmouseout="out('-321326358809916252');" style=""> 592         CustomConnectionBuilder customConnection = new CustomConnectionBuilder(proxiedBuilder);          </span>
<span class="-5872856843685271172" onmouseenter="enter('-5872856843685271172');" onmouseout="out('-5872856843685271172');" style=""> 593         if (headers != null) {                                                                           </span>
<span class="-4120878389218127223" onmouseenter="enter('-4120878389218127223');" onmouseout="out('-4120878389218127223');" style=""> 594             customConnection.setHeaders(headers);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595         }                                                                                                </span>
<span  style=""> 596                                                                                                          </span>
<span class="5629827582834827587" onmouseenter="enter('5629827582834827587');" onmouseout="out('5629827582834827587');" style=""> 597         return customConnection;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598     }                                                                                                    </span>
<span  style=""> 599                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 600     /*                                                                                                   </span>
<span class="9187662928809351886" onmouseenter="enter('9187662928809351886');" onmouseout="out('9187662928809351886');" style=""> 601      *  Replicated private method from AuthorizationServiceConfiguration                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 602      */                                                                                                  </span>
<span class="2622836649973257205" onmouseenter="enter('2622836649973257205');" onmouseout="out('2622836649973257205');" style=""> 603     private Uri buildConfigurationUriFromIssuer(Uri openIdConnectIssuerUri) {                            </span>
<span class="-830811466431368071" onmouseenter="enter('-830811466431368071');" onmouseout="out('-830811466431368071');" style=""> 604         return openIdConnectIssuerUri.buildUpon()                                                        </span>
<span class="7258170423676519924" onmouseenter="enter('7258170423676519924');" onmouseout="out('7258170423676519924');" style=""> 605                 .appendPath(AuthorizationServiceConfiguration.WELL_KNOWN_PATH)                           </span>
<span class="-3903955623180377764" onmouseenter="enter('-3903955623180377764');" onmouseout="out('-3903955623180377764');" style=""> 606                 .appendPath(AuthorizationServiceConfiguration.OPENID_CONFIGURATION_RESOURCE)             </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 607                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 608     }                                                                                                    </span>
<span  style=""> 609                                                                                                          </span>
<span class="3122274151060887299" onmouseenter="enter('3122274151060887299');" onmouseout="out('3122274151060887299');" style=""><abbr title=" 610     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfiguration) throws Exception {"> 610     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap service🔵</abbr></span>
<span class="4275545280692735139" onmouseenter="enter('4275545280692735139');" onmouseout="out('4275545280692735139');" style=""> 611         if (!serviceConfiguration.hasKey(&quot;authorizationEndpoint&quot;)) {                                     </span>
<span class="3986521017730318395" onmouseenter="enter('3986521017730318395');" onmouseout="out('3986521017730318395');" style=""> 612             throw new Exception(&quot;serviceConfiguration passed without an authorizationEndpoint&quot;);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 613         }                                                                                                </span>
<span  style=""> 614                                                                                                          </span>
<span class="5638598812511759739" onmouseenter="enter('5638598812511759739');" onmouseout="out('5638598812511759739');" style=""> 615         if (!serviceConfiguration.hasKey(&quot;tokenEndpoint&quot;)) {                                             </span>
<span class="7444064849592215652" onmouseenter="enter('7444064849592215652');" onmouseout="out('7444064849592215652');" style=""> 616             throw new Exception(&quot;serviceConfiguration passed without a tokenEndpoint&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 617         }                                                                                                </span>
<span  style=""> 618                                                                                                          </span>
<span class="-3941749567598770425" onmouseenter="enter('-3941749567598770425');" onmouseout="out('-3941749567598770425');" style=""> 619         Uri authorizationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;authorizationEndpoint&quot;));  </span>
<span class="4054930865548070446" onmouseenter="enter('4054930865548070446');" onmouseout="out('4054930865548070446');" style=""> 620         Uri tokenEndpoint = Uri.parse(serviceConfiguration.getString(&quot;tokenEndpoint&quot;));                  </span>
<span class="2264343622444418519" onmouseenter="enter('2264343622444418519');" onmouseout="out('2264343622444418519');" style=""> 621         Uri registrationEndpoint = null;                                                                 </span>
<span class="-4970643399788664483" onmouseenter="enter('-4970643399788664483');" onmouseout="out('-4970643399788664483');" style=""> 622         if (serviceConfiguration.hasKey(&quot;registrationEndpoint&quot;)) {                                       </span>
<span class="1609034589288005797" onmouseenter="enter('1609034589288005797');" onmouseout="out('1609034589288005797');" style=""> 623             registrationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;registrationEndpoint&quot;));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624         }                                                                                                </span>
<span  style=""> 625                                                                                                          </span>
<span class="-8455698330779530293" onmouseenter="enter('-8455698330779530293');" onmouseout="out('-8455698330779530293');" style=""> 626         return new AuthorizationServiceConfiguration(                                                    </span>
<span class="-9206356706352718453" onmouseenter="enter('-9206356706352718453');" onmouseout="out('-9206356706352718453');" style=""> 627                 authorizationEndpoint,                                                                   </span>
<span class="-6119344076232034280" onmouseenter="enter('-6119344076232034280');" onmouseout="out('-6119344076232034280');" style=""> 628                 tokenEndpoint,                                                                           </span>
<span class="-4224958759407269631" onmouseenter="enter('-4224958759407269631');" onmouseout="out('-4224958759407269631');" style=""> 629                 registrationEndpoint                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 630         );                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 631     }                                                                                                    </span>
<span  style=""> 632                                                                                                          </span>
<span class="-4130257184876230563" onmouseenter="enter('-4130257184876230563');" onmouseout="out('-4130257184876230563');" style=""> 633     private void warmChromeCustomTab(Context context, final String issuer) {                             </span>
<span class="-4012796735492941375" onmouseenter="enter('-4012796735492941375');" onmouseout="out('-4012796735492941375');" style=""> 634         CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 635             @Override                                                                                    </span>
<span class="4306327880536035079" onmouseenter="enter('4306327880536035079');" onmouseout="out('4306327880536035079');" style=""> 636             public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {      </span>
<span class="-5035114608817725139" onmouseenter="enter('-5035114608817725139');" onmouseout="out('-5035114608817725139');" style=""> 637                 client.warmup(0);                                                                        </span>
<span class="5970961959698416627" onmouseenter="enter('5970961959698416627');" onmouseout="out('5970961959698416627');" style=""><abbr title=" 638                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bundle&gt;emptyList());"> 638                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collect🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639             }                                                                                            </span>
<span  style=""> 640                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 641             @Override                                                                                    </span>
<span class="6231636659664649995" onmouseenter="enter('6231636659664649995');" onmouseout="out('6231636659664649995');" style=""> 642             public void onServiceDisconnected(ComponentName name) {                                      </span>
<span  style=""> 643                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 645         };                                                                                               </span>
<span class="5767142201781268255" onmouseenter="enter('5767142201781268255');" onmouseout="out('5767142201781268255');" style=""> 646         CustomTabsClient.bindCustomTabsService(context, CUSTOM_TAB_PACKAGE_NAME, connection);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 647     }                                                                                                    </span>
<span  style=""> 648                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 649     @Override                                                                                            </span>
<span class="-4337880705383881802" onmouseenter="enter('-4337880705383881802');" onmouseout="out('-4337880705383881802');" style=""> 650     public void onNewIntent(Intent intent) {                                                             </span>
<span  style=""> 651                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 652     }                                                                                                    </span>
<span  style=""> 653                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 654     @Override                                                                                            </span>
<span class="190238665005496725" onmouseenter="enter('190238665005496725');" onmouseout="out('190238665005496725');" style=""> 655     public String getName() {                                                                            </span>
<span class="4315075324919368681" onmouseenter="enter('4315075324919368681');" onmouseout="out('4315075324919368681');" style=""> 656         return &quot;RNAppAuth&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 657     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 658 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-6280296900167357794" onmouseenter="enter('-6280296900167357794');" onmouseout="out('-6280296900167357794');" style="">   1 package com.rnappauth;                                                                                   </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="2265467446931963889" onmouseenter="enter('2265467446931963889');" onmouseout="out('2265467446931963889');" style="">   4 import android.app.PendingIntent;                                                                        </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">   5 import android.content.ComponentName;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   6 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   7 import android.content.Intent;                                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   8 import android.net.Uri;                                                                                  </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   9 import android.os.Bundle;                                                                                </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10 import androidx.annotation.Nullable;                                                                     </span>
<span class="-4621922491292668474" onmouseenter="enter('-4621922491292668474');" onmouseout="out('-4621922491292668474');" style="">  11 import androidx.browser.customtabs.CustomTabsCallback;                                                   </span>
<span class="5786009149739133921" onmouseenter="enter('5786009149739133921');" onmouseout="out('5786009149739133921');" style="">  12 import androidx.browser.customtabs.CustomTabsClient;                                                     </span>
<span class="6730446154443378273" onmouseenter="enter('6730446154443378273');" onmouseout="out('6730446154443378273');" style="">  13 import androidx.browser.customtabs.CustomTabsServiceConnection;                                          </span>
<span  style="">  14                                                                                                          </span>
<span class="7327608205307094785" onmouseenter="enter('7327608205307094785');" onmouseout="out('7327608205307094785');" style="">  15 import com.facebook.react.bridge.ActivityEventListener;                                                  </span>
<span class="1744055796152404290" onmouseenter="enter('1744055796152404290');" onmouseout="out('1744055796152404290');" style="">  16 import com.facebook.react.bridge.ReactApplicationContext;                                                </span>
<span class="7756046764634890677" onmouseenter="enter('7756046764634890677');" onmouseout="out('7756046764634890677');" style="">  17 import com.facebook.react.bridge.ReactContextBaseJavaModule;                                             </span>
<span class="-7062843866366665780" onmouseenter="enter('-7062843866366665780');" onmouseout="out('-7062843866366665780');" style="">  18 import com.facebook.react.bridge.ReactMethod;                                                            </span>
<span class="-9114944870765420144" onmouseenter="enter('-9114944870765420144');" onmouseout="out('-9114944870765420144');" style="">  19 import com.facebook.react.bridge.Promise;                                                                </span>
<span class="3666939786570277423" onmouseenter="enter('3666939786570277423');" onmouseout="out('3666939786570277423');" style="">  20 import com.facebook.react.bridge.ReadableArray;                                                          </span>
<span class="5552486474970006352" onmouseenter="enter('5552486474970006352');" onmouseout="out('5552486474970006352');" style="">  21 import com.facebook.react.bridge.ReadableMap;                                                            </span>
<span class="-2689054124168074705" onmouseenter="enter('-2689054124168074705');" onmouseout="out('-2689054124168074705');" style="">  22 import com.facebook.react.bridge.WritableMap;                                                            </span>
<span class="7507448895670758430" onmouseenter="enter('7507448895670758430');" onmouseout="out('7507448895670758430');" style="">  23 import com.facebook.react.bridge.ReadableType;                                                           </span>
<span  style="">  24                                                                                                          </span>
<span class="2824452556317040091" onmouseenter="enter('2824452556317040091');" onmouseout="out('2824452556317040091');" style="">  25 import com.rnappauth.utils.MapUtil;                                                                      </span>
<span class="2320112657500195094" onmouseenter="enter('2320112657500195094');" onmouseout="out('2320112657500195094');" style="">  26 import com.rnappauth.utils.UnsafeConnectionBuilder;                                                      </span>
<span class="5385195114029684108" onmouseenter="enter('5385195114029684108');" onmouseout="out('5385195114029684108');" style="">  27 import com.rnappauth.utils.TokenResponseFactory;                                                         </span>
<span class="-7309342380344421476" onmouseenter="enter('-7309342380344421476');" onmouseout="out('-7309342380344421476');" style="">  28 import com.rnappauth.utils.CustomConnectionBuilder;                                                      </span>
<span  style="">  29                                                                                                          </span>
<span class="2084880808431135122" onmouseenter="enter('2084880808431135122');" onmouseout="out('2084880808431135122');" style="">  30 import net.openid.appauth.AppAuthConfiguration;                                                          </span>
<span class="-6153791587225110013" onmouseenter="enter('-6153791587225110013');" onmouseout="out('-6153791587225110013');" style="">  31 import net.openid.appauth.AuthorizationException;                                                        </span>
<span class="220855730882953420" onmouseenter="enter('220855730882953420');" onmouseout="out('220855730882953420');" style="">  32 import net.openid.appauth.AuthorizationRequest;                                                          </span>
<span class="3507212550601358175" onmouseenter="enter('3507212550601358175');" onmouseout="out('3507212550601358175');" style="">  33 import net.openid.appauth.AuthorizationResponse;                                                         </span>
<span class="6486087234581123017" onmouseenter="enter('6486087234581123017');" onmouseout="out('6486087234581123017');" style="">  34 import net.openid.appauth.AuthorizationService;                                                          </span>
<span class="-1918380963859750931" onmouseenter="enter('-1918380963859750931');" onmouseout="out('-1918380963859750931');" style="">  35 import net.openid.appauth.AuthorizationServiceConfiguration;                                             </span>
<span class="-1745886087889911862" onmouseenter="enter('-1745886087889911862');" onmouseout="out('-1745886087889911862');" style="">  36 import net.openid.appauth.ClientAuthentication;                                                          </span>
<span class="5802881313983385714" onmouseenter="enter('5802881313983385714');" onmouseout="out('5802881313983385714');" style="">  37 import net.openid.appauth.ClientSecretBasic;                                                             </span>
<span class="6044047429679939107" onmouseenter="enter('6044047429679939107');" onmouseout="out('6044047429679939107');" style="">  38 import net.openid.appauth.ClientSecretPost;                                                              </span>
<span class="-7057741429751790751" onmouseenter="enter('-7057741429751790751');" onmouseout="out('-7057741429751790751');" style="">  39 import net.openid.appauth.ResponseTypeValues;                                                            </span>
<span class="7041795251639894294" onmouseenter="enter('7041795251639894294');" onmouseout="out('7041795251639894294');" style="">  40 import net.openid.appauth.TokenResponse;                                                                 </span>
<span class="4423191746780431402" onmouseenter="enter('4423191746780431402');" onmouseout="out('4423191746780431402');" style="">  41 import net.openid.appauth.TokenRequest;                                                                  </span>
<span class="-5344047661436712974" onmouseenter="enter('-5344047661436712974');" onmouseout="out('-5344047661436712974');" style="">  42 import net.openid.appauth.connectivity.ConnectionBuilder;                                                </span>
<span class="2682978576506672064" onmouseenter="enter('2682978576506672064');" onmouseout="out('2682978576506672064');" style="">  43 import net.openid.appauth.connectivity.DefaultConnectionBuilder;                                         </span>
<span  style="">  44                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  45 import java.util.Collections;                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  46 import java.util.HashMap;                                                                                </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  47 import java.util.Map;                                                                                    </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  48 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="6937050046386248317" onmouseenter="enter('6937050046386248317');" onmouseout="out('6937050046386248317');" style="">  49 import java.util.concurrent.CountDownLatch;                                                              </span>
<span  style="">  50                                                                                                          </span>
<span class="6575769426762835403" onmouseenter="enter('6575769426762835403');" onmouseout="out('6575769426762835403');" style="">  51 public class RNAppAuthModule extends ReactContextBaseJavaModule implements ActivityEventListener {       </span>
<span  style="">  52                                                                                                          </span>
<span class="8401162781518473365" onmouseenter="enter('8401162781518473365');" onmouseout="out('8401162781518473365');" style="">  53     public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;                           </span>
<span  style="">  54                                                                                                          </span>
<span class="6180419538961108965" onmouseenter="enter('6180419538961108965');" onmouseout="out('6180419538961108965');" style="">  55     private final ReactApplicationContext reactContext;                                                  </span>
<span class="1869321332520936904" onmouseenter="enter('1869321332520936904');" onmouseout="out('1869321332520936904');" style="">  56     private Promise promise;                                                                             </span>
<span class="504355591559206068" onmouseenter="enter('504355591559206068');" onmouseout="out('504355591559206068');" style="">  57     private Boolean dangerouslyAllowInsecureHttpRequests;                                                </span>
<span class="6877933566748299598" onmouseenter="enter('6877933566748299598');" onmouseout="out('6877933566748299598');" style="">  58     private String clientAuthMethod = &quot;basic&quot;;                                                           </span>
<span class="5073960437150900627" onmouseenter="enter('5073960437150900627');" onmouseout="out('5073960437150900627');" style="">  59     private Map&lt;String, String&gt; authorizationRequestHeaders = null;                                      </span>
<span class="493655431939084947" onmouseenter="enter('493655431939084947');" onmouseout="out('493655431939084947');" style="">  60     private Map&lt;String, String&gt; tokenRequestHeaders = null;                                              </span>
<span class="4071237130655105462" onmouseenter="enter('4071237130655105462');" onmouseout="out('4071237130655105462');" style="">  61     private Map&lt;String, String&gt; additionalParametersMap;                                                 </span>
<span class="266383520389269247" onmouseenter="enter('266383520389269247');" onmouseout="out('266383520389269247');" style="">  62     private String clientSecret;                                                                         </span>
<span class="-2587280928065129913" onmouseenter="enter('-2587280928065129913');" onmouseout="out('-2587280928065129913');" style=""><abbr title="  63     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;();">  63     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicRe🔵</abbr></span>
<span class="-7004558742358285463" onmouseenter="enter('-7004558742358285463');" onmouseout="out('-7004558742358285463');" style="">  64     private boolean isPrefetched = false;                                                                </span>
<span  style="">  65                                                                                                          </span>
<span class="-978447563967948693" onmouseenter="enter('-978447563967948693');" onmouseout="out('-978447563967948693');" style="">  66     public RNAppAuthModule(ReactApplicationContext reactContext) {                                       </span>
<span class="-1443603959286428543" onmouseenter="enter('-1443603959286428543');" onmouseout="out('-1443603959286428543');" style="">  67         super(reactContext);                                                                             </span>
<span class="3003228313870805798" onmouseenter="enter('3003228313870805798');" onmouseout="out('3003228313870805798');" style="">  68         this.reactContext = reactContext;                                                                </span>
<span class="6669990586656871028" onmouseenter="enter('6669990586656871028');" onmouseout="out('6669990586656871028');" style="">  69         reactContext.addActivityEventListener(this);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style="">  72     @ReactMethod                                                                                         </span>
<span class="-5002037316527958427" onmouseenter="enter('-5002037316527958427');" onmouseout="out('-5002037316527958427');" style="">  73     public void prefetchConfiguration(                                                                   </span>
<span class="-8094929847941500576" onmouseenter="enter('-8094929847941500576');" onmouseout="out('-8094929847941500576');" style="">  74         final Boolean warmAndPrefetchChrome,                                                             </span>
<span class="-1461695631126767390" onmouseenter="enter('-1461695631126767390');" onmouseout="out('-1461695631126767390');" style="">  75         final String issuer,                                                                             </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style="">  76         final String redirectUrl,                                                                        </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style="">  77         final String clientId,                                                                           </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style="">  78         final ReadableArray scopes,                                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style="">  79         final ReadableMap serviceConfiguration,                                                          </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style="">  80         final Boolean dangerouslyAllowInsecureHttpRequests,                                              </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style="">  81         final ReadableMap headers,                                                                       </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style="">  82         final Promise promise                                                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style="">  83     ) {                                                                                                  </span>
<span class="-7526945842846133690" onmouseenter="enter('-7526945842846133690');" onmouseout="out('-7526945842846133690');" style="">  84         if (warmAndPrefetchChrome) {                                                                     </span>
<span class="8703515971997686923" onmouseenter="enter('8703515971997686923');" onmouseout="out('8703515971997686923');" style="">  85             warmChromeCustomTab(reactContext, issuer);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86         }                                                                                                </span>
<span  style="">  87                                                                                                          </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style="">  88         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title="  89         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);">  89         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="8517032726698162354" onmouseenter="enter('8517032726698162354');" onmouseout="out('8517032726698162354');" style="">  90         final CountDownLatch fetchConfigurationLatch = new CountDownLatch(1);                            </span>
<span  style="">  91                                                                                                          </span>
<span class="-7471939844701867604" onmouseenter="enter('-7471939844701867604');" onmouseout="out('-7471939844701867604');" style="">  92         if(!isPrefetched) {                                                                              </span>
<span class="-8580903789630998000" onmouseenter="enter('-8580903789630998000');" onmouseout="out('-8580903789630998000');" style="">  93             if (serviceConfiguration != null &amp;&amp; mServiceConfiguration.get() == null) {                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  94                 try {                                                                                    </span>
<span class="-5277191699256196698" onmouseenter="enter('-5277191699256196698');" onmouseout="out('-5277191699256196698');" style=""><abbr title="  95                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguration));">  95                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguratio🔵</abbr></span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style="">  96                     isPrefetched = true;                                                                 </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style="">  97                     fetchConfigurationLatch.countDown();                                                 </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="">  98                 } catch (Exception e) {                                                                  </span>
<span class="6809300863683709814" onmouseenter="enter('6809300863683709814');" onmouseout="out('6809300863683709814');" style="">  99                     promise.reject(&quot;configuration_error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100                 }                                                                                        </span>
<span class="7986155546390017313" onmouseenter="enter('7986155546390017313');" onmouseout="out('7986155546390017313');" style=""> 101             } else if (mServiceConfiguration.get() == null) {                                            </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 102                 final Uri issuerUri = Uri.parse(issuer);                                                 </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 103                 AuthorizationServiceConfiguration.fetchFromUrl(                                          </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 104                         buildConfigurationUriFromIssuer(issuerUri),                                      </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 105                         new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {          </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 106                             public void onFetchConfigurationCompleted(                                   </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 107                                     @Nullable AuthorizationServiceConfiguration fetchedConfiguration,    </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 108                                     @Nullable AuthorizationException ex) {                               </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 109                                 if (ex != null) {                                                        </span>
<span class="6863513032854295921" onmouseenter="enter('6863513032854295921');" onmouseout="out('6863513032854295921');" style=""><abbr title=" 110                                     promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configuration&quot;, ex);"> 110                                     promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch 🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 111                                     return;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112                                 }                                                                        </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 113                                 mServiceConfiguration.set(fetchedConfiguration);                         </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style=""> 114                                 isPrefetched = true;                                                     </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 115                                 fetchConfigurationLatch.countDown();                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116                             }                                                                            </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 117                         },                                                                               </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 118                         builder                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 119                 );                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 121         } else {                                                                                         </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 122             fetchConfigurationLatch.countDown();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span  style=""> 124                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 125         try {                                                                                            </span>
<span class="-1907621811022997860" onmouseenter="enter('-1907621811022997860');" onmouseout="out('-1907621811022997860');" style=""> 126             fetchConfigurationLatch.await();                                                             </span>
<span class="1954864242125272611" onmouseenter="enter('1954864242125272611');" onmouseout="out('1954864242125272611');" style=""> 127             promise.resolve(isPrefetched);                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 128         } catch (Exception e) {                                                                          </span>
<span class="1768900707370095440" onmouseenter="enter('1768900707370095440');" onmouseout="out('1768900707370095440');" style=""><abbr title=" 129             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e);"> 129             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 133     @ReactMethod                                                                                         </span>
<span class="7303195633629033586" onmouseenter="enter('7303195633629033586');" onmouseout="out('7303195633629033586');" style=""> 134     public void authorize(                                                                               </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 135             String issuer,                                                                               </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 136             final String redirectUrl,                                                                    </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 137             final String clientId,                                                                       </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 138             final String clientSecret,                                                                   </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 139             final ReadableArray scopes,                                                                  </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 140             final ReadableMap additionalParameters,                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 141             final ReadableMap serviceConfiguration,                                                      </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 142             final Boolean usePKCE,                                                                       </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 143             final String clientAuthMethod,                                                               </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 144             final Boolean dangerouslyAllowInsecureHttpRequests,                                          </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 145             final ReadableMap headers,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 146             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 147     ) {                                                                                                  </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 148         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title=" 149         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);"> 149         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="3019383581923708916" onmouseenter="enter('3019383581923708916');" onmouseout="out('3019383581923708916');" style=""> 150         final AppAuthConfiguration appAuthConfiguration = this.createAppAuthConfiguration(builder);      </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 151         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 151         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span  style=""> 152                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 153         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 154             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155         }                                                                                                </span>
<span  style=""> 156                                                                                                          </span>
<span class="5192680332872896216" onmouseenter="enter('5192680332872896216');" onmouseout="out('5192680332872896216');" style=""> 157         // store args in private fields for later use in onActivityResult handler                        </span>
<span class="-4922073825750036997" onmouseenter="enter('-4922073825750036997');" onmouseout="out('-4922073825750036997');" style=""> 158         this.promise = promise;                                                                          </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 159         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 160         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span class="-8734683050201249921" onmouseenter="enter('-8734683050201249921');" onmouseout="out('-8734683050201249921');" style=""> 161         this.clientSecret = clientSecret;                                                                </span>
<span class="3270519662544404418" onmouseenter="enter('3270519662544404418');" onmouseout="out('3270519662544404418');" style=""> 162         this.clientAuthMethod = clientAuthMethod;                                                        </span>
<span  style=""> 163                                                                                                          </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 164         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 164         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 165         if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 166             try {                                                                                        </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 167                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 167                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != nu🔵</abbr></span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 168                 authorizeWithConfiguration(                                                              </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 169                         serviceConfig,                                                                   </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 170                         appAuthConfiguration,                                                            </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 171                         clientId,                                                                        </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 172                         scopes,                                                                          </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 173                         redirectUrl,                                                                     </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 174                         usePKCE,                                                                         </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 175                         additionalParametersMap                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 176                 );                                                                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 177             } catch (Exception e) {                                                                      </span>
<span class="-3857326443207234519" onmouseenter="enter('-3857326443207234519');" onmouseout="out('-3857326443207234519');" style=""> 178                 promise.reject(&quot;authentication_failed&quot;, e.getMessage());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 181             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 182             AuthorizationServiceConfiguration.fetchFromUrl(                                              </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 183                     buildConfigurationUriFromIssuer(issuerUri),                                          </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 184                     new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {              </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 185                         public void onFetchConfigurationCompleted(                                       </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 186                                 @Nullable AuthorizationServiceConfiguration fetchedConfiguration,        </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 187                                 @Nullable AuthorizationException ex) {                                   </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 188                             if (ex != null) {                                                            </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 189                                 promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));</span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 190                                 return;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                             }                                                                            </span>
<span  style=""> 192                                                                                                          </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 193                             mServiceConfiguration.set(fetchedConfiguration);                             </span>
<span  style=""> 194                                                                                                          </span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 195                             authorizeWithConfiguration(                                                  </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 196                                     fetchedConfiguration,                                                </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 197                                     appAuthConfiguration,                                                </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 198                                     clientId,                                                            </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 199                                     scopes,                                                              </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 200                                     redirectUrl,                                                         </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 201                                     usePKCE,                                                             </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 202                                     additionalParametersMap                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 203                             );                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204                         }                                                                                </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 205                     },                                                                                   </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 206                     builder                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 207             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208         }                                                                                                </span>
<span  style=""> 209                                                                                                          </span>
<span  style=""> 210                                                                                                          </span>
<span  style=""> 211                                                                                                          </span>
<span  style=""> 212                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 215     @ReactMethod                                                                                         </span>
<span class="-5238780499530126703" onmouseenter="enter('-5238780499530126703');" onmouseout="out('-5238780499530126703');" style=""> 216     public void refresh(                                                                                 </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 217             String issuer,                                                                               </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 218             final String redirectUrl,                                                                    </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 219             final String clientId,                                                                       </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 220             final String clientSecret,                                                                   </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 221             final String refreshToken,                                                                   </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 222             final ReadableArray scopes,                                                                  </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 223             final ReadableMap additionalParameters,                                                      </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 224             final ReadableMap serviceConfiguration,                                                      </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 225             final String clientAuthMethod,                                                               </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 226             final Boolean dangerouslyAllowInsecureHttpRequests,                                          </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 227             final ReadableMap headers,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 228             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 229     ) {                                                                                                  </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 230         this.parseHeaderMap(headers);                                                                    </span>
<span class="5750510513523473374" onmouseenter="enter('5750510513523473374');" onmouseout="out('5750510513523473374');" style=""><abbr title=" 231         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders);"> 231         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="-7964591588332866161" onmouseenter="enter('-7964591588332866161');" onmouseout="out('-7964591588332866161');" style=""> 232         final AppAuthConfiguration appAuthConfiguration = createAppAuthConfiguration(builder);           </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 233         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 233         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span  style=""> 234                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 235         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 236             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237         }                                                                                                </span>
<span  style=""> 238                                                                                                          </span>
<span class="1495748746185505707" onmouseenter="enter('1495748746185505707');" onmouseout="out('1495748746185505707');" style=""> 239         // store setting in private field for later use in onActivityResult handler                      </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 240         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 241         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span  style=""> 242                                                                                                          </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 243         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 243         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 244         if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 245             try {                                                                                        </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 246                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 246                 final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != nu🔵</abbr></span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 247                 refreshWithConfiguration(                                                                </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 248                         serviceConfig,                                                                   </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 249                         appAuthConfiguration,                                                            </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 250                         refreshToken,                                                                    </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 251                         clientId,                                                                        </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 252                         scopes,                                                                          </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 253                         redirectUrl,                                                                     </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 254                         additionalParametersMap,                                                         </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 255                         clientAuthMethod,                                                                </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 256                         clientSecret,                                                                    </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 257                         promise                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 258                 );                                                                                       </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 259             } catch (Exception e) {                                                                      </span>
<span class="7513248397060081198" onmouseenter="enter('7513248397060081198');" onmouseout="out('7513248397060081198');" style=""> 260                 promise.reject(&quot;token_refresh_failed&quot;, e.getMessage());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 263             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 264             AuthorizationServiceConfiguration.fetchFromUrl(                                              </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 265                     buildConfigurationUriFromIssuer(issuerUri),                                          </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 266                     new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {              </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 267                         public void onFetchConfigurationCompleted(                                       </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 268                                 @Nullable AuthorizationServiceConfiguration fetchedConfiguration,        </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 269                                 @Nullable AuthorizationException ex) {                                   </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 270                             if (ex != null) {                                                            </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 271                                 promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));</span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 272                                 return;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273                             }                                                                            </span>
<span  style=""> 274                                                                                                          </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 275                             mServiceConfiguration.set(fetchedConfiguration);                             </span>
<span  style=""> 276                                                                                                          </span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 277                             refreshWithConfiguration(                                                    </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 278                                     fetchedConfiguration,                                                </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 279                                     appAuthConfiguration,                                                </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 280                                     refreshToken,                                                        </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 281                                     clientId,                                                            </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 282                                     scopes,                                                              </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 283                                     redirectUrl,                                                         </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 284                                     additionalParametersMap,                                             </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 285                                     clientAuthMethod,                                                    </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 286                                     clientSecret,                                                        </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 287                                     promise                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 288                             );                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289                         }                                                                                </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 290                     },                                                                                   </span>
<span class="2680658541157360392" onmouseenter="enter('2680658541157360392');" onmouseout="out('2680658541157360392');" style=""> 291                     builder);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292         }                                                                                                </span>
<span  style=""> 293                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 296     /*                                                                                                   </span>
<span class="7578951324193379805" onmouseenter="enter('7578951324193379805');" onmouseout="out('7578951324193379805');" style=""> 297      * Called when the OAuth browser activity completes                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 298      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 299     @Override                                                                                            </span>
<span class="2027722410160164989" onmouseenter="enter('2027722410160164989');" onmouseout="out('2027722410160164989');" style=""> 300     public void onActivityResult(Activity activity, int requestCode, int resultCode, Intent data) {      </span>
<span class="-4639597857217913430" onmouseenter="enter('-4639597857217913430');" onmouseout="out('-4639597857217913430');" style=""> 301         if (requestCode == 0) {                                                                          </span>
<span class="-5203356024335682166" onmouseenter="enter('-5203356024335682166');" onmouseout="out('-5203356024335682166');" style=""> 302             if (data == null) {                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 303 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 304                 if (promise != null) {                                                                   </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 305                     promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 306                 }                                                                                        </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 307 ||||||| BASE                                                                                             </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                 promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310             }                                                                                            </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 311 =======                                                                                                  </span>
<span class="2268968836554739893" onmouseenter="enter('2268968836554739893');" onmouseout="out('2268968836554739893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312                 promise.reject(&quot;authentication_error&quot;, &quot;Data intent is null&quot; );                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 313 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 314                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span  style=""> 316                                                                                                          </span>
<span class="1683167759369238332" onmouseenter="enter('1683167759369238332');" onmouseout="out('1683167759369238332');" style=""> 317             final AuthorizationResponse response = AuthorizationResponse.fromIntent(data);               </span>
<span class="-2661429536108932642" onmouseenter="enter('-2661429536108932642');" onmouseout="out('-2661429536108932642');" style=""> 318             AuthorizationException exception = AuthorizationException.fromIntent(data);                  </span>
<span class="812069196179346176" onmouseenter="enter('812069196179346176');" onmouseout="out('812069196179346176');" style=""> 319             if (exception != null) {                                                                     </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 320 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 321                 if (promise != null) {                                                                   </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 322                     promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 323                 }                                                                                        </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 324 ||||||| BASE                                                                                             </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325                 promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328                                                                                                          </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329             final Promise authorizePromise = this.promise;                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 330 =======                                                                                                  </span>
<span class="8302975562867231827" onmouseenter="enter('8302975562867231827');" onmouseout="out('8302975562867231827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331                 promise.reject(&quot;authentication_error&quot;, getErrorMessage(exception));                      </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 332 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 333                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334             }                                                                                            </span>
<span  style=""> 335                                                                                                          </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style=""> 336             final Promise authorizePromise = this.promise;                                               </span>
<span class="5853075131485496752" onmouseenter="enter('5853075131485496752');" onmouseout="out('5853075131485496752');" style=""> 337             final AppAuthConfiguration configuration = createAppAuthConfiguration(                       </span>
<span class="-3586276280695435831" onmouseenter="enter('-3586276280695435831');" onmouseout="out('-3586276280695435831');" style=""><abbr title=" 338                     createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders)"> 338                     createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestH🔵</abbr></span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 339             );                                                                                           </span>
<span  style=""> 340                                                                                                          </span>
<span class="-598339291394324639" onmouseenter="enter('-598339291394324639');" onmouseout="out('-598339291394324639');" style=""><abbr title=" 341             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration);"> 341             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration)🔵</abbr></span>
<span  style=""> 342                                                                                                          </span>
<span class="6152215567678252770" onmouseenter="enter('6152215567678252770');" onmouseout="out('6152215567678252770');" style=""><abbr title=" 343             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap);"> 343             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap)🔵</abbr></span>
<span  style=""> 344                                                                                                          </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 345             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 345             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.T🔵</abbr></span>
<span  style=""> 346                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 347                 @Override                                                                                </span>
<span class="-8262795349130604582" onmouseenter="enter('-8262795349130604582');" onmouseout="out('-8262795349130604582');" style=""> 348                 public void onTokenRequestCompleted(                                                     </span>
<span class="5619805881636115456" onmouseenter="enter('5619805881636115456');" onmouseout="out('5619805881636115456');" style=""> 349                         TokenResponse resp, AuthorizationException ex) {                                 </span>
<span class="7476284757153148856" onmouseenter="enter('7476284757153148856');" onmouseout="out('7476284757153148856');" style=""> 350                     if (resp != null) {                                                                  </span>
<span class="7607526798956663360" onmouseenter="enter('7607526798956663360');" onmouseout="out('7607526798956663360');" style=""> 351                         WritableMap map = TokenResponseFactory.tokenResponseToMap(resp, response);       </span>
<span class="-6045783056504489326" onmouseenter="enter('-6045783056504489326');" onmouseout="out('-6045783056504489326');" style=""> 352                         if (authorizePromise != null) {                                                  </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style=""> 353                         authorizePromise.resolve(map);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 355                     } else {                                                                             </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 356 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 357                         if (promise != null) {                                                           </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 358                             promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 359 ||||||| BASE                                                                                             </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360                         promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362                 }                                                                                        </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363             };                                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364                                                                                                          </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365             if (this.clientSecret != null) {                                                             </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 366                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 366                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.cl🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367                 authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 368 =======                                                                                                  </span>
<span class="-1873248496991044419" onmouseenter="enter('-1873248496991044419');" onmouseout="out('-1873248496991044419');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369                         promise.reject(&quot;token_exchange_failed&quot;, getErrorMessage(ex));                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 370 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373                 }                                                                                        </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 374             };                                                                                           </span>
<span  style=""> 375                                                                                                          </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style=""> 376             if (this.clientSecret != null) {                                                             </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style=""><abbr title=" 377                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 377                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.cl🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 378                 authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);        </span>
<span  style=""> 379                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 380             } else {                                                                                     </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 381                 authService.performTokenRequest(tokenRequest, tokenResponseCallback);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382             }                                                                                            </span>
<span  style=""> 383                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385     }                                                                                                    </span>
<span  style=""> 386                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 387     /*                                                                                                   </span>
<span class="-3037424821439688076" onmouseenter="enter('-3037424821439688076');" onmouseout="out('-3037424821439688076');" style=""> 388      * Authorize user with the provided configuration                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 389      */                                                                                                  </span>
<span class="-1686698148972257501" onmouseenter="enter('-1686698148972257501');" onmouseout="out('-1686698148972257501');" style=""> 390     private void authorizeWithConfiguration(                                                             </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 391             final AuthorizationServiceConfiguration serviceConfiguration,                                </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 392             final AppAuthConfiguration appAuthConfiguration,                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 393             final String clientId,                                                                       </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 394             final ReadableArray scopes,                                                                  </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 395             final String redirectUrl,                                                                    </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 396             final Boolean usePKCE,                                                                       </span>
<span class="4591131233701235058" onmouseenter="enter('4591131233701235058');" onmouseout="out('4591131233701235058');" style=""> 397             final Map&lt;String, String&gt; additionalParametersMap                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 398     ) {                                                                                                  </span>
<span  style=""> 399                                                                                                          </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 400         String scopesString = null;                                                                      </span>
<span  style=""> 401                                                                                                          </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 402         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 403             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404         }                                                                                                </span>
<span  style=""> 405                                                                                                          </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 406         final Context context = this.reactContext;                                                       </span>
<span class="-4913832152651687292" onmouseenter="enter('-4913832152651687292');" onmouseout="out('-4913832152651687292');" style=""> 407         final Activity currentActivity = getCurrentActivity();                                           </span>
<span  style=""> 408                                                                                                          </span>
<span class="1615045173536817183" onmouseenter="enter('1615045173536817183');" onmouseout="out('1615045173536817183');" style=""> 409         AuthorizationRequest.Builder authRequestBuilder =                                                </span>
<span class="8630572254279098967" onmouseenter="enter('8630572254279098967');" onmouseout="out('8630572254279098967');" style=""> 410                 new AuthorizationRequest.Builder(                                                        </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 411                         serviceConfiguration,                                                            </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 412                         clientId,                                                                        </span>
<span class="4849618716626806999" onmouseenter="enter('4849618716626806999');" onmouseout="out('4849618716626806999');" style=""> 413                         ResponseTypeValues.CODE,                                                         </span>
<span class="-1639145692422133689" onmouseenter="enter('-1639145692422133689');" onmouseout="out('-1639145692422133689');" style=""> 414                         Uri.parse(redirectUrl)                                                           </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 415                 );                                                                                       </span>
<span  style=""> 416                                                                                                          </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 417         if (scopesString != null) {                                                                      </span>
<span class="-8218576309450527961" onmouseenter="enter('-8218576309450527961');" onmouseout="out('-8218576309450527961');" style=""> 418             authRequestBuilder.setScope(scopesString);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419         }                                                                                                </span>
<span  style=""> 420                                                                                                          </span>
<span  style=""> 421                                                                                                          </span>
<span class="7149068665077353053" onmouseenter="enter('7149068665077353053');" onmouseout="out('7149068665077353053');" style=""> 422         if (additionalParametersMap != null) {                                                           </span>
<span class="-6137327941719445172" onmouseenter="enter('-6137327941719445172');" onmouseout="out('-6137327941719445172');" style=""> 423             // handle additional parameters separately to avoid exceptions from AppAuth                  </span>
<span class="-4729676460784236302" onmouseenter="enter('-4729676460784236302');" onmouseout="out('-4729676460784236302');" style=""> 424             if (additionalParametersMap.containsKey(&quot;display&quot;)) {                                        </span>
<span class="6740086842281271815" onmouseenter="enter('6740086842281271815');" onmouseout="out('6740086842281271815');" style=""> 425                 authRequestBuilder.setDisplay(additionalParametersMap.get(&quot;display&quot;));                   </span>
<span class="5478676394718524231" onmouseenter="enter('5478676394718524231');" onmouseout="out('5478676394718524231');" style=""> 426                 additionalParametersMap.remove(&quot;display&quot;);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427             }                                                                                            </span>
<span class="-5162308638975991351" onmouseenter="enter('-5162308638975991351');" onmouseout="out('-5162308638975991351');" style=""> 428             if (additionalParametersMap.containsKey(&quot;login_hint&quot;)) {                                     </span>
<span class="7478322337196261432" onmouseenter="enter('7478322337196261432');" onmouseout="out('7478322337196261432');" style=""> 429                 authRequestBuilder.setLoginHint(additionalParametersMap.get(&quot;login_hint&quot;));              </span>
<span class="-3825577662921277200" onmouseenter="enter('-3825577662921277200');" onmouseout="out('-3825577662921277200');" style=""> 430                 additionalParametersMap.remove(&quot;login_hint&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431             }                                                                                            </span>
<span class="-8254180626457365202" onmouseenter="enter('-8254180626457365202');" onmouseout="out('-8254180626457365202');" style=""> 432             if (additionalParametersMap.containsKey(&quot;prompt&quot;)) {                                         </span>
<span class="2585369211918110761" onmouseenter="enter('2585369211918110761');" onmouseout="out('2585369211918110761');" style=""> 433                 authRequestBuilder.setPrompt(additionalParametersMap.get(&quot;prompt&quot;));                     </span>
<span class="290019989822766287" onmouseenter="enter('290019989822766287');" onmouseout="out('290019989822766287');" style=""> 434                 additionalParametersMap.remove(&quot;prompt&quot;);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435             }                                                                                            </span>
<span  style=""> 436                                                                                                          </span>
<span class="-1433627721318603910" onmouseenter="enter('-1433627721318603910');" onmouseout="out('-1433627721318603910');" style=""> 437             authRequestBuilder.setAdditionalParameters(additionalParametersMap);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438         }                                                                                                </span>
<span  style=""> 439                                                                                                          </span>
<span class="6295746505532947076" onmouseenter="enter('6295746505532947076');" onmouseout="out('6295746505532947076');" style=""> 440         if (!usePKCE) {                                                                                  </span>
<span class="211047115781987373" onmouseenter="enter('211047115781987373');" onmouseout="out('211047115781987373');" style=""> 441             authRequestBuilder.setCodeVerifier(null);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442         }                                                                                                </span>
<span  style=""> 443                                                                                                          </span>
<span class="2874496759892237047" onmouseenter="enter('2874496759892237047');" onmouseout="out('2874496759892237047');" style=""> 444         AuthorizationRequest authRequest = authRequestBuilder.build();                                   </span>
<span  style=""> 445                                                                                                          </span>
<span class="4248167488592758879" onmouseenter="enter('4248167488592758879');" onmouseout="out('4248167488592758879');" style=""> 446         if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.LOLLIPOP) {               </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 447             AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);  </span>
<span class="-8712988972948484879" onmouseenter="enter('-8712988972948484879');" onmouseout="out('-8712988972948484879');" style=""> 448             Intent authIntent = authService.getAuthorizationRequestIntent(authRequest);                  </span>
<span  style=""> 449                                                                                                          </span>
<span class="-1768672139093830544" onmouseenter="enter('-1768672139093830544');" onmouseout="out('-1768672139093830544');" style=""> 450             currentActivity.startActivityForResult(authIntent, 0);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 451         } else {                                                                                         </span>
<span class="-5574677103641269793" onmouseenter="enter('-5574677103641269793');" onmouseout="out('-5574677103641269793');" style=""><abbr title=" 452             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfiguration);"> 452             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfigura🔵</abbr></span>
<span class="-921350943484849229" onmouseenter="enter('-921350943484849229');" onmouseout="out('-921350943484849229');" style=""> 453             PendingIntent pendingIntent = currentActivity.createPendingResult(0, new Intent(), 0);       </span>
<span  style=""> 454                                                                                                          </span>
<span class="5462088869311657545" onmouseenter="enter('5462088869311657545');" onmouseout="out('5462088869311657545');" style=""> 455             authService.performAuthorizationRequest(authRequest, pendingIntent);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457     }                                                                                                    </span>
<span  style=""> 458                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 459     /*                                                                                                   </span>
<span class="8814346366745541198" onmouseenter="enter('8814346366745541198');" onmouseout="out('8814346366745541198');" style=""> 460      * Refresh authentication token with the provided configuration                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 461      */                                                                                                  </span>
<span class="-7235916799046070057" onmouseenter="enter('-7235916799046070057');" onmouseout="out('-7235916799046070057');" style=""> 462     private void refreshWithConfiguration(                                                               </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 463             final AuthorizationServiceConfiguration serviceConfiguration,                                </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 464             final AppAuthConfiguration appAuthConfiguration,                                             </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 465             final String refreshToken,                                                                   </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 466             final String clientId,                                                                       </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 467             final ReadableArray scopes,                                                                  </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 468             final String redirectUrl,                                                                    </span>
<span class="3078994421067824649" onmouseenter="enter('3078994421067824649');" onmouseout="out('3078994421067824649');" style=""> 469             final Map&lt;String, String&gt; additionalParametersMap,                                           </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 470             final String clientAuthMethod,                                                               </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 471             final String clientSecret,                                                                   </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 472             final Promise promise                                                                        </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 473     ) {                                                                                                  </span>
<span  style=""> 474                                                                                                          </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 475         String scopesString = null;                                                                      </span>
<span  style=""> 476                                                                                                          </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 477         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 478             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 479         }                                                                                                </span>
<span  style=""> 480                                                                                                          </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 481         final Context context = this.reactContext;                                                       </span>
<span  style=""> 482                                                                                                          </span>
<span class="-1882592220700818910" onmouseenter="enter('-1882592220700818910');" onmouseout="out('-1882592220700818910');" style=""> 483         TokenRequest.Builder tokenRequestBuilder =                                                       </span>
<span class="-7570030938974274508" onmouseenter="enter('-7570030938974274508');" onmouseout="out('-7570030938974274508');" style=""> 484                 new TokenRequest.Builder(                                                                </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 485                         serviceConfiguration,                                                            </span>
<span class="-3028793166139754818" onmouseenter="enter('-3028793166139754818');" onmouseout="out('-3028793166139754818');" style=""> 486                         clientId                                                                         </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 487                 )                                                                                        </span>
<span class="5149869235939087614" onmouseenter="enter('5149869235939087614');" onmouseout="out('5149869235939087614');" style=""> 488                         .setRefreshToken(refreshToken)                                                   </span>
<span class="-4168308848344323961" onmouseenter="enter('-4168308848344323961');" onmouseout="out('-4168308848344323961');" style=""> 489                         .setRedirectUri(Uri.parse(redirectUrl));                                         </span>
<span  style=""> 490                                                                                                          </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 491         if (scopesString != null) {                                                                      </span>
<span class="-4940100242303343354" onmouseenter="enter('-4940100242303343354');" onmouseout="out('-4940100242303343354');" style=""> 492             tokenRequestBuilder.setScope(scopesString);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493         }                                                                                                </span>
<span  style=""> 494                                                                                                          </span>
<span class="1982926752875631058" onmouseenter="enter('1982926752875631058');" onmouseout="out('1982926752875631058');" style=""> 495         if (!additionalParametersMap.isEmpty()) {                                                        </span>
<span class="6791703352530289305" onmouseenter="enter('6791703352530289305');" onmouseout="out('6791703352530289305');" style=""> 496             tokenRequestBuilder.setAdditionalParameters(additionalParametersMap);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 497         }                                                                                                </span>
<span  style=""> 498                                                                                                          </span>
<span class="6300215370198990899" onmouseenter="enter('6300215370198990899');" onmouseout="out('6300215370198990899');" style=""> 499         TokenRequest tokenRequest = tokenRequestBuilder.build();                                         </span>
<span  style=""> 500                                                                                                          </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 501         AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);      </span>
<span  style=""> 502                                                                                                          </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 503         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 503         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.Token🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 504             @Override                                                                                    </span>
<span class="-9019017716153453132" onmouseenter="enter('-9019017716153453132');" onmouseout="out('-9019017716153453132');" style=""><abbr title=" 505             public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException ex) {"> 505             public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable Authorization🔵</abbr></span>
<span class="4756227728171050519" onmouseenter="enter('4756227728171050519');" onmouseout="out('4756227728171050519');" style=""> 506                 if (response != null) {                                                                  </span>
<span class="-4071880271889138129" onmouseenter="enter('-4071880271889138129');" onmouseout="out('-4071880271889138129');" style=""> 507                     WritableMap map = TokenResponseFactory.tokenResponseToMap(response);                 </span>
<span class="9181054552595447887" onmouseenter="enter('9181054552595447887');" onmouseout="out('9181054552595447887');" style=""> 508                     promise.resolve(map);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 509                 } else {                                                                                 </span>
<span class="-8974399670180994057" onmouseenter="enter('-8974399670180994057');" onmouseout="out('-8974399670180994057');" style=""> 510                     promise.reject(&quot;token_refresh_failed&quot;, getErrorMessage(ex));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 511                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 513         };                                                                                               </span>
<span  style=""> 514                                                                                                          </span>
<span  style=""> 515                                                                                                          </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 516         if (clientSecret != null) {                                                                      </span>
<span class="-3955443834186652225" onmouseenter="enter('-3955443834186652225');" onmouseout="out('-3955443834186652225');" style=""><abbr title=" 517             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod);"> 517             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 518             authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);            </span>
<span  style=""> 519                                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 520         } else {                                                                                         </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 521             authService.performTokenRequest(tokenRequest, tokenResponseCallback);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523     }                                                                                                    </span>
<span  style=""> 524                                                                                                          </span>
<span class="2930218534777413873" onmouseenter="enter('2930218534777413873');" onmouseout="out('2930218534777413873');" style=""> 525     private void parseHeaderMap (ReadableMap headerMap) {                                                </span>
<span class="-6316489241675673035" onmouseenter="enter('-6316489241675673035');" onmouseout="out('-6316489241675673035');" style=""> 526         if (headerMap == null) {                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 527             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528         }                                                                                                </span>
<span class="-8530407112624237580" onmouseenter="enter('-8530407112624237580');" onmouseout="out('-8530407112624237580');" style=""> 529         if (headerMap.hasKey(&quot;authorize&quot;) &amp;&amp; headerMap.getType(&quot;authorize&quot;) == ReadableType.Map) {       </span>
<span class="762039099095363738" onmouseenter="enter('762039099095363738');" onmouseout="out('762039099095363738');" style=""><abbr title=" 530             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;));"> 530             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531         }                                                                                                </span>
<span class="5768179141818569002" onmouseenter="enter('5768179141818569002');" onmouseout="out('5768179141818569002');" style=""> 532         if (headerMap.hasKey(&quot;token&quot;) &amp;&amp; headerMap.getType(&quot;token&quot;) == ReadableType.Map) {               </span>
<span class="-4870803436115877491" onmouseenter="enter('-4870803436115877491');" onmouseout="out('-4870803436115877491');" style=""> 533             this.tokenRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;token&quot;));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 534         }                                                                                                </span>
<span  style=""> 535                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 536     }                                                                                                    </span>
<span  style=""> 537                                                                                                          </span>
<span class="-2276636657842571599" onmouseenter="enter('-2276636657842571599');" onmouseout="out('-2276636657842571599');" style=""> 538     private ClientAuthentication getClientAuthentication(String clientSecret, String clientAuthMethod) { </span>
<span class="4736948393768361142" onmouseenter="enter('4736948393768361142');" onmouseout="out('4736948393768361142');" style=""> 539         if (clientAuthMethod.equals(&quot;post&quot;)) {                                                           </span>
<span class="4033722210949459980" onmouseenter="enter('4033722210949459980');" onmouseout="out('4033722210949459980');" style=""> 540             return new ClientSecretPost(clientSecret);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541         }                                                                                                </span>
<span  style=""> 542                                                                                                          </span>
<span class="-1107687855860572488" onmouseenter="enter('-1107687855860572488');" onmouseout="out('-1107687855860572488');" style=""> 543         return new ClientSecretBasic(clientSecret);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544     }                                                                                                    </span>
<span  style=""> 545                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 546     /*                                                                                                   </span>
<span class="5090378039448834807" onmouseenter="enter('5090378039448834807');" onmouseout="out('5090378039448834807');" style=""> 547      * Return error information if it is available                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 548      */                                                                                                  </span>
<span class="7325111704754615468" onmouseenter="enter('7325111704754615468');" onmouseout="out('7325111704754615468');" style=""> 549     private String getErrorMessage(AuthorizationException ex){                                           </span>
<span class="6233744395473659458" onmouseenter="enter('6233744395473659458');" onmouseout="out('6233744395473659458');" style=""> 550         if(ex.errorDescription == null &amp;&amp; ex.error != null)                                              </span>
<span class="8212520076730053042" onmouseenter="enter('8212520076730053042');" onmouseout="out('8212520076730053042');" style=""> 551             return ex.error;                                                                             </span>
<span class="-944119096152079377" onmouseenter="enter('-944119096152079377');" onmouseout="out('-944119096152079377');" style=""> 552         return ex.errorDescription;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 553     }                                                                                                    </span>
<span  style=""> 554                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 555     /*                                                                                                   </span>
<span class="6638112631744326921" onmouseenter="enter('6638112631744326921');" onmouseout="out('6638112631744326921');" style=""> 556      * Create a space-delimited string from an array                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 557      */                                                                                                  </span>
<span class="2843730177292313139" onmouseenter="enter('2843730177292313139');" onmouseout="out('2843730177292313139');" style=""> 558     private String arrayToString(ReadableArray array) {                                                  </span>
<span class="-8236782342056480869" onmouseenter="enter('-8236782342056480869');" onmouseout="out('-8236782342056480869');" style=""> 559         StringBuilder strBuilder = new StringBuilder();                                                  </span>
<span class="7278311890620727475" onmouseenter="enter('7278311890620727475');" onmouseout="out('7278311890620727475');" style=""> 560         for (int i = 0; i &lt; array.size(); i++) {                                                         </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style=""> 561             if (i != 0) {                                                                                </span>
<span class="-4449242394605741248" onmouseenter="enter('-4449242394605741248');" onmouseout="out('-4449242394605741248');" style=""> 562                 strBuilder.append(&#x27; &#x27;);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563             }                                                                                            </span>
<span class="-8205116312766504963" onmouseenter="enter('-8205116312766504963');" onmouseout="out('-8205116312766504963');" style=""> 564             strBuilder.append(array.getString(i));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565         }                                                                                                </span>
<span class="-7597052729024482685" onmouseenter="enter('-7597052729024482685');" onmouseout="out('-7597052729024482685');" style=""> 566         return strBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 569     /*                                                                                                   </span>
<span class="5214794569700518887" onmouseenter="enter('5214794569700518887');" onmouseout="out('5214794569700518887');" style=""> 570      * Create an App Auth configuration using the provided connection builder                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 571      */                                                                                                  </span>
<span class="-5342361748775304563" onmouseenter="enter('-5342361748775304563');" onmouseout="out('-5342361748775304563');" style=""> 572     private AppAuthConfiguration createAppAuthConfiguration(ConnectionBuilder connectionBuilder) {       </span>
<span class="-6961363017801118708" onmouseenter="enter('-6961363017801118708');" onmouseout="out('-6961363017801118708');" style=""> 573         return new AppAuthConfiguration                                                                  </span>
<span class="370567544488026574" onmouseenter="enter('370567544488026574');" onmouseout="out('370567544488026574');" style=""> 574                 .Builder()                                                                               </span>
<span class="6932817517014214209" onmouseenter="enter('6932817517014214209');" onmouseout="out('6932817517014214209');" style=""> 575                 .setConnectionBuilder(connectionBuilder)                                                 </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 576                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577     }                                                                                                    </span>
<span  style=""> 578                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 579     /*                                                                                                   </span>
<span class="2307564597312892215" onmouseenter="enter('2307564597312892215');" onmouseout="out('2307564597312892215');" style=""> 580      *  Create appropriate connection builder based on provided settings                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 581      */                                                                                                  </span>
<span class="-266307560690147004" onmouseenter="enter('-266307560690147004');" onmouseout="out('-266307560690147004');" style=""><abbr title=" 582     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; headers) {"> 582     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, Strin🔵</abbr></span>
<span class="7318015076305824949" onmouseenter="enter('7318015076305824949');" onmouseout="out('7318015076305824949');" style=""> 583         ConnectionBuilder proxiedBuilder;                                                                </span>
<span  style=""> 584                                                                                                          </span>
<span class="-6214248404965356101" onmouseenter="enter('-6214248404965356101');" onmouseout="out('-6214248404965356101');" style=""> 585         if (allowInsecureConnections.equals(true)) {                                                     </span>
<span class="-8652069864919613967" onmouseenter="enter('-8652069864919613967');" onmouseout="out('-8652069864919613967');" style=""> 586             proxiedBuilder =UnsafeConnectionBuilder.INSTANCE;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 587         } else {                                                                                         </span>
<span class="-3823294731313489124" onmouseenter="enter('-3823294731313489124');" onmouseout="out('-3823294731313489124');" style=""> 588             proxiedBuilder = DefaultConnectionBuilder.INSTANCE;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589         }                                                                                                </span>
<span  style=""> 590                                                                                                          </span>
<span class="-321326358809916252" onmouseenter="enter('-321326358809916252');" onmouseout="out('-321326358809916252');" style=""> 591         CustomConnectionBuilder customConnection = new CustomConnectionBuilder(proxiedBuilder);          </span>
<span class="-5872856843685271172" onmouseenter="enter('-5872856843685271172');" onmouseout="out('-5872856843685271172');" style=""> 592         if (headers != null) {                                                                           </span>
<span class="-4120878389218127223" onmouseenter="enter('-4120878389218127223');" onmouseout="out('-4120878389218127223');" style=""> 593             customConnection.setHeaders(headers);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594         }                                                                                                </span>
<span  style=""> 595                                                                                                          </span>
<span class="5629827582834827587" onmouseenter="enter('5629827582834827587');" onmouseout="out('5629827582834827587');" style=""> 596         return customConnection;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597     }                                                                                                    </span>
<span  style=""> 598                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 599     /*                                                                                                   </span>
<span class="9187662928809351886" onmouseenter="enter('9187662928809351886');" onmouseout="out('9187662928809351886');" style=""> 600      *  Replicated private method from AuthorizationServiceConfiguration                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 601      */                                                                                                  </span>
<span class="2622836649973257205" onmouseenter="enter('2622836649973257205');" onmouseout="out('2622836649973257205');" style=""> 602     private Uri buildConfigurationUriFromIssuer(Uri openIdConnectIssuerUri) {                            </span>
<span class="-830811466431368071" onmouseenter="enter('-830811466431368071');" onmouseout="out('-830811466431368071');" style=""> 603         return openIdConnectIssuerUri.buildUpon()                                                        </span>
<span class="7258170423676519924" onmouseenter="enter('7258170423676519924');" onmouseout="out('7258170423676519924');" style=""> 604                 .appendPath(AuthorizationServiceConfiguration.WELL_KNOWN_PATH)                           </span>
<span class="-3903955623180377764" onmouseenter="enter('-3903955623180377764');" onmouseout="out('-3903955623180377764');" style=""> 605                 .appendPath(AuthorizationServiceConfiguration.OPENID_CONFIGURATION_RESOURCE)             </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 606                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607     }                                                                                                    </span>
<span  style=""> 608                                                                                                          </span>
<span class="3122274151060887299" onmouseenter="enter('3122274151060887299');" onmouseout="out('3122274151060887299');" style=""><abbr title=" 609     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfiguration) throws Exception {"> 609     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap service🔵</abbr></span>
<span class="4275545280692735139" onmouseenter="enter('4275545280692735139');" onmouseout="out('4275545280692735139');" style=""> 610         if (!serviceConfiguration.hasKey(&quot;authorizationEndpoint&quot;)) {                                     </span>
<span class="3986521017730318395" onmouseenter="enter('3986521017730318395');" onmouseout="out('3986521017730318395');" style=""> 611             throw new Exception(&quot;serviceConfiguration passed without an authorizationEndpoint&quot;);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 612         }                                                                                                </span>
<span  style=""> 613                                                                                                          </span>
<span class="5638598812511759739" onmouseenter="enter('5638598812511759739');" onmouseout="out('5638598812511759739');" style=""> 614         if (!serviceConfiguration.hasKey(&quot;tokenEndpoint&quot;)) {                                             </span>
<span class="7444064849592215652" onmouseenter="enter('7444064849592215652');" onmouseout="out('7444064849592215652');" style=""> 615             throw new Exception(&quot;serviceConfiguration passed without a tokenEndpoint&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 616         }                                                                                                </span>
<span  style=""> 617                                                                                                          </span>
<span class="-3941749567598770425" onmouseenter="enter('-3941749567598770425');" onmouseout="out('-3941749567598770425');" style=""> 618         Uri authorizationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;authorizationEndpoint&quot;));  </span>
<span class="4054930865548070446" onmouseenter="enter('4054930865548070446');" onmouseout="out('4054930865548070446');" style=""> 619         Uri tokenEndpoint = Uri.parse(serviceConfiguration.getString(&quot;tokenEndpoint&quot;));                  </span>
<span class="2264343622444418519" onmouseenter="enter('2264343622444418519');" onmouseout="out('2264343622444418519');" style=""> 620         Uri registrationEndpoint = null;                                                                 </span>
<span class="-4970643399788664483" onmouseenter="enter('-4970643399788664483');" onmouseout="out('-4970643399788664483');" style=""> 621         if (serviceConfiguration.hasKey(&quot;registrationEndpoint&quot;)) {                                       </span>
<span class="1609034589288005797" onmouseenter="enter('1609034589288005797');" onmouseout="out('1609034589288005797');" style=""> 622             registrationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;registrationEndpoint&quot;));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 623         }                                                                                                </span>
<span  style=""> 624                                                                                                          </span>
<span class="-8455698330779530293" onmouseenter="enter('-8455698330779530293');" onmouseout="out('-8455698330779530293');" style=""> 625         return new AuthorizationServiceConfiguration(                                                    </span>
<span class="-9206356706352718453" onmouseenter="enter('-9206356706352718453');" onmouseout="out('-9206356706352718453');" style=""> 626                 authorizationEndpoint,                                                                   </span>
<span class="-6119344076232034280" onmouseenter="enter('-6119344076232034280');" onmouseout="out('-6119344076232034280');" style=""> 627                 tokenEndpoint,                                                                           </span>
<span class="-4224958759407269631" onmouseenter="enter('-4224958759407269631');" onmouseout="out('-4224958759407269631');" style=""> 628                 registrationEndpoint                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 629         );                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 630     }                                                                                                    </span>
<span  style=""> 631                                                                                                          </span>
<span class="-4130257184876230563" onmouseenter="enter('-4130257184876230563');" onmouseout="out('-4130257184876230563');" style=""> 632     private void warmChromeCustomTab(Context context, final String issuer) {                             </span>
<span class="-4012796735492941375" onmouseenter="enter('-4012796735492941375');" onmouseout="out('-4012796735492941375');" style=""> 633         CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 634             @Override                                                                                    </span>
<span class="4306327880536035079" onmouseenter="enter('4306327880536035079');" onmouseout="out('4306327880536035079');" style=""> 635             public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {      </span>
<span class="-5035114608817725139" onmouseenter="enter('-5035114608817725139');" onmouseout="out('-5035114608817725139');" style=""> 636                 client.warmup(0);                                                                        </span>
<span class="5970961959698416627" onmouseenter="enter('5970961959698416627');" onmouseout="out('5970961959698416627');" style=""><abbr title=" 637                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bundle&gt;emptyList());"> 637                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collect🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 638             }                                                                                            </span>
<span  style=""> 639                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 640             @Override                                                                                    </span>
<span class="6231636659664649995" onmouseenter="enter('6231636659664649995');" onmouseout="out('6231636659664649995');" style=""> 641             public void onServiceDisconnected(ComponentName name) {                                      </span>
<span  style=""> 642                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 643             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 644         };                                                                                               </span>
<span class="5767142201781268255" onmouseenter="enter('5767142201781268255');" onmouseout="out('5767142201781268255');" style=""> 645         CustomTabsClient.bindCustomTabsService(context, CUSTOM_TAB_PACKAGE_NAME, connection);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 646     }                                                                                                    </span>
<span  style=""> 647                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 648     @Override                                                                                            </span>
<span class="-4337880705383881802" onmouseenter="enter('-4337880705383881802');" onmouseout="out('-4337880705383881802');" style=""> 649     public void onNewIntent(Intent intent) {                                                             </span>
<span  style=""> 650                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651     }                                                                                                    </span>
<span  style=""> 652                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 653     @Override                                                                                            </span>
<span class="190238665005496725" onmouseenter="enter('190238665005496725');" onmouseout="out('190238665005496725');" style=""> 654     public String getName() {                                                                            </span>
<span class="4315075324919368681" onmouseenter="enter('4315075324919368681');" onmouseout="out('4315075324919368681');" style=""> 655         return &quot;RNAppAuth&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 656     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 657 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-6280296900167357794" onmouseenter="enter('-6280296900167357794');" onmouseout="out('-6280296900167357794');" style="">   1 package com.rnappauth;                                                                                   </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="2265467446931963889" onmouseenter="enter('2265467446931963889');" onmouseout="out('2265467446931963889');" style="">   4 import android.app.PendingIntent;                                                                        </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">   5 import android.content.ComponentName;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   6 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   7 import android.content.Intent;                                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   8 import android.net.Uri;                                                                                  </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   9 import android.os.Bundle;                                                                                </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10 import androidx.annotation.Nullable;                                                                     </span>
<span class="-4621922491292668474" onmouseenter="enter('-4621922491292668474');" onmouseout="out('-4621922491292668474');" style="">  11 import androidx.browser.customtabs.CustomTabsCallback;                                                   </span>
<span class="5786009149739133921" onmouseenter="enter('5786009149739133921');" onmouseout="out('5786009149739133921');" style="">  12 import androidx.browser.customtabs.CustomTabsClient;                                                     </span>
<span class="6730446154443378273" onmouseenter="enter('6730446154443378273');" onmouseout="out('6730446154443378273');" style="">  13 import androidx.browser.customtabs.CustomTabsServiceConnection;                                          </span>
<span class="7327608205307094785" onmouseenter="enter('7327608205307094785');" onmouseout="out('7327608205307094785');" style="">  14 import com.facebook.react.bridge.ActivityEventListener;                                                  </span>
<span class="-9114944870765420144" onmouseenter="enter('-9114944870765420144');" onmouseout="out('-9114944870765420144');" style="">  15 import com.facebook.react.bridge.Promise;                                                                </span>
<span class="1744055796152404290" onmouseenter="enter('1744055796152404290');" onmouseout="out('1744055796152404290');" style="">  16 import com.facebook.react.bridge.ReactApplicationContext;                                                </span>
<span class="7756046764634890677" onmouseenter="enter('7756046764634890677');" onmouseout="out('7756046764634890677');" style="">  17 import com.facebook.react.bridge.ReactContextBaseJavaModule;                                             </span>
<span class="-7062843866366665780" onmouseenter="enter('-7062843866366665780');" onmouseout="out('-7062843866366665780');" style="">  18 import com.facebook.react.bridge.ReactMethod;                                                            </span>
<span class="3666939786570277423" onmouseenter="enter('3666939786570277423');" onmouseout="out('3666939786570277423');" style="">  19 import com.facebook.react.bridge.ReadableArray;                                                          </span>
<span class="5552486474970006352" onmouseenter="enter('5552486474970006352');" onmouseout="out('5552486474970006352');" style="">  20 import com.facebook.react.bridge.ReadableMap;                                                            </span>
<span class="7507448895670758430" onmouseenter="enter('7507448895670758430');" onmouseout="out('7507448895670758430');" style="">  21 import com.facebook.react.bridge.ReadableType;                                                           </span>
<span class="-2689054124168074705" onmouseenter="enter('-2689054124168074705');" onmouseout="out('-2689054124168074705');" style="">  22 import com.facebook.react.bridge.WritableMap;                                                            </span>
<span class="-7309342380344421476" onmouseenter="enter('-7309342380344421476');" onmouseout="out('-7309342380344421476');" style="">  23 import com.rnappauth.utils.CustomConnectionBuilder;                                                      </span>
<span class="2824452556317040091" onmouseenter="enter('2824452556317040091');" onmouseout="out('2824452556317040091');" style="">  24 import com.rnappauth.utils.MapUtil;                                                                      </span>
<span class="5385195114029684108" onmouseenter="enter('5385195114029684108');" onmouseout="out('5385195114029684108');" style="">  25 import com.rnappauth.utils.TokenResponseFactory;                                                         </span>
<span class="2320112657500195094" onmouseenter="enter('2320112657500195094');" onmouseout="out('2320112657500195094');" style="">  26 import com.rnappauth.utils.UnsafeConnectionBuilder;                                                      </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  27 import java.util.Collections;                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  28 import java.util.HashMap;                                                                                </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  29 import java.util.Map;                                                                                    </span>
<span class="6937050046386248317" onmouseenter="enter('6937050046386248317');" onmouseout="out('6937050046386248317');" style="">  30 import java.util.concurrent.CountDownLatch;                                                              </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  31 import java.util.concurrent.atomic.AtomicReference;                                                      </span>
<span class="2084880808431135122" onmouseenter="enter('2084880808431135122');" onmouseout="out('2084880808431135122');" style="">  32 import net.openid.appauth.AppAuthConfiguration;                                                          </span>
<span class="-6153791587225110013" onmouseenter="enter('-6153791587225110013');" onmouseout="out('-6153791587225110013');" style="">  33 import net.openid.appauth.AuthorizationException;                                                        </span>
<span class="220855730882953420" onmouseenter="enter('220855730882953420');" onmouseout="out('220855730882953420');" style="">  34 import net.openid.appauth.AuthorizationRequest;                                                          </span>
<span class="3507212550601358175" onmouseenter="enter('3507212550601358175');" onmouseout="out('3507212550601358175');" style="">  35 import net.openid.appauth.AuthorizationResponse;                                                         </span>
<span class="6486087234581123017" onmouseenter="enter('6486087234581123017');" onmouseout="out('6486087234581123017');" style="">  36 import net.openid.appauth.AuthorizationService;                                                          </span>
<span class="-1918380963859750931" onmouseenter="enter('-1918380963859750931');" onmouseout="out('-1918380963859750931');" style="">  37 import net.openid.appauth.AuthorizationServiceConfiguration;                                             </span>
<span class="-1745886087889911862" onmouseenter="enter('-1745886087889911862');" onmouseout="out('-1745886087889911862');" style="">  38 import net.openid.appauth.ClientAuthentication;                                                          </span>
<span class="5802881313983385714" onmouseenter="enter('5802881313983385714');" onmouseout="out('5802881313983385714');" style="">  39 import net.openid.appauth.ClientSecretBasic;                                                             </span>
<span class="6044047429679939107" onmouseenter="enter('6044047429679939107');" onmouseout="out('6044047429679939107');" style="">  40 import net.openid.appauth.ClientSecretPost;                                                              </span>
<span class="-7057741429751790751" onmouseenter="enter('-7057741429751790751');" onmouseout="out('-7057741429751790751');" style="">  41 import net.openid.appauth.ResponseTypeValues;                                                            </span>
<span class="4423191746780431402" onmouseenter="enter('4423191746780431402');" onmouseout="out('4423191746780431402');" style="">  42 import net.openid.appauth.TokenRequest;                                                                  </span>
<span class="7041795251639894294" onmouseenter="enter('7041795251639894294');" onmouseout="out('7041795251639894294');" style="">  43 import net.openid.appauth.TokenResponse;                                                                 </span>
<span class="-5344047661436712974" onmouseenter="enter('-5344047661436712974');" onmouseout="out('-5344047661436712974');" style="">  44 import net.openid.appauth.connectivity.ConnectionBuilder;                                                </span>
<span class="2682978576506672064" onmouseenter="enter('2682978576506672064');" onmouseout="out('2682978576506672064');" style="">  45 import net.openid.appauth.connectivity.DefaultConnectionBuilder;                                         </span>
<span  style="">  46                                                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="6575769426762835403" onmouseenter="enter('6575769426762835403');" onmouseout="out('6575769426762835403');" style="">  48 public class RNAppAuthModule extends ReactContextBaseJavaModule implements ActivityEventListener {       </span>
<span class="8401162781518473365" onmouseenter="enter('8401162781518473365');" onmouseout="out('8401162781518473365');" style="">  49     public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;                           </span>
<span  style="">  50                                                                                                          </span>
<span class="6180419538961108965" onmouseenter="enter('6180419538961108965');" onmouseout="out('6180419538961108965');" style="">  51     private final ReactApplicationContext reactContext;                                                  </span>
<span  style="">  52                                                                                                          </span>
<span class="1869321332520936904" onmouseenter="enter('1869321332520936904');" onmouseout="out('1869321332520936904');" style="">  53     private Promise promise;                                                                             </span>
<span  style="">  54                                                                                                          </span>
<span class="504355591559206068" onmouseenter="enter('504355591559206068');" onmouseout="out('504355591559206068');" style="">  55     private Boolean dangerouslyAllowInsecureHttpRequests;                                                </span>
<span  style="">  56                                                                                                          </span>
<span class="6877933566748299598" onmouseenter="enter('6877933566748299598');" onmouseout="out('6877933566748299598');" style="">  57     private String clientAuthMethod = &quot;basic&quot;;                                                           </span>
<span  style="">  58                                                                                                          </span>
<span class="5073960437150900627" onmouseenter="enter('5073960437150900627');" onmouseout="out('5073960437150900627');" style="">  59     private Map&lt;String, String&gt; authorizationRequestHeaders = null;                                      </span>
<span  style="">  60                                                                                                          </span>
<span class="493655431939084947" onmouseenter="enter('493655431939084947');" onmouseout="out('493655431939084947');" style="">  61     private Map&lt;String, String&gt; tokenRequestHeaders = null;                                              </span>
<span  style="">  62                                                                                                          </span>
<span class="4071237130655105462" onmouseenter="enter('4071237130655105462');" onmouseout="out('4071237130655105462');" style="">  63     private Map&lt;String, String&gt; additionalParametersMap;                                                 </span>
<span  style="">  64                                                                                                          </span>
<span class="266383520389269247" onmouseenter="enter('266383520389269247');" onmouseout="out('266383520389269247');" style="">  65     private String clientSecret;                                                                         </span>
<span  style="">  66                                                                                                          </span>
<span class="-2587280928065129913" onmouseenter="enter('-2587280928065129913');" onmouseout="out('-2587280928065129913');" style=""><abbr title="  67     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;();">  67     private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicRe🔵</abbr></span>
<span  style="">  68                                                                                                          </span>
<span class="-7004558742358285463" onmouseenter="enter('-7004558742358285463');" onmouseout="out('-7004558742358285463');" style="">  69     private boolean isPrefetched = false;                                                                </span>
<span  style="">  70                                                                                                          </span>
<span class="-978447563967948693" onmouseenter="enter('-978447563967948693');" onmouseout="out('-978447563967948693');" style="">  71     public RNAppAuthModule(ReactApplicationContext reactContext) {                                       </span>
<span class="-1443603959286428543" onmouseenter="enter('-1443603959286428543');" onmouseout="out('-1443603959286428543');" style="">  72         super(reactContext);                                                                             </span>
<span class="3003228313870805798" onmouseenter="enter('3003228313870805798');" onmouseout="out('3003228313870805798');" style="">  73         this.reactContext = reactContext;                                                                </span>
<span class="6669990586656871028" onmouseenter="enter('6669990586656871028');" onmouseout="out('6669990586656871028');" style="">  74         reactContext.addActivityEventListener(this);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  75     }                                                                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style="">  77     @ReactMethod                                                                                         </span>
<span class="5198575771274322872" onmouseenter="enter('5198575771274322872');" onmouseout="out('5198575771274322872');" style=""><abbr title="  78     public void prefetchConfiguration(final Boolean warmAndPrefetchChrome, final String issuer, final String redirectUrl, final String clientId, final ReadableArray scopes, final ReadableMap serviceConfiguration, final Boolean dangerouslyAllowInsecureHttpRequests, final ReadableMap headers, final Promise promise) {">  78     public void prefetchConfiguration(final Boolean warmAndPrefetchChrome, final String issuer, final Str🔵</abbr></span>
<span class="-7526945842846133690" onmouseenter="enter('-7526945842846133690');" onmouseout="out('-7526945842846133690');" style="">  79         if (warmAndPrefetchChrome) {                                                                     </span>
<span class="8703515971997686923" onmouseenter="enter('8703515971997686923');" onmouseout="out('8703515971997686923');" style="">  80             warmChromeCustomTab(reactContext, issuer);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81         }                                                                                                </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style="">  82         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title="  83         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);">  83         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="8517032726698162354" onmouseenter="enter('8517032726698162354');" onmouseout="out('8517032726698162354');" style="">  84         final CountDownLatch fetchConfigurationLatch = new CountDownLatch(1);                            </span>
<span class="-8709359352183164935" onmouseenter="enter('-8709359352183164935');" onmouseout="out('-8709359352183164935');" style="">  85         if (!isPrefetched) {                                                                             </span>
<span class="4681005627184431526" onmouseenter="enter('4681005627184431526');" onmouseout="out('4681005627184431526');" style="">  86             if ((serviceConfiguration != null) &amp;&amp; (mServiceConfiguration.get() == null)) {               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  87                 try {                                                                                    </span>
<span class="-5277191699256196698" onmouseenter="enter('-5277191699256196698');" onmouseout="out('-5277191699256196698');" style=""><abbr title="  88                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguration));">  88                     mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguratio🔵</abbr></span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style="">  89                     isPrefetched = true;                                                                 </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style="">  90                     fetchConfigurationLatch.countDown();                                                 </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style="">  91                 } catch (java.lang.Exception e) {                                                        </span>
<span class="6809300863683709814" onmouseenter="enter('6809300863683709814');" onmouseout="out('6809300863683709814');" style="">  92                     promise.reject(&quot;configuration_error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93                 }                                                                                        </span>
<span class="7986155546390017313" onmouseenter="enter('7986155546390017313');" onmouseout="out('7986155546390017313');" style="">  94             } else if (mServiceConfiguration.get() == null) {                                            </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style="">  95                 final Uri issuerUri = Uri.parse(issuer);                                                 </span>
<span class="-8547048573593997638" onmouseenter="enter('-8547048573593997638');" onmouseout="out('-8547048573593997638');" style=""><abbr title="  96                 AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri), new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {">  96                 AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri)🔵</abbr></span>
<span class="-2257150778706080239" onmouseenter="enter('-2257150778706080239');" onmouseout="out('-2257150778706080239');" style="">  97                     public void onFetchConfigurationCompleted(@Nullable                                  </span>
<span class="3222389656683390874" onmouseenter="enter('3222389656683390874');" onmouseout="out('3222389656683390874');" style="">  98                     AuthorizationServiceConfiguration fetchedConfiguration, @Nullable                    </span>
<span class="-6575744672153550235" onmouseenter="enter('-6575744672153550235');" onmouseout="out('-6575744672153550235');" style="">  99                     AuthorizationException ex) {                                                         </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 100                         if (ex != null) {                                                                </span>
<span class="6863513032854295921" onmouseenter="enter('6863513032854295921');" onmouseout="out('6863513032854295921');" style=""><abbr title=" 101                             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configuration&quot;, ex);"> 101                             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configur🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 102                             return;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103                         }                                                                                </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 104                         mServiceConfiguration.set(fetchedConfiguration);                                 </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style=""> 105                         isPrefetched = true;                                                             </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 106                         fetchConfigurationLatch.countDown();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107                     }                                                                                    </span>
<span class="430947961988862402" onmouseenter="enter('430947961988862402');" onmouseout="out('430947961988862402');" style=""> 108                 }, builder);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 110         } else {                                                                                         </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 111             fetchConfigurationLatch.countDown();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112         }                                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 113         try {                                                                                            </span>
<span class="-1907621811022997860" onmouseenter="enter('-1907621811022997860');" onmouseout="out('-1907621811022997860');" style=""> 114             fetchConfigurationLatch.await();                                                             </span>
<span class="1954864242125272611" onmouseenter="enter('1954864242125272611');" onmouseout="out('1954864242125272611');" style=""> 115             promise.resolve(isPrefetched);                                                               </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 116         } catch (java.lang.Exception e) {                                                                </span>
<span class="1768900707370095440" onmouseenter="enter('1768900707370095440');" onmouseout="out('1768900707370095440');" style=""><abbr title=" 117             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e);"> 117             promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119     }                                                                                                    </span>
<span  style=""> 120                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 121     @ReactMethod                                                                                         </span>
<span class="9099780150643892942" onmouseenter="enter('9099780150643892942');" onmouseout="out('9099780150643892942');" style=""><abbr title=" 122     public void authorize(String issuer, final String redirectUrl, final String clientId, final String clientSecret, final ReadableArray scopes, final ReadableMap additionalParameters, final ReadableMap serviceConfiguration, final Boolean usePKCE, final String clientAuthMethod, final Boolean dangerouslyAllowInsecureHttpRequests, final ReadableMap headers, final Promise promise) {"> 122     public void authorize(String issuer, final String redirectUrl, final String clientId, final String cl🔵</abbr></span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 123         this.parseHeaderMap(headers);                                                                    </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title=" 124         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);"> 124         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="3019383581923708916" onmouseenter="enter('3019383581923708916');" onmouseout="out('3019383581923708916');" style=""> 125         final AppAuthConfiguration appAuthConfiguration = this.createAppAuthConfiguration(builder);      </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 126         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 126         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 127         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 128             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129         }                                                                                                </span>
<span class="5192680332872896216" onmouseenter="enter('5192680332872896216');" onmouseout="out('5192680332872896216');" style=""> 130         // store args in private fields for later use in onActivityResult handler                        </span>
<span class="-4922073825750036997" onmouseenter="enter('-4922073825750036997');" onmouseout="out('-4922073825750036997');" style=""> 131         this.promise = promise;                                                                          </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 132         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 133         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span class="-8734683050201249921" onmouseenter="enter('-8734683050201249921');" onmouseout="out('-8734683050201249921');" style=""> 134         this.clientSecret = clientSecret;                                                                </span>
<span class="3270519662544404418" onmouseenter="enter('3270519662544404418');" onmouseout="out('3270519662544404418');" style=""> 135         this.clientAuthMethod = clientAuthMethod;                                                        </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 136         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 136         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-273840844626677319" onmouseenter="enter('-273840844626677319');" onmouseout="out('-273840844626677319');" style=""> 137         if ((serviceConfiguration != null) || (mServiceConfiguration.get() != null)) {                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 138             try {                                                                                        </span>
<span class="-8714840365255154195" onmouseenter="enter('-8714840365255154195');" onmouseout="out('-8714840365255154195');" style=""><abbr title=" 139                 final AuthorizationServiceConfiguration serviceConfig = (mServiceConfiguration.get() != null) ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 139                 final AuthorizationServiceConfiguration serviceConfig = (mServiceConfiguration.get() != n🔵</abbr></span>
<span class="4365749174608131524" onmouseenter="enter('4365749174608131524');" onmouseout="out('4365749174608131524');" style=""><abbr title=" 140                 authorizeWithConfiguration(serviceConfig, appAuthConfiguration, clientId, scopes, redirectUrl, usePKCE, additionalParametersMap);"> 140                 authorizeWithConfiguration(serviceConfig, appAuthConfiguration, clientId, scopes, redirec🔵</abbr></span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 141             } catch (java.lang.Exception e) {                                                            </span>
<span class="-3857326443207234519" onmouseenter="enter('-3857326443207234519');" onmouseout="out('-3857326443207234519');" style=""> 142                 promise.reject(&quot;authentication_failed&quot;, e.getMessage());                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 144         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 145             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="-8547048573593997638" onmouseenter="enter('-8547048573593997638');" onmouseout="out('-8547048573593997638');" style=""><abbr title=" 146             AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri), new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {"> 146             AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri), ne🔵</abbr></span>
<span class="-2257150778706080239" onmouseenter="enter('-2257150778706080239');" onmouseout="out('-2257150778706080239');" style=""> 147                 public void onFetchConfigurationCompleted(@Nullable                                      </span>
<span class="3222389656683390874" onmouseenter="enter('3222389656683390874');" onmouseout="out('3222389656683390874');" style=""> 148                 AuthorizationServiceConfiguration fetchedConfiguration, @Nullable                        </span>
<span class="-6575744672153550235" onmouseenter="enter('-6575744672153550235');" onmouseout="out('-6575744672153550235');" style=""> 149                 AuthorizationException ex) {                                                             </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 150                     if (ex != null) {                                                                    </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 151                         promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 152                         return;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153                     }                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 154                     mServiceConfiguration.set(fetchedConfiguration);                                     </span>
<span class="-9066176821851810209" onmouseenter="enter('-9066176821851810209');" onmouseout="out('-9066176821851810209');" style=""><abbr title=" 155                     authorizeWithConfiguration(fetchedConfiguration, appAuthConfiguration, clientId, scopes, redirectUrl, usePKCE, additionalParametersMap);"> 155                     authorizeWithConfiguration(fetchedConfiguration, appAuthConfiguration, clientId, scop🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156                 }                                                                                        </span>
<span class="430947961988862402" onmouseenter="enter('430947961988862402');" onmouseout="out('430947961988862402');" style=""> 157             }, builder);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159     }                                                                                                    </span>
<span  style=""> 160                                                                                                          </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 161     @ReactMethod                                                                                         </span>
<span class="-5519556835002782100" onmouseenter="enter('-5519556835002782100');" onmouseout="out('-5519556835002782100');" style=""><abbr title=" 162     public void refresh(String issuer, final String redirectUrl, final String clientId, final String clientSecret, final String refreshToken, final ReadableArray scopes, final ReadableMap additionalParameters, final ReadableMap serviceConfiguration, final String clientAuthMethod, final Boolean dangerouslyAllowInsecureHttpRequests, final ReadableMap headers, final Promise promise) {"> 162     public void refresh(String issuer, final String redirectUrl, final String clientId, final String clie🔵</abbr></span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 163         this.parseHeaderMap(headers);                                                                    </span>
<span class="5750510513523473374" onmouseenter="enter('5750510513523473374');" onmouseout="out('5750510513523473374');" style=""><abbr title=" 164         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders);"> 164         final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, t🔵</abbr></span>
<span class="-7964591588332866161" onmouseenter="enter('-7964591588332866161');" onmouseout="out('-7964591588332866161');" style=""> 165         final AppAuthConfiguration appAuthConfiguration = createAppAuthConfiguration(builder);           </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 166         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 166         final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalPa🔵</abbr></span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 167         if (clientSecret != null) {                                                                      </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 168             additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="1495748746185505707" onmouseenter="enter('1495748746185505707');" onmouseout="out('1495748746185505707');" style=""> 170         // store setting in private field for later use in onActivityResult handler                      </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 171         this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 172         this.additionalParametersMap = additionalParametersMap;                                          </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""><abbr title=" 173         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint"> 173         // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoi🔵</abbr></span>
<span class="-273840844626677319" onmouseenter="enter('-273840844626677319');" onmouseout="out('-273840844626677319');" style=""> 174         if ((serviceConfiguration != null) || (mServiceConfiguration.get() != null)) {                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 175             try {                                                                                        </span>
<span class="-8714840365255154195" onmouseenter="enter('-8714840365255154195');" onmouseout="out('-8714840365255154195');" style=""><abbr title=" 176                 final AuthorizationServiceConfiguration serviceConfig = (mServiceConfiguration.get() != null) ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 176                 final AuthorizationServiceConfiguration serviceConfig = (mServiceConfiguration.get() != n🔵</abbr></span>
<span class="-6761808542727858534" onmouseenter="enter('-6761808542727858534');" onmouseout="out('-6761808542727858534');" style=""><abbr title=" 177                 refreshWithConfiguration(serviceConfig, appAuthConfiguration, refreshToken, clientId, scopes, redirectUrl, additionalParametersMap, clientAuthMethod, clientSecret, promise);"> 177                 refreshWithConfiguration(serviceConfig, appAuthConfiguration, refreshToken, clientId, sco🔵</abbr></span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 178             } catch (java.lang.Exception e) {                                                            </span>
<span class="7513248397060081198" onmouseenter="enter('7513248397060081198');" onmouseout="out('7513248397060081198');" style=""> 179                 promise.reject(&quot;token_refresh_failed&quot;, e.getMessage());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 181         } else {                                                                                         </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 182             final Uri issuerUri = Uri.parse(issuer);                                                     </span>
<span class="-8547048573593997638" onmouseenter="enter('-8547048573593997638');" onmouseout="out('-8547048573593997638');" style=""><abbr title=" 183             AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri), new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {"> 183             AuthorizationServiceConfiguration.fetchFromUrl(buildConfigurationUriFromIssuer(issuerUri), ne🔵</abbr></span>
<span class="-2257150778706080239" onmouseenter="enter('-2257150778706080239');" onmouseout="out('-2257150778706080239');" style=""> 184                 public void onFetchConfigurationCompleted(@Nullable                                      </span>
<span class="3222389656683390874" onmouseenter="enter('3222389656683390874');" onmouseout="out('3222389656683390874');" style=""> 185                 AuthorizationServiceConfiguration fetchedConfiguration, @Nullable                        </span>
<span class="-6575744672153550235" onmouseenter="enter('-6575744672153550235');" onmouseout="out('-6575744672153550235');" style=""> 186                 AuthorizationException ex) {                                                             </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 187                     if (ex != null) {                                                                    </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style=""> 188                         promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 189                         return;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190                     }                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 191                     mServiceConfiguration.set(fetchedConfiguration);                                     </span>
<span class="1554359056512755150" onmouseenter="enter('1554359056512755150');" onmouseout="out('1554359056512755150');" style=""><abbr title=" 192                     refreshWithConfiguration(fetchedConfiguration, appAuthConfiguration, refreshToken, clientId, scopes, redirectUrl, additionalParametersMap, clientAuthMethod, clientSecret, promise);"> 192                     refreshWithConfiguration(fetchedConfiguration, appAuthConfiguration, refreshToken, cl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193                 }                                                                                        </span>
<span class="430947961988862402" onmouseenter="enter('430947961988862402');" onmouseout="out('430947961988862402');" style=""> 194             }, builder);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 198     /*                                                                                                   </span>
<span class="7578951324193379805" onmouseenter="enter('7578951324193379805');" onmouseout="out('7578951324193379805');" style=""> 199      * Called when the OAuth browser activity completes                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 200      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 201     @Override                                                                                            </span>
<span class="2027722410160164989" onmouseenter="enter('2027722410160164989');" onmouseout="out('2027722410160164989');" style=""> 202     public void onActivityResult(Activity activity, int requestCode, int resultCode, Intent data) {      </span>
<span class="-4639597857217913430" onmouseenter="enter('-4639597857217913430');" onmouseout="out('-4639597857217913430');" style=""> 203         if (requestCode == 0) {                                                                          </span>
<span class="-5203356024335682166" onmouseenter="enter('-5203356024335682166');" onmouseout="out('-5203356024335682166');" style=""> 204             if (data == null) {                                                                          </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style=""> 205                 if (promise != null) {                                                                   </span>
<span class="-7426400094937746923" onmouseenter="enter('-7426400094937746923');" onmouseout="out('-7426400094937746923');" style=""> 206                     promise.reject(&quot;authentication_error&quot;, &quot;Data intent is null&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 208                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209             }                                                                                            </span>
<span class="1683167759369238332" onmouseenter="enter('1683167759369238332');" onmouseout="out('1683167759369238332');" style=""> 210             final AuthorizationResponse response = AuthorizationResponse.fromIntent(data);               </span>
<span class="-2661429536108932642" onmouseenter="enter('-2661429536108932642');" onmouseout="out('-2661429536108932642');" style=""> 211             AuthorizationException exception = AuthorizationException.fromIntent(data);                  </span>
<span class="812069196179346176" onmouseenter="enter('812069196179346176');" onmouseout="out('812069196179346176');" style=""> 212             if (exception != null) {                                                                     </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style=""> 213                 if (promise != null) {                                                                   </span>
<span class="8302975562867231827" onmouseenter="enter('8302975562867231827');" onmouseout="out('8302975562867231827');" style=""> 214                     promise.reject(&quot;authentication_error&quot;, getErrorMessage(exception));                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 216                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217             }                                                                                            </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style=""> 218             final Promise authorizePromise = this.promise;                                               </span>
<span class="-2180038079718264036" onmouseenter="enter('-2180038079718264036');" onmouseout="out('-2180038079718264036');" style=""><abbr title=" 219             final AppAuthConfiguration configuration = createAppAuthConfiguration(createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders));"> 219             final AppAuthConfiguration configuration = createAppAuthConfiguration(createConnectionBuilder🔵</abbr></span>
<span class="-598339291394324639" onmouseenter="enter('-598339291394324639');" onmouseout="out('-598339291394324639');" style=""><abbr title=" 220             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration);"> 220             AuthorizationService authService = new AuthorizationService(this.reactContext, configuration)🔵</abbr></span>
<span class="6152215567678252770" onmouseenter="enter('6152215567678252770');" onmouseout="out('6152215567678252770');" style=""><abbr title=" 221             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap);"> 221             TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap)🔵</abbr></span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 222             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 222             AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.T🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 223                 @Override                                                                                </span>
<span class="-7947697347358044811" onmouseenter="enter('-7947697347358044811');" onmouseout="out('-7947697347358044811');" style=""> 224                 public void onTokenRequestCompleted(TokenResponse resp, AuthorizationException ex) {     </span>
<span class="7476284757153148856" onmouseenter="enter('7476284757153148856');" onmouseout="out('7476284757153148856');" style=""> 225                     if (resp != null) {                                                                  </span>
<span class="7607526798956663360" onmouseenter="enter('7607526798956663360');" onmouseout="out('7607526798956663360');" style=""> 226                         WritableMap map = TokenResponseFactory.tokenResponseToMap(resp, response);       </span>
<span class="-6045783056504489326" onmouseenter="enter('-6045783056504489326');" onmouseout="out('-6045783056504489326');" style=""> 227                         if (authorizePromise != null) {                                                  </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style=""> 228                             authorizePromise.resolve(map);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229                         }                                                                                </span>
<span class="5033272853631726450" onmouseenter="enter('5033272853631726450');" onmouseout="out('5033272853631726450');" style=""> 230                     } else if (promise != null) {                                                        </span>
<span class="-1873248496991044419" onmouseenter="enter('-1873248496991044419');" onmouseout="out('-1873248496991044419');" style=""> 231                         promise.reject(&quot;token_exchange_failed&quot;, getErrorMessage(ex));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233                 }                                                                                        </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 234             };                                                                                           </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style=""> 235             if (this.clientSecret != null) {                                                             </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style=""><abbr title=" 236                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 236                 ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.cl🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 237                 authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 238             } else {                                                                                     </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 239                 authService.performTokenRequest(tokenRequest, tokenResponseCallback);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span  style=""> 243                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 244     /*                                                                                                   </span>
<span class="-3037424821439688076" onmouseenter="enter('-3037424821439688076');" onmouseout="out('-3037424821439688076');" style=""> 245      * Authorize user with the provided configuration                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 246      */                                                                                                  </span>
<span class="-1686698148972257501" onmouseenter="enter('-1686698148972257501');" onmouseout="out('-1686698148972257501');" style=""> 247     private void authorizeWithConfiguration(                                                             </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 248             final AuthorizationServiceConfiguration serviceConfiguration,                                </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 249             final AppAuthConfiguration appAuthConfiguration,                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 250             final String clientId,                                                                       </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 251             final ReadableArray scopes,                                                                  </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 252             final String redirectUrl,                                                                    </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 253             final Boolean usePKCE,                                                                       </span>
<span class="4591131233701235058" onmouseenter="enter('4591131233701235058');" onmouseout="out('4591131233701235058');" style=""> 254             final Map&lt;String, String&gt; additionalParametersMap                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 255     ) {                                                                                                  </span>
<span  style=""> 256                                                                                                          </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 257         String scopesString = null;                                                                      </span>
<span  style=""> 258                                                                                                          </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 259         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 260             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261         }                                                                                                </span>
<span  style=""> 262                                                                                                          </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 263         final Context context = this.reactContext;                                                       </span>
<span class="-4913832152651687292" onmouseenter="enter('-4913832152651687292');" onmouseout="out('-4913832152651687292');" style=""> 264         final Activity currentActivity = getCurrentActivity();                                           </span>
<span  style=""> 265                                                                                                          </span>
<span class="1615045173536817183" onmouseenter="enter('1615045173536817183');" onmouseout="out('1615045173536817183');" style=""> 266         AuthorizationRequest.Builder authRequestBuilder =                                                </span>
<span class="8630572254279098967" onmouseenter="enter('8630572254279098967');" onmouseout="out('8630572254279098967');" style=""> 267                 new AuthorizationRequest.Builder(                                                        </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 268                         serviceConfiguration,                                                            </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 269                         clientId,                                                                        </span>
<span class="4849618716626806999" onmouseenter="enter('4849618716626806999');" onmouseout="out('4849618716626806999');" style=""> 270                         ResponseTypeValues.CODE,                                                         </span>
<span class="-1639145692422133689" onmouseenter="enter('-1639145692422133689');" onmouseout="out('-1639145692422133689');" style=""> 271                         Uri.parse(redirectUrl)                                                           </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 272                 );                                                                                       </span>
<span  style=""> 273                                                                                                          </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 274         if (scopesString != null) {                                                                      </span>
<span class="-8218576309450527961" onmouseenter="enter('-8218576309450527961');" onmouseout="out('-8218576309450527961');" style=""> 275             authRequestBuilder.setScope(scopesString);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276         }                                                                                                </span>
<span  style=""> 277                                                                                                          </span>
<span  style=""> 278                                                                                                          </span>
<span class="7149068665077353053" onmouseenter="enter('7149068665077353053');" onmouseout="out('7149068665077353053');" style=""> 279         if (additionalParametersMap != null) {                                                           </span>
<span class="-6137327941719445172" onmouseenter="enter('-6137327941719445172');" onmouseout="out('-6137327941719445172');" style=""> 280             // handle additional parameters separately to avoid exceptions from AppAuth                  </span>
<span class="-4729676460784236302" onmouseenter="enter('-4729676460784236302');" onmouseout="out('-4729676460784236302');" style=""> 281             if (additionalParametersMap.containsKey(&quot;display&quot;)) {                                        </span>
<span class="6740086842281271815" onmouseenter="enter('6740086842281271815');" onmouseout="out('6740086842281271815');" style=""> 282                 authRequestBuilder.setDisplay(additionalParametersMap.get(&quot;display&quot;));                   </span>
<span class="5478676394718524231" onmouseenter="enter('5478676394718524231');" onmouseout="out('5478676394718524231');" style=""> 283                 additionalParametersMap.remove(&quot;display&quot;);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284             }                                                                                            </span>
<span class="-5162308638975991351" onmouseenter="enter('-5162308638975991351');" onmouseout="out('-5162308638975991351');" style=""> 285             if (additionalParametersMap.containsKey(&quot;login_hint&quot;)) {                                     </span>
<span class="7478322337196261432" onmouseenter="enter('7478322337196261432');" onmouseout="out('7478322337196261432');" style=""> 286                 authRequestBuilder.setLoginHint(additionalParametersMap.get(&quot;login_hint&quot;));              </span>
<span class="-3825577662921277200" onmouseenter="enter('-3825577662921277200');" onmouseout="out('-3825577662921277200');" style=""> 287                 additionalParametersMap.remove(&quot;login_hint&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288             }                                                                                            </span>
<span class="-8254180626457365202" onmouseenter="enter('-8254180626457365202');" onmouseout="out('-8254180626457365202');" style=""> 289             if (additionalParametersMap.containsKey(&quot;prompt&quot;)) {                                         </span>
<span class="2585369211918110761" onmouseenter="enter('2585369211918110761');" onmouseout="out('2585369211918110761');" style=""> 290                 authRequestBuilder.setPrompt(additionalParametersMap.get(&quot;prompt&quot;));                     </span>
<span class="290019989822766287" onmouseenter="enter('290019989822766287');" onmouseout="out('290019989822766287');" style=""> 291                 additionalParametersMap.remove(&quot;prompt&quot;);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292             }                                                                                            </span>
<span  style=""> 293                                                                                                          </span>
<span class="-1433627721318603910" onmouseenter="enter('-1433627721318603910');" onmouseout="out('-1433627721318603910');" style=""> 294             authRequestBuilder.setAdditionalParameters(additionalParametersMap);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295         }                                                                                                </span>
<span  style=""> 296                                                                                                          </span>
<span class="6295746505532947076" onmouseenter="enter('6295746505532947076');" onmouseout="out('6295746505532947076');" style=""> 297         if (!usePKCE) {                                                                                  </span>
<span class="211047115781987373" onmouseenter="enter('211047115781987373');" onmouseout="out('211047115781987373');" style=""> 298             authRequestBuilder.setCodeVerifier(null);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299         }                                                                                                </span>
<span  style=""> 300                                                                                                          </span>
<span class="2874496759892237047" onmouseenter="enter('2874496759892237047');" onmouseout="out('2874496759892237047');" style=""> 301         AuthorizationRequest authRequest = authRequestBuilder.build();                                   </span>
<span  style=""> 302                                                                                                          </span>
<span class="4248167488592758879" onmouseenter="enter('4248167488592758879');" onmouseout="out('4248167488592758879');" style=""> 303         if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.LOLLIPOP) {               </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 304             AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);  </span>
<span class="-8712988972948484879" onmouseenter="enter('-8712988972948484879');" onmouseout="out('-8712988972948484879');" style=""> 305             Intent authIntent = authService.getAuthorizationRequestIntent(authRequest);                  </span>
<span  style=""> 306                                                                                                          </span>
<span class="-1768672139093830544" onmouseenter="enter('-1768672139093830544');" onmouseout="out('-1768672139093830544');" style=""> 307             currentActivity.startActivityForResult(authIntent, 0);                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 308         } else {                                                                                         </span>
<span class="-5574677103641269793" onmouseenter="enter('-5574677103641269793');" onmouseout="out('-5574677103641269793');" style=""><abbr title=" 309             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfiguration);"> 309             AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfigura🔵</abbr></span>
<span class="-921350943484849229" onmouseenter="enter('-921350943484849229');" onmouseout="out('-921350943484849229');" style=""> 310             PendingIntent pendingIntent = currentActivity.createPendingResult(0, new Intent(), 0);       </span>
<span  style=""> 311                                                                                                          </span>
<span class="5462088869311657545" onmouseenter="enter('5462088869311657545');" onmouseout="out('5462088869311657545');" style=""> 312             authService.performAuthorizationRequest(authRequest, pendingIntent);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314     }                                                                                                    </span>
<span  style=""> 315                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 316     /*                                                                                                   </span>
<span class="8814346366745541198" onmouseenter="enter('8814346366745541198');" onmouseout="out('8814346366745541198');" style=""> 317      * Refresh authentication token with the provided configuration                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 318      */                                                                                                  </span>
<span class="-4356832458352714" onmouseenter="enter('-4356832458352714');" onmouseout="out('-4356832458352714');" style=""><abbr title=" 319     private void refreshWithConfiguration(final AuthorizationServiceConfiguration serviceConfiguration, final AppAuthConfiguration appAuthConfiguration, final String refreshToken, final String clientId, final ReadableArray scopes, final String redirectUrl, final Map&lt;String, String&gt; additionalParametersMap, final String clientAuthMethod, final String clientSecret, final Promise promise) {"> 319     private void refreshWithConfiguration(final AuthorizationServiceConfiguration serviceConfiguration, f🔵</abbr></span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 320         String scopesString = null;                                                                      </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 321         if (scopes != null) {                                                                            </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 322             scopesString = this.arrayToString(scopes);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323         }                                                                                                </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 324         final Context context = this.reactContext;                                                       </span>
<span class="4187525380790789106" onmouseenter="enter('4187525380790789106');" onmouseout="out('4187525380790789106');" style=""><abbr title=" 325         TokenRequest.Builder tokenRequestBuilder = new TokenRequest.Builder(serviceConfiguration, clientId).setRefreshToken(refreshToken).setRedirectUri(Uri.parse(redirectUrl));"> 325         TokenRequest.Builder tokenRequestBuilder = new TokenRequest.Builder(serviceConfiguration, clientI🔵</abbr></span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 326         if (scopesString != null) {                                                                      </span>
<span class="-4940100242303343354" onmouseenter="enter('-4940100242303343354');" onmouseout="out('-4940100242303343354');" style=""> 327             tokenRequestBuilder.setScope(scopesString);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328         }                                                                                                </span>
<span class="1982926752875631058" onmouseenter="enter('1982926752875631058');" onmouseout="out('1982926752875631058');" style=""> 329         if (!additionalParametersMap.isEmpty()) {                                                        </span>
<span class="6791703352530289305" onmouseenter="enter('6791703352530289305');" onmouseout="out('6791703352530289305');" style=""> 330             tokenRequestBuilder.setAdditionalParameters(additionalParametersMap);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331         }                                                                                                </span>
<span class="6300215370198990899" onmouseenter="enter('6300215370198990899');" onmouseout="out('6300215370198990899');" style=""> 332         TokenRequest tokenRequest = tokenRequestBuilder.build();                                         </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 333         AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);      </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 334         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 334         AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.Token🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 335             @Override                                                                                    </span>
<span class="7185247944988073446" onmouseenter="enter('7185247944988073446');" onmouseout="out('7185247944988073446');" style=""> 336             public void onTokenRequestCompleted(@Nullable                                                </span>
<span class="5872282735739112495" onmouseenter="enter('5872282735739112495');" onmouseout="out('5872282735739112495');" style=""> 337             TokenResponse response, @Nullable                                                            </span>
<span class="-6575744672153550235" onmouseenter="enter('-6575744672153550235');" onmouseout="out('-6575744672153550235');" style=""> 338             AuthorizationException ex) {                                                                 </span>
<span class="4756227728171050519" onmouseenter="enter('4756227728171050519');" onmouseout="out('4756227728171050519');" style=""> 339                 if (response != null) {                                                                  </span>
<span class="-4071880271889138129" onmouseenter="enter('-4071880271889138129');" onmouseout="out('-4071880271889138129');" style=""> 340                     WritableMap map = TokenResponseFactory.tokenResponseToMap(response);                 </span>
<span class="9181054552595447887" onmouseenter="enter('9181054552595447887');" onmouseout="out('9181054552595447887');" style=""> 341                     promise.resolve(map);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 342                 } else {                                                                                 </span>
<span class="-8974399670180994057" onmouseenter="enter('-8974399670180994057');" onmouseout="out('-8974399670180994057');" style=""> 343                     promise.reject(&quot;token_refresh_failed&quot;, getErrorMessage(ex));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 346         };                                                                                               </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 347         if (clientSecret != null) {                                                                      </span>
<span class="-3955443834186652225" onmouseenter="enter('-3955443834186652225');" onmouseout="out('-3955443834186652225');" style=""><abbr title=" 348             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod);"> 348             ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 349             authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 350         } else {                                                                                         </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 351             authService.performTokenRequest(tokenRequest, tokenResponseCallback);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353     }                                                                                                    </span>
<span  style=""> 354                                                                                                          </span>
<span class="2930218534777413873" onmouseenter="enter('2930218534777413873');" onmouseout="out('2930218534777413873');" style=""> 355     private void parseHeaderMap (ReadableMap headerMap) {                                                </span>
<span class="-6316489241675673035" onmouseenter="enter('-6316489241675673035');" onmouseout="out('-6316489241675673035');" style=""> 356         if (headerMap == null) {                                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 357             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358         }                                                                                                </span>
<span class="-8530407112624237580" onmouseenter="enter('-8530407112624237580');" onmouseout="out('-8530407112624237580');" style=""> 359         if (headerMap.hasKey(&quot;authorize&quot;) &amp;&amp; headerMap.getType(&quot;authorize&quot;) == ReadableType.Map) {       </span>
<span class="762039099095363738" onmouseenter="enter('762039099095363738');" onmouseout="out('762039099095363738');" style=""><abbr title=" 360             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;));"> 360             this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361         }                                                                                                </span>
<span class="5768179141818569002" onmouseenter="enter('5768179141818569002');" onmouseout="out('5768179141818569002');" style=""> 362         if (headerMap.hasKey(&quot;token&quot;) &amp;&amp; headerMap.getType(&quot;token&quot;) == ReadableType.Map) {               </span>
<span class="-4870803436115877491" onmouseenter="enter('-4870803436115877491');" onmouseout="out('-4870803436115877491');" style=""> 363             this.tokenRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;token&quot;));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364         }                                                                                                </span>
<span  style=""> 365                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366     }                                                                                                    </span>
<span  style=""> 367                                                                                                          </span>
<span class="-2276636657842571599" onmouseenter="enter('-2276636657842571599');" onmouseout="out('-2276636657842571599');" style=""> 368     private ClientAuthentication getClientAuthentication(String clientSecret, String clientAuthMethod) { </span>
<span class="4736948393768361142" onmouseenter="enter('4736948393768361142');" onmouseout="out('4736948393768361142');" style=""> 369         if (clientAuthMethod.equals(&quot;post&quot;)) {                                                           </span>
<span class="4033722210949459980" onmouseenter="enter('4033722210949459980');" onmouseout="out('4033722210949459980');" style=""> 370             return new ClientSecretPost(clientSecret);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371         }                                                                                                </span>
<span  style=""> 372                                                                                                          </span>
<span class="-1107687855860572488" onmouseenter="enter('-1107687855860572488');" onmouseout="out('-1107687855860572488');" style=""> 373         return new ClientSecretBasic(clientSecret);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374     }                                                                                                    </span>
<span  style=""> 375                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 376     /*                                                                                                   </span>
<span class="5090378039448834807" onmouseenter="enter('5090378039448834807');" onmouseout="out('5090378039448834807');" style=""> 377      * Return error information if it is available                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 378      */                                                                                                  </span>
<span class="7325111704754615468" onmouseenter="enter('7325111704754615468');" onmouseout="out('7325111704754615468');" style=""> 379     private String getErrorMessage(AuthorizationException ex){                                           </span>
<span class="6233744395473659458" onmouseenter="enter('6233744395473659458');" onmouseout="out('6233744395473659458');" style=""> 380         if(ex.errorDescription == null &amp;&amp; ex.error != null)                                              </span>
<span class="8212520076730053042" onmouseenter="enter('8212520076730053042');" onmouseout="out('8212520076730053042');" style=""> 381             return ex.error;                                                                             </span>
<span class="-944119096152079377" onmouseenter="enter('-944119096152079377');" onmouseout="out('-944119096152079377');" style=""> 382         return ex.errorDescription;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383     }                                                                                                    </span>
<span  style=""> 384                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 385     /*                                                                                                   </span>
<span class="6638112631744326921" onmouseenter="enter('6638112631744326921');" onmouseout="out('6638112631744326921');" style=""> 386      * Create a space-delimited string from an array                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 387      */                                                                                                  </span>
<span class="2843730177292313139" onmouseenter="enter('2843730177292313139');" onmouseout="out('2843730177292313139');" style=""> 388     private String arrayToString(ReadableArray array) {                                                  </span>
<span class="-8236782342056480869" onmouseenter="enter('-8236782342056480869');" onmouseout="out('-8236782342056480869');" style=""> 389         StringBuilder strBuilder = new StringBuilder();                                                  </span>
<span class="7278311890620727475" onmouseenter="enter('7278311890620727475');" onmouseout="out('7278311890620727475');" style=""> 390         for (int i = 0; i &lt; array.size(); i++) {                                                         </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style=""> 391             if (i != 0) {                                                                                </span>
<span class="-4449242394605741248" onmouseenter="enter('-4449242394605741248');" onmouseout="out('-4449242394605741248');" style=""> 392                 strBuilder.append(&#x27; &#x27;);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393             }                                                                                            </span>
<span class="-8205116312766504963" onmouseenter="enter('-8205116312766504963');" onmouseout="out('-8205116312766504963');" style=""> 394             strBuilder.append(array.getString(i));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395         }                                                                                                </span>
<span class="-7597052729024482685" onmouseenter="enter('-7597052729024482685');" onmouseout="out('-7597052729024482685');" style=""> 396         return strBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397     }                                                                                                    </span>
<span  style=""> 398                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 399     /*                                                                                                   </span>
<span class="5214794569700518887" onmouseenter="enter('5214794569700518887');" onmouseout="out('5214794569700518887');" style=""> 400      * Create an App Auth configuration using the provided connection builder                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 401      */                                                                                                  </span>
<span class="-5342361748775304563" onmouseenter="enter('-5342361748775304563');" onmouseout="out('-5342361748775304563');" style=""> 402     private AppAuthConfiguration createAppAuthConfiguration(ConnectionBuilder connectionBuilder) {       </span>
<span class="-6961363017801118708" onmouseenter="enter('-6961363017801118708');" onmouseout="out('-6961363017801118708');" style=""> 403         return new AppAuthConfiguration                                                                  </span>
<span class="370567544488026574" onmouseenter="enter('370567544488026574');" onmouseout="out('370567544488026574');" style=""> 404                 .Builder()                                                                               </span>
<span class="6932817517014214209" onmouseenter="enter('6932817517014214209');" onmouseout="out('6932817517014214209');" style=""> 405                 .setConnectionBuilder(connectionBuilder)                                                 </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 406                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407     }                                                                                                    </span>
<span  style=""> 408                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 409     /*                                                                                                   </span>
<span class="2307564597312892215" onmouseenter="enter('2307564597312892215');" onmouseout="out('2307564597312892215');" style=""> 410      *  Create appropriate connection builder based on provided settings                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 411      */                                                                                                  </span>
<span class="-266307560690147004" onmouseenter="enter('-266307560690147004');" onmouseout="out('-266307560690147004');" style=""><abbr title=" 412     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; headers) {"> 412     private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, Strin🔵</abbr></span>
<span class="7318015076305824949" onmouseenter="enter('7318015076305824949');" onmouseout="out('7318015076305824949');" style=""> 413         ConnectionBuilder proxiedBuilder;                                                                </span>
<span  style=""> 414                                                                                                          </span>
<span class="-6214248404965356101" onmouseenter="enter('-6214248404965356101');" onmouseout="out('-6214248404965356101');" style=""> 415         if (allowInsecureConnections.equals(true)) {                                                     </span>
<span class="-8652069864919613967" onmouseenter="enter('-8652069864919613967');" onmouseout="out('-8652069864919613967');" style=""> 416             proxiedBuilder =UnsafeConnectionBuilder.INSTANCE;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 417         } else {                                                                                         </span>
<span class="-3823294731313489124" onmouseenter="enter('-3823294731313489124');" onmouseout="out('-3823294731313489124');" style=""> 418             proxiedBuilder = DefaultConnectionBuilder.INSTANCE;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419         }                                                                                                </span>
<span  style=""> 420                                                                                                          </span>
<span class="-321326358809916252" onmouseenter="enter('-321326358809916252');" onmouseout="out('-321326358809916252');" style=""> 421         CustomConnectionBuilder customConnection = new CustomConnectionBuilder(proxiedBuilder);          </span>
<span class="-5872856843685271172" onmouseenter="enter('-5872856843685271172');" onmouseout="out('-5872856843685271172');" style=""> 422         if (headers != null) {                                                                           </span>
<span class="-4120878389218127223" onmouseenter="enter('-4120878389218127223');" onmouseout="out('-4120878389218127223');" style=""> 423             customConnection.setHeaders(headers);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424         }                                                                                                </span>
<span  style=""> 425                                                                                                          </span>
<span class="5629827582834827587" onmouseenter="enter('5629827582834827587');" onmouseout="out('5629827582834827587');" style=""> 426         return customConnection;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427     }                                                                                                    </span>
<span  style=""> 428                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 429     /*                                                                                                   </span>
<span class="9187662928809351886" onmouseenter="enter('9187662928809351886');" onmouseout="out('9187662928809351886');" style=""> 430      *  Replicated private method from AuthorizationServiceConfiguration                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 431      */                                                                                                  </span>
<span class="2622836649973257205" onmouseenter="enter('2622836649973257205');" onmouseout="out('2622836649973257205');" style=""> 432     private Uri buildConfigurationUriFromIssuer(Uri openIdConnectIssuerUri) {                            </span>
<span class="-830811466431368071" onmouseenter="enter('-830811466431368071');" onmouseout="out('-830811466431368071');" style=""> 433         return openIdConnectIssuerUri.buildUpon()                                                        </span>
<span class="7258170423676519924" onmouseenter="enter('7258170423676519924');" onmouseout="out('7258170423676519924');" style=""> 434                 .appendPath(AuthorizationServiceConfiguration.WELL_KNOWN_PATH)                           </span>
<span class="-3903955623180377764" onmouseenter="enter('-3903955623180377764');" onmouseout="out('-3903955623180377764');" style=""> 435                 .appendPath(AuthorizationServiceConfiguration.OPENID_CONFIGURATION_RESOURCE)             </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 436                 .build();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 437     }                                                                                                    </span>
<span  style=""> 438                                                                                                          </span>
<span class="3122274151060887299" onmouseenter="enter('3122274151060887299');" onmouseout="out('3122274151060887299');" style=""><abbr title=" 439     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfiguration) throws Exception {"> 439     private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap service🔵</abbr></span>
<span class="4275545280692735139" onmouseenter="enter('4275545280692735139');" onmouseout="out('4275545280692735139');" style=""> 440         if (!serviceConfiguration.hasKey(&quot;authorizationEndpoint&quot;)) {                                     </span>
<span class="3986521017730318395" onmouseenter="enter('3986521017730318395');" onmouseout="out('3986521017730318395');" style=""> 441             throw new Exception(&quot;serviceConfiguration passed without an authorizationEndpoint&quot;);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442         }                                                                                                </span>
<span  style=""> 443                                                                                                          </span>
<span class="5638598812511759739" onmouseenter="enter('5638598812511759739');" onmouseout="out('5638598812511759739');" style=""> 444         if (!serviceConfiguration.hasKey(&quot;tokenEndpoint&quot;)) {                                             </span>
<span class="7444064849592215652" onmouseenter="enter('7444064849592215652');" onmouseout="out('7444064849592215652');" style=""> 445             throw new Exception(&quot;serviceConfiguration passed without a tokenEndpoint&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446         }                                                                                                </span>
<span  style=""> 447                                                                                                          </span>
<span class="-3941749567598770425" onmouseenter="enter('-3941749567598770425');" onmouseout="out('-3941749567598770425');" style=""> 448         Uri authorizationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;authorizationEndpoint&quot;));  </span>
<span class="4054930865548070446" onmouseenter="enter('4054930865548070446');" onmouseout="out('4054930865548070446');" style=""> 449         Uri tokenEndpoint = Uri.parse(serviceConfiguration.getString(&quot;tokenEndpoint&quot;));                  </span>
<span class="2264343622444418519" onmouseenter="enter('2264343622444418519');" onmouseout="out('2264343622444418519');" style=""> 450         Uri registrationEndpoint = null;                                                                 </span>
<span class="-4970643399788664483" onmouseenter="enter('-4970643399788664483');" onmouseout="out('-4970643399788664483');" style=""> 451         if (serviceConfiguration.hasKey(&quot;registrationEndpoint&quot;)) {                                       </span>
<span class="1609034589288005797" onmouseenter="enter('1609034589288005797');" onmouseout="out('1609034589288005797');" style=""> 452             registrationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;registrationEndpoint&quot;));    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453         }                                                                                                </span>
<span  style=""> 454                                                                                                          </span>
<span class="-8455698330779530293" onmouseenter="enter('-8455698330779530293');" onmouseout="out('-8455698330779530293');" style=""> 455         return new AuthorizationServiceConfiguration(                                                    </span>
<span class="-9206356706352718453" onmouseenter="enter('-9206356706352718453');" onmouseout="out('-9206356706352718453');" style=""> 456                 authorizationEndpoint,                                                                   </span>
<span class="-6119344076232034280" onmouseenter="enter('-6119344076232034280');" onmouseout="out('-6119344076232034280');" style=""> 457                 tokenEndpoint,                                                                           </span>
<span class="-4224958759407269631" onmouseenter="enter('-4224958759407269631');" onmouseout="out('-4224958759407269631');" style=""> 458                 registrationEndpoint                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 459         );                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460     }                                                                                                    </span>
<span  style=""> 461                                                                                                          </span>
<span class="-4130257184876230563" onmouseenter="enter('-4130257184876230563');" onmouseout="out('-4130257184876230563');" style=""> 462     private void warmChromeCustomTab(Context context, final String issuer) {                             </span>
<span class="-4012796735492941375" onmouseenter="enter('-4012796735492941375');" onmouseout="out('-4012796735492941375');" style=""> 463         CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 464             @Override                                                                                    </span>
<span class="4306327880536035079" onmouseenter="enter('4306327880536035079');" onmouseout="out('4306327880536035079');" style=""> 465             public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {      </span>
<span class="-5035114608817725139" onmouseenter="enter('-5035114608817725139');" onmouseout="out('-5035114608817725139');" style=""> 466                 client.warmup(0);                                                                        </span>
<span class="5970961959698416627" onmouseenter="enter('5970961959698416627');" onmouseout="out('5970961959698416627');" style=""><abbr title=" 467                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bundle&gt;emptyList());"> 467                 client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collect🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468             }                                                                                            </span>
<span  style=""> 469                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 470             @Override                                                                                    </span>
<span class="6231636659664649995" onmouseenter="enter('6231636659664649995');" onmouseout="out('6231636659664649995');" style=""> 471             public void onServiceDisconnected(ComponentName name) {                                      </span>
<span  style=""> 472                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 474         };                                                                                               </span>
<span class="5767142201781268255" onmouseenter="enter('5767142201781268255');" onmouseout="out('5767142201781268255');" style=""> 475         CustomTabsClient.bindCustomTabsService(context, CUSTOM_TAB_PACKAGE_NAME, connection);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476     }                                                                                                    </span>
<span  style=""> 477                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 478     @Override                                                                                            </span>
<span class="-4337880705383881802" onmouseenter="enter('-4337880705383881802');" onmouseout="out('-4337880705383881802');" style=""> 479     public void onNewIntent(Intent intent) {                                                             </span>
<span  style=""> 480                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481     }                                                                                                    </span>
<span  style=""> 482                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 483     @Override                                                                                            </span>
<span class="190238665005496725" onmouseenter="enter('190238665005496725');" onmouseout="out('190238665005496725');" style=""> 484     public String getName() {                                                                            </span>
<span class="4315075324919368681" onmouseenter="enter('4315075324919368681');" onmouseout="out('4315075324919368681');" style=""> 485         return &quot;RNAppAuth&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487 }                                                                                                        </span>









































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-6280296900167357794" onmouseenter="enter('-6280296900167357794');" onmouseout="out('-6280296900167357794');" style="">   1  package com.rnappauth;                                                                                            </span>
<span  style="">   2                                                                                                                    </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3  import android.app.Activity;                                                                                      </span>
<span class="2265467446931963889" onmouseenter="enter('2265467446931963889');" onmouseout="out('2265467446931963889');" style="">   4  import android.app.PendingIntent;                                                                                 </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">   5  import android.content.ComponentName;                                                                             </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   6  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   7  import android.content.Intent;                                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   8  import android.net.Uri;                                                                                           </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   9  import android.os.Bundle;                                                                                         </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10  import androidx.annotation.Nullable;                                                                              </span>
<span class="-4621922491292668474" onmouseenter="enter('-4621922491292668474');" onmouseout="out('-4621922491292668474');" style="">  11  import androidx.browser.customtabs.CustomTabsCallback;                                                            </span>
<span class="5786009149739133921" onmouseenter="enter('5786009149739133921');" onmouseout="out('5786009149739133921');" style="">  12  import androidx.browser.customtabs.CustomTabsClient;                                                              </span>
<span class="6730446154443378273" onmouseenter="enter('6730446154443378273');" onmouseout="out('6730446154443378273');" style="">  13  import androidx.browser.customtabs.CustomTabsServiceConnection;                                                   </span>
<span  style="">  14                                                                                                                    </span>
<span class="7327608205307094785" onmouseenter="enter('7327608205307094785');" onmouseout="out('7327608205307094785');" style="">  15  import com.facebook.react.bridge.ActivityEventListener;                                                           </span>
<span class="1744055796152404290" onmouseenter="enter('1744055796152404290');" onmouseout="out('1744055796152404290');" style="">  16  import com.facebook.react.bridge.ReactApplicationContext;                                                         </span>
<span class="7756046764634890677" onmouseenter="enter('7756046764634890677');" onmouseout="out('7756046764634890677');" style="">  17  import com.facebook.react.bridge.ReactContextBaseJavaModule;                                                      </span>
<span class="-7062843866366665780" onmouseenter="enter('-7062843866366665780');" onmouseout="out('-7062843866366665780');" style="">  18  import com.facebook.react.bridge.ReactMethod;                                                                     </span>
<span class="-9114944870765420144" onmouseenter="enter('-9114944870765420144');" onmouseout="out('-9114944870765420144');" style="">  19  import com.facebook.react.bridge.Promise;                                                                         </span>
<span class="3666939786570277423" onmouseenter="enter('3666939786570277423');" onmouseout="out('3666939786570277423');" style="">  20  import com.facebook.react.bridge.ReadableArray;                                                                   </span>
<span class="5552486474970006352" onmouseenter="enter('5552486474970006352');" onmouseout="out('5552486474970006352');" style="">  21  import com.facebook.react.bridge.ReadableMap;                                                                     </span>
<span class="-2689054124168074705" onmouseenter="enter('-2689054124168074705');" onmouseout="out('-2689054124168074705');" style="">  22  import com.facebook.react.bridge.WritableMap;                                                                     </span>
<span class="7507448895670758430" onmouseenter="enter('7507448895670758430');" onmouseout="out('7507448895670758430');" style="">  23  import com.facebook.react.bridge.ReadableType;                                                                    </span>
<span  style="">  24                                                                                                                    </span>
<span class="2824452556317040091" onmouseenter="enter('2824452556317040091');" onmouseout="out('2824452556317040091');" style="">  25  import com.rnappauth.utils.MapUtil;                                                                               </span>
<span class="2320112657500195094" onmouseenter="enter('2320112657500195094');" onmouseout="out('2320112657500195094');" style="">  26  import com.rnappauth.utils.UnsafeConnectionBuilder;                                                               </span>
<span class="5385195114029684108" onmouseenter="enter('5385195114029684108');" onmouseout="out('5385195114029684108');" style="">  27  import com.rnappauth.utils.TokenResponseFactory;                                                                  </span>
<span class="-7309342380344421476" onmouseenter="enter('-7309342380344421476');" onmouseout="out('-7309342380344421476');" style="">  28  import com.rnappauth.utils.CustomConnectionBuilder;                                                               </span>
<span  style="">  29                                                                                                                    </span>
<span class="2084880808431135122" onmouseenter="enter('2084880808431135122');" onmouseout="out('2084880808431135122');" style="">  30  import net.openid.appauth.AppAuthConfiguration;                                                                   </span>
<span class="-6153791587225110013" onmouseenter="enter('-6153791587225110013');" onmouseout="out('-6153791587225110013');" style="">  31  import net.openid.appauth.AuthorizationException;                                                                 </span>
<span class="220855730882953420" onmouseenter="enter('220855730882953420');" onmouseout="out('220855730882953420');" style="">  32  import net.openid.appauth.AuthorizationRequest;                                                                   </span>
<span class="3507212550601358175" onmouseenter="enter('3507212550601358175');" onmouseout="out('3507212550601358175');" style="">  33  import net.openid.appauth.AuthorizationResponse;                                                                  </span>
<span class="6486087234581123017" onmouseenter="enter('6486087234581123017');" onmouseout="out('6486087234581123017');" style="">  34  import net.openid.appauth.AuthorizationService;                                                                   </span>
<span class="-1918380963859750931" onmouseenter="enter('-1918380963859750931');" onmouseout="out('-1918380963859750931');" style="">  35  import net.openid.appauth.AuthorizationServiceConfiguration;                                                      </span>
<span class="-1745886087889911862" onmouseenter="enter('-1745886087889911862');" onmouseout="out('-1745886087889911862');" style="">  36  import net.openid.appauth.ClientAuthentication;                                                                   </span>
<span class="5802881313983385714" onmouseenter="enter('5802881313983385714');" onmouseout="out('5802881313983385714');" style="">  37  import net.openid.appauth.ClientSecretBasic;                                                                      </span>
<span class="6044047429679939107" onmouseenter="enter('6044047429679939107');" onmouseout="out('6044047429679939107');" style="">  38  import net.openid.appauth.ClientSecretPost;                                                                       </span>
<span class="-7057741429751790751" onmouseenter="enter('-7057741429751790751');" onmouseout="out('-7057741429751790751');" style="">  39  import net.openid.appauth.ResponseTypeValues;                                                                     </span>
<span class="7041795251639894294" onmouseenter="enter('7041795251639894294');" onmouseout="out('7041795251639894294');" style="">  40  import net.openid.appauth.TokenResponse;                                                                          </span>
<span class="4423191746780431402" onmouseenter="enter('4423191746780431402');" onmouseout="out('4423191746780431402');" style="">  41  import net.openid.appauth.TokenRequest;                                                                           </span>
<span class="-5344047661436712974" onmouseenter="enter('-5344047661436712974');" onmouseout="out('-5344047661436712974');" style="">  42  import net.openid.appauth.connectivity.ConnectionBuilder;                                                         </span>
<span class="2682978576506672064" onmouseenter="enter('2682978576506672064');" onmouseout="out('2682978576506672064');" style="">  43  import net.openid.appauth.connectivity.DefaultConnectionBuilder;                                                  </span>
<span  style="">  44                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  45  import java.util.Collections;                                                                                     </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  46  import java.util.HashMap;                                                                                         </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  47  import java.util.Map;                                                                                             </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  48  import java.util.concurrent.atomic.AtomicReference;                                                               </span>
<span class="6937050046386248317" onmouseenter="enter('6937050046386248317');" onmouseout="out('6937050046386248317');" style="">  49  import java.util.concurrent.CountDownLatch;                                                                       </span>
<span  style="">  50                                                                                                                    </span>
<span class="6575769426762835403" onmouseenter="enter('6575769426762835403');" onmouseout="out('6575769426762835403');" style="">  51  public class RNAppAuthModule extends ReactContextBaseJavaModule implements ActivityEventListener {                </span>
<span  style="">  52                                                                                                                    </span>
<span class="8401162781518473365" onmouseenter="enter('8401162781518473365');" onmouseout="out('8401162781518473365');" style="">  53      public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;                                    </span>
<span  style="">  54                                                                                                                    </span>
<span class="6180419538961108965" onmouseenter="enter('6180419538961108965');" onmouseout="out('6180419538961108965');" style="">  55      private final ReactApplicationContext reactContext;                                                           </span>
<span class="1869321332520936904" onmouseenter="enter('1869321332520936904');" onmouseout="out('1869321332520936904');" style="">  56      private Promise promise;                                                                                      </span>
<span class="504355591559206068" onmouseenter="enter('504355591559206068');" onmouseout="out('504355591559206068');" style="">  57      private Boolean dangerouslyAllowInsecureHttpRequests;                                                         </span>
<span class="6877933566748299598" onmouseenter="enter('6877933566748299598');" onmouseout="out('6877933566748299598');" style="">  58      private String clientAuthMethod = &quot;basic&quot;;                                                                    </span>
<span class="5073960437150900627" onmouseenter="enter('5073960437150900627');" onmouseout="out('5073960437150900627');" style="">  59      private Map&lt;String, String&gt; authorizationRequestHeaders = null;                                               </span>
<span class="493655431939084947" onmouseenter="enter('493655431939084947');" onmouseout="out('493655431939084947');" style="">  60      private Map&lt;String, String&gt; tokenRequestHeaders = null;                                                       </span>
<span class="4071237130655105462" onmouseenter="enter('4071237130655105462');" onmouseout="out('4071237130655105462');" style="">  61      private Map&lt;String, String&gt; additionalParametersMap;                                                          </span>
<span class="266383520389269247" onmouseenter="enter('266383520389269247');" onmouseout="out('266383520389269247');" style="">  62      private String clientSecret;                                                                                  </span>
<span class="-2587280928065129913" onmouseenter="enter('-2587280928065129913');" onmouseout="out('-2587280928065129913');" style=""><abbr title="  63      private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;();">  63      private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;🔵</abbr></span>
<span class="-7004558742358285463" onmouseenter="enter('-7004558742358285463');" onmouseout="out('-7004558742358285463');" style="">  64      private boolean isPrefetched = false;                                                                         </span>
<span  style="">  65                                                                                                                    </span>
<span class="-978447563967948693" onmouseenter="enter('-978447563967948693');" onmouseout="out('-978447563967948693');" style="">  66      public RNAppAuthModule(ReactApplicationContext reactContext) {                                                </span>
<span class="-1443603959286428543" onmouseenter="enter('-1443603959286428543');" onmouseout="out('-1443603959286428543');" style="">  67          super(reactContext);                                                                                      </span>
<span class="3003228313870805798" onmouseenter="enter('3003228313870805798');" onmouseout="out('3003228313870805798');" style="">  68          this.reactContext = reactContext;                                                                         </span>
<span class="6669990586656871028" onmouseenter="enter('6669990586656871028');" onmouseout="out('6669990586656871028');" style="">  69          reactContext.addActivityEventListener(this);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70      }                                                                                                             </span>
<span  style="">  71                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style="">  72      @ReactMethod                                                                                                  </span>
<span class="-5002037316527958427" onmouseenter="enter('-5002037316527958427');" onmouseout="out('-5002037316527958427');" style="">  73      public void prefetchConfiguration(                                                                            </span>
<span class="-8094929847941500576" onmouseenter="enter('-8094929847941500576');" onmouseout="out('-8094929847941500576');" style="">  74          final Boolean warmAndPrefetchChrome,                                                                      </span>
<span class="-1461695631126767390" onmouseenter="enter('-1461695631126767390');" onmouseout="out('-1461695631126767390');" style="">  75          final String issuer,                                                                                      </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style="">  76          final String redirectUrl,                                                                                 </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style="">  77          final String clientId,                                                                                    </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style="">  78          final ReadableArray scopes,                                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style="">  79          final ReadableMap serviceConfiguration,                                                                   </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style="">  80          final Boolean dangerouslyAllowInsecureHttpRequests,                                                       </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style="">  81          final ReadableMap headers,                                                                                </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style="">  82          final Promise promise                                                                                     </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style="">  83      ) {                                                                                                           </span>
<span class="-7526945842846133690" onmouseenter="enter('-7526945842846133690');" onmouseout="out('-7526945842846133690');" style="">  84          if (warmAndPrefetchChrome) {                                                                              </span>
<span class="8703515971997686923" onmouseenter="enter('8703515971997686923');" onmouseout="out('8703515971997686923');" style="">  85              warmChromeCustomTab(reactContext, issuer);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86          }                                                                                                         </span>
<span  style="">  87                                                                                                                    </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style="">  88          this.parseHeaderMap(headers);                                                                             </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title="  89          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);">  89          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.autho🔵</abbr></span>
<span class="8517032726698162354" onmouseenter="enter('8517032726698162354');" onmouseout="out('8517032726698162354');" style="">  90          final CountDownLatch fetchConfigurationLatch = new CountDownLatch(1);                                     </span>
<span  style="">  91                                                                                                                    </span>
<span class="-7471939844701867604" onmouseenter="enter('-7471939844701867604');" onmouseout="out('-7471939844701867604');" style="">  92          if(!isPrefetched) {                                                                                       </span>
<span class="-8580903789630998000" onmouseenter="enter('-8580903789630998000');" onmouseout="out('-8580903789630998000');" style="">  93              if (serviceConfiguration != null &amp;&amp; mServiceConfiguration.get() == null) {                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  94                  try {                                                                                             </span>
<span class="-5277191699256196698" onmouseenter="enter('-5277191699256196698');" onmouseout="out('-5277191699256196698');" style="">  95                      mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguration));     </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style="">  96                      isPrefetched = true;                                                                          </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style="">  97                      fetchConfigurationLatch.countDown();                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="">  98                  } catch (Exception e) {                                                                           </span>
<span class="-8239593343121465313" onmouseenter="enter('-8239593343121465313');" onmouseout="out('-8239593343121465313');" style="">  99                      promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);               </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100                  }                                                                                                 </span>
<span class="7986155546390017313" onmouseenter="enter('7986155546390017313');" onmouseout="out('7986155546390017313');" style=""> 101              } else if (mServiceConfiguration.get() == null) {                                                     </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 102                  final Uri issuerUri = Uri.parse(issuer);                                                          </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 103                  AuthorizationServiceConfiguration.fetchFromUrl(                                                   </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 104                          buildConfigurationUriFromIssuer(issuerUri),                                               </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 105                          new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                   </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 106                              public void onFetchConfigurationCompleted(                                            </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 107                                      @Nullable AuthorizationServiceConfiguration fetchedConfiguration,             </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 108                                      @Nullable AuthorizationException ex) {                                        </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 109                                  if (ex != null) {                                                                 </span>
<span class="-2204762563580056008" onmouseenter="enter('-2204762563580056008');" onmouseout="out('-2204762563580056008');" style=""> 110                                      promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to fetch configuration&quot;, ex);       </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 111                                      return;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112                                  }                                                                                 </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 113                                  mServiceConfiguration.set(fetchedConfiguration);                                  </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style=""> 114                                  isPrefetched = true;                                                              </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 115                                  fetchConfigurationLatch.countDown();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116                              }                                                                                     </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 117                          },                                                                                        </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 118                          builder                                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 119                  );                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 121          } else {                                                                                                  </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 122              fetchConfigurationLatch.countDown();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span  style=""> 124                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 125          try {                                                                                                     </span>
<span class="-1907621811022997860" onmouseenter="enter('-1907621811022997860');" onmouseout="out('-1907621811022997860');" style=""> 126              fetchConfigurationLatch.await();                                                                      </span>
<span class="1954864242125272611" onmouseenter="enter('1954864242125272611');" onmouseout="out('1954864242125272611');" style=""> 127              promise.resolve(isPrefetched);                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 128          } catch (Exception e) {                                                                                   </span>
<span class="4386486081711603430" onmouseenter="enter('4386486081711603430');" onmouseout="out('4386486081711603430');" style=""> 129              promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to await fetch configuration&quot;, e);                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131      }                                                                                                             </span>
<span  style=""> 132                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 133      @ReactMethod                                                                                                  </span>
<span class="7303195633629033586" onmouseenter="enter('7303195633629033586');" onmouseout="out('7303195633629033586');" style=""> 134      public void authorize(                                                                                        </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 135              String issuer,                                                                                        </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 136              final String redirectUrl,                                                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 137              final String clientId,                                                                                </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 138              final String clientSecret,                                                                            </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 139              final ReadableArray scopes,                                                                           </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 140              final ReadableMap additionalParameters,                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 141              final ReadableMap serviceConfiguration,                                                               </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 142              final Boolean usePKCE,                                                                                </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 143              final String clientAuthMethod,                                                                        </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 144              final Boolean dangerouslyAllowInsecureHttpRequests,                                                   </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 145              final ReadableMap headers,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 146              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 147      ) {                                                                                                           </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 148          this.parseHeaderMap(headers);                                                                             </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title=" 149          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);"> 149          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.autho🔵</abbr></span>
<span class="3019383581923708916" onmouseenter="enter('3019383581923708916');" onmouseout="out('3019383581923708916');" style=""> 150          final AppAuthConfiguration appAuthConfiguration = this.createAppAuthConfiguration(builder);               </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 151          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 151          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters)🔵</abbr></span>
<span  style=""> 152                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 153          if (clientSecret != null) {                                                                               </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 154              additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155          }                                                                                                         </span>
<span  style=""> 156                                                                                                                    </span>
<span class="5192680332872896216" onmouseenter="enter('5192680332872896216');" onmouseout="out('5192680332872896216');" style=""> 157          // store args in private fields for later use in onActivityResult handler                                 </span>
<span class="-4922073825750036997" onmouseenter="enter('-4922073825750036997');" onmouseout="out('-4922073825750036997');" style=""> 158          this.promise = promise;                                                                                   </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 159          this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                         </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 160          this.additionalParametersMap = additionalParametersMap;                                                   </span>
<span class="-8734683050201249921" onmouseenter="enter('-8734683050201249921');" onmouseout="out('-8734683050201249921');" style=""> 161          this.clientSecret = clientSecret;                                                                         </span>
<span class="3270519662544404418" onmouseenter="enter('3270519662544404418');" onmouseout="out('3270519662544404418');" style=""> 162          this.clientAuthMethod = clientAuthMethod;                                                                 </span>
<span  style=""> 163                                                                                                                    </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""> 164          // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint       </span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 165          if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 166              try {                                                                                                 </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 167                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 167                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mSer🔵</abbr></span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 168                  authorizeWithConfiguration(                                                                       </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 169                          serviceConfig,                                                                            </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 170                          appAuthConfiguration,                                                                     </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 171                          clientId,                                                                                 </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 172                          scopes,                                                                                   </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 173                          redirectUrl,                                                                              </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 174                          usePKCE,                                                                                  </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 175                          additionalParametersMap                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 176                  );                                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 177              } catch (Exception e) {                                                                               </span>
<span class="-229732838093683174" onmouseenter="enter('-229732838093683174');" onmouseout="out('-229732838093683174');" style=""> 178                  promise.reject(&quot;Failed to authenticate&quot;, e.getMessage());                                         </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180          } else {                                                                                                  </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 181              final Uri issuerUri = Uri.parse(issuer);                                                              </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 182              AuthorizationServiceConfiguration.fetchFromUrl(                                                       </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 183                      buildConfigurationUriFromIssuer(issuerUri),                                                   </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 184                      new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                       </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 185                          public void onFetchConfigurationCompleted(                                                </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 186                                  @Nullable AuthorizationServiceConfiguration fetchedConfiguration,                 </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 187                                  @Nullable AuthorizationException ex) {                                            </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 188                              if (ex != null) {                                                                     </span>
<span class="8433363972287261549" onmouseenter="enter('8433363972287261549');" onmouseout="out('8433363972287261549');" style=""> 189                                  promise.reject(&quot;Failed to fetch configuration&quot;, getErrorMessage(ex));             </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 190                                  return;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                              }                                                                                     </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 193                              mServiceConfiguration.set(fetchedConfiguration);                                      </span>
<span  style=""> 194                                                                                                                    </span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 195                              authorizeWithConfiguration(                                                           </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 196                                      fetchedConfiguration,                                                         </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 197                                      appAuthConfiguration,                                                         </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 198                                      clientId,                                                                     </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 199                                      scopes,                                                                       </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 200                                      redirectUrl,                                                                  </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 201                                      usePKCE,                                                                      </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 202                                      additionalParametersMap                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 203                              );                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204                          }                                                                                         </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 205                      },                                                                                            </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 206                      builder                                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 207              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208          }                                                                                                         </span>
<span  style=""> 209                                                                                                                    </span>
<span  style=""> 210                                                                                                                    </span>
<span  style=""> 211                                                                                                                    </span>
<span  style=""> 212                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213      }                                                                                                             </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 215      @ReactMethod                                                                                                  </span>
<span class="-5238780499530126703" onmouseenter="enter('-5238780499530126703');" onmouseout="out('-5238780499530126703');" style=""> 216      public void refresh(                                                                                          </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 217              String issuer,                                                                                        </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 218              final String redirectUrl,                                                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 219              final String clientId,                                                                                </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 220              final String clientSecret,                                                                            </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 221              final String refreshToken,                                                                            </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 222              final ReadableArray scopes,                                                                           </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 223              final ReadableMap additionalParameters,                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 224              final ReadableMap serviceConfiguration,                                                               </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 225              final String clientAuthMethod,                                                                        </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 226              final Boolean dangerouslyAllowInsecureHttpRequests,                                                   </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 227              final ReadableMap headers,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 228              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 229      ) {                                                                                                           </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 230          this.parseHeaderMap(headers);                                                                             </span>
<span class="5750510513523473374" onmouseenter="enter('5750510513523473374');" onmouseout="out('5750510513523473374');" style=""><abbr title=" 231          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders);"> 231          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.token🔵</abbr></span>
<span class="-7964591588332866161" onmouseenter="enter('-7964591588332866161');" onmouseout="out('-7964591588332866161');" style=""> 232          final AppAuthConfiguration appAuthConfiguration = createAppAuthConfiguration(builder);                    </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 233          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 233          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters)🔵</abbr></span>
<span  style=""> 234                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 235          if (clientSecret != null) {                                                                               </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 236              additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237          }                                                                                                         </span>
<span  style=""> 238                                                                                                                    </span>
<span class="1495748746185505707" onmouseenter="enter('1495748746185505707');" onmouseout="out('1495748746185505707');" style=""> 239          // store setting in private field for later use in onActivityResult handler                               </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 240          this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                         </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 241          this.additionalParametersMap = additionalParametersMap;                                                   </span>
<span  style=""> 242                                                                                                                    </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""> 243          // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint       </span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 244          if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 245              try {                                                                                                 </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 246                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 246                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mSer🔵</abbr></span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 247                  refreshWithConfiguration(                                                                         </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 248                          serviceConfig,                                                                            </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 249                          appAuthConfiguration,                                                                     </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 250                          refreshToken,                                                                             </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 251                          clientId,                                                                                 </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 252                          scopes,                                                                                   </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 253                          redirectUrl,                                                                              </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 254                          additionalParametersMap,                                                                  </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 255                          clientAuthMethod,                                                                         </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 256                          clientSecret,                                                                             </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 257                          promise                                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 258                  );                                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 259              } catch (Exception e) {                                                                               </span>
<span class="-4557249980300987138" onmouseenter="enter('-4557249980300987138');" onmouseout="out('-4557249980300987138');" style=""> 260                  promise.reject(&quot;Failed to refresh token&quot;, e.getMessage());                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262          } else {                                                                                                  </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 263              final Uri issuerUri = Uri.parse(issuer);                                                              </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 264              AuthorizationServiceConfiguration.fetchFromUrl(                                                       </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 265                      buildConfigurationUriFromIssuer(issuerUri),                                                   </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 266                      new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                       </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 267                          public void onFetchConfigurationCompleted(                                                </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 268                                  @Nullable AuthorizationServiceConfiguration fetchedConfiguration,                 </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 269                                  @Nullable AuthorizationException ex) {                                            </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 270                              if (ex != null) {                                                                     </span>
<span class="8433363972287261549" onmouseenter="enter('8433363972287261549');" onmouseout="out('8433363972287261549');" style=""> 271                                  promise.reject(&quot;Failed to fetch configuration&quot;, getErrorMessage(ex));             </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 272                                  return;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273                              }                                                                                     </span>
<span  style=""> 274                                                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 275                              mServiceConfiguration.set(fetchedConfiguration);                                      </span>
<span  style=""> 276                                                                                                                    </span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 277                              refreshWithConfiguration(                                                             </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 278                                      fetchedConfiguration,                                                         </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 279                                      appAuthConfiguration,                                                         </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 280                                      refreshToken,                                                                 </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 281                                      clientId,                                                                     </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 282                                      scopes,                                                                       </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 283                                      redirectUrl,                                                                  </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 284                                      additionalParametersMap,                                                      </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 285                                      clientAuthMethod,                                                             </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 286                                      clientSecret,                                                                 </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 287                                      promise                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 288                              );                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289                          }                                                                                         </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 290                      },                                                                                            </span>
<span class="2680658541157360392" onmouseenter="enter('2680658541157360392');" onmouseout="out('2680658541157360392');" style=""> 291                      builder);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292          }                                                                                                         </span>
<span  style=""> 293                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294      }                                                                                                             </span>
<span  style=""> 295                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 296      /*                                                                                                            </span>
<span class="7578951324193379805" onmouseenter="enter('7578951324193379805');" onmouseout="out('7578951324193379805');" style=""> 297       * Called when the OAuth browser activity completes                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 298       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 299      @Override                                                                                                     </span>
<span class="2027722410160164989" onmouseenter="enter('2027722410160164989');" onmouseout="out('2027722410160164989');" style=""> 300      public void onActivityResult(Activity activity, int requestCode, int resultCode, Intent data) {               </span>
<span class="-4639597857217913430" onmouseenter="enter('-4639597857217913430');" onmouseout="out('-4639597857217913430');" style=""> 301          if (requestCode == 0) {                                                                                   </span>
<span class="-5203356024335682166" onmouseenter="enter('-5203356024335682166');" onmouseout="out('-5203356024335682166');" style=""> 302              if (data == null) {                                                                                   </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -                promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                                 </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +                if (promise != null) {                                                                            </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                    promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 306 +                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 307                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308              }                                                                                                     </span>
<span  style=""> 309                                                                                                                    </span>
<span class="1683167759369238332" onmouseenter="enter('1683167759369238332');" onmouseout="out('1683167759369238332');" style=""> 310              final AuthorizationResponse response = AuthorizationResponse.fromIntent(data);                        </span>
<span class="-2661429536108932642" onmouseenter="enter('-2661429536108932642');" onmouseout="out('-2661429536108932642');" style=""> 311              AuthorizationException exception = AuthorizationException.fromIntent(data);                           </span>
<span class="812069196179346176" onmouseenter="enter('812069196179346176');" onmouseout="out('812069196179346176');" style=""> 312              if (exception != null) {                                                                              </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -                promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 314 +                if (promise != null) {                                                                            </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +                    promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 317                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318              }                                                                                                     </span>
<span  style=""> 319                                                                                                                    </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style=""> 320              final Promise authorizePromise = this.promise;                                                        </span>
<span class="5853075131485496752" onmouseenter="enter('5853075131485496752');" onmouseout="out('5853075131485496752');" style=""> 321              final AppAuthConfiguration configuration = createAppAuthConfiguration(                                </span>
<span class="-3586276280695435831" onmouseenter="enter('-3586276280695435831');" onmouseout="out('-3586276280695435831');" style=""> 322                      createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders)  </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 323              );                                                                                                    </span>
<span  style=""> 324                                                                                                                    </span>
<span class="-598339291394324639" onmouseenter="enter('-598339291394324639');" onmouseout="out('-598339291394324639');" style=""> 325              AuthorizationService authService = new AuthorizationService(this.reactContext, configuration);        </span>
<span  style=""> 326                                                                                                                    </span>
<span class="6152215567678252770" onmouseenter="enter('6152215567678252770');" onmouseout="out('6152215567678252770');" style=""> 327              TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap);        </span>
<span  style=""> 328                                                                                                                    </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 329              AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 329              AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenRespo🔵</abbr></span>
<span  style=""> 330                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 331                  @Override                                                                                         </span>
<span class="-8262795349130604582" onmouseenter="enter('-8262795349130604582');" onmouseout="out('-8262795349130604582');" style=""> 332                  public void onTokenRequestCompleted(                                                              </span>
<span class="5619805881636115456" onmouseenter="enter('5619805881636115456');" onmouseout="out('5619805881636115456');" style=""> 333                          TokenResponse resp, AuthorizationException ex) {                                          </span>
<span class="7476284757153148856" onmouseenter="enter('7476284757153148856');" onmouseout="out('7476284757153148856');" style=""> 334                      if (resp != null) {                                                                           </span>
<span class="7607526798956663360" onmouseenter="enter('7607526798956663360');" onmouseout="out('7607526798956663360');" style=""> 335                          WritableMap map = TokenResponseFactory.tokenResponseToMap(resp, response);                </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -                        authorizePromise.resolve(map);                                                            </span>
<span class="-6045783056504489326" onmouseenter="enter('-6045783056504489326');" onmouseout="out('-6045783056504489326');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 337 +                        if (authorizePromise != null) {                                                           </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 338 +                            authorizePromise.resolve(map);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 339 +                        }                                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 340                      } else {                                                                                      </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -                        promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                             </span>
<span class="-1871951378605138055" onmouseenter="enter('-1871951378605138055');" onmouseout="out('-1871951378605138055');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 342 +                        if (promise != null) {                                                                    </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 343 +                            promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 344 +                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346                  }                                                                                                 </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 347              };                                                                                                    </span>
<span  style=""> 348                                                                                                                    </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style=""> 349              if (this.clientSecret != null) {                                                                      </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style=""><abbr title=" 350                  ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 350                  ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthM🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 351                  authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);                 </span>
<span  style=""> 352                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 353              } else {                                                                                              </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 354                  authService.performTokenRequest(tokenRequest, tokenResponseCallback);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355              }                                                                                                     </span>
<span  style=""> 356                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358      }                                                                                                             </span>
<span  style=""> 359                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 360      /*                                                                                                            </span>
<span class="-3037424821439688076" onmouseenter="enter('-3037424821439688076');" onmouseout="out('-3037424821439688076');" style=""> 361       * Authorize user with the provided configuration                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 362       */                                                                                                           </span>
<span class="-1686698148972257501" onmouseenter="enter('-1686698148972257501');" onmouseout="out('-1686698148972257501');" style=""> 363      private void authorizeWithConfiguration(                                                                      </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 364              final AuthorizationServiceConfiguration serviceConfiguration,                                         </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 365              final AppAuthConfiguration appAuthConfiguration,                                                      </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 366              final String clientId,                                                                                </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 367              final ReadableArray scopes,                                                                           </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 368              final String redirectUrl,                                                                             </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 369              final Boolean usePKCE,                                                                                </span>
<span class="4591131233701235058" onmouseenter="enter('4591131233701235058');" onmouseout="out('4591131233701235058');" style=""> 370              final Map&lt;String, String&gt; additionalParametersMap                                                     </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 371      ) {                                                                                                           </span>
<span  style=""> 372                                                                                                                    </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 373          String scopesString = null;                                                                               </span>
<span  style=""> 374                                                                                                                    </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 375          if (scopes != null) {                                                                                     </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 376              scopesString = this.arrayToString(scopes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377          }                                                                                                         </span>
<span  style=""> 378                                                                                                                    </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 379          final Context context = this.reactContext;                                                                </span>
<span class="-4913832152651687292" onmouseenter="enter('-4913832152651687292');" onmouseout="out('-4913832152651687292');" style=""> 380          final Activity currentActivity = getCurrentActivity();                                                    </span>
<span  style=""> 381                                                                                                                    </span>
<span class="1615045173536817183" onmouseenter="enter('1615045173536817183');" onmouseout="out('1615045173536817183');" style=""> 382          AuthorizationRequest.Builder authRequestBuilder =                                                         </span>
<span class="8630572254279098967" onmouseenter="enter('8630572254279098967');" onmouseout="out('8630572254279098967');" style=""> 383                  new AuthorizationRequest.Builder(                                                                 </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 384                          serviceConfiguration,                                                                     </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 385                          clientId,                                                                                 </span>
<span class="4849618716626806999" onmouseenter="enter('4849618716626806999');" onmouseout="out('4849618716626806999');" style=""> 386                          ResponseTypeValues.CODE,                                                                  </span>
<span class="-1639145692422133689" onmouseenter="enter('-1639145692422133689');" onmouseout="out('-1639145692422133689');" style=""> 387                          Uri.parse(redirectUrl)                                                                    </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 388                  );                                                                                                </span>
<span  style=""> 389                                                                                                                    </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 390          if (scopesString != null) {                                                                               </span>
<span class="-8218576309450527961" onmouseenter="enter('-8218576309450527961');" onmouseout="out('-8218576309450527961');" style=""> 391              authRequestBuilder.setScope(scopesString);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392          }                                                                                                         </span>
<span  style=""> 393                                                                                                                    </span>
<span  style=""> 394                                                                                                                    </span>
<span class="7149068665077353053" onmouseenter="enter('7149068665077353053');" onmouseout="out('7149068665077353053');" style=""> 395          if (additionalParametersMap != null) {                                                                    </span>
<span class="-6137327941719445172" onmouseenter="enter('-6137327941719445172');" onmouseout="out('-6137327941719445172');" style=""> 396              // handle additional parameters separately to avoid exceptions from AppAuth                           </span>
<span class="-4729676460784236302" onmouseenter="enter('-4729676460784236302');" onmouseout="out('-4729676460784236302');" style=""> 397              if (additionalParametersMap.containsKey(&quot;display&quot;)) {                                                 </span>
<span class="6740086842281271815" onmouseenter="enter('6740086842281271815');" onmouseout="out('6740086842281271815');" style=""> 398                  authRequestBuilder.setDisplay(additionalParametersMap.get(&quot;display&quot;));                            </span>
<span class="5478676394718524231" onmouseenter="enter('5478676394718524231');" onmouseout="out('5478676394718524231');" style=""> 399                  additionalParametersMap.remove(&quot;display&quot;);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400              }                                                                                                     </span>
<span class="-5162308638975991351" onmouseenter="enter('-5162308638975991351');" onmouseout="out('-5162308638975991351');" style=""> 401              if (additionalParametersMap.containsKey(&quot;login_hint&quot;)) {                                              </span>
<span class="7478322337196261432" onmouseenter="enter('7478322337196261432');" onmouseout="out('7478322337196261432');" style=""> 402                  authRequestBuilder.setLoginHint(additionalParametersMap.get(&quot;login_hint&quot;));                       </span>
<span class="-3825577662921277200" onmouseenter="enter('-3825577662921277200');" onmouseout="out('-3825577662921277200');" style=""> 403                  additionalParametersMap.remove(&quot;login_hint&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404              }                                                                                                     </span>
<span class="-8254180626457365202" onmouseenter="enter('-8254180626457365202');" onmouseout="out('-8254180626457365202');" style=""> 405              if (additionalParametersMap.containsKey(&quot;prompt&quot;)) {                                                  </span>
<span class="2585369211918110761" onmouseenter="enter('2585369211918110761');" onmouseout="out('2585369211918110761');" style=""> 406                  authRequestBuilder.setPrompt(additionalParametersMap.get(&quot;prompt&quot;));                              </span>
<span class="290019989822766287" onmouseenter="enter('290019989822766287');" onmouseout="out('290019989822766287');" style=""> 407                  additionalParametersMap.remove(&quot;prompt&quot;);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408              }                                                                                                     </span>
<span  style=""> 409                                                                                                                    </span>
<span class="-1433627721318603910" onmouseenter="enter('-1433627721318603910');" onmouseout="out('-1433627721318603910');" style=""> 410              authRequestBuilder.setAdditionalParameters(additionalParametersMap);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411          }                                                                                                         </span>
<span  style=""> 412                                                                                                                    </span>
<span class="6295746505532947076" onmouseenter="enter('6295746505532947076');" onmouseout="out('6295746505532947076');" style=""> 413          if (!usePKCE) {                                                                                           </span>
<span class="211047115781987373" onmouseenter="enter('211047115781987373');" onmouseout="out('211047115781987373');" style=""> 414              authRequestBuilder.setCodeVerifier(null);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415          }                                                                                                         </span>
<span  style=""> 416                                                                                                                    </span>
<span class="2874496759892237047" onmouseenter="enter('2874496759892237047');" onmouseout="out('2874496759892237047');" style=""> 417          AuthorizationRequest authRequest = authRequestBuilder.build();                                            </span>
<span  style=""> 418                                                                                                                    </span>
<span class="4248167488592758879" onmouseenter="enter('4248167488592758879');" onmouseout="out('4248167488592758879');" style=""> 419          if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.LOLLIPOP) {                        </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 420              AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);           </span>
<span class="-8712988972948484879" onmouseenter="enter('-8712988972948484879');" onmouseout="out('-8712988972948484879');" style=""> 421              Intent authIntent = authService.getAuthorizationRequestIntent(authRequest);                           </span>
<span  style=""> 422                                                                                                                    </span>
<span class="-1768672139093830544" onmouseenter="enter('-1768672139093830544');" onmouseout="out('-1768672139093830544');" style=""> 423              currentActivity.startActivityForResult(authIntent, 0);                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 424          } else {                                                                                                  </span>
<span class="-5574677103641269793" onmouseenter="enter('-5574677103641269793');" onmouseout="out('-5574677103641269793');" style=""> 425              AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfiguration);   </span>
<span class="-921350943484849229" onmouseenter="enter('-921350943484849229');" onmouseout="out('-921350943484849229');" style=""> 426              PendingIntent pendingIntent = currentActivity.createPendingResult(0, new Intent(), 0);                </span>
<span  style=""> 427                                                                                                                    </span>
<span class="5462088869311657545" onmouseenter="enter('5462088869311657545');" onmouseout="out('5462088869311657545');" style=""> 428              authService.performAuthorizationRequest(authRequest, pendingIntent);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430      }                                                                                                             </span>
<span  style=""> 431                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 432      /*                                                                                                            </span>
<span class="8814346366745541198" onmouseenter="enter('8814346366745541198');" onmouseout="out('8814346366745541198');" style=""> 433       * Refresh authentication token with the provided configuration                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 434       */                                                                                                           </span>
<span class="-7235916799046070057" onmouseenter="enter('-7235916799046070057');" onmouseout="out('-7235916799046070057');" style=""> 435      private void refreshWithConfiguration(                                                                        </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 436              final AuthorizationServiceConfiguration serviceConfiguration,                                         </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 437              final AppAuthConfiguration appAuthConfiguration,                                                      </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 438              final String refreshToken,                                                                            </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 439              final String clientId,                                                                                </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 440              final ReadableArray scopes,                                                                           </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 441              final String redirectUrl,                                                                             </span>
<span class="3078994421067824649" onmouseenter="enter('3078994421067824649');" onmouseout="out('3078994421067824649');" style=""> 442              final Map&lt;String, String&gt; additionalParametersMap,                                                    </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 443              final String clientAuthMethod,                                                                        </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 444              final String clientSecret,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 445              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 446      ) {                                                                                                           </span>
<span  style=""> 447                                                                                                                    </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 448          String scopesString = null;                                                                               </span>
<span  style=""> 449                                                                                                                    </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 450          if (scopes != null) {                                                                                     </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 451              scopesString = this.arrayToString(scopes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452          }                                                                                                         </span>
<span  style=""> 453                                                                                                                    </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 454          final Context context = this.reactContext;                                                                </span>
<span  style=""> 455                                                                                                                    </span>
<span class="-1882592220700818910" onmouseenter="enter('-1882592220700818910');" onmouseout="out('-1882592220700818910');" style=""> 456          TokenRequest.Builder tokenRequestBuilder =                                                                </span>
<span class="-7570030938974274508" onmouseenter="enter('-7570030938974274508');" onmouseout="out('-7570030938974274508');" style=""> 457                  new TokenRequest.Builder(                                                                         </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 458                          serviceConfiguration,                                                                     </span>
<span class="-3028793166139754818" onmouseenter="enter('-3028793166139754818');" onmouseout="out('-3028793166139754818');" style=""> 459                          clientId                                                                                  </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 460                  )                                                                                                 </span>
<span class="5149869235939087614" onmouseenter="enter('5149869235939087614');" onmouseout="out('5149869235939087614');" style=""> 461                          .setRefreshToken(refreshToken)                                                            </span>
<span class="-4168308848344323961" onmouseenter="enter('-4168308848344323961');" onmouseout="out('-4168308848344323961');" style=""> 462                          .setRedirectUri(Uri.parse(redirectUrl));                                                  </span>
<span  style=""> 463                                                                                                                    </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 464          if (scopesString != null) {                                                                               </span>
<span class="-4940100242303343354" onmouseenter="enter('-4940100242303343354');" onmouseout="out('-4940100242303343354');" style=""> 465              tokenRequestBuilder.setScope(scopesString);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466          }                                                                                                         </span>
<span  style=""> 467                                                                                                                    </span>
<span class="1982926752875631058" onmouseenter="enter('1982926752875631058');" onmouseout="out('1982926752875631058');" style=""> 468          if (!additionalParametersMap.isEmpty()) {                                                                 </span>
<span class="6791703352530289305" onmouseenter="enter('6791703352530289305');" onmouseout="out('6791703352530289305');" style=""> 469              tokenRequestBuilder.setAdditionalParameters(additionalParametersMap);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470          }                                                                                                         </span>
<span  style=""> 471                                                                                                                    </span>
<span class="6300215370198990899" onmouseenter="enter('6300215370198990899');" onmouseout="out('6300215370198990899');" style=""> 472          TokenRequest tokenRequest = tokenRequestBuilder.build();                                                  </span>
<span  style=""> 473                                                                                                                    </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 474          AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);               </span>
<span  style=""> 475                                                                                                                    </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 476          AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 476          AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseC🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 477              @Override                                                                                             </span>
<span class="-9019017716153453132" onmouseenter="enter('-9019017716153453132');" onmouseout="out('-9019017716153453132');" style=""><abbr title=" 478              public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException ex) {"> 478              public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException🔵</abbr></span>
<span class="4756227728171050519" onmouseenter="enter('4756227728171050519');" onmouseout="out('4756227728171050519');" style=""> 479                  if (response != null) {                                                                           </span>
<span class="-4071880271889138129" onmouseenter="enter('-4071880271889138129');" onmouseout="out('-4071880271889138129');" style=""> 480                      WritableMap map = TokenResponseFactory.tokenResponseToMap(response);                          </span>
<span class="9181054552595447887" onmouseenter="enter('9181054552595447887');" onmouseout="out('9181054552595447887');" style=""> 481                      promise.resolve(map);                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 482                  } else {                                                                                          </span>
<span class="-797630881355515698" onmouseenter="enter('-797630881355515698');" onmouseout="out('-797630881355515698');" style=""> 483                      promise.reject(&quot;Failed to refresh token&quot;, getErrorMessage(ex));                               </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 486          };                                                                                                        </span>
<span  style=""> 487                                                                                                                    </span>
<span  style=""> 488                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 489          if (clientSecret != null) {                                                                               </span>
<span class="-3955443834186652225" onmouseenter="enter('-3955443834186652225');" onmouseout="out('-3955443834186652225');" style=""> 490              ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod);       </span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 491              authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);                     </span>
<span  style=""> 492                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 493          } else {                                                                                                  </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 494              authService.performTokenRequest(tokenRequest, tokenResponseCallback);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496      }                                                                                                             </span>
<span  style=""> 497                                                                                                                    </span>
<span class="2930218534777413873" onmouseenter="enter('2930218534777413873');" onmouseout="out('2930218534777413873');" style=""> 498      private void parseHeaderMap (ReadableMap headerMap) {                                                         </span>
<span class="-6316489241675673035" onmouseenter="enter('-6316489241675673035');" onmouseout="out('-6316489241675673035');" style=""> 499          if (headerMap == null) {                                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 500              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501          }                                                                                                         </span>
<span class="-8530407112624237580" onmouseenter="enter('-8530407112624237580');" onmouseout="out('-8530407112624237580');" style=""> 502          if (headerMap.hasKey(&quot;authorize&quot;) &amp;&amp; headerMap.getType(&quot;authorize&quot;) == ReadableType.Map) {                </span>
<span class="762039099095363738" onmouseenter="enter('762039099095363738');" onmouseout="out('762039099095363738');" style=""> 503              this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;));       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504          }                                                                                                         </span>
<span class="5768179141818569002" onmouseenter="enter('5768179141818569002');" onmouseout="out('5768179141818569002');" style=""> 505          if (headerMap.hasKey(&quot;token&quot;) &amp;&amp; headerMap.getType(&quot;token&quot;) == ReadableType.Map) {                        </span>
<span class="-4870803436115877491" onmouseenter="enter('-4870803436115877491');" onmouseout="out('-4870803436115877491');" style=""> 506              this.tokenRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;token&quot;));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507          }                                                                                                         </span>
<span  style=""> 508                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 509      }                                                                                                             </span>
<span  style=""> 510                                                                                                                    </span>
<span class="-2276636657842571599" onmouseenter="enter('-2276636657842571599');" onmouseout="out('-2276636657842571599');" style=""> 511      private ClientAuthentication getClientAuthentication(String clientSecret, String clientAuthMethod) {          </span>
<span class="4736948393768361142" onmouseenter="enter('4736948393768361142');" onmouseout="out('4736948393768361142');" style=""> 512          if (clientAuthMethod.equals(&quot;post&quot;)) {                                                                    </span>
<span class="4033722210949459980" onmouseenter="enter('4033722210949459980');" onmouseout="out('4033722210949459980');" style=""> 513              return new ClientSecretPost(clientSecret);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514          }                                                                                                         </span>
<span  style=""> 515                                                                                                                    </span>
<span class="-1107687855860572488" onmouseenter="enter('-1107687855860572488');" onmouseout="out('-1107687855860572488');" style=""> 516          return new ClientSecretBasic(clientSecret);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517      }                                                                                                             </span>
<span  style=""> 518                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 519      /*                                                                                                            </span>
<span class="5090378039448834807" onmouseenter="enter('5090378039448834807');" onmouseout="out('5090378039448834807');" style=""> 520       * Return error information if it is available                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 521       */                                                                                                           </span>
<span class="7325111704754615468" onmouseenter="enter('7325111704754615468');" onmouseout="out('7325111704754615468');" style=""> 522      private String getErrorMessage(AuthorizationException ex){                                                    </span>
<span class="6233744395473659458" onmouseenter="enter('6233744395473659458');" onmouseout="out('6233744395473659458');" style=""> 523          if(ex.errorDescription == null &amp;&amp; ex.error != null)                                                       </span>
<span class="8212520076730053042" onmouseenter="enter('8212520076730053042');" onmouseout="out('8212520076730053042');" style=""> 524              return ex.error;                                                                                      </span>
<span class="-944119096152079377" onmouseenter="enter('-944119096152079377');" onmouseout="out('-944119096152079377');" style=""> 525          return ex.errorDescription;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 526      }                                                                                                             </span>
<span  style=""> 527                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 528      /*                                                                                                            </span>
<span class="6638112631744326921" onmouseenter="enter('6638112631744326921');" onmouseout="out('6638112631744326921');" style=""> 529       * Create a space-delimited string from an array                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 530       */                                                                                                           </span>
<span class="2843730177292313139" onmouseenter="enter('2843730177292313139');" onmouseout="out('2843730177292313139');" style=""> 531      private String arrayToString(ReadableArray array) {                                                           </span>
<span class="-8236782342056480869" onmouseenter="enter('-8236782342056480869');" onmouseout="out('-8236782342056480869');" style=""> 532          StringBuilder strBuilder = new StringBuilder();                                                           </span>
<span class="7278311890620727475" onmouseenter="enter('7278311890620727475');" onmouseout="out('7278311890620727475');" style=""> 533          for (int i = 0; i &lt; array.size(); i++) {                                                                  </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style=""> 534              if (i != 0) {                                                                                         </span>
<span class="-4449242394605741248" onmouseenter="enter('-4449242394605741248');" onmouseout="out('-4449242394605741248');" style=""> 535                  strBuilder.append(&#x27; &#x27;);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 536              }                                                                                                     </span>
<span class="-8205116312766504963" onmouseenter="enter('-8205116312766504963');" onmouseout="out('-8205116312766504963');" style=""> 537              strBuilder.append(array.getString(i));                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538          }                                                                                                         </span>
<span class="-7597052729024482685" onmouseenter="enter('-7597052729024482685');" onmouseout="out('-7597052729024482685');" style=""> 539          return strBuilder.toString();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 540      }                                                                                                             </span>
<span  style=""> 541                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 542      /*                                                                                                            </span>
<span class="5214794569700518887" onmouseenter="enter('5214794569700518887');" onmouseout="out('5214794569700518887');" style=""> 543       * Create an App Auth configuration using the provided connection builder                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 544       */                                                                                                           </span>
<span class="-5342361748775304563" onmouseenter="enter('-5342361748775304563');" onmouseout="out('-5342361748775304563');" style=""> 545      private AppAuthConfiguration createAppAuthConfiguration(ConnectionBuilder connectionBuilder) {                </span>
<span class="-6961363017801118708" onmouseenter="enter('-6961363017801118708');" onmouseout="out('-6961363017801118708');" style=""> 546          return new AppAuthConfiguration                                                                           </span>
<span class="370567544488026574" onmouseenter="enter('370567544488026574');" onmouseout="out('370567544488026574');" style=""> 547                  .Builder()                                                                                        </span>
<span class="6932817517014214209" onmouseenter="enter('6932817517014214209');" onmouseout="out('6932817517014214209');" style=""> 548                  .setConnectionBuilder(connectionBuilder)                                                          </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 549                  .build();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550      }                                                                                                             </span>
<span  style=""> 551                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 552      /*                                                                                                            </span>
<span class="2307564597312892215" onmouseenter="enter('2307564597312892215');" onmouseout="out('2307564597312892215');" style=""> 553       *  Create appropriate connection builder based on provided settings                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 554       */                                                                                                           </span>
<span class="-266307560690147004" onmouseenter="enter('-266307560690147004');" onmouseout="out('-266307560690147004');" style=""><abbr title=" 555      private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; headers) {"> 555      private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; header🔵</abbr></span>
<span class="7318015076305824949" onmouseenter="enter('7318015076305824949');" onmouseout="out('7318015076305824949');" style=""> 556          ConnectionBuilder proxiedBuilder;                                                                         </span>
<span  style=""> 557                                                                                                                    </span>
<span class="-6214248404965356101" onmouseenter="enter('-6214248404965356101');" onmouseout="out('-6214248404965356101');" style=""> 558          if (allowInsecureConnections.equals(true)) {                                                              </span>
<span class="-8652069864919613967" onmouseenter="enter('-8652069864919613967');" onmouseout="out('-8652069864919613967');" style=""> 559              proxiedBuilder =UnsafeConnectionBuilder.INSTANCE;                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 560          } else {                                                                                                  </span>
<span class="-3823294731313489124" onmouseenter="enter('-3823294731313489124');" onmouseout="out('-3823294731313489124');" style=""> 561              proxiedBuilder = DefaultConnectionBuilder.INSTANCE;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 562          }                                                                                                         </span>
<span  style=""> 563                                                                                                                    </span>
<span class="-321326358809916252" onmouseenter="enter('-321326358809916252');" onmouseout="out('-321326358809916252');" style=""> 564          CustomConnectionBuilder customConnection = new CustomConnectionBuilder(proxiedBuilder);                   </span>
<span class="-5872856843685271172" onmouseenter="enter('-5872856843685271172');" onmouseout="out('-5872856843685271172');" style=""> 565          if (headers != null) {                                                                                    </span>
<span class="-4120878389218127223" onmouseenter="enter('-4120878389218127223');" onmouseout="out('-4120878389218127223');" style=""> 566              customConnection.setHeaders(headers);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567          }                                                                                                         </span>
<span  style=""> 568                                                                                                                    </span>
<span class="5629827582834827587" onmouseenter="enter('5629827582834827587');" onmouseout="out('5629827582834827587');" style=""> 569          return customConnection;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 570      }                                                                                                             </span>
<span  style=""> 571                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 572      /*                                                                                                            </span>
<span class="9187662928809351886" onmouseenter="enter('9187662928809351886');" onmouseout="out('9187662928809351886');" style=""> 573       *  Replicated private method from AuthorizationServiceConfiguration                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 574       */                                                                                                           </span>
<span class="2622836649973257205" onmouseenter="enter('2622836649973257205');" onmouseout="out('2622836649973257205');" style=""> 575      private Uri buildConfigurationUriFromIssuer(Uri openIdConnectIssuerUri) {                                     </span>
<span class="-830811466431368071" onmouseenter="enter('-830811466431368071');" onmouseout="out('-830811466431368071');" style=""> 576          return openIdConnectIssuerUri.buildUpon()                                                                 </span>
<span class="7258170423676519924" onmouseenter="enter('7258170423676519924');" onmouseout="out('7258170423676519924');" style=""> 577                  .appendPath(AuthorizationServiceConfiguration.WELL_KNOWN_PATH)                                    </span>
<span class="-3903955623180377764" onmouseenter="enter('-3903955623180377764');" onmouseout="out('-3903955623180377764');" style=""> 578                  .appendPath(AuthorizationServiceConfiguration.OPENID_CONFIGURATION_RESOURCE)                      </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 579                  .build();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 580      }                                                                                                             </span>
<span  style=""> 581                                                                                                                    </span>
<span class="3122274151060887299" onmouseenter="enter('3122274151060887299');" onmouseout="out('3122274151060887299');" style=""><abbr title=" 582      private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfiguration) throws Exception {"> 582      private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfigura🔵</abbr></span>
<span class="4275545280692735139" onmouseenter="enter('4275545280692735139');" onmouseout="out('4275545280692735139');" style=""> 583          if (!serviceConfiguration.hasKey(&quot;authorizationEndpoint&quot;)) {                                              </span>
<span class="3986521017730318395" onmouseenter="enter('3986521017730318395');" onmouseout="out('3986521017730318395');" style=""> 584              throw new Exception(&quot;serviceConfiguration passed without an authorizationEndpoint&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585          }                                                                                                         </span>
<span  style=""> 586                                                                                                                    </span>
<span class="5638598812511759739" onmouseenter="enter('5638598812511759739');" onmouseout="out('5638598812511759739');" style=""> 587          if (!serviceConfiguration.hasKey(&quot;tokenEndpoint&quot;)) {                                                      </span>
<span class="7444064849592215652" onmouseenter="enter('7444064849592215652');" onmouseout="out('7444064849592215652');" style=""> 588              throw new Exception(&quot;serviceConfiguration passed without a tokenEndpoint&quot;);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589          }                                                                                                         </span>
<span  style=""> 590                                                                                                                    </span>
<span class="-3941749567598770425" onmouseenter="enter('-3941749567598770425');" onmouseout="out('-3941749567598770425');" style=""> 591          Uri authorizationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;authorizationEndpoint&quot;));           </span>
<span class="4054930865548070446" onmouseenter="enter('4054930865548070446');" onmouseout="out('4054930865548070446');" style=""> 592          Uri tokenEndpoint = Uri.parse(serviceConfiguration.getString(&quot;tokenEndpoint&quot;));                           </span>
<span class="2264343622444418519" onmouseenter="enter('2264343622444418519');" onmouseout="out('2264343622444418519');" style=""> 593          Uri registrationEndpoint = null;                                                                          </span>
<span class="-4970643399788664483" onmouseenter="enter('-4970643399788664483');" onmouseout="out('-4970643399788664483');" style=""> 594          if (serviceConfiguration.hasKey(&quot;registrationEndpoint&quot;)) {                                                </span>
<span class="1609034589288005797" onmouseenter="enter('1609034589288005797');" onmouseout="out('1609034589288005797');" style=""> 595              registrationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;registrationEndpoint&quot;));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596          }                                                                                                         </span>
<span  style=""> 597                                                                                                                    </span>
<span class="-8455698330779530293" onmouseenter="enter('-8455698330779530293');" onmouseout="out('-8455698330779530293');" style=""> 598          return new AuthorizationServiceConfiguration(                                                             </span>
<span class="-9206356706352718453" onmouseenter="enter('-9206356706352718453');" onmouseout="out('-9206356706352718453');" style=""> 599                  authorizationEndpoint,                                                                            </span>
<span class="-6119344076232034280" onmouseenter="enter('-6119344076232034280');" onmouseout="out('-6119344076232034280');" style=""> 600                  tokenEndpoint,                                                                                    </span>
<span class="-4224958759407269631" onmouseenter="enter('-4224958759407269631');" onmouseout="out('-4224958759407269631');" style=""> 601                  registrationEndpoint                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 602          );                                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 603      }                                                                                                             </span>
<span  style=""> 604                                                                                                                    </span>
<span class="-4130257184876230563" onmouseenter="enter('-4130257184876230563');" onmouseout="out('-4130257184876230563');" style=""> 605      private void warmChromeCustomTab(Context context, final String issuer) {                                      </span>
<span class="-4012796735492941375" onmouseenter="enter('-4012796735492941375');" onmouseout="out('-4012796735492941375');" style=""> 606          CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 607              @Override                                                                                             </span>
<span class="4306327880536035079" onmouseenter="enter('4306327880536035079');" onmouseout="out('4306327880536035079');" style=""> 608              public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {               </span>
<span class="-5035114608817725139" onmouseenter="enter('-5035114608817725139');" onmouseout="out('-5035114608817725139');" style=""> 609                  client.warmup(0);                                                                                 </span>
<span class="5970961959698416627" onmouseenter="enter('5970961959698416627');" onmouseout="out('5970961959698416627');" style=""><abbr title=" 610                  client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bundle&gt;emptyList());"> 610                  client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bun🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 611              }                                                                                                     </span>
<span  style=""> 612                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 613              @Override                                                                                             </span>
<span class="6231636659664649995" onmouseenter="enter('6231636659664649995');" onmouseout="out('6231636659664649995');" style=""> 614              public void onServiceDisconnected(ComponentName name) {                                               </span>
<span  style=""> 615                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 616              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 617          };                                                                                                        </span>
<span class="5767142201781268255" onmouseenter="enter('5767142201781268255');" onmouseout="out('5767142201781268255');" style=""> 618          CustomTabsClient.bindCustomTabsService(context, CUSTOM_TAB_PACKAGE_NAME, connection);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619      }                                                                                                             </span>
<span  style=""> 620                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 621      @Override                                                                                                     </span>
<span class="-4337880705383881802" onmouseenter="enter('-4337880705383881802');" onmouseout="out('-4337880705383881802');" style=""> 622      public void onNewIntent(Intent intent) {                                                                      </span>
<span  style=""> 623                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624      }                                                                                                             </span>
<span  style=""> 625                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 626      @Override                                                                                                     </span>
<span class="190238665005496725" onmouseenter="enter('190238665005496725');" onmouseout="out('190238665005496725');" style=""> 627      public String getName() {                                                                                     </span>
<span class="4315075324919368681" onmouseenter="enter('4315075324919368681');" onmouseout="out('4315075324919368681');" style=""> 628          return &quot;RNAppAuth&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 630  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="-6280296900167357794" onmouseenter="enter('-6280296900167357794');" onmouseout="out('-6280296900167357794');" style="">   1  package com.rnappauth;                                                                                            </span>
<span  style="">   2                                                                                                                    </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3  import android.app.Activity;                                                                                      </span>
<span class="2265467446931963889" onmouseenter="enter('2265467446931963889');" onmouseout="out('2265467446931963889');" style="">   4  import android.app.PendingIntent;                                                                                 </span>
<span class="6810188203727856944" onmouseenter="enter('6810188203727856944');" onmouseout="out('6810188203727856944');" style="">   5  import android.content.ComponentName;                                                                             </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   6  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   7  import android.content.Intent;                                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   8  import android.net.Uri;                                                                                           </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">   9  import android.os.Bundle;                                                                                         </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10  import androidx.annotation.Nullable;                                                                              </span>
<span class="-4621922491292668474" onmouseenter="enter('-4621922491292668474');" onmouseout="out('-4621922491292668474');" style="">  11  import androidx.browser.customtabs.CustomTabsCallback;                                                            </span>
<span class="5786009149739133921" onmouseenter="enter('5786009149739133921');" onmouseout="out('5786009149739133921');" style="">  12  import androidx.browser.customtabs.CustomTabsClient;                                                              </span>
<span class="6730446154443378273" onmouseenter="enter('6730446154443378273');" onmouseout="out('6730446154443378273');" style="">  13  import androidx.browser.customtabs.CustomTabsServiceConnection;                                                   </span>
<span  style="">  14                                                                                                                    </span>
<span class="7327608205307094785" onmouseenter="enter('7327608205307094785');" onmouseout="out('7327608205307094785');" style="">  15  import com.facebook.react.bridge.ActivityEventListener;                                                           </span>
<span class="1744055796152404290" onmouseenter="enter('1744055796152404290');" onmouseout="out('1744055796152404290');" style="">  16  import com.facebook.react.bridge.ReactApplicationContext;                                                         </span>
<span class="7756046764634890677" onmouseenter="enter('7756046764634890677');" onmouseout="out('7756046764634890677');" style="">  17  import com.facebook.react.bridge.ReactContextBaseJavaModule;                                                      </span>
<span class="-7062843866366665780" onmouseenter="enter('-7062843866366665780');" onmouseout="out('-7062843866366665780');" style="">  18  import com.facebook.react.bridge.ReactMethod;                                                                     </span>
<span class="-9114944870765420144" onmouseenter="enter('-9114944870765420144');" onmouseout="out('-9114944870765420144');" style="">  19  import com.facebook.react.bridge.Promise;                                                                         </span>
<span class="3666939786570277423" onmouseenter="enter('3666939786570277423');" onmouseout="out('3666939786570277423');" style="">  20  import com.facebook.react.bridge.ReadableArray;                                                                   </span>
<span class="5552486474970006352" onmouseenter="enter('5552486474970006352');" onmouseout="out('5552486474970006352');" style="">  21  import com.facebook.react.bridge.ReadableMap;                                                                     </span>
<span class="-2689054124168074705" onmouseenter="enter('-2689054124168074705');" onmouseout="out('-2689054124168074705');" style="">  22  import com.facebook.react.bridge.WritableMap;                                                                     </span>
<span class="7507448895670758430" onmouseenter="enter('7507448895670758430');" onmouseout="out('7507448895670758430');" style="">  23  import com.facebook.react.bridge.ReadableType;                                                                    </span>
<span  style="">  24                                                                                                                    </span>
<span class="2824452556317040091" onmouseenter="enter('2824452556317040091');" onmouseout="out('2824452556317040091');" style="">  25  import com.rnappauth.utils.MapUtil;                                                                               </span>
<span class="2320112657500195094" onmouseenter="enter('2320112657500195094');" onmouseout="out('2320112657500195094');" style="">  26  import com.rnappauth.utils.UnsafeConnectionBuilder;                                                               </span>
<span class="5385195114029684108" onmouseenter="enter('5385195114029684108');" onmouseout="out('5385195114029684108');" style="">  27  import com.rnappauth.utils.TokenResponseFactory;                                                                  </span>
<span class="-7309342380344421476" onmouseenter="enter('-7309342380344421476');" onmouseout="out('-7309342380344421476');" style="">  28  import com.rnappauth.utils.CustomConnectionBuilder;                                                               </span>
<span  style="">  29                                                                                                                    </span>
<span class="2084880808431135122" onmouseenter="enter('2084880808431135122');" onmouseout="out('2084880808431135122');" style="">  30  import net.openid.appauth.AppAuthConfiguration;                                                                   </span>
<span class="-6153791587225110013" onmouseenter="enter('-6153791587225110013');" onmouseout="out('-6153791587225110013');" style="">  31  import net.openid.appauth.AuthorizationException;                                                                 </span>
<span class="220855730882953420" onmouseenter="enter('220855730882953420');" onmouseout="out('220855730882953420');" style="">  32  import net.openid.appauth.AuthorizationRequest;                                                                   </span>
<span class="3507212550601358175" onmouseenter="enter('3507212550601358175');" onmouseout="out('3507212550601358175');" style="">  33  import net.openid.appauth.AuthorizationResponse;                                                                  </span>
<span class="6486087234581123017" onmouseenter="enter('6486087234581123017');" onmouseout="out('6486087234581123017');" style="">  34  import net.openid.appauth.AuthorizationService;                                                                   </span>
<span class="-1918380963859750931" onmouseenter="enter('-1918380963859750931');" onmouseout="out('-1918380963859750931');" style="">  35  import net.openid.appauth.AuthorizationServiceConfiguration;                                                      </span>
<span class="-1745886087889911862" onmouseenter="enter('-1745886087889911862');" onmouseout="out('-1745886087889911862');" style="">  36  import net.openid.appauth.ClientAuthentication;                                                                   </span>
<span class="5802881313983385714" onmouseenter="enter('5802881313983385714');" onmouseout="out('5802881313983385714');" style="">  37  import net.openid.appauth.ClientSecretBasic;                                                                      </span>
<span class="6044047429679939107" onmouseenter="enter('6044047429679939107');" onmouseout="out('6044047429679939107');" style="">  38  import net.openid.appauth.ClientSecretPost;                                                                       </span>
<span class="-7057741429751790751" onmouseenter="enter('-7057741429751790751');" onmouseout="out('-7057741429751790751');" style="">  39  import net.openid.appauth.ResponseTypeValues;                                                                     </span>
<span class="7041795251639894294" onmouseenter="enter('7041795251639894294');" onmouseout="out('7041795251639894294');" style="">  40  import net.openid.appauth.TokenResponse;                                                                          </span>
<span class="4423191746780431402" onmouseenter="enter('4423191746780431402');" onmouseout="out('4423191746780431402');" style="">  41  import net.openid.appauth.TokenRequest;                                                                           </span>
<span class="-5344047661436712974" onmouseenter="enter('-5344047661436712974');" onmouseout="out('-5344047661436712974');" style="">  42  import net.openid.appauth.connectivity.ConnectionBuilder;                                                         </span>
<span class="2682978576506672064" onmouseenter="enter('2682978576506672064');" onmouseout="out('2682978576506672064');" style="">  43  import net.openid.appauth.connectivity.DefaultConnectionBuilder;                                                  </span>
<span  style="">  44                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  45  import java.util.Collections;                                                                                     </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  46  import java.util.HashMap;                                                                                         </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  47  import java.util.Map;                                                                                             </span>
<span class="1679953027169218497" onmouseenter="enter('1679953027169218497');" onmouseout="out('1679953027169218497');" style="">  48  import java.util.concurrent.atomic.AtomicReference;                                                               </span>
<span class="6937050046386248317" onmouseenter="enter('6937050046386248317');" onmouseout="out('6937050046386248317');" style="">  49  import java.util.concurrent.CountDownLatch;                                                                       </span>
<span  style="">  50                                                                                                                    </span>
<span class="6575769426762835403" onmouseenter="enter('6575769426762835403');" onmouseout="out('6575769426762835403');" style="">  51  public class RNAppAuthModule extends ReactContextBaseJavaModule implements ActivityEventListener {                </span>
<span  style="">  52                                                                                                                    </span>
<span class="8401162781518473365" onmouseenter="enter('8401162781518473365');" onmouseout="out('8401162781518473365');" style="">  53      public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;                                    </span>
<span  style="">  54                                                                                                                    </span>
<span class="6180419538961108965" onmouseenter="enter('6180419538961108965');" onmouseout="out('6180419538961108965');" style="">  55      private final ReactApplicationContext reactContext;                                                           </span>
<span class="1869321332520936904" onmouseenter="enter('1869321332520936904');" onmouseout="out('1869321332520936904');" style="">  56      private Promise promise;                                                                                      </span>
<span class="504355591559206068" onmouseenter="enter('504355591559206068');" onmouseout="out('504355591559206068');" style="">  57      private Boolean dangerouslyAllowInsecureHttpRequests;                                                         </span>
<span class="6877933566748299598" onmouseenter="enter('6877933566748299598');" onmouseout="out('6877933566748299598');" style="">  58      private String clientAuthMethod = &quot;basic&quot;;                                                                    </span>
<span class="5073960437150900627" onmouseenter="enter('5073960437150900627');" onmouseout="out('5073960437150900627');" style="">  59      private Map&lt;String, String&gt; authorizationRequestHeaders = null;                                               </span>
<span class="493655431939084947" onmouseenter="enter('493655431939084947');" onmouseout="out('493655431939084947');" style="">  60      private Map&lt;String, String&gt; tokenRequestHeaders = null;                                                       </span>
<span class="4071237130655105462" onmouseenter="enter('4071237130655105462');" onmouseout="out('4071237130655105462');" style="">  61      private Map&lt;String, String&gt; additionalParametersMap;                                                          </span>
<span class="266383520389269247" onmouseenter="enter('266383520389269247');" onmouseout="out('266383520389269247');" style="">  62      private String clientSecret;                                                                                  </span>
<span class="-2587280928065129913" onmouseenter="enter('-2587280928065129913');" onmouseout="out('-2587280928065129913');" style=""><abbr title="  63      private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;();">  63      private final AtomicReference&lt;AuthorizationServiceConfiguration&gt; mServiceConfiguration = new AtomicReference&lt;&gt;🔵</abbr></span>
<span class="-7004558742358285463" onmouseenter="enter('-7004558742358285463');" onmouseout="out('-7004558742358285463');" style="">  64      private boolean isPrefetched = false;                                                                         </span>
<span  style="">  65                                                                                                                    </span>
<span class="-978447563967948693" onmouseenter="enter('-978447563967948693');" onmouseout="out('-978447563967948693');" style="">  66      public RNAppAuthModule(ReactApplicationContext reactContext) {                                                </span>
<span class="-1443603959286428543" onmouseenter="enter('-1443603959286428543');" onmouseout="out('-1443603959286428543');" style="">  67          super(reactContext);                                                                                      </span>
<span class="3003228313870805798" onmouseenter="enter('3003228313870805798');" onmouseout="out('3003228313870805798');" style="">  68          this.reactContext = reactContext;                                                                         </span>
<span class="6669990586656871028" onmouseenter="enter('6669990586656871028');" onmouseout="out('6669990586656871028');" style="">  69          reactContext.addActivityEventListener(this);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70      }                                                                                                             </span>
<span  style="">  71                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style="">  72      @ReactMethod                                                                                                  </span>
<span class="-5002037316527958427" onmouseenter="enter('-5002037316527958427');" onmouseout="out('-5002037316527958427');" style="">  73      public void prefetchConfiguration(                                                                            </span>
<span class="-8094929847941500576" onmouseenter="enter('-8094929847941500576');" onmouseout="out('-8094929847941500576');" style="">  74          final Boolean warmAndPrefetchChrome,                                                                      </span>
<span class="-1461695631126767390" onmouseenter="enter('-1461695631126767390');" onmouseout="out('-1461695631126767390');" style="">  75          final String issuer,                                                                                      </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style="">  76          final String redirectUrl,                                                                                 </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style="">  77          final String clientId,                                                                                    </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style="">  78          final ReadableArray scopes,                                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style="">  79          final ReadableMap serviceConfiguration,                                                                   </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style="">  80          final Boolean dangerouslyAllowInsecureHttpRequests,                                                       </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style="">  81          final ReadableMap headers,                                                                                </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style="">  82          final Promise promise                                                                                     </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style="">  83      ) {                                                                                                           </span>
<span class="-7526945842846133690" onmouseenter="enter('-7526945842846133690');" onmouseout="out('-7526945842846133690');" style="">  84          if (warmAndPrefetchChrome) {                                                                              </span>
<span class="8703515971997686923" onmouseenter="enter('8703515971997686923');" onmouseout="out('8703515971997686923');" style="">  85              warmChromeCustomTab(reactContext, issuer);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86          }                                                                                                         </span>
<span  style="">  87                                                                                                                    </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style="">  88          this.parseHeaderMap(headers);                                                                             </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title="  89          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);">  89          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.autho🔵</abbr></span>
<span class="8517032726698162354" onmouseenter="enter('8517032726698162354');" onmouseout="out('8517032726698162354');" style="">  90          final CountDownLatch fetchConfigurationLatch = new CountDownLatch(1);                                     </span>
<span  style="">  91                                                                                                                    </span>
<span class="-7471939844701867604" onmouseenter="enter('-7471939844701867604');" onmouseout="out('-7471939844701867604');" style="">  92          if(!isPrefetched) {                                                                                       </span>
<span class="-8580903789630998000" onmouseenter="enter('-8580903789630998000');" onmouseout="out('-8580903789630998000');" style="">  93              if (serviceConfiguration != null &amp;&amp; mServiceConfiguration.get() == null) {                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  94                  try {                                                                                             </span>
<span class="-5277191699256196698" onmouseenter="enter('-5277191699256196698');" onmouseout="out('-5277191699256196698');" style="">  95                      mServiceConfiguration.set(createAuthorizationServiceConfiguration(serviceConfiguration));     </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style="">  96                      isPrefetched = true;                                                                          </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style="">  97                      fetchConfigurationLatch.countDown();                                                          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="">  98                  } catch (Exception e) {                                                                           </span>
<span class="-8239593343121465313" onmouseenter="enter('-8239593343121465313');" onmouseout="out('-8239593343121465313');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -                    promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);               </span>
<span class="6809300863683709814" onmouseenter="enter('6809300863683709814');" onmouseout="out('6809300863683709814');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +                    promise.reject(&quot;configuration_error&quot;, &quot;Failed to convert serviceConfiguration&quot;, e);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101                  }                                                                                                 </span>
<span class="7986155546390017313" onmouseenter="enter('7986155546390017313');" onmouseout="out('7986155546390017313');" style=""> 102              } else if (mServiceConfiguration.get() == null) {                                                     </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 103                  final Uri issuerUri = Uri.parse(issuer);                                                          </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 104                  AuthorizationServiceConfiguration.fetchFromUrl(                                                   </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 105                          buildConfigurationUriFromIssuer(issuerUri),                                               </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 106                          new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                   </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 107                              public void onFetchConfigurationCompleted(                                            </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 108                                      @Nullable AuthorizationServiceConfiguration fetchedConfiguration,             </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 109                                      @Nullable AuthorizationException ex) {                                        </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 110                                  if (ex != null) {                                                                 </span>
<span class="-2204762563580056008" onmouseenter="enter('-2204762563580056008');" onmouseout="out('-2204762563580056008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -                                    promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to fetch configuration&quot;, ex);       </span>
<span class="6863513032854295921" onmouseenter="enter('6863513032854295921');" onmouseout="out('6863513032854295921');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 112 +                                    promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configuration&quot;, ex);"> 112 +                                    promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to fetch configura🔵</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 113                                      return;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114                                  }                                                                                 </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 115                                  mServiceConfiguration.set(fetchedConfiguration);                                  </span>
<span class="-3756484855427077276" onmouseenter="enter('-3756484855427077276');" onmouseout="out('-3756484855427077276');" style=""> 116                                  isPrefetched = true;                                                              </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 117                                  fetchConfigurationLatch.countDown();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118                              }                                                                                     </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 119                          },                                                                                        </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 120                          builder                                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 121                  );                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 123          } else {                                                                                                  </span>
<span class="-4438200880561083184" onmouseenter="enter('-4438200880561083184');" onmouseout="out('-4438200880561083184');" style=""> 124              fetchConfigurationLatch.countDown();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125          }                                                                                                         </span>
<span  style=""> 126                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 127          try {                                                                                                     </span>
<span class="-1907621811022997860" onmouseenter="enter('-1907621811022997860');" onmouseout="out('-1907621811022997860');" style=""> 128              fetchConfigurationLatch.await();                                                                      </span>
<span class="1954864242125272611" onmouseenter="enter('1954864242125272611');" onmouseout="out('1954864242125272611');" style=""> 129              promise.resolve(isPrefetched);                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 130          } catch (Exception e) {                                                                                   </span>
<span class="4386486081711603430" onmouseenter="enter('4386486081711603430');" onmouseout="out('4386486081711603430');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -            promise.reject(&quot;RNAppAuth Error&quot;, &quot;Failed to await fetch configuration&quot;, e);                          </span>
<span class="1768900707370095440" onmouseenter="enter('1768900707370095440');" onmouseout="out('1768900707370095440');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +            promise.reject(&quot;service_configuration_fetch_error&quot;, &quot;Failed to await fetch configuration&quot;, e);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134      }                                                                                                             </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 136      @ReactMethod                                                                                                  </span>
<span class="7303195633629033586" onmouseenter="enter('7303195633629033586');" onmouseout="out('7303195633629033586');" style=""> 137      public void authorize(                                                                                        </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 138              String issuer,                                                                                        </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 139              final String redirectUrl,                                                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 140              final String clientId,                                                                                </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 141              final String clientSecret,                                                                            </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 142              final ReadableArray scopes,                                                                           </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 143              final ReadableMap additionalParameters,                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 144              final ReadableMap serviceConfiguration,                                                               </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 145              final Boolean usePKCE,                                                                                </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 146              final String clientAuthMethod,                                                                        </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 147              final Boolean dangerouslyAllowInsecureHttpRequests,                                                   </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 148              final ReadableMap headers,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 149              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 150      ) {                                                                                                           </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 151          this.parseHeaderMap(headers);                                                                             </span>
<span class="7643190933574465169" onmouseenter="enter('7643190933574465169');" onmouseout="out('7643190933574465169');" style=""><abbr title=" 152          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.authorizationRequestHeaders);"> 152          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.autho🔵</abbr></span>
<span class="3019383581923708916" onmouseenter="enter('3019383581923708916');" onmouseout="out('3019383581923708916');" style=""> 153          final AppAuthConfiguration appAuthConfiguration = this.createAppAuthConfiguration(builder);               </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 154          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 154          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters)🔵</abbr></span>
<span  style=""> 155                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 156          if (clientSecret != null) {                                                                               </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 157              additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158          }                                                                                                         </span>
<span  style=""> 159                                                                                                                    </span>
<span class="5192680332872896216" onmouseenter="enter('5192680332872896216');" onmouseout="out('5192680332872896216');" style=""> 160          // store args in private fields for later use in onActivityResult handler                                 </span>
<span class="-4922073825750036997" onmouseenter="enter('-4922073825750036997');" onmouseout="out('-4922073825750036997');" style=""> 161          this.promise = promise;                                                                                   </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 162          this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                         </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 163          this.additionalParametersMap = additionalParametersMap;                                                   </span>
<span class="-8734683050201249921" onmouseenter="enter('-8734683050201249921');" onmouseout="out('-8734683050201249921');" style=""> 164          this.clientSecret = clientSecret;                                                                         </span>
<span class="3270519662544404418" onmouseenter="enter('3270519662544404418');" onmouseout="out('3270519662544404418');" style=""> 165          this.clientAuthMethod = clientAuthMethod;                                                                 </span>
<span  style=""> 166                                                                                                                    </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""> 167          // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint       </span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 168          if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 169              try {                                                                                                 </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 170                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 170                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mSer🔵</abbr></span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 171                  authorizeWithConfiguration(                                                                       </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 172                          serviceConfig,                                                                            </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 173                          appAuthConfiguration,                                                                     </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 174                          clientId,                                                                                 </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 175                          scopes,                                                                                   </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 176                          redirectUrl,                                                                              </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 177                          usePKCE,                                                                                  </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 178                          additionalParametersMap                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 179                  );                                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 180              } catch (Exception e) {                                                                               </span>
<span class="-229732838093683174" onmouseenter="enter('-229732838093683174');" onmouseout="out('-229732838093683174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                promise.reject(&quot;Failed to authenticate&quot;, e.getMessage());                                         </span>
<span class="-3857326443207234519" onmouseenter="enter('-3857326443207234519');" onmouseout="out('-3857326443207234519');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +                promise.reject(&quot;authentication_failed&quot;, e.getMessage());                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 184          } else {                                                                                                  </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 185              final Uri issuerUri = Uri.parse(issuer);                                                              </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 186              AuthorizationServiceConfiguration.fetchFromUrl(                                                       </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 187                      buildConfigurationUriFromIssuer(issuerUri),                                                   </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 188                      new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                       </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 189                          public void onFetchConfigurationCompleted(                                                </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 190                                  @Nullable AuthorizationServiceConfiguration fetchedConfiguration,                 </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 191                                  @Nullable AuthorizationException ex) {                                            </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 192                              if (ex != null) {                                                                     </span>
<span class="8433363972287261549" onmouseenter="enter('8433363972287261549');" onmouseout="out('8433363972287261549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                                promise.reject(&quot;Failed to fetch configuration&quot;, getErrorMessage(ex));             </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +                                promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 195                                  return;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196                              }                                                                                     </span>
<span  style=""> 197                                                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 198                              mServiceConfiguration.set(fetchedConfiguration);                                      </span>
<span  style=""> 199                                                                                                                    </span>
<span class="-1486526546209877526" onmouseenter="enter('-1486526546209877526');" onmouseout="out('-1486526546209877526');" style=""> 200                              authorizeWithConfiguration(                                                           </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 201                                      fetchedConfiguration,                                                         </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 202                                      appAuthConfiguration,                                                         </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 203                                      clientId,                                                                     </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 204                                      scopes,                                                                       </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 205                                      redirectUrl,                                                                  </span>
<span class="-6035018429398733383" onmouseenter="enter('-6035018429398733383');" onmouseout="out('-6035018429398733383');" style=""> 206                                      usePKCE,                                                                      </span>
<span class="2881611988086822402" onmouseenter="enter('2881611988086822402');" onmouseout="out('2881611988086822402');" style=""> 207                                      additionalParametersMap                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 208                              );                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209                          }                                                                                         </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 210                      },                                                                                            </span>
<span class="-6127323510460163099" onmouseenter="enter('-6127323510460163099');" onmouseout="out('-6127323510460163099');" style=""> 211                      builder                                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 212              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213          }                                                                                                         </span>
<span  style=""> 214                                                                                                                    </span>
<span  style=""> 215                                                                                                                    </span>
<span  style=""> 216                                                                                                                    </span>
<span  style=""> 217                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218      }                                                                                                             </span>
<span  style=""> 219                                                                                                                    </span>
<span class="-141978935869821236" onmouseenter="enter('-141978935869821236');" onmouseout="out('-141978935869821236');" style=""> 220      @ReactMethod                                                                                                  </span>
<span class="-5238780499530126703" onmouseenter="enter('-5238780499530126703');" onmouseout="out('-5238780499530126703');" style=""> 221      public void refresh(                                                                                          </span>
<span class="-6582977741210267495" onmouseenter="enter('-6582977741210267495');" onmouseout="out('-6582977741210267495');" style=""> 222              String issuer,                                                                                        </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 223              final String redirectUrl,                                                                             </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 224              final String clientId,                                                                                </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 225              final String clientSecret,                                                                            </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 226              final String refreshToken,                                                                            </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 227              final ReadableArray scopes,                                                                           </span>
<span class="-3845296448405000192" onmouseenter="enter('-3845296448405000192');" onmouseout="out('-3845296448405000192');" style=""> 228              final ReadableMap additionalParameters,                                                               </span>
<span class="194155253776521026" onmouseenter="enter('194155253776521026');" onmouseout="out('194155253776521026');" style=""> 229              final ReadableMap serviceConfiguration,                                                               </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 230              final String clientAuthMethod,                                                                        </span>
<span class="1508394136448727590" onmouseenter="enter('1508394136448727590');" onmouseout="out('1508394136448727590');" style=""> 231              final Boolean dangerouslyAllowInsecureHttpRequests,                                                   </span>
<span class="7766530789087763454" onmouseenter="enter('7766530789087763454');" onmouseout="out('7766530789087763454');" style=""> 232              final ReadableMap headers,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 233              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 234      ) {                                                                                                           </span>
<span class="-4919309082518309682" onmouseenter="enter('-4919309082518309682');" onmouseout="out('-4919309082518309682');" style=""> 235          this.parseHeaderMap(headers);                                                                             </span>
<span class="5750510513523473374" onmouseenter="enter('5750510513523473374');" onmouseout="out('5750510513523473374');" style=""><abbr title=" 236          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders);"> 236          final ConnectionBuilder builder = createConnectionBuilder(dangerouslyAllowInsecureHttpRequests, this.token🔵</abbr></span>
<span class="-7964591588332866161" onmouseenter="enter('-7964591588332866161');" onmouseout="out('-7964591588332866161');" style=""> 237          final AppAuthConfiguration appAuthConfiguration = createAppAuthConfiguration(builder);                    </span>
<span class="-7109956500539147060" onmouseenter="enter('-7109956500539147060');" onmouseout="out('-7109956500539147060');" style=""><abbr title=" 238          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters);"> 238          final HashMap&lt;String, String&gt; additionalParametersMap = MapUtil.readableMapToHashMap(additionalParameters)🔵</abbr></span>
<span  style=""> 239                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 240          if (clientSecret != null) {                                                                               </span>
<span class="-5682406089270036260" onmouseenter="enter('-5682406089270036260');" onmouseout="out('-5682406089270036260');" style=""> 241              additionalParametersMap.put(&quot;client_secret&quot;, clientSecret);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242          }                                                                                                         </span>
<span  style=""> 243                                                                                                                    </span>
<span class="1495748746185505707" onmouseenter="enter('1495748746185505707');" onmouseout="out('1495748746185505707');" style=""> 244          // store setting in private field for later use in onActivityResult handler                               </span>
<span class="3480277836983128979" onmouseenter="enter('3480277836983128979');" onmouseout="out('3480277836983128979');" style=""> 245          this.dangerouslyAllowInsecureHttpRequests = dangerouslyAllowInsecureHttpRequests;                         </span>
<span class="5634104765560395766" onmouseenter="enter('5634104765560395766');" onmouseout="out('5634104765560395766');" style=""> 246          this.additionalParametersMap = additionalParametersMap;                                                   </span>
<span  style=""> 247                                                                                                                    </span>
<span class="2931665236381026116" onmouseenter="enter('2931665236381026116');" onmouseout="out('2931665236381026116');" style=""> 248          // when serviceConfiguration is provided, we don&#x27;t need to hit up the OpenID well-known id endpoint       </span>
<span class="-4807753295584445622" onmouseenter="enter('-4807753295584445622');" onmouseout="out('-4807753295584445622');" style=""> 249          if (serviceConfiguration != null || mServiceConfiguration.get() != null) {                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 250              try {                                                                                                 </span>
<span class="-1759552719269661640" onmouseenter="enter('-1759552719269661640');" onmouseout="out('-1759552719269661640');" style=""><abbr title=" 251                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mServiceConfiguration.get() : createAuthorizationServiceConfiguration(serviceConfiguration);"> 251                  final AuthorizationServiceConfiguration serviceConfig = mServiceConfiguration.get() != null ? mSer🔵</abbr></span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 252                  refreshWithConfiguration(                                                                         </span>
<span class="5543097407325269813" onmouseenter="enter('5543097407325269813');" onmouseout="out('5543097407325269813');" style=""> 253                          serviceConfig,                                                                            </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 254                          appAuthConfiguration,                                                                     </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 255                          refreshToken,                                                                             </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 256                          clientId,                                                                                 </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 257                          scopes,                                                                                   </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 258                          redirectUrl,                                                                              </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 259                          additionalParametersMap,                                                                  </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 260                          clientAuthMethod,                                                                         </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 261                          clientSecret,                                                                             </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 262                          promise                                                                                   </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 263                  );                                                                                                </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 264              } catch (Exception e) {                                                                               </span>
<span class="-4557249980300987138" onmouseenter="enter('-4557249980300987138');" onmouseout="out('-4557249980300987138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                promise.reject(&quot;Failed to refresh token&quot;, e.getMessage());                                        </span>
<span class="7513248397060081198" onmouseenter="enter('7513248397060081198');" onmouseout="out('7513248397060081198');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +                promise.reject(&quot;token_refresh_failed&quot;, e.getMessage());                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 268          } else {                                                                                                  </span>
<span class="5120327872108088277" onmouseenter="enter('5120327872108088277');" onmouseout="out('5120327872108088277');" style=""> 269              final Uri issuerUri = Uri.parse(issuer);                                                              </span>
<span class="3189471842200176563" onmouseenter="enter('3189471842200176563');" onmouseout="out('3189471842200176563');" style=""> 270              AuthorizationServiceConfiguration.fetchFromUrl(                                                       </span>
<span class="-917898007766008740" onmouseenter="enter('-917898007766008740');" onmouseout="out('-917898007766008740');" style=""> 271                      buildConfigurationUriFromIssuer(issuerUri),                                                   </span>
<span class="-5731501030882835631" onmouseenter="enter('-5731501030882835631');" onmouseout="out('-5731501030882835631');" style=""> 272                      new AuthorizationServiceConfiguration.RetrieveConfigurationCallback() {                       </span>
<span class="4930672542407750962" onmouseenter="enter('4930672542407750962');" onmouseout="out('4930672542407750962');" style=""> 273                          public void onFetchConfigurationCompleted(                                                </span>
<span class="6799918846290870191" onmouseenter="enter('6799918846290870191');" onmouseout="out('6799918846290870191');" style=""> 274                                  @Nullable AuthorizationServiceConfiguration fetchedConfiguration,                 </span>
<span class="-3889685016070893683" onmouseenter="enter('-3889685016070893683');" onmouseout="out('-3889685016070893683');" style=""> 275                                  @Nullable AuthorizationException ex) {                                            </span>
<span class="-3832690312485057937" onmouseenter="enter('-3832690312485057937');" onmouseout="out('-3832690312485057937');" style=""> 276                              if (ex != null) {                                                                     </span>
<span class="8433363972287261549" onmouseenter="enter('8433363972287261549');" onmouseout="out('8433363972287261549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                                promise.reject(&quot;Failed to fetch configuration&quot;, getErrorMessage(ex));             </span>
<span class="-1412490292993010468" onmouseenter="enter('-1412490292993010468');" onmouseout="out('-1412490292993010468');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 278 +                                promise.reject(&quot;service_configuration_fetch_error&quot;, getErrorMessage(ex));         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 279                                  return;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                              }                                                                                     </span>
<span  style=""> 281                                                                                                                    </span>
<span class="-5412554652574185713" onmouseenter="enter('-5412554652574185713');" onmouseout="out('-5412554652574185713');" style=""> 282                              mServiceConfiguration.set(fetchedConfiguration);                                      </span>
<span  style=""> 283                                                                                                                    </span>
<span class="-458698083733976772" onmouseenter="enter('-458698083733976772');" onmouseout="out('-458698083733976772');" style=""> 284                              refreshWithConfiguration(                                                             </span>
<span class="4669533994023155203" onmouseenter="enter('4669533994023155203');" onmouseout="out('4669533994023155203');" style=""> 285                                      fetchedConfiguration,                                                         </span>
<span class="5644730204592106442" onmouseenter="enter('5644730204592106442');" onmouseout="out('5644730204592106442');" style=""> 286                                      appAuthConfiguration,                                                         </span>
<span class="-898932939000724171" onmouseenter="enter('-898932939000724171');" onmouseout="out('-898932939000724171');" style=""> 287                                      refreshToken,                                                                 </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 288                                      clientId,                                                                     </span>
<span class="-7590782321721152056" onmouseenter="enter('-7590782321721152056');" onmouseout="out('-7590782321721152056');" style=""> 289                                      scopes,                                                                       </span>
<span class="6249938355353344086" onmouseenter="enter('6249938355353344086');" onmouseout="out('6249938355353344086');" style=""> 290                                      redirectUrl,                                                                  </span>
<span class="-851959020690644515" onmouseenter="enter('-851959020690644515');" onmouseout="out('-851959020690644515');" style=""> 291                                      additionalParametersMap,                                                      </span>
<span class="3820652764230669423" onmouseenter="enter('3820652764230669423');" onmouseout="out('3820652764230669423');" style=""> 292                                      clientAuthMethod,                                                             </span>
<span class="677976280472910575" onmouseenter="enter('677976280472910575');" onmouseout="out('677976280472910575');" style=""> 293                                      clientSecret,                                                                 </span>
<span class="-1109463015887053831" onmouseenter="enter('-1109463015887053831');" onmouseout="out('-1109463015887053831');" style=""> 294                                      promise                                                                       </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 295                              );                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296                          }                                                                                         </span>
<span class="-4102417550988568311" onmouseenter="enter('-4102417550988568311');" onmouseout="out('-4102417550988568311');" style=""> 297                      },                                                                                            </span>
<span class="2680658541157360392" onmouseenter="enter('2680658541157360392');" onmouseout="out('2680658541157360392');" style=""> 298                      builder);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299          }                                                                                                         </span>
<span  style=""> 300                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301      }                                                                                                             </span>
<span  style=""> 302                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 303      /*                                                                                                            </span>
<span class="7578951324193379805" onmouseenter="enter('7578951324193379805');" onmouseout="out('7578951324193379805');" style=""> 304       * Called when the OAuth browser activity completes                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 305       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 306      @Override                                                                                                     </span>
<span class="2027722410160164989" onmouseenter="enter('2027722410160164989');" onmouseout="out('2027722410160164989');" style=""> 307      public void onActivityResult(Activity activity, int requestCode, int resultCode, Intent data) {               </span>
<span class="-4639597857217913430" onmouseenter="enter('-4639597857217913430');" onmouseout="out('-4639597857217913430');" style=""> 308          if (requestCode == 0) {                                                                                   </span>
<span class="-5203356024335682166" onmouseenter="enter('-5203356024335682166');" onmouseout="out('-5203356024335682166');" style=""> 309              if (data == null) {                                                                                   </span>
<span class="896291834146965431" onmouseenter="enter('896291834146965431');" onmouseout="out('896291834146965431');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -                promise.reject(&quot;Failed to authenticate&quot;, &quot;Data intent is null&quot; );                                 </span>
<span class="2268968836554739893" onmouseenter="enter('2268968836554739893');" onmouseout="out('2268968836554739893');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +                promise.reject(&quot;authentication_error&quot;, &quot;Data intent is null&quot; );                                   </span>


<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 312                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313              }                                                                                                     </span>
<span  style=""> 314                                                                                                                    </span>
<span class="1683167759369238332" onmouseenter="enter('1683167759369238332');" onmouseout="out('1683167759369238332');" style=""> 315              final AuthorizationResponse response = AuthorizationResponse.fromIntent(data);                        </span>
<span class="-2661429536108932642" onmouseenter="enter('-2661429536108932642');" onmouseout="out('-2661429536108932642');" style=""> 316              AuthorizationException exception = AuthorizationException.fromIntent(data);                           </span>
<span class="812069196179346176" onmouseenter="enter('812069196179346176');" onmouseout="out('812069196179346176');" style=""> 317              if (exception != null) {                                                                              </span>
<span class="-8411565336114705255" onmouseenter="enter('-8411565336114705255');" onmouseout="out('-8411565336114705255');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -                promise.reject(&quot;Failed to authenticate&quot;, getErrorMessage(exception));                             </span>
<span class="8302975562867231827" onmouseenter="enter('8302975562867231827');" onmouseout="out('8302975562867231827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +                promise.reject(&quot;authentication_error&quot;, getErrorMessage(exception));                               </span>


<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 320                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321              }                                                                                                     </span>
<span  style=""> 322                                                                                                                    </span>
<span class="7265001672864433355" onmouseenter="enter('7265001672864433355');" onmouseout="out('7265001672864433355');" style=""> 323              final Promise authorizePromise = this.promise;                                                        </span>
<span class="5853075131485496752" onmouseenter="enter('5853075131485496752');" onmouseout="out('5853075131485496752');" style=""> 324              final AppAuthConfiguration configuration = createAppAuthConfiguration(                                </span>
<span class="-3586276280695435831" onmouseenter="enter('-3586276280695435831');" onmouseout="out('-3586276280695435831');" style=""> 325                      createConnectionBuilder(this.dangerouslyAllowInsecureHttpRequests, this.tokenRequestHeaders)  </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 326              );                                                                                                    </span>
<span  style=""> 327                                                                                                                    </span>
<span class="-598339291394324639" onmouseenter="enter('-598339291394324639');" onmouseout="out('-598339291394324639');" style=""> 328              AuthorizationService authService = new AuthorizationService(this.reactContext, configuration);        </span>
<span  style=""> 329                                                                                                                    </span>
<span class="6152215567678252770" onmouseenter="enter('6152215567678252770');" onmouseout="out('6152215567678252770');" style=""> 330              TokenRequest tokenRequest = response.createTokenExchangeRequest(this.additionalParametersMap);        </span>
<span  style=""> 331                                                                                                                    </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 332              AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 332              AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenRespo🔵</abbr></span>
<span  style=""> 333                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 334                  @Override                                                                                         </span>
<span class="-8262795349130604582" onmouseenter="enter('-8262795349130604582');" onmouseout="out('-8262795349130604582');" style=""> 335                  public void onTokenRequestCompleted(                                                              </span>
<span class="5619805881636115456" onmouseenter="enter('5619805881636115456');" onmouseout="out('5619805881636115456');" style=""> 336                          TokenResponse resp, AuthorizationException ex) {                                          </span>
<span class="7476284757153148856" onmouseenter="enter('7476284757153148856');" onmouseout="out('7476284757153148856');" style=""> 337                      if (resp != null) {                                                                           </span>
<span class="7607526798956663360" onmouseenter="enter('7607526798956663360');" onmouseout="out('7607526798956663360');" style=""> 338                          WritableMap map = TokenResponseFactory.tokenResponseToMap(resp, response);                </span>
<span class="-4073221780338751137" onmouseenter="enter('-4073221780338751137');" onmouseout="out('-4073221780338751137');" style=""> 339                          authorizePromise.resolve(map);                                                            </span>



<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 340                      } else {                                                                                      </span>
<span class="6218095900068398599" onmouseenter="enter('6218095900068398599');" onmouseout="out('6218095900068398599');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -                        promise.reject(&quot;Failed exchange token&quot;, getErrorMessage(ex));                             </span>
<span class="-1873248496991044419" onmouseenter="enter('-1873248496991044419');" onmouseout="out('-1873248496991044419');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 342 +                        promise.reject(&quot;token_exchange_failed&quot;, getErrorMessage(ex));                             </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344                  }                                                                                                 </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 345              };                                                                                                    </span>
<span  style=""> 346                                                                                                                    </span>
<span class="-7911542703683536912" onmouseenter="enter('-7911542703683536912');" onmouseout="out('-7911542703683536912');" style=""> 347              if (this.clientSecret != null) {                                                                      </span>
<span class="-3188745194840831156" onmouseenter="enter('-3188745194840831156');" onmouseout="out('-3188745194840831156');" style=""><abbr title=" 348                  ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthMethod);"> 348                  ClientAuthentication clientAuth = this.getClientAuthentication(this.clientSecret, this.clientAuthM🔵</abbr></span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 349                  authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);                 </span>
<span  style=""> 350                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 351              } else {                                                                                              </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 352                  authService.performTokenRequest(tokenRequest, tokenResponseCallback);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353              }                                                                                                     </span>
<span  style=""> 354                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356      }                                                                                                             </span>
<span  style=""> 357                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 358      /*                                                                                                            </span>
<span class="-3037424821439688076" onmouseenter="enter('-3037424821439688076');" onmouseout="out('-3037424821439688076');" style=""> 359       * Authorize user with the provided configuration                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 360       */                                                                                                           </span>
<span class="-1686698148972257501" onmouseenter="enter('-1686698148972257501');" onmouseout="out('-1686698148972257501');" style=""> 361      private void authorizeWithConfiguration(                                                                      </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 362              final AuthorizationServiceConfiguration serviceConfiguration,                                         </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 363              final AppAuthConfiguration appAuthConfiguration,                                                      </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 364              final String clientId,                                                                                </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 365              final ReadableArray scopes,                                                                           </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 366              final String redirectUrl,                                                                             </span>
<span class="757822854767106715" onmouseenter="enter('757822854767106715');" onmouseout="out('757822854767106715');" style=""> 367              final Boolean usePKCE,                                                                                </span>
<span class="4591131233701235058" onmouseenter="enter('4591131233701235058');" onmouseout="out('4591131233701235058');" style=""> 368              final Map&lt;String, String&gt; additionalParametersMap                                                     </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 369      ) {                                                                                                           </span>
<span  style=""> 370                                                                                                                    </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 371          String scopesString = null;                                                                               </span>
<span  style=""> 372                                                                                                                    </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 373          if (scopes != null) {                                                                                     </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 374              scopesString = this.arrayToString(scopes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375          }                                                                                                         </span>
<span  style=""> 376                                                                                                                    </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 377          final Context context = this.reactContext;                                                                </span>
<span class="-4913832152651687292" onmouseenter="enter('-4913832152651687292');" onmouseout="out('-4913832152651687292');" style=""> 378          final Activity currentActivity = getCurrentActivity();                                                    </span>
<span  style=""> 379                                                                                                                    </span>
<span class="1615045173536817183" onmouseenter="enter('1615045173536817183');" onmouseout="out('1615045173536817183');" style=""> 380          AuthorizationRequest.Builder authRequestBuilder =                                                         </span>
<span class="8630572254279098967" onmouseenter="enter('8630572254279098967');" onmouseout="out('8630572254279098967');" style=""> 381                  new AuthorizationRequest.Builder(                                                                 </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 382                          serviceConfiguration,                                                                     </span>
<span class="-7142487624803337726" onmouseenter="enter('-7142487624803337726');" onmouseout="out('-7142487624803337726');" style=""> 383                          clientId,                                                                                 </span>
<span class="4849618716626806999" onmouseenter="enter('4849618716626806999');" onmouseout="out('4849618716626806999');" style=""> 384                          ResponseTypeValues.CODE,                                                                  </span>
<span class="-1639145692422133689" onmouseenter="enter('-1639145692422133689');" onmouseout="out('-1639145692422133689');" style=""> 385                          Uri.parse(redirectUrl)                                                                    </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 386                  );                                                                                                </span>
<span  style=""> 387                                                                                                                    </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 388          if (scopesString != null) {                                                                               </span>
<span class="-8218576309450527961" onmouseenter="enter('-8218576309450527961');" onmouseout="out('-8218576309450527961');" style=""> 389              authRequestBuilder.setScope(scopesString);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390          }                                                                                                         </span>
<span  style=""> 391                                                                                                                    </span>
<span  style=""> 392                                                                                                                    </span>
<span class="7149068665077353053" onmouseenter="enter('7149068665077353053');" onmouseout="out('7149068665077353053');" style=""> 393          if (additionalParametersMap != null) {                                                                    </span>
<span class="-6137327941719445172" onmouseenter="enter('-6137327941719445172');" onmouseout="out('-6137327941719445172');" style=""> 394              // handle additional parameters separately to avoid exceptions from AppAuth                           </span>
<span class="-4729676460784236302" onmouseenter="enter('-4729676460784236302');" onmouseout="out('-4729676460784236302');" style=""> 395              if (additionalParametersMap.containsKey(&quot;display&quot;)) {                                                 </span>
<span class="6740086842281271815" onmouseenter="enter('6740086842281271815');" onmouseout="out('6740086842281271815');" style=""> 396                  authRequestBuilder.setDisplay(additionalParametersMap.get(&quot;display&quot;));                            </span>
<span class="5478676394718524231" onmouseenter="enter('5478676394718524231');" onmouseout="out('5478676394718524231');" style=""> 397                  additionalParametersMap.remove(&quot;display&quot;);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398              }                                                                                                     </span>
<span class="-5162308638975991351" onmouseenter="enter('-5162308638975991351');" onmouseout="out('-5162308638975991351');" style=""> 399              if (additionalParametersMap.containsKey(&quot;login_hint&quot;)) {                                              </span>
<span class="7478322337196261432" onmouseenter="enter('7478322337196261432');" onmouseout="out('7478322337196261432');" style=""> 400                  authRequestBuilder.setLoginHint(additionalParametersMap.get(&quot;login_hint&quot;));                       </span>
<span class="-3825577662921277200" onmouseenter="enter('-3825577662921277200');" onmouseout="out('-3825577662921277200');" style=""> 401                  additionalParametersMap.remove(&quot;login_hint&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402              }                                                                                                     </span>
<span class="-8254180626457365202" onmouseenter="enter('-8254180626457365202');" onmouseout="out('-8254180626457365202');" style=""> 403              if (additionalParametersMap.containsKey(&quot;prompt&quot;)) {                                                  </span>
<span class="2585369211918110761" onmouseenter="enter('2585369211918110761');" onmouseout="out('2585369211918110761');" style=""> 404                  authRequestBuilder.setPrompt(additionalParametersMap.get(&quot;prompt&quot;));                              </span>
<span class="290019989822766287" onmouseenter="enter('290019989822766287');" onmouseout="out('290019989822766287');" style=""> 405                  additionalParametersMap.remove(&quot;prompt&quot;);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406              }                                                                                                     </span>
<span  style=""> 407                                                                                                                    </span>
<span class="-1433627721318603910" onmouseenter="enter('-1433627721318603910');" onmouseout="out('-1433627721318603910');" style=""> 408              authRequestBuilder.setAdditionalParameters(additionalParametersMap);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409          }                                                                                                         </span>
<span  style=""> 410                                                                                                                    </span>
<span class="6295746505532947076" onmouseenter="enter('6295746505532947076');" onmouseout="out('6295746505532947076');" style=""> 411          if (!usePKCE) {                                                                                           </span>
<span class="211047115781987373" onmouseenter="enter('211047115781987373');" onmouseout="out('211047115781987373');" style=""> 412              authRequestBuilder.setCodeVerifier(null);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413          }                                                                                                         </span>
<span  style=""> 414                                                                                                                    </span>
<span class="2874496759892237047" onmouseenter="enter('2874496759892237047');" onmouseout="out('2874496759892237047');" style=""> 415          AuthorizationRequest authRequest = authRequestBuilder.build();                                            </span>
<span  style=""> 416                                                                                                                    </span>
<span class="4248167488592758879" onmouseenter="enter('4248167488592758879');" onmouseout="out('4248167488592758879');" style=""> 417          if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.LOLLIPOP) {                        </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 418              AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);           </span>
<span class="-8712988972948484879" onmouseenter="enter('-8712988972948484879');" onmouseout="out('-8712988972948484879');" style=""> 419              Intent authIntent = authService.getAuthorizationRequestIntent(authRequest);                           </span>
<span  style=""> 420                                                                                                                    </span>
<span class="-1768672139093830544" onmouseenter="enter('-1768672139093830544');" onmouseout="out('-1768672139093830544');" style=""> 421              currentActivity.startActivityForResult(authIntent, 0);                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 422          } else {                                                                                                  </span>
<span class="-5574677103641269793" onmouseenter="enter('-5574677103641269793');" onmouseout="out('-5574677103641269793');" style=""> 423              AuthorizationService authService = new AuthorizationService(currentActivity, appAuthConfiguration);   </span>
<span class="-921350943484849229" onmouseenter="enter('-921350943484849229');" onmouseout="out('-921350943484849229');" style=""> 424              PendingIntent pendingIntent = currentActivity.createPendingResult(0, new Intent(), 0);                </span>
<span  style=""> 425                                                                                                                    </span>
<span class="5462088869311657545" onmouseenter="enter('5462088869311657545');" onmouseout="out('5462088869311657545');" style=""> 426              authService.performAuthorizationRequest(authRequest, pendingIntent);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428      }                                                                                                             </span>
<span  style=""> 429                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 430      /*                                                                                                            </span>
<span class="8814346366745541198" onmouseenter="enter('8814346366745541198');" onmouseout="out('8814346366745541198');" style=""> 431       * Refresh authentication token with the provided configuration                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 432       */                                                                                                           </span>
<span class="-7235916799046070057" onmouseenter="enter('-7235916799046070057');" onmouseout="out('-7235916799046070057');" style=""> 433      private void refreshWithConfiguration(                                                                        </span>
<span class="6738372303589480670" onmouseenter="enter('6738372303589480670');" onmouseout="out('6738372303589480670');" style=""> 434              final AuthorizationServiceConfiguration serviceConfiguration,                                         </span>
<span class="-7148653639167688877" onmouseenter="enter('-7148653639167688877');" onmouseout="out('-7148653639167688877');" style=""> 435              final AppAuthConfiguration appAuthConfiguration,                                                      </span>
<span class="-379485936381134853" onmouseenter="enter('-379485936381134853');" onmouseout="out('-379485936381134853');" style=""> 436              final String refreshToken,                                                                            </span>
<span class="5687609302985114059" onmouseenter="enter('5687609302985114059');" onmouseout="out('5687609302985114059');" style=""> 437              final String clientId,                                                                                </span>
<span class="-2571432075276428063" onmouseenter="enter('-2571432075276428063');" onmouseout="out('-2571432075276428063');" style=""> 438              final ReadableArray scopes,                                                                           </span>
<span class="-2300460312367070002" onmouseenter="enter('-2300460312367070002');" onmouseout="out('-2300460312367070002');" style=""> 439              final String redirectUrl,                                                                             </span>
<span class="3078994421067824649" onmouseenter="enter('3078994421067824649');" onmouseout="out('3078994421067824649');" style=""> 440              final Map&lt;String, String&gt; additionalParametersMap,                                                    </span>
<span class="7067272401530563010" onmouseenter="enter('7067272401530563010');" onmouseout="out('7067272401530563010');" style=""> 441              final String clientAuthMethod,                                                                        </span>
<span class="-444453538460346544" onmouseenter="enter('-444453538460346544');" onmouseout="out('-444453538460346544');" style=""> 442              final String clientSecret,                                                                            </span>
<span class="-8418158227951587358" onmouseenter="enter('-8418158227951587358');" onmouseout="out('-8418158227951587358');" style=""> 443              final Promise promise                                                                                 </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 444      ) {                                                                                                           </span>
<span  style=""> 445                                                                                                                    </span>
<span class="-1291757027033748823" onmouseenter="enter('-1291757027033748823');" onmouseout="out('-1291757027033748823');" style=""> 446          String scopesString = null;                                                                               </span>
<span  style=""> 447                                                                                                                    </span>
<span class="-4774210946826185426" onmouseenter="enter('-4774210946826185426');" onmouseout="out('-4774210946826185426');" style=""> 448          if (scopes != null) {                                                                                     </span>
<span class="-3414107120191340382" onmouseenter="enter('-3414107120191340382');" onmouseout="out('-3414107120191340382');" style=""> 449              scopesString = this.arrayToString(scopes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450          }                                                                                                         </span>
<span  style=""> 451                                                                                                                    </span>
<span class="-6618419046875856106" onmouseenter="enter('-6618419046875856106');" onmouseout="out('-6618419046875856106');" style=""> 452          final Context context = this.reactContext;                                                                </span>
<span  style=""> 453                                                                                                                    </span>
<span class="-1882592220700818910" onmouseenter="enter('-1882592220700818910');" onmouseout="out('-1882592220700818910');" style=""> 454          TokenRequest.Builder tokenRequestBuilder =                                                                </span>
<span class="-7570030938974274508" onmouseenter="enter('-7570030938974274508');" onmouseout="out('-7570030938974274508');" style=""> 455                  new TokenRequest.Builder(                                                                         </span>
<span class="-7084153681994695608" onmouseenter="enter('-7084153681994695608');" onmouseout="out('-7084153681994695608');" style=""> 456                          serviceConfiguration,                                                                     </span>
<span class="-3028793166139754818" onmouseenter="enter('-3028793166139754818');" onmouseout="out('-3028793166139754818');" style=""> 457                          clientId                                                                                  </span>
<span class="-2015476096144723150" onmouseenter="enter('-2015476096144723150');" onmouseout="out('-2015476096144723150');" style=""> 458                  )                                                                                                 </span>
<span class="5149869235939087614" onmouseenter="enter('5149869235939087614');" onmouseout="out('5149869235939087614');" style=""> 459                          .setRefreshToken(refreshToken)                                                            </span>
<span class="-4168308848344323961" onmouseenter="enter('-4168308848344323961');" onmouseout="out('-4168308848344323961');" style=""> 460                          .setRedirectUri(Uri.parse(redirectUrl));                                                  </span>
<span  style=""> 461                                                                                                                    </span>
<span class="-7385661931052667974" onmouseenter="enter('-7385661931052667974');" onmouseout="out('-7385661931052667974');" style=""> 462          if (scopesString != null) {                                                                               </span>
<span class="-4940100242303343354" onmouseenter="enter('-4940100242303343354');" onmouseout="out('-4940100242303343354');" style=""> 463              tokenRequestBuilder.setScope(scopesString);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464          }                                                                                                         </span>
<span  style=""> 465                                                                                                                    </span>
<span class="1982926752875631058" onmouseenter="enter('1982926752875631058');" onmouseout="out('1982926752875631058');" style=""> 466          if (!additionalParametersMap.isEmpty()) {                                                                 </span>
<span class="6791703352530289305" onmouseenter="enter('6791703352530289305');" onmouseout="out('6791703352530289305');" style=""> 467              tokenRequestBuilder.setAdditionalParameters(additionalParametersMap);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468          }                                                                                                         </span>
<span  style=""> 469                                                                                                                    </span>
<span class="6300215370198990899" onmouseenter="enter('6300215370198990899');" onmouseout="out('6300215370198990899');" style=""> 470          TokenRequest tokenRequest = tokenRequestBuilder.build();                                                  </span>
<span  style=""> 471                                                                                                                    </span>
<span class="4816591906407044398" onmouseenter="enter('4816591906407044398');" onmouseout="out('4816591906407044398');" style=""> 472          AuthorizationService authService = new AuthorizationService(context, appAuthConfiguration);               </span>
<span  style=""> 473                                                                                                                    </span>
<span class="-5959293994775680289" onmouseenter="enter('-5959293994775680289');" onmouseout="out('-5959293994775680289');" style=""><abbr title=" 474          AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseCallback() {"> 474          AuthorizationService.TokenResponseCallback tokenResponseCallback = new AuthorizationService.TokenResponseC🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 475              @Override                                                                                             </span>
<span class="-9019017716153453132" onmouseenter="enter('-9019017716153453132');" onmouseout="out('-9019017716153453132');" style=""><abbr title=" 476              public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException ex) {"> 476              public void onTokenRequestCompleted(@Nullable TokenResponse response, @Nullable AuthorizationException🔵</abbr></span>
<span class="4756227728171050519" onmouseenter="enter('4756227728171050519');" onmouseout="out('4756227728171050519');" style=""> 477                  if (response != null) {                                                                           </span>
<span class="-4071880271889138129" onmouseenter="enter('-4071880271889138129');" onmouseout="out('-4071880271889138129');" style=""> 478                      WritableMap map = TokenResponseFactory.tokenResponseToMap(response);                          </span>
<span class="9181054552595447887" onmouseenter="enter('9181054552595447887');" onmouseout="out('9181054552595447887');" style=""> 479                      promise.resolve(map);                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 480                  } else {                                                                                          </span>
<span class="-797630881355515698" onmouseenter="enter('-797630881355515698');" onmouseout="out('-797630881355515698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 481 -                    promise.reject(&quot;Failed to refresh token&quot;, getErrorMessage(ex));                               </span>
<span class="-8974399670180994057" onmouseenter="enter('-8974399670180994057');" onmouseout="out('-8974399670180994057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 482 +                    promise.reject(&quot;token_refresh_failed&quot;, getErrorMessage(ex));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 485          };                                                                                                        </span>
<span  style=""> 486                                                                                                                    </span>
<span  style=""> 487                                                                                                                    </span>
<span class="7421395494546180413" onmouseenter="enter('7421395494546180413');" onmouseout="out('7421395494546180413');" style=""> 488          if (clientSecret != null) {                                                                               </span>
<span class="-3955443834186652225" onmouseenter="enter('-3955443834186652225');" onmouseout="out('-3955443834186652225');" style=""> 489              ClientAuthentication clientAuth = this.getClientAuthentication(clientSecret, clientAuthMethod);       </span>
<span class="5874890706685367726" onmouseenter="enter('5874890706685367726');" onmouseout="out('5874890706685367726');" style=""> 490              authService.performTokenRequest(tokenRequest, clientAuth, tokenResponseCallback);                     </span>
<span  style=""> 491                                                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 492          } else {                                                                                                  </span>
<span class="6963498436255567330" onmouseenter="enter('6963498436255567330');" onmouseout="out('6963498436255567330');" style=""> 493              authService.performTokenRequest(tokenRequest, tokenResponseCallback);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495      }                                                                                                             </span>
<span  style=""> 496                                                                                                                    </span>
<span class="2930218534777413873" onmouseenter="enter('2930218534777413873');" onmouseout="out('2930218534777413873');" style=""> 497      private void parseHeaderMap (ReadableMap headerMap) {                                                         </span>
<span class="-6316489241675673035" onmouseenter="enter('-6316489241675673035');" onmouseout="out('-6316489241675673035');" style=""> 498          if (headerMap == null) {                                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 499              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500          }                                                                                                         </span>
<span class="-8530407112624237580" onmouseenter="enter('-8530407112624237580');" onmouseout="out('-8530407112624237580');" style=""> 501          if (headerMap.hasKey(&quot;authorize&quot;) &amp;&amp; headerMap.getType(&quot;authorize&quot;) == ReadableType.Map) {                </span>
<span class="762039099095363738" onmouseenter="enter('762039099095363738');" onmouseout="out('762039099095363738');" style=""> 502              this.authorizationRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;authorize&quot;));       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503          }                                                                                                         </span>
<span class="5768179141818569002" onmouseenter="enter('5768179141818569002');" onmouseout="out('5768179141818569002');" style=""> 504          if (headerMap.hasKey(&quot;token&quot;) &amp;&amp; headerMap.getType(&quot;token&quot;) == ReadableType.Map) {                        </span>
<span class="-4870803436115877491" onmouseenter="enter('-4870803436115877491');" onmouseout="out('-4870803436115877491');" style=""> 505              this.tokenRequestHeaders = MapUtil.readableMapToHashMap(headerMap.getMap(&quot;token&quot;));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506          }                                                                                                         </span>
<span  style=""> 507                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508      }                                                                                                             </span>
<span  style=""> 509                                                                                                                    </span>
<span class="-2276636657842571599" onmouseenter="enter('-2276636657842571599');" onmouseout="out('-2276636657842571599');" style=""> 510      private ClientAuthentication getClientAuthentication(String clientSecret, String clientAuthMethod) {          </span>
<span class="4736948393768361142" onmouseenter="enter('4736948393768361142');" onmouseout="out('4736948393768361142');" style=""> 511          if (clientAuthMethod.equals(&quot;post&quot;)) {                                                                    </span>
<span class="4033722210949459980" onmouseenter="enter('4033722210949459980');" onmouseout="out('4033722210949459980');" style=""> 512              return new ClientSecretPost(clientSecret);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 513          }                                                                                                         </span>
<span  style=""> 514                                                                                                                    </span>
<span class="-1107687855860572488" onmouseenter="enter('-1107687855860572488');" onmouseout="out('-1107687855860572488');" style=""> 515          return new ClientSecretBasic(clientSecret);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516      }                                                                                                             </span>
<span  style=""> 517                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 518      /*                                                                                                            </span>
<span class="5090378039448834807" onmouseenter="enter('5090378039448834807');" onmouseout="out('5090378039448834807');" style=""> 519       * Return error information if it is available                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 520       */                                                                                                           </span>
<span class="7325111704754615468" onmouseenter="enter('7325111704754615468');" onmouseout="out('7325111704754615468');" style=""> 521      private String getErrorMessage(AuthorizationException ex){                                                    </span>
<span class="6233744395473659458" onmouseenter="enter('6233744395473659458');" onmouseout="out('6233744395473659458');" style=""> 522          if(ex.errorDescription == null &amp;&amp; ex.error != null)                                                       </span>
<span class="8212520076730053042" onmouseenter="enter('8212520076730053042');" onmouseout="out('8212520076730053042');" style=""> 523              return ex.error;                                                                                      </span>
<span class="-944119096152079377" onmouseenter="enter('-944119096152079377');" onmouseout="out('-944119096152079377');" style=""> 524          return ex.errorDescription;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525      }                                                                                                             </span>
<span  style=""> 526                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 527      /*                                                                                                            </span>
<span class="6638112631744326921" onmouseenter="enter('6638112631744326921');" onmouseout="out('6638112631744326921');" style=""> 528       * Create a space-delimited string from an array                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 529       */                                                                                                           </span>
<span class="2843730177292313139" onmouseenter="enter('2843730177292313139');" onmouseout="out('2843730177292313139');" style=""> 530      private String arrayToString(ReadableArray array) {                                                           </span>
<span class="-8236782342056480869" onmouseenter="enter('-8236782342056480869');" onmouseout="out('-8236782342056480869');" style=""> 531          StringBuilder strBuilder = new StringBuilder();                                                           </span>
<span class="7278311890620727475" onmouseenter="enter('7278311890620727475');" onmouseout="out('7278311890620727475');" style=""> 532          for (int i = 0; i &lt; array.size(); i++) {                                                                  </span>
<span class="-7800557187785605413" onmouseenter="enter('-7800557187785605413');" onmouseout="out('-7800557187785605413');" style=""> 533              if (i != 0) {                                                                                         </span>
<span class="-4449242394605741248" onmouseenter="enter('-4449242394605741248');" onmouseout="out('-4449242394605741248');" style=""> 534                  strBuilder.append(&#x27; &#x27;);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535              }                                                                                                     </span>
<span class="-8205116312766504963" onmouseenter="enter('-8205116312766504963');" onmouseout="out('-8205116312766504963');" style=""> 536              strBuilder.append(array.getString(i));                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537          }                                                                                                         </span>
<span class="-7597052729024482685" onmouseenter="enter('-7597052729024482685');" onmouseout="out('-7597052729024482685');" style=""> 538          return strBuilder.toString();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539      }                                                                                                             </span>
<span  style=""> 540                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 541      /*                                                                                                            </span>
<span class="5214794569700518887" onmouseenter="enter('5214794569700518887');" onmouseout="out('5214794569700518887');" style=""> 542       * Create an App Auth configuration using the provided connection builder                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 543       */                                                                                                           </span>
<span class="-5342361748775304563" onmouseenter="enter('-5342361748775304563');" onmouseout="out('-5342361748775304563');" style=""> 544      private AppAuthConfiguration createAppAuthConfiguration(ConnectionBuilder connectionBuilder) {                </span>
<span class="-6961363017801118708" onmouseenter="enter('-6961363017801118708');" onmouseout="out('-6961363017801118708');" style=""> 545          return new AppAuthConfiguration                                                                           </span>
<span class="370567544488026574" onmouseenter="enter('370567544488026574');" onmouseout="out('370567544488026574');" style=""> 546                  .Builder()                                                                                        </span>
<span class="6932817517014214209" onmouseenter="enter('6932817517014214209');" onmouseout="out('6932817517014214209');" style=""> 547                  .setConnectionBuilder(connectionBuilder)                                                          </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 548                  .build();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549      }                                                                                                             </span>
<span  style=""> 550                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 551      /*                                                                                                            </span>
<span class="2307564597312892215" onmouseenter="enter('2307564597312892215');" onmouseout="out('2307564597312892215');" style=""> 552       *  Create appropriate connection builder based on provided settings                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 553       */                                                                                                           </span>
<span class="-266307560690147004" onmouseenter="enter('-266307560690147004');" onmouseout="out('-266307560690147004');" style=""><abbr title=" 554      private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; headers) {"> 554      private ConnectionBuilder createConnectionBuilder(Boolean allowInsecureConnections, Map&lt;String, String&gt; header🔵</abbr></span>
<span class="7318015076305824949" onmouseenter="enter('7318015076305824949');" onmouseout="out('7318015076305824949');" style=""> 555          ConnectionBuilder proxiedBuilder;                                                                         </span>
<span  style=""> 556                                                                                                                    </span>
<span class="-6214248404965356101" onmouseenter="enter('-6214248404965356101');" onmouseout="out('-6214248404965356101');" style=""> 557          if (allowInsecureConnections.equals(true)) {                                                              </span>
<span class="-8652069864919613967" onmouseenter="enter('-8652069864919613967');" onmouseout="out('-8652069864919613967');" style=""> 558              proxiedBuilder =UnsafeConnectionBuilder.INSTANCE;                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 559          } else {                                                                                                  </span>
<span class="-3823294731313489124" onmouseenter="enter('-3823294731313489124');" onmouseout="out('-3823294731313489124');" style=""> 560              proxiedBuilder = DefaultConnectionBuilder.INSTANCE;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 561          }                                                                                                         </span>
<span  style=""> 562                                                                                                                    </span>
<span class="-321326358809916252" onmouseenter="enter('-321326358809916252');" onmouseout="out('-321326358809916252');" style=""> 563          CustomConnectionBuilder customConnection = new CustomConnectionBuilder(proxiedBuilder);                   </span>
<span class="-5872856843685271172" onmouseenter="enter('-5872856843685271172');" onmouseout="out('-5872856843685271172');" style=""> 564          if (headers != null) {                                                                                    </span>
<span class="-4120878389218127223" onmouseenter="enter('-4120878389218127223');" onmouseout="out('-4120878389218127223');" style=""> 565              customConnection.setHeaders(headers);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566          }                                                                                                         </span>
<span  style=""> 567                                                                                                                    </span>
<span class="5629827582834827587" onmouseenter="enter('5629827582834827587');" onmouseout="out('5629827582834827587');" style=""> 568          return customConnection;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 569      }                                                                                                             </span>
<span  style=""> 570                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style=""> 571      /*                                                                                                            </span>
<span class="9187662928809351886" onmouseenter="enter('9187662928809351886');" onmouseout="out('9187662928809351886');" style=""> 572       *  Replicated private method from AuthorizationServiceConfiguration                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 573       */                                                                                                           </span>
<span class="2622836649973257205" onmouseenter="enter('2622836649973257205');" onmouseout="out('2622836649973257205');" style=""> 574      private Uri buildConfigurationUriFromIssuer(Uri openIdConnectIssuerUri) {                                     </span>
<span class="-830811466431368071" onmouseenter="enter('-830811466431368071');" onmouseout="out('-830811466431368071');" style=""> 575          return openIdConnectIssuerUri.buildUpon()                                                                 </span>
<span class="7258170423676519924" onmouseenter="enter('7258170423676519924');" onmouseout="out('7258170423676519924');" style=""> 576                  .appendPath(AuthorizationServiceConfiguration.WELL_KNOWN_PATH)                                    </span>
<span class="-3903955623180377764" onmouseenter="enter('-3903955623180377764');" onmouseout="out('-3903955623180377764');" style=""> 577                  .appendPath(AuthorizationServiceConfiguration.OPENID_CONFIGURATION_RESOURCE)                      </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 578                  .build();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579      }                                                                                                             </span>
<span  style=""> 580                                                                                                                    </span>
<span class="3122274151060887299" onmouseenter="enter('3122274151060887299');" onmouseout="out('3122274151060887299');" style=""><abbr title=" 581      private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfiguration) throws Exception {"> 581      private AuthorizationServiceConfiguration createAuthorizationServiceConfiguration(ReadableMap serviceConfigura🔵</abbr></span>
<span class="4275545280692735139" onmouseenter="enter('4275545280692735139');" onmouseout="out('4275545280692735139');" style=""> 582          if (!serviceConfiguration.hasKey(&quot;authorizationEndpoint&quot;)) {                                              </span>
<span class="3986521017730318395" onmouseenter="enter('3986521017730318395');" onmouseout="out('3986521017730318395');" style=""> 583              throw new Exception(&quot;serviceConfiguration passed without an authorizationEndpoint&quot;);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 584          }                                                                                                         </span>
<span  style=""> 585                                                                                                                    </span>
<span class="5638598812511759739" onmouseenter="enter('5638598812511759739');" onmouseout="out('5638598812511759739');" style=""> 586          if (!serviceConfiguration.hasKey(&quot;tokenEndpoint&quot;)) {                                                      </span>
<span class="7444064849592215652" onmouseenter="enter('7444064849592215652');" onmouseout="out('7444064849592215652');" style=""> 587              throw new Exception(&quot;serviceConfiguration passed without a tokenEndpoint&quot;);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 588          }                                                                                                         </span>
<span  style=""> 589                                                                                                                    </span>
<span class="-3941749567598770425" onmouseenter="enter('-3941749567598770425');" onmouseout="out('-3941749567598770425');" style=""> 590          Uri authorizationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;authorizationEndpoint&quot;));           </span>
<span class="4054930865548070446" onmouseenter="enter('4054930865548070446');" onmouseout="out('4054930865548070446');" style=""> 591          Uri tokenEndpoint = Uri.parse(serviceConfiguration.getString(&quot;tokenEndpoint&quot;));                           </span>
<span class="2264343622444418519" onmouseenter="enter('2264343622444418519');" onmouseout="out('2264343622444418519');" style=""> 592          Uri registrationEndpoint = null;                                                                          </span>
<span class="-4970643399788664483" onmouseenter="enter('-4970643399788664483');" onmouseout="out('-4970643399788664483');" style=""> 593          if (serviceConfiguration.hasKey(&quot;registrationEndpoint&quot;)) {                                                </span>
<span class="1609034589288005797" onmouseenter="enter('1609034589288005797');" onmouseout="out('1609034589288005797');" style=""> 594              registrationEndpoint = Uri.parse(serviceConfiguration.getString(&quot;registrationEndpoint&quot;));             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595          }                                                                                                         </span>
<span  style=""> 596                                                                                                                    </span>
<span class="-8455698330779530293" onmouseenter="enter('-8455698330779530293');" onmouseout="out('-8455698330779530293');" style=""> 597          return new AuthorizationServiceConfiguration(                                                             </span>
<span class="-9206356706352718453" onmouseenter="enter('-9206356706352718453');" onmouseout="out('-9206356706352718453');" style=""> 598                  authorizationEndpoint,                                                                            </span>
<span class="-6119344076232034280" onmouseenter="enter('-6119344076232034280');" onmouseout="out('-6119344076232034280');" style=""> 599                  tokenEndpoint,                                                                                    </span>
<span class="-4224958759407269631" onmouseenter="enter('-4224958759407269631');" onmouseout="out('-4224958759407269631');" style=""> 600                  registrationEndpoint                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 601          );                                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 602      }                                                                                                             </span>
<span  style=""> 603                                                                                                                    </span>
<span class="-4130257184876230563" onmouseenter="enter('-4130257184876230563');" onmouseout="out('-4130257184876230563');" style=""> 604      private void warmChromeCustomTab(Context context, final String issuer) {                                      </span>
<span class="-4012796735492941375" onmouseenter="enter('-4012796735492941375');" onmouseout="out('-4012796735492941375');" style=""> 605          CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 606              @Override                                                                                             </span>
<span class="4306327880536035079" onmouseenter="enter('4306327880536035079');" onmouseout="out('4306327880536035079');" style=""> 607              public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {               </span>
<span class="-5035114608817725139" onmouseenter="enter('-5035114608817725139');" onmouseout="out('-5035114608817725139');" style=""> 608                  client.warmup(0);                                                                                 </span>
<span class="5970961959698416627" onmouseenter="enter('5970961959698416627');" onmouseout="out('5970961959698416627');" style=""><abbr title=" 609                  client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bundle&gt;emptyList());"> 609                  client.newSession(new CustomTabsCallback()).mayLaunchUrl(Uri.parse(issuer), null, Collections.&lt;Bun🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 610              }                                                                                                     </span>
<span  style=""> 611                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 612              @Override                                                                                             </span>
<span class="6231636659664649995" onmouseenter="enter('6231636659664649995');" onmouseout="out('6231636659664649995');" style=""> 613              public void onServiceDisconnected(ComponentName name) {                                               </span>
<span  style=""> 614                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 616          };                                                                                                        </span>
<span class="5767142201781268255" onmouseenter="enter('5767142201781268255');" onmouseout="out('5767142201781268255');" style=""> 617          CustomTabsClient.bindCustomTabsService(context, CUSTOM_TAB_PACKAGE_NAME, connection);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 618      }                                                                                                             </span>
<span  style=""> 619                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 620      @Override                                                                                                     </span>
<span class="-4337880705383881802" onmouseenter="enter('-4337880705383881802');" onmouseout="out('-4337880705383881802');" style=""> 621      public void onNewIntent(Intent intent) {                                                                      </span>
<span  style=""> 622                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 623      }                                                                                                             </span>
<span  style=""> 624                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 625      @Override                                                                                                     </span>
<span class="190238665005496725" onmouseenter="enter('190238665005496725');" onmouseout="out('190238665005496725');" style=""> 626      public String getName() {                                                                                     </span>
<span class="4315075324919368681" onmouseenter="enter('4315075324919368681');" onmouseout="out('4315075324919368681');" style=""> 627          return &quot;RNAppAuth&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 628      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            