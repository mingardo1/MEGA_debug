<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>377</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    377
                    <a href="376.html">prev</a>
                    <a href="378.html">next</a>
                    <a href="377_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_f7d04befb21c26162c7af61911a0e71624243147_core/src/main/java/com/dtstack/flink/sql/environment/MyLocalStreamEnvironment.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f7d04befb21c26162c7af61911a0e71624243147:core/src/main/java/com/dtstack/flink/sql/environment/MyLocalStreamEnvironment.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f7d04befb21c26162c7af61911a0e71624243147^1:core/src/main/java/com/dtstack/flink/sql/environment/MyLocalStreamEnvironment.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f7d04befb21c26162c7af61911a0e71624243147^2:core/src/main/java/com/dtstack/flink/sql/environment/MyLocalStreamEnvironment.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b59ef71c4aa3401fd523d61328334a6bac817e1c:core/src/main/java/com/dtstack/flink/sql/environment/MyLocalStreamEnvironment.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [j]], subset: [[b], [b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="5598128254818160022" onmouseenter="enter('5598128254818160022');" onmouseout="out('5598128254818160022');" style="">  19 package com.dtstack.flink.sql.environment;                                                               </span>
<span  style="">  20                                                                                                          </span>
<span class="2461872502712586167" onmouseenter="enter('2461872502712586167');" onmouseout="out('2461872502712586167');" style="">  21 import org.apache.flink.api.common.InvalidProgramException;                                              </span>
<span class="8256876323376004396" onmouseenter="enter('8256876323376004396');" onmouseout="out('8256876323376004396');" style="">  22 import org.apache.flink.api.common.JobExecutionResult;                                                   </span>
<span class="-902830676319511587" onmouseenter="enter('-902830676319511587');" onmouseout="out('-902830676319511587');" style="">  23 import org.apache.flink.api.java.ExecutionEnvironment;                                                   </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5318294912310187959" onmouseenter="enter('5318294912310187959');" onmouseout="out('5318294912310187959');" style="">  25 import org.apache.flink.configuration.RestOptions;                                                       </span>
<span class="1850401773685605073" onmouseenter="enter('1850401773685605073');" onmouseout="out('1850401773685605073');" style="">  26 import org.apache.flink.configuration.TaskManagerOptions;                                                </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  27 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="-2713113410259205994" onmouseenter="enter('-2713113410259205994');" onmouseout="out('-2713113410259205994');" style="">  28 import org.apache.flink.runtime.minicluster.MiniCluster;                                                 </span>
<span class="1583265242678797853" onmouseenter="enter('1583265242678797853');" onmouseout="out('1583265242678797853');" style="">  29 import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;                                    </span>
<span class="5297953280946518295" onmouseenter="enter('5297953280946518295');" onmouseout="out('5297953280946518295');" style="">  30 import org.apache.flink.streaming.api.environment.LocalStreamEnvironment;                                </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  31 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="-6686939373153454077" onmouseenter="enter('-6686939373153454077');" onmouseout="out('-6686939373153454077');" style="">  32 import org.apache.flink.streaming.api.graph.StreamGraph;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  35                                                                                                          </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  36 import java.net.URL;                                                                                     </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  37 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  38 import java.util.List;                                                                                   </span>
<span  style="">  39                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40 /**                                                                                                      </span>
<span class="-3231818603887923319" onmouseenter="enter('-3231818603887923319');" onmouseout="out('-3231818603887923319');" style="">  41  * Local Stream Environment                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  42  *                                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  43  * Company: www.dtstack.com                                                                              </span>
<span class="6779159400583430426" onmouseenter="enter('6779159400583430426');" onmouseout="out('6779159400583430426');" style="">  44  * @author huyifan.zju@163.com                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45  */                                                                                                      </span>
<span class="4246239116754757473" onmouseenter="enter('4246239116754757473');" onmouseout="out('4246239116754757473');" style="">  46 public class MyLocalStreamEnvironment extends StreamExecutionEnvironment {                               </span>
<span class="927814391059993389" onmouseenter="enter('927814391059993389');" onmouseout="out('927814391059993389');" style="">  47     private static final Logger LOG = LoggerFactory.getLogger(LocalStreamEnvironment.class);             </span>
<span  style="">  48                                                                                                          </span>
<span class="-8302311498454820742" onmouseenter="enter('-8302311498454820742');" onmouseout="out('-8302311498454820742');" style="">  49     /** The configuration to use for the local cluster. */                                               </span>
<span class="-5224455178778766138" onmouseenter="enter('-5224455178778766138');" onmouseout="out('-5224455178778766138');" style="">  50     private final Configuration conf;                                                                    </span>
<span  style="">  51                                                                                                          </span>
<span class="33436849132097052" onmouseenter="enter('33436849132097052');" onmouseout="out('33436849132097052');" style="">  52     public List&lt;URL&gt; getClasspaths() {                                                                   </span>
<span class="-6420995887957701132" onmouseenter="enter('-6420995887957701132');" onmouseout="out('-6420995887957701132');" style="">  53         return classpaths;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54     }                                                                                                    </span>
<span  style="">  55                                                                                                          </span>
<span class="4428292286261856619" onmouseenter="enter('4428292286261856619');" onmouseout="out('4428292286261856619');" style="">  56     public void setClasspaths(List&lt;URL&gt; classpaths) {                                                    </span>
<span class="-284268027982127308" onmouseenter="enter('-284268027982127308');" onmouseout="out('-284268027982127308');" style="">  57         this.classpaths = classpaths;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58     }                                                                                                    </span>
<span  style="">  59                                                                                                          </span>
<span class="-6352601788059183844" onmouseenter="enter('-6352601788059183844');" onmouseout="out('-6352601788059183844');" style="">  60     private List&lt;URL&gt; classpaths = Collections.emptyList();                                              </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62     /**                                                                                                  </span>
<span class="-4066435560223898603" onmouseenter="enter('-4066435560223898603');" onmouseout="out('-4066435560223898603');" style="">  63      * Creates a new local stream environment that uses the default configuration.                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64      */                                                                                                  </span>
<span class="3058085256785609242" onmouseenter="enter('3058085256785609242');" onmouseout="out('3058085256785609242');" style="">  65     public MyLocalStreamEnvironment() {                                                                  </span>
<span class="4995832816651655245" onmouseenter="enter('4995832816651655245');" onmouseout="out('4995832816651655245');" style="">  66         this(null);                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  69     /**                                                                                                  </span>
<span class="-4528612473615798665" onmouseenter="enter('-4528612473615798665');" onmouseout="out('-4528612473615798665');" style=""><abbr title="  70      * Creates a new local stream environment that configures its local executor with the given configuration.">  70      * Creates a new local stream environment that configures its local executor with the given configuraðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  71      *                                                                                                   </span>
<span class="-6707673741392514158" onmouseenter="enter('-6707673741392514158');" onmouseout="out('-6707673741392514158');" style="">  72      * @param config The configuration used to configure the local executor.                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73      */                                                                                                  </span>
<span class="-2493191466510402117" onmouseenter="enter('-2493191466510402117');" onmouseout="out('-2493191466510402117');" style="">  74     public MyLocalStreamEnvironment(Configuration config) {                                              </span>
<span class="8789071791401540025" onmouseenter="enter('8789071791401540025');" onmouseout="out('8789071791401540025');" style="">  75         if (!ExecutionEnvironment.areExplicitEnvironmentsAllowed()) {                                    </span>
<span class="7710846670516805987" onmouseenter="enter('7710846670516805987');" onmouseout="out('7710846670516805987');" style="">  76             throw new InvalidProgramException(                                                           </span>
<span class="-2542758256191115215" onmouseenter="enter('-2542758256191115215');" onmouseout="out('-2542758256191115215');" style=""><abbr title="  77                     &quot;The LocalStreamEnvironment cannot be used when submitting a program through a client, &quot; +">  77                     &quot;The LocalStreamEnvironment cannot be used when submitting a program through a clientðŸ”µ</abbr></span>
<span class="6974934080389806707" onmouseenter="enter('6974934080389806707');" onmouseout="out('6974934080389806707');" style="">  78                             &quot;or running in a TestEnvironment context.&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79         }                                                                                                </span>
<span  style="">  80                                                                                                          </span>
<span class="-8373741422957297910" onmouseenter="enter('-8373741422957297910');" onmouseout="out('-8373741422957297910');" style="">  81         this.conf = config == null ? new Configuration() : config;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span  style="">  83                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84     /**                                                                                                  </span>
<span class="1284490758839337609" onmouseenter="enter('1284490758839337609');" onmouseout="out('1284490758839337609');" style="">  85      * Executes the JobGraph of the on a mini cluster of CLusterUtil with a user                         </span>
<span class="-8276390245672004452" onmouseenter="enter('-8276390245672004452');" onmouseout="out('-8276390245672004452');" style="">  86      * specified name.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  87      *                                                                                                   </span>
<span class="1205290586124068771" onmouseenter="enter('1205290586124068771');" onmouseout="out('1205290586124068771');" style="">  88      * @param jobName                                                                                    </span>
<span class="8922276232820338335" onmouseenter="enter('8922276232820338335');" onmouseout="out('8922276232820338335');" style="">  89      *            name of the job                                                                        </span>
<span class="-7125693057193628963" onmouseenter="enter('-7125693057193628963');" onmouseout="out('-7125693057193628963');" style="">  90      * @return The result of the job execution, containing elapsed time and accumulators.                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92     @Override                                                                                            </span>
<span class="1978066122187801914" onmouseenter="enter('1978066122187801914');" onmouseout="out('1978066122187801914');" style="">  93     public JobExecutionResult execute(String jobName) throws Exception {                                 </span>
<span class="-1724004361167976311" onmouseenter="enter('-1724004361167976311');" onmouseout="out('-1724004361167976311');" style="">  94         // transform the streaming program into a JobGraph                                               </span>
<span class="2530093744782704739" onmouseenter="enter('2530093744782704739');" onmouseout="out('2530093744782704739');" style="">  95         StreamGraph streamGraph = getStreamGraph();                                                      </span>
<span class="6186400327817873378" onmouseenter="enter('6186400327817873378');" onmouseout="out('6186400327817873378');" style="">  96         streamGraph.setJobName(jobName);                                                                 </span>
<span class="-5806655344611004702" onmouseenter="enter('-5806655344611004702');" onmouseout="out('-5806655344611004702');" style="">  97         return execute(streamGraph);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98     }                                                                                                    </span>
<span  style="">  99                                                                                                          </span>
<span class="-8115262382803132310" onmouseenter="enter('-8115262382803132310');" onmouseout="out('-8115262382803132310');" style=""> 100     public JobExecutionResult execute(StreamGraph streamGraph) throws Exception {                        </span>
<span  style=""> 101                                                                                                          </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style=""> 102         JobGraph jobGraph = streamGraph.getJobGraph();                                                   </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style=""> 103         jobGraph.setClasspaths(classpaths);                                                              </span>
<span class="469304360307650831" onmouseenter="enter('469304360307650831');" onmouseout="out('469304360307650831');" style=""> 104         jobGraph.setAllowQueuedScheduling(true);                                                         </span>
<span  style=""> 105                                                                                                          </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style=""> 106         Configuration configuration = new Configuration();                                               </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style=""> 107         configuration.addAll(jobGraph.getJobConfiguration());                                            </span>
<span class="-2347000785166369020" onmouseenter="enter('-2347000785166369020');" onmouseout="out('-2347000785166369020');" style=""> 108         configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;0&quot;);                            </span>
<span  style=""> 109                                                                                                          </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style=""> 110         // add (and override) the settings with what the user defined                                    </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style=""> 111         configuration.addAll(this.conf);                                                                 </span>
<span  style=""> 112                                                                                                          </span>
<span class="1146827845910868279" onmouseenter="enter('1146827845910868279');" onmouseout="out('1146827845910868279');" style=""> 113         if (!configuration.contains(RestOptions.BIND_PORT)) {                                            </span>
<span class="-970167148439492506" onmouseenter="enter('-970167148439492506');" onmouseout="out('-970167148439492506');" style=""> 114             configuration.setString(RestOptions.BIND_PORT, &quot;0&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span  style=""> 116                                                                                                          </span>
<span class="7193442408929112501" onmouseenter="enter('7193442408929112501');" onmouseout="out('7193442408929112501');" style=""><abbr title=" 117         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());"> 117         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraphðŸ”µ</abbr></span>
<span  style=""> 118                                                                                                          </span>
<span class="-6461278587826064637" onmouseenter="enter('-6461278587826064637');" onmouseout="out('-6461278587826064637');" style=""> 119         MiniClusterConfiguration cfg = new MiniClusterConfiguration.Builder()                            </span>
<span class="-5561795182015022337" onmouseenter="enter('-5561795182015022337');" onmouseout="out('-5561795182015022337');" style=""> 120                 .setConfiguration(configuration)                                                         </span>
<span class="-267175273231167629" onmouseenter="enter('-267175273231167629');" onmouseout="out('-267175273231167629');" style=""> 121                 .setNumSlotsPerTaskManager(numSlotsPerTaskManager)                                       </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 122                 .build();                                                                                </span>
<span  style=""> 123                                                                                                          </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 124         if (LOG.isInfoEnabled()) {                                                                       </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style=""> 125             LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span  style=""> 127                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 128 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-184687421353294589" onmouseenter="enter('-184687421353294589');" onmouseout="out('-184687421353294589');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129         MiniCluster miniCluster = new MiniCluster(cfg);                                                  </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131         try {                                                                                            </span>
<span class="-6379149240419989614" onmouseenter="enter('-6379149240419989614');" onmouseout="out('-6379149240419989614');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132             miniCluster.start();                                                                         </span>
<span class="1705754538614300842" onmouseenter="enter('1705754538614300842');" onmouseout="out('1705754538614300842');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133             configuration.setInteger(RestOptions.PORT, miniCluster.getRestAddress().get().getPort());    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134                                                                                                          </span>
<span class="109994806188102896" onmouseenter="enter('109994806188102896');" onmouseout="out('109994806188102896');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135             return miniCluster.executeJobBlocking(jobGraph);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136         }                                                                                                </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137         finally {                                                                                        </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 138 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6927310010976677086" onmouseenter="enter('6927310010976677086');" onmouseout="out('6927310010976677086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139         MiniCluster exec = new MiniCluster(configBuilder.build());                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         try {                                                                                            </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141             exec.start();                                                                                </span>
<span class="7731757287012350095" onmouseenter="enter('7731757287012350095');" onmouseout="out('7731757287012350095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142             return exec.executeJobBlocking(jobGraph);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         }                                                                                                </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         finally {                                                                                        </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145             transformations.clear();                                                                     </span>
<span class="5486376394376154741" onmouseenter="enter('5486376394376154741');" onmouseout="out('5486376394376154741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146             exec.closeAsync();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 150 =======                                                                                                  </span>
<span class="168373147428824238" onmouseenter="enter('168373147428824238');" onmouseout="out('168373147428824238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151         try (MiniCluster exec = new MiniCluster(configBuilder.build());) {                               </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152             exec.start();                                                                                </span>
<span class="-4131614522424838430" onmouseenter="enter('-4131614522424838430');" onmouseout="out('-4131614522424838430');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153             JobExecutionResult jobExecutionResult = exec.executeJobBlocking(jobGraph);                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 154 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style=""> 155             transformations.clear();                                                                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 156 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-3977601811582495792" onmouseenter="enter('-3977601811582495792');" onmouseout="out('-3977601811582495792');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157             miniCluster.close();                                                                         </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 158 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159         }                                                                                                </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160         finally {                                                                                        </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161             transformations.clear();                                                                     </span>
<span class="5486376394376154741" onmouseenter="enter('5486376394376154741');" onmouseout="out('5486376394376154741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162             exec.closeAsync();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 166 =======                                                                                                  </span>
<span class="-1000843434916666050" onmouseenter="enter('-1000843434916666050');" onmouseout="out('-1000843434916666050');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167             return jobExecutionResult;                                                                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168         } catch (Exception e) {                                                                          </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169             throw new RuntimeException(e);                                                               </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 170 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173 }                                                                                                        </span>


























</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="5598128254818160022" onmouseenter="enter('5598128254818160022');" onmouseout="out('5598128254818160022');" style="">  19 package com.dtstack.flink.sql.environment;                                                               </span>
<span  style="">  20                                                                                                          </span>
<span class="2461872502712586167" onmouseenter="enter('2461872502712586167');" onmouseout="out('2461872502712586167');" style="">  21 import org.apache.flink.api.common.InvalidProgramException;                                              </span>
<span class="8256876323376004396" onmouseenter="enter('8256876323376004396');" onmouseout="out('8256876323376004396');" style="">  22 import org.apache.flink.api.common.JobExecutionResult;                                                   </span>
<span class="-902830676319511587" onmouseenter="enter('-902830676319511587');" onmouseout="out('-902830676319511587');" style="">  23 import org.apache.flink.api.java.ExecutionEnvironment;                                                   </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5318294912310187959" onmouseenter="enter('5318294912310187959');" onmouseout="out('5318294912310187959');" style="">  25 import org.apache.flink.configuration.RestOptions;                                                       </span>
<span class="1850401773685605073" onmouseenter="enter('1850401773685605073');" onmouseout="out('1850401773685605073');" style="">  26 import org.apache.flink.configuration.TaskManagerOptions;                                                </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  27 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="-2713113410259205994" onmouseenter="enter('-2713113410259205994');" onmouseout="out('-2713113410259205994');" style="">  28 import org.apache.flink.runtime.minicluster.MiniCluster;                                                 </span>
<span class="1583265242678797853" onmouseenter="enter('1583265242678797853');" onmouseout="out('1583265242678797853');" style="">  29 import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;                                    </span>
<span class="5297953280946518295" onmouseenter="enter('5297953280946518295');" onmouseout="out('5297953280946518295');" style="">  30 import org.apache.flink.streaming.api.environment.LocalStreamEnvironment;                                </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  31 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="-6686939373153454077" onmouseenter="enter('-6686939373153454077');" onmouseout="out('-6686939373153454077');" style="">  32 import org.apache.flink.streaming.api.graph.StreamGraph;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  35                                                                                                          </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  36 import java.net.URL;                                                                                     </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  37 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  38 import java.util.List;                                                                                   </span>
<span  style="">  39                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40 /**                                                                                                      </span>
<span class="-3231818603887923319" onmouseenter="enter('-3231818603887923319');" onmouseout="out('-3231818603887923319');" style="">  41  * Local Stream Environment                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  42  *                                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  43  * Company: www.dtstack.com                                                                              </span>
<span class="6779159400583430426" onmouseenter="enter('6779159400583430426');" onmouseout="out('6779159400583430426');" style="">  44  * @author huyifan.zju@163.com                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45  */                                                                                                      </span>
<span class="4246239116754757473" onmouseenter="enter('4246239116754757473');" onmouseout="out('4246239116754757473');" style="">  46 public class MyLocalStreamEnvironment extends StreamExecutionEnvironment {                               </span>
<span class="927814391059993389" onmouseenter="enter('927814391059993389');" onmouseout="out('927814391059993389');" style="">  47     private static final Logger LOG = LoggerFactory.getLogger(LocalStreamEnvironment.class);             </span>
<span  style="">  48                                                                                                          </span>
<span class="-8302311498454820742" onmouseenter="enter('-8302311498454820742');" onmouseout="out('-8302311498454820742');" style="">  49     /** The configuration to use for the local cluster. */                                               </span>
<span class="-5224455178778766138" onmouseenter="enter('-5224455178778766138');" onmouseout="out('-5224455178778766138');" style="">  50     private final Configuration conf;                                                                    </span>
<span  style="">  51                                                                                                          </span>
<span class="33436849132097052" onmouseenter="enter('33436849132097052');" onmouseout="out('33436849132097052');" style="">  52     public List&lt;URL&gt; getClasspaths() {                                                                   </span>
<span class="-6420995887957701132" onmouseenter="enter('-6420995887957701132');" onmouseout="out('-6420995887957701132');" style="">  53         return classpaths;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54     }                                                                                                    </span>
<span  style="">  55                                                                                                          </span>
<span class="4428292286261856619" onmouseenter="enter('4428292286261856619');" onmouseout="out('4428292286261856619');" style="">  56     public void setClasspaths(List&lt;URL&gt; classpaths) {                                                    </span>
<span class="-284268027982127308" onmouseenter="enter('-284268027982127308');" onmouseout="out('-284268027982127308');" style="">  57         this.classpaths = classpaths;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58     }                                                                                                    </span>
<span  style="">  59                                                                                                          </span>
<span class="-6352601788059183844" onmouseenter="enter('-6352601788059183844');" onmouseout="out('-6352601788059183844');" style="">  60     private List&lt;URL&gt; classpaths = Collections.emptyList();                                              </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62     /**                                                                                                  </span>
<span class="-4066435560223898603" onmouseenter="enter('-4066435560223898603');" onmouseout="out('-4066435560223898603');" style="">  63      * Creates a new local stream environment that uses the default configuration.                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64      */                                                                                                  </span>
<span class="3058085256785609242" onmouseenter="enter('3058085256785609242');" onmouseout="out('3058085256785609242');" style="">  65     public MyLocalStreamEnvironment() {                                                                  </span>
<span class="4995832816651655245" onmouseenter="enter('4995832816651655245');" onmouseout="out('4995832816651655245');" style="">  66         this(null);                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67     }                                                                                                    </span>
<span  style="">  68                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  69     /**                                                                                                  </span>
<span class="-4528612473615798665" onmouseenter="enter('-4528612473615798665');" onmouseout="out('-4528612473615798665');" style=""><abbr title="  70      * Creates a new local stream environment that configures its local executor with the given configuration.">  70      * Creates a new local stream environment that configures its local executor with the given configuraðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  71      *                                                                                                   </span>
<span class="-6707673741392514158" onmouseenter="enter('-6707673741392514158');" onmouseout="out('-6707673741392514158');" style="">  72      * @param config The configuration used to configure the local executor.                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73      */                                                                                                  </span>
<span class="-2493191466510402117" onmouseenter="enter('-2493191466510402117');" onmouseout="out('-2493191466510402117');" style="">  74     public MyLocalStreamEnvironment(Configuration config) {                                              </span>
<span class="8789071791401540025" onmouseenter="enter('8789071791401540025');" onmouseout="out('8789071791401540025');" style="">  75         if (!ExecutionEnvironment.areExplicitEnvironmentsAllowed()) {                                    </span>
<span class="7710846670516805987" onmouseenter="enter('7710846670516805987');" onmouseout="out('7710846670516805987');" style="">  76             throw new InvalidProgramException(                                                           </span>
<span class="-2542758256191115215" onmouseenter="enter('-2542758256191115215');" onmouseout="out('-2542758256191115215');" style=""><abbr title="  77                     &quot;The LocalStreamEnvironment cannot be used when submitting a program through a client, &quot; +">  77                     &quot;The LocalStreamEnvironment cannot be used when submitting a program through a clientðŸ”µ</abbr></span>
<span class="6974934080389806707" onmouseenter="enter('6974934080389806707');" onmouseout="out('6974934080389806707');" style="">  78                             &quot;or running in a TestEnvironment context.&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79         }                                                                                                </span>
<span  style="">  80                                                                                                          </span>
<span class="-8373741422957297910" onmouseenter="enter('-8373741422957297910');" onmouseout="out('-8373741422957297910');" style="">  81         this.conf = config == null ? new Configuration() : config;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span  style="">  83                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84     /**                                                                                                  </span>
<span class="1284490758839337609" onmouseenter="enter('1284490758839337609');" onmouseout="out('1284490758839337609');" style="">  85      * Executes the JobGraph of the on a mini cluster of CLusterUtil with a user                         </span>
<span class="-8276390245672004452" onmouseenter="enter('-8276390245672004452');" onmouseout="out('-8276390245672004452');" style="">  86      * specified name.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  87      *                                                                                                   </span>
<span class="1205290586124068771" onmouseenter="enter('1205290586124068771');" onmouseout="out('1205290586124068771');" style="">  88      * @param jobName                                                                                    </span>
<span class="8922276232820338335" onmouseenter="enter('8922276232820338335');" onmouseout="out('8922276232820338335');" style="">  89      *            name of the job                                                                        </span>
<span class="-7125693057193628963" onmouseenter="enter('-7125693057193628963');" onmouseout="out('-7125693057193628963');" style="">  90      * @return The result of the job execution, containing elapsed time and accumulators.                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92     @Override                                                                                            </span>
<span class="1978066122187801914" onmouseenter="enter('1978066122187801914');" onmouseout="out('1978066122187801914');" style="">  93     public JobExecutionResult execute(String jobName) throws Exception {                                 </span>
<span class="-1724004361167976311" onmouseenter="enter('-1724004361167976311');" onmouseout="out('-1724004361167976311');" style="">  94         // transform the streaming program into a JobGraph                                               </span>
<span class="2530093744782704739" onmouseenter="enter('2530093744782704739');" onmouseout="out('2530093744782704739');" style="">  95         StreamGraph streamGraph = getStreamGraph();                                                      </span>
<span class="6186400327817873378" onmouseenter="enter('6186400327817873378');" onmouseout="out('6186400327817873378');" style="">  96         streamGraph.setJobName(jobName);                                                                 </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  97 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-5806655344611004702" onmouseenter="enter('-5806655344611004702');" onmouseout="out('-5806655344611004702');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  98         return execute(streamGraph);                                                                     </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  99 ||||||| BASE                                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100                                                                                                          </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101         JobGraph jobGraph = streamGraph.getJobGraph();                                                   </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102         jobGraph.setClasspaths(classpaths);                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103                                                                                                          </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104         Configuration configuration = new Configuration();                                               </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105         configuration.addAll(jobGraph.getJobConfiguration());                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106                                                                                                          </span>
<span class="-7627712255778921581" onmouseenter="enter('-7627712255778921581');" onmouseout="out('-7627712255778921581');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107         configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;512M&quot;);                         </span>
<span class="5682313294434480073" onmouseenter="enter('5682313294434480073');" onmouseout="out('5682313294434480073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108         configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                                                                                                          </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110         // add (and override) the settings with what the user defined                                    </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111         configuration.addAll(this.conf);                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                                                                                                          </span>
<span class="-4067763610081958627" onmouseenter="enter('-4067763610081958627');" onmouseout="out('-4067763610081958627');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113         MiniClusterConfiguration.Builder configBuilder = new MiniClusterConfiguration.Builder();         </span>
<span class="-218288098588460842" onmouseenter="enter('-218288098588460842');" onmouseout="out('-218288098588460842');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114         configBuilder.setConfiguration(configuration);                                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115                                                                                                          </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116         if (LOG.isInfoEnabled()) {                                                                       </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117             LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119                                                                                                          </span>
<span class="6927310010976677086" onmouseenter="enter('6927310010976677086');" onmouseout="out('6927310010976677086');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120         MiniCluster exec = new MiniCluster(configBuilder.build());                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121         try {                                                                                            </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122             exec.start();                                                                                </span>
<span class="7731757287012350095" onmouseenter="enter('7731757287012350095');" onmouseout="out('7731757287012350095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123             return exec.executeJobBlocking(jobGraph);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124         }                                                                                                </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125         finally {                                                                                        </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126             transformations.clear();                                                                     </span>
<span class="5486376394376154741" onmouseenter="enter('5486376394376154741');" onmouseout="out('5486376394376154741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127             exec.closeAsync();                                                                           </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 128 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129                                                                                                          </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130         JobGraph jobGraph = streamGraph.getJobGraph();                                                   </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131         jobGraph.setClasspaths(classpaths);                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132                                                                                                          </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133         Configuration configuration = new Configuration();                                               </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134         configuration.addAll(jobGraph.getJobConfiguration());                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135                                                                                                          </span>
<span class="-7627712255778921581" onmouseenter="enter('-7627712255778921581');" onmouseout="out('-7627712255778921581');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136         configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;512M&quot;);                         </span>
<span class="5682313294434480073" onmouseenter="enter('5682313294434480073');" onmouseout="out('5682313294434480073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137         configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138                                                                                                          </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139         // add (and override) the settings with what the user defined                                    </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140         configuration.addAll(this.conf);                                                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141                                                                                                          </span>
<span class="-4067763610081958627" onmouseenter="enter('-4067763610081958627');" onmouseout="out('-4067763610081958627');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142         MiniClusterConfiguration.Builder configBuilder = new MiniClusterConfiguration.Builder();         </span>
<span class="-218288098588460842" onmouseenter="enter('-218288098588460842');" onmouseout="out('-218288098588460842');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143         configBuilder.setConfiguration(configuration);                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                                                                                                          </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145         if (LOG.isInfoEnabled()) {                                                                       </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146             LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148                                                                                                          </span>
<span class="168373147428824238" onmouseenter="enter('168373147428824238');" onmouseout="out('168373147428824238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149         try (MiniCluster exec = new MiniCluster(configBuilder.build());) {                               </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150             exec.start();                                                                                </span>
<span class="-4131614522424838430" onmouseenter="enter('-4131614522424838430');" onmouseout="out('-4131614522424838430');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151             JobExecutionResult jobExecutionResult = exec.executeJobBlocking(jobGraph);                   </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152             transformations.clear();                                                                     </span>
<span class="-1000843434916666050" onmouseenter="enter('-1000843434916666050');" onmouseout="out('-1000843434916666050');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153             return jobExecutionResult;                                                                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154         } catch (Exception e) {                                                                          </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155             throw new RuntimeException(e);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156         }                                                                                                </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 157 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="-8115262382803132310" onmouseenter="enter('-8115262382803132310');" onmouseout="out('-8115262382803132310');" style=""> 160     public JobExecutionResult execute(StreamGraph streamGraph) throws Exception {                        </span>
<span  style=""> 161                                                                                                          </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style=""> 162         JobGraph jobGraph = streamGraph.getJobGraph();                                                   </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style=""> 163         jobGraph.setClasspaths(classpaths);                                                              </span>
<span class="469304360307650831" onmouseenter="enter('469304360307650831');" onmouseout="out('469304360307650831');" style=""> 164         jobGraph.setAllowQueuedScheduling(true);                                                         </span>
<span  style=""> 165                                                                                                          </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style=""> 166         Configuration configuration = new Configuration();                                               </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style=""> 167         configuration.addAll(jobGraph.getJobConfiguration());                                            </span>
<span class="-2347000785166369020" onmouseenter="enter('-2347000785166369020');" onmouseout="out('-2347000785166369020');" style=""> 168         configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;0&quot;);                            </span>
<span  style=""> 169                                                                                                          </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style=""> 170         // add (and override) the settings with what the user defined                                    </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style=""> 171         configuration.addAll(this.conf);                                                                 </span>
<span  style=""> 172                                                                                                          </span>
<span class="1146827845910868279" onmouseenter="enter('1146827845910868279');" onmouseout="out('1146827845910868279');" style=""> 173         if (!configuration.contains(RestOptions.BIND_PORT)) {                                            </span>
<span class="-970167148439492506" onmouseenter="enter('-970167148439492506');" onmouseout="out('-970167148439492506');" style=""> 174             configuration.setString(RestOptions.BIND_PORT, &quot;0&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175         }                                                                                                </span>
<span  style=""> 176                                                                                                          </span>
<span class="7193442408929112501" onmouseenter="enter('7193442408929112501');" onmouseout="out('7193442408929112501');" style=""><abbr title=" 177         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());"> 177         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraphðŸ”µ</abbr></span>
<span  style=""> 178                                                                                                          </span>
<span class="-6461278587826064637" onmouseenter="enter('-6461278587826064637');" onmouseout="out('-6461278587826064637');" style=""> 179         MiniClusterConfiguration cfg = new MiniClusterConfiguration.Builder()                            </span>
<span class="-5561795182015022337" onmouseenter="enter('-5561795182015022337');" onmouseout="out('-5561795182015022337');" style=""> 180                 .setConfiguration(configuration)                                                         </span>
<span class="-267175273231167629" onmouseenter="enter('-267175273231167629');" onmouseout="out('-267175273231167629');" style=""> 181                 .setNumSlotsPerTaskManager(numSlotsPerTaskManager)                                       </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style=""> 182                 .build();                                                                                </span>
<span  style=""> 183                                                                                                          </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 184         if (LOG.isInfoEnabled()) {                                                                       </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style=""> 185             LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span  style=""> 187                                                                                                          </span>
<span class="-184687421353294589" onmouseenter="enter('-184687421353294589');" onmouseout="out('-184687421353294589');" style=""> 188         MiniCluster miniCluster = new MiniCluster(cfg);                                                  </span>
<span  style=""> 189                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 190         try {                                                                                            </span>
<span class="-6379149240419989614" onmouseenter="enter('-6379149240419989614');" onmouseout="out('-6379149240419989614');" style=""> 191             miniCluster.start();                                                                         </span>
<span class="1705754538614300842" onmouseenter="enter('1705754538614300842');" onmouseout="out('1705754538614300842');" style=""> 192             configuration.setInteger(RestOptions.PORT, miniCluster.getRestAddress().get().getPort());    </span>
<span  style=""> 193                                                                                                          </span>
<span class="109994806188102896" onmouseenter="enter('109994806188102896');" onmouseout="out('109994806188102896');" style=""> 194             return miniCluster.executeJobBlocking(jobGraph);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style=""> 196         finally {                                                                                        </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style=""> 197             transformations.clear();                                                                     </span>
<span class="-3977601811582495792" onmouseenter="enter('-3977601811582495792');" onmouseout="out('-3977601811582495792');" style=""> 198             miniCluster.close();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="5598128254818160022" onmouseenter="enter('5598128254818160022');" onmouseout="out('5598128254818160022');" style="">  18 package com.dtstack.flink.sql.environment;                                                               </span>
<span  style="">  19                                                                                                          </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  20 import java.net.URL;                                                                                     </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  21 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  22 import java.util.List;                                                                                   </span>
<span class="2461872502712586167" onmouseenter="enter('2461872502712586167');" onmouseout="out('2461872502712586167');" style="">  23 import org.apache.flink.api.common.InvalidProgramException;                                              </span>
<span class="8256876323376004396" onmouseenter="enter('8256876323376004396');" onmouseout="out('8256876323376004396');" style="">  24 import org.apache.flink.api.common.JobExecutionResult;                                                   </span>
<span class="-902830676319511587" onmouseenter="enter('-902830676319511587');" onmouseout="out('-902830676319511587');" style="">  25 import org.apache.flink.api.java.ExecutionEnvironment;                                                   </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  26 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5318294912310187959" onmouseenter="enter('5318294912310187959');" onmouseout="out('5318294912310187959');" style="">  27 import org.apache.flink.configuration.RestOptions;                                                       </span>
<span class="1850401773685605073" onmouseenter="enter('1850401773685605073');" onmouseout="out('1850401773685605073');" style="">  28 import org.apache.flink.configuration.TaskManagerOptions;                                                </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  29 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="-2713113410259205994" onmouseenter="enter('-2713113410259205994');" onmouseout="out('-2713113410259205994');" style="">  30 import org.apache.flink.runtime.minicluster.MiniCluster;                                                 </span>
<span class="1583265242678797853" onmouseenter="enter('1583265242678797853');" onmouseout="out('1583265242678797853');" style="">  31 import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;                                    </span>
<span class="5297953280946518295" onmouseenter="enter('5297953280946518295');" onmouseout="out('5297953280946518295');" style="">  32 import org.apache.flink.streaming.api.environment.LocalStreamEnvironment;                                </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  33 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="-6686939373153454077" onmouseenter="enter('-6686939373153454077');" onmouseout="out('-6686939373153454077');" style="">  34 import org.apache.flink.streaming.api.graph.StreamGraph;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  35 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  36 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  37                                                                                                          </span>
<span  style="">  38                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  39 /**                                                                                                      </span>
<span class="-3231818603887923319" onmouseenter="enter('-3231818603887923319');" onmouseout="out('-3231818603887923319');" style="">  40  * Local Stream Environment                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  41  *                                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  42  * Company: www.dtstack.com                                                                              </span>
<span class="6779159400583430426" onmouseenter="enter('6779159400583430426');" onmouseout="out('6779159400583430426');" style="">  43  * @author huyifan.zju@163.com                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  44  */                                                                                                      </span>
<span class="4246239116754757473" onmouseenter="enter('4246239116754757473');" onmouseout="out('4246239116754757473');" style="">  45 public class MyLocalStreamEnvironment extends StreamExecutionEnvironment {                               </span>
<span class="927814391059993389" onmouseenter="enter('927814391059993389');" onmouseout="out('927814391059993389');" style="">  46     private static final Logger LOG = LoggerFactory.getLogger(LocalStreamEnvironment.class);             </span>
<span  style="">  47                                                                                                          </span>
<span class="-8302311498454820742" onmouseenter="enter('-8302311498454820742');" onmouseout="out('-8302311498454820742');" style="">  48     /** The configuration to use for the local cluster. */                                               </span>
<span class="-5224455178778766138" onmouseenter="enter('-5224455178778766138');" onmouseout="out('-5224455178778766138');" style="">  49     private final Configuration conf;                                                                    </span>
<span  style="">  50                                                                                                          </span>
<span class="33436849132097052" onmouseenter="enter('33436849132097052');" onmouseout="out('33436849132097052');" style="">  51     public List&lt;URL&gt; getClasspaths() {                                                                   </span>
<span class="-6420995887957701132" onmouseenter="enter('-6420995887957701132');" onmouseout="out('-6420995887957701132');" style="">  52         return classpaths;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53     }                                                                                                    </span>
<span  style="">  54                                                                                                          </span>
<span class="4428292286261856619" onmouseenter="enter('4428292286261856619');" onmouseout="out('4428292286261856619');" style="">  55     public void setClasspaths(List&lt;URL&gt; classpaths) {                                                    </span>
<span class="-284268027982127308" onmouseenter="enter('-284268027982127308');" onmouseout="out('-284268027982127308');" style="">  56         this.classpaths = classpaths;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57     }                                                                                                    </span>
<span  style="">  58                                                                                                          </span>
<span class="-6352601788059183844" onmouseenter="enter('-6352601788059183844');" onmouseout="out('-6352601788059183844');" style="">  59     private List&lt;URL&gt; classpaths = Collections.emptyList();                                              </span>
<span  style="">  60                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61     /**                                                                                                  </span>
<span class="-4066435560223898603" onmouseenter="enter('-4066435560223898603');" onmouseout="out('-4066435560223898603');" style="">  62      * Creates a new local stream environment that uses the default configuration.                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63      */                                                                                                  </span>
<span class="3058085256785609242" onmouseenter="enter('3058085256785609242');" onmouseout="out('3058085256785609242');" style="">  64     public MyLocalStreamEnvironment() {                                                                  </span>
<span class="4995832816651655245" onmouseenter="enter('4995832816651655245');" onmouseout="out('4995832816651655245');" style="">  65         this(null);                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66     }                                                                                                    </span>
<span  style="">  67                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68     /**                                                                                                  </span>
<span class="-4528612473615798665" onmouseenter="enter('-4528612473615798665');" onmouseout="out('-4528612473615798665');" style=""><abbr title="  69      * Creates a new local stream environment that configures its local executor with the given configuration.">  69      * Creates a new local stream environment that configures its local executor with the given configuraðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  70      *                                                                                                   </span>
<span class="-7608443615991866972" onmouseenter="enter('-7608443615991866972');" onmouseout="out('-7608443615991866972');" style="">  71      * @param config                                                                                     </span>
<span class="3984938571057825749" onmouseenter="enter('3984938571057825749');" onmouseout="out('3984938571057825749');" style="">  72      * 		The configuration used to configure the local executor.                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73      */                                                                                                  </span>
<span class="-2493191466510402117" onmouseenter="enter('-2493191466510402117');" onmouseout="out('-2493191466510402117');" style="">  74     public MyLocalStreamEnvironment(Configuration config) {                                              </span>
<span class="8789071791401540025" onmouseenter="enter('8789071791401540025');" onmouseout="out('8789071791401540025');" style="">  75         if (!ExecutionEnvironment.areExplicitEnvironmentsAllowed()) {                                    </span>
<span class="1015100435640193477" onmouseenter="enter('1015100435640193477');" onmouseout="out('1015100435640193477');" style=""><abbr title="  76             throw new InvalidProgramException(&quot;The LocalStreamEnvironment cannot be used when submitting a program through a client, &quot; + &quot;or running in a TestEnvironment context.&quot;);">  76             throw new InvalidProgramException(&quot;The LocalStreamEnvironment cannot be used when submitting ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77         }                                                                                                </span>
<span class="8027398753728377815" onmouseenter="enter('8027398753728377815');" onmouseout="out('8027398753728377815');" style="">  78         this.conf = (config == null) ? new Configuration() : config;                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  81     /**                                                                                                  </span>
<span class="1284490758839337609" onmouseenter="enter('1284490758839337609');" onmouseout="out('1284490758839337609');" style="">  82      * Executes the JobGraph of the on a mini cluster of CLusterUtil with a user                         </span>
<span class="-8276390245672004452" onmouseenter="enter('-8276390245672004452');" onmouseout="out('-8276390245672004452');" style="">  83      * specified name.                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  84      *                                                                                                   </span>
<span class="1205290586124068771" onmouseenter="enter('1205290586124068771');" onmouseout="out('1205290586124068771');" style="">  85      * @param jobName                                                                                    </span>
<span class="8922276232820338335" onmouseenter="enter('8922276232820338335');" onmouseout="out('8922276232820338335');" style="">  86      *            name of the job                                                                        </span>
<span class="-7125693057193628963" onmouseenter="enter('-7125693057193628963');" onmouseout="out('-7125693057193628963');" style="">  87      * @return The result of the job execution, containing elapsed time and accumulators.                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  88      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  89     @Override                                                                                            </span>
<span class="1978066122187801914" onmouseenter="enter('1978066122187801914');" onmouseout="out('1978066122187801914');" style="">  90     public JobExecutionResult execute(String jobName) throws Exception {                                 </span>
<span class="-1724004361167976311" onmouseenter="enter('-1724004361167976311');" onmouseout="out('-1724004361167976311');" style="">  91         // transform the streaming program into a JobGraph                                               </span>
<span class="2530093744782704739" onmouseenter="enter('2530093744782704739');" onmouseout="out('2530093744782704739');" style="">  92         StreamGraph streamGraph = getStreamGraph();                                                      </span>
<span class="6186400327817873378" onmouseenter="enter('6186400327817873378');" onmouseout="out('6186400327817873378');" style="">  93         streamGraph.setJobName(jobName);                                                                 </span>
<span class="-5806655344611004702" onmouseenter="enter('-5806655344611004702');" onmouseout="out('-5806655344611004702');" style="">  94         return execute(streamGraph);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95     }                                                                                                    </span>
<span  style="">  96                                                                                                          </span>
<span class="-8115262382803132310" onmouseenter="enter('-8115262382803132310');" onmouseout="out('-8115262382803132310');" style="">  97     public JobExecutionResult execute(StreamGraph streamGraph) throws Exception {                        </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style="">  98         JobGraph jobGraph = streamGraph.getJobGraph();                                                   </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style="">  99         jobGraph.setClasspaths(classpaths);                                                              </span>
<span class="469304360307650831" onmouseenter="enter('469304360307650831');" onmouseout="out('469304360307650831');" style=""> 100         jobGraph.setAllowQueuedScheduling(true);                                                         </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style=""> 101         Configuration configuration = new Configuration();                                               </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style=""> 102         configuration.addAll(jobGraph.getJobConfiguration());                                            </span>
<span class="-2347000785166369020" onmouseenter="enter('-2347000785166369020');" onmouseout="out('-2347000785166369020');" style=""> 103         configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;0&quot;);                            </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style=""> 104         // add (and override) the settings with what the user defined                                    </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style=""> 105         configuration.addAll(this.conf);                                                                 </span>
<span class="1146827845910868279" onmouseenter="enter('1146827845910868279');" onmouseout="out('1146827845910868279');" style=""> 106         if (!configuration.contains(RestOptions.BIND_PORT)) {                                            </span>
<span class="-970167148439492506" onmouseenter="enter('-970167148439492506');" onmouseout="out('-970167148439492506');" style=""> 107             configuration.setString(RestOptions.BIND_PORT, &quot;0&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="7193442408929112501" onmouseenter="enter('7193442408929112501');" onmouseout="out('7193442408929112501');" style=""><abbr title=" 109         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());"> 109         int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraphðŸ”µ</abbr></span>
<span class="4163294475633519864" onmouseenter="enter('4163294475633519864');" onmouseout="out('4163294475633519864');" style=""><abbr title=" 110         MiniClusterConfiguration cfg = new MiniClusterConfiguration.Builder().setConfiguration(configuration).setNumSlotsPerTaskManager(numSlotsPerTaskManager).build();"> 110         MiniClusterConfiguration cfg = new MiniClusterConfiguration.Builder().setConfiguration(configuratðŸ”µ</abbr></span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 111         if (LOG.isInfoEnabled()) {                                                                       </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style=""> 112             LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113         }                                                                                                </span>
<span class="8874474461313001992" onmouseenter="enter('8874474461313001992');" onmouseout="out('8874474461313001992');" style=""> 114         try (final MiniCluster exec = new MiniCluster(cfg)) {                                            </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style=""> 115             exec.start();                                                                                </span>
<span class="3695977717033734852" onmouseenter="enter('3695977717033734852');" onmouseout="out('3695977717033734852');" style=""> 116             JobExecutionResult jobExecutionResult = miniCluster.executeJobBlocking(jobGraph);            </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style=""> 117             transformations.clear();                                                                     </span>
<span class="-1000843434916666050" onmouseenter="enter('-1000843434916666050');" onmouseout="out('-1000843434916666050');" style=""> 118             return jobExecutionResult;                                                                   </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 119         } catch (java.lang.Exception e) {                                                                </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style=""> 120             throw new RuntimeException(e);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123 }                                                                                                        </span>












































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="5598128254818160022" onmouseenter="enter('5598128254818160022');" onmouseout="out('5598128254818160022');" style="">  19  package com.dtstack.flink.sql.environment;                                                                        </span>
<span  style="">  20                                                                                                                    </span>
<span class="2461872502712586167" onmouseenter="enter('2461872502712586167');" onmouseout="out('2461872502712586167');" style="">  21  import org.apache.flink.api.common.InvalidProgramException;                                                       </span>
<span class="8256876323376004396" onmouseenter="enter('8256876323376004396');" onmouseout="out('8256876323376004396');" style="">  22  import org.apache.flink.api.common.JobExecutionResult;                                                            </span>
<span class="-902830676319511587" onmouseenter="enter('-902830676319511587');" onmouseout="out('-902830676319511587');" style="">  23  import org.apache.flink.api.java.ExecutionEnvironment;                                                            </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="5318294912310187959" onmouseenter="enter('5318294912310187959');" onmouseout="out('5318294912310187959');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import org.apache.flink.configuration.RestOptions;                                                                </span>
<span class="1850401773685605073" onmouseenter="enter('1850401773685605073');" onmouseout="out('1850401773685605073');" style="">  26  import org.apache.flink.configuration.TaskManagerOptions;                                                         </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  27  import org.apache.flink.runtime.jobgraph.JobGraph;                                                                </span>
<span class="-2713113410259205994" onmouseenter="enter('-2713113410259205994');" onmouseout="out('-2713113410259205994');" style="">  28  import org.apache.flink.runtime.minicluster.MiniCluster;                                                          </span>
<span class="1583265242678797853" onmouseenter="enter('1583265242678797853');" onmouseout="out('1583265242678797853');" style="">  29  import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;                                             </span>
<span class="5297953280946518295" onmouseenter="enter('5297953280946518295');" onmouseout="out('5297953280946518295');" style="">  30  import org.apache.flink.streaming.api.environment.LocalStreamEnvironment;                                         </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  31  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="-6686939373153454077" onmouseenter="enter('-6686939373153454077');" onmouseout="out('-6686939373153454077');" style="">  32  import org.apache.flink.streaming.api.graph.StreamGraph;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  35                                                                                                                    </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  36  import java.net.URL;                                                                                              </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  37  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  38  import java.util.List;                                                                                            </span>
<span  style="">  39                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40  /**                                                                                                               </span>
<span class="-3231818603887923319" onmouseenter="enter('-3231818603887923319');" onmouseout="out('-3231818603887923319');" style="">  41   * Local Stream Environment                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  42   *                                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  43   * Company: www.dtstack.com                                                                                       </span>
<span class="6779159400583430426" onmouseenter="enter('6779159400583430426');" onmouseout="out('6779159400583430426');" style="">  44   * @author huyifan.zju@163.com                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45   */                                                                                                               </span>
<span class="4246239116754757473" onmouseenter="enter('4246239116754757473');" onmouseout="out('4246239116754757473');" style="">  46  public class MyLocalStreamEnvironment extends StreamExecutionEnvironment {                                        </span>
<span class="927814391059993389" onmouseenter="enter('927814391059993389');" onmouseout="out('927814391059993389');" style="">  47      private static final Logger LOG = LoggerFactory.getLogger(LocalStreamEnvironment.class);                      </span>
<span  style="">  48                                                                                                                    </span>
<span class="-8302311498454820742" onmouseenter="enter('-8302311498454820742');" onmouseout="out('-8302311498454820742');" style="">  49      /** The configuration to use for the local cluster. */                                                        </span>
<span class="-5224455178778766138" onmouseenter="enter('-5224455178778766138');" onmouseout="out('-5224455178778766138');" style="">  50      private final Configuration conf;                                                                             </span>
<span  style="">  51                                                                                                                    </span>
<span class="33436849132097052" onmouseenter="enter('33436849132097052');" onmouseout="out('33436849132097052');" style="">  52      public List&lt;URL&gt; getClasspaths() {                                                                            </span>
<span class="-6420995887957701132" onmouseenter="enter('-6420995887957701132');" onmouseout="out('-6420995887957701132');" style="">  53          return classpaths;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54      }                                                                                                             </span>
<span  style="">  55                                                                                                                    </span>
<span class="4428292286261856619" onmouseenter="enter('4428292286261856619');" onmouseout="out('4428292286261856619');" style="">  56      public void setClasspaths(List&lt;URL&gt; classpaths) {                                                             </span>
<span class="-284268027982127308" onmouseenter="enter('-284268027982127308');" onmouseout="out('-284268027982127308');" style="">  57          this.classpaths = classpaths;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58      }                                                                                                             </span>
<span  style="">  59                                                                                                                    </span>
<span class="-6352601788059183844" onmouseenter="enter('-6352601788059183844');" onmouseout="out('-6352601788059183844');" style="">  60      private List&lt;URL&gt; classpaths = Collections.emptyList();                                                       </span>
<span  style="">  61                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62      /**                                                                                                           </span>
<span class="-4066435560223898603" onmouseenter="enter('-4066435560223898603');" onmouseout="out('-4066435560223898603');" style="">  63       * Creates a new local stream environment that uses the default configuration.                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64       */                                                                                                           </span>
<span class="3058085256785609242" onmouseenter="enter('3058085256785609242');" onmouseout="out('3058085256785609242');" style="">  65      public MyLocalStreamEnvironment() {                                                                           </span>
<span class="4995832816651655245" onmouseenter="enter('4995832816651655245');" onmouseout="out('4995832816651655245');" style="">  66          this(null);                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67      }                                                                                                             </span>
<span  style="">  68                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  69      /**                                                                                                           </span>
<span class="-4528612473615798665" onmouseenter="enter('-4528612473615798665');" onmouseout="out('-4528612473615798665');" style="">  70       * Creates a new local stream environment that configures its local executor with the given configuration.    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  71       *                                                                                                            </span>
<span class="-6707673741392514158" onmouseenter="enter('-6707673741392514158');" onmouseout="out('-6707673741392514158');" style="">  72       * @param config The configuration used to configure the local executor.                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  73       */                                                                                                           </span>
<span class="-2493191466510402117" onmouseenter="enter('-2493191466510402117');" onmouseout="out('-2493191466510402117');" style="">  74      public MyLocalStreamEnvironment(Configuration config) {                                                       </span>
<span class="8789071791401540025" onmouseenter="enter('8789071791401540025');" onmouseout="out('8789071791401540025');" style="">  75          if (!ExecutionEnvironment.areExplicitEnvironmentsAllowed()) {                                             </span>
<span class="7710846670516805987" onmouseenter="enter('7710846670516805987');" onmouseout="out('7710846670516805987');" style="">  76              throw new InvalidProgramException(                                                                    </span>
<span class="-2542758256191115215" onmouseenter="enter('-2542758256191115215');" onmouseout="out('-2542758256191115215');" style="">  77                      &quot;The LocalStreamEnvironment cannot be used when submitting a program through a client, &quot; +    </span>
<span class="6974934080389806707" onmouseenter="enter('6974934080389806707');" onmouseout="out('6974934080389806707');" style="">  78                              &quot;or running in a TestEnvironment context.&quot;);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79          }                                                                                                         </span>
<span  style="">  80                                                                                                                    </span>
<span class="-8373741422957297910" onmouseenter="enter('-8373741422957297910');" onmouseout="out('-8373741422957297910');" style="">  81          this.conf = config == null ? new Configuration() : config;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82      }                                                                                                             </span>
<span  style="">  83                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84      /**                                                                                                           </span>
<span class="1284490758839337609" onmouseenter="enter('1284490758839337609');" onmouseout="out('1284490758839337609');" style="">  85       * Executes the JobGraph of the on a mini cluster of CLusterUtil with a user                                  </span>
<span class="-8276390245672004452" onmouseenter="enter('-8276390245672004452');" onmouseout="out('-8276390245672004452');" style="">  86       * specified name.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  87       *                                                                                                            </span>
<span class="1205290586124068771" onmouseenter="enter('1205290586124068771');" onmouseout="out('1205290586124068771');" style="">  88       * @param jobName                                                                                             </span>
<span class="8922276232820338335" onmouseenter="enter('8922276232820338335');" onmouseout="out('8922276232820338335');" style="">  89       *            name of the job                                                                                 </span>
<span class="-7125693057193628963" onmouseenter="enter('-7125693057193628963');" onmouseout="out('-7125693057193628963');" style="">  90       * @return The result of the job execution, containing elapsed time and accumulators.                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92      @Override                                                                                                     </span>
<span class="1978066122187801914" onmouseenter="enter('1978066122187801914');" onmouseout="out('1978066122187801914');" style="">  93      public JobExecutionResult execute(String jobName) throws Exception {                                          </span>
<span class="-1724004361167976311" onmouseenter="enter('-1724004361167976311');" onmouseout="out('-1724004361167976311');" style="">  94          // transform the streaming program into a JobGraph                                                        </span>
<span class="2530093744782704739" onmouseenter="enter('2530093744782704739');" onmouseout="out('2530093744782704739');" style="">  95          StreamGraph streamGraph = getStreamGraph();                                                               </span>
<span class="6186400327817873378" onmouseenter="enter('6186400327817873378');" onmouseout="out('6186400327817873378');" style="">  96          streamGraph.setJobName(jobName);                                                                          </span>
<span class="-5806655344611004702" onmouseenter="enter('-5806655344611004702');" onmouseout="out('-5806655344611004702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +        return execute(streamGraph);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +                                                                                                                  </span>
<span class="-8115262382803132310" onmouseenter="enter('-8115262382803132310');" onmouseout="out('-8115262382803132310');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +    public JobExecutionResult execute(StreamGraph streamGraph) throws Exception {                                 </span>
<span  style=""> 101                                                                                                                    </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style=""> 102          JobGraph jobGraph = streamGraph.getJobGraph();                                                            </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style=""> 103          jobGraph.setClasspaths(classpaths);                                                                       </span>
<span class="469304360307650831" onmouseenter="enter('469304360307650831');" onmouseout="out('469304360307650831');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +        jobGraph.setAllowQueuedScheduling(true);                                                                  </span>
<span  style=""> 105                                                                                                                    </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style=""> 106          Configuration configuration = new Configuration();                                                        </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style=""> 107          configuration.addAll(jobGraph.getJobConfiguration());                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                                                                                                                  </span>
<span class="-7627712255778921581" onmouseenter="enter('-7627712255778921581');" onmouseout="out('-7627712255778921581');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -        configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;512M&quot;);                                  </span>
<span class="5682313294434480073" onmouseenter="enter('5682313294434480073');" onmouseout="out('5682313294434480073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -        configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());            </span>
<span class="-2347000785166369020" onmouseenter="enter('-2347000785166369020');" onmouseout="out('-2347000785166369020');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +        configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;0&quot;);                                     </span>
<span  style=""> 112                                                                                                                    </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style=""> 113          // add (and override) the settings with what the user defined                                             </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style=""> 114          configuration.addAll(this.conf);                                                                          </span>
<span  style=""> 115                                                                                                                    </span>
<span class="-4067763610081958627" onmouseenter="enter('-4067763610081958627');" onmouseout="out('-4067763610081958627');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -        MiniClusterConfiguration.Builder configBuilder = new MiniClusterConfiguration.Builder();                  </span>
<span class="-218288098588460842" onmouseenter="enter('-218288098588460842');" onmouseout="out('-218288098588460842');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -        configBuilder.setConfiguration(configuration);                                                            </span>
<span class="1146827845910868279" onmouseenter="enter('1146827845910868279');" onmouseout="out('1146827845910868279');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +        if (!configuration.contains(RestOptions.BIND_PORT)) {                                                     </span>
<span class="-970167148439492506" onmouseenter="enter('-970167148439492506');" onmouseout="out('-970167148439492506');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +            configuration.setString(RestOptions.BIND_PORT, &quot;0&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +                                                                                                                  </span>
<span class="7193442408929112501" onmouseenter="enter('7193442408929112501');" onmouseout="out('7193442408929112501');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 122 +        int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());"> 122 +        int numSlotsPerTaskManager = configuration.getInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +                                                                                                                  </span>
<span class="-6461278587826064637" onmouseenter="enter('-6461278587826064637');" onmouseout="out('-6461278587826064637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +        MiniClusterConfiguration cfg = new MiniClusterConfiguration.Builder()                                     </span>
<span class="-5561795182015022337" onmouseenter="enter('-5561795182015022337');" onmouseout="out('-5561795182015022337');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +                .setConfiguration(configuration)                                                                  </span>
<span class="-267175273231167629" onmouseenter="enter('-267175273231167629');" onmouseout="out('-267175273231167629');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                .setNumSlotsPerTaskManager(numSlotsPerTaskManager)                                                </span>
<span class="-368814941510255410" onmouseenter="enter('-368814941510255410');" onmouseout="out('-368814941510255410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +                .build();                                                                                         </span>
<span  style=""> 128                                                                                                                    </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 129          if (LOG.isInfoEnabled()) {                                                                                </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style=""> 130              LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131          }                                                                                                         </span>
<span  style=""> 132                                                                                                                    </span>
<span class="6927310010976677086" onmouseenter="enter('6927310010976677086');" onmouseout="out('6927310010976677086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -        MiniCluster exec = new MiniCluster(configBuilder.build());                                                </span>
<span class="-184687421353294589" onmouseenter="enter('-184687421353294589');" onmouseout="out('-184687421353294589');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +        MiniCluster miniCluster = new MiniCluster(cfg);                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 136          try {                                                                                                     </span>

<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -            exec.start();                                                                                         </span>
<span class="7731757287012350095" onmouseenter="enter('7731757287012350095');" onmouseout="out('7731757287012350095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -            return exec.executeJobBlocking(jobGraph);                                                             </span>
<span class="-6379149240419989614" onmouseenter="enter('-6379149240419989614');" onmouseout="out('-6379149240419989614');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +            miniCluster.start();                                                                                  </span>
<span class="1705754538614300842" onmouseenter="enter('1705754538614300842');" onmouseout="out('1705754538614300842');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +            configuration.setInteger(RestOptions.PORT, miniCluster.getRestAddress().get().getPort());             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +                                                                                                                  </span>
<span class="109994806188102896" onmouseenter="enter('109994806188102896');" onmouseout="out('109994806188102896');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +            return miniCluster.executeJobBlocking(jobGraph);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143          }                                                                                                         </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style=""> 144          finally {                                                                                                 </span>

<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style=""> 145              transformations.clear();                                                                              </span>
<span class="5486376394376154741" onmouseenter="enter('5486376394376154741');" onmouseout="out('5486376394376154741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -            exec.closeAsync();                                                                                    </span>
<span class="-3977601811582495792" onmouseenter="enter('-3977601811582495792');" onmouseout="out('-3977601811582495792');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +            miniCluster.close();                                                                                  </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="5598128254818160022" onmouseenter="enter('5598128254818160022');" onmouseout="out('5598128254818160022');" style="">  19  package com.dtstack.flink.sql.environment;                                                                        </span>
<span  style="">  20                                                                                                                    </span>
<span class="2461872502712586167" onmouseenter="enter('2461872502712586167');" onmouseout="out('2461872502712586167');" style="">  21  import org.apache.flink.api.common.InvalidProgramException;                                                       </span>
<span class="8256876323376004396" onmouseenter="enter('8256876323376004396');" onmouseout="out('8256876323376004396');" style="">  22  import org.apache.flink.api.common.JobExecutionResult;                                                            </span>
<span class="-902830676319511587" onmouseenter="enter('-902830676319511587');" onmouseout="out('-902830676319511587');" style="">  23  import org.apache.flink.api.java.ExecutionEnvironment;                                                            </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24  import org.apache.flink.configuration.Configuration;                                                              </span>

<span class="1850401773685605073" onmouseenter="enter('1850401773685605073');" onmouseout="out('1850401773685605073');" style="">  25  import org.apache.flink.configuration.TaskManagerOptions;                                                         </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  26  import org.apache.flink.runtime.jobgraph.JobGraph;                                                                </span>
<span class="-2713113410259205994" onmouseenter="enter('-2713113410259205994');" onmouseout="out('-2713113410259205994');" style="">  27  import org.apache.flink.runtime.minicluster.MiniCluster;                                                          </span>
<span class="1583265242678797853" onmouseenter="enter('1583265242678797853');" onmouseout="out('1583265242678797853');" style="">  28  import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;                                             </span>
<span class="5297953280946518295" onmouseenter="enter('5297953280946518295');" onmouseout="out('5297953280946518295');" style="">  29  import org.apache.flink.streaming.api.environment.LocalStreamEnvironment;                                         </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  30  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="-6686939373153454077" onmouseenter="enter('-6686939373153454077');" onmouseout="out('-6686939373153454077');" style="">  31  import org.apache.flink.streaming.api.graph.StreamGraph;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  32  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  33  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  34                                                                                                                    </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  35  import java.net.URL;                                                                                              </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  36  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  37  import java.util.List;                                                                                            </span>
<span  style="">  38                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  39  /**                                                                                                               </span>
<span class="-3231818603887923319" onmouseenter="enter('-3231818603887923319');" onmouseout="out('-3231818603887923319');" style="">  40   * Local Stream Environment                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  41   *                                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  42   * Company: www.dtstack.com                                                                                       </span>
<span class="6779159400583430426" onmouseenter="enter('6779159400583430426');" onmouseout="out('6779159400583430426');" style="">  43   * @author huyifan.zju@163.com                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  44   */                                                                                                               </span>
<span class="4246239116754757473" onmouseenter="enter('4246239116754757473');" onmouseout="out('4246239116754757473');" style="">  45  public class MyLocalStreamEnvironment extends StreamExecutionEnvironment {                                        </span>
<span class="927814391059993389" onmouseenter="enter('927814391059993389');" onmouseout="out('927814391059993389');" style="">  46      private static final Logger LOG = LoggerFactory.getLogger(LocalStreamEnvironment.class);                      </span>
<span  style="">  47                                                                                                                    </span>
<span class="-8302311498454820742" onmouseenter="enter('-8302311498454820742');" onmouseout="out('-8302311498454820742');" style="">  48      /** The configuration to use for the local cluster. */                                                        </span>
<span class="-5224455178778766138" onmouseenter="enter('-5224455178778766138');" onmouseout="out('-5224455178778766138');" style="">  49      private final Configuration conf;                                                                             </span>
<span  style="">  50                                                                                                                    </span>
<span class="33436849132097052" onmouseenter="enter('33436849132097052');" onmouseout="out('33436849132097052');" style="">  51      public List&lt;URL&gt; getClasspaths() {                                                                            </span>
<span class="-6420995887957701132" onmouseenter="enter('-6420995887957701132');" onmouseout="out('-6420995887957701132');" style="">  52          return classpaths;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53      }                                                                                                             </span>
<span  style="">  54                                                                                                                    </span>
<span class="4428292286261856619" onmouseenter="enter('4428292286261856619');" onmouseout="out('4428292286261856619');" style="">  55      public void setClasspaths(List&lt;URL&gt; classpaths) {                                                             </span>
<span class="-284268027982127308" onmouseenter="enter('-284268027982127308');" onmouseout="out('-284268027982127308');" style="">  56          this.classpaths = classpaths;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  57      }                                                                                                             </span>
<span  style="">  58                                                                                                                    </span>
<span class="-6352601788059183844" onmouseenter="enter('-6352601788059183844');" onmouseout="out('-6352601788059183844');" style="">  59      private List&lt;URL&gt; classpaths = Collections.emptyList();                                                       </span>
<span  style="">  60                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61      /**                                                                                                           </span>
<span class="-4066435560223898603" onmouseenter="enter('-4066435560223898603');" onmouseout="out('-4066435560223898603');" style="">  62       * Creates a new local stream environment that uses the default configuration.                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  63       */                                                                                                           </span>
<span class="3058085256785609242" onmouseenter="enter('3058085256785609242');" onmouseout="out('3058085256785609242');" style="">  64      public MyLocalStreamEnvironment() {                                                                           </span>
<span class="4995832816651655245" onmouseenter="enter('4995832816651655245');" onmouseout="out('4995832816651655245');" style="">  65          this(null);                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  66      }                                                                                                             </span>
<span  style="">  67                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  68      /**                                                                                                           </span>
<span class="-4528612473615798665" onmouseenter="enter('-4528612473615798665');" onmouseout="out('-4528612473615798665');" style="">  69       * Creates a new local stream environment that configures its local executor with the given configuration.    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  70       *                                                                                                            </span>
<span class="-6707673741392514158" onmouseenter="enter('-6707673741392514158');" onmouseout="out('-6707673741392514158');" style="">  71       * @param config The configuration used to configure the local executor.                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  72       */                                                                                                           </span>
<span class="-2493191466510402117" onmouseenter="enter('-2493191466510402117');" onmouseout="out('-2493191466510402117');" style="">  73      public MyLocalStreamEnvironment(Configuration config) {                                                       </span>
<span class="8789071791401540025" onmouseenter="enter('8789071791401540025');" onmouseout="out('8789071791401540025');" style="">  74          if (!ExecutionEnvironment.areExplicitEnvironmentsAllowed()) {                                             </span>
<span class="7710846670516805987" onmouseenter="enter('7710846670516805987');" onmouseout="out('7710846670516805987');" style="">  75              throw new InvalidProgramException(                                                                    </span>
<span class="-2542758256191115215" onmouseenter="enter('-2542758256191115215');" onmouseout="out('-2542758256191115215');" style="">  76                      &quot;The LocalStreamEnvironment cannot be used when submitting a program through a client, &quot; +    </span>
<span class="6974934080389806707" onmouseenter="enter('6974934080389806707');" onmouseout="out('6974934080389806707');" style="">  77                              &quot;or running in a TestEnvironment context.&quot;);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78          }                                                                                                         </span>
<span  style="">  79                                                                                                                    </span>
<span class="-8373741422957297910" onmouseenter="enter('-8373741422957297910');" onmouseout="out('-8373741422957297910');" style="">  80          this.conf = config == null ? new Configuration() : config;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81      }                                                                                                             </span>
<span  style="">  82                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83      /**                                                                                                           </span>
<span class="1284490758839337609" onmouseenter="enter('1284490758839337609');" onmouseout="out('1284490758839337609');" style="">  84       * Executes the JobGraph of the on a mini cluster of CLusterUtil with a user                                  </span>
<span class="-8276390245672004452" onmouseenter="enter('-8276390245672004452');" onmouseout="out('-8276390245672004452');" style="">  85       * specified name.                                                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  86       *                                                                                                            </span>
<span class="1205290586124068771" onmouseenter="enter('1205290586124068771');" onmouseout="out('1205290586124068771');" style="">  87       * @param jobName                                                                                             </span>
<span class="8922276232820338335" onmouseenter="enter('8922276232820338335');" onmouseout="out('8922276232820338335');" style="">  88       *            name of the job                                                                                 </span>
<span class="-7125693057193628963" onmouseenter="enter('-7125693057193628963');" onmouseout="out('-7125693057193628963');" style="">  89       * @return The result of the job execution, containing elapsed time and accumulators.                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91      @Override                                                                                                     </span>
<span class="1978066122187801914" onmouseenter="enter('1978066122187801914');" onmouseout="out('1978066122187801914');" style="">  92      public JobExecutionResult execute(String jobName) throws Exception {                                          </span>
<span class="-1724004361167976311" onmouseenter="enter('-1724004361167976311');" onmouseout="out('-1724004361167976311');" style="">  93          // transform the streaming program into a JobGraph                                                        </span>
<span class="2530093744782704739" onmouseenter="enter('2530093744782704739');" onmouseout="out('2530093744782704739');" style="">  94          StreamGraph streamGraph = getStreamGraph();                                                               </span>
<span class="6186400327817873378" onmouseenter="enter('6186400327817873378');" onmouseout="out('6186400327817873378');" style="">  95          streamGraph.setJobName(jobName);                                                                          </span>




<span  style="">  96                                                                                                                    </span>
<span class="-6285821008141170020" onmouseenter="enter('-6285821008141170020');" onmouseout="out('-6285821008141170020');" style="">  97          JobGraph jobGraph = streamGraph.getJobGraph();                                                            </span>
<span class="1919055888054948862" onmouseenter="enter('1919055888054948862');" onmouseout="out('1919055888054948862');" style="">  98          jobGraph.setClasspaths(classpaths);                                                                       </span>

<span  style="">  99                                                                                                                    </span>
<span class="-6499647470194902929" onmouseenter="enter('-6499647470194902929');" onmouseout="out('-6499647470194902929');" style=""> 100          Configuration configuration = new Configuration();                                                        </span>
<span class="8285770659347218218" onmouseenter="enter('8285770659347218218');" onmouseout="out('8285770659347218218');" style=""> 101          configuration.addAll(jobGraph.getJobConfiguration());                                                     </span>
<span  style=""> 102                                                                                                                    </span>
<span class="-7627712255778921581" onmouseenter="enter('-7627712255778921581');" onmouseout="out('-7627712255778921581');" style=""> 103          configuration.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE, &quot;512M&quot;);                                  </span>
<span class="5682313294434480073" onmouseenter="enter('5682313294434480073');" onmouseout="out('5682313294434480073');" style=""> 104          configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, jobGraph.getMaximumParallelism());            </span>

<span  style=""> 105                                                                                                                    </span>
<span class="6859569609522625763" onmouseenter="enter('6859569609522625763');" onmouseout="out('6859569609522625763');" style=""> 106          // add (and override) the settings with what the user defined                                             </span>
<span class="-6604923139298531654" onmouseenter="enter('-6604923139298531654');" onmouseout="out('-6604923139298531654');" style=""> 107          configuration.addAll(this.conf);                                                                          </span>
<span  style=""> 108                                                                                                                    </span>
<span class="-4067763610081958627" onmouseenter="enter('-4067763610081958627');" onmouseout="out('-4067763610081958627');" style=""> 109          MiniClusterConfiguration.Builder configBuilder = new MiniClusterConfiguration.Builder();                  </span>
<span class="-218288098588460842" onmouseenter="enter('-218288098588460842');" onmouseout="out('-218288098588460842');" style=""> 110          configBuilder.setConfiguration(configuration);                                                            </span>










<span  style=""> 111                                                                                                                    </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 112          if (LOG.isInfoEnabled()) {                                                                                </span>
<span class="4626573951882189824" onmouseenter="enter('4626573951882189824');" onmouseout="out('4626573951882189824');" style=""> 113              LOG.info(&quot;Running job on local embedded Flink mini cluster&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114          }                                                                                                         </span>
<span  style=""> 115                                                                                                                    </span>
<span class="6927310010976677086" onmouseenter="enter('6927310010976677086');" onmouseout="out('6927310010976677086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -        MiniCluster exec = new MiniCluster(configBuilder.build());                                                </span>


<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -        try {                                                                                                     </span>
<span class="168373147428824238" onmouseenter="enter('168373147428824238');" onmouseout="out('168373147428824238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +        try (MiniCluster exec = new MiniCluster(configBuilder.build());) {                                        </span>
<span class="-6430303123276844640" onmouseenter="enter('-6430303123276844640');" onmouseout="out('-6430303123276844640');" style=""> 119              exec.start();                                                                                         </span>
<span class="7731757287012350095" onmouseenter="enter('7731757287012350095');" onmouseout="out('7731757287012350095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -            return exec.executeJobBlocking(jobGraph);                                                             </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -        }                                                                                                         </span>
<span class="-4316631342148518333" onmouseenter="enter('-4316631342148518333');" onmouseout="out('-4316631342148518333');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -        finally {                                                                                                 </span>
<span class="-4131614522424838430" onmouseenter="enter('-4131614522424838430');" onmouseout="out('-4131614522424838430');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +            JobExecutionResult jobExecutionResult = exec.executeJobBlocking(jobGraph);                            </span>
<span class="-8933349475483584039" onmouseenter="enter('-8933349475483584039');" onmouseout="out('-8933349475483584039');" style=""> 124              transformations.clear();                                                                              </span>
<span class="5486376394376154741" onmouseenter="enter('5486376394376154741');" onmouseout="out('5486376394376154741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -            exec.closeAsync();                                                                                    </span>
<span class="-1000843434916666050" onmouseenter="enter('-1000843434916666050');" onmouseout="out('-1000843434916666050');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +            return jobExecutionResult;                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        } catch (Exception e) {                                                                                   </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +            throw new RuntimeException(e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            