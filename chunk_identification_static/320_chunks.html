<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>320 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                         &#x27;                &#x27;
                         &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                         &#x27;                Object factory = &#x27;
                         &#x27;getFactoryMethod.invoke(null);\n&#x27;
                         &#x27;                Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                         &#x27;                Method getSelector = &#x27;
                         &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                         &#x27;                Object contextSelector = &#x27;
                         &#x27;getSelector.invoke(factory, (Object[]) null);\n&#x27;
                         &#x27;                ContextSelector ctxSelector = &#x27;
                         &#x27;(ContextSelector) contextSelector;\n&#x27;
                         &#x27;                for (LoggerContext ctx: &#x27;
                         &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                         &#x27;                    ctx.reconfigure();\n&#x27;
                         &#x27;                    &#x27;
                         &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                         &#x27;                    Configuration config = &#x27;
                         &#x27;ctx.getConfiguration();\n&#x27;
                         &#x27;                    StrLookup resolver = &#x27;
                         &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                         &#x27;                    if (resolver instanceof &#x27;
                         &#x27;Interpolator) {\n&#x27;
                         &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;
                         &#x27;                        try {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                         &#x27;                        } catch &#x27;
                         &#x27;(NoSuchFieldException e) {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                         &#x27;                        }\n&#x27;
                         &#x27;                        &#x27;
                         &#x27;lookups.setAccessible(true);\n&#x27;
                         &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                         &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                         &#x27;lookups.get(resolver);\n&#x27;
                         &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;            getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;            Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;            Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;            Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;            Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;            ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;            for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                // The following deadlocks in some &#x27;
                           &#x27;tests when using ThreadContext attacks\n&#x27;
                           &#x27;                //ctx.reconfigure();\n&#x27;
                           &#x27;                Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;
                           &#x27;                    try {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                    } catch (NoSuchFieldException &#x27;
                           &#x27;e) {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                         &#x27;                &#x27;
                         &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                         &#x27;                Object factory = &#x27;
                         &#x27;getFactoryMethod.invoke(null);\n&#x27;
                         &#x27;                Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                         &#x27;                Method getSelector = &#x27;
                         &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                         &#x27;                Object contextSelector = &#x27;
                         &#x27;getSelector.invoke(factory, (Object[]) null);\n&#x27;
                         &#x27;                ContextSelector ctxSelector = &#x27;
                         &#x27;(ContextSelector) contextSelector;\n&#x27;
                         &#x27;                for (LoggerContext ctx: &#x27;
                         &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                         &#x27;                    ctx.reconfigure();\n&#x27;
                         &#x27;                    &#x27;
                         &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                         &#x27;                    Configuration config = &#x27;
                         &#x27;ctx.getConfiguration();\n&#x27;
                         &#x27;                    StrLookup resolver = &#x27;
                         &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                         &#x27;                    if (resolver instanceof &#x27;
                         &#x27;Interpolator) {\n&#x27;
                         &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;
                         &#x27;                        try {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                         &#x27;                        } catch &#x27;
                         &#x27;(NoSuchFieldException e) {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                         &#x27;                        }\n&#x27;
                         &#x27;                        &#x27;
                         &#x27;lookups.setAccessible(true);\n&#x27;
                         &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                         &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                         &#x27;lookups.get(resolver);\n&#x27;
                         &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;            getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;            Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;            Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;            Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;            Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;            ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;            for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                // The following deadlocks in some &#x27;
                           &#x27;tests when using ThreadContext attacks\n&#x27;
                           &#x27;                //ctx.reconfigure();\n&#x27;
                           &#x27;                Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;
                           &#x27;                    try {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                    } catch (NoSuchFieldException &#x27;
                           &#x27;e) {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            //}\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            }\n        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            //}\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                         &#x27;                &#x27;
                         &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                         &#x27;                Object factory = &#x27;
                         &#x27;getFactoryMethod.invoke(null);\n&#x27;
                         &#x27;                Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                         &#x27;                Method getSelector = &#x27;
                         &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                         &#x27;                Object contextSelector = &#x27;
                         &#x27;getSelector.invoke(factory, (Object[]) null);\n&#x27;
                         &#x27;                ContextSelector ctxSelector = &#x27;
                         &#x27;(ContextSelector) contextSelector;\n&#x27;
                         &#x27;                for (LoggerContext ctx: &#x27;
                         &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                         &#x27;                    ctx.reconfigure();\n&#x27;
                         &#x27;                    &#x27;
                         &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                         &#x27;                    Configuration config = &#x27;
                         &#x27;ctx.getConfiguration();\n&#x27;
                         &#x27;                    StrLookup resolver = &#x27;
                         &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                         &#x27;                    if (resolver instanceof &#x27;
                         &#x27;Interpolator) {\n&#x27;
                         &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;
                         &#x27;                        try {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                         &#x27;                        } catch &#x27;
                         &#x27;(NoSuchFieldException e) {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                         &#x27;                        }\n&#x27;
                         &#x27;                        &#x27;
                         &#x27;lookups.setAccessible(true);\n&#x27;
                         &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                         &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                         &#x27;lookups.get(resolver);\n&#x27;
                         &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;            getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;            Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;            Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;            Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;            Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;            ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;            for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                // The following deadlocks in some &#x27;
                           &#x27;tests when using ThreadContext attacks\n&#x27;
                           &#x27;                //ctx.reconfigure();\n&#x27;
                           &#x27;                Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;
                           &#x27;                    try {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                    } catch (NoSuchFieldException &#x27;
                           &#x27;e) {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            c = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                         &#x27;            try {\n&#x27;
                         &#x27;                Method reconfigure = &#x27;
                         &#x27;c.getMethod(&quot;reconfigure&quot;);\n&#x27;
                         &#x27;                reconfigure.invoke(null);\n&#x27;
                         &#x27;            } catch (Exception ex) {\n&#x27;
                         &#x27;                // Log4j is probably older.\n&#x27;
                         &#x27;                Method getFactoryMethod = &#x27;
                         &#x27;c.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                         &#x27;                &#x27;
                         &#x27;getFactoryMethod.setAccessible(true);\n&#x27;
                         &#x27;                Object factory = &#x27;
                         &#x27;getFactoryMethod.invoke(null);\n&#x27;
                         &#x27;                Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                         &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                         &#x27;                Method getSelector = &#x27;
                         &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                         &#x27;                Object contextSelector = &#x27;
                         &#x27;getSelector.invoke(factory, (Object[]) null);\n&#x27;
                         &#x27;                ContextSelector ctxSelector = &#x27;
                         &#x27;(ContextSelector) contextSelector;\n&#x27;
                         &#x27;                for (LoggerContext ctx: &#x27;
                         &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                         &#x27;                    ctx.reconfigure();\n&#x27;
                         &#x27;                    &#x27;
                         &#x27;System.err.println(&quot;Reconfiguring context&quot;);\n&#x27;
                         &#x27;                    Configuration config = &#x27;
                         &#x27;ctx.getConfiguration();\n&#x27;
                         &#x27;                    StrLookup resolver = &#x27;
                         &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                         &#x27;                    if (resolver instanceof &#x27;
                         &#x27;Interpolator) {\n&#x27;
                         &#x27;                        System.err.println(&quot;Lookup &#x27;
                         &#x27;is an Interpolator - attempting to remove JNDI&quot;);\n&#x27;
                         &#x27;                        Field lookups;\n&#x27;
                         &#x27;                        //noinspection &#x27;
                         &#x27;RedundantSuppression\n&#x27;
                         &#x27;                        try {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                         &#x27;                        } catch &#x27;
                         &#x27;(NoSuchFieldException e) {\n&#x27;
                         &#x27;                            //noinspection &#x27;
                         &#x27;JavaReflectionMemberAccess\n&#x27;
                         &#x27;                            lookups = &#x27;
                         &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                         &#x27;                        }\n&#x27;
                         &#x27;                        &#x27;
                         &#x27;lookups.setAccessible(true);\n&#x27;
                         &#x27;                        Map&lt;String, StrLookup&gt; &#x27;
                         &#x27;lookupMap = (Map&lt;String, StrLookup&gt;) &#x27;
                         &#x27;lookups.get(resolver);\n&#x27;
                         &#x27;                        lookupMap.remove(&quot;jndi&quot;);\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            Class&lt;?&gt; configuratorClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.config.Configurator&quot;);\n&#x27;
                           &#x27;\n&#x27;
                           &quot;            // Due to CVE-2021-45046 we&#x27;re no &quot;
                           &#x27;longer using the reconfigure method -\n&#x27;
                           &#x27;            // Instead we reconfigure the logger &#x27;
                           &#x27;but *also* remove the JNDI listener from the &#x27;
                           &#x27;plugin map\n&#x27;
                           &#x27;            //try {\n&#x27;
                           &#x27;            //    Method reconfigure = &#x27;
                           &#x27;configuratorClass.getMethod(&quot;reconfigure&quot;);\n&#x27;
                           &#x27;            //    reconfigure.invoke(null);\n&#x27;
                           &#x27;            //} catch (Exception ex) {\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            Method getFactoryMethod = &#x27;
                           &#x27;configuratorClass.getDeclaredMethod(&quot;getFactory&quot;);\n&#x27;
                           &#x27;            getFactoryMethod.setAccessible(true);\n&#x27;
                           &#x27;            Object factory = &#x27;
                           &#x27;getFactoryMethod.invoke(null);\n&#x27;
                           &#x27;            Class&lt;?&gt; log4jContextFactoryClass = &#x27;
                           &#x27;classLoader.loadClass(&quot;org.apache.logging.log4j.core.impl.Log4jContextFactory&quot;);\n&#x27;
                           &#x27;            Method getSelector = &#x27;
                           &#x27;log4jContextFactoryClass.getMethod(&quot;getSelector&quot;);\n&#x27;
                           &#x27;            Object contextSelector = &#x27;
                           &#x27;getSelector.invoke(factory, null);\n&#x27;
                           &#x27;            ContextSelector ctxSelector = &#x27;
                           &#x27;(ContextSelector) contextSelector;\n&#x27;
                           &#x27;            for (LoggerContext ctx: &#x27;
                           &#x27;ctxSelector.getLoggerContexts()) {\n&#x27;
                           &#x27;                // The following deadlocks in some &#x27;
                           &#x27;tests when using ThreadContext attacks\n&#x27;
                           &#x27;                //ctx.reconfigure();\n&#x27;
                           &#x27;                Configuration config = &#x27;
                           &#x27;ctx.getConfiguration();\n&#x27;
                           &#x27;                StrLookup resolver = &#x27;
                           &#x27;config.getStrSubstitutor().getVariableResolver();\n&#x27;
                           &#x27;                if (resolver instanceof &#x27;
                           &#x27;Interpolator) {\n&#x27;
                           &#x27;                    System.err.println(&quot;Lookup is &#x27;
                           &#x27;an Interpolator - removing JNDI&quot;);\n&#x27;
                           &#x27;                    Field lookups = null;\n&#x27;
                           &#x27;                    try {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;lookups&quot;);\n&#x27;
                           &#x27;                    } catch (NoSuchFieldException &#x27;
                           &#x27;e) {\n&#x27;
                           &#x27;                        lookups = &#x27;
                           &#x27;Interpolator.class.getDeclaredField(&quot;strLookupMap&quot;);\n&#x27;
                           &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            //}\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            }\n        } catch (Throwable e) {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            //}\n&#x27;
                           &#x27;        } catch (Exception e) {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        